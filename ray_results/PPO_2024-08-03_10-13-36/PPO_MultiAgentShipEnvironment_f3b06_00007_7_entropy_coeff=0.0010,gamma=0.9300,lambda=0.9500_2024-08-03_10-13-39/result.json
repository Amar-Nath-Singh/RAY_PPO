{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5192009115591645, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.182327771683534, "policy_loss": -0.011755079333185373, "vf_loss": 9.192544234792392, "vf_explained_var": 0.05992427716652552, "kl": 0.014806852210464664, "entropy": 1.4227625396102668, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -132.93735775407, "episode_reward_min": -1188.3707683110629, "episode_reward_mean": -700.4798657884016, "episode_len_mean": 141.52173913043478, "episode_media": {}, "episodes_timesteps_total": 3255, "policy_reward_min": {"policy_0": -1188.3707683110629}, "policy_reward_max": {"policy_0": -132.93735775407}, "policy_reward_mean": {"policy_0": -700.4798657884016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-410.6788056315244, -163.97172330701804, -1188.3707683110629, -804.6220685540162, -1068.750955666459, -466.9845400339827, -821.3453323007243, -812.7541663695063, -787.8361646886843, -750.8130010884494, -370.51462311845046, -838.4823545725936, -334.0809197315277, -924.9112229617241, -132.93735775407, -964.1496588401648, -901.2532732821438, -736.501849549409, -871.6543194566758, -799.949205766924, -197.61805956420946, -967.4628879743608, -795.393654609556], "episode_lengths": [150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 80, 150, 150], "policy_policy_0_reward": [-410.6788056315244, -163.97172330701804, -1188.3707683110629, -804.6220685540162, -1068.750955666459, -466.9845400339827, -821.3453323007243, -812.7541663695063, -787.8361646886843, -750.8130010884494, -370.51462311845046, -838.4823545725936, -334.0809197315277, -924.9112229617241, -132.93735775407, -964.1496588401648, -901.2532732821438, -736.501849549409, -871.6543194566758, -799.949205766924, -197.61805956420946, -967.4628879743608, -795.393654609556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5700909937356586, "mean_inference_ms": 1.657750479387098, "mean_action_processing_ms": 0.2786293943493254, "mean_env_wait_ms": 2.943180474971494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011450311411981997, "StateBufferConnector_ms": 0.007975619772206182, "ViewRequirementAgentConnector_ms": 0.1770496368408203}, "num_episodes": 23, "episode_return_max": -132.93735775407, "episode_return_min": -1188.3707683110629, "episode_return_mean": -700.4798657884016, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.63319907422357, "num_env_steps_trained_throughput_per_sec": 296.63319907422357, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13484.677, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13484.615, "sample_time_ms": 1014.674, "learn_time_ms": 12397.128, "learn_throughput": 322.655, "synch_weights_time_ms": 71.98}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00007", "date": "2024-08-03_10-53-53", "timestamp": 1722662633, "time_this_iter_s": 13.495734930038452, "time_total_s": 13.495734930038452, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c576560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.495734930038452, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.59, "ram_util_percent": 27.590000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1933986891061066, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.905996824304262, "policy_loss": -0.013126757879702685, "vf_loss": 8.917590403556824, "vf_explained_var": 0.07149948664009571, "kl": 0.014904276262313942, "entropy": 1.4477190915495157, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -55.66373346491794, "episode_reward_min": -1188.3707683110629, "episode_reward_mean": -691.1447156886392, "episode_len_mean": 138.6875, "episode_media": {}, "episodes_timesteps_total": 6657, "policy_reward_min": {"policy_0": -1188.3707683110629}, "policy_reward_max": {"policy_0": -55.66373346491794}, "policy_reward_mean": {"policy_0": -691.1447156886392}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-410.6788056315244, -163.97172330701804, -1188.3707683110629, -804.6220685540162, -1068.750955666459, -466.9845400339827, -821.3453323007243, -812.7541663695063, -787.8361646886843, -750.8130010884494, -370.51462311845046, -838.4823545725936, -334.0809197315277, -924.9112229617241, -132.93735775407, -964.1496588401648, -901.2532732821438, -736.501849549409, -871.6543194566758, -799.949205766924, -197.61805956420946, -967.4628879743608, -795.393654609556, -781.6655349774603, -344.6792826021897, -810.0613391300767, -1125.2953823079954, -783.2530426377824, -634.6787179599753, -554.6185410591037, -631.7880155396293, -960.9718463755061, -1005.9405285768859, -55.66373346491794, -912.8510624429036, -880.3603235197004, -998.2838163106446, -518.4836906057853, -473.9955199833186, -691.379594816852, -392.18721320069125, -245.6641392684415, -876.2300144163868, -1164.1370234817487, -521.7547667794365, -369.0683929429752, -1037.5490098165606, -293.3489077044732], "episode_lengths": [150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 57, 150, 150, 150, 118, 150, 150, 106, 81, 150, 150, 150, 107, 150, 87], "policy_policy_0_reward": [-410.6788056315244, -163.97172330701804, -1188.3707683110629, -804.6220685540162, -1068.750955666459, -466.9845400339827, -821.3453323007243, -812.7541663695063, -787.8361646886843, -750.8130010884494, -370.51462311845046, -838.4823545725936, -334.0809197315277, -924.9112229617241, -132.93735775407, -964.1496588401648, -901.2532732821438, -736.501849549409, -871.6543194566758, -799.949205766924, -197.61805956420946, -967.4628879743608, -795.393654609556, -781.6655349774603, -344.6792826021897, -810.0613391300767, -1125.2953823079954, -783.2530426377824, -634.6787179599753, -554.6185410591037, -631.7880155396293, -960.9718463755061, -1005.9405285768859, -55.66373346491794, -912.8510624429036, -880.3603235197004, -998.2838163106446, -518.4836906057853, -473.9955199833186, -691.379594816852, -392.18721320069125, -245.6641392684415, -876.2300144163868, -1164.1370234817487, -521.7547667794365, -369.0683929429752, -1037.5490098165606, -293.3489077044732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.564338763417522, "mean_inference_ms": 1.6560285359971811, "mean_action_processing_ms": 0.2783843915528233, "mean_env_wait_ms": 2.9449296990372034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013901789983113607, "StateBufferConnector_ms": 0.008051097393035889, "ViewRequirementAgentConnector_ms": 0.17914374669392905}, "num_episodes": 25, "episode_return_max": -55.66373346491794, "episode_return_min": -1188.3707683110629, "episode_return_mean": -691.1447156886392, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.1291114642543, "num_env_steps_trained_throughput_per_sec": 303.1291114642543, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13340.194, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13340.127, "sample_time_ms": 1005.75, "learn_time_ms": 12262.428, "learn_throughput": 326.2, "synch_weights_time_ms": 71.096}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00007", "date": "2024-08-03_10-54-06", "timestamp": 1722662646, "time_this_iter_s": 13.208075523376465, "time_total_s": 26.703810453414917, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5217e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.703810453414917, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.189473684210528, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6565943946441015, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.561894887685776, "policy_loss": -0.007535630516455664, "vf_loss": 8.568463931481043, "vf_explained_var": 0.09499528234203657, "kl": 0.011850479298876357, "entropy": 1.4035126154621442, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -20.753956485755808, "episode_reward_min": -1233.33692694034, "episode_reward_mean": -695.9317555768642, "episode_len_mean": 137.2972972972973, "episode_media": {}, "episodes_timesteps_total": 10160, "policy_reward_min": {"policy_0": -1233.33692694034}, "policy_reward_max": {"policy_0": -20.753956485755808}, "policy_reward_mean": {"policy_0": -695.9317555768642}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-410.6788056315244, -163.97172330701804, -1188.3707683110629, -804.6220685540162, -1068.750955666459, -466.9845400339827, -821.3453323007243, -812.7541663695063, -787.8361646886843, -750.8130010884494, -370.51462311845046, -838.4823545725936, -334.0809197315277, -924.9112229617241, -132.93735775407, -964.1496588401648, -901.2532732821438, -736.501849549409, -871.6543194566758, -799.949205766924, -197.61805956420946, -967.4628879743608, -795.393654609556, -781.6655349774603, -344.6792826021897, -810.0613391300767, -1125.2953823079954, -783.2530426377824, -634.6787179599753, -554.6185410591037, -631.7880155396293, -960.9718463755061, -1005.9405285768859, -55.66373346491794, -912.8510624429036, -880.3603235197004, -998.2838163106446, -518.4836906057853, -473.9955199833186, -691.379594816852, -392.18721320069125, -245.6641392684415, -876.2300144163868, -1164.1370234817487, -521.7547667794365, -369.0683929429752, -1037.5490098165606, -293.3489077044732, -783.9611593606237, -1006.569141916416, -254.25375410660945, -881.3561883471007, -1021.8770260748423, -635.4390016827208, -626.0367893959566, -883.7786125438749, -1099.922363345019, -341.0110320078645, -20.753956485755808, -1233.33692694034, -1030.742749829073, -815.3757129371778, -826.1065473711266, -438.73300280007663, -1130.9685045893184, -201.56072128516567, -553.817722380229, -814.0762432541993, -249.93167705969097, -699.9833780176658, -946.9142467359534, -642.9659098852134, -486.57498540555054, -697.9562058757078], "episode_lengths": [150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 57, 150, 150, 150, 118, 150, 150, 106, 81, 150, 150, 150, 107, 150, 87, 150, 150, 76, 150, 150, 150, 150, 150, 150, 94, 43, 150, 150, 150, 150, 150, 150, 74, 150, 150, 82, 134, 150, 150, 150, 150], "policy_policy_0_reward": [-410.6788056315244, -163.97172330701804, -1188.3707683110629, -804.6220685540162, -1068.750955666459, -466.9845400339827, -821.3453323007243, -812.7541663695063, -787.8361646886843, -750.8130010884494, -370.51462311845046, -838.4823545725936, -334.0809197315277, -924.9112229617241, -132.93735775407, -964.1496588401648, -901.2532732821438, -736.501849549409, -871.6543194566758, -799.949205766924, -197.61805956420946, -967.4628879743608, -795.393654609556, -781.6655349774603, -344.6792826021897, -810.0613391300767, -1125.2953823079954, -783.2530426377824, -634.6787179599753, -554.6185410591037, -631.7880155396293, -960.9718463755061, -1005.9405285768859, -55.66373346491794, -912.8510624429036, -880.3603235197004, -998.2838163106446, -518.4836906057853, -473.9955199833186, -691.379594816852, -392.18721320069125, -245.6641392684415, -876.2300144163868, -1164.1370234817487, -521.7547667794365, -369.0683929429752, -1037.5490098165606, -293.3489077044732, -783.9611593606237, -1006.569141916416, -254.25375410660945, -881.3561883471007, -1021.8770260748423, -635.4390016827208, -626.0367893959566, -883.7786125438749, -1099.922363345019, -341.0110320078645, -20.753956485755808, -1233.33692694034, -1030.742749829073, -815.3757129371778, -826.1065473711266, -438.73300280007663, -1130.9685045893184, -201.56072128516567, -553.817722380229, -814.0762432541993, -249.93167705969097, -699.9833780176658, -946.9142467359534, -642.9659098852134, -486.57498540555054, -697.9562058757078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620671749026691, "mean_inference_ms": 1.6581554602527184, "mean_action_processing_ms": 0.27877965350908873, "mean_env_wait_ms": 2.9500179176344465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013213222091262406, "StateBufferConnector_ms": 0.008262814702214422, "ViewRequirementAgentConnector_ms": 0.18275782868668838}, "num_episodes": 26, "episode_return_max": -20.753956485755808, "episode_return_min": -1233.33692694034, "episode_return_mean": -695.9317555768642, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.80010866459, "num_env_steps_trained_throughput_per_sec": 300.80010866459, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13326.09, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13326.019, "sample_time_ms": 1005.074, "learn_time_ms": 12245.949, "learn_throughput": 326.639, "synch_weights_time_ms": 74.138}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00007", "date": "2024-08-03_10-54-20", "timestamp": 1722662660, "time_this_iter_s": 13.311519622802734, "time_total_s": 40.01533007621765, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010a7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 40.01533007621765, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.411111111111111, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.892201670631766, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.179286166528861, "policy_loss": -0.0063962688766575106, "vf_loss": 8.184598907331626, "vf_explained_var": 0.3423029993350307, "kl": 0.012622923324033763, "entropy": 1.4410444674392542, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -20.753956485755808, "episode_reward_min": -1233.33692694034, "episode_reward_mean": -719.0826040395721, "episode_len_mean": 138.38, "episode_media": {}, "episodes_timesteps_total": 13838, "policy_reward_min": {"policy_0": -1233.33692694034}, "policy_reward_max": {"policy_0": -20.753956485755808}, "policy_reward_mean": {"policy_0": -719.0826040395721}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-804.6220685540162, -1068.750955666459, -466.9845400339827, -821.3453323007243, -812.7541663695063, -787.8361646886843, -750.8130010884494, -370.51462311845046, -838.4823545725936, -334.0809197315277, -924.9112229617241, -132.93735775407, -964.1496588401648, -901.2532732821438, -736.501849549409, -871.6543194566758, -799.949205766924, -197.61805956420946, -967.4628879743608, -795.393654609556, -781.6655349774603, -344.6792826021897, -810.0613391300767, -1125.2953823079954, -783.2530426377824, -634.6787179599753, -554.6185410591037, -631.7880155396293, -960.9718463755061, -1005.9405285768859, -55.66373346491794, -912.8510624429036, -880.3603235197004, -998.2838163106446, -518.4836906057853, -473.9955199833186, -691.379594816852, -392.18721320069125, -245.6641392684415, -876.2300144163868, -1164.1370234817487, -521.7547667794365, -369.0683929429752, -1037.5490098165606, -293.3489077044732, -783.9611593606237, -1006.569141916416, -254.25375410660945, -881.3561883471007, -1021.8770260748423, -635.4390016827208, -626.0367893959566, -883.7786125438749, -1099.922363345019, -341.0110320078645, -20.753956485755808, -1233.33692694034, -1030.742749829073, -815.3757129371778, -826.1065473711266, -438.73300280007663, -1130.9685045893184, -201.56072128516567, -553.817722380229, -814.0762432541993, -249.93167705969097, -699.9833780176658, -946.9142467359534, -642.9659098852134, -486.57498540555054, -697.9562058757078, -899.4292584094328, -569.1474632584129, -850.1648701259096, -912.6808254405181, -175.24755350951483, -999.8850652722044, -879.5972055489909, -582.897959151216, -1133.0872021220914, -1225.3060967534711, -679.3703297115452, -509.45989761603465, -867.4466431759271, -1156.6256403272282, -1216.7805654713527, -936.9261129272712, -306.98950195799466, -703.3917774210614, -253.3259452904671, -803.9783093277073, -718.853661752396, -75.10516328943868, -817.1153869591078, -977.6702217912514, -900.3457084127531, -920.5936311192474, -745.0264584203868, -584.581088552469, -771.3022454034485], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 57, 150, 150, 150, 118, 150, 150, 106, 81, 150, 150, 150, 107, 150, 87, 150, 150, 76, 150, 150, 150, 150, 150, 150, 94, 43, 150, 150, 150, 150, 150, 150, 74, 150, 150, 82, 134, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 95, 150, 150, 52, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-804.6220685540162, -1068.750955666459, -466.9845400339827, -821.3453323007243, -812.7541663695063, -787.8361646886843, -750.8130010884494, -370.51462311845046, -838.4823545725936, -334.0809197315277, -924.9112229617241, -132.93735775407, -964.1496588401648, -901.2532732821438, -736.501849549409, -871.6543194566758, -799.949205766924, -197.61805956420946, -967.4628879743608, -795.393654609556, -781.6655349774603, -344.6792826021897, -810.0613391300767, -1125.2953823079954, -783.2530426377824, -634.6787179599753, -554.6185410591037, -631.7880155396293, -960.9718463755061, -1005.9405285768859, -55.66373346491794, -912.8510624429036, -880.3603235197004, -998.2838163106446, -518.4836906057853, -473.9955199833186, -691.379594816852, -392.18721320069125, -245.6641392684415, -876.2300144163868, -1164.1370234817487, -521.7547667794365, -369.0683929429752, -1037.5490098165606, -293.3489077044732, -783.9611593606237, -1006.569141916416, -254.25375410660945, -881.3561883471007, -1021.8770260748423, -635.4390016827208, -626.0367893959566, -883.7786125438749, -1099.922363345019, -341.0110320078645, -20.753956485755808, -1233.33692694034, -1030.742749829073, -815.3757129371778, -826.1065473711266, -438.73300280007663, -1130.9685045893184, -201.56072128516567, -553.817722380229, -814.0762432541993, -249.93167705969097, -699.9833780176658, -946.9142467359534, -642.9659098852134, -486.57498540555054, -697.9562058757078, -899.4292584094328, -569.1474632584129, -850.1648701259096, -912.6808254405181, -175.24755350951483, -999.8850652722044, -879.5972055489909, -582.897959151216, -1133.0872021220914, -1225.3060967534711, -679.3703297115452, -509.45989761603465, -867.4466431759271, -1156.6256403272282, -1216.7805654713527, -936.9261129272712, -306.98950195799466, -703.3917774210614, -253.3259452904671, -803.9783093277073, -718.853661752396, -75.10516328943868, -817.1153869591078, -977.6702217912514, -900.3457084127531, -920.5936311192474, -745.0264584203868, -584.581088552469, -771.3022454034485]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5610395245619806, "mean_inference_ms": 1.6623750384157443, "mean_action_processing_ms": 0.27933653916709, "mean_env_wait_ms": 2.955089175477397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014121770858764648, "StateBufferConnector_ms": 0.00854945182800293, "ViewRequirementAgentConnector_ms": 0.18880796432495117}, "num_episodes": 29, "episode_return_max": -20.753956485755808, "episode_return_min": -1233.33692694034, "episode_return_mean": -719.0826040395721, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.896711022456, "num_env_steps_trained_throughput_per_sec": 296.896711022456, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13362.746, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13362.674, "sample_time_ms": 1011.342, "learn_time_ms": 12278.758, "learn_throughput": 325.766, "synch_weights_time_ms": 71.739}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00007", "date": "2024-08-03_10-54-33", "timestamp": 1722662673, "time_this_iter_s": 13.486037492752075, "time_total_s": 53.50136756896973, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c576560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 53.50136756896973, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.035, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.073743898173174, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.114924656351407, "policy_loss": -0.012101471133064479, "vf_loss": 7.125060414771239, "vf_explained_var": 0.6469945513953765, "kl": 0.017132967284154196, "entropy": 1.460901371265451, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -20.753956485755808, "episode_reward_min": -1233.33692694034, "episode_reward_mean": -735.119107151658, "episode_len_mean": 135.87, "episode_media": {}, "episodes_timesteps_total": 13587, "policy_reward_min": {"policy_0": -1233.33692694034}, "policy_reward_max": {"policy_0": -20.753956485755808}, "policy_reward_mean": {"policy_0": -735.119107151658}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-960.9718463755061, -1005.9405285768859, -55.66373346491794, -912.8510624429036, -880.3603235197004, -998.2838163106446, -518.4836906057853, -473.9955199833186, -691.379594816852, -392.18721320069125, -245.6641392684415, -876.2300144163868, -1164.1370234817487, -521.7547667794365, -369.0683929429752, -1037.5490098165606, -293.3489077044732, -783.9611593606237, -1006.569141916416, -254.25375410660945, -881.3561883471007, -1021.8770260748423, -635.4390016827208, -626.0367893959566, -883.7786125438749, -1099.922363345019, -341.0110320078645, -20.753956485755808, -1233.33692694034, -1030.742749829073, -815.3757129371778, -826.1065473711266, -438.73300280007663, -1130.9685045893184, -201.56072128516567, -553.817722380229, -814.0762432541993, -249.93167705969097, -699.9833780176658, -946.9142467359534, -642.9659098852134, -486.57498540555054, -697.9562058757078, -899.4292584094328, -569.1474632584129, -850.1648701259096, -912.6808254405181, -175.24755350951483, -999.8850652722044, -879.5972055489909, -582.897959151216, -1133.0872021220914, -1225.3060967534711, -679.3703297115452, -509.45989761603465, -867.4466431759271, -1156.6256403272282, -1216.7805654713527, -936.9261129272712, -306.98950195799466, -703.3917774210614, -253.3259452904671, -803.9783093277073, -718.853661752396, -75.10516328943868, -817.1153869591078, -977.6702217912514, -900.3457084127531, -920.5936311192474, -745.0264584203868, -584.581088552469, -771.3022454034485, -804.3867062906526, -75.77523453663346, -659.834638524847, -1039.2512304672903, -124.788241018824, -415.49299296152554, -808.8410962707036, -1012.0443982741067, -498.2853245698508, -1029.626324390372, -1065.2337175411942, -949.8508871869338, -983.0054533875624, -426.4126548292051, -1156.3462440484138, -1202.177303127596, -126.57159203133591, -1184.0085191337378, -348.1413057285512, -987.9422836309451, -872.9440697588119, -925.1492677719667, -1046.6089257661447, -1037.1932955134507, -808.2921838830622, -164.9266139737892, -1176.9336050697977, -687.6416736191339], "episode_lengths": [150, 150, 57, 150, 150, 150, 118, 150, 150, 106, 81, 150, 150, 150, 107, 150, 87, 150, 150, 76, 150, 150, 150, 150, 150, 150, 94, 43, 150, 150, 150, 150, 150, 150, 74, 150, 150, 82, 134, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 95, 150, 150, 52, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 101, 134, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 82, 150, 102, 150, 150, 150, 150, 150, 150, 74, 150, 150], "policy_policy_0_reward": [-960.9718463755061, -1005.9405285768859, -55.66373346491794, -912.8510624429036, -880.3603235197004, -998.2838163106446, -518.4836906057853, -473.9955199833186, -691.379594816852, -392.18721320069125, -245.6641392684415, -876.2300144163868, -1164.1370234817487, -521.7547667794365, -369.0683929429752, -1037.5490098165606, -293.3489077044732, -783.9611593606237, -1006.569141916416, -254.25375410660945, -881.3561883471007, -1021.8770260748423, -635.4390016827208, -626.0367893959566, -883.7786125438749, -1099.922363345019, -341.0110320078645, -20.753956485755808, -1233.33692694034, -1030.742749829073, -815.3757129371778, -826.1065473711266, -438.73300280007663, -1130.9685045893184, -201.56072128516567, -553.817722380229, -814.0762432541993, -249.93167705969097, -699.9833780176658, -946.9142467359534, -642.9659098852134, -486.57498540555054, -697.9562058757078, -899.4292584094328, -569.1474632584129, -850.1648701259096, -912.6808254405181, -175.24755350951483, -999.8850652722044, -879.5972055489909, -582.897959151216, -1133.0872021220914, -1225.3060967534711, -679.3703297115452, -509.45989761603465, -867.4466431759271, -1156.6256403272282, -1216.7805654713527, -936.9261129272712, -306.98950195799466, -703.3917774210614, -253.3259452904671, -803.9783093277073, -718.853661752396, -75.10516328943868, -817.1153869591078, -977.6702217912514, -900.3457084127531, -920.5936311192474, -745.0264584203868, -584.581088552469, -771.3022454034485, -804.3867062906526, -75.77523453663346, -659.834638524847, -1039.2512304672903, -124.788241018824, -415.49299296152554, -808.8410962707036, -1012.0443982741067, -498.2853245698508, -1029.626324390372, -1065.2337175411942, -949.8508871869338, -983.0054533875624, -426.4126548292051, -1156.3462440484138, -1202.177303127596, -126.57159203133591, -1184.0085191337378, -348.1413057285512, -987.9422836309451, -872.9440697588119, -925.1492677719667, -1046.6089257661447, -1037.1932955134507, -808.2921838830622, -164.9266139737892, -1176.9336050697977, -687.6416736191339]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5596732636198882, "mean_inference_ms": 1.6665173883024749, "mean_action_processing_ms": 0.28006158683692894, "mean_env_wait_ms": 2.9642420980643913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014154195785522461, "StateBufferConnector_ms": 0.00872802734375, "ViewRequirementAgentConnector_ms": 0.19222736358642578}, "num_episodes": 28, "episode_return_max": -20.753956485755808, "episode_return_min": -1233.33692694034, "episode_return_mean": -735.119107151658, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.0237012345063, "num_env_steps_trained_throughput_per_sec": 303.0237012345063, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13330.257, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13330.186, "sample_time_ms": 1008.95, "learn_time_ms": 12250.525, "learn_throughput": 326.517, "synch_weights_time_ms": 69.872}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00007", "date": "2024-08-03_10-54-46", "timestamp": 1722662686, "time_this_iter_s": 13.21328353881836, "time_total_s": 66.71465110778809, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5217e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 66.71465110778809, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.716666666666665, "ram_util_percent": 27.694444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65.41305726766586, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.8750816129148005, "policy_loss": -0.011546146072214469, "vf_loss": 4.884226779143016, "vf_explained_var": 0.8807090076928338, "kl": 0.01876503958919784, "entropy": 1.3520167386780182, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -43.606552601465715, "episode_reward_min": -1225.3060967534711, "episode_reward_mean": -733.9497191948176, "episode_len_mean": 138.38, "episode_media": {}, "episodes_timesteps_total": 13838, "policy_reward_min": {"policy_0": -1225.3060967534711}, "policy_reward_max": {"policy_0": -43.606552601465715}, "policy_reward_mean": {"policy_0": -733.9497191948176}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-826.1065473711266, -438.73300280007663, -1130.9685045893184, -201.56072128516567, -553.817722380229, -814.0762432541993, -249.93167705969097, -699.9833780176658, -946.9142467359534, -642.9659098852134, -486.57498540555054, -697.9562058757078, -899.4292584094328, -569.1474632584129, -850.1648701259096, -912.6808254405181, -175.24755350951483, -999.8850652722044, -879.5972055489909, -582.897959151216, -1133.0872021220914, -1225.3060967534711, -679.3703297115452, -509.45989761603465, -867.4466431759271, -1156.6256403272282, -1216.7805654713527, -936.9261129272712, -306.98950195799466, -703.3917774210614, -253.3259452904671, -803.9783093277073, -718.853661752396, -75.10516328943868, -817.1153869591078, -977.6702217912514, -900.3457084127531, -920.5936311192474, -745.0264584203868, -584.581088552469, -771.3022454034485, -804.3867062906526, -75.77523453663346, -659.834638524847, -1039.2512304672903, -124.788241018824, -415.49299296152554, -808.8410962707036, -1012.0443982741067, -498.2853245698508, -1029.626324390372, -1065.2337175411942, -949.8508871869338, -983.0054533875624, -426.4126548292051, -1156.3462440484138, -1202.177303127596, -126.57159203133591, -1184.0085191337378, -348.1413057285512, -987.9422836309451, -872.9440697588119, -925.1492677719667, -1046.6089257661447, -1037.1932955134507, -808.2921838830622, -164.9266139737892, -1176.9336050697977, -687.6416736191339, -714.4594281484543, -138.56895096542806, -638.3425108313312, -839.56512836987, -477.0718176565641, -1067.6465926903663, -350.525630401582, -811.8549618609379, -984.8988335050161, -860.0186030034781, -43.606552601465715, -858.7171454436602, -1169.4166262117712, -324.99707121839623, -432.5661222024463, -730.0895669564013, -632.4350586540611, -202.54103544599388, -704.8773420260243, -842.8804923837554, -844.6866912068382, -964.5510298281006, -764.9668174825424, -1097.394765280014, -877.8190776175041, -949.674760420841, -1125.4033720439515, -280.26056849102326, -255.9207292254042, -999.509074979434, -930.0788458439164], "episode_lengths": [150, 150, 150, 74, 150, 150, 82, 134, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 95, 150, 150, 52, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 101, 134, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 82, 150, 102, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 103, 150, 150, 150, 150, 96, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 84, 150, 150], "policy_policy_0_reward": [-826.1065473711266, -438.73300280007663, -1130.9685045893184, -201.56072128516567, -553.817722380229, -814.0762432541993, -249.93167705969097, -699.9833780176658, -946.9142467359534, -642.9659098852134, -486.57498540555054, -697.9562058757078, -899.4292584094328, -569.1474632584129, -850.1648701259096, -912.6808254405181, -175.24755350951483, -999.8850652722044, -879.5972055489909, -582.897959151216, -1133.0872021220914, -1225.3060967534711, -679.3703297115452, -509.45989761603465, -867.4466431759271, -1156.6256403272282, -1216.7805654713527, -936.9261129272712, -306.98950195799466, -703.3917774210614, -253.3259452904671, -803.9783093277073, -718.853661752396, -75.10516328943868, -817.1153869591078, -977.6702217912514, -900.3457084127531, -920.5936311192474, -745.0264584203868, -584.581088552469, -771.3022454034485, -804.3867062906526, -75.77523453663346, -659.834638524847, -1039.2512304672903, -124.788241018824, -415.49299296152554, -808.8410962707036, -1012.0443982741067, -498.2853245698508, -1029.626324390372, -1065.2337175411942, -949.8508871869338, -983.0054533875624, -426.4126548292051, -1156.3462440484138, -1202.177303127596, -126.57159203133591, -1184.0085191337378, -348.1413057285512, -987.9422836309451, -872.9440697588119, -925.1492677719667, -1046.6089257661447, -1037.1932955134507, -808.2921838830622, -164.9266139737892, -1176.9336050697977, -687.6416736191339, -714.4594281484543, -138.56895096542806, -638.3425108313312, -839.56512836987, -477.0718176565641, -1067.6465926903663, -350.525630401582, -811.8549618609379, -984.8988335050161, -860.0186030034781, -43.606552601465715, -858.7171454436602, -1169.4166262117712, -324.99707121839623, -432.5661222024463, -730.0895669564013, -632.4350586540611, -202.54103544599388, -704.8773420260243, -842.8804923837554, -844.6866912068382, -964.5510298281006, -764.9668174825424, -1097.394765280014, -877.8190776175041, -949.674760420841, -1125.4033720439515, -280.26056849102326, -255.9207292254042, -999.509074979434, -930.0788458439164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5596529945771772, "mean_inference_ms": 1.6728912862273935, "mean_action_processing_ms": 0.2808630427815996, "mean_env_wait_ms": 2.968156394923664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014493942260742188, "StateBufferConnector_ms": 0.008767366409301758, "ViewRequirementAgentConnector_ms": 0.19397759437561035}, "num_episodes": 31, "episode_return_max": -43.606552601465715, "episode_return_min": -1225.3060967534711, "episode_return_mean": -733.9497191948176, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.0877067337797, "num_env_steps_trained_throughput_per_sec": 297.0877067337797, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13352.556, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13352.485, "sample_time_ms": 1009.906, "learn_time_ms": 12272.662, "learn_throughput": 325.928, "synch_weights_time_ms": 69.077}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00007", "date": "2024-08-03_10-55-00", "timestamp": 1722662700, "time_this_iter_s": 13.476531744003296, "time_total_s": 80.19118285179138, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d2950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 80.19118285179138, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.944999999999999, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 101.27353302041689, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.8488489537189405, "policy_loss": -0.011828720721435577, "vf_loss": 3.858542434622844, "vf_explained_var": 0.9398605146134893, "kl": 0.01793888449894136, "entropy": 1.4525336543718974, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -43.606552601465715, "episode_reward_min": -1307.3758875426333, "episode_reward_mean": -728.8580802172365, "episode_len_mean": 140.1, "episode_media": {}, "episodes_timesteps_total": 14010, "policy_reward_min": {"policy_0": -1307.3758875426333}, "policy_reward_max": {"policy_0": -43.606552601465715}, "policy_reward_mean": {"policy_0": -728.8580802172365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-253.3259452904671, -803.9783093277073, -718.853661752396, -75.10516328943868, -817.1153869591078, -977.6702217912514, -900.3457084127531, -920.5936311192474, -745.0264584203868, -584.581088552469, -771.3022454034485, -804.3867062906526, -75.77523453663346, -659.834638524847, -1039.2512304672903, -124.788241018824, -415.49299296152554, -808.8410962707036, -1012.0443982741067, -498.2853245698508, -1029.626324390372, -1065.2337175411942, -949.8508871869338, -983.0054533875624, -426.4126548292051, -1156.3462440484138, -1202.177303127596, -126.57159203133591, -1184.0085191337378, -348.1413057285512, -987.9422836309451, -872.9440697588119, -925.1492677719667, -1046.6089257661447, -1037.1932955134507, -808.2921838830622, -164.9266139737892, -1176.9336050697977, -687.6416736191339, -714.4594281484543, -138.56895096542806, -638.3425108313312, -839.56512836987, -477.0718176565641, -1067.6465926903663, -350.525630401582, -811.8549618609379, -984.8988335050161, -860.0186030034781, -43.606552601465715, -858.7171454436602, -1169.4166262117712, -324.99707121839623, -432.5661222024463, -730.0895669564013, -632.4350586540611, -202.54103544599388, -704.8773420260243, -842.8804923837554, -844.6866912068382, -964.5510298281006, -764.9668174825424, -1097.394765280014, -877.8190776175041, -949.674760420841, -1125.4033720439515, -280.26056849102326, -255.9207292254042, -999.509074979434, -930.0788458439164, -688.2512005627816, -965.8996515308595, -1032.8856109566134, -829.8514683828934, -1042.3202256783186, -817.6225561155609, -656.4405223817488, -438.1390802397879, -644.6291133933854, -817.9186824560506, -814.2328204494618, -448.02002680037026, -790.2947852652346, -1050.0677834266494, -248.0767772686511, -164.4404722847038, -487.9173493721419, -1174.1114293988162, -1307.3758875426333, -739.7041920193059, -418.6588161201598, -492.50276368134416, -290.1531643322613, -1154.9166039098507, -532.3664799252992, -886.0648127440273, -736.3199911708606, -726.8021391761633, -729.4676238849552, -659.4071846310876], "episode_lengths": [95, 150, 150, 52, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 101, 134, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 82, 150, 102, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 103, 150, 150, 150, 150, 96, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 95, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-253.3259452904671, -803.9783093277073, -718.853661752396, -75.10516328943868, -817.1153869591078, -977.6702217912514, -900.3457084127531, -920.5936311192474, -745.0264584203868, -584.581088552469, -771.3022454034485, -804.3867062906526, -75.77523453663346, -659.834638524847, -1039.2512304672903, -124.788241018824, -415.49299296152554, -808.8410962707036, -1012.0443982741067, -498.2853245698508, -1029.626324390372, -1065.2337175411942, -949.8508871869338, -983.0054533875624, -426.4126548292051, -1156.3462440484138, -1202.177303127596, -126.57159203133591, -1184.0085191337378, -348.1413057285512, -987.9422836309451, -872.9440697588119, -925.1492677719667, -1046.6089257661447, -1037.1932955134507, -808.2921838830622, -164.9266139737892, -1176.9336050697977, -687.6416736191339, -714.4594281484543, -138.56895096542806, -638.3425108313312, -839.56512836987, -477.0718176565641, -1067.6465926903663, -350.525630401582, -811.8549618609379, -984.8988335050161, -860.0186030034781, -43.606552601465715, -858.7171454436602, -1169.4166262117712, -324.99707121839623, -432.5661222024463, -730.0895669564013, -632.4350586540611, -202.54103544599388, -704.8773420260243, -842.8804923837554, -844.6866912068382, -964.5510298281006, -764.9668174825424, -1097.394765280014, -877.8190776175041, -949.674760420841, -1125.4033720439515, -280.26056849102326, -255.9207292254042, -999.509074979434, -930.0788458439164, -688.2512005627816, -965.8996515308595, -1032.8856109566134, -829.8514683828934, -1042.3202256783186, -817.6225561155609, -656.4405223817488, -438.1390802397879, -644.6291133933854, -817.9186824560506, -814.2328204494618, -448.02002680037026, -790.2947852652346, -1050.0677834266494, -248.0767772686511, -164.4404722847038, -487.9173493721419, -1174.1114293988162, -1307.3758875426333, -739.7041920193059, -418.6588161201598, -492.50276368134416, -290.1531643322613, -1154.9166039098507, -532.3664799252992, -886.0648127440273, -736.3199911708606, -726.8021391761633, -729.4676238849552, -659.4071846310876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5600917833430336, "mean_inference_ms": 1.6766105134003055, "mean_action_processing_ms": 0.2808347572177761, "mean_env_wait_ms": 2.968931781725176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014141321182250977, "StateBufferConnector_ms": 0.008496999740600586, "ViewRequirementAgentConnector_ms": 0.1988844871520996}, "num_episodes": 30, "episode_return_max": -43.606552601465715, "episode_return_min": -1307.3758875426333, "episode_return_mean": -728.8580802172365, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.6399659385779, "num_env_steps_trained_throughput_per_sec": 312.6399659385779, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13272.803, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13272.731, "sample_time_ms": 1015.778, "learn_time_ms": 12187.958, "learn_throughput": 328.193, "synch_weights_time_ms": 68.166}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00007", "date": "2024-08-03_10-55-13", "timestamp": 1722662713, "time_this_iter_s": 12.805625438690186, "time_total_s": 92.99680829048157, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c574d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 92.99680829048157, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.761111111111111, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.59970385432243, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.223910925537348, "policy_loss": -0.013091428017166134, "vf_loss": 4.234760611255964, "vf_explained_var": 0.9609008106713494, "kl": 0.018382644865323535, "entropy": 1.4347721497217814, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -43.606552601465715, "episode_reward_min": -1307.3758875426333, "episode_reward_mean": -680.3327188534128, "episode_len_mean": 136.67, "episode_media": {}, "episodes_timesteps_total": 13667, "policy_reward_min": {"policy_0": -1307.3758875426333}, "policy_reward_max": {"policy_0": -43.606552601465715}, "policy_reward_mean": {"policy_0": -680.3327188534128}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-348.1413057285512, -987.9422836309451, -872.9440697588119, -925.1492677719667, -1046.6089257661447, -1037.1932955134507, -808.2921838830622, -164.9266139737892, -1176.9336050697977, -687.6416736191339, -714.4594281484543, -138.56895096542806, -638.3425108313312, -839.56512836987, -477.0718176565641, -1067.6465926903663, -350.525630401582, -811.8549618609379, -984.8988335050161, -860.0186030034781, -43.606552601465715, -858.7171454436602, -1169.4166262117712, -324.99707121839623, -432.5661222024463, -730.0895669564013, -632.4350586540611, -202.54103544599388, -704.8773420260243, -842.8804923837554, -844.6866912068382, -964.5510298281006, -764.9668174825424, -1097.394765280014, -877.8190776175041, -949.674760420841, -1125.4033720439515, -280.26056849102326, -255.9207292254042, -999.509074979434, -930.0788458439164, -688.2512005627816, -965.8996515308595, -1032.8856109566134, -829.8514683828934, -1042.3202256783186, -817.6225561155609, -656.4405223817488, -438.1390802397879, -644.6291133933854, -817.9186824560506, -814.2328204494618, -448.02002680037026, -790.2947852652346, -1050.0677834266494, -248.0767772686511, -164.4404722847038, -487.9173493721419, -1174.1114293988162, -1307.3758875426333, -739.7041920193059, -418.6588161201598, -492.50276368134416, -290.1531643322613, -1154.9166039098507, -532.3664799252992, -886.0648127440273, -736.3199911708606, -726.8021391761633, -729.4676238849552, -659.4071846310876, -1207.6513775143628, -963.2622059720414, -676.574990725582, -85.69982107013507, -153.09665239446738, -1024.394576895514, -739.0255042493702, -1117.15761592926, -158.2028120593133, -110.54160820423625, -298.0998753745218, -51.94157466566016, -962.796440339857, -168.3613386946919, -725.2540302916799, -859.1733261854654, -713.774410644884, -905.0687952698033, -124.96453017299763, -985.7429982277864, -183.1829335667451, -698.7932315880755, -137.16697347359744, -985.1588621446172, -1279.7185626418348, -51.538341227891664, -335.99522840188996, -115.10559149617796, -459.8500331046029], "episode_lengths": [102, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 103, 150, 150, 150, 150, 96, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 95, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 56, 110, 150, 150, 150, 68, 70, 150, 53, 150, 93, 150, 150, 150, 150, 83, 150, 150, 150, 72, 150, 150, 67, 150, 95, 150], "policy_policy_0_reward": [-348.1413057285512, -987.9422836309451, -872.9440697588119, -925.1492677719667, -1046.6089257661447, -1037.1932955134507, -808.2921838830622, -164.9266139737892, -1176.9336050697977, -687.6416736191339, -714.4594281484543, -138.56895096542806, -638.3425108313312, -839.56512836987, -477.0718176565641, -1067.6465926903663, -350.525630401582, -811.8549618609379, -984.8988335050161, -860.0186030034781, -43.606552601465715, -858.7171454436602, -1169.4166262117712, -324.99707121839623, -432.5661222024463, -730.0895669564013, -632.4350586540611, -202.54103544599388, -704.8773420260243, -842.8804923837554, -844.6866912068382, -964.5510298281006, -764.9668174825424, -1097.394765280014, -877.8190776175041, -949.674760420841, -1125.4033720439515, -280.26056849102326, -255.9207292254042, -999.509074979434, -930.0788458439164, -688.2512005627816, -965.8996515308595, -1032.8856109566134, -829.8514683828934, -1042.3202256783186, -817.6225561155609, -656.4405223817488, -438.1390802397879, -644.6291133933854, -817.9186824560506, -814.2328204494618, -448.02002680037026, -790.2947852652346, -1050.0677834266494, -248.0767772686511, -164.4404722847038, -487.9173493721419, -1174.1114293988162, -1307.3758875426333, -739.7041920193059, -418.6588161201598, -492.50276368134416, -290.1531643322613, -1154.9166039098507, -532.3664799252992, -886.0648127440273, -736.3199911708606, -726.8021391761633, -729.4676238849552, -659.4071846310876, -1207.6513775143628, -963.2622059720414, -676.574990725582, -85.69982107013507, -153.09665239446738, -1024.394576895514, -739.0255042493702, -1117.15761592926, -158.2028120593133, -110.54160820423625, -298.0998753745218, -51.94157466566016, -962.796440339857, -168.3613386946919, -725.2540302916799, -859.1733261854654, -713.774410644884, -905.0687952698033, -124.96453017299763, -985.7429982277864, -183.1829335667451, -698.7932315880755, -137.16697347359744, -985.1588621446172, -1279.7185626418348, -51.538341227891664, -335.99522840188996, -115.10559149617796, -459.8500331046029]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5594965683029122, "mean_inference_ms": 1.6796269501160237, "mean_action_processing_ms": 0.2806333349591937, "mean_env_wait_ms": 2.971556357185946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01373910903930664, "StateBufferConnector_ms": 0.008219003677368164, "ViewRequirementAgentConnector_ms": 0.19826054573059082}, "num_episodes": 29, "episode_return_max": -43.606552601465715, "episode_return_min": -1307.3758875426333, "episode_return_mean": -680.3327188534128, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.943717357017, "num_env_steps_trained_throughput_per_sec": 358.943717357017, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13006.68, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13006.609, "sample_time_ms": 1018.165, "learn_time_ms": 11922.47, "learn_throughput": 335.501, "synch_weights_time_ms": 65.158}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00007", "date": "2024-08-03_10-55-24", "timestamp": 1722662724, "time_this_iter_s": 11.156188249588013, "time_total_s": 104.15299654006958, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d2d40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 104.15299654006958, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 14.600000000000001, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 161.08283421198527, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.779657357558608, "policy_loss": -0.010892162952222862, "vf_loss": 3.7890162686506907, "vf_explained_var": 0.9672108062232534, "kl": 0.015194891291078724, "entropy": 1.5057164287815492, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -51.538341227891664, "episode_reward_min": -1307.3758875426333, "episode_reward_mean": -702.391251361868, "episode_len_mean": 137.31, "episode_media": {}, "episodes_timesteps_total": 13731, "policy_reward_min": {"policy_0": -1307.3758875426333}, "policy_reward_max": {"policy_0": -51.538341227891664}, "policy_reward_mean": {"policy_0": -702.391251361868}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-704.8773420260243, -842.8804923837554, -844.6866912068382, -964.5510298281006, -764.9668174825424, -1097.394765280014, -877.8190776175041, -949.674760420841, -1125.4033720439515, -280.26056849102326, -255.9207292254042, -999.509074979434, -930.0788458439164, -688.2512005627816, -965.8996515308595, -1032.8856109566134, -829.8514683828934, -1042.3202256783186, -817.6225561155609, -656.4405223817488, -438.1390802397879, -644.6291133933854, -817.9186824560506, -814.2328204494618, -448.02002680037026, -790.2947852652346, -1050.0677834266494, -248.0767772686511, -164.4404722847038, -487.9173493721419, -1174.1114293988162, -1307.3758875426333, -739.7041920193059, -418.6588161201598, -492.50276368134416, -290.1531643322613, -1154.9166039098507, -532.3664799252992, -886.0648127440273, -736.3199911708606, -726.8021391761633, -729.4676238849552, -659.4071846310876, -1207.6513775143628, -963.2622059720414, -676.574990725582, -85.69982107013507, -153.09665239446738, -1024.394576895514, -739.0255042493702, -1117.15761592926, -158.2028120593133, -110.54160820423625, -298.0998753745218, -51.94157466566016, -962.796440339857, -168.3613386946919, -725.2540302916799, -859.1733261854654, -713.774410644884, -905.0687952698033, -124.96453017299763, -985.7429982277864, -183.1829335667451, -698.7932315880755, -137.16697347359744, -985.1588621446172, -1279.7185626418348, -51.538341227891664, -335.99522840188996, -115.10559149617796, -459.8500331046029, -747.0327980626756, -594.7805710085337, -185.12817293932542, -577.0151752156399, -1160.9137866551102, -1131.492097782805, -989.4404441225367, -873.4017554793978, -763.9182390579598, -879.9619407629633, -589.3549003769062, -1170.8187797670012, -369.85981694880076, -1006.1661709674809, -240.1133290133052, -283.30268561265086, -870.359935013682, -934.1418033980733, -1136.801537667898, -983.3665406139041, -1230.592058690034, -62.21002774779858, -936.8000053389252, -940.7178867455123, -826.7566021469358, -148.99873081406463, -833.2924082184147, -1072.209911560064], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 95, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 56, 110, 150, 150, 150, 68, 70, 150, 53, 150, 93, 150, 150, 150, 150, 83, 150, 150, 150, 72, 150, 150, 67, 150, 95, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 86, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 74, 150, 150], "policy_policy_0_reward": [-704.8773420260243, -842.8804923837554, -844.6866912068382, -964.5510298281006, -764.9668174825424, -1097.394765280014, -877.8190776175041, -949.674760420841, -1125.4033720439515, -280.26056849102326, -255.9207292254042, -999.509074979434, -930.0788458439164, -688.2512005627816, -965.8996515308595, -1032.8856109566134, -829.8514683828934, -1042.3202256783186, -817.6225561155609, -656.4405223817488, -438.1390802397879, -644.6291133933854, -817.9186824560506, -814.2328204494618, -448.02002680037026, -790.2947852652346, -1050.0677834266494, -248.0767772686511, -164.4404722847038, -487.9173493721419, -1174.1114293988162, -1307.3758875426333, -739.7041920193059, -418.6588161201598, -492.50276368134416, -290.1531643322613, -1154.9166039098507, -532.3664799252992, -886.0648127440273, -736.3199911708606, -726.8021391761633, -729.4676238849552, -659.4071846310876, -1207.6513775143628, -963.2622059720414, -676.574990725582, -85.69982107013507, -153.09665239446738, -1024.394576895514, -739.0255042493702, -1117.15761592926, -158.2028120593133, -110.54160820423625, -298.0998753745218, -51.94157466566016, -962.796440339857, -168.3613386946919, -725.2540302916799, -859.1733261854654, -713.774410644884, -905.0687952698033, -124.96453017299763, -985.7429982277864, -183.1829335667451, -698.7932315880755, -137.16697347359744, -985.1588621446172, -1279.7185626418348, -51.538341227891664, -335.99522840188996, -115.10559149617796, -459.8500331046029, -747.0327980626756, -594.7805710085337, -185.12817293932542, -577.0151752156399, -1160.9137866551102, -1131.492097782805, -989.4404441225367, -873.4017554793978, -763.9182390579598, -879.9619407629633, -589.3549003769062, -1170.8187797670012, -369.85981694880076, -1006.1661709674809, -240.1133290133052, -283.30268561265086, -870.359935013682, -934.1418033980733, -1136.801537667898, -983.3665406139041, -1230.592058690034, -62.21002774779858, -936.8000053389252, -940.7178867455123, -826.7566021469358, -148.99873081406463, -833.2924082184147, -1072.209911560064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5588286174867517, "mean_inference_ms": 1.6829474293780278, "mean_action_processing_ms": 0.28054482435613837, "mean_env_wait_ms": 2.982088280122629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012896060943603516, "StateBufferConnector_ms": 0.008102655410766602, "ViewRequirementAgentConnector_ms": 0.19977855682373047}, "num_episodes": 28, "episode_return_max": -51.538341227891664, "episode_return_min": -1307.3758875426333, "episode_return_mean": -702.391251361868, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.086520880097, "num_env_steps_trained_throughput_per_sec": 355.086520880097, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12813.146, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12813.076, "sample_time_ms": 1016.078, "learn_time_ms": 11731.896, "learn_throughput": 340.951, "synch_weights_time_ms": 64.283}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00007", "date": "2024-08-03_10-55-35", "timestamp": 1722662735, "time_this_iter_s": 11.279984951019287, "time_total_s": 115.43298149108887, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5217e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.43298149108887, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 14.31875, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 158.9529818077882, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.659320814535022, "policy_loss": -0.006660067555397594, "vf_loss": 2.664997799073656, "vf_explained_var": 0.980514265038073, "kl": 0.012350210671502281, "entropy": 1.4869486458599568, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -51.538341227891664, "episode_reward_min": -1307.3758875426333, "episode_reward_mean": -699.2676333566345, "episode_len_mean": 137.06, "episode_media": {}, "episodes_timesteps_total": 13706, "policy_reward_min": {"policy_0": -1307.3758875426333}, "policy_reward_max": {"policy_0": -51.538341227891664}, "policy_reward_mean": {"policy_0": -699.2676333566345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1174.1114293988162, -1307.3758875426333, -739.7041920193059, -418.6588161201598, -492.50276368134416, -290.1531643322613, -1154.9166039098507, -532.3664799252992, -886.0648127440273, -736.3199911708606, -726.8021391761633, -729.4676238849552, -659.4071846310876, -1207.6513775143628, -963.2622059720414, -676.574990725582, -85.69982107013507, -153.09665239446738, -1024.394576895514, -739.0255042493702, -1117.15761592926, -158.2028120593133, -110.54160820423625, -298.0998753745218, -51.94157466566016, -962.796440339857, -168.3613386946919, -725.2540302916799, -859.1733261854654, -713.774410644884, -905.0687952698033, -124.96453017299763, -985.7429982277864, -183.1829335667451, -698.7932315880755, -137.16697347359744, -985.1588621446172, -1279.7185626418348, -51.538341227891664, -335.99522840188996, -115.10559149617796, -459.8500331046029, -747.0327980626756, -594.7805710085337, -185.12817293932542, -577.0151752156399, -1160.9137866551102, -1131.492097782805, -989.4404441225367, -873.4017554793978, -763.9182390579598, -879.9619407629633, -589.3549003769062, -1170.8187797670012, -369.85981694880076, -1006.1661709674809, -240.1133290133052, -283.30268561265086, -870.359935013682, -934.1418033980733, -1136.801537667898, -983.3665406139041, -1230.592058690034, -62.21002774779858, -936.8000053389252, -940.7178867455123, -826.7566021469358, -148.99873081406463, -833.2924082184147, -1072.209911560064, -1215.1782344629983, -507.8930783439088, -869.9970831704859, -136.62812409009797, -877.001522670596, -874.3526631432886, -433.43326545438595, -549.8505638536757, -547.0860790744036, -1063.4207351016257, -967.4105909638774, -1077.095009935173, -626.997490259604, -716.9651534995683, -712.607973246852, -794.4399486532623, -762.5806477750383, -570.2189022034354, -689.749757893961, -1073.1906480178322, -509.5201297675596, -1056.1574325376207, -989.9417268739684, -804.7661936016292, -263.93823320903385, -1201.1793721636623, -631.237596913732, -708.1957449405768, -64.81841425270461, -966.817576796664], "episode_lengths": [150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 56, 110, 150, 150, 150, 68, 70, 150, 53, 150, 93, 150, 150, 150, 150, 83, 150, 150, 150, 72, 150, 150, 67, 150, 95, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 86, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 74, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 133, 150, 150, 150, 62, 150], "policy_policy_0_reward": [-1174.1114293988162, -1307.3758875426333, -739.7041920193059, -418.6588161201598, -492.50276368134416, -290.1531643322613, -1154.9166039098507, -532.3664799252992, -886.0648127440273, -736.3199911708606, -726.8021391761633, -729.4676238849552, -659.4071846310876, -1207.6513775143628, -963.2622059720414, -676.574990725582, -85.69982107013507, -153.09665239446738, -1024.394576895514, -739.0255042493702, -1117.15761592926, -158.2028120593133, -110.54160820423625, -298.0998753745218, -51.94157466566016, -962.796440339857, -168.3613386946919, -725.2540302916799, -859.1733261854654, -713.774410644884, -905.0687952698033, -124.96453017299763, -985.7429982277864, -183.1829335667451, -698.7932315880755, -137.16697347359744, -985.1588621446172, -1279.7185626418348, -51.538341227891664, -335.99522840188996, -115.10559149617796, -459.8500331046029, -747.0327980626756, -594.7805710085337, -185.12817293932542, -577.0151752156399, -1160.9137866551102, -1131.492097782805, -989.4404441225367, -873.4017554793978, -763.9182390579598, -879.9619407629633, -589.3549003769062, -1170.8187797670012, -369.85981694880076, -1006.1661709674809, -240.1133290133052, -283.30268561265086, -870.359935013682, -934.1418033980733, -1136.801537667898, -983.3665406139041, -1230.592058690034, -62.21002774779858, -936.8000053389252, -940.7178867455123, -826.7566021469358, -148.99873081406463, -833.2924082184147, -1072.209911560064, -1215.1782344629983, -507.8930783439088, -869.9970831704859, -136.62812409009797, -877.001522670596, -874.3526631432886, -433.43326545438595, -549.8505638536757, -547.0860790744036, -1063.4207351016257, -967.4105909638774, -1077.095009935173, -626.997490259604, -716.9651534995683, -712.607973246852, -794.4399486532623, -762.5806477750383, -570.2189022034354, -689.749757893961, -1073.1906480178322, -509.5201297675596, -1056.1574325376207, -989.9417268739684, -804.7661936016292, -263.93823320903385, -1201.1793721636623, -631.237596913732, -708.1957449405768, -64.81841425270461, -966.817576796664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5584910757492536, "mean_inference_ms": 1.684455204499383, "mean_action_processing_ms": 0.2802083286451766, "mean_env_wait_ms": 2.9894328415173783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012745857238769531, "StateBufferConnector_ms": 0.00798797607421875, "ViewRequirementAgentConnector_ms": 0.19286680221557617}, "num_episodes": 30, "episode_return_max": -51.538341227891664, "episode_return_min": -1307.3758875426333, "episode_return_mean": -699.2676333566345, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.5446496018317, "num_env_steps_trained_throughput_per_sec": 302.5446496018317, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12853.951, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12853.881, "sample_time_ms": 1018.983, "learn_time_ms": 11770.363, "learn_throughput": 339.837, "synch_weights_time_ms": 63.707}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00007", "date": "2024-08-03_10-55-49", "timestamp": 1722662749, "time_this_iter_s": 13.233879566192627, "time_total_s": 128.6668610572815, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d30a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 128.6668610572815, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.4, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 197.516313658158, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.1687053785969814, "policy_loss": -0.009524004032815963, "vf_loss": 3.175819342707594, "vf_explained_var": 0.9830564823001623, "kl": 0.019543833018936623, "entropy": 1.4987229655186336, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -51.538341227891664, "episode_reward_min": -1331.249338257942, "episode_reward_mean": -723.8754013475299, "episode_len_mean": 139.87, "episode_media": {}, "episodes_timesteps_total": 13987, "policy_reward_min": {"policy_0": -1331.249338257942}, "policy_reward_max": {"policy_0": -51.538341227891664}, "policy_reward_mean": {"policy_0": -723.8754013475299}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-725.2540302916799, -859.1733261854654, -713.774410644884, -905.0687952698033, -124.96453017299763, -985.7429982277864, -183.1829335667451, -698.7932315880755, -137.16697347359744, -985.1588621446172, -1279.7185626418348, -51.538341227891664, -335.99522840188996, -115.10559149617796, -459.8500331046029, -747.0327980626756, -594.7805710085337, -185.12817293932542, -577.0151752156399, -1160.9137866551102, -1131.492097782805, -989.4404441225367, -873.4017554793978, -763.9182390579598, -879.9619407629633, -589.3549003769062, -1170.8187797670012, -369.85981694880076, -1006.1661709674809, -240.1133290133052, -283.30268561265086, -870.359935013682, -934.1418033980733, -1136.801537667898, -983.3665406139041, -1230.592058690034, -62.21002774779858, -936.8000053389252, -940.7178867455123, -826.7566021469358, -148.99873081406463, -833.2924082184147, -1072.209911560064, -1215.1782344629983, -507.8930783439088, -869.9970831704859, -136.62812409009797, -877.001522670596, -874.3526631432886, -433.43326545438595, -549.8505638536757, -547.0860790744036, -1063.4207351016257, -967.4105909638774, -1077.095009935173, -626.997490259604, -716.9651534995683, -712.607973246852, -794.4399486532623, -762.5806477750383, -570.2189022034354, -689.749757893961, -1073.1906480178322, -509.5201297675596, -1056.1574325376207, -989.9417268739684, -804.7661936016292, -263.93823320903385, -1201.1793721636623, -631.237596913732, -708.1957449405768, -64.81841425270461, -966.817576796664, -600.7179833426496, -990.9768781703383, -743.9285484244373, -562.0187869615982, -686.7463151855227, -429.8066767928686, -275.6683412159391, -241.24435820808972, -1013.5093769640615, -864.4383453013635, -946.1697639738301, -653.0343386246166, -77.43213525054658, -499.9582689985561, -215.11714240429518, -977.3993919865933, -1058.4970771536239, -1003.7318153756486, -872.7163068316212, -839.7085074473888, -692.3325417642002, -1067.6359286000225, -217.91379905254988, -1183.0634558305323, -1331.249338257942, -1059.3424945395905, -921.0763650568788], "episode_lengths": [150, 150, 150, 150, 83, 150, 150, 150, 72, 150, 150, 67, 150, 95, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 86, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 74, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 133, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 84, 123, 109, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150], "policy_policy_0_reward": [-725.2540302916799, -859.1733261854654, -713.774410644884, -905.0687952698033, -124.96453017299763, -985.7429982277864, -183.1829335667451, -698.7932315880755, -137.16697347359744, -985.1588621446172, -1279.7185626418348, -51.538341227891664, -335.99522840188996, -115.10559149617796, -459.8500331046029, -747.0327980626756, -594.7805710085337, -185.12817293932542, -577.0151752156399, -1160.9137866551102, -1131.492097782805, -989.4404441225367, -873.4017554793978, -763.9182390579598, -879.9619407629633, -589.3549003769062, -1170.8187797670012, -369.85981694880076, -1006.1661709674809, -240.1133290133052, -283.30268561265086, -870.359935013682, -934.1418033980733, -1136.801537667898, -983.3665406139041, -1230.592058690034, -62.21002774779858, -936.8000053389252, -940.7178867455123, -826.7566021469358, -148.99873081406463, -833.2924082184147, -1072.209911560064, -1215.1782344629983, -507.8930783439088, -869.9970831704859, -136.62812409009797, -877.001522670596, -874.3526631432886, -433.43326545438595, -549.8505638536757, -547.0860790744036, -1063.4207351016257, -967.4105909638774, -1077.095009935173, -626.997490259604, -716.9651534995683, -712.607973246852, -794.4399486532623, -762.5806477750383, -570.2189022034354, -689.749757893961, -1073.1906480178322, -509.5201297675596, -1056.1574325376207, -989.9417268739684, -804.7661936016292, -263.93823320903385, -1201.1793721636623, -631.237596913732, -708.1957449405768, -64.81841425270461, -966.817576796664, -600.7179833426496, -990.9768781703383, -743.9285484244373, -562.0187869615982, -686.7463151855227, -429.8066767928686, -275.6683412159391, -241.24435820808972, -1013.5093769640615, -864.4383453013635, -946.1697639738301, -653.0343386246166, -77.43213525054658, -499.9582689985561, -215.11714240429518, -977.3993919865933, -1058.4970771536239, -1003.7318153756486, -872.7163068316212, -839.7085074473888, -692.3325417642002, -1067.6359286000225, -217.91379905254988, -1183.0634558305323, -1331.249338257942, -1059.3424945395905, -921.0763650568788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5575290951061356, "mean_inference_ms": 1.6846010217716505, "mean_action_processing_ms": 0.27993746124274843, "mean_env_wait_ms": 2.992502534941824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012713432312011719, "StateBufferConnector_ms": 0.00796365737915039, "ViewRequirementAgentConnector_ms": 0.19341611862182617}, "num_episodes": 27, "episode_return_max": -51.538341227891664, "episode_return_min": -1331.249338257942, "episode_return_mean": -723.8754013475299, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.7185098628958, "num_env_steps_trained_throughput_per_sec": 343.7185098628958, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12669.228, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12669.156, "sample_time_ms": 1018.989, "learn_time_ms": 11586.443, "learn_throughput": 345.231, "synch_weights_time_ms": 62.893}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00007", "date": "2024-08-03_10-56-00", "timestamp": 1722662760, "time_this_iter_s": 11.6508047580719, "time_total_s": 140.3176658153534, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d3c70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 140.3176658153534, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 14.6125, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 189.47842968900997, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.5934230751668412, "policy_loss": -0.0061527402436089085, "vf_loss": 2.5975591796139876, "vf_explained_var": 0.9801514867072304, "kl": 0.01756681480618075, "entropy": 1.4967339190344016, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -37.873742722743295, "episode_reward_min": -1331.249338257942, "episode_reward_mean": -740.4231895599926, "episode_len_mean": 140.38, "episode_media": {}, "episodes_timesteps_total": 14038, "policy_reward_min": {"policy_0": -1331.249338257942}, "policy_reward_max": {"policy_0": -37.873742722743295}, "policy_reward_mean": {"policy_0": -740.4231895599926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1006.1661709674809, -240.1133290133052, -283.30268561265086, -870.359935013682, -934.1418033980733, -1136.801537667898, -983.3665406139041, -1230.592058690034, -62.21002774779858, -936.8000053389252, -940.7178867455123, -826.7566021469358, -148.99873081406463, -833.2924082184147, -1072.209911560064, -1215.1782344629983, -507.8930783439088, -869.9970831704859, -136.62812409009797, -877.001522670596, -874.3526631432886, -433.43326545438595, -549.8505638536757, -547.0860790744036, -1063.4207351016257, -967.4105909638774, -1077.095009935173, -626.997490259604, -716.9651534995683, -712.607973246852, -794.4399486532623, -762.5806477750383, -570.2189022034354, -689.749757893961, -1073.1906480178322, -509.5201297675596, -1056.1574325376207, -989.9417268739684, -804.7661936016292, -263.93823320903385, -1201.1793721636623, -631.237596913732, -708.1957449405768, -64.81841425270461, -966.817576796664, -600.7179833426496, -990.9768781703383, -743.9285484244373, -562.0187869615982, -686.7463151855227, -429.8066767928686, -275.6683412159391, -241.24435820808972, -1013.5093769640615, -864.4383453013635, -946.1697639738301, -653.0343386246166, -77.43213525054658, -499.9582689985561, -215.11714240429518, -977.3993919865933, -1058.4970771536239, -1003.7318153756486, -872.7163068316212, -839.7085074473888, -692.3325417642002, -1067.6359286000225, -217.91379905254988, -1183.0634558305323, -1331.249338257942, -1059.3424945395905, -921.0763650568788, -90.70014850197951, -977.4096206782816, -1188.7858644099529, -815.0915582141043, -809.530898080245, -795.1502017841481, -736.3234143662015, -1254.4141122669935, -869.2293128777767, -182.89395906906955, -770.5910569610967, -37.873742722743295, -540.9674682877131, -710.310962138391, -879.3252636168836, -57.73864292473924, -664.8046664510872, -298.4568733330264, -682.8278699782342, -693.0254792724908, -1111.946022128572, -536.97903409825, -781.4557074825457, -1241.3052202232611, -1324.6972469707255, -867.8427375608228, -818.3283056038539, -510.37975786080415], "episode_lengths": [150, 86, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 74, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 133, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 84, 123, 109, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 67, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1006.1661709674809, -240.1133290133052, -283.30268561265086, -870.359935013682, -934.1418033980733, -1136.801537667898, -983.3665406139041, -1230.592058690034, -62.21002774779858, -936.8000053389252, -940.7178867455123, -826.7566021469358, -148.99873081406463, -833.2924082184147, -1072.209911560064, -1215.1782344629983, -507.8930783439088, -869.9970831704859, -136.62812409009797, -877.001522670596, -874.3526631432886, -433.43326545438595, -549.8505638536757, -547.0860790744036, -1063.4207351016257, -967.4105909638774, -1077.095009935173, -626.997490259604, -716.9651534995683, -712.607973246852, -794.4399486532623, -762.5806477750383, -570.2189022034354, -689.749757893961, -1073.1906480178322, -509.5201297675596, -1056.1574325376207, -989.9417268739684, -804.7661936016292, -263.93823320903385, -1201.1793721636623, -631.237596913732, -708.1957449405768, -64.81841425270461, -966.817576796664, -600.7179833426496, -990.9768781703383, -743.9285484244373, -562.0187869615982, -686.7463151855227, -429.8066767928686, -275.6683412159391, -241.24435820808972, -1013.5093769640615, -864.4383453013635, -946.1697639738301, -653.0343386246166, -77.43213525054658, -499.9582689985561, -215.11714240429518, -977.3993919865933, -1058.4970771536239, -1003.7318153756486, -872.7163068316212, -839.7085074473888, -692.3325417642002, -1067.6359286000225, -217.91379905254988, -1183.0634558305323, -1331.249338257942, -1059.3424945395905, -921.0763650568788, -90.70014850197951, -977.4096206782816, -1188.7858644099529, -815.0915582141043, -809.530898080245, -795.1502017841481, -736.3234143662015, -1254.4141122669935, -869.2293128777767, -182.89395906906955, -770.5910569610967, -37.873742722743295, -540.9674682877131, -710.310962138391, -879.3252636168836, -57.73864292473924, -664.8046664510872, -298.4568733330264, -682.8278699782342, -693.0254792724908, -1111.946022128572, -536.97903409825, -781.4557074825457, -1241.3052202232611, -1324.6972469707255, -867.8427375608228, -818.3283056038539, -510.37975786080415]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5566190861380793, "mean_inference_ms": 1.6848340717219066, "mean_action_processing_ms": 0.2796157711582701, "mean_env_wait_ms": 2.995650147892038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012558460235595703, "StateBufferConnector_ms": 0.007959127426147461, "ViewRequirementAgentConnector_ms": 0.19894909858703613}, "num_episodes": 28, "episode_return_max": -37.873742722743295, "episode_return_min": -1331.249338257942, "episode_return_mean": -740.4231895599926, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.1258503161038, "num_env_steps_trained_throughput_per_sec": 311.1258503161038, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12635.312, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12635.239, "sample_time_ms": 1024.874, "learn_time_ms": 11546.43, "learn_throughput": 346.427, "synch_weights_time_ms": 63.103}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00007", "date": "2024-08-03_10-56-13", "timestamp": 1722662773, "time_this_iter_s": 12.868045806884766, "time_total_s": 153.18571162223816, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d3be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 153.18571162223816, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.478947368421053, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 191.45402240554492, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.6221680458635093, "policy_loss": -0.010388471144930614, "vf_loss": 2.6307305809110404, "vf_explained_var": 0.9843012578164537, "kl": 0.016788245144501463, "entropy": 1.5317153580486775, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -17.117558096546674, "episode_reward_min": -1331.249338257942, "episode_reward_mean": -728.0575513364354, "episode_len_mean": 138.19, "episode_media": {}, "episodes_timesteps_total": 13819, "policy_reward_min": {"policy_0": -1331.249338257942}, "policy_reward_max": {"policy_0": -17.117558096546674}, "policy_reward_mean": {"policy_0": -728.0575513364354}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-570.2189022034354, -689.749757893961, -1073.1906480178322, -509.5201297675596, -1056.1574325376207, -989.9417268739684, -804.7661936016292, -263.93823320903385, -1201.1793721636623, -631.237596913732, -708.1957449405768, -64.81841425270461, -966.817576796664, -600.7179833426496, -990.9768781703383, -743.9285484244373, -562.0187869615982, -686.7463151855227, -429.8066767928686, -275.6683412159391, -241.24435820808972, -1013.5093769640615, -864.4383453013635, -946.1697639738301, -653.0343386246166, -77.43213525054658, -499.9582689985561, -215.11714240429518, -977.3993919865933, -1058.4970771536239, -1003.7318153756486, -872.7163068316212, -839.7085074473888, -692.3325417642002, -1067.6359286000225, -217.91379905254988, -1183.0634558305323, -1331.249338257942, -1059.3424945395905, -921.0763650568788, -90.70014850197951, -977.4096206782816, -1188.7858644099529, -815.0915582141043, -809.530898080245, -795.1502017841481, -736.3234143662015, -1254.4141122669935, -869.2293128777767, -182.89395906906955, -770.5910569610967, -37.873742722743295, -540.9674682877131, -710.310962138391, -879.3252636168836, -57.73864292473924, -664.8046664510872, -298.4568733330264, -682.8278699782342, -693.0254792724908, -1111.946022128572, -536.97903409825, -781.4557074825457, -1241.3052202232611, -1324.6972469707255, -867.8427375608228, -818.3283056038539, -510.37975786080415, -992.3616050665297, -532.6222752740276, -795.6394330895718, -849.856108246815, -961.9479876582119, -1062.304283653658, -1104.4431386978563, -1148.4856028693976, -574.3810886349262, -1280.8058435775, -345.8637096941927, -301.1662220327989, -100.19144901460467, -1130.357376996433, -446.13613253590285, -1207.5716462038372, -366.6726927290438, -973.3791935062548, -1096.9299310137312, -708.1607014450775, -1109.1007368479172, -775.0080616772531, -188.14192071737912, -968.8098761427195, -767.4605029283507, -545.3756175992378, -17.117558096546674, -835.1710245610024, -710.2135504047502, -105.09352602422554, -62.270768731075876, -939.1644092210533], "episode_lengths": [150, 150, 150, 127, 150, 150, 150, 133, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 84, 123, 109, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 67, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 97, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 42, 150, 150, 64, 58, 150], "policy_policy_0_reward": [-570.2189022034354, -689.749757893961, -1073.1906480178322, -509.5201297675596, -1056.1574325376207, -989.9417268739684, -804.7661936016292, -263.93823320903385, -1201.1793721636623, -631.237596913732, -708.1957449405768, -64.81841425270461, -966.817576796664, -600.7179833426496, -990.9768781703383, -743.9285484244373, -562.0187869615982, -686.7463151855227, -429.8066767928686, -275.6683412159391, -241.24435820808972, -1013.5093769640615, -864.4383453013635, -946.1697639738301, -653.0343386246166, -77.43213525054658, -499.9582689985561, -215.11714240429518, -977.3993919865933, -1058.4970771536239, -1003.7318153756486, -872.7163068316212, -839.7085074473888, -692.3325417642002, -1067.6359286000225, -217.91379905254988, -1183.0634558305323, -1331.249338257942, -1059.3424945395905, -921.0763650568788, -90.70014850197951, -977.4096206782816, -1188.7858644099529, -815.0915582141043, -809.530898080245, -795.1502017841481, -736.3234143662015, -1254.4141122669935, -869.2293128777767, -182.89395906906955, -770.5910569610967, -37.873742722743295, -540.9674682877131, -710.310962138391, -879.3252636168836, -57.73864292473924, -664.8046664510872, -298.4568733330264, -682.8278699782342, -693.0254792724908, -1111.946022128572, -536.97903409825, -781.4557074825457, -1241.3052202232611, -1324.6972469707255, -867.8427375608228, -818.3283056038539, -510.37975786080415, -992.3616050665297, -532.6222752740276, -795.6394330895718, -849.856108246815, -961.9479876582119, -1062.304283653658, -1104.4431386978563, -1148.4856028693976, -574.3810886349262, -1280.8058435775, -345.8637096941927, -301.1662220327989, -100.19144901460467, -1130.357376996433, -446.13613253590285, -1207.5716462038372, -366.6726927290438, -973.3791935062548, -1096.9299310137312, -708.1607014450775, -1109.1007368479172, -775.0080616772531, -188.14192071737912, -968.8098761427195, -767.4605029283507, -545.3756175992378, -17.117558096546674, -835.1710245610024, -710.2135504047502, -105.09352602422554, -62.270768731075876, -939.1644092210533]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556044852813125, "mean_inference_ms": 1.6846300279447868, "mean_action_processing_ms": 0.27945266145210307, "mean_env_wait_ms": 2.999037132574659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012294292449951172, "StateBufferConnector_ms": 0.007784128189086914, "ViewRequirementAgentConnector_ms": 0.1961653232574463}, "num_episodes": 32, "episode_return_max": -17.117558096546674, "episode_return_min": -1331.249338257942, "episode_return_mean": -728.0575513364354, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 363.7634516429258, "num_env_steps_trained_throughput_per_sec": 363.7634516429258, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12405.141, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12405.068, "sample_time_ms": 1025.065, "learn_time_ms": 11318.381, "learn_throughput": 353.407, "synch_weights_time_ms": 60.805}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00007", "date": "2024-08-03_10-56-24", "timestamp": 1722662784, "time_this_iter_s": 11.0077223777771, "time_total_s": 164.19343400001526, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d3400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.19343400001526, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 14.953333333333335, "ram_util_percent": 27.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 230.45465484261513, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.3536474106212455, "policy_loss": -0.008727992310014088, "vf_loss": 2.3603357071677844, "vf_explained_var": 0.9923044583449762, "kl": 0.017990846547885075, "entropy": 1.5584696495284638, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -17.117558096546674, "episode_reward_min": -1331.249338257942, "episode_reward_mean": -747.5238294132815, "episode_len_mean": 138.02, "episode_media": {}, "episodes_timesteps_total": 13802, "policy_reward_min": {"policy_0": -1331.249338257942}, "policy_reward_max": {"policy_0": -17.117558096546674}, "policy_reward_mean": {"policy_0": -747.5238294132815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-215.11714240429518, -977.3993919865933, -1058.4970771536239, -1003.7318153756486, -872.7163068316212, -839.7085074473888, -692.3325417642002, -1067.6359286000225, -217.91379905254988, -1183.0634558305323, -1331.249338257942, -1059.3424945395905, -921.0763650568788, -90.70014850197951, -977.4096206782816, -1188.7858644099529, -815.0915582141043, -809.530898080245, -795.1502017841481, -736.3234143662015, -1254.4141122669935, -869.2293128777767, -182.89395906906955, -770.5910569610967, -37.873742722743295, -540.9674682877131, -710.310962138391, -879.3252636168836, -57.73864292473924, -664.8046664510872, -298.4568733330264, -682.8278699782342, -693.0254792724908, -1111.946022128572, -536.97903409825, -781.4557074825457, -1241.3052202232611, -1324.6972469707255, -867.8427375608228, -818.3283056038539, -510.37975786080415, -992.3616050665297, -532.6222752740276, -795.6394330895718, -849.856108246815, -961.9479876582119, -1062.304283653658, -1104.4431386978563, -1148.4856028693976, -574.3810886349262, -1280.8058435775, -345.8637096941927, -301.1662220327989, -100.19144901460467, -1130.357376996433, -446.13613253590285, -1207.5716462038372, -366.6726927290438, -973.3791935062548, -1096.9299310137312, -708.1607014450775, -1109.1007368479172, -775.0080616772531, -188.14192071737912, -968.8098761427195, -767.4605029283507, -545.3756175992378, -17.117558096546674, -835.1710245610024, -710.2135504047502, -105.09352602422554, -62.270768731075876, -939.1644092210533, -863.4057024905567, -232.8165659663257, -912.3212055161462, -935.5202349338418, -1178.2536800688358, -1113.5668416122603, -1053.0754861538308, -353.75325316790435, -841.2030494949335, -476.44638051997765, -817.7802047323569, -366.72345603043647, -921.7344620458355, -778.928627188328, -1173.3292152056415, -320.8868681967417, -1068.228747015385, -1147.7031472661024, -1104.7023076583478, -950.1992581599529, -221.6996868339767, -74.23866489643298, -365.5582885560643, -263.3611689212951, -928.3466327993666, -881.989550686718, -716.236968153785], "episode_lengths": [109, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 67, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 97, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 42, 150, 150, 64, 58, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 133, 102, 150, 150, 150], "policy_policy_0_reward": [-215.11714240429518, -977.3993919865933, -1058.4970771536239, -1003.7318153756486, -872.7163068316212, -839.7085074473888, -692.3325417642002, -1067.6359286000225, -217.91379905254988, -1183.0634558305323, -1331.249338257942, -1059.3424945395905, -921.0763650568788, -90.70014850197951, -977.4096206782816, -1188.7858644099529, -815.0915582141043, -809.530898080245, -795.1502017841481, -736.3234143662015, -1254.4141122669935, -869.2293128777767, -182.89395906906955, -770.5910569610967, -37.873742722743295, -540.9674682877131, -710.310962138391, -879.3252636168836, -57.73864292473924, -664.8046664510872, -298.4568733330264, -682.8278699782342, -693.0254792724908, -1111.946022128572, -536.97903409825, -781.4557074825457, -1241.3052202232611, -1324.6972469707255, -867.8427375608228, -818.3283056038539, -510.37975786080415, -992.3616050665297, -532.6222752740276, -795.6394330895718, -849.856108246815, -961.9479876582119, -1062.304283653658, -1104.4431386978563, -1148.4856028693976, -574.3810886349262, -1280.8058435775, -345.8637096941927, -301.1662220327989, -100.19144901460467, -1130.357376996433, -446.13613253590285, -1207.5716462038372, -366.6726927290438, -973.3791935062548, -1096.9299310137312, -708.1607014450775, -1109.1007368479172, -775.0080616772531, -188.14192071737912, -968.8098761427195, -767.4605029283507, -545.3756175992378, -17.117558096546674, -835.1710245610024, -710.2135504047502, -105.09352602422554, -62.270768731075876, -939.1644092210533, -863.4057024905567, -232.8165659663257, -912.3212055161462, -935.5202349338418, -1178.2536800688358, -1113.5668416122603, -1053.0754861538308, -353.75325316790435, -841.2030494949335, -476.44638051997765, -817.7802047323569, -366.72345603043647, -921.7344620458355, -778.928627188328, -1173.3292152056415, -320.8868681967417, -1068.228747015385, -1147.7031472661024, -1104.7023076583478, -950.1992581599529, -221.6996868339767, -74.23866489643298, -365.5582885560643, -263.3611689212951, -928.3466327993666, -881.989550686718, -716.236968153785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554937143463989, "mean_inference_ms": 1.6822653440178994, "mean_action_processing_ms": 0.27895731515143624, "mean_env_wait_ms": 2.9997685166024812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012004375457763672, "StateBufferConnector_ms": 0.0077440738677978516, "ViewRequirementAgentConnector_ms": 0.19524693489074707}, "num_episodes": 27, "episode_return_max": -17.117558096546674, "episode_return_min": -1331.249338257942, "episode_return_mean": -747.5238294132815, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.53212152439846, "num_env_steps_trained_throughput_per_sec": 417.53212152439846, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12015.881, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12015.809, "sample_time_ms": 1024.463, "learn_time_ms": 10931.737, "learn_throughput": 365.907, "synch_weights_time_ms": 58.793}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00007", "date": "2024-08-03_10-56-34", "timestamp": 1722662794, "time_this_iter_s": 9.592570781707764, "time_total_s": 173.78600478172302, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d2050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 173.78600478172302, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 15.37857142857143, "ram_util_percent": 27.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 205.19657182693481, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.4469642117619514, "policy_loss": -0.00605632431882744, "vf_loss": 2.4514343086630106, "vf_explained_var": 0.9835643101483583, "kl": 0.01572369203871253, "entropy": 1.5585130778451761, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -17.117558096546674, "episode_reward_min": -1324.6972469707255, "episode_reward_mean": -735.7357005489051, "episode_len_mean": 140.16, "episode_media": {}, "episodes_timesteps_total": 14016, "policy_reward_min": {"policy_0": -1324.6972469707255}, "policy_reward_max": {"policy_0": -17.117558096546674}, "policy_reward_mean": {"policy_0": -735.7357005489051}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-879.3252636168836, -57.73864292473924, -664.8046664510872, -298.4568733330264, -682.8278699782342, -693.0254792724908, -1111.946022128572, -536.97903409825, -781.4557074825457, -1241.3052202232611, -1324.6972469707255, -867.8427375608228, -818.3283056038539, -510.37975786080415, -992.3616050665297, -532.6222752740276, -795.6394330895718, -849.856108246815, -961.9479876582119, -1062.304283653658, -1104.4431386978563, -1148.4856028693976, -574.3810886349262, -1280.8058435775, -345.8637096941927, -301.1662220327989, -100.19144901460467, -1130.357376996433, -446.13613253590285, -1207.5716462038372, -366.6726927290438, -973.3791935062548, -1096.9299310137312, -708.1607014450775, -1109.1007368479172, -775.0080616772531, -188.14192071737912, -968.8098761427195, -767.4605029283507, -545.3756175992378, -17.117558096546674, -835.1710245610024, -710.2135504047502, -105.09352602422554, -62.270768731075876, -939.1644092210533, -863.4057024905567, -232.8165659663257, -912.3212055161462, -935.5202349338418, -1178.2536800688358, -1113.5668416122603, -1053.0754861538308, -353.75325316790435, -841.2030494949335, -476.44638051997765, -817.7802047323569, -366.72345603043647, -921.7344620458355, -778.928627188328, -1173.3292152056415, -320.8868681967417, -1068.228747015385, -1147.7031472661024, -1104.7023076583478, -950.1992581599529, -221.6996868339767, -74.23866489643298, -365.5582885560643, -263.3611689212951, -928.3466327993666, -881.989550686718, -716.236968153785, -721.5387618325439, -661.7084600745357, -753.840165274309, -886.9061831896432, -832.6953213667963, -678.9009460813893, -485.108739426365, -148.5902217645662, -331.5359123637436, -881.5731165973405, -992.0717584029634, -1254.1099459786478, -463.6612405275749, -676.5453427385463, -914.6088244627699, -1258.0828977444612, -444.03589348947173, -389.01286938538726, -1285.9067182178346, -618.8722861032652, -849.3183644512558, -528.0470831068927, -529.4332175348353, -632.3954108352781, -943.3927935509349, -680.9353425282358, -1197.4157811923585], "episode_lengths": [150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 97, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 42, 150, 150, 64, 58, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 133, 102, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 143, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-879.3252636168836, -57.73864292473924, -664.8046664510872, -298.4568733330264, -682.8278699782342, -693.0254792724908, -1111.946022128572, -536.97903409825, -781.4557074825457, -1241.3052202232611, -1324.6972469707255, -867.8427375608228, -818.3283056038539, -510.37975786080415, -992.3616050665297, -532.6222752740276, -795.6394330895718, -849.856108246815, -961.9479876582119, -1062.304283653658, -1104.4431386978563, -1148.4856028693976, -574.3810886349262, -1280.8058435775, -345.8637096941927, -301.1662220327989, -100.19144901460467, -1130.357376996433, -446.13613253590285, -1207.5716462038372, -366.6726927290438, -973.3791935062548, -1096.9299310137312, -708.1607014450775, -1109.1007368479172, -775.0080616772531, -188.14192071737912, -968.8098761427195, -767.4605029283507, -545.3756175992378, -17.117558096546674, -835.1710245610024, -710.2135504047502, -105.09352602422554, -62.270768731075876, -939.1644092210533, -863.4057024905567, -232.8165659663257, -912.3212055161462, -935.5202349338418, -1178.2536800688358, -1113.5668416122603, -1053.0754861538308, -353.75325316790435, -841.2030494949335, -476.44638051997765, -817.7802047323569, -366.72345603043647, -921.7344620458355, -778.928627188328, -1173.3292152056415, -320.8868681967417, -1068.228747015385, -1147.7031472661024, -1104.7023076583478, -950.1992581599529, -221.6996868339767, -74.23866489643298, -365.5582885560643, -263.3611689212951, -928.3466327993666, -881.989550686718, -716.236968153785, -721.5387618325439, -661.7084600745357, -753.840165274309, -886.9061831896432, -832.6953213667963, -678.9009460813893, -485.108739426365, -148.5902217645662, -331.5359123637436, -881.5731165973405, -992.0717584029634, -1254.1099459786478, -463.6612405275749, -676.5453427385463, -914.6088244627699, -1258.0828977444612, -444.03589348947173, -389.01286938538726, -1285.9067182178346, -618.8722861032652, -849.3183644512558, -528.0470831068927, -529.4332175348353, -632.3954108352781, -943.3927935509349, -680.9353425282358, -1197.4157811923585]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541475884315537, "mean_inference_ms": 1.6799582398505726, "mean_action_processing_ms": 0.2784454763608457, "mean_env_wait_ms": 3.001207162006677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012170791625976562, "StateBufferConnector_ms": 0.00777888298034668, "ViewRequirementAgentConnector_ms": 0.19728469848632812}, "num_episodes": 27, "episode_return_max": -17.117558096546674, "episode_return_min": -1324.6972469707255, "episode_return_mean": -735.7357005489051, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.6425316813869, "num_env_steps_trained_throughput_per_sec": 298.6425316813869, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12035.246, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12035.174, "sample_time_ms": 1029.969, "learn_time_ms": 10944.932, "learn_throughput": 365.466, "synch_weights_time_ms": 59.445}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00007", "date": "2024-08-03_10-56-47", "timestamp": 1722662807, "time_this_iter_s": 13.407378911972046, "time_total_s": 187.19338369369507, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010a7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 187.19338369369507, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 13.478947368421053, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 239.63136818408967, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.293647085316479, "policy_loss": -0.002791908096211652, "vf_loss": 2.295170383776228, "vf_explained_var": 0.9879515607530872, "kl": 0.014137150372653208, "entropy": 1.558826664586862, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -17.117558096546674, "episode_reward_min": -1285.9067182178346, "episode_reward_mean": -719.9836620964674, "episode_len_mean": 138.63, "episode_media": {}, "episodes_timesteps_total": 13863, "policy_reward_min": {"policy_0": -1285.9067182178346}, "policy_reward_max": {"policy_0": -17.117558096546674}, "policy_reward_mean": {"policy_0": -719.9836620964674}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-446.13613253590285, -1207.5716462038372, -366.6726927290438, -973.3791935062548, -1096.9299310137312, -708.1607014450775, -1109.1007368479172, -775.0080616772531, -188.14192071737912, -968.8098761427195, -767.4605029283507, -545.3756175992378, -17.117558096546674, -835.1710245610024, -710.2135504047502, -105.09352602422554, -62.270768731075876, -939.1644092210533, -863.4057024905567, -232.8165659663257, -912.3212055161462, -935.5202349338418, -1178.2536800688358, -1113.5668416122603, -1053.0754861538308, -353.75325316790435, -841.2030494949335, -476.44638051997765, -817.7802047323569, -366.72345603043647, -921.7344620458355, -778.928627188328, -1173.3292152056415, -320.8868681967417, -1068.228747015385, -1147.7031472661024, -1104.7023076583478, -950.1992581599529, -221.6996868339767, -74.23866489643298, -365.5582885560643, -263.3611689212951, -928.3466327993666, -881.989550686718, -716.236968153785, -721.5387618325439, -661.7084600745357, -753.840165274309, -886.9061831896432, -832.6953213667963, -678.9009460813893, -485.108739426365, -148.5902217645662, -331.5359123637436, -881.5731165973405, -992.0717584029634, -1254.1099459786478, -463.6612405275749, -676.5453427385463, -914.6088244627699, -1258.0828977444612, -444.03589348947173, -389.01286938538726, -1285.9067182178346, -618.8722861032652, -849.3183644512558, -528.0470831068927, -529.4332175348353, -632.3954108352781, -943.3927935509349, -680.9353425282358, -1197.4157811923585, -592.6079133823799, -970.8655306682858, -281.9754659419841, -1024.2247506984902, -876.9043226579441, -963.6679692755716, -242.5744594583038, -257.29438606934747, -150.93747094317888, -928.0158787350155, -1234.1517357033583, -760.5894367539472, -302.5249135341546, -594.725068495949, -442.4959334597755, -1025.30192765035, -784.5977882960935, -305.91768186416874, -931.6801058985368, -934.6697224218015, -307.6441370702921, -410.4137758263335, -1177.5307494841136, -746.1467349577864, -962.7492868142025, -861.7725534113521, -915.8821870736962, -1086.4732202216294], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 42, 150, 150, 64, 58, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 133, 102, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 143, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 91, 77, 64, 150, 150, 150, 99, 150, 150, 150, 150, 143, 150, 150, 95, 122, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-446.13613253590285, -1207.5716462038372, -366.6726927290438, -973.3791935062548, -1096.9299310137312, -708.1607014450775, -1109.1007368479172, -775.0080616772531, -188.14192071737912, -968.8098761427195, -767.4605029283507, -545.3756175992378, -17.117558096546674, -835.1710245610024, -710.2135504047502, -105.09352602422554, -62.270768731075876, -939.1644092210533, -863.4057024905567, -232.8165659663257, -912.3212055161462, -935.5202349338418, -1178.2536800688358, -1113.5668416122603, -1053.0754861538308, -353.75325316790435, -841.2030494949335, -476.44638051997765, -817.7802047323569, -366.72345603043647, -921.7344620458355, -778.928627188328, -1173.3292152056415, -320.8868681967417, -1068.228747015385, -1147.7031472661024, -1104.7023076583478, -950.1992581599529, -221.6996868339767, -74.23866489643298, -365.5582885560643, -263.3611689212951, -928.3466327993666, -881.989550686718, -716.236968153785, -721.5387618325439, -661.7084600745357, -753.840165274309, -886.9061831896432, -832.6953213667963, -678.9009460813893, -485.108739426365, -148.5902217645662, -331.5359123637436, -881.5731165973405, -992.0717584029634, -1254.1099459786478, -463.6612405275749, -676.5453427385463, -914.6088244627699, -1258.0828977444612, -444.03589348947173, -389.01286938538726, -1285.9067182178346, -618.8722861032652, -849.3183644512558, -528.0470831068927, -529.4332175348353, -632.3954108352781, -943.3927935509349, -680.9353425282358, -1197.4157811923585, -592.6079133823799, -970.8655306682858, -281.9754659419841, -1024.2247506984902, -876.9043226579441, -963.6679692755716, -242.5744594583038, -257.29438606934747, -150.93747094317888, -928.0158787350155, -1234.1517357033583, -760.5894367539472, -302.5249135341546, -594.725068495949, -442.4959334597755, -1025.30192765035, -784.5977882960935, -305.91768186416874, -931.6801058985368, -934.6697224218015, -307.6441370702921, -410.4137758263335, -1177.5307494841136, -746.1467349577864, -962.7492868142025, -861.7725534113521, -915.8821870736962, -1086.4732202216294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542047946707279, "mean_inference_ms": 1.6788292403043144, "mean_action_processing_ms": 0.27810587949511895, "mean_env_wait_ms": 3.0032513159123497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012455940246582031, "StateBufferConnector_ms": 0.007889032363891602, "ViewRequirementAgentConnector_ms": 0.2008800506591797}, "num_episodes": 28, "episode_return_max": -17.117558096546674, "episode_return_min": -1285.9067182178346, "episode_return_mean": -719.9836620964674, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.00849555353903, "num_env_steps_trained_throughput_per_sec": 301.00849555353903, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12017.708, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12017.636, "sample_time_ms": 1034.507, "learn_time_ms": 10921.76, "learn_throughput": 366.241, "synch_weights_time_ms": 60.53}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00007", "date": "2024-08-03_10-57-01", "timestamp": 1722662821, "time_this_iter_s": 13.30288052558899, "time_total_s": 200.49626421928406, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c576950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 200.49626421928406, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.257894736842104, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 173.68544946511585, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.2301088056216636, "policy_loss": -0.01303259208604383, "vf_loss": 2.2418673330297074, "vf_explained_var": 0.988827193590502, "kl": 0.014060954126762245, "entropy": 1.53814021187524, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -74.23866489643298, "episode_reward_min": -1323.9187188681412, "episode_reward_mean": -714.6678812826323, "episode_len_mean": 140.42, "episode_media": {}, "episodes_timesteps_total": 14042, "policy_reward_min": {"policy_0": -1323.9187188681412}, "policy_reward_max": {"policy_0": -74.23866489643298}, "policy_reward_mean": {"policy_0": -714.6678812826323}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-778.928627188328, -1173.3292152056415, -320.8868681967417, -1068.228747015385, -1147.7031472661024, -1104.7023076583478, -950.1992581599529, -221.6996868339767, -74.23866489643298, -365.5582885560643, -263.3611689212951, -928.3466327993666, -881.989550686718, -716.236968153785, -721.5387618325439, -661.7084600745357, -753.840165274309, -886.9061831896432, -832.6953213667963, -678.9009460813893, -485.108739426365, -148.5902217645662, -331.5359123637436, -881.5731165973405, -992.0717584029634, -1254.1099459786478, -463.6612405275749, -676.5453427385463, -914.6088244627699, -1258.0828977444612, -444.03589348947173, -389.01286938538726, -1285.9067182178346, -618.8722861032652, -849.3183644512558, -528.0470831068927, -529.4332175348353, -632.3954108352781, -943.3927935509349, -680.9353425282358, -1197.4157811923585, -592.6079133823799, -970.8655306682858, -281.9754659419841, -1024.2247506984902, -876.9043226579441, -963.6679692755716, -242.5744594583038, -257.29438606934747, -150.93747094317888, -928.0158787350155, -1234.1517357033583, -760.5894367539472, -302.5249135341546, -594.725068495949, -442.4959334597755, -1025.30192765035, -784.5977882960935, -305.91768186416874, -931.6801058985368, -934.6697224218015, -307.6441370702921, -410.4137758263335, -1177.5307494841136, -746.1467349577864, -962.7492868142025, -861.7725534113521, -915.8821870736962, -1086.4732202216294, -600.040164419336, -397.41909718188407, -843.7285193715072, -373.9872216319945, -794.622166018684, -121.35370448489024, -984.1668072366583, -598.7982079862421, -987.8217768585408, -842.2536148049651, -398.37170491440037, -91.79912771021674, -797.3754096144519, -631.7828490935775, -994.4073642524401, -204.3050973165606, -490.4997138796923, -530.7799869477252, -951.2418486299346, -913.5289051835713, -732.2420140814698, -802.4055751147804, -990.2617948229552, -861.9979661242679, -508.6249956786242, -785.3535374283988, -1323.9187188681412, -153.98615873474262, -439.2094192053261, -1048.3924807118583, -1162.1243434272765], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 60, 133, 102, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 143, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 91, 77, 64, 150, 150, 150, 99, 150, 150, 150, 150, 143, 150, 150, 95, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 118, 87, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 108, 150, 150, 150], "policy_policy_0_reward": [-778.928627188328, -1173.3292152056415, -320.8868681967417, -1068.228747015385, -1147.7031472661024, -1104.7023076583478, -950.1992581599529, -221.6996868339767, -74.23866489643298, -365.5582885560643, -263.3611689212951, -928.3466327993666, -881.989550686718, -716.236968153785, -721.5387618325439, -661.7084600745357, -753.840165274309, -886.9061831896432, -832.6953213667963, -678.9009460813893, -485.108739426365, -148.5902217645662, -331.5359123637436, -881.5731165973405, -992.0717584029634, -1254.1099459786478, -463.6612405275749, -676.5453427385463, -914.6088244627699, -1258.0828977444612, -444.03589348947173, -389.01286938538726, -1285.9067182178346, -618.8722861032652, -849.3183644512558, -528.0470831068927, -529.4332175348353, -632.3954108352781, -943.3927935509349, -680.9353425282358, -1197.4157811923585, -592.6079133823799, -970.8655306682858, -281.9754659419841, -1024.2247506984902, -876.9043226579441, -963.6679692755716, -242.5744594583038, -257.29438606934747, -150.93747094317888, -928.0158787350155, -1234.1517357033583, -760.5894367539472, -302.5249135341546, -594.725068495949, -442.4959334597755, -1025.30192765035, -784.5977882960935, -305.91768186416874, -931.6801058985368, -934.6697224218015, -307.6441370702921, -410.4137758263335, -1177.5307494841136, -746.1467349577864, -962.7492868142025, -861.7725534113521, -915.8821870736962, -1086.4732202216294, -600.040164419336, -397.41909718188407, -843.7285193715072, -373.9872216319945, -794.622166018684, -121.35370448489024, -984.1668072366583, -598.7982079862421, -987.8217768585408, -842.2536148049651, -398.37170491440037, -91.79912771021674, -797.3754096144519, -631.7828490935775, -994.4073642524401, -204.3050973165606, -490.4997138796923, -530.7799869477252, -951.2418486299346, -913.5289051835713, -732.2420140814698, -802.4055751147804, -990.2617948229552, -861.9979661242679, -508.6249956786242, -785.3535374283988, -1323.9187188681412, -153.98615873474262, -439.2094192053261, -1048.3924807118583, -1162.1243434272765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533989584457624, "mean_inference_ms": 1.6776656811289317, "mean_action_processing_ms": 0.27769194124226343, "mean_env_wait_ms": 3.005612110611803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01258230209350586, "StateBufferConnector_ms": 0.007946968078613281, "ViewRequirementAgentConnector_ms": 0.20055150985717773}, "num_episodes": 31, "episode_return_max": -74.23866489643298, "episode_return_min": -1323.9187188681412, "episode_return_mean": -714.6678812826323, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.6394076148217, "num_env_steps_trained_throughput_per_sec": 307.6394076148217, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12038.505, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12038.432, "sample_time_ms": 1033.07, "learn_time_ms": 10943.879, "learn_throughput": 365.501, "synch_weights_time_ms": 60.643}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00007", "date": "2024-08-03_10-57-14", "timestamp": 1722662834, "time_this_iter_s": 13.015037775039673, "time_total_s": 213.51130199432373, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c577f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 213.51130199432373, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.257894736842106, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 192.5297204832236, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.822809531260282, "policy_loss": -0.007234575797823103, "vf_loss": 1.8283555736765265, "vf_explained_var": 0.9953005515659848, "kl": 0.016234022507327004, "entropy": 1.5582756453504165, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -91.79912771021674, "episode_reward_min": -1323.9187188681412, "episode_reward_mean": -731.630713497674, "episode_len_mean": 141.57, "episode_media": {}, "episodes_timesteps_total": 14157, "policy_reward_min": {"policy_0": -1323.9187188681412}, "policy_reward_max": {"policy_0": -91.79912771021674}, "policy_reward_mean": {"policy_0": -731.630713497674}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-992.0717584029634, -1254.1099459786478, -463.6612405275749, -676.5453427385463, -914.6088244627699, -1258.0828977444612, -444.03589348947173, -389.01286938538726, -1285.9067182178346, -618.8722861032652, -849.3183644512558, -528.0470831068927, -529.4332175348353, -632.3954108352781, -943.3927935509349, -680.9353425282358, -1197.4157811923585, -592.6079133823799, -970.8655306682858, -281.9754659419841, -1024.2247506984902, -876.9043226579441, -963.6679692755716, -242.5744594583038, -257.29438606934747, -150.93747094317888, -928.0158787350155, -1234.1517357033583, -760.5894367539472, -302.5249135341546, -594.725068495949, -442.4959334597755, -1025.30192765035, -784.5977882960935, -305.91768186416874, -931.6801058985368, -934.6697224218015, -307.6441370702921, -410.4137758263335, -1177.5307494841136, -746.1467349577864, -962.7492868142025, -861.7725534113521, -915.8821870736962, -1086.4732202216294, -600.040164419336, -397.41909718188407, -843.7285193715072, -373.9872216319945, -794.622166018684, -121.35370448489024, -984.1668072366583, -598.7982079862421, -987.8217768585408, -842.2536148049651, -398.37170491440037, -91.79912771021674, -797.3754096144519, -631.7828490935775, -994.4073642524401, -204.3050973165606, -490.4997138796923, -530.7799869477252, -951.2418486299346, -913.5289051835713, -732.2420140814698, -802.4055751147804, -990.2617948229552, -861.9979661242679, -508.6249956786242, -785.3535374283988, -1323.9187188681412, -153.98615873474262, -439.2094192053261, -1048.3924807118583, -1162.1243434272765, -666.2441174373263, -671.3487160665254, -486.61914214378675, -796.5142595598486, -1065.6011688472138, -686.3978968421725, -875.157093366594, -791.1288351449774, -1019.1460149500331, -258.6061180380563, -359.5599281992316, -185.6245684865324, -640.2226893657056, -890.2730105108345, -1002.2264312478932, -1095.9321168078911, -824.0766531610767, -1062.0395719819862, -1241.4722678731555, -1026.0739835392228, -584.947745453249, -1051.677716927465, -583.1149394215735, -210.0851956411791], "episode_lengths": [150, 150, 143, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 91, 77, 64, 150, 150, 150, 99, 150, 150, 150, 150, 143, 150, 150, 95, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 118, 87, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78], "policy_policy_0_reward": [-992.0717584029634, -1254.1099459786478, -463.6612405275749, -676.5453427385463, -914.6088244627699, -1258.0828977444612, -444.03589348947173, -389.01286938538726, -1285.9067182178346, -618.8722861032652, -849.3183644512558, -528.0470831068927, -529.4332175348353, -632.3954108352781, -943.3927935509349, -680.9353425282358, -1197.4157811923585, -592.6079133823799, -970.8655306682858, -281.9754659419841, -1024.2247506984902, -876.9043226579441, -963.6679692755716, -242.5744594583038, -257.29438606934747, -150.93747094317888, -928.0158787350155, -1234.1517357033583, -760.5894367539472, -302.5249135341546, -594.725068495949, -442.4959334597755, -1025.30192765035, -784.5977882960935, -305.91768186416874, -931.6801058985368, -934.6697224218015, -307.6441370702921, -410.4137758263335, -1177.5307494841136, -746.1467349577864, -962.7492868142025, -861.7725534113521, -915.8821870736962, -1086.4732202216294, -600.040164419336, -397.41909718188407, -843.7285193715072, -373.9872216319945, -794.622166018684, -121.35370448489024, -984.1668072366583, -598.7982079862421, -987.8217768585408, -842.2536148049651, -398.37170491440037, -91.79912771021674, -797.3754096144519, -631.7828490935775, -994.4073642524401, -204.3050973165606, -490.4997138796923, -530.7799869477252, -951.2418486299346, -913.5289051835713, -732.2420140814698, -802.4055751147804, -990.2617948229552, -861.9979661242679, -508.6249956786242, -785.3535374283988, -1323.9187188681412, -153.98615873474262, -439.2094192053261, -1048.3924807118583, -1162.1243434272765, -666.2441174373263, -671.3487160665254, -486.61914214378675, -796.5142595598486, -1065.6011688472138, -686.3978968421725, -875.157093366594, -791.1288351449774, -1019.1460149500331, -258.6061180380563, -359.5599281992316, -185.6245684865324, -640.2226893657056, -890.2730105108345, -1002.2264312478932, -1095.9321168078911, -824.0766531610767, -1062.0395719819862, -1241.4722678731555, -1026.0739835392228, -584.947745453249, -1051.677716927465, -583.1149394215735, -210.0851956411791]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553589228251707, "mean_inference_ms": 1.6776570794337136, "mean_action_processing_ms": 0.27784788247173475, "mean_env_wait_ms": 3.008445887848326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013326644897460938, "StateBufferConnector_ms": 0.008090972900390625, "ViewRequirementAgentConnector_ms": 0.20225858688354492}, "num_episodes": 24, "episode_return_max": -91.79912771021674, "episode_return_min": -1323.9187188681412, "episode_return_mean": -731.630713497674, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.2787546463027, "num_env_steps_trained_throughput_per_sec": 302.2787546463027, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12247.406, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12247.331, "sample_time_ms": 1031.701, "learn_time_ms": 11151.382, "learn_throughput": 358.7, "synch_weights_time_ms": 63.396}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00007", "date": "2024-08-03_10-57-27", "timestamp": 1722662847, "time_this_iter_s": 13.246633291244507, "time_total_s": 226.75793528556824, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010a7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 226.75793528556824, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.326315789473684, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 244.2907374938329, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.1131909258663653, "policy_loss": -0.010123817927281682, "vf_loss": 2.121640991171201, "vf_explained_var": 0.99480172911038, "kl": 0.016560389134883734, "entropy": 1.6383230631550154, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -64.4632454945347, "episode_reward_min": -1323.9187188681412, "episode_reward_mean": -722.0461335379338, "episode_len_mean": 140.82, "episode_media": {}, "episodes_timesteps_total": 14082, "policy_reward_min": {"policy_0": -1323.9187188681412}, "policy_reward_max": {"policy_0": -64.4632454945347}, "policy_reward_mean": {"policy_0": -722.0461335379338}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-784.5977882960935, -305.91768186416874, -931.6801058985368, -934.6697224218015, -307.6441370702921, -410.4137758263335, -1177.5307494841136, -746.1467349577864, -962.7492868142025, -861.7725534113521, -915.8821870736962, -1086.4732202216294, -600.040164419336, -397.41909718188407, -843.7285193715072, -373.9872216319945, -794.622166018684, -121.35370448489024, -984.1668072366583, -598.7982079862421, -987.8217768585408, -842.2536148049651, -398.37170491440037, -91.79912771021674, -797.3754096144519, -631.7828490935775, -994.4073642524401, -204.3050973165606, -490.4997138796923, -530.7799869477252, -951.2418486299346, -913.5289051835713, -732.2420140814698, -802.4055751147804, -990.2617948229552, -861.9979661242679, -508.6249956786242, -785.3535374283988, -1323.9187188681412, -153.98615873474262, -439.2094192053261, -1048.3924807118583, -1162.1243434272765, -666.2441174373263, -671.3487160665254, -486.61914214378675, -796.5142595598486, -1065.6011688472138, -686.3978968421725, -875.157093366594, -791.1288351449774, -1019.1460149500331, -258.6061180380563, -359.5599281992316, -185.6245684865324, -640.2226893657056, -890.2730105108345, -1002.2264312478932, -1095.9321168078911, -824.0766531610767, -1062.0395719819862, -1241.4722678731555, -1026.0739835392228, -584.947745453249, -1051.677716927465, -583.1149394215735, -210.0851956411791, -556.5454436672561, -682.6851963738932, -114.23092683948417, -731.0300103175257, -909.3370588020051, -881.7230882562511, -1062.6594883064172, -978.5515118688355, -746.8576889845899, -73.24319510100129, -80.66954692756161, -1040.450356853868, -997.2630536425945, -789.0800934351848, -962.9824992059075, -519.1559464568255, -689.817579310296, -229.1636410899376, -538.4803011194074, -64.4632454945347, -508.055261069152, -1223.4687232453964, -839.1121095731801, -978.1098037190715, -1204.3434570519667, -728.8969176414384, -1192.3754295106814, -461.7677238664978, -563.628052256795, -776.2321729683796, -278.60690440147715, -1148.829909878256, -796.4286004690525], "episode_lengths": [150, 143, 150, 150, 95, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 118, 87, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 96, 150, 150, 150, 150, 150, 150, 53, 68, 150, 150, 150, 150, 150, 150, 85, 150, 62, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-784.5977882960935, -305.91768186416874, -931.6801058985368, -934.6697224218015, -307.6441370702921, -410.4137758263335, -1177.5307494841136, -746.1467349577864, -962.7492868142025, -861.7725534113521, -915.8821870736962, -1086.4732202216294, -600.040164419336, -397.41909718188407, -843.7285193715072, -373.9872216319945, -794.622166018684, -121.35370448489024, -984.1668072366583, -598.7982079862421, -987.8217768585408, -842.2536148049651, -398.37170491440037, -91.79912771021674, -797.3754096144519, -631.7828490935775, -994.4073642524401, -204.3050973165606, -490.4997138796923, -530.7799869477252, -951.2418486299346, -913.5289051835713, -732.2420140814698, -802.4055751147804, -990.2617948229552, -861.9979661242679, -508.6249956786242, -785.3535374283988, -1323.9187188681412, -153.98615873474262, -439.2094192053261, -1048.3924807118583, -1162.1243434272765, -666.2441174373263, -671.3487160665254, -486.61914214378675, -796.5142595598486, -1065.6011688472138, -686.3978968421725, -875.157093366594, -791.1288351449774, -1019.1460149500331, -258.6061180380563, -359.5599281992316, -185.6245684865324, -640.2226893657056, -890.2730105108345, -1002.2264312478932, -1095.9321168078911, -824.0766531610767, -1062.0395719819862, -1241.4722678731555, -1026.0739835392228, -584.947745453249, -1051.677716927465, -583.1149394215735, -210.0851956411791, -556.5454436672561, -682.6851963738932, -114.23092683948417, -731.0300103175257, -909.3370588020051, -881.7230882562511, -1062.6594883064172, -978.5515118688355, -746.8576889845899, -73.24319510100129, -80.66954692756161, -1040.450356853868, -997.2630536425945, -789.0800934351848, -962.9824992059075, -519.1559464568255, -689.817579310296, -229.1636410899376, -538.4803011194074, -64.4632454945347, -508.055261069152, -1223.4687232453964, -839.1121095731801, -978.1098037190715, -1204.3434570519667, -728.8969176414384, -1192.3754295106814, -461.7677238664978, -563.628052256795, -776.2321729683796, -278.60690440147715, -1148.829909878256, -796.4286004690525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534030139702331, "mean_inference_ms": 1.6780951363008736, "mean_action_processing_ms": 0.2774338572360898, "mean_env_wait_ms": 3.008653885226602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013661861419677734, "StateBufferConnector_ms": 0.008320093154907227, "ViewRequirementAgentConnector_ms": 0.20032715797424316}, "num_episodes": 33, "episode_return_max": -64.4632454945347, "episode_return_min": -1323.9187188681412, "episode_return_mean": -722.0461335379338, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.3685967474777, "num_env_steps_trained_throughput_per_sec": 301.3685967474777, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12448.199, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12448.122, "sample_time_ms": 1037.472, "learn_time_ms": 11344.646, "learn_throughput": 352.589, "synch_weights_time_ms": 65.139}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00007", "date": "2024-08-03_10-57-40", "timestamp": 1722662860, "time_this_iter_s": 13.286543369293213, "time_total_s": 240.04447865486145, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c575bd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 240.04447865486145, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.647368421052635, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 170.48546504775683, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.3650449557850757, "policy_loss": -0.01266927722026594, "vf_loss": 2.375877338896195, "vf_explained_var": 0.9861690738548835, "kl": 0.01634084023353354, "entropy": 1.4312654534975688, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -18.63792796999289, "episode_reward_min": -1323.9187188681412, "episode_reward_mean": -709.0518769189449, "episode_len_mean": 138.9, "episode_media": {}, "episodes_timesteps_total": 13890, "policy_reward_min": {"policy_0": -1323.9187188681412}, "policy_reward_max": {"policy_0": -18.63792796999289}, "policy_reward_mean": {"policy_0": -709.0518769189449}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-732.2420140814698, -802.4055751147804, -990.2617948229552, -861.9979661242679, -508.6249956786242, -785.3535374283988, -1323.9187188681412, -153.98615873474262, -439.2094192053261, -1048.3924807118583, -1162.1243434272765, -666.2441174373263, -671.3487160665254, -486.61914214378675, -796.5142595598486, -1065.6011688472138, -686.3978968421725, -875.157093366594, -791.1288351449774, -1019.1460149500331, -258.6061180380563, -359.5599281992316, -185.6245684865324, -640.2226893657056, -890.2730105108345, -1002.2264312478932, -1095.9321168078911, -824.0766531610767, -1062.0395719819862, -1241.4722678731555, -1026.0739835392228, -584.947745453249, -1051.677716927465, -583.1149394215735, -210.0851956411791, -556.5454436672561, -682.6851963738932, -114.23092683948417, -731.0300103175257, -909.3370588020051, -881.7230882562511, -1062.6594883064172, -978.5515118688355, -746.8576889845899, -73.24319510100129, -80.66954692756161, -1040.450356853868, -997.2630536425945, -789.0800934351848, -962.9824992059075, -519.1559464568255, -689.817579310296, -229.1636410899376, -538.4803011194074, -64.4632454945347, -508.055261069152, -1223.4687232453964, -839.1121095731801, -978.1098037190715, -1204.3434570519667, -728.8969176414384, -1192.3754295106814, -461.7677238664978, -563.628052256795, -776.2321729683796, -278.60690440147715, -1148.829909878256, -796.4286004690525, -816.1664004949334, -973.681349112061, -917.0611932021192, -343.1052669041394, -107.38194817872585, -182.11558717929455, -451.1791801147345, -681.6980234707266, -846.4742379663267, -701.1309941916003, -729.9904221498658, -30.92808628012286, -549.5689629646643, -636.5792392892375, -77.76173847806827, -644.1267292158416, -1224.677344732854, -18.63792796999289, -613.8912386644716, -964.7989745545259, -303.64625840241825, -581.0108886549185, -1047.8076398885523, -523.6320163749792, -966.8877381011898, -720.7075482084683, -908.7150252712736, -538.0828365439089, -693.699503133591, -1312.5752748587688, -598.1527852167998, -968.4632092092298], "episode_lengths": [150, 150, 150, 150, 121, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 96, 150, 150, 150, 150, 150, 150, 53, 68, 150, 150, 150, 150, 150, 150, 85, 150, 62, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 107, 64, 73, 150, 150, 150, 150, 150, 57, 150, 150, 72, 150, 150, 47, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150], "policy_policy_0_reward": [-732.2420140814698, -802.4055751147804, -990.2617948229552, -861.9979661242679, -508.6249956786242, -785.3535374283988, -1323.9187188681412, -153.98615873474262, -439.2094192053261, -1048.3924807118583, -1162.1243434272765, -666.2441174373263, -671.3487160665254, -486.61914214378675, -796.5142595598486, -1065.6011688472138, -686.3978968421725, -875.157093366594, -791.1288351449774, -1019.1460149500331, -258.6061180380563, -359.5599281992316, -185.6245684865324, -640.2226893657056, -890.2730105108345, -1002.2264312478932, -1095.9321168078911, -824.0766531610767, -1062.0395719819862, -1241.4722678731555, -1026.0739835392228, -584.947745453249, -1051.677716927465, -583.1149394215735, -210.0851956411791, -556.5454436672561, -682.6851963738932, -114.23092683948417, -731.0300103175257, -909.3370588020051, -881.7230882562511, -1062.6594883064172, -978.5515118688355, -746.8576889845899, -73.24319510100129, -80.66954692756161, -1040.450356853868, -997.2630536425945, -789.0800934351848, -962.9824992059075, -519.1559464568255, -689.817579310296, -229.1636410899376, -538.4803011194074, -64.4632454945347, -508.055261069152, -1223.4687232453964, -839.1121095731801, -978.1098037190715, -1204.3434570519667, -728.8969176414384, -1192.3754295106814, -461.7677238664978, -563.628052256795, -776.2321729683796, -278.60690440147715, -1148.829909878256, -796.4286004690525, -816.1664004949334, -973.681349112061, -917.0611932021192, -343.1052669041394, -107.38194817872585, -182.11558717929455, -451.1791801147345, -681.6980234707266, -846.4742379663267, -701.1309941916003, -729.9904221498658, -30.92808628012286, -549.5689629646643, -636.5792392892375, -77.76173847806827, -644.1267292158416, -1224.677344732854, -18.63792796999289, -613.8912386644716, -964.7989745545259, -303.64625840241825, -581.0108886549185, -1047.8076398885523, -523.6320163749792, -966.8877381011898, -720.7075482084683, -908.7150252712736, -538.0828365439089, -693.699503133591, -1312.5752748587688, -598.1527852167998, -968.4632092092298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532007872126937, "mean_inference_ms": 1.6780710565208752, "mean_action_processing_ms": 0.2773796191581032, "mean_env_wait_ms": 3.010233231669035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013377666473388672, "StateBufferConnector_ms": 0.008122682571411133, "ViewRequirementAgentConnector_ms": 0.19893693923950195}, "num_episodes": 32, "episode_return_max": -18.63792796999289, "episode_return_min": -1323.9187188681412, "episode_return_mean": -709.0518769189449, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.02177904473854, "num_env_steps_trained_throughput_per_sec": 289.02177904473854, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12510.058, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12509.984, "sample_time_ms": 1035.089, "learn_time_ms": 11409.117, "learn_throughput": 350.597, "synch_weights_time_ms": 64.918}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00007", "date": "2024-08-03_10-57-54", "timestamp": 1722662874, "time_this_iter_s": 13.852406978607178, "time_total_s": 253.89688563346863, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d20e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 253.89688563346863, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.015789473684213, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 291.077536469698, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.9204930977895855, "policy_loss": -0.014413934396482848, "vf_loss": 1.9337169661497076, "vf_explained_var": 0.9893764032050967, "kl": 0.01432064517729638, "entropy": 1.674061948681871, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -18.63792796999289, "episode_reward_min": -1312.5752748587688, "episode_reward_mean": -720.5125768712975, "episode_len_mean": 139.14, "episode_media": {}, "episodes_timesteps_total": 13914, "policy_reward_min": {"policy_0": -1312.5752748587688}, "policy_reward_max": {"policy_0": -18.63792796999289}, "policy_reward_mean": {"policy_0": -720.5125768712975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-890.2730105108345, -1002.2264312478932, -1095.9321168078911, -824.0766531610767, -1062.0395719819862, -1241.4722678731555, -1026.0739835392228, -584.947745453249, -1051.677716927465, -583.1149394215735, -210.0851956411791, -556.5454436672561, -682.6851963738932, -114.23092683948417, -731.0300103175257, -909.3370588020051, -881.7230882562511, -1062.6594883064172, -978.5515118688355, -746.8576889845899, -73.24319510100129, -80.66954692756161, -1040.450356853868, -997.2630536425945, -789.0800934351848, -962.9824992059075, -519.1559464568255, -689.817579310296, -229.1636410899376, -538.4803011194074, -64.4632454945347, -508.055261069152, -1223.4687232453964, -839.1121095731801, -978.1098037190715, -1204.3434570519667, -728.8969176414384, -1192.3754295106814, -461.7677238664978, -563.628052256795, -776.2321729683796, -278.60690440147715, -1148.829909878256, -796.4286004690525, -816.1664004949334, -973.681349112061, -917.0611932021192, -343.1052669041394, -107.38194817872585, -182.11558717929455, -451.1791801147345, -681.6980234707266, -846.4742379663267, -701.1309941916003, -729.9904221498658, -30.92808628012286, -549.5689629646643, -636.5792392892375, -77.76173847806827, -644.1267292158416, -1224.677344732854, -18.63792796999289, -613.8912386644716, -964.7989745545259, -303.64625840241825, -581.0108886549185, -1047.8076398885523, -523.6320163749792, -966.8877381011898, -720.7075482084683, -908.7150252712736, -538.0828365439089, -693.699503133591, -1312.5752748587688, -598.1527852167998, -968.4632092092298, -763.4223832290417, -458.4418431272512, -1207.3062702167097, -1126.623864660181, -170.88184727827834, -957.7038956169455, -708.8060508469413, -829.8752195882696, -176.57296722935249, -745.4853844123255, -632.8530249001293, -850.7103587077635, -474.76795455206576, -713.3959851530688, -980.5744742877857, -748.9810344311925, -935.571412694015, -720.7848156430191, -755.5654255936164, -751.510500649264, -929.9731911432648, -1083.3034862633272, -588.5735614571488, -1145.0725962001586], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 96, 150, 150, 150, 150, 150, 150, 53, 68, 150, 150, 150, 150, 150, 150, 85, 150, 62, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 107, 64, 73, 150, 150, 150, 150, 150, 57, 150, 150, 72, 150, 150, 47, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 105, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-890.2730105108345, -1002.2264312478932, -1095.9321168078911, -824.0766531610767, -1062.0395719819862, -1241.4722678731555, -1026.0739835392228, -584.947745453249, -1051.677716927465, -583.1149394215735, -210.0851956411791, -556.5454436672561, -682.6851963738932, -114.23092683948417, -731.0300103175257, -909.3370588020051, -881.7230882562511, -1062.6594883064172, -978.5515118688355, -746.8576889845899, -73.24319510100129, -80.66954692756161, -1040.450356853868, -997.2630536425945, -789.0800934351848, -962.9824992059075, -519.1559464568255, -689.817579310296, -229.1636410899376, -538.4803011194074, -64.4632454945347, -508.055261069152, -1223.4687232453964, -839.1121095731801, -978.1098037190715, -1204.3434570519667, -728.8969176414384, -1192.3754295106814, -461.7677238664978, -563.628052256795, -776.2321729683796, -278.60690440147715, -1148.829909878256, -796.4286004690525, -816.1664004949334, -973.681349112061, -917.0611932021192, -343.1052669041394, -107.38194817872585, -182.11558717929455, -451.1791801147345, -681.6980234707266, -846.4742379663267, -701.1309941916003, -729.9904221498658, -30.92808628012286, -549.5689629646643, -636.5792392892375, -77.76173847806827, -644.1267292158416, -1224.677344732854, -18.63792796999289, -613.8912386644716, -964.7989745545259, -303.64625840241825, -581.0108886549185, -1047.8076398885523, -523.6320163749792, -966.8877381011898, -720.7075482084683, -908.7150252712736, -538.0828365439089, -693.699503133591, -1312.5752748587688, -598.1527852167998, -968.4632092092298, -763.4223832290417, -458.4418431272512, -1207.3062702167097, -1126.623864660181, -170.88184727827834, -957.7038956169455, -708.8060508469413, -829.8752195882696, -176.57296722935249, -745.4853844123255, -632.8530249001293, -850.7103587077635, -474.76795455206576, -713.3959851530688, -980.5744742877857, -748.9810344311925, -935.571412694015, -720.7848156430191, -755.5654255936164, -751.510500649264, -929.9731911432648, -1083.3034862633272, -588.5735614571488, -1145.0725962001586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536440708723085, "mean_inference_ms": 1.6787031672107946, "mean_action_processing_ms": 0.277480587792607, "mean_env_wait_ms": 3.012618404940543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013132810592651367, "StateBufferConnector_ms": 0.008026361465454102, "ViewRequirementAgentConnector_ms": 0.1974804401397705}, "num_episodes": 24, "episode_return_max": -18.63792796999289, "episode_return_min": -1312.5752748587688, "episode_return_mean": -720.5125768712975, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.9971674257036, "num_env_steps_trained_throughput_per_sec": 324.9971674257036, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12577.095, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12577.021, "sample_time_ms": 1036.649, "learn_time_ms": 11474.832, "learn_throughput": 348.589, "synch_weights_time_ms": 64.684}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00007", "date": "2024-08-03_10-58-07", "timestamp": 1722662887, "time_this_iter_s": 12.321913957595825, "time_total_s": 266.21879959106445, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010a7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 266.21879959106445, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.366666666666667, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 208.91873459418613, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.930397031456232, "policy_loss": -0.012711141752273154, "vf_loss": 1.9415361200769743, "vf_explained_var": 0.9932005263864994, "kl": 0.015928542343923862, "entropy": 1.6136541879425446, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -18.63792796999289, "episode_reward_min": -1312.5752748587688, "episode_reward_mean": -723.6330660663782, "episode_len_mean": 141.33, "episode_media": {}, "episodes_timesteps_total": 14133, "policy_reward_min": {"policy_0": -1312.5752748587688}, "policy_reward_max": {"policy_0": -18.63792796999289}, "policy_reward_mean": {"policy_0": -723.6330660663782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-519.1559464568255, -689.817579310296, -229.1636410899376, -538.4803011194074, -64.4632454945347, -508.055261069152, -1223.4687232453964, -839.1121095731801, -978.1098037190715, -1204.3434570519667, -728.8969176414384, -1192.3754295106814, -461.7677238664978, -563.628052256795, -776.2321729683796, -278.60690440147715, -1148.829909878256, -796.4286004690525, -816.1664004949334, -973.681349112061, -917.0611932021192, -343.1052669041394, -107.38194817872585, -182.11558717929455, -451.1791801147345, -681.6980234707266, -846.4742379663267, -701.1309941916003, -729.9904221498658, -30.92808628012286, -549.5689629646643, -636.5792392892375, -77.76173847806827, -644.1267292158416, -1224.677344732854, -18.63792796999289, -613.8912386644716, -964.7989745545259, -303.64625840241825, -581.0108886549185, -1047.8076398885523, -523.6320163749792, -966.8877381011898, -720.7075482084683, -908.7150252712736, -538.0828365439089, -693.699503133591, -1312.5752748587688, -598.1527852167998, -968.4632092092298, -763.4223832290417, -458.4418431272512, -1207.3062702167097, -1126.623864660181, -170.88184727827834, -957.7038956169455, -708.8060508469413, -829.8752195882696, -176.57296722935249, -745.4853844123255, -632.8530249001293, -850.7103587077635, -474.76795455206576, -713.3959851530688, -980.5744742877857, -748.9810344311925, -935.571412694015, -720.7848156430191, -755.5654255936164, -751.510500649264, -929.9731911432648, -1083.3034862633272, -588.5735614571488, -1145.0725962001586, -883.923435013929, -1187.0467686330178, -566.5549117917967, -817.9149367829776, -567.890570752101, -942.8911335022345, -678.0174411048804, -394.2898254954661, -698.5835456029947, -1143.2481619121577, -434.48849493050096, -1056.6113194501584, -428.1302503900175, -949.4324890046765, -202.892239557752, -1094.8588611970013, -1139.100736268358, -606.9790602211656, -1121.192370590048, -949.8474737325577, -549.3405128980517, -760.5549857072942, -868.1055039087761, -736.4547497639343, -787.5985035487179, -925.3294288953696], "episode_lengths": [150, 150, 85, 150, 62, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 107, 64, 73, 150, 150, 150, 150, 150, 57, 150, 150, 72, 150, 150, 47, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 105, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-519.1559464568255, -689.817579310296, -229.1636410899376, -538.4803011194074, -64.4632454945347, -508.055261069152, -1223.4687232453964, -839.1121095731801, -978.1098037190715, -1204.3434570519667, -728.8969176414384, -1192.3754295106814, -461.7677238664978, -563.628052256795, -776.2321729683796, -278.60690440147715, -1148.829909878256, -796.4286004690525, -816.1664004949334, -973.681349112061, -917.0611932021192, -343.1052669041394, -107.38194817872585, -182.11558717929455, -451.1791801147345, -681.6980234707266, -846.4742379663267, -701.1309941916003, -729.9904221498658, -30.92808628012286, -549.5689629646643, -636.5792392892375, -77.76173847806827, -644.1267292158416, -1224.677344732854, -18.63792796999289, -613.8912386644716, -964.7989745545259, -303.64625840241825, -581.0108886549185, -1047.8076398885523, -523.6320163749792, -966.8877381011898, -720.7075482084683, -908.7150252712736, -538.0828365439089, -693.699503133591, -1312.5752748587688, -598.1527852167998, -968.4632092092298, -763.4223832290417, -458.4418431272512, -1207.3062702167097, -1126.623864660181, -170.88184727827834, -957.7038956169455, -708.8060508469413, -829.8752195882696, -176.57296722935249, -745.4853844123255, -632.8530249001293, -850.7103587077635, -474.76795455206576, -713.3959851530688, -980.5744742877857, -748.9810344311925, -935.571412694015, -720.7848156430191, -755.5654255936164, -751.510500649264, -929.9731911432648, -1083.3034862633272, -588.5735614571488, -1145.0725962001586, -883.923435013929, -1187.0467686330178, -566.5549117917967, -817.9149367829776, -567.890570752101, -942.8911335022345, -678.0174411048804, -394.2898254954661, -698.5835456029947, -1143.2481619121577, -434.48849493050096, -1056.6113194501584, -428.1302503900175, -949.4324890046765, -202.892239557752, -1094.8588611970013, -1139.100736268358, -606.9790602211656, -1121.192370590048, -949.8474737325577, -549.3405128980517, -760.5549857072942, -868.1055039087761, -736.4547497639343, -787.5985035487179, -925.3294288953696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5535712733076167, "mean_inference_ms": 1.6796608798508652, "mean_action_processing_ms": 0.2775310466267845, "mean_env_wait_ms": 3.016763351221255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01262807846069336, "StateBufferConnector_ms": 0.00777745246887207, "ViewRequirementAgentConnector_ms": 0.19353222846984863}, "num_episodes": 26, "episode_return_max": -18.63792796999289, "episode_return_min": -1312.5752748587688, "episode_return_mean": -723.6330660663782, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.3730395217288, "num_env_steps_trained_throughput_per_sec": 299.3730395217288, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12627.567, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12627.493, "sample_time_ms": 1041.147, "learn_time_ms": 11520.433, "learn_throughput": 347.209, "synch_weights_time_ms": 65.056}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00007", "date": "2024-08-03_10-58-20", "timestamp": 1722662900, "time_this_iter_s": 13.375862121582031, "time_total_s": 279.5946617126465, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d3eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 279.5946617126465, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.584210526315792, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 212.54153416156768, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.075711495491366, "policy_loss": -0.009255916378848875, "vf_loss": 2.0831043905888995, "vf_explained_var": 0.9845607313637932, "kl": 0.017391252646242115, "entropy": 1.6152277025083701, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -18.63792796999289, "episode_reward_min": -1312.5752748587688, "episode_reward_mean": -741.7693358308167, "episode_len_mean": 141.16, "episode_media": {}, "episodes_timesteps_total": 14116, "policy_reward_min": {"policy_0": -1312.5752748587688}, "policy_reward_max": {"policy_0": -18.63792796999289}, "policy_reward_mean": {"policy_0": -741.7693358308167}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-549.5689629646643, -636.5792392892375, -77.76173847806827, -644.1267292158416, -1224.677344732854, -18.63792796999289, -613.8912386644716, -964.7989745545259, -303.64625840241825, -581.0108886549185, -1047.8076398885523, -523.6320163749792, -966.8877381011898, -720.7075482084683, -908.7150252712736, -538.0828365439089, -693.699503133591, -1312.5752748587688, -598.1527852167998, -968.4632092092298, -763.4223832290417, -458.4418431272512, -1207.3062702167097, -1126.623864660181, -170.88184727827834, -957.7038956169455, -708.8060508469413, -829.8752195882696, -176.57296722935249, -745.4853844123255, -632.8530249001293, -850.7103587077635, -474.76795455206576, -713.3959851530688, -980.5744742877857, -748.9810344311925, -935.571412694015, -720.7848156430191, -755.5654255936164, -751.510500649264, -929.9731911432648, -1083.3034862633272, -588.5735614571488, -1145.0725962001586, -883.923435013929, -1187.0467686330178, -566.5549117917967, -817.9149367829776, -567.890570752101, -942.8911335022345, -678.0174411048804, -394.2898254954661, -698.5835456029947, -1143.2481619121577, -434.48849493050096, -1056.6113194501584, -428.1302503900175, -949.4324890046765, -202.892239557752, -1094.8588611970013, -1139.100736268358, -606.9790602211656, -1121.192370590048, -949.8474737325577, -549.3405128980517, -760.5549857072942, -868.1055039087761, -736.4547497639343, -787.5985035487179, -925.3294288953696, -848.206101021213, -504.8598672081191, -858.6703187976381, -1119.486382667119, -752.77876148585, -1008.1141926523595, -466.9880586862806, -183.96478372624887, -940.0312948610075, -1073.352051588204, -647.8706120852627, -767.3396451483059, -895.7019077094202, -268.7274530447982, -40.47844478664149, -683.2262466608837, -584.390751566074, -1269.6044499055188, -751.7033595867732, -890.3680548430572, -201.62360110072538, -921.3504418938211, -848.0572669330529, -156.83335012735785, -747.9305201204046, -932.0750924227697, -939.6540010953211, -1078.724076411795, -751.7609062643718, -201.60345041047586], "episode_lengths": [150, 150, 72, 150, 150, 47, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 105, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 74, 150, 150, 136, 148, 150, 101, 50, 150, 150, 150, 150, 150, 66, 150, 150, 72, 150, 150, 150, 150, 150, 75], "policy_policy_0_reward": [-549.5689629646643, -636.5792392892375, -77.76173847806827, -644.1267292158416, -1224.677344732854, -18.63792796999289, -613.8912386644716, -964.7989745545259, -303.64625840241825, -581.0108886549185, -1047.8076398885523, -523.6320163749792, -966.8877381011898, -720.7075482084683, -908.7150252712736, -538.0828365439089, -693.699503133591, -1312.5752748587688, -598.1527852167998, -968.4632092092298, -763.4223832290417, -458.4418431272512, -1207.3062702167097, -1126.623864660181, -170.88184727827834, -957.7038956169455, -708.8060508469413, -829.8752195882696, -176.57296722935249, -745.4853844123255, -632.8530249001293, -850.7103587077635, -474.76795455206576, -713.3959851530688, -980.5744742877857, -748.9810344311925, -935.571412694015, -720.7848156430191, -755.5654255936164, -751.510500649264, -929.9731911432648, -1083.3034862633272, -588.5735614571488, -1145.0725962001586, -883.923435013929, -1187.0467686330178, -566.5549117917967, -817.9149367829776, -567.890570752101, -942.8911335022345, -678.0174411048804, -394.2898254954661, -698.5835456029947, -1143.2481619121577, -434.48849493050096, -1056.6113194501584, -428.1302503900175, -949.4324890046765, -202.892239557752, -1094.8588611970013, -1139.100736268358, -606.9790602211656, -1121.192370590048, -949.8474737325577, -549.3405128980517, -760.5549857072942, -868.1055039087761, -736.4547497639343, -787.5985035487179, -925.3294288953696, -848.206101021213, -504.8598672081191, -858.6703187976381, -1119.486382667119, -752.77876148585, -1008.1141926523595, -466.9880586862806, -183.96478372624887, -940.0312948610075, -1073.352051588204, -647.8706120852627, -767.3396451483059, -895.7019077094202, -268.7274530447982, -40.47844478664149, -683.2262466608837, -584.390751566074, -1269.6044499055188, -751.7033595867732, -890.3680548430572, -201.62360110072538, -921.3504418938211, -848.0572669330529, -156.83335012735785, -747.9305201204046, -932.0750924227697, -939.6540010953211, -1078.724076411795, -751.7609062643718, -201.60345041047586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536471265155217, "mean_inference_ms": 1.6796468418044577, "mean_action_processing_ms": 0.27760943541940275, "mean_env_wait_ms": 3.0196460658008304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012878656387329102, "StateBufferConnector_ms": 0.007884979248046875, "ViewRequirementAgentConnector_ms": 0.197617769241333}, "num_episodes": 30, "episode_return_max": -18.63792796999289, "episode_return_min": -1312.5752748587688, "episode_return_mean": -741.7693358308167, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.5785216898877, "num_env_steps_trained_throughput_per_sec": 303.5785216898877, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12845.568, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12845.492, "sample_time_ms": 1046.04, "learn_time_ms": 11732.345, "learn_throughput": 340.938, "synch_weights_time_ms": 66.235}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00007", "date": "2024-08-03_10-58-33", "timestamp": 1722662913, "time_this_iter_s": 13.190266370773315, "time_total_s": 292.7849280834198, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f51990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 292.7849280834198, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.768421052631577, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 190.15584606130918, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.126452260029813, "policy_loss": -0.01356653215722569, "vf_loss": 2.1377733821670213, "vf_explained_var": 0.9931323627630869, "kl": 0.019005670416140673, "entropy": 1.5557274285703897, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -40.47844478664149, "episode_reward_min": -1269.6044499055188, "episode_reward_mean": -728.380813874626, "episode_len_mean": 141.44, "episode_media": {}, "episodes_timesteps_total": 14144, "policy_reward_min": {"policy_0": -1269.6044499055188}, "policy_reward_max": {"policy_0": -40.47844478664149}, "policy_reward_mean": {"policy_0": -728.380813874626}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-829.8752195882696, -176.57296722935249, -745.4853844123255, -632.8530249001293, -850.7103587077635, -474.76795455206576, -713.3959851530688, -980.5744742877857, -748.9810344311925, -935.571412694015, -720.7848156430191, -755.5654255936164, -751.510500649264, -929.9731911432648, -1083.3034862633272, -588.5735614571488, -1145.0725962001586, -883.923435013929, -1187.0467686330178, -566.5549117917967, -817.9149367829776, -567.890570752101, -942.8911335022345, -678.0174411048804, -394.2898254954661, -698.5835456029947, -1143.2481619121577, -434.48849493050096, -1056.6113194501584, -428.1302503900175, -949.4324890046765, -202.892239557752, -1094.8588611970013, -1139.100736268358, -606.9790602211656, -1121.192370590048, -949.8474737325577, -549.3405128980517, -760.5549857072942, -868.1055039087761, -736.4547497639343, -787.5985035487179, -925.3294288953696, -848.206101021213, -504.8598672081191, -858.6703187976381, -1119.486382667119, -752.77876148585, -1008.1141926523595, -466.9880586862806, -183.96478372624887, -940.0312948610075, -1073.352051588204, -647.8706120852627, -767.3396451483059, -895.7019077094202, -268.7274530447982, -40.47844478664149, -683.2262466608837, -584.390751566074, -1269.6044499055188, -751.7033595867732, -890.3680548430572, -201.62360110072538, -921.3504418938211, -848.0572669330529, -156.83335012735785, -747.9305201204046, -932.0750924227697, -939.6540010953211, -1078.724076411795, -751.7609062643718, -201.60345041047586, -907.4207818806036, -731.8009289103697, -834.4088782130696, -810.9080619300242, -567.2453373897423, -379.985376666461, -98.1242955127168, -325.72338838308326, -1036.6082730454832, -1104.7038866272937, -681.978321071579, -739.6882063621754, -1230.191957444077, -504.91989933020756, -1137.4663160273149, -595.2349408164071, -288.4393522282118, -683.6819897361468, -174.40154030332585, -280.4496739971559, -757.5137264171044, -1225.586230338577, -230.3683820232159, -563.6095330613684, -597.0105917863207, -1049.3796858146452, -410.9072837733448], "episode_lengths": [150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 74, 150, 150, 136, 148, 150, 101, 50, 150, 150, 150, 150, 150, 66, 150, 150, 72, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 145, 150, 150, 150, 150, 85, 150, 107, 132, 150, 150, 116, 150, 150, 150, 150], "policy_policy_0_reward": [-829.8752195882696, -176.57296722935249, -745.4853844123255, -632.8530249001293, -850.7103587077635, -474.76795455206576, -713.3959851530688, -980.5744742877857, -748.9810344311925, -935.571412694015, -720.7848156430191, -755.5654255936164, -751.510500649264, -929.9731911432648, -1083.3034862633272, -588.5735614571488, -1145.0725962001586, -883.923435013929, -1187.0467686330178, -566.5549117917967, -817.9149367829776, -567.890570752101, -942.8911335022345, -678.0174411048804, -394.2898254954661, -698.5835456029947, -1143.2481619121577, -434.48849493050096, -1056.6113194501584, -428.1302503900175, -949.4324890046765, -202.892239557752, -1094.8588611970013, -1139.100736268358, -606.9790602211656, -1121.192370590048, -949.8474737325577, -549.3405128980517, -760.5549857072942, -868.1055039087761, -736.4547497639343, -787.5985035487179, -925.3294288953696, -848.206101021213, -504.8598672081191, -858.6703187976381, -1119.486382667119, -752.77876148585, -1008.1141926523595, -466.9880586862806, -183.96478372624887, -940.0312948610075, -1073.352051588204, -647.8706120852627, -767.3396451483059, -895.7019077094202, -268.7274530447982, -40.47844478664149, -683.2262466608837, -584.390751566074, -1269.6044499055188, -751.7033595867732, -890.3680548430572, -201.62360110072538, -921.3504418938211, -848.0572669330529, -156.83335012735785, -747.9305201204046, -932.0750924227697, -939.6540010953211, -1078.724076411795, -751.7609062643718, -201.60345041047586, -907.4207818806036, -731.8009289103697, -834.4088782130696, -810.9080619300242, -567.2453373897423, -379.985376666461, -98.1242955127168, -325.72338838308326, -1036.6082730454832, -1104.7038866272937, -681.978321071579, -739.6882063621754, -1230.191957444077, -504.91989933020756, -1137.4663160273149, -595.2349408164071, -288.4393522282118, -683.6819897361468, -174.40154030332585, -280.4496739971559, -757.5137264171044, -1225.586230338577, -230.3683820232159, -563.6095330613684, -597.0105917863207, -1049.3796858146452, -410.9072837733448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538225132259244, "mean_inference_ms": 1.6804458098864408, "mean_action_processing_ms": 0.2776366501019724, "mean_env_wait_ms": 3.0221164560004463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012671470642089844, "StateBufferConnector_ms": 0.008086204528808594, "ViewRequirementAgentConnector_ms": 0.20119071006774902}, "num_episodes": 27, "episode_return_max": -40.47844478664149, "episode_return_min": -1269.6044499055188, "episode_return_mean": -728.380813874626, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.5974284007365, "num_env_steps_trained_throughput_per_sec": 304.5974284007365, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13200.767, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13200.69, "sample_time_ms": 1047.449, "learn_time_ms": 12083.915, "learn_throughput": 331.019, "synch_weights_time_ms": 68.446}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00007", "date": "2024-08-03_10-58-47", "timestamp": 1722662927, "time_this_iter_s": 13.143634557723999, "time_total_s": 305.9285626411438, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f525f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 305.9285626411438, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.649999999999999, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 187.23753686944644, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.0183681322261693, "policy_loss": -0.014022335382469464, "vf_loss": 2.030125062043468, "vf_explained_var": 0.9906745137646794, "kl": 0.01896371690242328, "entropy": 1.5273435158034165, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -16.259784566117744, "episode_reward_min": -1269.6044499055188, "episode_reward_mean": -710.398344178128, "episode_len_mean": 140.64, "episode_media": {}, "episodes_timesteps_total": 14064, "policy_reward_min": {"policy_0": -1269.6044499055188}, "policy_reward_max": {"policy_0": -16.259784566117744}, "policy_reward_mean": {"policy_0": -710.398344178128}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1094.8588611970013, -1139.100736268358, -606.9790602211656, -1121.192370590048, -949.8474737325577, -549.3405128980517, -760.5549857072942, -868.1055039087761, -736.4547497639343, -787.5985035487179, -925.3294288953696, -848.206101021213, -504.8598672081191, -858.6703187976381, -1119.486382667119, -752.77876148585, -1008.1141926523595, -466.9880586862806, -183.96478372624887, -940.0312948610075, -1073.352051588204, -647.8706120852627, -767.3396451483059, -895.7019077094202, -268.7274530447982, -40.47844478664149, -683.2262466608837, -584.390751566074, -1269.6044499055188, -751.7033595867732, -890.3680548430572, -201.62360110072538, -921.3504418938211, -848.0572669330529, -156.83335012735785, -747.9305201204046, -932.0750924227697, -939.6540010953211, -1078.724076411795, -751.7609062643718, -201.60345041047586, -907.4207818806036, -731.8009289103697, -834.4088782130696, -810.9080619300242, -567.2453373897423, -379.985376666461, -98.1242955127168, -325.72338838308326, -1036.6082730454832, -1104.7038866272937, -681.978321071579, -739.6882063621754, -1230.191957444077, -504.91989933020756, -1137.4663160273149, -595.2349408164071, -288.4393522282118, -683.6819897361468, -174.40154030332585, -280.4496739971559, -757.5137264171044, -1225.586230338577, -230.3683820232159, -563.6095330613684, -597.0105917863207, -1049.3796858146452, -410.9072837733448, -467.17305375795536, -637.8576730892952, -830.3630500529338, -16.259784566117744, -967.7009016581221, -490.0389666074152, -604.3624978877016, -339.83552665323896, -1013.2714469244661, -195.56235866420116, -991.1419650834517, -860.2236493388464, -625.5562722927115, -1078.967966773784, -910.2746510226938, -683.007756228778, -357.62696321118585, -714.2850993187725, -917.8116854474446, -364.01382539321384, -1045.0959301714745, -611.0585165430332, -995.2958606959893, -1070.7675026551597, -557.418840092854, -993.9151349973126, -743.1648697402609, -403.6311281523005, -985.9792156962086, -649.4814135180119, -425.3388100501499, -670.7576308955553], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 74, 150, 150, 136, 148, 150, 101, 50, 150, 150, 150, 150, 150, 66, 150, 150, 72, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 145, 150, 150, 150, 150, 85, 150, 107, 132, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150], "policy_policy_0_reward": [-1094.8588611970013, -1139.100736268358, -606.9790602211656, -1121.192370590048, -949.8474737325577, -549.3405128980517, -760.5549857072942, -868.1055039087761, -736.4547497639343, -787.5985035487179, -925.3294288953696, -848.206101021213, -504.8598672081191, -858.6703187976381, -1119.486382667119, -752.77876148585, -1008.1141926523595, -466.9880586862806, -183.96478372624887, -940.0312948610075, -1073.352051588204, -647.8706120852627, -767.3396451483059, -895.7019077094202, -268.7274530447982, -40.47844478664149, -683.2262466608837, -584.390751566074, -1269.6044499055188, -751.7033595867732, -890.3680548430572, -201.62360110072538, -921.3504418938211, -848.0572669330529, -156.83335012735785, -747.9305201204046, -932.0750924227697, -939.6540010953211, -1078.724076411795, -751.7609062643718, -201.60345041047586, -907.4207818806036, -731.8009289103697, -834.4088782130696, -810.9080619300242, -567.2453373897423, -379.985376666461, -98.1242955127168, -325.72338838308326, -1036.6082730454832, -1104.7038866272937, -681.978321071579, -739.6882063621754, -1230.191957444077, -504.91989933020756, -1137.4663160273149, -595.2349408164071, -288.4393522282118, -683.6819897361468, -174.40154030332585, -280.4496739971559, -757.5137264171044, -1225.586230338577, -230.3683820232159, -563.6095330613684, -597.0105917863207, -1049.3796858146452, -410.9072837733448, -467.17305375795536, -637.8576730892952, -830.3630500529338, -16.259784566117744, -967.7009016581221, -490.0389666074152, -604.3624978877016, -339.83552665323896, -1013.2714469244661, -195.56235866420116, -991.1419650834517, -860.2236493388464, -625.5562722927115, -1078.967966773784, -910.2746510226938, -683.007756228778, -357.62696321118585, -714.2850993187725, -917.8116854474446, -364.01382539321384, -1045.0959301714745, -611.0585165430332, -995.2958606959893, -1070.7675026551597, -557.418840092854, -993.9151349973126, -743.1648697402609, -403.6311281523005, -985.9792156962086, -649.4814135180119, -425.3388100501499, -670.7576308955553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539441519346675, "mean_inference_ms": 1.6809219820357548, "mean_action_processing_ms": 0.27751882938028055, "mean_env_wait_ms": 3.0233479718763134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013017654418945312, "StateBufferConnector_ms": 0.008383750915527344, "ViewRequirementAgentConnector_ms": 0.20738816261291504}, "num_episodes": 32, "episode_return_max": -16.259784566117744, "episode_return_min": -1269.6044499055188, "episode_return_mean": -710.398344178128, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.0967292314892, "num_env_steps_trained_throughput_per_sec": 297.0967292314892, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13207.736, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13207.66, "sample_time_ms": 1047.79, "learn_time_ms": 12091.104, "learn_throughput": 330.822, "synch_weights_time_ms": 67.892}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00007", "date": "2024-08-03_10-59-00", "timestamp": 1722662940, "time_this_iter_s": 13.4754638671875, "time_total_s": 319.4040265083313, "pid": 517218, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d2e60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 319.4040265083313, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.36, "ram_util_percent": 27.7}}
