{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0704843685341379, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.485144599278767, "policy_loss": -0.009052942147051605, "vf_loss": 9.492038814226786, "vf_explained_var": 0.013222493665913741, "kl": 0.01150751651224103, "entropy": 1.4280816368758678, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -25.829575659072837, "episode_reward_min": -1062.6409867870896, "episode_reward_mean": -633.4852106127697, "episode_len_mean": 129.95833333333334, "episode_media": {}, "episodes_timesteps_total": 3119, "policy_reward_min": {"policy_0": -1062.6409867870896}, "policy_reward_max": {"policy_0": -25.829575659072837}, "policy_reward_mean": {"policy_0": -633.4852106127697}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-954.9072282800531, -1033.3412362860167, -704.8685900417154, -509.0185688480143, -752.970963326987, -793.6306230859944, -326.8372448227229, -1011.4595944879005, -164.62665114562307, -25.829575659072837, -927.4975357677166, -234.50576585473877, -922.9266210176289, -1062.6409867870896, -297.5484658235325, -74.58283718114389, -470.3614027056985, -245.53167839851082, -699.6078475316617, -1048.9613086190918, -729.1027903577823, -829.4152117055472, -897.1358808621688, -486.3364461100642], "episode_lengths": [150, 150, 145, 146, 150, 150, 150, 150, 63, 60, 150, 111, 150, 150, 94, 60, 130, 96, 150, 150, 150, 150, 150, 114], "policy_policy_0_reward": [-954.9072282800531, -1033.3412362860167, -704.8685900417154, -509.0185688480143, -752.970963326987, -793.6306230859944, -326.8372448227229, -1011.4595944879005, -164.62665114562307, -25.829575659072837, -927.4975357677166, -234.50576585473877, -922.9266210176289, -1062.6409867870896, -297.5484658235325, -74.58283718114389, -470.3614027056985, -245.53167839851082, -699.6078475316617, -1048.9613086190918, -729.1027903577823, -829.4152117055472, -897.1358808621688, -486.3364461100642]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5629550347122, "mean_inference_ms": 1.6713833146625097, "mean_action_processing_ms": 0.28213841933400235, "mean_env_wait_ms": 2.9707635000356247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011345744132995605, "StateBufferConnector_ms": 0.00819861888885498, "ViewRequirementAgentConnector_ms": 0.18016397953033447}, "num_episodes": 24, "episode_return_max": -25.829575659072837, "episode_return_min": -1062.6409867870896, "episode_return_mean": -633.4852106127697, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.43384409731914, "num_env_steps_trained_throughput_per_sec": 313.43384409731914, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12761.874, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12761.808, "sample_time_ms": 1025.996, "learn_time_ms": 11670.099, "learn_throughput": 342.756, "synch_weights_time_ms": 64.879}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00006", "date": "2024-08-03_10-48-07", "timestamp": 1722662287, "time_this_iter_s": 12.77436113357544, "time_total_s": 12.77436113357544, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c521000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.77436113357544, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 13.010526315789477, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.913223923339198, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.186792217195034, "policy_loss": -0.012703855108702556, "vf_loss": 9.19656830728054, "vf_explained_var": 0.09535210449248552, "kl": 0.015371018542949364, "entropy": 1.4647530172020198, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -16.090937104594282, "episode_reward_min": -1334.1537744242737, "episode_reward_mean": -618.4062871463996, "episode_len_mean": 128.92, "episode_media": {}, "episodes_timesteps_total": 6446, "policy_reward_min": {"policy_0": -1334.1537744242737}, "policy_reward_max": {"policy_0": -16.090937104594282}, "policy_reward_mean": {"policy_0": -618.4062871463996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-954.9072282800531, -1033.3412362860167, -704.8685900417154, -509.0185688480143, -752.970963326987, -793.6306230859944, -326.8372448227229, -1011.4595944879005, -164.62665114562307, -25.829575659072837, -927.4975357677166, -234.50576585473877, -922.9266210176289, -1062.6409867870896, -297.5484658235325, -74.58283718114389, -470.3614027056985, -245.53167839851082, -699.6078475316617, -1048.9613086190918, -729.1027903577823, -829.4152117055472, -897.1358808621688, -486.3364461100642, -32.90727948211719, -834.3390914468283, -1151.920128636096, -594.7729055502783, -791.1046628267114, -596.8405360158564, -133.3616635776456, -594.869091869198, -17.866726732865818, -1157.0617215030195, -30.177285276590403, -274.2143939056844, -887.5019468646877, -928.5260192524628, -270.847484074922, -710.3854848252204, -621.4084403058531, -273.1677753144294, -869.264056945243, -1334.1537744242737, -854.8570547833258, -694.5995446406043, -16.090937104594282, -549.6988055406521, -1014.5159815726357, -482.2165101417043], "episode_lengths": [150, 150, 145, 146, 150, 150, 150, 150, 63, 60, 150, 111, 150, 150, 94, 60, 130, 96, 150, 150, 150, 150, 150, 114, 66, 150, 150, 150, 150, 150, 100, 150, 45, 150, 44, 84, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 38, 150, 150, 150], "policy_policy_0_reward": [-954.9072282800531, -1033.3412362860167, -704.8685900417154, -509.0185688480143, -752.970963326987, -793.6306230859944, -326.8372448227229, -1011.4595944879005, -164.62665114562307, -25.829575659072837, -927.4975357677166, -234.50576585473877, -922.9266210176289, -1062.6409867870896, -297.5484658235325, -74.58283718114389, -470.3614027056985, -245.53167839851082, -699.6078475316617, -1048.9613086190918, -729.1027903577823, -829.4152117055472, -897.1358808621688, -486.3364461100642, -32.90727948211719, -834.3390914468283, -1151.920128636096, -594.7729055502783, -791.1046628267114, -596.8405360158564, -133.3616635776456, -594.869091869198, -17.866726732865818, -1157.0617215030195, -30.177285276590403, -274.2143939056844, -887.5019468646877, -928.5260192524628, -270.847484074922, -710.3854848252204, -621.4084403058531, -273.1677753144294, -869.264056945243, -1334.1537744242737, -854.8570547833258, -694.5995446406043, -16.090937104594282, -549.6988055406521, -1014.5159815726357, -482.2165101417043]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5626443248665611, "mean_inference_ms": 1.6803896628270365, "mean_action_processing_ms": 0.28280770888793527, "mean_env_wait_ms": 2.972370310126974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013241291046142578, "StateBufferConnector_ms": 0.008480548858642578, "ViewRequirementAgentConnector_ms": 0.18491220474243164}, "num_episodes": 26, "episode_return_max": -16.090937104594282, "episode_return_min": -1334.1537744242737, "episode_return_mean": -618.4062871463996, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.1348686252493, "num_env_steps_trained_throughput_per_sec": 302.1348686252493, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13000.505, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13000.429, "sample_time_ms": 1021.762, "learn_time_ms": 11908.377, "learn_throughput": 335.898, "synch_weights_time_ms": 69.489}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00006", "date": "2024-08-03_10-48-20", "timestamp": 1722662300, "time_this_iter_s": 13.250893354415894, "time_total_s": 26.025254487991333, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5204c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.025254487991333, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.61578947368421, "ram_util_percent": 27.50526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.701195258491984, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.376577282945314, "policy_loss": -0.014094745923648589, "vf_loss": 8.38745987812678, "vf_explained_var": 0.3944745980824033, "kl": 0.016812758634902517, "entropy": 1.503981023778518, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -16.090937104594282, "episode_reward_min": -1334.1537744242737, "episode_reward_mean": -629.7967848190302, "episode_len_mean": 130.62820512820514, "episode_media": {}, "episodes_timesteps_total": 10189, "policy_reward_min": {"policy_0": -1334.1537744242737}, "policy_reward_max": {"policy_0": -16.090937104594282}, "policy_reward_mean": {"policy_0": -629.7967848190302}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-954.9072282800531, -1033.3412362860167, -704.8685900417154, -509.0185688480143, -752.970963326987, -793.6306230859944, -326.8372448227229, -1011.4595944879005, -164.62665114562307, -25.829575659072837, -927.4975357677166, -234.50576585473877, -922.9266210176289, -1062.6409867870896, -297.5484658235325, -74.58283718114389, -470.3614027056985, -245.53167839851082, -699.6078475316617, -1048.9613086190918, -729.1027903577823, -829.4152117055472, -897.1358808621688, -486.3364461100642, -32.90727948211719, -834.3390914468283, -1151.920128636096, -594.7729055502783, -791.1046628267114, -596.8405360158564, -133.3616635776456, -594.869091869198, -17.866726732865818, -1157.0617215030195, -30.177285276590403, -274.2143939056844, -887.5019468646877, -928.5260192524628, -270.847484074922, -710.3854848252204, -621.4084403058531, -273.1677753144294, -869.264056945243, -1334.1537744242737, -854.8570547833258, -694.5995446406043, -16.090937104594282, -549.6988055406521, -1014.5159815726357, -482.2165101417043, -818.8880475501514, -900.0532201567165, -947.6799029537991, -722.2965282624649, -446.5009682901666, -234.82365547325108, -901.75045148568, -613.3978330272508, -534.2012676166681, -455.51569082592886, -971.155471665656, -122.58796424805168, -676.0296833388676, -983.8966466470368, -73.96648164665378, -37.20469758152103, -766.2965270905285, -758.5459968376673, -790.5170722032265, -455.08176605275725, -172.44031401474317, -1106.5458830714904, -476.26115968388484, -1245.4824029764668, -1022.6552112447216, -865.8124417632871, -610.6224496598487, -493.6251231958947], "episode_lengths": [150, 150, 145, 146, 150, 150, 150, 150, 63, 60, 150, 111, 150, 150, 94, 60, 130, 96, 150, 150, 150, 150, 150, 114, 66, 150, 150, 150, 150, 150, 100, 150, 45, 150, 44, 84, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 109, 91, 150, 150, 150, 120, 150, 66, 150, 150, 57, 57, 150, 146, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-954.9072282800531, -1033.3412362860167, -704.8685900417154, -509.0185688480143, -752.970963326987, -793.6306230859944, -326.8372448227229, -1011.4595944879005, -164.62665114562307, -25.829575659072837, -927.4975357677166, -234.50576585473877, -922.9266210176289, -1062.6409867870896, -297.5484658235325, -74.58283718114389, -470.3614027056985, -245.53167839851082, -699.6078475316617, -1048.9613086190918, -729.1027903577823, -829.4152117055472, -897.1358808621688, -486.3364461100642, -32.90727948211719, -834.3390914468283, -1151.920128636096, -594.7729055502783, -791.1046628267114, -596.8405360158564, -133.3616635776456, -594.869091869198, -17.866726732865818, -1157.0617215030195, -30.177285276590403, -274.2143939056844, -887.5019468646877, -928.5260192524628, -270.847484074922, -710.3854848252204, -621.4084403058531, -273.1677753144294, -869.264056945243, -1334.1537744242737, -854.8570547833258, -694.5995446406043, -16.090937104594282, -549.6988055406521, -1014.5159815726357, -482.2165101417043, -818.8880475501514, -900.0532201567165, -947.6799029537991, -722.2965282624649, -446.5009682901666, -234.82365547325108, -901.75045148568, -613.3978330272508, -534.2012676166681, -455.51569082592886, -971.155471665656, -122.58796424805168, -676.0296833388676, -983.8966466470368, -73.96648164665378, -37.20469758152103, -766.2965270905285, -758.5459968376673, -790.5170722032265, -455.08176605275725, -172.44031401474317, -1106.5458830714904, -476.26115968388484, -1245.4824029764668, -1022.6552112447216, -865.8124417632871, -610.6224496598487, -493.6251231958947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621338922921679, "mean_inference_ms": 1.6804951405589912, "mean_action_processing_ms": 0.28242254392901334, "mean_env_wait_ms": 2.9752914015599217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013315066313132262, "StateBufferConnector_ms": 0.008635643200996595, "ViewRequirementAgentConnector_ms": 0.1876699618804149}, "num_episodes": 28, "episode_return_max": -16.090937104594282, "episode_return_min": -1334.1537744242737, "episode_return_mean": -629.7967848190302, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.41061478503883, "num_env_steps_trained_throughput_per_sec": 304.41061478503883, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13047.057, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13046.983, "sample_time_ms": 1016.436, "learn_time_ms": 11964.228, "learn_throughput": 334.33, "synch_weights_time_ms": 65.501}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00006", "date": "2024-08-03_10-48-34", "timestamp": 1722662314, "time_this_iter_s": 13.152650117874146, "time_total_s": 39.17790460586548, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c520ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.17790460586548, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.805555555555557, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.505305071671806, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.988589502622684, "policy_loss": -0.01200136651508122, "vf_loss": 5.997048072765271, "vf_explained_var": 0.7171295678243041, "kl": 0.018472222810222167, "entropy": 1.5164989373336235, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -16.090937104594282, "episode_reward_min": -1334.1537744242737, "episode_reward_mean": -674.7433937009964, "episode_len_mean": 132.7, "episode_media": {}, "episodes_timesteps_total": 13270, "policy_reward_min": {"policy_0": -1334.1537744242737}, "policy_reward_max": {"policy_0": -16.090937104594282}, "policy_reward_mean": {"policy_0": -674.7433937009964}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011.4595944879005, -164.62665114562307, -25.829575659072837, -927.4975357677166, -234.50576585473877, -922.9266210176289, -1062.6409867870896, -297.5484658235325, -74.58283718114389, -470.3614027056985, -245.53167839851082, -699.6078475316617, -1048.9613086190918, -729.1027903577823, -829.4152117055472, -897.1358808621688, -486.3364461100642, -32.90727948211719, -834.3390914468283, -1151.920128636096, -594.7729055502783, -791.1046628267114, -596.8405360158564, -133.3616635776456, -594.869091869198, -17.866726732865818, -1157.0617215030195, -30.177285276590403, -274.2143939056844, -887.5019468646877, -928.5260192524628, -270.847484074922, -710.3854848252204, -621.4084403058531, -273.1677753144294, -869.264056945243, -1334.1537744242737, -854.8570547833258, -694.5995446406043, -16.090937104594282, -549.6988055406521, -1014.5159815726357, -482.2165101417043, -818.8880475501514, -900.0532201567165, -947.6799029537991, -722.2965282624649, -446.5009682901666, -234.82365547325108, -901.75045148568, -613.3978330272508, -534.2012676166681, -455.51569082592886, -971.155471665656, -122.58796424805168, -676.0296833388676, -983.8966466470368, -73.96648164665378, -37.20469758152103, -766.2965270905285, -758.5459968376673, -790.5170722032265, -455.08176605275725, -172.44031401474317, -1106.5458830714904, -476.26115968388484, -1245.4824029764668, -1022.6552112447216, -865.8124417632871, -610.6224496598487, -493.6251231958947, -936.5813289345613, -403.92181077457957, -1042.3308922728083, -247.70899428351342, -649.0950345239318, -797.9239023504462, -887.2226215927437, -331.2183065371058, -844.2736171191858, -808.8470260586012, -958.2548309055256, -825.1511160603653, -940.0817940704578, -971.8478971135694, -199.95966063507416, -884.7406790663476, -915.197632121067, -741.7276648425878, -847.5174249101692, -871.7909356262428, -1094.7596106790702, -1101.0849439314143, -934.8550372240155, -1152.8860110339017, -936.8359798577894, -943.6465422922656, -212.82110350749525, -730.8006655111615, -1212.6815450707875], "episode_lengths": [150, 63, 60, 150, 111, 150, 150, 94, 60, 130, 96, 150, 150, 150, 150, 150, 114, 66, 150, 150, 150, 150, 150, 100, 150, 45, 150, 44, 84, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 109, 91, 150, 150, 150, 120, 150, 66, 150, 150, 57, 57, 150, 146, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 96, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150], "policy_policy_0_reward": [-1011.4595944879005, -164.62665114562307, -25.829575659072837, -927.4975357677166, -234.50576585473877, -922.9266210176289, -1062.6409867870896, -297.5484658235325, -74.58283718114389, -470.3614027056985, -245.53167839851082, -699.6078475316617, -1048.9613086190918, -729.1027903577823, -829.4152117055472, -897.1358808621688, -486.3364461100642, -32.90727948211719, -834.3390914468283, -1151.920128636096, -594.7729055502783, -791.1046628267114, -596.8405360158564, -133.3616635776456, -594.869091869198, -17.866726732865818, -1157.0617215030195, -30.177285276590403, -274.2143939056844, -887.5019468646877, -928.5260192524628, -270.847484074922, -710.3854848252204, -621.4084403058531, -273.1677753144294, -869.264056945243, -1334.1537744242737, -854.8570547833258, -694.5995446406043, -16.090937104594282, -549.6988055406521, -1014.5159815726357, -482.2165101417043, -818.8880475501514, -900.0532201567165, -947.6799029537991, -722.2965282624649, -446.5009682901666, -234.82365547325108, -901.75045148568, -613.3978330272508, -534.2012676166681, -455.51569082592886, -971.155471665656, -122.58796424805168, -676.0296833388676, -983.8966466470368, -73.96648164665378, -37.20469758152103, -766.2965270905285, -758.5459968376673, -790.5170722032265, -455.08176605275725, -172.44031401474317, -1106.5458830714904, -476.26115968388484, -1245.4824029764668, -1022.6552112447216, -865.8124417632871, -610.6224496598487, -493.6251231958947, -936.5813289345613, -403.92181077457957, -1042.3308922728083, -247.70899428351342, -649.0950345239318, -797.9239023504462, -887.2226215927437, -331.2183065371058, -844.2736171191858, -808.8470260586012, -958.2548309055256, -825.1511160603653, -940.0817940704578, -971.8478971135694, -199.95966063507416, -884.7406790663476, -915.197632121067, -741.7276648425878, -847.5174249101692, -871.7909356262428, -1094.7596106790702, -1101.0849439314143, -934.8550372240155, -1152.8860110339017, -936.8359798577894, -943.6465422922656, -212.82110350749525, -730.8006655111615, -1212.6815450707875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5611878862373991, "mean_inference_ms": 1.6832039630296054, "mean_action_processing_ms": 0.28259660197875064, "mean_env_wait_ms": 2.9775204952187715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01368570327758789, "StateBufferConnector_ms": 0.008719205856323242, "ViewRequirementAgentConnector_ms": 0.18889355659484863}, "num_episodes": 29, "episode_return_max": -16.090937104594282, "episode_return_min": -1334.1537744242737, "episode_return_mean": -674.7433937009964, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.18583790197164, "num_env_steps_trained_throughput_per_sec": 306.18583790197164, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13051.287, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13051.21, "sample_time_ms": 1018.283, "learn_time_ms": 11965.658, "learn_throughput": 334.29, "synch_weights_time_ms": 66.43}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00006", "date": "2024-08-03_10-48-47", "timestamp": 1722662327, "time_this_iter_s": 13.078070163726807, "time_total_s": 52.255974769592285, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c521750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.255974769592285, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.489473684210527, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 73.31902647515138, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.751616474489371, "policy_loss": -0.010899067665741313, "vf_loss": 4.759492893268665, "vf_explained_var": 0.8720946169768771, "kl": 0.015839110692468242, "entropy": 1.4516814332455397, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -16.090937104594282, "episode_reward_min": -1334.1537744242737, "episode_reward_mean": -735.8900308395679, "episode_len_mean": 139.5, "episode_media": {}, "episodes_timesteps_total": 13950, "policy_reward_min": {"policy_0": -1334.1537744242737}, "policy_reward_max": {"policy_0": -16.090937104594282}, "policy_reward_mean": {"policy_0": -735.8900308395679}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-928.5260192524628, -270.847484074922, -710.3854848252204, -621.4084403058531, -273.1677753144294, -869.264056945243, -1334.1537744242737, -854.8570547833258, -694.5995446406043, -16.090937104594282, -549.6988055406521, -1014.5159815726357, -482.2165101417043, -818.8880475501514, -900.0532201567165, -947.6799029537991, -722.2965282624649, -446.5009682901666, -234.82365547325108, -901.75045148568, -613.3978330272508, -534.2012676166681, -455.51569082592886, -971.155471665656, -122.58796424805168, -676.0296833388676, -983.8966466470368, -73.96648164665378, -37.20469758152103, -766.2965270905285, -758.5459968376673, -790.5170722032265, -455.08176605275725, -172.44031401474317, -1106.5458830714904, -476.26115968388484, -1245.4824029764668, -1022.6552112447216, -865.8124417632871, -610.6224496598487, -493.6251231958947, -936.5813289345613, -403.92181077457957, -1042.3308922728083, -247.70899428351342, -649.0950345239318, -797.9239023504462, -887.2226215927437, -331.2183065371058, -844.2736171191858, -808.8470260586012, -958.2548309055256, -825.1511160603653, -940.0817940704578, -971.8478971135694, -199.95966063507416, -884.7406790663476, -915.197632121067, -741.7276648425878, -847.5174249101692, -871.7909356262428, -1094.7596106790702, -1101.0849439314143, -934.8550372240155, -1152.8860110339017, -936.8359798577894, -943.6465422922656, -212.82110350749525, -730.8006655111615, -1212.6815450707875, -948.4651361422854, -749.176568935249, -1197.363895367887, -1108.6104623221406, -437.92849642025965, -450.80830501443637, -1272.4873977843997, -863.5259340643563, -860.3647037426639, -687.9524943444609, -1241.867940943141, -948.9686610866631, -1069.046014337495, -993.8870930674316, -158.66837387431625, -716.7605715100797, -863.134940193351, -568.3347636327687, -134.96605763268477, -652.452982101392, -297.31456970384755, -596.0937109821186, -530.9353318767058, -244.7431678174178, -1048.3256387071503, -802.4752338707086, -1244.8173561266703, -1046.633329179855, -1062.610367802997, -540.9522489747812], "episode_lengths": [150, 150, 150, 150, 100, 150, 150, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 109, 91, 150, 150, 150, 120, 150, 66, 150, 150, 57, 57, 150, 146, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 96, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 60, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-928.5260192524628, -270.847484074922, -710.3854848252204, -621.4084403058531, -273.1677753144294, -869.264056945243, -1334.1537744242737, -854.8570547833258, -694.5995446406043, -16.090937104594282, -549.6988055406521, -1014.5159815726357, -482.2165101417043, -818.8880475501514, -900.0532201567165, -947.6799029537991, -722.2965282624649, -446.5009682901666, -234.82365547325108, -901.75045148568, -613.3978330272508, -534.2012676166681, -455.51569082592886, -971.155471665656, -122.58796424805168, -676.0296833388676, -983.8966466470368, -73.96648164665378, -37.20469758152103, -766.2965270905285, -758.5459968376673, -790.5170722032265, -455.08176605275725, -172.44031401474317, -1106.5458830714904, -476.26115968388484, -1245.4824029764668, -1022.6552112447216, -865.8124417632871, -610.6224496598487, -493.6251231958947, -936.5813289345613, -403.92181077457957, -1042.3308922728083, -247.70899428351342, -649.0950345239318, -797.9239023504462, -887.2226215927437, -331.2183065371058, -844.2736171191858, -808.8470260586012, -958.2548309055256, -825.1511160603653, -940.0817940704578, -971.8478971135694, -199.95966063507416, -884.7406790663476, -915.197632121067, -741.7276648425878, -847.5174249101692, -871.7909356262428, -1094.7596106790702, -1101.0849439314143, -934.8550372240155, -1152.8860110339017, -936.8359798577894, -943.6465422922656, -212.82110350749525, -730.8006655111615, -1212.6815450707875, -948.4651361422854, -749.176568935249, -1197.363895367887, -1108.6104623221406, -437.92849642025965, -450.80830501443637, -1272.4873977843997, -863.5259340643563, -860.3647037426639, -687.9524943444609, -1241.867940943141, -948.9686610866631, -1069.046014337495, -993.8870930674316, -158.66837387431625, -716.7605715100797, -863.134940193351, -568.3347636327687, -134.96605763268477, -652.452982101392, -297.31456970384755, -596.0937109821186, -530.9353318767058, -244.7431678174178, -1048.3256387071503, -802.4752338707086, -1244.8173561266703, -1046.633329179855, -1062.610367802997, -540.9522489747812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5624093741065438, "mean_inference_ms": 1.6921444977069724, "mean_action_processing_ms": 0.2833292490615016, "mean_env_wait_ms": 2.989919216789711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014209270477294922, "StateBufferConnector_ms": 0.009070873260498047, "ViewRequirementAgentConnector_ms": 0.19436955451965332}, "num_episodes": 30, "episode_return_max": -16.090937104594282, "episode_return_min": -1334.1537744242737, "episode_return_mean": -735.8900308395679, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.7497659766339, "num_env_steps_trained_throughput_per_sec": 312.7497659766339, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12998.988, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12998.912, "sample_time_ms": 1034.019, "learn_time_ms": 11895.324, "learn_throughput": 336.267, "synch_weights_time_ms": 68.738}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00006", "date": "2024-08-03_10-49-00", "timestamp": 1722662340, "time_this_iter_s": 12.801970481872559, "time_total_s": 65.05794525146484, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c521090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 65.05794525146484, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 14.394444444444446, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.93527478476365, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.973203219721715, "policy_loss": -0.011968677698556954, "vf_loss": 3.9818911500275136, "vf_explained_var": 0.9544199465463559, "kl": 0.017095353223400403, "entropy": 1.3831101236244043, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -37.20469758152103, "episode_reward_min": -1272.4873977843997, "episode_reward_mean": -742.6559345792103, "episode_len_mean": 139.93, "episode_media": {}, "episodes_timesteps_total": 13993, "policy_reward_min": {"policy_0": -1272.4873977843997}, "policy_reward_max": {"policy_0": -37.20469758152103}, "policy_reward_mean": {"policy_0": -742.6559345792103}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73.96648164665378, -37.20469758152103, -766.2965270905285, -758.5459968376673, -790.5170722032265, -455.08176605275725, -172.44031401474317, -1106.5458830714904, -476.26115968388484, -1245.4824029764668, -1022.6552112447216, -865.8124417632871, -610.6224496598487, -493.6251231958947, -936.5813289345613, -403.92181077457957, -1042.3308922728083, -247.70899428351342, -649.0950345239318, -797.9239023504462, -887.2226215927437, -331.2183065371058, -844.2736171191858, -808.8470260586012, -958.2548309055256, -825.1511160603653, -940.0817940704578, -971.8478971135694, -199.95966063507416, -884.7406790663476, -915.197632121067, -741.7276648425878, -847.5174249101692, -871.7909356262428, -1094.7596106790702, -1101.0849439314143, -934.8550372240155, -1152.8860110339017, -936.8359798577894, -943.6465422922656, -212.82110350749525, -730.8006655111615, -1212.6815450707875, -948.4651361422854, -749.176568935249, -1197.363895367887, -1108.6104623221406, -437.92849642025965, -450.80830501443637, -1272.4873977843997, -863.5259340643563, -860.3647037426639, -687.9524943444609, -1241.867940943141, -948.9686610866631, -1069.046014337495, -993.8870930674316, -158.66837387431625, -716.7605715100797, -863.134940193351, -568.3347636327687, -134.96605763268477, -652.452982101392, -297.31456970384755, -596.0937109821186, -530.9353318767058, -244.7431678174178, -1048.3256387071503, -802.4752338707086, -1244.8173561266703, -1046.633329179855, -1062.610367802997, -540.9522489747812, -998.0690196593553, -652.6560519718421, -1051.44485321276, -263.8420298684371, -808.3593789980439, -885.4160835115931, -108.02092156280315, -170.4657141868097, -935.438220253194, -1035.0416570008483, -742.2579701927317, -1031.3878340257597, -479.7814063574449, -868.8045350423201, -1014.0586638813425, -156.43879699442252, -359.2235789398512, -1039.6676748542232, -914.7626436969003, -543.125252250673, -116.38058733176277, -823.8426815863471, -794.8128481242461, -1166.7182959591091, -635.5423431135231, -768.907928256109, -260.6326035993737], "episode_lengths": [57, 57, 150, 146, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 96, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 60, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 94, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 88, 150, 150, 150, 135, 150, 94], "policy_policy_0_reward": [-73.96648164665378, -37.20469758152103, -766.2965270905285, -758.5459968376673, -790.5170722032265, -455.08176605275725, -172.44031401474317, -1106.5458830714904, -476.26115968388484, -1245.4824029764668, -1022.6552112447216, -865.8124417632871, -610.6224496598487, -493.6251231958947, -936.5813289345613, -403.92181077457957, -1042.3308922728083, -247.70899428351342, -649.0950345239318, -797.9239023504462, -887.2226215927437, -331.2183065371058, -844.2736171191858, -808.8470260586012, -958.2548309055256, -825.1511160603653, -940.0817940704578, -971.8478971135694, -199.95966063507416, -884.7406790663476, -915.197632121067, -741.7276648425878, -847.5174249101692, -871.7909356262428, -1094.7596106790702, -1101.0849439314143, -934.8550372240155, -1152.8860110339017, -936.8359798577894, -943.6465422922656, -212.82110350749525, -730.8006655111615, -1212.6815450707875, -948.4651361422854, -749.176568935249, -1197.363895367887, -1108.6104623221406, -437.92849642025965, -450.80830501443637, -1272.4873977843997, -863.5259340643563, -860.3647037426639, -687.9524943444609, -1241.867940943141, -948.9686610866631, -1069.046014337495, -993.8870930674316, -158.66837387431625, -716.7605715100797, -863.134940193351, -568.3347636327687, -134.96605763268477, -652.452982101392, -297.31456970384755, -596.0937109821186, -530.9353318767058, -244.7431678174178, -1048.3256387071503, -802.4752338707086, -1244.8173561266703, -1046.633329179855, -1062.610367802997, -540.9522489747812, -998.0690196593553, -652.6560519718421, -1051.44485321276, -263.8420298684371, -808.3593789980439, -885.4160835115931, -108.02092156280315, -170.4657141868097, -935.438220253194, -1035.0416570008483, -742.2579701927317, -1031.3878340257597, -479.7814063574449, -868.8045350423201, -1014.0586638813425, -156.43879699442252, -359.2235789398512, -1039.6676748542232, -914.7626436969003, -543.125252250673, -116.38058733176277, -823.8426815863471, -794.8128481242461, -1166.7182959591091, -635.5423431135231, -768.907928256109, -260.6326035993737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5627029176474346, "mean_inference_ms": 1.6959752800415864, "mean_action_processing_ms": 0.2839217703786656, "mean_env_wait_ms": 2.9953353423733917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014074563980102539, "StateBufferConnector_ms": 0.008928298950195312, "ViewRequirementAgentConnector_ms": 0.19254446029663086}, "num_episodes": 27, "episode_return_max": -37.20469758152103, "episode_return_min": -1272.4873977843997, "episode_return_mean": -742.6559345792103, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.54746580357124, "num_env_steps_trained_throughput_per_sec": 308.54746580357124, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12993.154, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12993.074, "sample_time_ms": 1028.745, "learn_time_ms": 11895.128, "learn_throughput": 336.272, "synch_weights_time_ms": 68.358}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00006", "date": "2024-08-03_10-49-13", "timestamp": 1722662353, "time_this_iter_s": 12.976550102233887, "time_total_s": 78.03449535369873, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5749d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 78.03449535369873, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.315789473684212, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 105.94178375403087, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.665072223295768, "policy_loss": -0.0079892861135401, "vf_loss": 3.670020456860463, "vf_explained_var": 0.9598862862214446, "kl": 0.015885671776474434, "entropy": 1.3608810236056645, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -32.49195340619822, "episode_reward_min": -1272.4873977843997, "episode_reward_mean": -763.164553395633, "episode_len_mean": 141.81, "episode_media": {}, "episodes_timesteps_total": 14181, "policy_reward_min": {"policy_0": -1272.4873977843997}, "policy_reward_max": {"policy_0": -32.49195340619822}, "policy_reward_mean": {"policy_0": -763.164553395633}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-741.7276648425878, -847.5174249101692, -871.7909356262428, -1094.7596106790702, -1101.0849439314143, -934.8550372240155, -1152.8860110339017, -936.8359798577894, -943.6465422922656, -212.82110350749525, -730.8006655111615, -1212.6815450707875, -948.4651361422854, -749.176568935249, -1197.363895367887, -1108.6104623221406, -437.92849642025965, -450.80830501443637, -1272.4873977843997, -863.5259340643563, -860.3647037426639, -687.9524943444609, -1241.867940943141, -948.9686610866631, -1069.046014337495, -993.8870930674316, -158.66837387431625, -716.7605715100797, -863.134940193351, -568.3347636327687, -134.96605763268477, -652.452982101392, -297.31456970384755, -596.0937109821186, -530.9353318767058, -244.7431678174178, -1048.3256387071503, -802.4752338707086, -1244.8173561266703, -1046.633329179855, -1062.610367802997, -540.9522489747812, -998.0690196593553, -652.6560519718421, -1051.44485321276, -263.8420298684371, -808.3593789980439, -885.4160835115931, -108.02092156280315, -170.4657141868097, -935.438220253194, -1035.0416570008483, -742.2579701927317, -1031.3878340257597, -479.7814063574449, -868.8045350423201, -1014.0586638813425, -156.43879699442252, -359.2235789398512, -1039.6676748542232, -914.7626436969003, -543.125252250673, -116.38058733176277, -823.8426815863471, -794.8128481242461, -1166.7182959591091, -635.5423431135231, -768.907928256109, -260.6326035993737, -637.156540134758, -53.95662862567161, -1196.3373290987552, -847.2608055427561, -970.841546981851, -831.1198487226193, -32.49195340619822, -631.4954919826039, -293.2945666887761, -1050.2877970460056, -667.1972088196309, -938.8193383272487, -745.8292938243627, -885.4229582714618, -657.1089615402973, -1167.7521224255147, -506.42689649704187, -876.5053887445661, -467.33562172473745, -736.4041591348005, -559.753603834248, -868.0018037691237, -797.6771273640022, -771.4672180486326, -821.5297745853401, -826.7951754017964, -944.8238180989874, -1015.3095462176831, -815.921081501546, -891.053472039941, -1064.8994746838848], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 60, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 94, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 88, 150, 150, 150, 135, 150, 94, 150, 54, 150, 150, 150, 150, 50, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-741.7276648425878, -847.5174249101692, -871.7909356262428, -1094.7596106790702, -1101.0849439314143, -934.8550372240155, -1152.8860110339017, -936.8359798577894, -943.6465422922656, -212.82110350749525, -730.8006655111615, -1212.6815450707875, -948.4651361422854, -749.176568935249, -1197.363895367887, -1108.6104623221406, -437.92849642025965, -450.80830501443637, -1272.4873977843997, -863.5259340643563, -860.3647037426639, -687.9524943444609, -1241.867940943141, -948.9686610866631, -1069.046014337495, -993.8870930674316, -158.66837387431625, -716.7605715100797, -863.134940193351, -568.3347636327687, -134.96605763268477, -652.452982101392, -297.31456970384755, -596.0937109821186, -530.9353318767058, -244.7431678174178, -1048.3256387071503, -802.4752338707086, -1244.8173561266703, -1046.633329179855, -1062.610367802997, -540.9522489747812, -998.0690196593553, -652.6560519718421, -1051.44485321276, -263.8420298684371, -808.3593789980439, -885.4160835115931, -108.02092156280315, -170.4657141868097, -935.438220253194, -1035.0416570008483, -742.2579701927317, -1031.3878340257597, -479.7814063574449, -868.8045350423201, -1014.0586638813425, -156.43879699442252, -359.2235789398512, -1039.6676748542232, -914.7626436969003, -543.125252250673, -116.38058733176277, -823.8426815863471, -794.8128481242461, -1166.7182959591091, -635.5423431135231, -768.907928256109, -260.6326035993737, -637.156540134758, -53.95662862567161, -1196.3373290987552, -847.2608055427561, -970.841546981851, -831.1198487226193, -32.49195340619822, -631.4954919826039, -293.2945666887761, -1050.2877970460056, -667.1972088196309, -938.8193383272487, -745.8292938243627, -885.4229582714618, -657.1089615402973, -1167.7521224255147, -506.42689649704187, -876.5053887445661, -467.33562172473745, -736.4041591348005, -559.753603834248, -868.0018037691237, -797.6771273640022, -771.4672180486326, -821.5297745853401, -826.7951754017964, -944.8238180989874, -1015.3095462176831, -815.921081501546, -891.053472039941, -1064.8994746838848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.563398283319899, "mean_inference_ms": 1.7011266513198942, "mean_action_processing_ms": 0.28451430657225074, "mean_env_wait_ms": 3.000769092015294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014080286026000977, "StateBufferConnector_ms": 0.008622407913208008, "ViewRequirementAgentConnector_ms": 0.19422101974487305}, "num_episodes": 31, "episode_return_max": -32.49195340619822, "episode_return_min": -1272.4873977843997, "episode_return_mean": -763.164553395633, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.7687002552423, "num_env_steps_trained_throughput_per_sec": 299.7687002552423, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13043.223, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13043.144, "sample_time_ms": 1027.225, "learn_time_ms": 11947.371, "learn_throughput": 334.802, "synch_weights_time_ms": 67.712}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00006", "date": "2024-08-03_10-49-26", "timestamp": 1722662366, "time_this_iter_s": 13.356513023376465, "time_total_s": 91.3910083770752, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c521750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 91.3910083770752, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.28421052631579, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.69423820177714, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.2289843247582515, "policy_loss": -0.0066709873586660254, "vf_loss": 3.232243291536967, "vf_explained_var": 0.979379674543937, "kl": 0.01770061473149933, "entropy": 1.2811077640702326, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -32.49195340619822, "episode_reward_min": -1244.8173561266703, "episode_reward_mean": -720.1525075542727, "episode_len_mean": 140.74, "episode_media": {}, "episodes_timesteps_total": 14074, "policy_reward_min": {"policy_0": -1244.8173561266703}, "policy_reward_max": {"policy_0": -32.49195340619822}, "policy_reward_mean": {"policy_0": -720.1525075542727}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1069.046014337495, -993.8870930674316, -158.66837387431625, -716.7605715100797, -863.134940193351, -568.3347636327687, -134.96605763268477, -652.452982101392, -297.31456970384755, -596.0937109821186, -530.9353318767058, -244.7431678174178, -1048.3256387071503, -802.4752338707086, -1244.8173561266703, -1046.633329179855, -1062.610367802997, -540.9522489747812, -998.0690196593553, -652.6560519718421, -1051.44485321276, -263.8420298684371, -808.3593789980439, -885.4160835115931, -108.02092156280315, -170.4657141868097, -935.438220253194, -1035.0416570008483, -742.2579701927317, -1031.3878340257597, -479.7814063574449, -868.8045350423201, -1014.0586638813425, -156.43879699442252, -359.2235789398512, -1039.6676748542232, -914.7626436969003, -543.125252250673, -116.38058733176277, -823.8426815863471, -794.8128481242461, -1166.7182959591091, -635.5423431135231, -768.907928256109, -260.6326035993737, -637.156540134758, -53.95662862567161, -1196.3373290987552, -847.2608055427561, -970.841546981851, -831.1198487226193, -32.49195340619822, -631.4954919826039, -293.2945666887761, -1050.2877970460056, -667.1972088196309, -938.8193383272487, -745.8292938243627, -885.4229582714618, -657.1089615402973, -1167.7521224255147, -506.42689649704187, -876.5053887445661, -467.33562172473745, -736.4041591348005, -559.753603834248, -868.0018037691237, -797.6771273640022, -771.4672180486326, -821.5297745853401, -826.7951754017964, -944.8238180989874, -1015.3095462176831, -815.921081501546, -891.053472039941, -1064.8994746838848, -765.1897439635569, -543.8576234461915, -697.6233960214249, -1000.6563251650579, -298.2767343205122, -893.5271294642482, -713.5446414660588, -1105.3331788902553, -397.5555498648262, -407.2461885483918, -131.62129313390582, -108.47281710521561, -934.8355810015514, -739.6562264459459, -829.6983456698138, -1079.2826562912574, -1150.1388773272668, -629.5654035756385, -1239.2893969854597, -969.1735897798378, -664.9755942761059, -1046.1803715007557, -653.5975178120556, -248.42469446350174], "episode_lengths": [150, 150, 96, 150, 150, 150, 60, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 94, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 88, 150, 150, 150, 135, 150, 94, 150, 54, 150, 150, 150, 150, 50, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1069.046014337495, -993.8870930674316, -158.66837387431625, -716.7605715100797, -863.134940193351, -568.3347636327687, -134.96605763268477, -652.452982101392, -297.31456970384755, -596.0937109821186, -530.9353318767058, -244.7431678174178, -1048.3256387071503, -802.4752338707086, -1244.8173561266703, -1046.633329179855, -1062.610367802997, -540.9522489747812, -998.0690196593553, -652.6560519718421, -1051.44485321276, -263.8420298684371, -808.3593789980439, -885.4160835115931, -108.02092156280315, -170.4657141868097, -935.438220253194, -1035.0416570008483, -742.2579701927317, -1031.3878340257597, -479.7814063574449, -868.8045350423201, -1014.0586638813425, -156.43879699442252, -359.2235789398512, -1039.6676748542232, -914.7626436969003, -543.125252250673, -116.38058733176277, -823.8426815863471, -794.8128481242461, -1166.7182959591091, -635.5423431135231, -768.907928256109, -260.6326035993737, -637.156540134758, -53.95662862567161, -1196.3373290987552, -847.2608055427561, -970.841546981851, -831.1198487226193, -32.49195340619822, -631.4954919826039, -293.2945666887761, -1050.2877970460056, -667.1972088196309, -938.8193383272487, -745.8292938243627, -885.4229582714618, -657.1089615402973, -1167.7521224255147, -506.42689649704187, -876.5053887445661, -467.33562172473745, -736.4041591348005, -559.753603834248, -868.0018037691237, -797.6771273640022, -771.4672180486326, -821.5297745853401, -826.7951754017964, -944.8238180989874, -1015.3095462176831, -815.921081501546, -891.053472039941, -1064.8994746838848, -765.1897439635569, -543.8576234461915, -697.6233960214249, -1000.6563251650579, -298.2767343205122, -893.5271294642482, -713.5446414660588, -1105.3331788902553, -397.5555498648262, -407.2461885483918, -131.62129313390582, -108.47281710521561, -934.8355810015514, -739.6562264459459, -829.6983456698138, -1079.2826562912574, -1150.1388773272668, -629.5654035756385, -1239.2893969854597, -969.1735897798378, -664.9755942761059, -1046.1803715007557, -653.5975178120556, -248.42469446350174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5625935527051742, "mean_inference_ms": 1.7004115579633705, "mean_action_processing_ms": 0.2841208297912642, "mean_env_wait_ms": 3.0030391937515617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01330113410949707, "StateBufferConnector_ms": 0.008247137069702148, "ViewRequirementAgentConnector_ms": 0.19063401222229004}, "num_episodes": 24, "episode_return_max": -32.49195340619822, "episode_return_min": -1244.8173561266703, "episode_return_mean": -720.1525075542727, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.7450267366594, "num_env_steps_trained_throughput_per_sec": 302.7450267366594, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13064.377, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13064.297, "sample_time_ms": 1023.59, "learn_time_ms": 11972.509, "learn_throughput": 334.099, "synch_weights_time_ms": 67.343}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00006", "date": "2024-08-03_10-49-39", "timestamp": 1722662379, "time_this_iter_s": 13.223856687545776, "time_total_s": 104.61486506462097, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c521630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 104.61486506462097, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.761111111111111, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.26966735124589, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.9786925786485274, "policy_loss": -0.01589481118620218, "vf_loss": 2.990840799982349, "vf_explained_var": 0.9738620771095157, "kl": 0.019365657538764937, "entropy": 1.2653361707925797, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -5.284232457180197, "episode_reward_min": -1250.7256336267785, "episode_reward_mean": -689.0909652511505, "episode_len_mean": 138.38, "episode_media": {}, "episodes_timesteps_total": 13838, "policy_reward_min": {"policy_0": -1250.7256336267785}, "policy_reward_max": {"policy_0": -5.284232457180197}, "policy_reward_mean": {"policy_0": -689.0909652511505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-479.7814063574449, -868.8045350423201, -1014.0586638813425, -156.43879699442252, -359.2235789398512, -1039.6676748542232, -914.7626436969003, -543.125252250673, -116.38058733176277, -823.8426815863471, -794.8128481242461, -1166.7182959591091, -635.5423431135231, -768.907928256109, -260.6326035993737, -637.156540134758, -53.95662862567161, -1196.3373290987552, -847.2608055427561, -970.841546981851, -831.1198487226193, -32.49195340619822, -631.4954919826039, -293.2945666887761, -1050.2877970460056, -667.1972088196309, -938.8193383272487, -745.8292938243627, -885.4229582714618, -657.1089615402973, -1167.7521224255147, -506.42689649704187, -876.5053887445661, -467.33562172473745, -736.4041591348005, -559.753603834248, -868.0018037691237, -797.6771273640022, -771.4672180486326, -821.5297745853401, -826.7951754017964, -944.8238180989874, -1015.3095462176831, -815.921081501546, -891.053472039941, -1064.8994746838848, -765.1897439635569, -543.8576234461915, -697.6233960214249, -1000.6563251650579, -298.2767343205122, -893.5271294642482, -713.5446414660588, -1105.3331788902553, -397.5555498648262, -407.2461885483918, -131.62129313390582, -108.47281710521561, -934.8355810015514, -739.6562264459459, -829.6983456698138, -1079.2826562912574, -1150.1388773272668, -629.5654035756385, -1239.2893969854597, -969.1735897798378, -664.9755942761059, -1046.1803715007557, -653.5975178120556, -248.42469446350174, -954.6863031020142, -1153.1266335465111, -704.7469997048279, -1214.254500594065, -84.67389316164318, -974.111145711027, -433.30856391522104, -671.8392324316162, -1045.5473094306942, -110.88494938510021, -147.7643538316828, -394.75500160769974, -978.1482131749115, -1059.1543359569941, -5.284232457180197, -85.21024990515551, -503.492860625657, -678.1580533709257, -155.0732186258664, -329.5992850444235, -1250.7256336267785, -134.14608871653363, -826.600513102659, -447.2794587123374, -713.1303674337486, -307.5094497274397, -811.8628194456836, -628.6955967894287, -542.6244448185423, -802.0035475673437], "episode_lengths": [150, 150, 150, 75, 150, 150, 150, 150, 88, 150, 150, 150, 135, 150, 94, 150, 54, 150, 150, 150, 150, 50, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 85, 103, 150, 150, 150, 34, 62, 128, 150, 90, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-479.7814063574449, -868.8045350423201, -1014.0586638813425, -156.43879699442252, -359.2235789398512, -1039.6676748542232, -914.7626436969003, -543.125252250673, -116.38058733176277, -823.8426815863471, -794.8128481242461, -1166.7182959591091, -635.5423431135231, -768.907928256109, -260.6326035993737, -637.156540134758, -53.95662862567161, -1196.3373290987552, -847.2608055427561, -970.841546981851, -831.1198487226193, -32.49195340619822, -631.4954919826039, -293.2945666887761, -1050.2877970460056, -667.1972088196309, -938.8193383272487, -745.8292938243627, -885.4229582714618, -657.1089615402973, -1167.7521224255147, -506.42689649704187, -876.5053887445661, -467.33562172473745, -736.4041591348005, -559.753603834248, -868.0018037691237, -797.6771273640022, -771.4672180486326, -821.5297745853401, -826.7951754017964, -944.8238180989874, -1015.3095462176831, -815.921081501546, -891.053472039941, -1064.8994746838848, -765.1897439635569, -543.8576234461915, -697.6233960214249, -1000.6563251650579, -298.2767343205122, -893.5271294642482, -713.5446414660588, -1105.3331788902553, -397.5555498648262, -407.2461885483918, -131.62129313390582, -108.47281710521561, -934.8355810015514, -739.6562264459459, -829.6983456698138, -1079.2826562912574, -1150.1388773272668, -629.5654035756385, -1239.2893969854597, -969.1735897798378, -664.9755942761059, -1046.1803715007557, -653.5975178120556, -248.42469446350174, -954.6863031020142, -1153.1266335465111, -704.7469997048279, -1214.254500594065, -84.67389316164318, -974.111145711027, -433.30856391522104, -671.8392324316162, -1045.5473094306942, -110.88494938510021, -147.7643538316828, -394.75500160769974, -978.1482131749115, -1059.1543359569941, -5.284232457180197, -85.21024990515551, -503.492860625657, -678.1580533709257, -155.0732186258664, -329.5992850444235, -1250.7256336267785, -134.14608871653363, -826.600513102659, -447.2794587123374, -713.1303674337486, -307.5094497274397, -811.8628194456836, -628.6955967894287, -542.6244448185423, -802.0035475673437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.560722925424091, "mean_inference_ms": 1.6999956926539534, "mean_action_processing_ms": 0.28351856915196355, "mean_env_wait_ms": 3.002349138343003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013467550277709961, "StateBufferConnector_ms": 0.008124589920043945, "ViewRequirementAgentConnector_ms": 0.19393491744995117}, "num_episodes": 30, "episode_return_max": -5.284232457180197, "episode_return_min": -1250.7256336267785, "episode_return_mean": -689.0909652511505, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.96521100785503, "num_env_steps_trained_throughput_per_sec": 300.96521100785503, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13089.511, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13089.431, "sample_time_ms": 1023.238, "learn_time_ms": 11996.192, "learn_throughput": 333.439, "synch_weights_time_ms": 69.137}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00006", "date": "2024-08-03_10-49-53", "timestamp": 1722662393, "time_this_iter_s": 13.303781986236572, "time_total_s": 117.91864705085754, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c574790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 117.91864705085754, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.515789473684212, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 137.80118224223455, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.7479540628691512, "policy_loss": -0.0075556437450965555, "vf_loss": 2.7525768894702196, "vf_explained_var": 0.9830774848659833, "kl": 0.015283549290446292, "entropy": 1.2388906473914783, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -5.284232457180197, "episode_reward_min": -1250.7256336267785, "episode_reward_mean": -678.584653435741, "episode_len_mean": 137.8, "episode_media": {}, "episodes_timesteps_total": 13780, "policy_reward_min": {"policy_0": -1250.7256336267785}, "policy_reward_max": {"policy_0": -5.284232457180197}, "policy_reward_mean": {"policy_0": -678.584653435741}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1167.7521224255147, -506.42689649704187, -876.5053887445661, -467.33562172473745, -736.4041591348005, -559.753603834248, -868.0018037691237, -797.6771273640022, -771.4672180486326, -821.5297745853401, -826.7951754017964, -944.8238180989874, -1015.3095462176831, -815.921081501546, -891.053472039941, -1064.8994746838848, -765.1897439635569, -543.8576234461915, -697.6233960214249, -1000.6563251650579, -298.2767343205122, -893.5271294642482, -713.5446414660588, -1105.3331788902553, -397.5555498648262, -407.2461885483918, -131.62129313390582, -108.47281710521561, -934.8355810015514, -739.6562264459459, -829.6983456698138, -1079.2826562912574, -1150.1388773272668, -629.5654035756385, -1239.2893969854597, -969.1735897798378, -664.9755942761059, -1046.1803715007557, -653.5975178120556, -248.42469446350174, -954.6863031020142, -1153.1266335465111, -704.7469997048279, -1214.254500594065, -84.67389316164318, -974.111145711027, -433.30856391522104, -671.8392324316162, -1045.5473094306942, -110.88494938510021, -147.7643538316828, -394.75500160769974, -978.1482131749115, -1059.1543359569941, -5.284232457180197, -85.21024990515551, -503.492860625657, -678.1580533709257, -155.0732186258664, -329.5992850444235, -1250.7256336267785, -134.14608871653363, -826.600513102659, -447.2794587123374, -713.1303674337486, -307.5094497274397, -811.8628194456836, -628.6955967894287, -542.6244448185423, -802.0035475673437, -902.7483787979082, -604.4263302670125, -591.3020168610445, -13.212728390523209, -663.104520755858, -487.87295805112564, -114.48888107420333, -943.8893382517356, -1064.8555633727658, -645.7428764078705, -949.7077224629013, -122.97530704278459, -477.1208878768239, -891.8121369123639, -629.8124035965341, -469.4872893433598, -840.0954240154311, -788.8029894219266, -332.5077933609625, -1021.792366530262, -952.1853057022305, -856.8295032837069, -196.61675888122778, -933.8312592844179, -1017.0137407643354, -64.66999178424938, -618.2195905187631, -329.3013792707742, -727.6469661847856, -1078.6165189918136], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 85, 103, 150, 150, 150, 34, 62, 128, 150, 90, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 37, 150, 116, 71, 150, 150, 150, 150, 77, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 60, 150, 114, 150, 150], "policy_policy_0_reward": [-1167.7521224255147, -506.42689649704187, -876.5053887445661, -467.33562172473745, -736.4041591348005, -559.753603834248, -868.0018037691237, -797.6771273640022, -771.4672180486326, -821.5297745853401, -826.7951754017964, -944.8238180989874, -1015.3095462176831, -815.921081501546, -891.053472039941, -1064.8994746838848, -765.1897439635569, -543.8576234461915, -697.6233960214249, -1000.6563251650579, -298.2767343205122, -893.5271294642482, -713.5446414660588, -1105.3331788902553, -397.5555498648262, -407.2461885483918, -131.62129313390582, -108.47281710521561, -934.8355810015514, -739.6562264459459, -829.6983456698138, -1079.2826562912574, -1150.1388773272668, -629.5654035756385, -1239.2893969854597, -969.1735897798378, -664.9755942761059, -1046.1803715007557, -653.5975178120556, -248.42469446350174, -954.6863031020142, -1153.1266335465111, -704.7469997048279, -1214.254500594065, -84.67389316164318, -974.111145711027, -433.30856391522104, -671.8392324316162, -1045.5473094306942, -110.88494938510021, -147.7643538316828, -394.75500160769974, -978.1482131749115, -1059.1543359569941, -5.284232457180197, -85.21024990515551, -503.492860625657, -678.1580533709257, -155.0732186258664, -329.5992850444235, -1250.7256336267785, -134.14608871653363, -826.600513102659, -447.2794587123374, -713.1303674337486, -307.5094497274397, -811.8628194456836, -628.6955967894287, -542.6244448185423, -802.0035475673437, -902.7483787979082, -604.4263302670125, -591.3020168610445, -13.212728390523209, -663.104520755858, -487.87295805112564, -114.48888107420333, -943.8893382517356, -1064.8555633727658, -645.7428764078705, -949.7077224629013, -122.97530704278459, -477.1208878768239, -891.8121369123639, -629.8124035965341, -469.4872893433598, -840.0954240154311, -788.8029894219266, -332.5077933609625, -1021.792366530262, -952.1853057022305, -856.8295032837069, -196.61675888122778, -933.8312592844179, -1017.0137407643354, -64.66999178424938, -618.2195905187631, -329.3013792707742, -727.6469661847856, -1078.6165189918136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5597425350376453, "mean_inference_ms": 1.6987242537050087, "mean_action_processing_ms": 0.2827635759628057, "mean_env_wait_ms": 3.000160693490027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013222694396972656, "StateBufferConnector_ms": 0.008033514022827148, "ViewRequirementAgentConnector_ms": 0.1950054168701172}, "num_episodes": 30, "episode_return_max": -5.284232457180197, "episode_return_min": -1250.7256336267785, "episode_return_mean": -678.584653435741, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.4220986268199, "num_env_steps_trained_throughput_per_sec": 300.4220986268199, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13112.022, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13111.941, "sample_time_ms": 1026.416, "learn_time_ms": 12015.91, "learn_throughput": 332.892, "synch_weights_time_ms": 68.748}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00006", "date": "2024-08-03_10-50-06", "timestamp": 1722662406, "time_this_iter_s": 13.32772970199585, "time_total_s": 131.2463767528534, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c576050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 131.2463767528534, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.77894736842105, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 129.61756146152814, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.087713428462545, "policy_loss": -0.009546907878636072, "vf_loss": 3.094128106161952, "vf_explained_var": 0.9860152648761868, "kl": 0.0163005650437602, "entropy": 1.2788112639139095, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -5.284232457180197, "episode_reward_min": -1365.2816790693312, "episode_reward_mean": -665.9292686670941, "episode_len_mean": 134.18, "episode_media": {}, "episodes_timesteps_total": 13418, "policy_reward_min": {"policy_0": -1365.2816790693312}, "policy_reward_max": {"policy_0": -5.284232457180197}, "policy_reward_mean": {"policy_0": -665.9292686670941}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-739.6562264459459, -829.6983456698138, -1079.2826562912574, -1150.1388773272668, -629.5654035756385, -1239.2893969854597, -969.1735897798378, -664.9755942761059, -1046.1803715007557, -653.5975178120556, -248.42469446350174, -954.6863031020142, -1153.1266335465111, -704.7469997048279, -1214.254500594065, -84.67389316164318, -974.111145711027, -433.30856391522104, -671.8392324316162, -1045.5473094306942, -110.88494938510021, -147.7643538316828, -394.75500160769974, -978.1482131749115, -1059.1543359569941, -5.284232457180197, -85.21024990515551, -503.492860625657, -678.1580533709257, -155.0732186258664, -329.5992850444235, -1250.7256336267785, -134.14608871653363, -826.600513102659, -447.2794587123374, -713.1303674337486, -307.5094497274397, -811.8628194456836, -628.6955967894287, -542.6244448185423, -802.0035475673437, -902.7483787979082, -604.4263302670125, -591.3020168610445, -13.212728390523209, -663.104520755858, -487.87295805112564, -114.48888107420333, -943.8893382517356, -1064.8555633727658, -645.7428764078705, -949.7077224629013, -122.97530704278459, -477.1208878768239, -891.8121369123639, -629.8124035965341, -469.4872893433598, -840.0954240154311, -788.8029894219266, -332.5077933609625, -1021.792366530262, -952.1853057022305, -856.8295032837069, -196.61675888122778, -933.8312592844179, -1017.0137407643354, -64.66999178424938, -618.2195905187631, -329.3013792707742, -727.6469661847856, -1078.6165189918136, -1365.2816790693312, -800.6979665551257, -1036.6828407880416, -492.44734522750764, -80.73243701445887, -1125.234655526377, -392.8176426762316, -597.1159880175381, -125.67181345727242, -1116.368485199446, -540.299776546632, -793.9421669201739, -324.9134602377484, -921.0908844388015, -895.0910285235836, -574.3141718399924, -1193.6866120543282, -1068.83112075414, -894.5134417934474, -813.0256176762117, -1178.4724503419027, -268.42934690103584, -40.3394135053768, -376.8161522115599, -226.31505853328787, -1119.0239014094136, -890.7250043477883, -489.16297427492265, -121.81457375669827], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 85, 103, 150, 150, 150, 34, 62, 128, 150, 90, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 37, 150, 116, 71, 150, 150, 150, 150, 77, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 60, 150, 114, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 78, 150, 135, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 106, 52, 150, 85, 150, 150, 150, 66], "policy_policy_0_reward": [-739.6562264459459, -829.6983456698138, -1079.2826562912574, -1150.1388773272668, -629.5654035756385, -1239.2893969854597, -969.1735897798378, -664.9755942761059, -1046.1803715007557, -653.5975178120556, -248.42469446350174, -954.6863031020142, -1153.1266335465111, -704.7469997048279, -1214.254500594065, -84.67389316164318, -974.111145711027, -433.30856391522104, -671.8392324316162, -1045.5473094306942, -110.88494938510021, -147.7643538316828, -394.75500160769974, -978.1482131749115, -1059.1543359569941, -5.284232457180197, -85.21024990515551, -503.492860625657, -678.1580533709257, -155.0732186258664, -329.5992850444235, -1250.7256336267785, -134.14608871653363, -826.600513102659, -447.2794587123374, -713.1303674337486, -307.5094497274397, -811.8628194456836, -628.6955967894287, -542.6244448185423, -802.0035475673437, -902.7483787979082, -604.4263302670125, -591.3020168610445, -13.212728390523209, -663.104520755858, -487.87295805112564, -114.48888107420333, -943.8893382517356, -1064.8555633727658, -645.7428764078705, -949.7077224629013, -122.97530704278459, -477.1208878768239, -891.8121369123639, -629.8124035965341, -469.4872893433598, -840.0954240154311, -788.8029894219266, -332.5077933609625, -1021.792366530262, -952.1853057022305, -856.8295032837069, -196.61675888122778, -933.8312592844179, -1017.0137407643354, -64.66999178424938, -618.2195905187631, -329.3013792707742, -727.6469661847856, -1078.6165189918136, -1365.2816790693312, -800.6979665551257, -1036.6828407880416, -492.44734522750764, -80.73243701445887, -1125.234655526377, -392.8176426762316, -597.1159880175381, -125.67181345727242, -1116.368485199446, -540.299776546632, -793.9421669201739, -324.9134602377484, -921.0908844388015, -895.0910285235836, -574.3141718399924, -1193.6866120543282, -1068.83112075414, -894.5134417934474, -813.0256176762117, -1178.4724503419027, -268.42934690103584, -40.3394135053768, -376.8161522115599, -226.31505853328787, -1119.0239014094136, -890.7250043477883, -489.16297427492265, -121.81457375669827]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5587415498770028, "mean_inference_ms": 1.6993427234339722, "mean_action_processing_ms": 0.28237621347026837, "mean_env_wait_ms": 3.0011949151895494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01315617561340332, "StateBufferConnector_ms": 0.008209705352783203, "ViewRequirementAgentConnector_ms": 0.19878268241882324}, "num_episodes": 29, "episode_return_max": -5.284232457180197, "episode_return_min": -1365.2816790693312, "episode_return_mean": -665.9292686670941, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.9881468926325, "num_env_steps_trained_throughput_per_sec": 299.9881468926325, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13169.222, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13169.138, "sample_time_ms": 1029.095, "learn_time_ms": 12070.746, "learn_throughput": 331.38, "synch_weights_time_ms": 68.427}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00006", "date": "2024-08-03_10-50-19", "timestamp": 1722662419, "time_this_iter_s": 13.346672773361206, "time_total_s": 144.5930495262146, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c576b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 144.5930495262146, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 13.510526315789473, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 178.93730558951697, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.4321181771655875, "policy_loss": -0.008267596402341345, "vf_loss": 2.437433781971534, "vf_explained_var": 0.9879997311159968, "kl": 0.01538422590783739, "entropy": 1.2484309932837883, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -13.212728390523209, "episode_reward_min": -1403.7113496558777, "episode_reward_mean": -674.5282643674664, "episode_len_mean": 136.24, "episode_media": {}, "episodes_timesteps_total": 13624, "policy_reward_min": {"policy_0": -1403.7113496558777}, "policy_reward_max": {"policy_0": -13.212728390523209}, "policy_reward_mean": {"policy_0": -674.5282643674664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-134.14608871653363, -826.600513102659, -447.2794587123374, -713.1303674337486, -307.5094497274397, -811.8628194456836, -628.6955967894287, -542.6244448185423, -802.0035475673437, -902.7483787979082, -604.4263302670125, -591.3020168610445, -13.212728390523209, -663.104520755858, -487.87295805112564, -114.48888107420333, -943.8893382517356, -1064.8555633727658, -645.7428764078705, -949.7077224629013, -122.97530704278459, -477.1208878768239, -891.8121369123639, -629.8124035965341, -469.4872893433598, -840.0954240154311, -788.8029894219266, -332.5077933609625, -1021.792366530262, -952.1853057022305, -856.8295032837069, -196.61675888122778, -933.8312592844179, -1017.0137407643354, -64.66999178424938, -618.2195905187631, -329.3013792707742, -727.6469661847856, -1078.6165189918136, -1365.2816790693312, -800.6979665551257, -1036.6828407880416, -492.44734522750764, -80.73243701445887, -1125.234655526377, -392.8176426762316, -597.1159880175381, -125.67181345727242, -1116.368485199446, -540.299776546632, -793.9421669201739, -324.9134602377484, -921.0908844388015, -895.0910285235836, -574.3141718399924, -1193.6866120543282, -1068.83112075414, -894.5134417934474, -813.0256176762117, -1178.4724503419027, -268.42934690103584, -40.3394135053768, -376.8161522115599, -226.31505853328787, -1119.0239014094136, -890.7250043477883, -489.16297427492265, -121.81457375669827, -1403.7113496558777, -797.458505102702, -667.2109687002326, -1084.6673242726959, -852.74650104998, -1090.0204157961775, -791.0733767421294, -170.83486443313834, -832.7711890913423, -607.7501144208322, -771.3194785768453, -572.9577372994565, -1009.8555578682331, -392.70324793477965, -1190.142428418205, -752.964026355871, -772.0607911352259, -701.8282675469343, -401.8902870326384, -203.55920896830165, -903.1381322300294, -405.570916965147, -20.594097743644255, -230.34172316123397, -630.7680836377425, -725.2077210057533, -548.1237240839102, -986.8757268766296, -1262.11217881321, -677.6734086849232, -773.0675446865223, -813.4283150844975], "episode_lengths": [60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 37, 150, 116, 71, 150, 150, 150, 150, 77, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 60, 150, 114, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 78, 150, 135, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 106, 52, 150, 85, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 42, 85, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-134.14608871653363, -826.600513102659, -447.2794587123374, -713.1303674337486, -307.5094497274397, -811.8628194456836, -628.6955967894287, -542.6244448185423, -802.0035475673437, -902.7483787979082, -604.4263302670125, -591.3020168610445, -13.212728390523209, -663.104520755858, -487.87295805112564, -114.48888107420333, -943.8893382517356, -1064.8555633727658, -645.7428764078705, -949.7077224629013, -122.97530704278459, -477.1208878768239, -891.8121369123639, -629.8124035965341, -469.4872893433598, -840.0954240154311, -788.8029894219266, -332.5077933609625, -1021.792366530262, -952.1853057022305, -856.8295032837069, -196.61675888122778, -933.8312592844179, -1017.0137407643354, -64.66999178424938, -618.2195905187631, -329.3013792707742, -727.6469661847856, -1078.6165189918136, -1365.2816790693312, -800.6979665551257, -1036.6828407880416, -492.44734522750764, -80.73243701445887, -1125.234655526377, -392.8176426762316, -597.1159880175381, -125.67181345727242, -1116.368485199446, -540.299776546632, -793.9421669201739, -324.9134602377484, -921.0908844388015, -895.0910285235836, -574.3141718399924, -1193.6866120543282, -1068.83112075414, -894.5134417934474, -813.0256176762117, -1178.4724503419027, -268.42934690103584, -40.3394135053768, -376.8161522115599, -226.31505853328787, -1119.0239014094136, -890.7250043477883, -489.16297427492265, -121.81457375669827, -1403.7113496558777, -797.458505102702, -667.2109687002326, -1084.6673242726959, -852.74650104998, -1090.0204157961775, -791.0733767421294, -170.83486443313834, -832.7711890913423, -607.7501144208322, -771.3194785768453, -572.9577372994565, -1009.8555578682331, -392.70324793477965, -1190.142428418205, -752.964026355871, -772.0607911352259, -701.8282675469343, -401.8902870326384, -203.55920896830165, -903.1381322300294, -405.570916965147, -20.594097743644255, -230.34172316123397, -630.7680836377425, -725.2077210057533, -548.1237240839102, -986.8757268766296, -1262.11217881321, -677.6734086849232, -773.0675446865223, -813.4283150844975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577510579106559, "mean_inference_ms": 1.698721270968538, "mean_action_processing_ms": 0.2819928726901953, "mean_env_wait_ms": 2.9998960956893224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013129949569702148, "StateBufferConnector_ms": 0.008352994918823242, "ViewRequirementAgentConnector_ms": 0.20321393013000488}, "num_episodes": 32, "episode_return_max": -13.212728390523209, "episode_return_min": -1403.7113496558777, "episode_return_mean": -674.5282643674664, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.3067983704823, "num_env_steps_trained_throughput_per_sec": 301.3067983704823, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13172.861, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13172.777, "sample_time_ms": 1031.512, "learn_time_ms": 12072.739, "learn_throughput": 331.325, "synch_weights_time_ms": 67.616}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00006", "date": "2024-08-03_10-50-33", "timestamp": 1722662433, "time_this_iter_s": 13.287949562072754, "time_total_s": 157.88099908828735, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5777f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 157.88099908828735, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.773684210526318, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 146.06855393250783, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.854274872566263, "policy_loss": -0.007022511469161449, "vf_loss": 2.8578335218131543, "vf_explained_var": 0.986318382434547, "kl": 0.017926229236945816, "entropy": 1.2138033999751012, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": 2.3920645907568403, "episode_reward_min": -1403.7113496558777, "episode_reward_mean": -720.3738515604122, "episode_len_mean": 136.76, "episode_media": {}, "episodes_timesteps_total": 13676, "policy_reward_min": {"policy_0": -1403.7113496558777}, "policy_reward_max": {"policy_0": 2.3920645907568403}, "policy_reward_mean": {"policy_0": -720.3738515604122}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-952.1853057022305, -856.8295032837069, -196.61675888122778, -933.8312592844179, -1017.0137407643354, -64.66999178424938, -618.2195905187631, -329.3013792707742, -727.6469661847856, -1078.6165189918136, -1365.2816790693312, -800.6979665551257, -1036.6828407880416, -492.44734522750764, -80.73243701445887, -1125.234655526377, -392.8176426762316, -597.1159880175381, -125.67181345727242, -1116.368485199446, -540.299776546632, -793.9421669201739, -324.9134602377484, -921.0908844388015, -895.0910285235836, -574.3141718399924, -1193.6866120543282, -1068.83112075414, -894.5134417934474, -813.0256176762117, -1178.4724503419027, -268.42934690103584, -40.3394135053768, -376.8161522115599, -226.31505853328787, -1119.0239014094136, -890.7250043477883, -489.16297427492265, -121.81457375669827, -1403.7113496558777, -797.458505102702, -667.2109687002326, -1084.6673242726959, -852.74650104998, -1090.0204157961775, -791.0733767421294, -170.83486443313834, -832.7711890913423, -607.7501144208322, -771.3194785768453, -572.9577372994565, -1009.8555578682331, -392.70324793477965, -1190.142428418205, -752.964026355871, -772.0607911352259, -701.8282675469343, -401.8902870326384, -203.55920896830165, -903.1381322300294, -405.570916965147, -20.594097743644255, -230.34172316123397, -630.7680836377425, -725.2077210057533, -548.1237240839102, -986.8757268766296, -1262.11217881321, -677.6734086849232, -773.0675446865223, -813.4283150844975, -1365.1449365456228, -865.9351537457536, -555.3506233642613, -832.1391549297194, -1147.676767500548, -976.9388453481856, -473.74534312647506, -573.8150391374695, -898.7215029711358, -943.8482690103277, -74.11950913558843, 2.3920645907568403, -799.400932720443, -812.4118089915914, -639.9171830376913, -180.52605280012358, -900.9343692996621, -915.4908274591487, -200.54072766554108, -735.1070539227682, -1251.2860515814446, -1153.9336707494435, -1368.7353284102192, -358.30107238726066, -1150.0299064491908, -994.6819250657801, -760.6720411199054, -385.2408953330417, -1041.915991184098], "episode_lengths": [150, 150, 75, 150, 150, 60, 150, 114, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 78, 150, 135, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 106, 52, 150, 85, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 42, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 71, 37, 150, 150, 142, 67, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-952.1853057022305, -856.8295032837069, -196.61675888122778, -933.8312592844179, -1017.0137407643354, -64.66999178424938, -618.2195905187631, -329.3013792707742, -727.6469661847856, -1078.6165189918136, -1365.2816790693312, -800.6979665551257, -1036.6828407880416, -492.44734522750764, -80.73243701445887, -1125.234655526377, -392.8176426762316, -597.1159880175381, -125.67181345727242, -1116.368485199446, -540.299776546632, -793.9421669201739, -324.9134602377484, -921.0908844388015, -895.0910285235836, -574.3141718399924, -1193.6866120543282, -1068.83112075414, -894.5134417934474, -813.0256176762117, -1178.4724503419027, -268.42934690103584, -40.3394135053768, -376.8161522115599, -226.31505853328787, -1119.0239014094136, -890.7250043477883, -489.16297427492265, -121.81457375669827, -1403.7113496558777, -797.458505102702, -667.2109687002326, -1084.6673242726959, -852.74650104998, -1090.0204157961775, -791.0733767421294, -170.83486443313834, -832.7711890913423, -607.7501144208322, -771.3194785768453, -572.9577372994565, -1009.8555578682331, -392.70324793477965, -1190.142428418205, -752.964026355871, -772.0607911352259, -701.8282675469343, -401.8902870326384, -203.55920896830165, -903.1381322300294, -405.570916965147, -20.594097743644255, -230.34172316123397, -630.7680836377425, -725.2077210057533, -548.1237240839102, -986.8757268766296, -1262.11217881321, -677.6734086849232, -773.0675446865223, -813.4283150844975, -1365.1449365456228, -865.9351537457536, -555.3506233642613, -832.1391549297194, -1147.676767500548, -976.9388453481856, -473.74534312647506, -573.8150391374695, -898.7215029711358, -943.8482690103277, -74.11950913558843, 2.3920645907568403, -799.400932720443, -812.4118089915914, -639.9171830376913, -180.52605280012358, -900.9343692996621, -915.4908274591487, -200.54072766554108, -735.1070539227682, -1251.2860515814446, -1153.9336707494435, -1368.7353284102192, -358.30107238726066, -1150.0299064491908, -994.6819250657801, -760.6720411199054, -385.2408953330417, -1041.915991184098]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5572462740161285, "mean_inference_ms": 1.6980468806578386, "mean_action_processing_ms": 0.2815248299392754, "mean_env_wait_ms": 2.999612131596964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012568235397338867, "StateBufferConnector_ms": 0.008171319961547852, "ViewRequirementAgentConnector_ms": 0.20221185684204102}, "num_episodes": 29, "episode_return_max": 2.3920645907568403, "episode_return_min": -1403.7113496558777, "episode_return_mean": -720.3738515604122, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.8871156222023, "num_env_steps_trained_throughput_per_sec": 304.8871156222023, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13170.807, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13170.722, "sample_time_ms": 1030.745, "learn_time_ms": 12070.352, "learn_throughput": 331.391, "synch_weights_time_ms": 68.713}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00006", "date": "2024-08-03_10-50-46", "timestamp": 1722662446, "time_this_iter_s": 13.13362979888916, "time_total_s": 171.0146288871765, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c523ac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 171.0146288871765, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.578947368421053, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 192.09668088058632, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.2758476329346498, "policy_loss": -0.009565629925540027, "vf_loss": 2.2820931064585843, "vf_explained_var": 0.988676390176018, "kl": 0.017196634788251692, "entropy": 1.1917026707902552, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": 2.3920645907568403, "episode_reward_min": -1403.7113496558777, "episode_reward_mean": -717.4327486716393, "episode_len_mean": 137.09, "episode_media": {}, "episodes_timesteps_total": 13709, "policy_reward_min": {"policy_0": -1403.7113496558777}, "policy_reward_max": {"policy_0": 2.3920645907568403}, "policy_reward_mean": {"policy_0": -717.4327486716393}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-813.0256176762117, -1178.4724503419027, -268.42934690103584, -40.3394135053768, -376.8161522115599, -226.31505853328787, -1119.0239014094136, -890.7250043477883, -489.16297427492265, -121.81457375669827, -1403.7113496558777, -797.458505102702, -667.2109687002326, -1084.6673242726959, -852.74650104998, -1090.0204157961775, -791.0733767421294, -170.83486443313834, -832.7711890913423, -607.7501144208322, -771.3194785768453, -572.9577372994565, -1009.8555578682331, -392.70324793477965, -1190.142428418205, -752.964026355871, -772.0607911352259, -701.8282675469343, -401.8902870326384, -203.55920896830165, -903.1381322300294, -405.570916965147, -20.594097743644255, -230.34172316123397, -630.7680836377425, -725.2077210057533, -548.1237240839102, -986.8757268766296, -1262.11217881321, -677.6734086849232, -773.0675446865223, -813.4283150844975, -1365.1449365456228, -865.9351537457536, -555.3506233642613, -832.1391549297194, -1147.676767500548, -976.9388453481856, -473.74534312647506, -573.8150391374695, -898.7215029711358, -943.8482690103277, -74.11950913558843, 2.3920645907568403, -799.400932720443, -812.4118089915914, -639.9171830376913, -180.52605280012358, -900.9343692996621, -915.4908274591487, -200.54072766554108, -735.1070539227682, -1251.2860515814446, -1153.9336707494435, -1368.7353284102192, -358.30107238726066, -1150.0299064491908, -994.6819250657801, -760.6720411199054, -385.2408953330417, -1041.915991184098, -788.8025085132193, -803.4481519061018, -38.89009991735582, -602.0533448338471, -828.7505421502111, -601.2543670459307, -1048.8065947658688, -1137.4967508751276, -437.191204897104, -673.6741135709888, -827.0943443567478, -356.43342724213085, -1173.288574930941, -687.8521432566047, -822.5657096008806, -762.1893482265368, -661.1518226465988, -1167.2657176218959, -659.3016035018749, -338.5787636420592, -1093.2494021788577, -520.7104880542576, -1082.1677008434503, -832.7660271821625, -1127.5231260278072, -1191.7129282683684, -149.1232704218582, -298.84118562561116, -108.37098032480887], "episode_lengths": [150, 150, 106, 52, 150, 85, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 42, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 71, 37, 150, 150, 142, 67, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 121, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 89, 56], "policy_policy_0_reward": [-813.0256176762117, -1178.4724503419027, -268.42934690103584, -40.3394135053768, -376.8161522115599, -226.31505853328787, -1119.0239014094136, -890.7250043477883, -489.16297427492265, -121.81457375669827, -1403.7113496558777, -797.458505102702, -667.2109687002326, -1084.6673242726959, -852.74650104998, -1090.0204157961775, -791.0733767421294, -170.83486443313834, -832.7711890913423, -607.7501144208322, -771.3194785768453, -572.9577372994565, -1009.8555578682331, -392.70324793477965, -1190.142428418205, -752.964026355871, -772.0607911352259, -701.8282675469343, -401.8902870326384, -203.55920896830165, -903.1381322300294, -405.570916965147, -20.594097743644255, -230.34172316123397, -630.7680836377425, -725.2077210057533, -548.1237240839102, -986.8757268766296, -1262.11217881321, -677.6734086849232, -773.0675446865223, -813.4283150844975, -1365.1449365456228, -865.9351537457536, -555.3506233642613, -832.1391549297194, -1147.676767500548, -976.9388453481856, -473.74534312647506, -573.8150391374695, -898.7215029711358, -943.8482690103277, -74.11950913558843, 2.3920645907568403, -799.400932720443, -812.4118089915914, -639.9171830376913, -180.52605280012358, -900.9343692996621, -915.4908274591487, -200.54072766554108, -735.1070539227682, -1251.2860515814446, -1153.9336707494435, -1368.7353284102192, -358.30107238726066, -1150.0299064491908, -994.6819250657801, -760.6720411199054, -385.2408953330417, -1041.915991184098, -788.8025085132193, -803.4481519061018, -38.89009991735582, -602.0533448338471, -828.7505421502111, -601.2543670459307, -1048.8065947658688, -1137.4967508751276, -437.191204897104, -673.6741135709888, -827.0943443567478, -356.43342724213085, -1173.288574930941, -687.8521432566047, -822.5657096008806, -762.1893482265368, -661.1518226465988, -1167.2657176218959, -659.3016035018749, -338.5787636420592, -1093.2494021788577, -520.7104880542576, -1082.1677008434503, -832.7660271821625, -1127.5231260278072, -1191.7129282683684, -149.1232704218582, -298.84118562561116, -108.37098032480887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5572228555791626, "mean_inference_ms": 1.6980243843202196, "mean_action_processing_ms": 0.28132892270773846, "mean_env_wait_ms": 2.9984284904467238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01269841194152832, "StateBufferConnector_ms": 0.008075714111328125, "ViewRequirementAgentConnector_ms": 0.20067834854125977}, "num_episodes": 29, "episode_return_max": 2.3920645907568403, "episode_return_min": -1403.7113496558777, "episode_return_mean": -717.4327486716393, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.8048698046651, "num_env_steps_trained_throughput_per_sec": 305.8048698046651, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13172.435, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13172.348, "sample_time_ms": 1030.292, "learn_time_ms": 12072.412, "learn_throughput": 331.334, "synch_weights_time_ms": 68.723}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00006", "date": "2024-08-03_10-50-59", "timestamp": 1722662459, "time_this_iter_s": 13.09388279914856, "time_total_s": 184.10851168632507, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5217e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 184.10851168632507, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.505263157894735, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 147.49246212939423, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.078836988285184, "policy_loss": -0.01372456773048422, "vf_loss": 2.088831484814485, "vf_explained_var": 0.9924617743119597, "kl": 0.01926831158610489, "entropy": 1.2358907899508873, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": 2.3920645907568403, "episode_reward_min": -1368.7353284102192, "episode_reward_mean": -701.0273324726954, "episode_len_mean": 135.68, "episode_media": {}, "episodes_timesteps_total": 13568, "policy_reward_min": {"policy_0": -1368.7353284102192}, "policy_reward_max": {"policy_0": 2.3920645907568403}, "policy_reward_mean": {"policy_0": -701.0273324726954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-203.55920896830165, -903.1381322300294, -405.570916965147, -20.594097743644255, -230.34172316123397, -630.7680836377425, -725.2077210057533, -548.1237240839102, -986.8757268766296, -1262.11217881321, -677.6734086849232, -773.0675446865223, -813.4283150844975, -1365.1449365456228, -865.9351537457536, -555.3506233642613, -832.1391549297194, -1147.676767500548, -976.9388453481856, -473.74534312647506, -573.8150391374695, -898.7215029711358, -943.8482690103277, -74.11950913558843, 2.3920645907568403, -799.400932720443, -812.4118089915914, -639.9171830376913, -180.52605280012358, -900.9343692996621, -915.4908274591487, -200.54072766554108, -735.1070539227682, -1251.2860515814446, -1153.9336707494435, -1368.7353284102192, -358.30107238726066, -1150.0299064491908, -994.6819250657801, -760.6720411199054, -385.2408953330417, -1041.915991184098, -788.8025085132193, -803.4481519061018, -38.89009991735582, -602.0533448338471, -828.7505421502111, -601.2543670459307, -1048.8065947658688, -1137.4967508751276, -437.191204897104, -673.6741135709888, -827.0943443567478, -356.43342724213085, -1173.288574930941, -687.8521432566047, -822.5657096008806, -762.1893482265368, -661.1518226465988, -1167.2657176218959, -659.3016035018749, -338.5787636420592, -1093.2494021788577, -520.7104880542576, -1082.1677008434503, -832.7660271821625, -1127.5231260278072, -1191.7129282683684, -149.1232704218582, -298.84118562561116, -108.37098032480887, -1028.2303529127107, -131.29315050039642, -656.3494779226401, -178.65910300960934, -516.4836672745665, -1063.3090435593754, -354.80405161941445, -763.7000936981631, -1072.356963406681, -641.6459615234041, -608.2645325543663, -866.0635541911488, -1035.9060682277063, -1009.0812571725158, -411.66994742531693, -1082.9822416275065, -326.67718591275633, -752.0721533475346, -496.29572379485387, -214.9024267834427, -1234.6940177137394, -670.0101551190739, -38.74275016156827, -816.4057446890452, -788.4763832832658, -832.8835477141766, -169.03324829636594, -560.9956579488647, -425.56084310688044], "episode_lengths": [92, 150, 150, 42, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 71, 37, 150, 150, 142, 67, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 121, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 89, 56, 150, 72, 150, 97, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 89, 150, 150, 44, 150, 150, 150, 78, 150, 150], "policy_policy_0_reward": [-203.55920896830165, -903.1381322300294, -405.570916965147, -20.594097743644255, -230.34172316123397, -630.7680836377425, -725.2077210057533, -548.1237240839102, -986.8757268766296, -1262.11217881321, -677.6734086849232, -773.0675446865223, -813.4283150844975, -1365.1449365456228, -865.9351537457536, -555.3506233642613, -832.1391549297194, -1147.676767500548, -976.9388453481856, -473.74534312647506, -573.8150391374695, -898.7215029711358, -943.8482690103277, -74.11950913558843, 2.3920645907568403, -799.400932720443, -812.4118089915914, -639.9171830376913, -180.52605280012358, -900.9343692996621, -915.4908274591487, -200.54072766554108, -735.1070539227682, -1251.2860515814446, -1153.9336707494435, -1368.7353284102192, -358.30107238726066, -1150.0299064491908, -994.6819250657801, -760.6720411199054, -385.2408953330417, -1041.915991184098, -788.8025085132193, -803.4481519061018, -38.89009991735582, -602.0533448338471, -828.7505421502111, -601.2543670459307, -1048.8065947658688, -1137.4967508751276, -437.191204897104, -673.6741135709888, -827.0943443567478, -356.43342724213085, -1173.288574930941, -687.8521432566047, -822.5657096008806, -762.1893482265368, -661.1518226465988, -1167.2657176218959, -659.3016035018749, -338.5787636420592, -1093.2494021788577, -520.7104880542576, -1082.1677008434503, -832.7660271821625, -1127.5231260278072, -1191.7129282683684, -149.1232704218582, -298.84118562561116, -108.37098032480887, -1028.2303529127107, -131.29315050039642, -656.3494779226401, -178.65910300960934, -516.4836672745665, -1063.3090435593754, -354.80405161941445, -763.7000936981631, -1072.356963406681, -641.6459615234041, -608.2645325543663, -866.0635541911488, -1035.9060682277063, -1009.0812571725158, -411.66994742531693, -1082.9822416275065, -326.67718591275633, -752.0721533475346, -496.29572379485387, -214.9024267834427, -1234.6940177137394, -670.0101551190739, -38.74275016156827, -816.4057446890452, -788.4763832832658, -832.8835477141766, -169.03324829636594, -560.9956579488647, -425.56084310688044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567900809164114, "mean_inference_ms": 1.697081102516018, "mean_action_processing_ms": 0.28121561531302147, "mean_env_wait_ms": 2.997011830892103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012519598007202148, "StateBufferConnector_ms": 0.007966041564941406, "ViewRequirementAgentConnector_ms": 0.1985158920288086}, "num_episodes": 29, "episode_return_max": 2.3920645907568403, "episode_return_min": -1368.7353284102192, "episode_return_mean": -701.0273324726954, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.18977445806075, "num_env_steps_trained_throughput_per_sec": 297.18977445806075, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13239.399, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13239.31, "sample_time_ms": 1021.924, "learn_time_ms": 12149.046, "learn_throughput": 329.244, "synch_weights_time_ms": 67.411}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00006", "date": "2024-08-03_10-51-13", "timestamp": 1722662473, "time_this_iter_s": 13.473365783691406, "time_total_s": 197.58187747001648, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5227a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 197.58187747001648, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 13.542105263157895, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 207.12747705777485, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.084934258336822, "policy_loss": -0.012572213346720673, "vf_loss": 2.0941924673815566, "vf_explained_var": 0.9953696708505352, "kl": 0.017184999528732686, "entropy": 1.2299829334641497, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -38.74275016156827, "episode_reward_min": -1368.7353284102192, "episode_reward_mean": -718.1549954326774, "episode_len_mean": 138.7, "episode_media": {}, "episodes_timesteps_total": 13870, "policy_reward_min": {"policy_0": -1368.7353284102192}, "policy_reward_max": {"policy_0": -38.74275016156827}, "policy_reward_mean": {"policy_0": -718.1549954326774}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-639.9171830376913, -180.52605280012358, -900.9343692996621, -915.4908274591487, -200.54072766554108, -735.1070539227682, -1251.2860515814446, -1153.9336707494435, -1368.7353284102192, -358.30107238726066, -1150.0299064491908, -994.6819250657801, -760.6720411199054, -385.2408953330417, -1041.915991184098, -788.8025085132193, -803.4481519061018, -38.89009991735582, -602.0533448338471, -828.7505421502111, -601.2543670459307, -1048.8065947658688, -1137.4967508751276, -437.191204897104, -673.6741135709888, -827.0943443567478, -356.43342724213085, -1173.288574930941, -687.8521432566047, -822.5657096008806, -762.1893482265368, -661.1518226465988, -1167.2657176218959, -659.3016035018749, -338.5787636420592, -1093.2494021788577, -520.7104880542576, -1082.1677008434503, -832.7660271821625, -1127.5231260278072, -1191.7129282683684, -149.1232704218582, -298.84118562561116, -108.37098032480887, -1028.2303529127107, -131.29315050039642, -656.3494779226401, -178.65910300960934, -516.4836672745665, -1063.3090435593754, -354.80405161941445, -763.7000936981631, -1072.356963406681, -641.6459615234041, -608.2645325543663, -866.0635541911488, -1035.9060682277063, -1009.0812571725158, -411.66994742531693, -1082.9822416275065, -326.67718591275633, -752.0721533475346, -496.29572379485387, -214.9024267834427, -1234.6940177137394, -670.0101551190739, -38.74275016156827, -816.4057446890452, -788.4763832832658, -832.8835477141766, -169.03324829636594, -560.9956579488647, -425.56084310688044, -930.0253635484336, -593.8301797855804, -631.6828047390791, -166.74152168517878, -555.3841987056676, -562.288740153411, -610.936035277414, -572.8443819689397, -869.8657360482988, -978.9518665980523, -960.7648462499802, -1000.0618518926667, -1016.4765166218741, -858.9377952627601, -531.3568460398296, -1028.0692361718084, -925.6493542280706, -1039.881116692259, -1144.6877836552421, -154.391645655382, -306.29767667137065, -411.9466891756023, -705.499676923399, -1185.7463795693566, -500.3713851695227, -1022.8336030172155, -944.5596683697196], "episode_lengths": [142, 67, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 121, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 89, 56, 150, 72, 150, 97, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 89, 150, 150, 44, 150, 150, 150, 78, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 116, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-639.9171830376913, -180.52605280012358, -900.9343692996621, -915.4908274591487, -200.54072766554108, -735.1070539227682, -1251.2860515814446, -1153.9336707494435, -1368.7353284102192, -358.30107238726066, -1150.0299064491908, -994.6819250657801, -760.6720411199054, -385.2408953330417, -1041.915991184098, -788.8025085132193, -803.4481519061018, -38.89009991735582, -602.0533448338471, -828.7505421502111, -601.2543670459307, -1048.8065947658688, -1137.4967508751276, -437.191204897104, -673.6741135709888, -827.0943443567478, -356.43342724213085, -1173.288574930941, -687.8521432566047, -822.5657096008806, -762.1893482265368, -661.1518226465988, -1167.2657176218959, -659.3016035018749, -338.5787636420592, -1093.2494021788577, -520.7104880542576, -1082.1677008434503, -832.7660271821625, -1127.5231260278072, -1191.7129282683684, -149.1232704218582, -298.84118562561116, -108.37098032480887, -1028.2303529127107, -131.29315050039642, -656.3494779226401, -178.65910300960934, -516.4836672745665, -1063.3090435593754, -354.80405161941445, -763.7000936981631, -1072.356963406681, -641.6459615234041, -608.2645325543663, -866.0635541911488, -1035.9060682277063, -1009.0812571725158, -411.66994742531693, -1082.9822416275065, -326.67718591275633, -752.0721533475346, -496.29572379485387, -214.9024267834427, -1234.6940177137394, -670.0101551190739, -38.74275016156827, -816.4057446890452, -788.4763832832658, -832.8835477141766, -169.03324829636594, -560.9956579488647, -425.56084310688044, -930.0253635484336, -593.8301797855804, -631.6828047390791, -166.74152168517878, -555.3841987056676, -562.288740153411, -610.936035277414, -572.8443819689397, -869.8657360482988, -978.9518665980523, -960.7648462499802, -1000.0618518926667, -1016.4765166218741, -858.9377952627601, -531.3568460398296, -1028.0692361718084, -925.6493542280706, -1039.881116692259, -1144.6877836552421, -154.391645655382, -306.29767667137065, -411.9466891756023, -705.499676923399, -1185.7463795693566, -500.3713851695227, -1022.8336030172155, -944.5596683697196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569034090396648, "mean_inference_ms": 1.6978074738946574, "mean_action_processing_ms": 0.2811586547998781, "mean_env_wait_ms": 2.9976454758500823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01268315315246582, "StateBufferConnector_ms": 0.008043289184570312, "ViewRequirementAgentConnector_ms": 0.19921278953552246}, "num_episodes": 27, "episode_return_max": -38.74275016156827, "episode_return_min": -1368.7353284102192, "episode_return_mean": -718.1549954326774, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.25657575737955, "num_env_steps_trained_throughput_per_sec": 304.25657575737955, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13257.682, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13257.594, "sample_time_ms": 1023.775, "learn_time_ms": 12165.199, "learn_throughput": 328.807, "synch_weights_time_ms": 67.696}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00006", "date": "2024-08-03_10-51-26", "timestamp": 1722662486, "time_this_iter_s": 13.15888237953186, "time_total_s": 210.74075984954834, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907baef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 210.74075984954834, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.410526315789474, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 161.73599325517813, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.214110811551412, "policy_loss": -0.006851515737556231, "vf_loss": 2.2176022436469793, "vf_explained_var": 0.984887674326698, "kl": 0.0173380960070214, "entropy": 1.075342365168035, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -38.74275016156827, "episode_reward_min": -1234.6940177137394, "episode_reward_mean": -692.4982234527882, "episode_len_mean": 137.23, "episode_media": {}, "episodes_timesteps_total": 13723, "policy_reward_min": {"policy_0": -1234.6940177137394}, "policy_reward_max": {"policy_0": -38.74275016156827}, "policy_reward_mean": {"policy_0": -692.4982234527882}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-762.1893482265368, -661.1518226465988, -1167.2657176218959, -659.3016035018749, -338.5787636420592, -1093.2494021788577, -520.7104880542576, -1082.1677008434503, -832.7660271821625, -1127.5231260278072, -1191.7129282683684, -149.1232704218582, -298.84118562561116, -108.37098032480887, -1028.2303529127107, -131.29315050039642, -656.3494779226401, -178.65910300960934, -516.4836672745665, -1063.3090435593754, -354.80405161941445, -763.7000936981631, -1072.356963406681, -641.6459615234041, -608.2645325543663, -866.0635541911488, -1035.9060682277063, -1009.0812571725158, -411.66994742531693, -1082.9822416275065, -326.67718591275633, -752.0721533475346, -496.29572379485387, -214.9024267834427, -1234.6940177137394, -670.0101551190739, -38.74275016156827, -816.4057446890452, -788.4763832832658, -832.8835477141766, -169.03324829636594, -560.9956579488647, -425.56084310688044, -930.0253635484336, -593.8301797855804, -631.6828047390791, -166.74152168517878, -555.3841987056676, -562.288740153411, -610.936035277414, -572.8443819689397, -869.8657360482988, -978.9518665980523, -960.7648462499802, -1000.0618518926667, -1016.4765166218741, -858.9377952627601, -531.3568460398296, -1028.0692361718084, -925.6493542280706, -1039.881116692259, -1144.6877836552421, -154.391645655382, -306.29767667137065, -411.9466891756023, -705.499676923399, -1185.7463795693566, -500.3713851695227, -1022.8336030172155, -944.5596683697196, -667.556881194877, -939.2254966037942, -124.11054535362241, -957.3180414021841, -52.377957479154425, -557.2428724759853, -786.6820703571533, -1177.1421818597728, -822.7016877530507, -981.971446092813, -595.1588510113418, -463.8967666802536, -190.38141093061427, -1014.7906520689934, -829.7954668066095, -1109.5458135750634, -956.5245887733522, -335.7113593869023, -642.33276607745, -970.3831541860068, -256.0625937632073, -577.0460720212681, -881.7505947931577, -726.0522466893711, -785.1997043245941, -511.1145167686974, -39.35957850346532, -781.0236862136392, -454.4564851174664, -1112.3222880756011], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 89, 56, 150, 72, 150, 97, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 89, 150, 150, 44, 150, 150, 150, 78, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 116, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 65, 133, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 127, 150, 150, 109, 138, 150, 150, 150, 117, 63, 150, 150, 150], "policy_policy_0_reward": [-762.1893482265368, -661.1518226465988, -1167.2657176218959, -659.3016035018749, -338.5787636420592, -1093.2494021788577, -520.7104880542576, -1082.1677008434503, -832.7660271821625, -1127.5231260278072, -1191.7129282683684, -149.1232704218582, -298.84118562561116, -108.37098032480887, -1028.2303529127107, -131.29315050039642, -656.3494779226401, -178.65910300960934, -516.4836672745665, -1063.3090435593754, -354.80405161941445, -763.7000936981631, -1072.356963406681, -641.6459615234041, -608.2645325543663, -866.0635541911488, -1035.9060682277063, -1009.0812571725158, -411.66994742531693, -1082.9822416275065, -326.67718591275633, -752.0721533475346, -496.29572379485387, -214.9024267834427, -1234.6940177137394, -670.0101551190739, -38.74275016156827, -816.4057446890452, -788.4763832832658, -832.8835477141766, -169.03324829636594, -560.9956579488647, -425.56084310688044, -930.0253635484336, -593.8301797855804, -631.6828047390791, -166.74152168517878, -555.3841987056676, -562.288740153411, -610.936035277414, -572.8443819689397, -869.8657360482988, -978.9518665980523, -960.7648462499802, -1000.0618518926667, -1016.4765166218741, -858.9377952627601, -531.3568460398296, -1028.0692361718084, -925.6493542280706, -1039.881116692259, -1144.6877836552421, -154.391645655382, -306.29767667137065, -411.9466891756023, -705.499676923399, -1185.7463795693566, -500.3713851695227, -1022.8336030172155, -944.5596683697196, -667.556881194877, -939.2254966037942, -124.11054535362241, -957.3180414021841, -52.377957479154425, -557.2428724759853, -786.6820703571533, -1177.1421818597728, -822.7016877530507, -981.971446092813, -595.1588510113418, -463.8967666802536, -190.38141093061427, -1014.7906520689934, -829.7954668066095, -1109.5458135750634, -956.5245887733522, -335.7113593869023, -642.33276607745, -970.3831541860068, -256.0625937632073, -577.0460720212681, -881.7505947931577, -726.0522466893711, -785.1997043245941, -511.1145167686974, -39.35957850346532, -781.0236862136392, -454.4564851174664, -1112.3222880756011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567659854437519, "mean_inference_ms": 1.6979472692469815, "mean_action_processing_ms": 0.2812946435801535, "mean_env_wait_ms": 2.9970586688942205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0127105712890625, "StateBufferConnector_ms": 0.008103609085083008, "ViewRequirementAgentConnector_ms": 0.20102190971374512}, "num_episodes": 30, "episode_return_max": -38.74275016156827, "episode_return_min": -1234.6940177137394, "episode_return_mean": -692.4982234527882, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.66658451363315, "num_env_steps_trained_throughput_per_sec": 308.66658451363315, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13219.217, "restore_workers_time_ms": 0.036, "training_step_time_ms": 13219.128, "sample_time_ms": 1026.708, "learn_time_ms": 12123.523, "learn_throughput": 329.937, "synch_weights_time_ms": 67.974}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00006", "date": "2024-08-03_10-51-39", "timestamp": 1722662499, "time_this_iter_s": 12.971015214920044, "time_total_s": 223.71177506446838, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c575cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 223.71177506446838, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 14.222222222222221, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 169.6699122150739, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.210432121405999, "policy_loss": -0.00979807997549263, "vf_loss": 2.2169831422468027, "vf_explained_var": 0.9880169229581952, "kl": 0.016824839668576428, "entropy": 1.1790637425457438, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -35.88536680581363, "episode_reward_min": -1357.7474304614761, "episode_reward_mean": -687.2009715848374, "episode_len_mean": 136.62, "episode_media": {}, "episodes_timesteps_total": 13662, "policy_reward_min": {"policy_0": -1357.7474304614761}, "policy_reward_max": {"policy_0": -35.88536680581363}, "policy_reward_mean": {"policy_0": -687.2009715848374}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-752.0721533475346, -496.29572379485387, -214.9024267834427, -1234.6940177137394, -670.0101551190739, -38.74275016156827, -816.4057446890452, -788.4763832832658, -832.8835477141766, -169.03324829636594, -560.9956579488647, -425.56084310688044, -930.0253635484336, -593.8301797855804, -631.6828047390791, -166.74152168517878, -555.3841987056676, -562.288740153411, -610.936035277414, -572.8443819689397, -869.8657360482988, -978.9518665980523, -960.7648462499802, -1000.0618518926667, -1016.4765166218741, -858.9377952627601, -531.3568460398296, -1028.0692361718084, -925.6493542280706, -1039.881116692259, -1144.6877836552421, -154.391645655382, -306.29767667137065, -411.9466891756023, -705.499676923399, -1185.7463795693566, -500.3713851695227, -1022.8336030172155, -944.5596683697196, -667.556881194877, -939.2254966037942, -124.11054535362241, -957.3180414021841, -52.377957479154425, -557.2428724759853, -786.6820703571533, -1177.1421818597728, -822.7016877530507, -981.971446092813, -595.1588510113418, -463.8967666802536, -190.38141093061427, -1014.7906520689934, -829.7954668066095, -1109.5458135750634, -956.5245887733522, -335.7113593869023, -642.33276607745, -970.3831541860068, -256.0625937632073, -577.0460720212681, -881.7505947931577, -726.0522466893711, -785.1997043245941, -511.1145167686974, -39.35957850346532, -781.0236862136392, -454.4564851174664, -1112.3222880756011, -958.7492147254889, -193.82314044580235, -832.2116274880706, -665.1018475435171, -1357.7474304614761, -130.96645180098344, -1180.425778204971, -956.6746125512701, -687.4626407466427, -542.7620899148203, -35.88536680581363, -876.5706101771608, -165.68852193839876, -159.63157279357196, -921.775281494388, -151.62722633823924, -993.8397532736255, -432.0649605609069, -855.8283473393014, -741.0832856698482, -829.5123003066894, -221.00735844896246, -1113.7748754586032, -869.1961464752515, -768.4779413370336, -1191.0119926453044, -340.93076787034033, -1117.8608265545008, -316.39057506592474, -846.4736746974783, -756.1476111749622], "episode_lengths": [150, 150, 89, 150, 150, 44, 150, 150, 150, 78, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 116, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 65, 133, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 127, 150, 150, 109, 138, 150, 150, 150, 117, 63, 150, 150, 150, 150, 98, 150, 150, 150, 70, 150, 150, 150, 141, 51, 150, 92, 68, 150, 65, 150, 131, 150, 150, 150, 113, 150, 150, 150, 150, 149, 150, 150, 150, 150], "policy_policy_0_reward": [-752.0721533475346, -496.29572379485387, -214.9024267834427, -1234.6940177137394, -670.0101551190739, -38.74275016156827, -816.4057446890452, -788.4763832832658, -832.8835477141766, -169.03324829636594, -560.9956579488647, -425.56084310688044, -930.0253635484336, -593.8301797855804, -631.6828047390791, -166.74152168517878, -555.3841987056676, -562.288740153411, -610.936035277414, -572.8443819689397, -869.8657360482988, -978.9518665980523, -960.7648462499802, -1000.0618518926667, -1016.4765166218741, -858.9377952627601, -531.3568460398296, -1028.0692361718084, -925.6493542280706, -1039.881116692259, -1144.6877836552421, -154.391645655382, -306.29767667137065, -411.9466891756023, -705.499676923399, -1185.7463795693566, -500.3713851695227, -1022.8336030172155, -944.5596683697196, -667.556881194877, -939.2254966037942, -124.11054535362241, -957.3180414021841, -52.377957479154425, -557.2428724759853, -786.6820703571533, -1177.1421818597728, -822.7016877530507, -981.971446092813, -595.1588510113418, -463.8967666802536, -190.38141093061427, -1014.7906520689934, -829.7954668066095, -1109.5458135750634, -956.5245887733522, -335.7113593869023, -642.33276607745, -970.3831541860068, -256.0625937632073, -577.0460720212681, -881.7505947931577, -726.0522466893711, -785.1997043245941, -511.1145167686974, -39.35957850346532, -781.0236862136392, -454.4564851174664, -1112.3222880756011, -958.7492147254889, -193.82314044580235, -832.2116274880706, -665.1018475435171, -1357.7474304614761, -130.96645180098344, -1180.425778204971, -956.6746125512701, -687.4626407466427, -542.7620899148203, -35.88536680581363, -876.5706101771608, -165.68852193839876, -159.63157279357196, -921.775281494388, -151.62722633823924, -993.8397532736255, -432.0649605609069, -855.8283473393014, -741.0832856698482, -829.5123003066894, -221.00735844896246, -1113.7748754586032, -869.1961464752515, -768.4779413370336, -1191.0119926453044, -340.93076787034033, -1117.8608265545008, -316.39057506592474, -846.4736746974783, -756.1476111749622]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556715131778048, "mean_inference_ms": 1.6999481998704236, "mean_action_processing_ms": 0.28152986981483447, "mean_env_wait_ms": 2.9988100438562753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01315617561340332, "StateBufferConnector_ms": 0.008075714111328125, "ViewRequirementAgentConnector_ms": 0.2000882625579834}, "num_episodes": 31, "episode_return_max": -35.88536680581363, "episode_return_min": -1357.7474304614761, "episode_return_mean": -687.2009715848374, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.438724002989, "num_env_steps_trained_throughput_per_sec": 302.438724002989, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13220.555, "restore_workers_time_ms": 0.036, "training_step_time_ms": 13220.466, "sample_time_ms": 1030.047, "learn_time_ms": 12121.966, "learn_throughput": 329.979, "synch_weights_time_ms": 67.542}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00006", "date": "2024-08-03_10-51-52", "timestamp": 1722662512, "time_this_iter_s": 13.239418506622314, "time_total_s": 236.9511935710907, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c577d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 236.9511935710907, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.54736842105263, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.16708163817722, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.2089045378689964, "policy_loss": -0.006533911994968851, "vf_loss": 2.2125865294908484, "vf_explained_var": 0.9885590046023329, "kl": 0.014835000646477673, "entropy": 1.1507421168809135, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -24.362456987997124, "episode_reward_min": -1357.7474304614761, "episode_reward_mean": -644.1778914262641, "episode_len_mean": 129.98, "episode_media": {}, "episodes_timesteps_total": 12998, "policy_reward_min": {"policy_0": -1357.7474304614761}, "policy_reward_max": {"policy_0": -24.362456987997124}, "policy_reward_mean": {"policy_0": -644.1778914262641}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-306.29767667137065, -411.9466891756023, -705.499676923399, -1185.7463795693566, -500.3713851695227, -1022.8336030172155, -944.5596683697196, -667.556881194877, -939.2254966037942, -124.11054535362241, -957.3180414021841, -52.377957479154425, -557.2428724759853, -786.6820703571533, -1177.1421818597728, -822.7016877530507, -981.971446092813, -595.1588510113418, -463.8967666802536, -190.38141093061427, -1014.7906520689934, -829.7954668066095, -1109.5458135750634, -956.5245887733522, -335.7113593869023, -642.33276607745, -970.3831541860068, -256.0625937632073, -577.0460720212681, -881.7505947931577, -726.0522466893711, -785.1997043245941, -511.1145167686974, -39.35957850346532, -781.0236862136392, -454.4564851174664, -1112.3222880756011, -958.7492147254889, -193.82314044580235, -832.2116274880706, -665.1018475435171, -1357.7474304614761, -130.96645180098344, -1180.425778204971, -956.6746125512701, -687.4626407466427, -542.7620899148203, -35.88536680581363, -876.5706101771608, -165.68852193839876, -159.63157279357196, -921.775281494388, -151.62722633823924, -993.8397532736255, -432.0649605609069, -855.8283473393014, -741.0832856698482, -829.5123003066894, -221.00735844896246, -1113.7748754586032, -869.1961464752515, -768.4779413370336, -1191.0119926453044, -340.93076787034033, -1117.8608265545008, -316.39057506592474, -846.4736746974783, -756.1476111749622, -1120.5737679724878, -1211.7751667732318, -958.1111500296553, -67.81874361021232, -828.8830861673308, -911.5176643087842, -232.62249802347853, -974.2100601319047, -192.45959119339167, -42.67913051992597, -739.4109979920275, -875.5178128483793, -451.5855191724685, -1175.965841334584, -215.56215185878455, -943.2964487741261, -365.127633777382, -326.2874104909845, -858.082992147232, -24.362456987997124, -335.72493991796523, -235.55318902357595, -373.5229990470853, -92.42095918608281, -788.2699408807936, -641.9530924756548, -894.6107008275573, -931.1483429608473, -32.48004510552525, -116.11167246371427, -784.2696211832712, -88.67682989496355], "episode_lengths": [116, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 65, 133, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 127, 150, 150, 109, 138, 150, 150, 150, 117, 63, 150, 150, 150, 150, 98, 150, 150, 150, 70, 150, 150, 150, 141, 51, 150, 92, 68, 150, 65, 150, 131, 150, 150, 150, 113, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 91, 150, 88, 58, 150, 150, 117, 150, 99, 150, 99, 120, 150, 51, 91, 106, 150, 59, 150, 150, 150, 150, 63, 83, 150, 50], "policy_policy_0_reward": [-306.29767667137065, -411.9466891756023, -705.499676923399, -1185.7463795693566, -500.3713851695227, -1022.8336030172155, -944.5596683697196, -667.556881194877, -939.2254966037942, -124.11054535362241, -957.3180414021841, -52.377957479154425, -557.2428724759853, -786.6820703571533, -1177.1421818597728, -822.7016877530507, -981.971446092813, -595.1588510113418, -463.8967666802536, -190.38141093061427, -1014.7906520689934, -829.7954668066095, -1109.5458135750634, -956.5245887733522, -335.7113593869023, -642.33276607745, -970.3831541860068, -256.0625937632073, -577.0460720212681, -881.7505947931577, -726.0522466893711, -785.1997043245941, -511.1145167686974, -39.35957850346532, -781.0236862136392, -454.4564851174664, -1112.3222880756011, -958.7492147254889, -193.82314044580235, -832.2116274880706, -665.1018475435171, -1357.7474304614761, -130.96645180098344, -1180.425778204971, -956.6746125512701, -687.4626407466427, -542.7620899148203, -35.88536680581363, -876.5706101771608, -165.68852193839876, -159.63157279357196, -921.775281494388, -151.62722633823924, -993.8397532736255, -432.0649605609069, -855.8283473393014, -741.0832856698482, -829.5123003066894, -221.00735844896246, -1113.7748754586032, -869.1961464752515, -768.4779413370336, -1191.0119926453044, -340.93076787034033, -1117.8608265545008, -316.39057506592474, -846.4736746974783, -756.1476111749622, -1120.5737679724878, -1211.7751667732318, -958.1111500296553, -67.81874361021232, -828.8830861673308, -911.5176643087842, -232.62249802347853, -974.2100601319047, -192.45959119339167, -42.67913051992597, -739.4109979920275, -875.5178128483793, -451.5855191724685, -1175.965841334584, -215.56215185878455, -943.2964487741261, -365.127633777382, -326.2874104909845, -858.082992147232, -24.362456987997124, -335.72493991796523, -235.55318902357595, -373.5229990470853, -92.42095918608281, -788.2699408807936, -641.9530924756548, -894.6107008275573, -931.1483429608473, -32.48004510552525, -116.11167246371427, -784.2696211832712, -88.67682989496355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5571076900035938, "mean_inference_ms": 1.7005974273043651, "mean_action_processing_ms": 0.2817330839272948, "mean_env_wait_ms": 3.0005973334388973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013362884521484375, "StateBufferConnector_ms": 0.008220911026000977, "ViewRequirementAgentConnector_ms": 0.20148158073425293}, "num_episodes": 32, "episode_return_max": -24.362456987997124, "episode_return_min": -1357.7474304614761, "episode_return_mean": -644.1778914262641, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.3660258275086, "num_env_steps_trained_throughput_per_sec": 306.3660258275086, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13197.126, "restore_workers_time_ms": 0.037, "training_step_time_ms": 13197.035, "sample_time_ms": 1030.682, "learn_time_ms": 12100.302, "learn_throughput": 330.57, "synch_weights_time_ms": 65.142}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00006", "date": "2024-08-03_10-52-05", "timestamp": 1722662525, "time_this_iter_s": 13.068928480148315, "time_total_s": 250.020122051239, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907baef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 250.020122051239, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.468421052631578, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 162.9627711335818, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.50344122312963, "policy_loss": -0.01324659412202891, "vf_loss": 2.5135522415240605, "vf_explained_var": 0.9884548218299946, "kl": 0.01619931586707633, "entropy": 1.0429511197532217, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 3.8761330632205078, "episode_reward_min": -1357.7474304614761, "episode_reward_mean": -630.9924694311175, "episode_len_mean": 128.99, "episode_media": {}, "episodes_timesteps_total": 12899, "policy_reward_min": {"policy_0": -1357.7474304614761}, "policy_reward_max": {"policy_0": 3.8761330632205078}, "policy_reward_mean": {"policy_0": -630.9924694311175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.0522466893711, -785.1997043245941, -511.1145167686974, -39.35957850346532, -781.0236862136392, -454.4564851174664, -1112.3222880756011, -958.7492147254889, -193.82314044580235, -832.2116274880706, -665.1018475435171, -1357.7474304614761, -130.96645180098344, -1180.425778204971, -956.6746125512701, -687.4626407466427, -542.7620899148203, -35.88536680581363, -876.5706101771608, -165.68852193839876, -159.63157279357196, -921.775281494388, -151.62722633823924, -993.8397532736255, -432.0649605609069, -855.8283473393014, -741.0832856698482, -829.5123003066894, -221.00735844896246, -1113.7748754586032, -869.1961464752515, -768.4779413370336, -1191.0119926453044, -340.93076787034033, -1117.8608265545008, -316.39057506592474, -846.4736746974783, -756.1476111749622, -1120.5737679724878, -1211.7751667732318, -958.1111500296553, -67.81874361021232, -828.8830861673308, -911.5176643087842, -232.62249802347853, -974.2100601319047, -192.45959119339167, -42.67913051992597, -739.4109979920275, -875.5178128483793, -451.5855191724685, -1175.965841334584, -215.56215185878455, -943.2964487741261, -365.127633777382, -326.2874104909845, -858.082992147232, -24.362456987997124, -335.72493991796523, -235.55318902357595, -373.5229990470853, -92.42095918608281, -788.2699408807936, -641.9530924756548, -894.6107008275573, -931.1483429608473, -32.48004510552525, -116.11167246371427, -784.2696211832712, -88.67682989496355, -1031.8542058394567, -495.5122591310031, -588.2063405220699, -781.092318141471, -805.3711252191523, -980.0823305376077, -905.1124249108361, -602.037351792473, -645.5431509345154, -846.4013942124409, -639.0116229823527, -344.8433970285859, -972.4453476035537, -44.4982227206708, -594.5755191110877, -984.158541180955, -412.06292042871695, 3.8761330632205078, -1168.2819196613684, -459.8868952017298, -295.54120068518773, -1270.8424828302996, -399.0868175136282, -566.1446566830901, -1104.8923562452073, -7.547191362472631, -665.3523002578154, -569.9326934829854, -125.66081434929313, -1346.3204825213388], "episode_lengths": [150, 150, 117, 63, 150, 150, 150, 150, 98, 150, 150, 150, 70, 150, 150, 150, 141, 51, 150, 92, 68, 150, 65, 150, 131, 150, 150, 150, 113, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 91, 150, 88, 58, 150, 150, 117, 150, 99, 150, 99, 120, 150, 51, 91, 106, 150, 59, 150, 150, 150, 150, 63, 83, 150, 50, 150, 150, 150, 150, 150, 150, 150, 128, 140, 150, 150, 137, 150, 58, 150, 150, 150, 36, 150, 150, 146, 150, 150, 150, 150, 38, 150, 150, 74, 150], "policy_policy_0_reward": [-726.0522466893711, -785.1997043245941, -511.1145167686974, -39.35957850346532, -781.0236862136392, -454.4564851174664, -1112.3222880756011, -958.7492147254889, -193.82314044580235, -832.2116274880706, -665.1018475435171, -1357.7474304614761, -130.96645180098344, -1180.425778204971, -956.6746125512701, -687.4626407466427, -542.7620899148203, -35.88536680581363, -876.5706101771608, -165.68852193839876, -159.63157279357196, -921.775281494388, -151.62722633823924, -993.8397532736255, -432.0649605609069, -855.8283473393014, -741.0832856698482, -829.5123003066894, -221.00735844896246, -1113.7748754586032, -869.1961464752515, -768.4779413370336, -1191.0119926453044, -340.93076787034033, -1117.8608265545008, -316.39057506592474, -846.4736746974783, -756.1476111749622, -1120.5737679724878, -1211.7751667732318, -958.1111500296553, -67.81874361021232, -828.8830861673308, -911.5176643087842, -232.62249802347853, -974.2100601319047, -192.45959119339167, -42.67913051992597, -739.4109979920275, -875.5178128483793, -451.5855191724685, -1175.965841334584, -215.56215185878455, -943.2964487741261, -365.127633777382, -326.2874104909845, -858.082992147232, -24.362456987997124, -335.72493991796523, -235.55318902357595, -373.5229990470853, -92.42095918608281, -788.2699408807936, -641.9530924756548, -894.6107008275573, -931.1483429608473, -32.48004510552525, -116.11167246371427, -784.2696211832712, -88.67682989496355, -1031.8542058394567, -495.5122591310031, -588.2063405220699, -781.092318141471, -805.3711252191523, -980.0823305376077, -905.1124249108361, -602.037351792473, -645.5431509345154, -846.4013942124409, -639.0116229823527, -344.8433970285859, -972.4453476035537, -44.4982227206708, -594.5755191110877, -984.158541180955, -412.06292042871695, 3.8761330632205078, -1168.2819196613684, -459.8868952017298, -295.54120068518773, -1270.8424828302996, -399.0868175136282, -566.1446566830901, -1104.8923562452073, -7.547191362472631, -665.3523002578154, -569.9326934829854, -125.66081434929313, -1346.3204825213388]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5573732513787919, "mean_inference_ms": 1.7007557249486545, "mean_action_processing_ms": 0.2816845449204946, "mean_env_wait_ms": 3.0010729932632447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012978076934814453, "StateBufferConnector_ms": 0.008007287979125977, "ViewRequirementAgentConnector_ms": 0.1967029571533203}, "num_episodes": 30, "episode_return_max": 3.8761330632205078, "episode_return_min": -1357.7474304614761, "episode_return_mean": -630.9924694311175, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.6871879782287, "num_env_steps_trained_throughput_per_sec": 364.6871879782287, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12962.496, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12962.407, "sample_time_ms": 1025.083, "learn_time_ms": 11871.991, "learn_throughput": 336.927, "synch_weights_time_ms": 64.421}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00006", "date": "2024-08-03_10-52-16", "timestamp": 1722662536, "time_this_iter_s": 10.983939409255981, "time_total_s": 261.004061460495, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c576320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 261.004061460495, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 14.681249999999999, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 186.29668654402096, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.8824288464772205, "policy_loss": -0.010228680920166273, "vf_loss": 1.8885454862068096, "vf_explained_var": 0.9921818157037099, "kl": 0.021091860256516777, "entropy": 1.063329238941272, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": 3.8761330632205078, "episode_reward_min": -1346.3204825213388, "episode_reward_mean": -642.7864091385591, "episode_len_mean": 131.0, "episode_media": {}, "episodes_timesteps_total": 13100, "policy_reward_min": {"policy_0": -1346.3204825213388}, "policy_reward_max": {"policy_0": 3.8761330632205078}, "policy_reward_mean": {"policy_0": -642.7864091385591}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-768.4779413370336, -1191.0119926453044, -340.93076787034033, -1117.8608265545008, -316.39057506592474, -846.4736746974783, -756.1476111749622, -1120.5737679724878, -1211.7751667732318, -958.1111500296553, -67.81874361021232, -828.8830861673308, -911.5176643087842, -232.62249802347853, -974.2100601319047, -192.45959119339167, -42.67913051992597, -739.4109979920275, -875.5178128483793, -451.5855191724685, -1175.965841334584, -215.56215185878455, -943.2964487741261, -365.127633777382, -326.2874104909845, -858.082992147232, -24.362456987997124, -335.72493991796523, -235.55318902357595, -373.5229990470853, -92.42095918608281, -788.2699408807936, -641.9530924756548, -894.6107008275573, -931.1483429608473, -32.48004510552525, -116.11167246371427, -784.2696211832712, -88.67682989496355, -1031.8542058394567, -495.5122591310031, -588.2063405220699, -781.092318141471, -805.3711252191523, -980.0823305376077, -905.1124249108361, -602.037351792473, -645.5431509345154, -846.4013942124409, -639.0116229823527, -344.8433970285859, -972.4453476035537, -44.4982227206708, -594.5755191110877, -984.158541180955, -412.06292042871695, 3.8761330632205078, -1168.2819196613684, -459.8868952017298, -295.54120068518773, -1270.8424828302996, -399.0868175136282, -566.1446566830901, -1104.8923562452073, -7.547191362472631, -665.3523002578154, -569.9326934829854, -125.66081434929313, -1346.3204825213388, -1003.6773362662302, -82.79275796032593, -902.6208588146895, -761.440472855271, -390.6737374837893, -481.49589092631123, -1087.635255647241, -1033.8540982239697, -423.82144267423774, -1142.248903662171, -457.4312602848058, -70.9494803699532, -1165.2444504340508, -954.4818055966809, -792.0060012862854, -809.0915131998438, -716.3474184032005, -739.1248479260091, -964.1040416887123, -945.0989423947293, -225.6681358441119, -70.83248697584858, -1027.968056222752, -146.68025781952235, -959.9500421536097, -786.2437951091895, -521.2677120034382, -1114.6843760709435, -879.9675940640911, -589.1212063603219, -215.80873867847552], "episode_lengths": [150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 91, 150, 88, 58, 150, 150, 117, 150, 99, 150, 99, 120, 150, 51, 91, 106, 150, 59, 150, 150, 150, 150, 63, 83, 150, 50, 150, 150, 150, 150, 150, 150, 150, 128, 140, 150, 150, 137, 150, 58, 150, 150, 150, 36, 150, 150, 146, 150, 150, 150, 150, 38, 150, 150, 74, 150, 150, 59, 150, 150, 150, 120, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 106, 71, 150, 78, 150, 150, 150, 150, 150, 150, 112], "policy_policy_0_reward": [-768.4779413370336, -1191.0119926453044, -340.93076787034033, -1117.8608265545008, -316.39057506592474, -846.4736746974783, -756.1476111749622, -1120.5737679724878, -1211.7751667732318, -958.1111500296553, -67.81874361021232, -828.8830861673308, -911.5176643087842, -232.62249802347853, -974.2100601319047, -192.45959119339167, -42.67913051992597, -739.4109979920275, -875.5178128483793, -451.5855191724685, -1175.965841334584, -215.56215185878455, -943.2964487741261, -365.127633777382, -326.2874104909845, -858.082992147232, -24.362456987997124, -335.72493991796523, -235.55318902357595, -373.5229990470853, -92.42095918608281, -788.2699408807936, -641.9530924756548, -894.6107008275573, -931.1483429608473, -32.48004510552525, -116.11167246371427, -784.2696211832712, -88.67682989496355, -1031.8542058394567, -495.5122591310031, -588.2063405220699, -781.092318141471, -805.3711252191523, -980.0823305376077, -905.1124249108361, -602.037351792473, -645.5431509345154, -846.4013942124409, -639.0116229823527, -344.8433970285859, -972.4453476035537, -44.4982227206708, -594.5755191110877, -984.158541180955, -412.06292042871695, 3.8761330632205078, -1168.2819196613684, -459.8868952017298, -295.54120068518773, -1270.8424828302996, -399.0868175136282, -566.1446566830901, -1104.8923562452073, -7.547191362472631, -665.3523002578154, -569.9326934829854, -125.66081434929313, -1346.3204825213388, -1003.6773362662302, -82.79275796032593, -902.6208588146895, -761.440472855271, -390.6737374837893, -481.49589092631123, -1087.635255647241, -1033.8540982239697, -423.82144267423774, -1142.248903662171, -457.4312602848058, -70.9494803699532, -1165.2444504340508, -954.4818055966809, -792.0060012862854, -809.0915131998438, -716.3474184032005, -739.1248479260091, -964.1040416887123, -945.0989423947293, -225.6681358441119, -70.83248697584858, -1027.968056222752, -146.68025781952235, -959.9500421536097, -786.2437951091895, -521.2677120034382, -1114.6843760709435, -879.9675940640911, -589.1212063603219, -215.80873867847552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.557212005329674, "mean_inference_ms": 1.6994118193671393, "mean_action_processing_ms": 0.2813661597411681, "mean_env_wait_ms": 3.000886421643442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012914180755615234, "StateBufferConnector_ms": 0.008055925369262695, "ViewRequirementAgentConnector_ms": 0.19691801071166992}, "num_episodes": 31, "episode_return_max": 3.8761330632205078, "episode_return_min": -1346.3204825213388, "episode_return_mean": -642.7864091385591, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.7633016984014, "num_env_steps_trained_throughput_per_sec": 302.7633016984014, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12950.274, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12950.184, "sample_time_ms": 1023.721, "learn_time_ms": 11859.952, "learn_throughput": 337.27, "synch_weights_time_ms": 65.591}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00006", "date": "2024-08-03_10-52-30", "timestamp": 1722662550, "time_this_iter_s": 13.224936962127686, "time_total_s": 274.2289984226227, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c577130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 274.2289984226227, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.799999999999999, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 212.31458525657655, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.680944817016522, "policy_loss": -0.011738688437617384, "vf_loss": 1.687148264112572, "vf_explained_var": 0.997029158535103, "kl": 0.01886925250604084, "entropy": 1.2553048906847835, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": 3.8761330632205078, "episode_reward_min": -1346.3204825213388, "episode_reward_mean": -671.8140118713269, "episode_len_mean": 132.62, "episode_media": {}, "episodes_timesteps_total": 13262, "policy_reward_min": {"policy_0": -1346.3204825213388}, "policy_reward_max": {"policy_0": 3.8761330632205078}, "policy_reward_mean": {"policy_0": -671.8140118713269}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-335.72493991796523, -235.55318902357595, -373.5229990470853, -92.42095918608281, -788.2699408807936, -641.9530924756548, -894.6107008275573, -931.1483429608473, -32.48004510552525, -116.11167246371427, -784.2696211832712, -88.67682989496355, -1031.8542058394567, -495.5122591310031, -588.2063405220699, -781.092318141471, -805.3711252191523, -980.0823305376077, -905.1124249108361, -602.037351792473, -645.5431509345154, -846.4013942124409, -639.0116229823527, -344.8433970285859, -972.4453476035537, -44.4982227206708, -594.5755191110877, -984.158541180955, -412.06292042871695, 3.8761330632205078, -1168.2819196613684, -459.8868952017298, -295.54120068518773, -1270.8424828302996, -399.0868175136282, -566.1446566830901, -1104.8923562452073, -7.547191362472631, -665.3523002578154, -569.9326934829854, -125.66081434929313, -1346.3204825213388, -1003.6773362662302, -82.79275796032593, -902.6208588146895, -761.440472855271, -390.6737374837893, -481.49589092631123, -1087.635255647241, -1033.8540982239697, -423.82144267423774, -1142.248903662171, -457.4312602848058, -70.9494803699532, -1165.2444504340508, -954.4818055966809, -792.0060012862854, -809.0915131998438, -716.3474184032005, -739.1248479260091, -964.1040416887123, -945.0989423947293, -225.6681358441119, -70.83248697584858, -1027.968056222752, -146.68025781952235, -959.9500421536097, -786.2437951091895, -521.2677120034382, -1114.6843760709435, -879.9675940640911, -589.1212063603219, -215.80873867847552, -555.6636160588424, -603.0310214659419, -42.133851739630124, -462.9697913900976, -80.73668834399544, -1003.5769976369714, -43.997727553126666, -1092.08591821022, -878.7644284837334, -998.1644832585434, -961.9116049200944, -891.2855223708567, -1059.5333013726176, -1238.8386931073267, -178.26328474736485, -838.5403691684104, -1018.3567442046367, -1219.7737550444378, -1220.115179703048, -925.1506721679865, -1088.7131775846299, -635.6084232187151, -790.7991515171392, -138.22734895184098, -666.2853800158556, -949.4409721888097, -1173.9356823118333], "episode_lengths": [91, 106, 150, 59, 150, 150, 150, 150, 63, 83, 150, 50, 150, 150, 150, 150, 150, 150, 150, 128, 140, 150, 150, 137, 150, 58, 150, 150, 150, 36, 150, 150, 146, 150, 150, 150, 150, 38, 150, 150, 74, 150, 150, 59, 150, 150, 150, 120, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 106, 71, 150, 78, 150, 150, 150, 150, 150, 150, 112, 150, 150, 61, 150, 84, 150, 49, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150], "policy_policy_0_reward": [-335.72493991796523, -235.55318902357595, -373.5229990470853, -92.42095918608281, -788.2699408807936, -641.9530924756548, -894.6107008275573, -931.1483429608473, -32.48004510552525, -116.11167246371427, -784.2696211832712, -88.67682989496355, -1031.8542058394567, -495.5122591310031, -588.2063405220699, -781.092318141471, -805.3711252191523, -980.0823305376077, -905.1124249108361, -602.037351792473, -645.5431509345154, -846.4013942124409, -639.0116229823527, -344.8433970285859, -972.4453476035537, -44.4982227206708, -594.5755191110877, -984.158541180955, -412.06292042871695, 3.8761330632205078, -1168.2819196613684, -459.8868952017298, -295.54120068518773, -1270.8424828302996, -399.0868175136282, -566.1446566830901, -1104.8923562452073, -7.547191362472631, -665.3523002578154, -569.9326934829854, -125.66081434929313, -1346.3204825213388, -1003.6773362662302, -82.79275796032593, -902.6208588146895, -761.440472855271, -390.6737374837893, -481.49589092631123, -1087.635255647241, -1033.8540982239697, -423.82144267423774, -1142.248903662171, -457.4312602848058, -70.9494803699532, -1165.2444504340508, -954.4818055966809, -792.0060012862854, -809.0915131998438, -716.3474184032005, -739.1248479260091, -964.1040416887123, -945.0989423947293, -225.6681358441119, -70.83248697584858, -1027.968056222752, -146.68025781952235, -959.9500421536097, -786.2437951091895, -521.2677120034382, -1114.6843760709435, -879.9675940640911, -589.1212063603219, -215.80873867847552, -555.6636160588424, -603.0310214659419, -42.133851739630124, -462.9697913900976, -80.73668834399544, -1003.5769976369714, -43.997727553126666, -1092.08591821022, -878.7644284837334, -998.1644832585434, -961.9116049200944, -891.2855223708567, -1059.5333013726176, -1238.8386931073267, -178.26328474736485, -838.5403691684104, -1018.3567442046367, -1219.7737550444378, -1220.115179703048, -925.1506721679865, -1088.7131775846299, -635.6084232187151, -790.7991515171392, -138.22734895184098, -666.2853800158556, -949.4409721888097, -1173.9356823118333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5570685380194583, "mean_inference_ms": 1.6981042275459577, "mean_action_processing_ms": 0.28114019022317693, "mean_env_wait_ms": 2.9988561321908502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012537240982055664, "StateBufferConnector_ms": 0.00809621810913086, "ViewRequirementAgentConnector_ms": 0.1982707977294922}, "num_episodes": 27, "episode_return_max": 3.8761330632205078, "episode_return_min": -1346.3204825213388, "episode_return_mean": -671.8140118713269, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.68175676647985, "num_env_steps_trained_throughput_per_sec": 303.68175676647985, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12939.892, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12939.802, "sample_time_ms": 1021.637, "learn_time_ms": 11850.682, "learn_throughput": 337.533, "synch_weights_time_ms": 66.591}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00006", "date": "2024-08-03_10-52-43", "timestamp": 1722662563, "time_this_iter_s": 13.184603452682495, "time_total_s": 287.4136018753052, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c576b00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 287.4136018753052, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.494736842105262, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 176.74785309235256, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.2065044339746236, "policy_loss": -0.010314772916414465, "vf_loss": 2.2113866900404293, "vf_explained_var": 0.9924043448021015, "kl": 0.018402940871699986, "entropy": 0.8836572509879868, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -7.547191362472631, "episode_reward_min": -1346.3204825213388, "episode_reward_mean": -686.524640882826, "episode_len_mean": 131.08, "episode_media": {}, "episodes_timesteps_total": 13108, "policy_reward_min": {"policy_0": -1346.3204825213388}, "policy_reward_max": {"policy_0": -7.547191362472631}, "policy_reward_mean": {"policy_0": -686.524640882826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1270.8424828302996, -399.0868175136282, -566.1446566830901, -1104.8923562452073, -7.547191362472631, -665.3523002578154, -569.9326934829854, -125.66081434929313, -1346.3204825213388, -1003.6773362662302, -82.79275796032593, -902.6208588146895, -761.440472855271, -390.6737374837893, -481.49589092631123, -1087.635255647241, -1033.8540982239697, -423.82144267423774, -1142.248903662171, -457.4312602848058, -70.9494803699532, -1165.2444504340508, -954.4818055966809, -792.0060012862854, -809.0915131998438, -716.3474184032005, -739.1248479260091, -964.1040416887123, -945.0989423947293, -225.6681358441119, -70.83248697584858, -1027.968056222752, -146.68025781952235, -959.9500421536097, -786.2437951091895, -521.2677120034382, -1114.6843760709435, -879.9675940640911, -589.1212063603219, -215.80873867847552, -555.6636160588424, -603.0310214659419, -42.133851739630124, -462.9697913900976, -80.73668834399544, -1003.5769976369714, -43.997727553126666, -1092.08591821022, -878.7644284837334, -998.1644832585434, -961.9116049200944, -891.2855223708567, -1059.5333013726176, -1238.8386931073267, -178.26328474736485, -838.5403691684104, -1018.3567442046367, -1219.7737550444378, -1220.115179703048, -925.1506721679865, -1088.7131775846299, -635.6084232187151, -790.7991515171392, -138.22734895184098, -666.2853800158556, -949.4409721888097, -1173.9356823118333, -685.825762128955, -106.91292660398639, -1261.6116712247183, -28.183239737331363, -790.3720353482506, -993.0550947268506, -1009.9331170164132, -1176.389177057255, -84.9269830772295, -1042.0925131524814, -173.98756229061675, -70.24059889101315, -809.0381942160977, -271.78865386510023, -1003.6029971676106, -779.9124049717993, -263.6298142705077, -776.0467230475056, -573.7754484285279, -1144.3540595533573, -1007.5135284673601, -436.95910836282025, -61.080033492937616, -9.70136619770889, -253.52528544690708, -864.9266867109746, -975.9198932215431, -1057.7765108737783, -727.8180102638775, -224.22197731721167, -856.980508615288, -345.93976858446325, -510.4059345684813], "episode_lengths": [150, 150, 150, 150, 38, 150, 150, 74, 150, 150, 59, 150, 150, 150, 120, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 106, 71, 150, 78, 150, 150, 150, 150, 150, 150, 112, 150, 150, 61, 150, 84, 150, 49, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 71, 150, 56, 150, 150, 150, 150, 59, 150, 68, 69, 150, 103, 150, 150, 96, 150, 150, 150, 150, 145, 67, 41, 109, 150, 150, 150, 150, 90, 150, 119, 150], "policy_policy_0_reward": [-1270.8424828302996, -399.0868175136282, -566.1446566830901, -1104.8923562452073, -7.547191362472631, -665.3523002578154, -569.9326934829854, -125.66081434929313, -1346.3204825213388, -1003.6773362662302, -82.79275796032593, -902.6208588146895, -761.440472855271, -390.6737374837893, -481.49589092631123, -1087.635255647241, -1033.8540982239697, -423.82144267423774, -1142.248903662171, -457.4312602848058, -70.9494803699532, -1165.2444504340508, -954.4818055966809, -792.0060012862854, -809.0915131998438, -716.3474184032005, -739.1248479260091, -964.1040416887123, -945.0989423947293, -225.6681358441119, -70.83248697584858, -1027.968056222752, -146.68025781952235, -959.9500421536097, -786.2437951091895, -521.2677120034382, -1114.6843760709435, -879.9675940640911, -589.1212063603219, -215.80873867847552, -555.6636160588424, -603.0310214659419, -42.133851739630124, -462.9697913900976, -80.73668834399544, -1003.5769976369714, -43.997727553126666, -1092.08591821022, -878.7644284837334, -998.1644832585434, -961.9116049200944, -891.2855223708567, -1059.5333013726176, -1238.8386931073267, -178.26328474736485, -838.5403691684104, -1018.3567442046367, -1219.7737550444378, -1220.115179703048, -925.1506721679865, -1088.7131775846299, -635.6084232187151, -790.7991515171392, -138.22734895184098, -666.2853800158556, -949.4409721888097, -1173.9356823118333, -685.825762128955, -106.91292660398639, -1261.6116712247183, -28.183239737331363, -790.3720353482506, -993.0550947268506, -1009.9331170164132, -1176.389177057255, -84.9269830772295, -1042.0925131524814, -173.98756229061675, -70.24059889101315, -809.0381942160977, -271.78865386510023, -1003.6029971676106, -779.9124049717993, -263.6298142705077, -776.0467230475056, -573.7754484285279, -1144.3540595533573, -1007.5135284673601, -436.95910836282025, -61.080033492937616, -9.70136619770889, -253.52528544690708, -864.9266867109746, -975.9198932215431, -1057.7765108737783, -727.8180102638775, -224.22197731721167, -856.980508615288, -345.93976858446325, -510.4059345684813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5574834253381109, "mean_inference_ms": 1.6993111270201227, "mean_action_processing_ms": 0.28115096009875856, "mean_env_wait_ms": 3.0002570962402437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012429952621459961, "StateBufferConnector_ms": 0.007990837097167969, "ViewRequirementAgentConnector_ms": 0.19785690307617188}, "num_episodes": 33, "episode_return_max": -7.547191362472631, "episode_return_min": -1346.3204825213388, "episode_return_mean": -686.524640882826, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.1568683458402, "num_env_steps_trained_throughput_per_sec": 302.1568683458402, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12951.748, "restore_workers_time_ms": 0.038, "training_step_time_ms": 12951.654, "sample_time_ms": 1024.909, "learn_time_ms": 11858.511, "learn_throughput": 337.31, "synch_weights_time_ms": 67.337}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00006", "date": "2024-08-03_10-52-56", "timestamp": 1722662576, "time_this_iter_s": 13.251799583435059, "time_total_s": 300.66540145874023, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907baef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 300.66540145874023, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.731578947368423, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 167.14624668955804, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.9579842450718086, "policy_loss": -0.011664203010150231, "vf_loss": 1.9650488431875905, "vf_explained_var": 0.9867775740722815, "kl": 0.015716947304129765, "entropy": 1.154837605667611, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -9.70136619770889, "episode_reward_min": -1263.3868861773863, "episode_reward_mean": -697.1012701926172, "episode_len_mean": 131.39, "episode_media": {}, "episodes_timesteps_total": 13139, "policy_reward_min": {"policy_0": -1263.3868861773863}, "policy_reward_max": {"policy_0": -9.70136619770889}, "policy_reward_mean": {"policy_0": -697.1012701926172}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-146.68025781952235, -959.9500421536097, -786.2437951091895, -521.2677120034382, -1114.6843760709435, -879.9675940640911, -589.1212063603219, -215.80873867847552, -555.6636160588424, -603.0310214659419, -42.133851739630124, -462.9697913900976, -80.73668834399544, -1003.5769976369714, -43.997727553126666, -1092.08591821022, -878.7644284837334, -998.1644832585434, -961.9116049200944, -891.2855223708567, -1059.5333013726176, -1238.8386931073267, -178.26328474736485, -838.5403691684104, -1018.3567442046367, -1219.7737550444378, -1220.115179703048, -925.1506721679865, -1088.7131775846299, -635.6084232187151, -790.7991515171392, -138.22734895184098, -666.2853800158556, -949.4409721888097, -1173.9356823118333, -685.825762128955, -106.91292660398639, -1261.6116712247183, -28.183239737331363, -790.3720353482506, -993.0550947268506, -1009.9331170164132, -1176.389177057255, -84.9269830772295, -1042.0925131524814, -173.98756229061675, -70.24059889101315, -809.0381942160977, -271.78865386510023, -1003.6029971676106, -779.9124049717993, -263.6298142705077, -776.0467230475056, -573.7754484285279, -1144.3540595533573, -1007.5135284673601, -436.95910836282025, -61.080033492937616, -9.70136619770889, -253.52528544690708, -864.9266867109746, -975.9198932215431, -1057.7765108737783, -727.8180102638775, -224.22197731721167, -856.980508615288, -345.93976858446325, -510.4059345684813, -1078.781908890925, -1263.3868861773863, -24.234363092688355, -1006.9913969077256, -847.1560156139514, -515.9393265398666, -703.0318795606171, -1053.3596611936055, -1098.228516381775, -196.97385058100218, -846.1894338175061, -1070.7294552404378, -435.1257935557265, -1166.5521082187638, -1076.076524615744, -1075.2070539528772, -43.38380950628387, -1049.0835128696003, -994.7350905616611, -433.6195002870087, -464.4552903301011, -554.3859706882173, -61.56952550860879, -822.6087762658442, -679.8321086922361, -925.7114681848103, -643.4548257702565, -122.7108123842144, -387.2106014679722, -1158.8935945549692, -920.2831308274419, -642.1497291266265], "episode_lengths": [78, 150, 150, 150, 150, 150, 150, 112, 150, 150, 61, 150, 84, 150, 49, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 71, 150, 56, 150, 150, 150, 150, 59, 150, 68, 69, 150, 103, 150, 150, 96, 150, 150, 150, 150, 145, 67, 41, 109, 150, 150, 150, 150, 90, 150, 119, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 85, 150, 150, 125, 150, 150, 150, 59, 150, 150, 115, 150, 150, 64, 150, 150, 150, 144, 86, 150, 150, 150, 143], "policy_policy_0_reward": [-146.68025781952235, -959.9500421536097, -786.2437951091895, -521.2677120034382, -1114.6843760709435, -879.9675940640911, -589.1212063603219, -215.80873867847552, -555.6636160588424, -603.0310214659419, -42.133851739630124, -462.9697913900976, -80.73668834399544, -1003.5769976369714, -43.997727553126666, -1092.08591821022, -878.7644284837334, -998.1644832585434, -961.9116049200944, -891.2855223708567, -1059.5333013726176, -1238.8386931073267, -178.26328474736485, -838.5403691684104, -1018.3567442046367, -1219.7737550444378, -1220.115179703048, -925.1506721679865, -1088.7131775846299, -635.6084232187151, -790.7991515171392, -138.22734895184098, -666.2853800158556, -949.4409721888097, -1173.9356823118333, -685.825762128955, -106.91292660398639, -1261.6116712247183, -28.183239737331363, -790.3720353482506, -993.0550947268506, -1009.9331170164132, -1176.389177057255, -84.9269830772295, -1042.0925131524814, -173.98756229061675, -70.24059889101315, -809.0381942160977, -271.78865386510023, -1003.6029971676106, -779.9124049717993, -263.6298142705077, -776.0467230475056, -573.7754484285279, -1144.3540595533573, -1007.5135284673601, -436.95910836282025, -61.080033492937616, -9.70136619770889, -253.52528544690708, -864.9266867109746, -975.9198932215431, -1057.7765108737783, -727.8180102638775, -224.22197731721167, -856.980508615288, -345.93976858446325, -510.4059345684813, -1078.781908890925, -1263.3868861773863, -24.234363092688355, -1006.9913969077256, -847.1560156139514, -515.9393265398666, -703.0318795606171, -1053.3596611936055, -1098.228516381775, -196.97385058100218, -846.1894338175061, -1070.7294552404378, -435.1257935557265, -1166.5521082187638, -1076.076524615744, -1075.2070539528772, -43.38380950628387, -1049.0835128696003, -994.7350905616611, -433.6195002870087, -464.4552903301011, -554.3859706882173, -61.56952550860879, -822.6087762658442, -679.8321086922361, -925.7114681848103, -643.4548257702565, -122.7108123842144, -387.2106014679722, -1158.8935945549692, -920.2831308274419, -642.1497291266265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578997681309749, "mean_inference_ms": 1.7008906489651177, "mean_action_processing_ms": 0.2812049795880565, "mean_env_wait_ms": 3.003004561291251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012771129608154297, "StateBufferConnector_ms": 0.00809478759765625, "ViewRequirementAgentConnector_ms": 0.2012650966644287}, "num_episodes": 32, "episode_return_max": -9.70136619770889, "episode_return_min": -1263.3868861773863, "episode_return_mean": -697.1012701926172, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.153437638343, "num_env_steps_trained_throughput_per_sec": 311.153437638343, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12929.263, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12929.171, "sample_time_ms": 1026.597, "learn_time_ms": 11835.12, "learn_throughput": 337.977, "synch_weights_time_ms": 66.567}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00006", "date": "2024-08-03_10-53-09", "timestamp": 1722662589, "time_this_iter_s": 12.868755340576172, "time_total_s": 313.5341567993164, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c522440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 313.5341567993164, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.563157894736845, "ram_util_percent": 27.673684210526314}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 138.21936756769816, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.1468109328920644, "policy_loss": -0.011862361313978909, "vf_loss": 2.153503576417764, "vf_explained_var": 0.9932670263573528, "kl": 0.017614082859048117, "entropy": 1.1451436629518867, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -9.70136619770889, "episode_reward_min": -1365.041032451094, "episode_reward_mean": -659.4951494631906, "episode_len_mean": 127.71, "episode_media": {}, "episodes_timesteps_total": 12771, "policy_reward_min": {"policy_0": -1365.041032451094}, "policy_reward_max": {"policy_0": -9.70136619770889}, "policy_reward_mean": {"policy_0": -659.4951494631906}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-138.22734895184098, -666.2853800158556, -949.4409721888097, -1173.9356823118333, -685.825762128955, -106.91292660398639, -1261.6116712247183, -28.183239737331363, -790.3720353482506, -993.0550947268506, -1009.9331170164132, -1176.389177057255, -84.9269830772295, -1042.0925131524814, -173.98756229061675, -70.24059889101315, -809.0381942160977, -271.78865386510023, -1003.6029971676106, -779.9124049717993, -263.6298142705077, -776.0467230475056, -573.7754484285279, -1144.3540595533573, -1007.5135284673601, -436.95910836282025, -61.080033492937616, -9.70136619770889, -253.52528544690708, -864.9266867109746, -975.9198932215431, -1057.7765108737783, -727.8180102638775, -224.22197731721167, -856.980508615288, -345.93976858446325, -510.4059345684813, -1078.781908890925, -1263.3868861773863, -24.234363092688355, -1006.9913969077256, -847.1560156139514, -515.9393265398666, -703.0318795606171, -1053.3596611936055, -1098.228516381775, -196.97385058100218, -846.1894338175061, -1070.7294552404378, -435.1257935557265, -1166.5521082187638, -1076.076524615744, -1075.2070539528772, -43.38380950628387, -1049.0835128696003, -994.7350905616611, -433.6195002870087, -464.4552903301011, -554.3859706882173, -61.56952550860879, -822.6087762658442, -679.8321086922361, -925.7114681848103, -643.4548257702565, -122.7108123842144, -387.2106014679722, -1158.8935945549692, -920.2831308274419, -642.1497291266265, -754.8202173275297, -925.079881298184, -846.4393243340751, -544.6528622416938, -259.7165479586747, -366.3460316868703, -33.941943373281205, -1061.755362325382, -1013.062857351893, -41.55723835708966, -43.781168947758616, -29.016098219057834, -1141.6716352258659, -1021.5304708647923, -915.2461840547588, -97.79432393757261, -177.17413724675617, -150.66219998634415, -500.5061209942268, -778.0477236436697, -1245.0892108121543, -1067.2184748037541, -333.59912166555074, -1365.041032451094, -245.54896044653327, -714.2403846380422, -886.905462266695, -1224.6614748511029, -187.16750617666162, -193.11900513070614, -1115.7330899675417], "episode_lengths": [69, 150, 150, 150, 150, 71, 150, 56, 150, 150, 150, 150, 59, 150, 68, 69, 150, 103, 150, 150, 96, 150, 150, 150, 150, 145, 67, 41, 109, 150, 150, 150, 150, 90, 150, 119, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 85, 150, 150, 125, 150, 150, 150, 59, 150, 150, 115, 150, 150, 64, 150, 150, 150, 144, 86, 150, 150, 150, 143, 150, 150, 150, 150, 150, 95, 60, 150, 150, 54, 52, 52, 150, 150, 150, 76, 114, 68, 144, 150, 150, 150, 110, 150, 103, 150, 150, 150, 111, 107, 150], "policy_policy_0_reward": [-138.22734895184098, -666.2853800158556, -949.4409721888097, -1173.9356823118333, -685.825762128955, -106.91292660398639, -1261.6116712247183, -28.183239737331363, -790.3720353482506, -993.0550947268506, -1009.9331170164132, -1176.389177057255, -84.9269830772295, -1042.0925131524814, -173.98756229061675, -70.24059889101315, -809.0381942160977, -271.78865386510023, -1003.6029971676106, -779.9124049717993, -263.6298142705077, -776.0467230475056, -573.7754484285279, -1144.3540595533573, -1007.5135284673601, -436.95910836282025, -61.080033492937616, -9.70136619770889, -253.52528544690708, -864.9266867109746, -975.9198932215431, -1057.7765108737783, -727.8180102638775, -224.22197731721167, -856.980508615288, -345.93976858446325, -510.4059345684813, -1078.781908890925, -1263.3868861773863, -24.234363092688355, -1006.9913969077256, -847.1560156139514, -515.9393265398666, -703.0318795606171, -1053.3596611936055, -1098.228516381775, -196.97385058100218, -846.1894338175061, -1070.7294552404378, -435.1257935557265, -1166.5521082187638, -1076.076524615744, -1075.2070539528772, -43.38380950628387, -1049.0835128696003, -994.7350905616611, -433.6195002870087, -464.4552903301011, -554.3859706882173, -61.56952550860879, -822.6087762658442, -679.8321086922361, -925.7114681848103, -643.4548257702565, -122.7108123842144, -387.2106014679722, -1158.8935945549692, -920.2831308274419, -642.1497291266265, -754.8202173275297, -925.079881298184, -846.4393243340751, -544.6528622416938, -259.7165479586747, -366.3460316868703, -33.941943373281205, -1061.755362325382, -1013.062857351893, -41.55723835708966, -43.781168947758616, -29.016098219057834, -1141.6716352258659, -1021.5304708647923, -915.2461840547588, -97.79432393757261, -177.17413724675617, -150.66219998634415, -500.5061209942268, -778.0477236436697, -1245.0892108121543, -1067.2184748037541, -333.59912166555074, -1365.041032451094, -245.54896044653327, -714.2403846380422, -886.905462266695, -1224.6614748511029, -187.16750617666162, -193.11900513070614, -1115.7330899675417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5581260123413861, "mean_inference_ms": 1.701698687968208, "mean_action_processing_ms": 0.28132707890779307, "mean_env_wait_ms": 3.0035319860023884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012688875198364258, "StateBufferConnector_ms": 0.008173942565917969, "ViewRequirementAgentConnector_ms": 0.20310163497924805}, "num_episodes": 31, "episode_return_max": -9.70136619770889, "episode_return_min": -1365.041032451094, "episode_return_mean": -659.4951494631906, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.1800820139109, "num_env_steps_trained_throughput_per_sec": 299.1800820139109, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12920.309, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12920.218, "sample_time_ms": 1027.918, "learn_time_ms": 11824.601, "learn_throughput": 338.278, "synch_weights_time_ms": 66.812}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00006", "date": "2024-08-03_10-53-23", "timestamp": 1722662603, "time_this_iter_s": 13.383387804031372, "time_total_s": 326.9175446033478, "pid": 515585, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5235b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 326.9175446033478, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.447368421052632, "ram_util_percent": 27.610526315789475}}
