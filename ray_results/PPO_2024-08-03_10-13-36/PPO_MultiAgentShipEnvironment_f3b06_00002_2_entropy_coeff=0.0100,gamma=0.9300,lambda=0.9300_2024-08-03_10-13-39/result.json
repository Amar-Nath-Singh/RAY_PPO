{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8848575974193712, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.74634668926398, "policy_loss": -0.003538269503042102, "vf_loss": 9.76212594906489, "vf_explained_var": 0.012362067711850007, "kl": 0.009985181035775288, "entropy": 1.4238062965373197, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -307.1450758641984, "episode_reward_min": -1184.0726780695438, "episode_reward_mean": -794.1087560922647, "episode_len_mean": 142.56521739130434, "episode_media": {}, "episodes_timesteps_total": 3279, "policy_reward_min": {"policy_0": -1184.0726780695438}, "policy_reward_max": {"policy_0": -307.1450758641984}, "policy_reward_mean": {"policy_0": -794.1087560922647}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.0899346817268, -922.4952061710512, -852.3189648843346, -899.2624316676954, -669.722085048764, -1184.0726780695438, -971.7119450435022, -941.7096728695543, -992.1764664105783, -976.020808403589, -461.9186110380342, -423.224979213747, -813.8443360814878, -1050.9124070556886, -1003.8941139897316, -783.2776706240952, -603.7809943767693, -349.31268744300695, -800.0044050695599, -647.2220154554914, -974.6710673843879, -843.712833275548, -307.1450758641984], "episode_lengths": [150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 109, 100, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 93], "policy_policy_0_reward": [-792.0899346817268, -922.4952061710512, -852.3189648843346, -899.2624316676954, -669.722085048764, -1184.0726780695438, -971.7119450435022, -941.7096728695543, -992.1764664105783, -976.020808403589, -461.9186110380342, -423.224979213747, -813.8443360814878, -1050.9124070556886, -1003.8941139897316, -783.2776706240952, -603.7809943767693, -349.31268744300695, -800.0044050695599, -647.2220154554914, -974.6710673843879, -843.712833275548, -307.1450758641984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5637814086790963, "mean_inference_ms": 1.6547914728189317, "mean_action_processing_ms": 0.2787902260384962, "mean_env_wait_ms": 2.96544954098802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01133939494257388, "StateBufferConnector_ms": 0.007916533428689709, "ViewRequirementAgentConnector_ms": 0.17284414042597232}, "num_episodes": 23, "episode_return_max": -307.1450758641984, "episode_return_min": -1184.0726780695438, "episode_return_mean": -794.1087560922647, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.5411892781376, "num_env_steps_trained_throughput_per_sec": 303.5411892781376, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13177.792, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13177.729, "sample_time_ms": 1014.901, "learn_time_ms": 12102.077, "learn_throughput": 330.522, "synch_weights_time_ms": 59.916}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00002", "date": "2024-08-03_10-25-25", "timestamp": 1722660925, "time_this_iter_s": 13.189922332763672, "time_total_s": 13.189922332763672, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf57520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.189922332763672, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.700000000000001, "ram_util_percent": 27.442105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1518571101129056, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.706518335143725, "policy_loss": -0.009483713199248693, "vf_loss": 8.72841800202926, "vf_explained_var": 0.15291700170685849, "kl": 0.01103841994966691, "entropy": 1.462366566558679, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -38.79117424539565, "episode_reward_min": -1240.5747632509954, "episode_reward_mean": -755.6360055856566, "episode_len_mean": 143.58695652173913, "episode_media": {}, "episodes_timesteps_total": 6605, "policy_reward_min": {"policy_0": -1240.5747632509954}, "policy_reward_max": {"policy_0": -38.79117424539565}, "policy_reward_mean": {"policy_0": -755.6360055856566}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.0899346817268, -922.4952061710512, -852.3189648843346, -899.2624316676954, -669.722085048764, -1184.0726780695438, -971.7119450435022, -941.7096728695543, -992.1764664105783, -976.020808403589, -461.9186110380342, -423.224979213747, -813.8443360814878, -1050.9124070556886, -1003.8941139897316, -783.2776706240952, -603.7809943767693, -349.31268744300695, -800.0044050695599, -647.2220154554914, -974.6710673843879, -843.712833275548, -307.1450758641984, -961.5776569911977, -1001.4624338237519, -404.44692577945324, -1240.5747632509954, -541.742841182378, -824.7906922620894, -38.79117424539565, -203.98735372079284, -792.9838002398122, -356.131548540968, -842.8904297673132, -372.0587814983289, -890.3096347414952, -832.533804721326, -360.3401022348607, -576.3812582856837, -774.9476565455411, -1043.0808766037496, -840.5362611407039, -920.4253813357894, -739.0394801908408, -916.321252891092, -1019.4007568245476], "episode_lengths": [150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 109, 100, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 93, 150, 150, 150, 150, 124, 150, 62, 145, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-792.0899346817268, -922.4952061710512, -852.3189648843346, -899.2624316676954, -669.722085048764, -1184.0726780695438, -971.7119450435022, -941.7096728695543, -992.1764664105783, -976.020808403589, -461.9186110380342, -423.224979213747, -813.8443360814878, -1050.9124070556886, -1003.8941139897316, -783.2776706240952, -603.7809943767693, -349.31268744300695, -800.0044050695599, -647.2220154554914, -974.6710673843879, -843.712833275548, -307.1450758641984, -961.5776569911977, -1001.4624338237519, -404.44692577945324, -1240.5747632509954, -541.742841182378, -824.7906922620894, -38.79117424539565, -203.98735372079284, -792.9838002398122, -356.131548540968, -842.8904297673132, -372.0587814983289, -890.3096347414952, -832.533804721326, -360.3401022348607, -576.3812582856837, -774.9476565455411, -1043.0808766037496, -840.5362611407039, -920.4253813357894, -739.0394801908408, -916.321252891092, -1019.4007568245476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5667876711371337, "mean_inference_ms": 1.6729233760822366, "mean_action_processing_ms": 0.2810583096864615, "mean_env_wait_ms": 2.982516070447563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013816356658935547, "StateBufferConnector_ms": 0.008152878802755604, "ViewRequirementAgentConnector_ms": 0.1782977062722911}, "num_episodes": 23, "episode_return_max": -38.79117424539565, "episode_return_min": -1240.5747632509954, "episode_return_mean": -755.6360055856566, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.5518562778205, "num_env_steps_trained_throughput_per_sec": 294.5518562778205, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13378.879, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13378.811, "sample_time_ms": 1046.575, "learn_time_ms": 12257.29, "learn_throughput": 326.336, "synch_weights_time_ms": 74.07}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00002", "date": "2024-08-03_10-25-38", "timestamp": 1722660938, "time_this_iter_s": 13.592423915863037, "time_total_s": 26.78234624862671, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0ec20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.78234624862671, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.025, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.011608970786135, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.511453631023566, "policy_loss": -0.012409323220102427, "vf_loss": 7.536176012456417, "vf_explained_var": 0.40928931447366873, "kl": 0.015191109398646556, "entropy": 1.5351269422719875, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -38.79117424539565, "episode_reward_min": -1240.5747632509954, "episode_reward_mean": -685.2849804241803, "episode_len_mean": 133.71794871794873, "episode_media": {}, "episodes_timesteps_total": 10430, "policy_reward_min": {"policy_0": -1240.5747632509954}, "policy_reward_max": {"policy_0": -38.79117424539565}, "policy_reward_mean": {"policy_0": -685.2849804241803}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.0899346817268, -922.4952061710512, -852.3189648843346, -899.2624316676954, -669.722085048764, -1184.0726780695438, -971.7119450435022, -941.7096728695543, -992.1764664105783, -976.020808403589, -461.9186110380342, -423.224979213747, -813.8443360814878, -1050.9124070556886, -1003.8941139897316, -783.2776706240952, -603.7809943767693, -349.31268744300695, -800.0044050695599, -647.2220154554914, -974.6710673843879, -843.712833275548, -307.1450758641984, -961.5776569911977, -1001.4624338237519, -404.44692577945324, -1240.5747632509954, -541.742841182378, -824.7906922620894, -38.79117424539565, -203.98735372079284, -792.9838002398122, -356.131548540968, -842.8904297673132, -372.0587814983289, -890.3096347414952, -832.533804721326, -360.3401022348607, -576.3812582856837, -774.9476565455411, -1043.0808766037496, -840.5362611407039, -920.4253813357894, -739.0394801908408, -916.321252891092, -1019.4007568245476, -1113.1692040749533, -446.31096655701185, -503.5966402645062, -450.01752154034574, -186.69237987062536, -784.2646528004716, -973.4565927263923, -974.7639956438695, -1079.7282109069104, -157.836779447313, -1011.8917792921043, -336.15340561358255, -420.69232186627335, -760.9413079194275, -882.1278430651515, -350.33243519190637, -1038.9362182180007, -275.90893000940963, -198.6776714118466, -79.88585283187966, -818.950074124332, -177.27740670931897, -995.6222021547214, -254.36097742323759, -1018.8459886314018, -130.90468964448974, -923.9428196419641, -49.556742875633965, -959.2230885398587, -245.73141555440802, -180.78889987706197, -912.3832017174587], "episode_lengths": [150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 109, 100, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 93, 150, 150, 150, 150, 124, 150, 62, 145, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 116, 120, 80, 150, 150, 150, 150, 77, 150, 92, 124, 150, 150, 90, 150, 91, 116, 69, 150, 90, 150, 84, 150, 55, 150, 63, 150, 95, 108, 150], "policy_policy_0_reward": [-792.0899346817268, -922.4952061710512, -852.3189648843346, -899.2624316676954, -669.722085048764, -1184.0726780695438, -971.7119450435022, -941.7096728695543, -992.1764664105783, -976.020808403589, -461.9186110380342, -423.224979213747, -813.8443360814878, -1050.9124070556886, -1003.8941139897316, -783.2776706240952, -603.7809943767693, -349.31268744300695, -800.0044050695599, -647.2220154554914, -974.6710673843879, -843.712833275548, -307.1450758641984, -961.5776569911977, -1001.4624338237519, -404.44692577945324, -1240.5747632509954, -541.742841182378, -824.7906922620894, -38.79117424539565, -203.98735372079284, -792.9838002398122, -356.131548540968, -842.8904297673132, -372.0587814983289, -890.3096347414952, -832.533804721326, -360.3401022348607, -576.3812582856837, -774.9476565455411, -1043.0808766037496, -840.5362611407039, -920.4253813357894, -739.0394801908408, -916.321252891092, -1019.4007568245476, -1113.1692040749533, -446.31096655701185, -503.5966402645062, -450.01752154034574, -186.69237987062536, -784.2646528004716, -973.4565927263923, -974.7639956438695, -1079.7282109069104, -157.836779447313, -1011.8917792921043, -336.15340561358255, -420.69232186627335, -760.9413079194275, -882.1278430651515, -350.33243519190637, -1038.9362182180007, -275.90893000940963, -198.6776714118466, -79.88585283187966, -818.950074124332, -177.27740670931897, -995.6222021547214, -254.36097742323759, -1018.8459886314018, -130.90468964448974, -923.9428196419641, -49.556742875633965, -959.2230885398587, -245.73141555440802, -180.78889987706197, -912.3832017174587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.567457492317382, "mean_inference_ms": 1.6847172121730176, "mean_action_processing_ms": 0.2823728416297769, "mean_env_wait_ms": 2.987850047087848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013676973489614634, "StateBufferConnector_ms": 0.008504207317645732, "ViewRequirementAgentConnector_ms": 0.18631311563345102}, "num_episodes": 32, "episode_return_max": -38.79117424539565, "episode_return_min": -1240.5747632509954, "episode_return_mean": -685.2849804241803, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.24048617951973, "num_env_steps_trained_throughput_per_sec": 295.24048617951973, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13435.35, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13435.278, "sample_time_ms": 1044.861, "learn_time_ms": 12317.284, "learn_throughput": 324.747, "synch_weights_time_ms": 72.253}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00002", "date": "2024-08-03_10-25-52", "timestamp": 1722660952, "time_this_iter_s": 13.562382936477661, "time_total_s": 40.34472918510437, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0d090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 40.34472918510437, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.126315789473685, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.079261332253616, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.349420274297397, "policy_loss": -0.013327850496474032, "vf_loss": 5.375258586059014, "vf_explained_var": 0.7639489089449246, "kl": 0.015783207902859434, "entropy": 1.5667107106496891, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -38.79117424539565, "episode_reward_min": -1240.5747632509954, "episode_reward_mean": -684.5748741680045, "episode_len_mean": 135.06, "episode_media": {}, "episodes_timesteps_total": 13506, "policy_reward_min": {"policy_0": -1240.5747632509954}, "policy_reward_max": {"policy_0": -38.79117424539565}, "policy_reward_mean": {"policy_0": -684.5748741680045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-971.7119450435022, -941.7096728695543, -992.1764664105783, -976.020808403589, -461.9186110380342, -423.224979213747, -813.8443360814878, -1050.9124070556886, -1003.8941139897316, -783.2776706240952, -603.7809943767693, -349.31268744300695, -800.0044050695599, -647.2220154554914, -974.6710673843879, -843.712833275548, -307.1450758641984, -961.5776569911977, -1001.4624338237519, -404.44692577945324, -1240.5747632509954, -541.742841182378, -824.7906922620894, -38.79117424539565, -203.98735372079284, -792.9838002398122, -356.131548540968, -842.8904297673132, -372.0587814983289, -890.3096347414952, -832.533804721326, -360.3401022348607, -576.3812582856837, -774.9476565455411, -1043.0808766037496, -840.5362611407039, -920.4253813357894, -739.0394801908408, -916.321252891092, -1019.4007568245476, -1113.1692040749533, -446.31096655701185, -503.5966402645062, -450.01752154034574, -186.69237987062536, -784.2646528004716, -973.4565927263923, -974.7639956438695, -1079.7282109069104, -157.836779447313, -1011.8917792921043, -336.15340561358255, -420.69232186627335, -760.9413079194275, -882.1278430651515, -350.33243519190637, -1038.9362182180007, -275.90893000940963, -198.6776714118466, -79.88585283187966, -818.950074124332, -177.27740670931897, -995.6222021547214, -254.36097742323759, -1018.8459886314018, -130.90468964448974, -923.9428196419641, -49.556742875633965, -959.2230885398587, -245.73141555440802, -180.78889987706197, -912.3832017174587, -929.0334751718352, -722.0122033217039, -751.295951021593, -1143.6907082990792, -784.7851969469675, -696.3236280512101, -1007.5514029873256, -749.3515082544611, -994.0146237015776, -434.7629459543401, -944.6471462445311, -391.54096687153185, -383.803694532401, -106.92699707362114, -330.7765174953474, -883.3304769347178, -603.121701916987, -639.5547267114066, -879.9891007927363, -856.9068597542122, -982.8517045638681, -908.1637983406364, -1107.8017267986909, -1113.6845166354315, -566.6504153427594, -835.3876245211767, -460.03667419659917, -117.22395180077007], "episode_lengths": [150, 150, 150, 150, 109, 100, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 93, 150, 150, 150, 150, 124, 150, 62, 145, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 116, 120, 80, 150, 150, 150, 150, 77, 150, 92, 124, 150, 150, 90, 150, 91, 116, 69, 150, 90, 150, 84, 150, 55, 150, 63, 150, 95, 108, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 115, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 62], "policy_policy_0_reward": [-971.7119450435022, -941.7096728695543, -992.1764664105783, -976.020808403589, -461.9186110380342, -423.224979213747, -813.8443360814878, -1050.9124070556886, -1003.8941139897316, -783.2776706240952, -603.7809943767693, -349.31268744300695, -800.0044050695599, -647.2220154554914, -974.6710673843879, -843.712833275548, -307.1450758641984, -961.5776569911977, -1001.4624338237519, -404.44692577945324, -1240.5747632509954, -541.742841182378, -824.7906922620894, -38.79117424539565, -203.98735372079284, -792.9838002398122, -356.131548540968, -842.8904297673132, -372.0587814983289, -890.3096347414952, -832.533804721326, -360.3401022348607, -576.3812582856837, -774.9476565455411, -1043.0808766037496, -840.5362611407039, -920.4253813357894, -739.0394801908408, -916.321252891092, -1019.4007568245476, -1113.1692040749533, -446.31096655701185, -503.5966402645062, -450.01752154034574, -186.69237987062536, -784.2646528004716, -973.4565927263923, -974.7639956438695, -1079.7282109069104, -157.836779447313, -1011.8917792921043, -336.15340561358255, -420.69232186627335, -760.9413079194275, -882.1278430651515, -350.33243519190637, -1038.9362182180007, -275.90893000940963, -198.6776714118466, -79.88585283187966, -818.950074124332, -177.27740670931897, -995.6222021547214, -254.36097742323759, -1018.8459886314018, -130.90468964448974, -923.9428196419641, -49.556742875633965, -959.2230885398587, -245.73141555440802, -180.78889987706197, -912.3832017174587, -929.0334751718352, -722.0122033217039, -751.295951021593, -1143.6907082990792, -784.7851969469675, -696.3236280512101, -1007.5514029873256, -749.3515082544611, -994.0146237015776, -434.7629459543401, -944.6471462445311, -391.54096687153185, -383.803694532401, -106.92699707362114, -330.7765174953474, -883.3304769347178, -603.121701916987, -639.5547267114066, -879.9891007927363, -856.9068597542122, -982.8517045638681, -908.1637983406364, -1107.8017267986909, -1113.6845166354315, -566.6504153427594, -835.3876245211767, -460.03667419659917, -117.22395180077007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5693067541347056, "mean_inference_ms": 1.6923831144567805, "mean_action_processing_ms": 0.283380600981198, "mean_env_wait_ms": 2.9902058196871057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013985872268676758, "StateBufferConnector_ms": 0.008611440658569336, "ViewRequirementAgentConnector_ms": 0.18977618217468262}, "num_episodes": 28, "episode_return_max": -38.79117424539565, "episode_return_min": -1240.5747632509954, "episode_return_mean": -684.5748741680045, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.19286020929036, "num_env_steps_trained_throughput_per_sec": 299.19286020929036, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13418.842, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13418.769, "sample_time_ms": 1045.411, "learn_time_ms": 12301.306, "learn_throughput": 325.169, "synch_weights_time_ms": 71.199}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00002", "date": "2024-08-03_10-26-05", "timestamp": 1722660965, "time_this_iter_s": 13.382207155227661, "time_total_s": 53.72693634033203, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf57910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 53.72693634033203, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.484210526315788, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.73985708554586, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.484944412857294, "policy_loss": -0.01198800305428449, "vf_loss": 5.50869249800841, "vf_explained_var": 0.7876650076980393, "kl": 0.018105397699158254, "entropy": 1.5381162176529566, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -49.556742875633965, "episode_reward_min": -1312.164361905455, "episode_reward_mean": -671.5142284969338, "episode_len_mean": 133.25, "episode_media": {}, "episodes_timesteps_total": 13325, "policy_reward_min": {"policy_0": -1312.164361905455}, "policy_reward_max": {"policy_0": -49.556742875633965}, "policy_reward_mean": {"policy_0": -671.5142284969338}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-360.3401022348607, -576.3812582856837, -774.9476565455411, -1043.0808766037496, -840.5362611407039, -920.4253813357894, -739.0394801908408, -916.321252891092, -1019.4007568245476, -1113.1692040749533, -446.31096655701185, -503.5966402645062, -450.01752154034574, -186.69237987062536, -784.2646528004716, -973.4565927263923, -974.7639956438695, -1079.7282109069104, -157.836779447313, -1011.8917792921043, -336.15340561358255, -420.69232186627335, -760.9413079194275, -882.1278430651515, -350.33243519190637, -1038.9362182180007, -275.90893000940963, -198.6776714118466, -79.88585283187966, -818.950074124332, -177.27740670931897, -995.6222021547214, -254.36097742323759, -1018.8459886314018, -130.90468964448974, -923.9428196419641, -49.556742875633965, -959.2230885398587, -245.73141555440802, -180.78889987706197, -912.3832017174587, -929.0334751718352, -722.0122033217039, -751.295951021593, -1143.6907082990792, -784.7851969469675, -696.3236280512101, -1007.5514029873256, -749.3515082544611, -994.0146237015776, -434.7629459543401, -944.6471462445311, -391.54096687153185, -383.803694532401, -106.92699707362114, -330.7765174953474, -883.3304769347178, -603.121701916987, -639.5547267114066, -879.9891007927363, -856.9068597542122, -982.8517045638681, -908.1637983406364, -1107.8017267986909, -1113.6845166354315, -566.6504153427594, -835.3876245211767, -460.03667419659917, -117.22395180077007, -394.9336579909399, -1276.9358636036272, -576.8191637622616, -652.0604306979113, -746.0854991367279, -346.95165121035296, -170.6167748172624, -872.8744783997403, -342.7689025669321, -767.6559971132638, -1114.9210939898153, -1312.164361905455, -808.2061177237804, -475.3039587172628, -1031.476741001064, -980.0350841329887, -870.3921439867045, -217.1995922441331, -704.4958845549972, -722.1333559631389, -551.1298724606078, -1026.1982938960537, -50.51025930923855, -364.2576640178523, -900.867566482603, -472.8660460673535, -603.4895490338912, -137.7851320545722, -1060.3216390115501, -1151.238546868003, -240.06204053709945], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 116, 120, 80, 150, 150, 150, 150, 77, 150, 92, 124, 150, 150, 90, 150, 91, 116, 69, 150, 90, 150, 84, 150, 55, 150, 63, 150, 95, 108, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 115, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 62, 108, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 61, 150, 150, 115, 132, 60, 150, 150, 104], "policy_policy_0_reward": [-360.3401022348607, -576.3812582856837, -774.9476565455411, -1043.0808766037496, -840.5362611407039, -920.4253813357894, -739.0394801908408, -916.321252891092, -1019.4007568245476, -1113.1692040749533, -446.31096655701185, -503.5966402645062, -450.01752154034574, -186.69237987062536, -784.2646528004716, -973.4565927263923, -974.7639956438695, -1079.7282109069104, -157.836779447313, -1011.8917792921043, -336.15340561358255, -420.69232186627335, -760.9413079194275, -882.1278430651515, -350.33243519190637, -1038.9362182180007, -275.90893000940963, -198.6776714118466, -79.88585283187966, -818.950074124332, -177.27740670931897, -995.6222021547214, -254.36097742323759, -1018.8459886314018, -130.90468964448974, -923.9428196419641, -49.556742875633965, -959.2230885398587, -245.73141555440802, -180.78889987706197, -912.3832017174587, -929.0334751718352, -722.0122033217039, -751.295951021593, -1143.6907082990792, -784.7851969469675, -696.3236280512101, -1007.5514029873256, -749.3515082544611, -994.0146237015776, -434.7629459543401, -944.6471462445311, -391.54096687153185, -383.803694532401, -106.92699707362114, -330.7765174953474, -883.3304769347178, -603.121701916987, -639.5547267114066, -879.9891007927363, -856.9068597542122, -982.8517045638681, -908.1637983406364, -1107.8017267986909, -1113.6845166354315, -566.6504153427594, -835.3876245211767, -460.03667419659917, -117.22395180077007, -394.9336579909399, -1276.9358636036272, -576.8191637622616, -652.0604306979113, -746.0854991367279, -346.95165121035296, -170.6167748172624, -872.8744783997403, -342.7689025669321, -767.6559971132638, -1114.9210939898153, -1312.164361905455, -808.2061177237804, -475.3039587172628, -1031.476741001064, -980.0350841329887, -870.3921439867045, -217.1995922441331, -704.4958845549972, -722.1333559631389, -551.1298724606078, -1026.1982938960537, -50.51025930923855, -364.2576640178523, -900.867566482603, -472.8660460673535, -603.4895490338912, -137.7851320545722, -1060.3216390115501, -1151.238546868003, -240.06204053709945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5691756285306516, "mean_inference_ms": 1.7034288519693792, "mean_action_processing_ms": 0.284944725183034, "mean_env_wait_ms": 2.99837705628125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013702154159545898, "StateBufferConnector_ms": 0.00874185562133789, "ViewRequirementAgentConnector_ms": 0.19389057159423828}, "num_episodes": 31, "episode_return_max": -49.556742875633965, "episode_return_min": -1312.164361905455, "episode_return_mean": -671.5142284969338, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.05046295543747, "num_env_steps_trained_throughput_per_sec": 305.05046295543747, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13357.592, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13357.522, "sample_time_ms": 1041.339, "learn_time_ms": 12246.212, "learn_throughput": 326.632, "synch_weights_time_ms": 69.101}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00002", "date": "2024-08-03_10-26-19", "timestamp": 1722660979, "time_this_iter_s": 13.126360893249512, "time_total_s": 66.85329723358154, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00be290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 66.85329723358154, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.11578947368421, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 55.31840219895045, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.076792356868585, "policy_loss": -0.010662904859539897, "vf_loss": 5.099331344664097, "vf_explained_var": 0.8813878709450365, "kl": 0.015581851828998575, "entropy": 1.4992458023130895, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -49.556742875633965, "episode_reward_min": -1343.6182268304062, "episode_reward_mean": -685.0304803569753, "episode_len_mean": 135.41, "episode_media": {}, "episodes_timesteps_total": 13541, "policy_reward_min": {"policy_0": -1343.6182268304062}, "policy_reward_max": {"policy_0": -49.556742875633965}, "policy_reward_mean": {"policy_0": -685.0304803569753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-198.6776714118466, -79.88585283187966, -818.950074124332, -177.27740670931897, -995.6222021547214, -254.36097742323759, -1018.8459886314018, -130.90468964448974, -923.9428196419641, -49.556742875633965, -959.2230885398587, -245.73141555440802, -180.78889987706197, -912.3832017174587, -929.0334751718352, -722.0122033217039, -751.295951021593, -1143.6907082990792, -784.7851969469675, -696.3236280512101, -1007.5514029873256, -749.3515082544611, -994.0146237015776, -434.7629459543401, -944.6471462445311, -391.54096687153185, -383.803694532401, -106.92699707362114, -330.7765174953474, -883.3304769347178, -603.121701916987, -639.5547267114066, -879.9891007927363, -856.9068597542122, -982.8517045638681, -908.1637983406364, -1107.8017267986909, -1113.6845166354315, -566.6504153427594, -835.3876245211767, -460.03667419659917, -117.22395180077007, -394.9336579909399, -1276.9358636036272, -576.8191637622616, -652.0604306979113, -746.0854991367279, -346.95165121035296, -170.6167748172624, -872.8744783997403, -342.7689025669321, -767.6559971132638, -1114.9210939898153, -1312.164361905455, -808.2061177237804, -475.3039587172628, -1031.476741001064, -980.0350841329887, -870.3921439867045, -217.1995922441331, -704.4958845549972, -722.1333559631389, -551.1298724606078, -1026.1982938960537, -50.51025930923855, -364.2576640178523, -900.867566482603, -472.8660460673535, -603.4895490338912, -137.7851320545722, -1060.3216390115501, -1151.238546868003, -240.06204053709945, -997.7139497060278, -341.70584278030066, -1020.4324244347081, -551.4281636694689, -1016.1675357373628, -684.666772751722, -917.8897597010813, -303.1705352503568, -952.7470750079478, -158.6253949548041, -624.2088666625037, -1187.6232402470366, -972.4497160057315, -1162.4246603515253, -724.0717098864817, -876.9206965982945, -221.9498005530768, -916.7660584608947, -363.19952782525354, -287.6350375055951, -729.5293788679307, -1110.7898373269727, -1343.6182268304062, -447.0949072940175, -591.4635199551582, -787.3242435191013, -997.3025151814631], "episode_lengths": [116, 69, 150, 90, 150, 84, 150, 55, 150, 63, 150, 95, 108, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 115, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 62, 108, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 61, 150, 150, 115, 132, 60, 150, 150, 104, 150, 108, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 116, 150, 98, 90, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-198.6776714118466, -79.88585283187966, -818.950074124332, -177.27740670931897, -995.6222021547214, -254.36097742323759, -1018.8459886314018, -130.90468964448974, -923.9428196419641, -49.556742875633965, -959.2230885398587, -245.73141555440802, -180.78889987706197, -912.3832017174587, -929.0334751718352, -722.0122033217039, -751.295951021593, -1143.6907082990792, -784.7851969469675, -696.3236280512101, -1007.5514029873256, -749.3515082544611, -994.0146237015776, -434.7629459543401, -944.6471462445311, -391.54096687153185, -383.803694532401, -106.92699707362114, -330.7765174953474, -883.3304769347178, -603.121701916987, -639.5547267114066, -879.9891007927363, -856.9068597542122, -982.8517045638681, -908.1637983406364, -1107.8017267986909, -1113.6845166354315, -566.6504153427594, -835.3876245211767, -460.03667419659917, -117.22395180077007, -394.9336579909399, -1276.9358636036272, -576.8191637622616, -652.0604306979113, -746.0854991367279, -346.95165121035296, -170.6167748172624, -872.8744783997403, -342.7689025669321, -767.6559971132638, -1114.9210939898153, -1312.164361905455, -808.2061177237804, -475.3039587172628, -1031.476741001064, -980.0350841329887, -870.3921439867045, -217.1995922441331, -704.4958845549972, -722.1333559631389, -551.1298724606078, -1026.1982938960537, -50.51025930923855, -364.2576640178523, -900.867566482603, -472.8660460673535, -603.4895490338912, -137.7851320545722, -1060.3216390115501, -1151.238546868003, -240.06204053709945, -997.7139497060278, -341.70584278030066, -1020.4324244347081, -551.4281636694689, -1016.1675357373628, -684.666772751722, -917.8897597010813, -303.1705352503568, -952.7470750079478, -158.6253949548041, -624.2088666625037, -1187.6232402470366, -972.4497160057315, -1162.4246603515253, -724.0717098864817, -876.9206965982945, -221.9498005530768, -916.7660584608947, -363.19952782525354, -287.6350375055951, -729.5293788679307, -1110.7898373269727, -1343.6182268304062, -447.0949072940175, -591.4635199551582, -787.3242435191013, -997.3025151814631]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.568543817712887, "mean_inference_ms": 1.704788381326233, "mean_action_processing_ms": 0.28539722572095494, "mean_env_wait_ms": 2.9987184749984808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013434648513793945, "StateBufferConnector_ms": 0.008644580841064453, "ViewRequirementAgentConnector_ms": 0.19240450859069824}, "num_episodes": 27, "episode_return_max": -49.556742875633965, "episode_return_min": -1343.6182268304062, "episode_return_mean": -685.0304803569753, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 405.7948607977316, "num_env_steps_trained_throughput_per_sec": 405.7948607977316, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12774.196, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12774.121, "sample_time_ms": 1037.311, "learn_time_ms": 11670.836, "learn_throughput": 342.735, "synch_weights_time_ms": 65.13}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00002", "date": "2024-08-03_10-26-28", "timestamp": 1722660988, "time_this_iter_s": 9.86928129196167, "time_total_s": 76.72257852554321, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00be170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76.72257852554321, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 15.564285714285713, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 91.55897265076638, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.558275988449653, "policy_loss": -0.012151070025477868, "vf_loss": 3.5808198479314646, "vf_explained_var": 0.955180164364477, "kl": 0.01921710301209411, "entropy": 1.4236214698602756, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -50.51025930923855, "episode_reward_min": -1343.6182268304062, "episode_reward_mean": -686.3442237888141, "episode_len_mean": 135.7, "episode_media": {}, "episodes_timesteps_total": 13570, "policy_reward_min": {"policy_0": -1343.6182268304062}, "policy_reward_max": {"policy_0": -50.51025930923855}, "policy_reward_mean": {"policy_0": -686.3442237888141}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-639.5547267114066, -879.9891007927363, -856.9068597542122, -982.8517045638681, -908.1637983406364, -1107.8017267986909, -1113.6845166354315, -566.6504153427594, -835.3876245211767, -460.03667419659917, -117.22395180077007, -394.9336579909399, -1276.9358636036272, -576.8191637622616, -652.0604306979113, -746.0854991367279, -346.95165121035296, -170.6167748172624, -872.8744783997403, -342.7689025669321, -767.6559971132638, -1114.9210939898153, -1312.164361905455, -808.2061177237804, -475.3039587172628, -1031.476741001064, -980.0350841329887, -870.3921439867045, -217.1995922441331, -704.4958845549972, -722.1333559631389, -551.1298724606078, -1026.1982938960537, -50.51025930923855, -364.2576640178523, -900.867566482603, -472.8660460673535, -603.4895490338912, -137.7851320545722, -1060.3216390115501, -1151.238546868003, -240.06204053709945, -997.7139497060278, -341.70584278030066, -1020.4324244347081, -551.4281636694689, -1016.1675357373628, -684.666772751722, -917.8897597010813, -303.1705352503568, -952.7470750079478, -158.6253949548041, -624.2088666625037, -1187.6232402470366, -972.4497160057315, -1162.4246603515253, -724.0717098864817, -876.9206965982945, -221.9498005530768, -916.7660584608947, -363.19952782525354, -287.6350375055951, -729.5293788679307, -1110.7898373269727, -1343.6182268304062, -447.0949072940175, -591.4635199551582, -787.3242435191013, -997.3025151814631, -492.83794952757, -92.63904370989317, -948.2047053643502, -294.705197588459, -889.8409330737459, -1307.3950562285327, -864.212443660503, -272.12451259818755, -1052.8238412806684, -437.292249867701, -95.13170285663746, -78.2794776053826, -135.207083282929, -727.3254279736328, -524.2282730784001, -242.2469738208663, -329.85645953843147, -317.80905432446434, -991.8882000266774, -881.4576921841202, -806.5037162099303, -817.5087047319826, -1020.8110156816248, -1078.835157757562, -361.30306098301213, -59.07426517335951, -707.6961330413725, -1071.040849955678, -872.0877892601113, -448.7642803944028, -715.3632683205153], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 62, 108, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 61, 150, 150, 115, 132, 60, 150, 150, 104, 150, 108, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 116, 150, 98, 90, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 118, 150, 135, 56, 53, 54, 150, 150, 80, 150, 140, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-639.5547267114066, -879.9891007927363, -856.9068597542122, -982.8517045638681, -908.1637983406364, -1107.8017267986909, -1113.6845166354315, -566.6504153427594, -835.3876245211767, -460.03667419659917, -117.22395180077007, -394.9336579909399, -1276.9358636036272, -576.8191637622616, -652.0604306979113, -746.0854991367279, -346.95165121035296, -170.6167748172624, -872.8744783997403, -342.7689025669321, -767.6559971132638, -1114.9210939898153, -1312.164361905455, -808.2061177237804, -475.3039587172628, -1031.476741001064, -980.0350841329887, -870.3921439867045, -217.1995922441331, -704.4958845549972, -722.1333559631389, -551.1298724606078, -1026.1982938960537, -50.51025930923855, -364.2576640178523, -900.867566482603, -472.8660460673535, -603.4895490338912, -137.7851320545722, -1060.3216390115501, -1151.238546868003, -240.06204053709945, -997.7139497060278, -341.70584278030066, -1020.4324244347081, -551.4281636694689, -1016.1675357373628, -684.666772751722, -917.8897597010813, -303.1705352503568, -952.7470750079478, -158.6253949548041, -624.2088666625037, -1187.6232402470366, -972.4497160057315, -1162.4246603515253, -724.0717098864817, -876.9206965982945, -221.9498005530768, -916.7660584608947, -363.19952782525354, -287.6350375055951, -729.5293788679307, -1110.7898373269727, -1343.6182268304062, -447.0949072940175, -591.4635199551582, -787.3242435191013, -997.3025151814631, -492.83794952757, -92.63904370989317, -948.2047053643502, -294.705197588459, -889.8409330737459, -1307.3950562285327, -864.212443660503, -272.12451259818755, -1052.8238412806684, -437.292249867701, -95.13170285663746, -78.2794776053826, -135.207083282929, -727.3254279736328, -524.2282730784001, -242.2469738208663, -329.85645953843147, -317.80905432446434, -991.8882000266774, -881.4576921841202, -806.5037162099303, -817.5087047319826, -1020.8110156816248, -1078.835157757562, -361.30306098301213, -59.07426517335951, -707.6961330413725, -1071.040849955678, -872.0877892601113, -448.7642803944028, -715.3632683205153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5666805680241175, "mean_inference_ms": 1.7046397463487026, "mean_action_processing_ms": 0.28531790768885984, "mean_env_wait_ms": 3.0040826310771798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013093709945678711, "StateBufferConnector_ms": 0.008427619934082031, "ViewRequirementAgentConnector_ms": 0.19252276420593262}, "num_episodes": 31, "episode_return_max": -50.51025930923855, "episode_return_min": -1343.6182268304062, "episode_return_mean": -686.3442237888141, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.298129237561, "num_env_steps_trained_throughput_per_sec": 306.298129237561, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12814.908, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12814.835, "sample_time_ms": 1033.505, "learn_time_ms": 11715.07, "learn_throughput": 341.441, "synch_weights_time_ms": 65.421}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00002", "date": "2024-08-03_10-26-42", "timestamp": 1722661002, "time_this_iter_s": 13.072447299957275, "time_total_s": 89.79502582550049, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf54ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.79502582550049, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.344444444444443, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 116.29683535099029, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.5282529799888533, "policy_loss": -0.010850076060160063, "vf_loss": 3.550403441985448, "vf_explained_var": 0.967166359598438, "kl": 0.016710763829420716, "entropy": 1.46425392391781, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -22.61599935978622, "episode_reward_min": -1343.6182268304062, "episode_reward_mean": -690.2991000739303, "episode_len_mean": 136.35, "episode_media": {}, "episodes_timesteps_total": 13635, "policy_reward_min": {"policy_0": -1343.6182268304062}, "policy_reward_max": {"policy_0": -22.61599935978622}, "policy_reward_mean": {"policy_0": -690.2991000739303}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-870.3921439867045, -217.1995922441331, -704.4958845549972, -722.1333559631389, -551.1298724606078, -1026.1982938960537, -50.51025930923855, -364.2576640178523, -900.867566482603, -472.8660460673535, -603.4895490338912, -137.7851320545722, -1060.3216390115501, -1151.238546868003, -240.06204053709945, -997.7139497060278, -341.70584278030066, -1020.4324244347081, -551.4281636694689, -1016.1675357373628, -684.666772751722, -917.8897597010813, -303.1705352503568, -952.7470750079478, -158.6253949548041, -624.2088666625037, -1187.6232402470366, -972.4497160057315, -1162.4246603515253, -724.0717098864817, -876.9206965982945, -221.9498005530768, -916.7660584608947, -363.19952782525354, -287.6350375055951, -729.5293788679307, -1110.7898373269727, -1343.6182268304062, -447.0949072940175, -591.4635199551582, -787.3242435191013, -997.3025151814631, -492.83794952757, -92.63904370989317, -948.2047053643502, -294.705197588459, -889.8409330737459, -1307.3950562285327, -864.212443660503, -272.12451259818755, -1052.8238412806684, -437.292249867701, -95.13170285663746, -78.2794776053826, -135.207083282929, -727.3254279736328, -524.2282730784001, -242.2469738208663, -329.85645953843147, -317.80905432446434, -991.8882000266774, -881.4576921841202, -806.5037162099303, -817.5087047319826, -1020.8110156816248, -1078.835157757562, -361.30306098301213, -59.07426517335951, -707.6961330413725, -1071.040849955678, -872.0877892601113, -448.7642803944028, -715.3632683205153, -1260.1216440052815, -825.3959326707802, -734.5985978164239, -535.5607043764076, -1039.271852377431, -311.0995250610856, -887.43668992298, -943.1982608314016, -886.8547728627511, -728.8716535414341, -673.9668345189241, -1186.30314402893, -822.1754902445105, -1083.338334918695, -22.61599935978622, -956.2923332994111, -242.39912727685925, -424.2112119916187, -881.480894073638, -1139.5162271826025, -1080.3759053317629, -675.2838718332997, -943.5885925977309, -620.9403622851256, -558.151021669141, -659.6919653880548, -610.8075552732278], "episode_lengths": [150, 83, 150, 150, 150, 150, 61, 150, 150, 115, 132, 60, 150, 150, 104, 150, 108, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 116, 150, 98, 90, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 118, 150, 135, 56, 53, 54, 150, 150, 80, 150, 140, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150], "policy_policy_0_reward": [-870.3921439867045, -217.1995922441331, -704.4958845549972, -722.1333559631389, -551.1298724606078, -1026.1982938960537, -50.51025930923855, -364.2576640178523, -900.867566482603, -472.8660460673535, -603.4895490338912, -137.7851320545722, -1060.3216390115501, -1151.238546868003, -240.06204053709945, -997.7139497060278, -341.70584278030066, -1020.4324244347081, -551.4281636694689, -1016.1675357373628, -684.666772751722, -917.8897597010813, -303.1705352503568, -952.7470750079478, -158.6253949548041, -624.2088666625037, -1187.6232402470366, -972.4497160057315, -1162.4246603515253, -724.0717098864817, -876.9206965982945, -221.9498005530768, -916.7660584608947, -363.19952782525354, -287.6350375055951, -729.5293788679307, -1110.7898373269727, -1343.6182268304062, -447.0949072940175, -591.4635199551582, -787.3242435191013, -997.3025151814631, -492.83794952757, -92.63904370989317, -948.2047053643502, -294.705197588459, -889.8409330737459, -1307.3950562285327, -864.212443660503, -272.12451259818755, -1052.8238412806684, -437.292249867701, -95.13170285663746, -78.2794776053826, -135.207083282929, -727.3254279736328, -524.2282730784001, -242.2469738208663, -329.85645953843147, -317.80905432446434, -991.8882000266774, -881.4576921841202, -806.5037162099303, -817.5087047319826, -1020.8110156816248, -1078.835157757562, -361.30306098301213, -59.07426517335951, -707.6961330413725, -1071.040849955678, -872.0877892601113, -448.7642803944028, -715.3632683205153, -1260.1216440052815, -825.3959326707802, -734.5985978164239, -535.5607043764076, -1039.271852377431, -311.0995250610856, -887.43668992298, -943.1982608314016, -886.8547728627511, -728.8716535414341, -673.9668345189241, -1186.30314402893, -822.1754902445105, -1083.338334918695, -22.61599935978622, -956.2923332994111, -242.39912727685925, -424.2112119916187, -881.480894073638, -1139.5162271826025, -1080.3759053317629, -675.2838718332997, -943.5885925977309, -620.9403622851256, -558.151021669141, -659.6919653880548, -610.8075552732278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5660937220102982, "mean_inference_ms": 1.7052584283301093, "mean_action_processing_ms": 0.28527882676485933, "mean_env_wait_ms": 3.0118598245051205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012923717498779297, "StateBufferConnector_ms": 0.008353710174560547, "ViewRequirementAgentConnector_ms": 0.19377708435058594}, "num_episodes": 27, "episode_return_max": -22.61599935978622, "episode_return_min": -1343.6182268304062, "episode_return_mean": -690.2991000739303, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.83165034265465, "num_env_steps_trained_throughput_per_sec": 301.83165034265465, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12869.599, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12869.526, "sample_time_ms": 1037.823, "learn_time_ms": 11765.434, "learn_throughput": 339.979, "synch_weights_time_ms": 65.424}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00002", "date": "2024-08-03_10-26-55", "timestamp": 1722661015, "time_this_iter_s": 13.264434337615967, "time_total_s": 103.05946016311646, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0e950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 103.05946016311646, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.473684210526315, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 140.89163894156616, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.8170058807979026, "policy_loss": -0.012775750000825307, "vf_loss": 2.8413850251585244, "vf_explained_var": 0.9824046028157075, "kl": 0.017007604246797814, "entropy": 1.5004926068087419, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -22.61599935978622, "episode_reward_min": -1343.6182268304062, "episode_reward_mean": -705.7106710255117, "episode_len_mean": 138.02, "episode_media": {}, "episodes_timesteps_total": 13802, "policy_reward_min": {"policy_0": -1343.6182268304062}, "policy_reward_max": {"policy_0": -22.61599935978622}, "policy_reward_mean": {"policy_0": -705.7106710255117}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-972.4497160057315, -1162.4246603515253, -724.0717098864817, -876.9206965982945, -221.9498005530768, -916.7660584608947, -363.19952782525354, -287.6350375055951, -729.5293788679307, -1110.7898373269727, -1343.6182268304062, -447.0949072940175, -591.4635199551582, -787.3242435191013, -997.3025151814631, -492.83794952757, -92.63904370989317, -948.2047053643502, -294.705197588459, -889.8409330737459, -1307.3950562285327, -864.212443660503, -272.12451259818755, -1052.8238412806684, -437.292249867701, -95.13170285663746, -78.2794776053826, -135.207083282929, -727.3254279736328, -524.2282730784001, -242.2469738208663, -329.85645953843147, -317.80905432446434, -991.8882000266774, -881.4576921841202, -806.5037162099303, -817.5087047319826, -1020.8110156816248, -1078.835157757562, -361.30306098301213, -59.07426517335951, -707.6961330413725, -1071.040849955678, -872.0877892601113, -448.7642803944028, -715.3632683205153, -1260.1216440052815, -825.3959326707802, -734.5985978164239, -535.5607043764076, -1039.271852377431, -311.0995250610856, -887.43668992298, -943.1982608314016, -886.8547728627511, -728.8716535414341, -673.9668345189241, -1186.30314402893, -822.1754902445105, -1083.338334918695, -22.61599935978622, -956.2923332994111, -242.39912727685925, -424.2112119916187, -881.480894073638, -1139.5162271826025, -1080.3759053317629, -675.2838718332997, -943.5885925977309, -620.9403622851256, -558.151021669141, -659.6919653880548, -610.8075552732278, -444.3975469610919, -752.073625599611, -974.4200739643987, -150.5969212541108, -68.35734456365597, -414.5228406513833, -833.5738585380817, -761.7742996585903, -982.0357090837792, -216.10510612082237, -371.51461087195406, -1141.0976665374426, -796.2567813041562, -866.0689504361021, -729.8480842831667, -1069.2951729840847, -1147.7775225224666, -309.83895590477147, -1191.4083069994745, -969.289097493921, -478.83009251851655, -920.0461587825253, -575.8583715180453, -1218.7455661109616, -775.3618853692387, -457.94120000532115, -753.4484925115794], "episode_lengths": [150, 150, 150, 150, 116, 150, 98, 90, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 118, 150, 135, 56, 53, 54, 150, 150, 80, 150, 140, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 90, 54, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150], "policy_policy_0_reward": [-972.4497160057315, -1162.4246603515253, -724.0717098864817, -876.9206965982945, -221.9498005530768, -916.7660584608947, -363.19952782525354, -287.6350375055951, -729.5293788679307, -1110.7898373269727, -1343.6182268304062, -447.0949072940175, -591.4635199551582, -787.3242435191013, -997.3025151814631, -492.83794952757, -92.63904370989317, -948.2047053643502, -294.705197588459, -889.8409330737459, -1307.3950562285327, -864.212443660503, -272.12451259818755, -1052.8238412806684, -437.292249867701, -95.13170285663746, -78.2794776053826, -135.207083282929, -727.3254279736328, -524.2282730784001, -242.2469738208663, -329.85645953843147, -317.80905432446434, -991.8882000266774, -881.4576921841202, -806.5037162099303, -817.5087047319826, -1020.8110156816248, -1078.835157757562, -361.30306098301213, -59.07426517335951, -707.6961330413725, -1071.040849955678, -872.0877892601113, -448.7642803944028, -715.3632683205153, -1260.1216440052815, -825.3959326707802, -734.5985978164239, -535.5607043764076, -1039.271852377431, -311.0995250610856, -887.43668992298, -943.1982608314016, -886.8547728627511, -728.8716535414341, -673.9668345189241, -1186.30314402893, -822.1754902445105, -1083.338334918695, -22.61599935978622, -956.2923332994111, -242.39912727685925, -424.2112119916187, -881.480894073638, -1139.5162271826025, -1080.3759053317629, -675.2838718332997, -943.5885925977309, -620.9403622851256, -558.151021669141, -659.6919653880548, -610.8075552732278, -444.3975469610919, -752.073625599611, -974.4200739643987, -150.5969212541108, -68.35734456365597, -414.5228406513833, -833.5738585380817, -761.7742996585903, -982.0357090837792, -216.10510612082237, -371.51461087195406, -1141.0976665374426, -796.2567813041562, -866.0689504361021, -729.8480842831667, -1069.2951729840847, -1147.7775225224666, -309.83895590477147, -1191.4083069994745, -969.289097493921, -478.83009251851655, -920.0461587825253, -575.8583715180453, -1218.7455661109616, -775.3618853692387, -457.94120000532115, -753.4484925115794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5643375506615688, "mean_inference_ms": 1.702679819870604, "mean_action_processing_ms": 0.2844387787853919, "mean_env_wait_ms": 3.0142652559661918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01280355453491211, "StateBufferConnector_ms": 0.008324146270751953, "ViewRequirementAgentConnector_ms": 0.19764232635498047}, "num_episodes": 27, "episode_return_max": -22.61599935978622, "episode_return_min": -1343.6182268304062, "episode_return_mean": -705.7106710255117, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.4831903915822, "num_env_steps_trained_throughput_per_sec": 303.4831903915822, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12904.123, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12904.048, "sample_time_ms": 1036.481, "learn_time_ms": 11801.777, "learn_throughput": 338.932, "synch_weights_time_ms": 64.942}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00002", "date": "2024-08-03_10-27-08", "timestamp": 1722661028, "time_this_iter_s": 13.193692207336426, "time_total_s": 116.25315237045288, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00bef80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 116.25315237045288, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.194736842105264, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 130.5939737180869, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.7983032962307335, "policy_loss": -0.015223185077775269, "vf_loss": 2.8252948723733424, "vf_explained_var": 0.983048212962846, "kl": 0.019914844441943084, "entropy": 1.5751364664485057, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -22.61599935978622, "episode_reward_min": -1260.1216440052815, "episode_reward_mean": -706.455129081437, "episode_len_mean": 138.98, "episode_media": {}, "episodes_timesteps_total": 13898, "policy_reward_min": {"policy_0": -1260.1216440052815}, "policy_reward_max": {"policy_0": -22.61599935978622}, "policy_reward_mean": {"policy_0": -706.455129081437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-329.85645953843147, -317.80905432446434, -991.8882000266774, -881.4576921841202, -806.5037162099303, -817.5087047319826, -1020.8110156816248, -1078.835157757562, -361.30306098301213, -59.07426517335951, -707.6961330413725, -1071.040849955678, -872.0877892601113, -448.7642803944028, -715.3632683205153, -1260.1216440052815, -825.3959326707802, -734.5985978164239, -535.5607043764076, -1039.271852377431, -311.0995250610856, -887.43668992298, -943.1982608314016, -886.8547728627511, -728.8716535414341, -673.9668345189241, -1186.30314402893, -822.1754902445105, -1083.338334918695, -22.61599935978622, -956.2923332994111, -242.39912727685925, -424.2112119916187, -881.480894073638, -1139.5162271826025, -1080.3759053317629, -675.2838718332997, -943.5885925977309, -620.9403622851256, -558.151021669141, -659.6919653880548, -610.8075552732278, -444.3975469610919, -752.073625599611, -974.4200739643987, -150.5969212541108, -68.35734456365597, -414.5228406513833, -833.5738585380817, -761.7742996585903, -982.0357090837792, -216.10510612082237, -371.51461087195406, -1141.0976665374426, -796.2567813041562, -866.0689504361021, -729.8480842831667, -1069.2951729840847, -1147.7775225224666, -309.83895590477147, -1191.4083069994745, -969.289097493921, -478.83009251851655, -920.0461587825253, -575.8583715180453, -1218.7455661109616, -775.3618853692387, -457.94120000532115, -753.4484925115794, -747.4411413486654, -1006.6087176159051, -104.54020306476212, -294.35873071358304, -647.4678836915944, -239.94334284634036, -1156.92511347301, -841.5025093079809, -941.9073634443133, -506.2281705847423, -417.1736222092948, -911.5239380950856, -1106.9711733151244, -947.6829181049457, -1133.8523901999001, -498.92751210643826, -284.36621217715697, -1000.946507013417, -274.10770582273165, -827.2945976939716, -617.4587217437363, -955.766229362552, -162.2515352722119, -29.961178976135646, -1071.9824443855136, -562.2528931556807, -872.9536293306068, -290.3801768846759, -1063.3221167349507, -106.76391369605285, -438.61792090082025], "episode_lengths": [150, 140, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 90, 54, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 50, 99, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 76, 53, 150, 150, 150, 115, 150, 55, 150], "policy_policy_0_reward": [-329.85645953843147, -317.80905432446434, -991.8882000266774, -881.4576921841202, -806.5037162099303, -817.5087047319826, -1020.8110156816248, -1078.835157757562, -361.30306098301213, -59.07426517335951, -707.6961330413725, -1071.040849955678, -872.0877892601113, -448.7642803944028, -715.3632683205153, -1260.1216440052815, -825.3959326707802, -734.5985978164239, -535.5607043764076, -1039.271852377431, -311.0995250610856, -887.43668992298, -943.1982608314016, -886.8547728627511, -728.8716535414341, -673.9668345189241, -1186.30314402893, -822.1754902445105, -1083.338334918695, -22.61599935978622, -956.2923332994111, -242.39912727685925, -424.2112119916187, -881.480894073638, -1139.5162271826025, -1080.3759053317629, -675.2838718332997, -943.5885925977309, -620.9403622851256, -558.151021669141, -659.6919653880548, -610.8075552732278, -444.3975469610919, -752.073625599611, -974.4200739643987, -150.5969212541108, -68.35734456365597, -414.5228406513833, -833.5738585380817, -761.7742996585903, -982.0357090837792, -216.10510612082237, -371.51461087195406, -1141.0976665374426, -796.2567813041562, -866.0689504361021, -729.8480842831667, -1069.2951729840847, -1147.7775225224666, -309.83895590477147, -1191.4083069994745, -969.289097493921, -478.83009251851655, -920.0461587825253, -575.8583715180453, -1218.7455661109616, -775.3618853692387, -457.94120000532115, -753.4484925115794, -747.4411413486654, -1006.6087176159051, -104.54020306476212, -294.35873071358304, -647.4678836915944, -239.94334284634036, -1156.92511347301, -841.5025093079809, -941.9073634443133, -506.2281705847423, -417.1736222092948, -911.5239380950856, -1106.9711733151244, -947.6829181049457, -1133.8523901999001, -498.92751210643826, -284.36621217715697, -1000.946507013417, -274.10770582273165, -827.2945976939716, -617.4587217437363, -955.766229362552, -162.2515352722119, -29.961178976135646, -1071.9824443855136, -562.2528931556807, -872.9536293306068, -290.3801768846759, -1063.3221167349507, -106.76391369605285, -438.61792090082025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5631889950493233, "mean_inference_ms": 1.7021803568174578, "mean_action_processing_ms": 0.28388413725632566, "mean_env_wait_ms": 3.017488568049393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012547016143798828, "StateBufferConnector_ms": 0.008231878280639648, "ViewRequirementAgentConnector_ms": 0.1980445384979248}, "num_episodes": 31, "episode_return_max": -22.61599935978622, "episode_return_min": -1260.1216440052815, "episode_return_mean": -706.455129081437, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.47080197305604, "num_env_steps_trained_throughput_per_sec": 300.47080197305604, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12944.956, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12944.882, "sample_time_ms": 1036.507, "learn_time_ms": 11843.081, "learn_throughput": 337.75, "synch_weights_time_ms": 64.453}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00002", "date": "2024-08-03_10-27-21", "timestamp": 1722661041, "time_this_iter_s": 13.325977563858032, "time_total_s": 129.5791299343109, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00bdc60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 129.5791299343109, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.278947368421052, "ram_util_percent": 27.547368421052635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 170.62048036058744, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.2234502508615455, "policy_loss": -0.011428730419720524, "vf_loss": 2.246732277050614, "vf_explained_var": 0.9921654264753064, "kl": 0.01955084114209362, "entropy": 1.5763458788394928, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -20.869625538458234, "episode_reward_min": -1218.7455661109616, "episode_reward_mean": -716.0003905444551, "episode_len_mean": 138.49, "episode_media": {}, "episodes_timesteps_total": 13849, "policy_reward_min": {"policy_0": -1218.7455661109616}, "policy_reward_max": {"policy_0": -20.869625538458234}, "policy_reward_mean": {"policy_0": -716.0003905444551}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.61599935978622, -956.2923332994111, -242.39912727685925, -424.2112119916187, -881.480894073638, -1139.5162271826025, -1080.3759053317629, -675.2838718332997, -943.5885925977309, -620.9403622851256, -558.151021669141, -659.6919653880548, -610.8075552732278, -444.3975469610919, -752.073625599611, -974.4200739643987, -150.5969212541108, -68.35734456365597, -414.5228406513833, -833.5738585380817, -761.7742996585903, -982.0357090837792, -216.10510612082237, -371.51461087195406, -1141.0976665374426, -796.2567813041562, -866.0689504361021, -729.8480842831667, -1069.2951729840847, -1147.7775225224666, -309.83895590477147, -1191.4083069994745, -969.289097493921, -478.83009251851655, -920.0461587825253, -575.8583715180453, -1218.7455661109616, -775.3618853692387, -457.94120000532115, -753.4484925115794, -747.4411413486654, -1006.6087176159051, -104.54020306476212, -294.35873071358304, -647.4678836915944, -239.94334284634036, -1156.92511347301, -841.5025093079809, -941.9073634443133, -506.2281705847423, -417.1736222092948, -911.5239380950856, -1106.9711733151244, -947.6829181049457, -1133.8523901999001, -498.92751210643826, -284.36621217715697, -1000.946507013417, -274.10770582273165, -827.2945976939716, -617.4587217437363, -955.766229362552, -162.2515352722119, -29.961178976135646, -1071.9824443855136, -562.2528931556807, -872.9536293306068, -290.3801768846759, -1063.3221167349507, -106.76391369605285, -438.61792090082025, -405.9507895943293, -913.9388573756105, -1063.0922886684532, -900.8310053330416, -290.13380518735624, -561.2694238890206, -1011.6401968431753, -1120.2325338549554, -663.1512168410554, -942.8413988529918, -1154.0563822707888, -1173.776126775978, -483.6403496053041, -670.759535638195, -940.5541335054844, -1013.1450320225993, -962.5130173223229, -912.0685444048289, -952.3155505011489, -1099.908317223728, -349.82251170545777, -885.3371338684999, -992.4521862646827, -20.869625538458234, -901.2249315561209, -1095.4666508978119, -720.0892529193496, -820.4509698589704, -331.1874627423621], "episode_lengths": [42, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 90, 54, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 50, 99, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 76, 53, 150, 150, 150, 115, 150, 55, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-22.61599935978622, -956.2923332994111, -242.39912727685925, -424.2112119916187, -881.480894073638, -1139.5162271826025, -1080.3759053317629, -675.2838718332997, -943.5885925977309, -620.9403622851256, -558.151021669141, -659.6919653880548, -610.8075552732278, -444.3975469610919, -752.073625599611, -974.4200739643987, -150.5969212541108, -68.35734456365597, -414.5228406513833, -833.5738585380817, -761.7742996585903, -982.0357090837792, -216.10510612082237, -371.51461087195406, -1141.0976665374426, -796.2567813041562, -866.0689504361021, -729.8480842831667, -1069.2951729840847, -1147.7775225224666, -309.83895590477147, -1191.4083069994745, -969.289097493921, -478.83009251851655, -920.0461587825253, -575.8583715180453, -1218.7455661109616, -775.3618853692387, -457.94120000532115, -753.4484925115794, -747.4411413486654, -1006.6087176159051, -104.54020306476212, -294.35873071358304, -647.4678836915944, -239.94334284634036, -1156.92511347301, -841.5025093079809, -941.9073634443133, -506.2281705847423, -417.1736222092948, -911.5239380950856, -1106.9711733151244, -947.6829181049457, -1133.8523901999001, -498.92751210643826, -284.36621217715697, -1000.946507013417, -274.10770582273165, -827.2945976939716, -617.4587217437363, -955.766229362552, -162.2515352722119, -29.961178976135646, -1071.9824443855136, -562.2528931556807, -872.9536293306068, -290.3801768846759, -1063.3221167349507, -106.76391369605285, -438.61792090082025, -405.9507895943293, -913.9388573756105, -1063.0922886684532, -900.8310053330416, -290.13380518735624, -561.2694238890206, -1011.6401968431753, -1120.2325338549554, -663.1512168410554, -942.8413988529918, -1154.0563822707888, -1173.776126775978, -483.6403496053041, -670.759535638195, -940.5541335054844, -1013.1450320225993, -962.5130173223229, -912.0685444048289, -952.3155505011489, -1099.908317223728, -349.82251170545777, -885.3371338684999, -992.4521862646827, -20.869625538458234, -901.2249315561209, -1095.4666508978119, -720.0892529193496, -820.4509698589704, -331.1874627423621]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620915136662088, "mean_inference_ms": 1.7038437686842685, "mean_action_processing_ms": 0.2837603343320734, "mean_env_wait_ms": 3.0231710698867773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012634754180908203, "StateBufferConnector_ms": 0.008325815200805664, "ViewRequirementAgentConnector_ms": 0.20245361328125}, "num_episodes": 29, "episode_return_max": -20.869625538458234, "episode_return_min": -1218.7455661109616, "episode_return_mean": -716.0003905444551, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.6361052420817, "num_env_steps_trained_throughput_per_sec": 293.6361052420817, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12989.409, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12989.334, "sample_time_ms": 1039.343, "learn_time_ms": 11883.874, "learn_throughput": 336.591, "synch_weights_time_ms": 65.276}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00002", "date": "2024-08-03_10-27-35", "timestamp": 1722661055, "time_this_iter_s": 13.637535095214844, "time_total_s": 143.21666502952576, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00bff40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 143.21666502952576, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 13.273684210526318, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 167.81927535931268, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.964642808958888, "policy_loss": 0.0010005546413594858, "vf_loss": 1.9750380367661515, "vf_explained_var": 0.9845355457315842, "kl": 0.023204705612230706, "entropy": 1.603672163685163, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -20.869625538458234, "episode_reward_min": -1218.7455661109616, "episode_reward_mean": -748.1613236558518, "episode_len_mean": 141.05, "episode_media": {}, "episodes_timesteps_total": 14105, "policy_reward_min": {"policy_0": -1218.7455661109616}, "policy_reward_max": {"policy_0": -20.869625538458234}, "policy_reward_mean": {"policy_0": -748.1613236558518}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1069.2951729840847, -1147.7775225224666, -309.83895590477147, -1191.4083069994745, -969.289097493921, -478.83009251851655, -920.0461587825253, -575.8583715180453, -1218.7455661109616, -775.3618853692387, -457.94120000532115, -753.4484925115794, -747.4411413486654, -1006.6087176159051, -104.54020306476212, -294.35873071358304, -647.4678836915944, -239.94334284634036, -1156.92511347301, -841.5025093079809, -941.9073634443133, -506.2281705847423, -417.1736222092948, -911.5239380950856, -1106.9711733151244, -947.6829181049457, -1133.8523901999001, -498.92751210643826, -284.36621217715697, -1000.946507013417, -274.10770582273165, -827.2945976939716, -617.4587217437363, -955.766229362552, -162.2515352722119, -29.961178976135646, -1071.9824443855136, -562.2528931556807, -872.9536293306068, -290.3801768846759, -1063.3221167349507, -106.76391369605285, -438.61792090082025, -405.9507895943293, -913.9388573756105, -1063.0922886684532, -900.8310053330416, -290.13380518735624, -561.2694238890206, -1011.6401968431753, -1120.2325338549554, -663.1512168410554, -942.8413988529918, -1154.0563822707888, -1173.776126775978, -483.6403496053041, -670.759535638195, -940.5541335054844, -1013.1450320225993, -962.5130173223229, -912.0685444048289, -952.3155505011489, -1099.908317223728, -349.82251170545777, -885.3371338684999, -992.4521862646827, -20.869625538458234, -901.2249315561209, -1095.4666508978119, -720.0892529193496, -820.4509698589704, -331.1874627423621, -740.3701052524096, -729.5480558921679, -698.2506374689788, -1087.9660806211427, -1076.983927570357, -771.6098433995775, -1006.1906757208098, -919.9356538927368, -577.182315107106, -1028.411118389869, -820.2376505841717, -1078.2203368045741, -403.2652076461979, -1007.2928663661871, -622.9702185451043, -700.4609433715185, -845.1096696557548, -534.7755595893807, -890.2894041885244, -837.1500469702763, -730.173796401643, -68.60706327902331, -403.4201649471343, -863.7834678445107, -942.440692994108, -280.14515664126924, -703.4448811498277, -1165.856258235911], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 50, 99, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 76, 53, 150, 150, 150, 115, 150, 55, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 127, 150, 150, 150, 77, 150, 150, 150, 110, 150, 150], "policy_policy_0_reward": [-1069.2951729840847, -1147.7775225224666, -309.83895590477147, -1191.4083069994745, -969.289097493921, -478.83009251851655, -920.0461587825253, -575.8583715180453, -1218.7455661109616, -775.3618853692387, -457.94120000532115, -753.4484925115794, -747.4411413486654, -1006.6087176159051, -104.54020306476212, -294.35873071358304, -647.4678836915944, -239.94334284634036, -1156.92511347301, -841.5025093079809, -941.9073634443133, -506.2281705847423, -417.1736222092948, -911.5239380950856, -1106.9711733151244, -947.6829181049457, -1133.8523901999001, -498.92751210643826, -284.36621217715697, -1000.946507013417, -274.10770582273165, -827.2945976939716, -617.4587217437363, -955.766229362552, -162.2515352722119, -29.961178976135646, -1071.9824443855136, -562.2528931556807, -872.9536293306068, -290.3801768846759, -1063.3221167349507, -106.76391369605285, -438.61792090082025, -405.9507895943293, -913.9388573756105, -1063.0922886684532, -900.8310053330416, -290.13380518735624, -561.2694238890206, -1011.6401968431753, -1120.2325338549554, -663.1512168410554, -942.8413988529918, -1154.0563822707888, -1173.776126775978, -483.6403496053041, -670.759535638195, -940.5541335054844, -1013.1450320225993, -962.5130173223229, -912.0685444048289, -952.3155505011489, -1099.908317223728, -349.82251170545777, -885.3371338684999, -992.4521862646827, -20.869625538458234, -901.2249315561209, -1095.4666508978119, -720.0892529193496, -820.4509698589704, -331.1874627423621, -740.3701052524096, -729.5480558921679, -698.2506374689788, -1087.9660806211427, -1076.983927570357, -771.6098433995775, -1006.1906757208098, -919.9356538927368, -577.182315107106, -1028.411118389869, -820.2376505841717, -1078.2203368045741, -403.2652076461979, -1007.2928663661871, -622.9702185451043, -700.4609433715185, -845.1096696557548, -534.7755595893807, -890.2894041885244, -837.1500469702763, -730.173796401643, -68.60706327902331, -403.4201649471343, -863.7834678445107, -942.440692994108, -280.14515664126924, -703.4448811498277, -1165.856258235911]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5604827186088981, "mean_inference_ms": 1.700962880467694, "mean_action_processing_ms": 0.2830593212677248, "mean_env_wait_ms": 3.0212921020046752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012271642684936523, "StateBufferConnector_ms": 0.008105278015136719, "ViewRequirementAgentConnector_ms": 0.19712519645690918}, "num_episodes": 28, "episode_return_max": -20.869625538458234, "episode_return_min": -1218.7455661109616, "episode_return_mean": -748.1613236558518, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.19320032989407, "num_env_steps_trained_throughput_per_sec": 298.19320032989407, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12972.826, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12972.751, "sample_time_ms": 1034.001, "learn_time_ms": 11874.168, "learn_throughput": 336.866, "synch_weights_time_ms": 63.75}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00002", "date": "2024-08-03_10-27-49", "timestamp": 1722661069, "time_this_iter_s": 13.427742719650269, "time_total_s": 156.64440774917603, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0e950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 156.64440774917603, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.200000000000001, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 163.03710911870002, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.5124744246403377, "policy_loss": -0.01017392327824685, "vf_loss": 2.5341250312825045, "vf_explained_var": 0.9852201947321494, "kl": 0.01373473944346794, "entropy": 1.559709537650148, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -7.403640759327505, "episode_reward_min": -1246.5073589212452, "episode_reward_mean": -734.1407784546526, "episode_len_mean": 137.71, "episode_media": {}, "episodes_timesteps_total": 13771, "policy_reward_min": {"policy_0": -1246.5073589212452}, "policy_reward_max": {"policy_0": -7.403640759327505}, "policy_reward_mean": {"policy_0": -734.1407784546526}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-827.2945976939716, -617.4587217437363, -955.766229362552, -162.2515352722119, -29.961178976135646, -1071.9824443855136, -562.2528931556807, -872.9536293306068, -290.3801768846759, -1063.3221167349507, -106.76391369605285, -438.61792090082025, -405.9507895943293, -913.9388573756105, -1063.0922886684532, -900.8310053330416, -290.13380518735624, -561.2694238890206, -1011.6401968431753, -1120.2325338549554, -663.1512168410554, -942.8413988529918, -1154.0563822707888, -1173.776126775978, -483.6403496053041, -670.759535638195, -940.5541335054844, -1013.1450320225993, -962.5130173223229, -912.0685444048289, -952.3155505011489, -1099.908317223728, -349.82251170545777, -885.3371338684999, -992.4521862646827, -20.869625538458234, -901.2249315561209, -1095.4666508978119, -720.0892529193496, -820.4509698589704, -331.1874627423621, -740.3701052524096, -729.5480558921679, -698.2506374689788, -1087.9660806211427, -1076.983927570357, -771.6098433995775, -1006.1906757208098, -919.9356538927368, -577.182315107106, -1028.411118389869, -820.2376505841717, -1078.2203368045741, -403.2652076461979, -1007.2928663661871, -622.9702185451043, -700.4609433715185, -845.1096696557548, -534.7755595893807, -890.2894041885244, -837.1500469702763, -730.173796401643, -68.60706327902331, -403.4201649471343, -863.7834678445107, -942.440692994108, -280.14515664126924, -703.4448811498277, -1165.856258235911, -1233.1013332573434, -616.3287002235007, -1186.6794229710185, -775.7515795141582, -1218.1170617803116, -34.79593594246263, -943.7641093075563, -1191.7674340564, -509.4614411455469, -1153.033679086487, -469.6528921266738, -987.988984695977, -91.04409927330182, -1246.5073589212452, -7.403640759327505, -766.9846970598319, -1074.6888972156414, -945.2683333686009, -870.0540565704123, -119.31745752215949, -187.5491380811384, -813.875559847798, -402.4826443051015, -744.853621318875, -699.268476768201, -1037.4890932935298, -283.9384805363589, -344.84397597536656, -893.8137084793021, -508.27555472201834, -170.16008961035985], "episode_lengths": [150, 150, 150, 76, 53, 150, 150, 150, 115, 150, 55, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 127, 150, 150, 150, 77, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 110, 150, 106, 150, 72, 150, 34, 150, 150, 150, 150, 68, 96, 150, 143, 150, 150, 150, 123, 150, 150, 145, 75], "policy_policy_0_reward": [-827.2945976939716, -617.4587217437363, -955.766229362552, -162.2515352722119, -29.961178976135646, -1071.9824443855136, -562.2528931556807, -872.9536293306068, -290.3801768846759, -1063.3221167349507, -106.76391369605285, -438.61792090082025, -405.9507895943293, -913.9388573756105, -1063.0922886684532, -900.8310053330416, -290.13380518735624, -561.2694238890206, -1011.6401968431753, -1120.2325338549554, -663.1512168410554, -942.8413988529918, -1154.0563822707888, -1173.776126775978, -483.6403496053041, -670.759535638195, -940.5541335054844, -1013.1450320225993, -962.5130173223229, -912.0685444048289, -952.3155505011489, -1099.908317223728, -349.82251170545777, -885.3371338684999, -992.4521862646827, -20.869625538458234, -901.2249315561209, -1095.4666508978119, -720.0892529193496, -820.4509698589704, -331.1874627423621, -740.3701052524096, -729.5480558921679, -698.2506374689788, -1087.9660806211427, -1076.983927570357, -771.6098433995775, -1006.1906757208098, -919.9356538927368, -577.182315107106, -1028.411118389869, -820.2376505841717, -1078.2203368045741, -403.2652076461979, -1007.2928663661871, -622.9702185451043, -700.4609433715185, -845.1096696557548, -534.7755595893807, -890.2894041885244, -837.1500469702763, -730.173796401643, -68.60706327902331, -403.4201649471343, -863.7834678445107, -942.440692994108, -280.14515664126924, -703.4448811498277, -1165.856258235911, -1233.1013332573434, -616.3287002235007, -1186.6794229710185, -775.7515795141582, -1218.1170617803116, -34.79593594246263, -943.7641093075563, -1191.7674340564, -509.4614411455469, -1153.033679086487, -469.6528921266738, -987.988984695977, -91.04409927330182, -1246.5073589212452, -7.403640759327505, -766.9846970598319, -1074.6888972156414, -945.2683333686009, -870.0540565704123, -119.31745752215949, -187.5491380811384, -813.875559847798, -402.4826443051015, -744.853621318875, -699.268476768201, -1037.4890932935298, -283.9384805363589, -344.84397597536656, -893.8137084793021, -508.27555472201834, -170.16008961035985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5596282980678804, "mean_inference_ms": 1.6992447078227244, "mean_action_processing_ms": 0.2824504485281239, "mean_env_wait_ms": 3.024076334108289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012083292007446289, "StateBufferConnector_ms": 0.008075475692749023, "ViewRequirementAgentConnector_ms": 0.1975557804107666}, "num_episodes": 31, "episode_return_max": -7.403640759327505, "episode_return_min": -1246.5073589212452, "episode_return_mean": -734.1407784546526, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.70193312099025, "num_env_steps_trained_throughput_per_sec": 293.70193312099025, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12979.923, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12979.847, "sample_time_ms": 1036.52, "learn_time_ms": 11880.696, "learn_throughput": 336.681, "synch_weights_time_ms": 61.817}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00002", "date": "2024-08-03_10-28-02", "timestamp": 1722661082, "time_this_iter_s": 13.631033182144165, "time_total_s": 170.2754409313202, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a0108ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 170.2754409313202, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 12.910000000000002, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 167.85620976686477, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.7715249999115865, "policy_loss": -0.00872732674567184, "vf_loss": 1.7930508413662514, "vf_explained_var": 0.9931502209976315, "kl": 0.01067620156723025, "entropy": 1.6001380412528912, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -7.403640759327505, "episode_reward_min": -1246.5073589212452, "episode_reward_mean": -721.8578242263824, "episode_len_mean": 136.46, "episode_media": {}, "episodes_timesteps_total": 13646, "policy_reward_min": {"policy_0": -1246.5073589212452}, "policy_reward_max": {"policy_0": -7.403640759327505}, "policy_reward_mean": {"policy_0": -721.8578242263824}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-962.5130173223229, -912.0685444048289, -952.3155505011489, -1099.908317223728, -349.82251170545777, -885.3371338684999, -992.4521862646827, -20.869625538458234, -901.2249315561209, -1095.4666508978119, -720.0892529193496, -820.4509698589704, -331.1874627423621, -740.3701052524096, -729.5480558921679, -698.2506374689788, -1087.9660806211427, -1076.983927570357, -771.6098433995775, -1006.1906757208098, -919.9356538927368, -577.182315107106, -1028.411118389869, -820.2376505841717, -1078.2203368045741, -403.2652076461979, -1007.2928663661871, -622.9702185451043, -700.4609433715185, -845.1096696557548, -534.7755595893807, -890.2894041885244, -837.1500469702763, -730.173796401643, -68.60706327902331, -403.4201649471343, -863.7834678445107, -942.440692994108, -280.14515664126924, -703.4448811498277, -1165.856258235911, -1233.1013332573434, -616.3287002235007, -1186.6794229710185, -775.7515795141582, -1218.1170617803116, -34.79593594246263, -943.7641093075563, -1191.7674340564, -509.4614411455469, -1153.033679086487, -469.6528921266738, -987.988984695977, -91.04409927330182, -1246.5073589212452, -7.403640759327505, -766.9846970598319, -1074.6888972156414, -945.2683333686009, -870.0540565704123, -119.31745752215949, -187.5491380811384, -813.875559847798, -402.4826443051015, -744.853621318875, -699.268476768201, -1037.4890932935298, -283.9384805363589, -344.84397597536656, -893.8137084793021, -508.27555472201834, -170.16008961035985, -986.8822206772468, -937.8933071274015, -576.2461325433346, -951.2354021235235, -78.5188280912502, -1062.6457754712335, -998.5425226187511, -461.8954979426562, -842.1269306923747, -162.74637145525782, -888.2948071461346, -661.3334602946885, -365.8294198777266, -1143.8308507649792, -849.583793937854, -250.42451433946547, -371.1650722167154, -383.48079330249954, -713.0173234950768, -161.7015882151877, -810.3607061795406, -909.7274056603779, -941.1087102385721, -592.6952286736802, -710.4207772109696, -192.69808203178047, -1012.2704027055765, -1063.0470865343673], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 127, 150, 150, 150, 77, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 110, 150, 106, 150, 72, 150, 34, 150, 150, 150, 150, 68, 96, 150, 143, 150, 150, 150, 123, 150, 150, 145, 75, 150, 150, 150, 150, 43, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 102, 95, 109, 150, 55, 150, 150, 150, 150, 150, 95, 150, 150], "policy_policy_0_reward": [-962.5130173223229, -912.0685444048289, -952.3155505011489, -1099.908317223728, -349.82251170545777, -885.3371338684999, -992.4521862646827, -20.869625538458234, -901.2249315561209, -1095.4666508978119, -720.0892529193496, -820.4509698589704, -331.1874627423621, -740.3701052524096, -729.5480558921679, -698.2506374689788, -1087.9660806211427, -1076.983927570357, -771.6098433995775, -1006.1906757208098, -919.9356538927368, -577.182315107106, -1028.411118389869, -820.2376505841717, -1078.2203368045741, -403.2652076461979, -1007.2928663661871, -622.9702185451043, -700.4609433715185, -845.1096696557548, -534.7755595893807, -890.2894041885244, -837.1500469702763, -730.173796401643, -68.60706327902331, -403.4201649471343, -863.7834678445107, -942.440692994108, -280.14515664126924, -703.4448811498277, -1165.856258235911, -1233.1013332573434, -616.3287002235007, -1186.6794229710185, -775.7515795141582, -1218.1170617803116, -34.79593594246263, -943.7641093075563, -1191.7674340564, -509.4614411455469, -1153.033679086487, -469.6528921266738, -987.988984695977, -91.04409927330182, -1246.5073589212452, -7.403640759327505, -766.9846970598319, -1074.6888972156414, -945.2683333686009, -870.0540565704123, -119.31745752215949, -187.5491380811384, -813.875559847798, -402.4826443051015, -744.853621318875, -699.268476768201, -1037.4890932935298, -283.9384805363589, -344.84397597536656, -893.8137084793021, -508.27555472201834, -170.16008961035985, -986.8822206772468, -937.8933071274015, -576.2461325433346, -951.2354021235235, -78.5188280912502, -1062.6457754712335, -998.5425226187511, -461.8954979426562, -842.1269306923747, -162.74637145525782, -888.2948071461346, -661.3334602946885, -365.8294198777266, -1143.8308507649792, -849.583793937854, -250.42451433946547, -371.1650722167154, -383.48079330249954, -713.0173234950768, -161.7015882151877, -810.3607061795406, -909.7274056603779, -941.1087102385721, -592.6952286736802, -710.4207772109696, -192.69808203178047, -1012.2704027055765, -1063.0470865343673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5590124881814188, "mean_inference_ms": 1.6981819931839532, "mean_action_processing_ms": 0.28213885696024404, "mean_env_wait_ms": 3.0252044878904645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012007951736450195, "StateBufferConnector_ms": 0.007988929748535156, "ViewRequirementAgentConnector_ms": 0.19585108757019043}, "num_episodes": 28, "episode_return_max": -7.403640759327505, "episode_return_min": -1246.5073589212452, "episode_return_mean": -721.8578242263824, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.3886285909517, "num_env_steps_trained_throughput_per_sec": 295.3886285909517, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12997.141, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12997.067, "sample_time_ms": 1032.374, "learn_time_ms": 11902.453, "learn_throughput": 336.065, "synch_weights_time_ms": 61.429}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00002", "date": "2024-08-03_10-28-16", "timestamp": 1722661096, "time_this_iter_s": 13.553330421447754, "time_total_s": 183.82877135276794, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00bdbd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 183.82877135276794, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.08421052631579, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.6493853221337, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.0006056680033604, "policy_loss": -0.008042051583955375, "vf_loss": 2.0197046659886837, "vf_explained_var": 0.986763535750409, "kl": 0.011685678324223178, "entropy": 1.4562641873955726, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -7.403640759327505, "episode_reward_min": -1246.5073589212452, "episode_reward_mean": -678.195691843802, "episode_len_mean": 133.91, "episode_media": {}, "episodes_timesteps_total": 13391, "policy_reward_min": {"policy_0": -1246.5073589212452}, "policy_reward_max": {"policy_0": -7.403640759327505}, "policy_reward_mean": {"policy_0": -678.195691843802}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-534.7755595893807, -890.2894041885244, -837.1500469702763, -730.173796401643, -68.60706327902331, -403.4201649471343, -863.7834678445107, -942.440692994108, -280.14515664126924, -703.4448811498277, -1165.856258235911, -1233.1013332573434, -616.3287002235007, -1186.6794229710185, -775.7515795141582, -1218.1170617803116, -34.79593594246263, -943.7641093075563, -1191.7674340564, -509.4614411455469, -1153.033679086487, -469.6528921266738, -987.988984695977, -91.04409927330182, -1246.5073589212452, -7.403640759327505, -766.9846970598319, -1074.6888972156414, -945.2683333686009, -870.0540565704123, -119.31745752215949, -187.5491380811384, -813.875559847798, -402.4826443051015, -744.853621318875, -699.268476768201, -1037.4890932935298, -283.9384805363589, -344.84397597536656, -893.8137084793021, -508.27555472201834, -170.16008961035985, -986.8822206772468, -937.8933071274015, -576.2461325433346, -951.2354021235235, -78.5188280912502, -1062.6457754712335, -998.5425226187511, -461.8954979426562, -842.1269306923747, -162.74637145525782, -888.2948071461346, -661.3334602946885, -365.8294198777266, -1143.8308507649792, -849.583793937854, -250.42451433946547, -371.1650722167154, -383.48079330249954, -713.0173234950768, -161.7015882151877, -810.3607061795406, -909.7274056603779, -941.1087102385721, -592.6952286736802, -710.4207772109696, -192.69808203178047, -1012.2704027055765, -1063.0470865343673, -903.2834463139825, -917.6108821868046, -881.205088488592, -176.9362716393794, -834.1745727540357, -944.2742143813223, -878.4042426056988, -702.6852087645838, -876.5065429776888, -1083.9288636534527, -906.2644731149582, -787.246665215692, -418.6876224274994, -426.9256474574477, -1104.592295034268, -662.558273641722, -981.9968540791289, -110.35212239556857, -752.6446526750987, -573.6316108541396, -493.6859978687831, -46.07481288076026, -406.19218170722854, -523.8093252931969, -303.00235625194745, -529.9778495170013, -872.8119521656133, -238.8689875216223, -831.1114165202033, -622.053792446949], "episode_lengths": [127, 150, 150, 150, 77, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 110, 150, 106, 150, 72, 150, 34, 150, 150, 150, 150, 68, 96, 150, 143, 150, 150, 150, 123, 150, 150, 145, 75, 150, 150, 150, 150, 43, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 102, 95, 109, 150, 55, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 89, 150, 150, 113, 67, 118, 150, 110, 150, 150, 105, 150, 150], "policy_policy_0_reward": [-534.7755595893807, -890.2894041885244, -837.1500469702763, -730.173796401643, -68.60706327902331, -403.4201649471343, -863.7834678445107, -942.440692994108, -280.14515664126924, -703.4448811498277, -1165.856258235911, -1233.1013332573434, -616.3287002235007, -1186.6794229710185, -775.7515795141582, -1218.1170617803116, -34.79593594246263, -943.7641093075563, -1191.7674340564, -509.4614411455469, -1153.033679086487, -469.6528921266738, -987.988984695977, -91.04409927330182, -1246.5073589212452, -7.403640759327505, -766.9846970598319, -1074.6888972156414, -945.2683333686009, -870.0540565704123, -119.31745752215949, -187.5491380811384, -813.875559847798, -402.4826443051015, -744.853621318875, -699.268476768201, -1037.4890932935298, -283.9384805363589, -344.84397597536656, -893.8137084793021, -508.27555472201834, -170.16008961035985, -986.8822206772468, -937.8933071274015, -576.2461325433346, -951.2354021235235, -78.5188280912502, -1062.6457754712335, -998.5425226187511, -461.8954979426562, -842.1269306923747, -162.74637145525782, -888.2948071461346, -661.3334602946885, -365.8294198777266, -1143.8308507649792, -849.583793937854, -250.42451433946547, -371.1650722167154, -383.48079330249954, -713.0173234950768, -161.7015882151877, -810.3607061795406, -909.7274056603779, -941.1087102385721, -592.6952286736802, -710.4207772109696, -192.69808203178047, -1012.2704027055765, -1063.0470865343673, -903.2834463139825, -917.6108821868046, -881.205088488592, -176.9362716393794, -834.1745727540357, -944.2742143813223, -878.4042426056988, -702.6852087645838, -876.5065429776888, -1083.9288636534527, -906.2644731149582, -787.246665215692, -418.6876224274994, -426.9256474574477, -1104.592295034268, -662.558273641722, -981.9968540791289, -110.35212239556857, -752.6446526750987, -573.6316108541396, -493.6859978687831, -46.07481288076026, -406.19218170722854, -523.8093252931969, -303.00235625194745, -529.9778495170013, -872.8119521656133, -238.8689875216223, -831.1114165202033, -622.053792446949]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5584837787503679, "mean_inference_ms": 1.697313366302994, "mean_action_processing_ms": 0.28190498301332656, "mean_env_wait_ms": 3.0244292964429484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01246953010559082, "StateBufferConnector_ms": 0.008202314376831055, "ViewRequirementAgentConnector_ms": 0.20110201835632324}, "num_episodes": 30, "episode_return_max": -7.403640759327505, "episode_return_min": -1246.5073589212452, "episode_return_mean": -678.195691843802, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.8915914065215, "num_env_steps_trained_throughput_per_sec": 297.8915914065215, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13028.653, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13028.577, "sample_time_ms": 1032.656, "learn_time_ms": 11932.838, "learn_throughput": 335.209, "synch_weights_time_ms": 62.277}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00002", "date": "2024-08-03_10-28-29", "timestamp": 1722661109, "time_this_iter_s": 13.44221305847168, "time_total_s": 197.27098441123962, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00bc820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 197.27098441123962, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 14.34736842105263, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 174.6972820321719, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.9493926339472334, "policy_loss": -0.013528747231854746, "vf_loss": 1.973290388720731, "vf_explained_var": 0.9926162502417962, "kl": 0.016925948185356296, "entropy": 1.5446789941440027, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -10.104840291380336, "episode_reward_min": -1243.3522053044896, "episode_reward_mean": -663.5601937563013, "episode_len_mean": 134.96, "episode_media": {}, "episodes_timesteps_total": 13496, "policy_reward_min": {"policy_0": -1243.3522053044896}, "policy_reward_max": {"policy_0": -10.104840291380336}, "policy_reward_mean": {"policy_0": -663.5601937563013}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-119.31745752215949, -187.5491380811384, -813.875559847798, -402.4826443051015, -744.853621318875, -699.268476768201, -1037.4890932935298, -283.9384805363589, -344.84397597536656, -893.8137084793021, -508.27555472201834, -170.16008961035985, -986.8822206772468, -937.8933071274015, -576.2461325433346, -951.2354021235235, -78.5188280912502, -1062.6457754712335, -998.5425226187511, -461.8954979426562, -842.1269306923747, -162.74637145525782, -888.2948071461346, -661.3334602946885, -365.8294198777266, -1143.8308507649792, -849.583793937854, -250.42451433946547, -371.1650722167154, -383.48079330249954, -713.0173234950768, -161.7015882151877, -810.3607061795406, -909.7274056603779, -941.1087102385721, -592.6952286736802, -710.4207772109696, -192.69808203178047, -1012.2704027055765, -1063.0470865343673, -903.2834463139825, -917.6108821868046, -881.205088488592, -176.9362716393794, -834.1745727540357, -944.2742143813223, -878.4042426056988, -702.6852087645838, -876.5065429776888, -1083.9288636534527, -906.2644731149582, -787.246665215692, -418.6876224274994, -426.9256474574477, -1104.592295034268, -662.558273641722, -981.9968540791289, -110.35212239556857, -752.6446526750987, -573.6316108541396, -493.6859978687831, -46.07481288076026, -406.19218170722854, -523.8093252931969, -303.00235625194745, -529.9778495170013, -872.8119521656133, -238.8689875216223, -831.1114165202033, -622.053792446949, -563.9297305785184, -442.8922799079846, -745.9293599919099, -659.4634444253577, -236.04842865430447, -443.7016569108642, -356.18299967429016, -1073.345043725886, -783.8693122842094, -10.104840291380336, -1147.016009567965, -657.2666420792784, -100.3863296101571, -989.7629413144891, -712.8376504037492, -962.1940751723164, -844.0666637474991, -1005.367260412666, -1212.8787879410359, -161.2566830191686, -1111.1602423996148, -355.9861047724835, -1243.3522053044896, -648.9330164160693, -891.9778663253883, -783.1268053932777, -834.7733476598362, -658.0569601127387, -1025.67029623228, -617.3933564381324], "episode_lengths": [68, 96, 150, 143, 150, 150, 150, 123, 150, 150, 145, 75, 150, 150, 150, 150, 43, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 102, 95, 109, 150, 55, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 89, 150, 150, 113, 67, 118, 150, 110, 150, 150, 105, 150, 150, 150, 150, 150, 150, 75, 150, 145, 150, 150, 34, 150, 150, 56, 150, 150, 150, 150, 150, 150, 95, 150, 112, 150, 150, 150, 150, 150, 150, 150, 132], "policy_policy_0_reward": [-119.31745752215949, -187.5491380811384, -813.875559847798, -402.4826443051015, -744.853621318875, -699.268476768201, -1037.4890932935298, -283.9384805363589, -344.84397597536656, -893.8137084793021, -508.27555472201834, -170.16008961035985, -986.8822206772468, -937.8933071274015, -576.2461325433346, -951.2354021235235, -78.5188280912502, -1062.6457754712335, -998.5425226187511, -461.8954979426562, -842.1269306923747, -162.74637145525782, -888.2948071461346, -661.3334602946885, -365.8294198777266, -1143.8308507649792, -849.583793937854, -250.42451433946547, -371.1650722167154, -383.48079330249954, -713.0173234950768, -161.7015882151877, -810.3607061795406, -909.7274056603779, -941.1087102385721, -592.6952286736802, -710.4207772109696, -192.69808203178047, -1012.2704027055765, -1063.0470865343673, -903.2834463139825, -917.6108821868046, -881.205088488592, -176.9362716393794, -834.1745727540357, -944.2742143813223, -878.4042426056988, -702.6852087645838, -876.5065429776888, -1083.9288636534527, -906.2644731149582, -787.246665215692, -418.6876224274994, -426.9256474574477, -1104.592295034268, -662.558273641722, -981.9968540791289, -110.35212239556857, -752.6446526750987, -573.6316108541396, -493.6859978687831, -46.07481288076026, -406.19218170722854, -523.8093252931969, -303.00235625194745, -529.9778495170013, -872.8119521656133, -238.8689875216223, -831.1114165202033, -622.053792446949, -563.9297305785184, -442.8922799079846, -745.9293599919099, -659.4634444253577, -236.04842865430447, -443.7016569108642, -356.18299967429016, -1073.345043725886, -783.8693122842094, -10.104840291380336, -1147.016009567965, -657.2666420792784, -100.3863296101571, -989.7629413144891, -712.8376504037492, -962.1940751723164, -844.0666637474991, -1005.367260412666, -1212.8787879410359, -161.2566830191686, -1111.1602423996148, -355.9861047724835, -1243.3522053044896, -648.9330164160693, -891.9778663253883, -783.1268053932777, -834.7733476598362, -658.0569601127387, -1025.67029623228, -617.3933564381324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5584346577503032, "mean_inference_ms": 1.6968909576368734, "mean_action_processing_ms": 0.28173296001642145, "mean_env_wait_ms": 3.0245895594646384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012343168258666992, "StateBufferConnector_ms": 0.008113384246826172, "ViewRequirementAgentConnector_ms": 0.20066380500793457}, "num_episodes": 30, "episode_return_max": -10.104840291380336, "episode_return_min": -1243.3522053044896, "episode_return_mean": -663.5601937563013, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.1737132605382, "num_env_steps_trained_throughput_per_sec": 301.1737132605382, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13371.071, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13370.996, "sample_time_ms": 1033.284, "learn_time_ms": 12273.852, "learn_throughput": 325.896, "synch_weights_time_ms": 63.051}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00002", "date": "2024-08-03_10-28-43", "timestamp": 1722661123, "time_this_iter_s": 13.2942955493927, "time_total_s": 210.56527996063232, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00bf7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 210.56527996063232, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.173684210526316, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 178.80185121893882, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.1066886351133385, "policy_loss": -0.012256411721561259, "vf_loss": 2.130329854848484, "vf_explained_var": 0.991631333095332, "kl": 0.013279996114912743, "entropy": 1.5368802512685458, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -10.104840291380336, "episode_reward_min": -1243.3522053044896, "episode_reward_mean": -682.8232372124477, "episode_len_mean": 135.87, "episode_media": {}, "episodes_timesteps_total": 13587, "policy_reward_min": {"policy_0": -1243.3522053044896}, "policy_reward_max": {"policy_0": -10.104840291380336}, "policy_reward_mean": {"policy_0": -682.8232372124477}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-713.0173234950768, -161.7015882151877, -810.3607061795406, -909.7274056603779, -941.1087102385721, -592.6952286736802, -710.4207772109696, -192.69808203178047, -1012.2704027055765, -1063.0470865343673, -903.2834463139825, -917.6108821868046, -881.205088488592, -176.9362716393794, -834.1745727540357, -944.2742143813223, -878.4042426056988, -702.6852087645838, -876.5065429776888, -1083.9288636534527, -906.2644731149582, -787.246665215692, -418.6876224274994, -426.9256474574477, -1104.592295034268, -662.558273641722, -981.9968540791289, -110.35212239556857, -752.6446526750987, -573.6316108541396, -493.6859978687831, -46.07481288076026, -406.19218170722854, -523.8093252931969, -303.00235625194745, -529.9778495170013, -872.8119521656133, -238.8689875216223, -831.1114165202033, -622.053792446949, -563.9297305785184, -442.8922799079846, -745.9293599919099, -659.4634444253577, -236.04842865430447, -443.7016569108642, -356.18299967429016, -1073.345043725886, -783.8693122842094, -10.104840291380336, -1147.016009567965, -657.2666420792784, -100.3863296101571, -989.7629413144891, -712.8376504037492, -962.1940751723164, -844.0666637474991, -1005.367260412666, -1212.8787879410359, -161.2566830191686, -1111.1602423996148, -355.9861047724835, -1243.3522053044896, -648.9330164160693, -891.9778663253883, -783.1268053932777, -834.7733476598362, -658.0569601127387, -1025.67029623228, -617.3933564381324, -887.6875717038472, -875.003088907763, -895.3319086472355, -756.317797569261, -554.6468664959857, -658.3517905998624, -295.6511700472016, -631.6952892386413, -358.007368500115, -98.39216646510644, -1005.4202178906584, -252.17027865696377, -853.2164910184871, -1020.3234081016719, -14.30230177013537, -438.5473147484237, -344.8599816838106, -766.4432136942862, -1120.3726644831172, -1131.7684165381452, -755.1126038870825, -908.3165296460361, -1191.2958114951875, -877.9945493047348, -25.635857947352918, -554.9176530963088, -413.14632122232695, -1083.9687598612468, -1116.154350980503, -219.79610249642724], "episode_lengths": [150, 55, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 89, 150, 150, 113, 67, 118, 150, 110, 150, 150, 105, 150, 150, 150, 150, 150, 150, 75, 150, 145, 150, 150, 34, 150, 150, 56, 150, 150, 150, 150, 150, 150, 95, 150, 112, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 134, 91, 150, 89, 150, 150, 43, 150, 96, 150, 150, 150, 150, 150, 150, 150, 43, 150, 119, 150, 150, 103], "policy_policy_0_reward": [-713.0173234950768, -161.7015882151877, -810.3607061795406, -909.7274056603779, -941.1087102385721, -592.6952286736802, -710.4207772109696, -192.69808203178047, -1012.2704027055765, -1063.0470865343673, -903.2834463139825, -917.6108821868046, -881.205088488592, -176.9362716393794, -834.1745727540357, -944.2742143813223, -878.4042426056988, -702.6852087645838, -876.5065429776888, -1083.9288636534527, -906.2644731149582, -787.246665215692, -418.6876224274994, -426.9256474574477, -1104.592295034268, -662.558273641722, -981.9968540791289, -110.35212239556857, -752.6446526750987, -573.6316108541396, -493.6859978687831, -46.07481288076026, -406.19218170722854, -523.8093252931969, -303.00235625194745, -529.9778495170013, -872.8119521656133, -238.8689875216223, -831.1114165202033, -622.053792446949, -563.9297305785184, -442.8922799079846, -745.9293599919099, -659.4634444253577, -236.04842865430447, -443.7016569108642, -356.18299967429016, -1073.345043725886, -783.8693122842094, -10.104840291380336, -1147.016009567965, -657.2666420792784, -100.3863296101571, -989.7629413144891, -712.8376504037492, -962.1940751723164, -844.0666637474991, -1005.367260412666, -1212.8787879410359, -161.2566830191686, -1111.1602423996148, -355.9861047724835, -1243.3522053044896, -648.9330164160693, -891.9778663253883, -783.1268053932777, -834.7733476598362, -658.0569601127387, -1025.67029623228, -617.3933564381324, -887.6875717038472, -875.003088907763, -895.3319086472355, -756.317797569261, -554.6468664959857, -658.3517905998624, -295.6511700472016, -631.6952892386413, -358.007368500115, -98.39216646510644, -1005.4202178906584, -252.17027865696377, -853.2164910184871, -1020.3234081016719, -14.30230177013537, -438.5473147484237, -344.8599816838106, -766.4432136942862, -1120.3726644831172, -1131.7684165381452, -755.1126038870825, -908.3165296460361, -1191.2958114951875, -877.9945493047348, -25.635857947352918, -554.9176530963088, -413.14632122232695, -1083.9687598612468, -1116.154350980503, -219.79610249642724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5579110258689312, "mean_inference_ms": 1.6952699943806544, "mean_action_processing_ms": 0.2812850896532061, "mean_env_wait_ms": 3.0253347902420984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012262821197509766, "StateBufferConnector_ms": 0.008016586303710938, "ViewRequirementAgentConnector_ms": 0.19901061058044434}, "num_episodes": 30, "episode_return_max": -10.104840291380336, "episode_return_min": -1243.3522053044896, "episode_return_mean": -682.8232372124477, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.5632671677155, "num_env_steps_trained_throughput_per_sec": 296.5632671677155, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13413.938, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13413.862, "sample_time_ms": 1036.229, "learn_time_ms": 12313.592, "learn_throughput": 324.844, "synch_weights_time_ms": 63.226}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00002", "date": "2024-08-03_10-28-56", "timestamp": 1722661136, "time_this_iter_s": 13.500571489334106, "time_total_s": 224.06585144996643, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf557e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 224.06585144996643, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.394736842105264, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 198.41009179751077, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.1368109214430056, "policy_loss": -0.0054280351435105935, "vf_loss": 2.153375169013937, "vf_explained_var": 0.9920626423011224, "kl": 0.012483393893186681, "entropy": 1.4881225219617287, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -10.104840291380336, "episode_reward_min": -1243.3522053044896, "episode_reward_mean": -681.537244232667, "episode_len_mean": 136.28, "episode_media": {}, "episodes_timesteps_total": 13628, "policy_reward_min": {"policy_0": -1243.3522053044896}, "policy_reward_max": {"policy_0": -10.104840291380336}, "policy_reward_mean": {"policy_0": -681.537244232667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-981.9968540791289, -110.35212239556857, -752.6446526750987, -573.6316108541396, -493.6859978687831, -46.07481288076026, -406.19218170722854, -523.8093252931969, -303.00235625194745, -529.9778495170013, -872.8119521656133, -238.8689875216223, -831.1114165202033, -622.053792446949, -563.9297305785184, -442.8922799079846, -745.9293599919099, -659.4634444253577, -236.04842865430447, -443.7016569108642, -356.18299967429016, -1073.345043725886, -783.8693122842094, -10.104840291380336, -1147.016009567965, -657.2666420792784, -100.3863296101571, -989.7629413144891, -712.8376504037492, -962.1940751723164, -844.0666637474991, -1005.367260412666, -1212.8787879410359, -161.2566830191686, -1111.1602423996148, -355.9861047724835, -1243.3522053044896, -648.9330164160693, -891.9778663253883, -783.1268053932777, -834.7733476598362, -658.0569601127387, -1025.67029623228, -617.3933564381324, -887.6875717038472, -875.003088907763, -895.3319086472355, -756.317797569261, -554.6468664959857, -658.3517905998624, -295.6511700472016, -631.6952892386413, -358.007368500115, -98.39216646510644, -1005.4202178906584, -252.17027865696377, -853.2164910184871, -1020.3234081016719, -14.30230177013537, -438.5473147484237, -344.8599816838106, -766.4432136942862, -1120.3726644831172, -1131.7684165381452, -755.1126038870825, -908.3165296460361, -1191.2958114951875, -877.9945493047348, -25.635857947352918, -554.9176530963088, -413.14632122232695, -1083.9687598612468, -1116.154350980503, -219.79610249642724, -995.3200866575611, -701.9832668920106, -1204.1418518616415, -1010.6353095404227, -24.455229561833825, -508.35223740853314, -1071.0305061365798, -897.2990278924373, -767.6624253105284, -532.4281299530954, -852.6675855544087, -921.2280807703053, -398.48650224049413, -998.428587459896, -148.66303424066106, -712.7664814249232, -639.9894437409927, -1028.8765993199943, -1042.5608520575001, -691.7765356022855, -733.781087313048, -842.217041669782, -877.5022895782937, -895.0680418423192, -758.2968862624775, -228.11520333216825], "episode_lengths": [150, 89, 150, 150, 113, 67, 118, 150, 110, 150, 150, 105, 150, 150, 150, 150, 150, 150, 75, 150, 145, 150, 150, 34, 150, 150, 56, 150, 150, 150, 150, 150, 150, 95, 150, 112, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 134, 91, 150, 89, 150, 150, 43, 150, 96, 150, 150, 150, 150, 150, 150, 150, 43, 150, 119, 150, 150, 103, 150, 150, 150, 150, 45, 140, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-981.9968540791289, -110.35212239556857, -752.6446526750987, -573.6316108541396, -493.6859978687831, -46.07481288076026, -406.19218170722854, -523.8093252931969, -303.00235625194745, -529.9778495170013, -872.8119521656133, -238.8689875216223, -831.1114165202033, -622.053792446949, -563.9297305785184, -442.8922799079846, -745.9293599919099, -659.4634444253577, -236.04842865430447, -443.7016569108642, -356.18299967429016, -1073.345043725886, -783.8693122842094, -10.104840291380336, -1147.016009567965, -657.2666420792784, -100.3863296101571, -989.7629413144891, -712.8376504037492, -962.1940751723164, -844.0666637474991, -1005.367260412666, -1212.8787879410359, -161.2566830191686, -1111.1602423996148, -355.9861047724835, -1243.3522053044896, -648.9330164160693, -891.9778663253883, -783.1268053932777, -834.7733476598362, -658.0569601127387, -1025.67029623228, -617.3933564381324, -887.6875717038472, -875.003088907763, -895.3319086472355, -756.317797569261, -554.6468664959857, -658.3517905998624, -295.6511700472016, -631.6952892386413, -358.007368500115, -98.39216646510644, -1005.4202178906584, -252.17027865696377, -853.2164910184871, -1020.3234081016719, -14.30230177013537, -438.5473147484237, -344.8599816838106, -766.4432136942862, -1120.3726644831172, -1131.7684165381452, -755.1126038870825, -908.3165296460361, -1191.2958114951875, -877.9945493047348, -25.635857947352918, -554.9176530963088, -413.14632122232695, -1083.9687598612468, -1116.154350980503, -219.79610249642724, -995.3200866575611, -701.9832668920106, -1204.1418518616415, -1010.6353095404227, -24.455229561833825, -508.35223740853314, -1071.0305061365798, -897.2990278924373, -767.6624253105284, -532.4281299530954, -852.6675855544087, -921.2280807703053, -398.48650224049413, -998.428587459896, -148.66303424066106, -712.7664814249232, -639.9894437409927, -1028.8765993199943, -1042.5608520575001, -691.7765356022855, -733.781087313048, -842.217041669782, -877.5022895782937, -895.0680418423192, -758.2968862624775, -228.11520333216825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578615816301518, "mean_inference_ms": 1.6945415795219654, "mean_action_processing_ms": 0.28109338017197855, "mean_env_wait_ms": 3.026234281255641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012122869491577148, "StateBufferConnector_ms": 0.007999420166015625, "ViewRequirementAgentConnector_ms": 0.19867348670959473}, "num_episodes": 26, "episode_return_max": -10.104840291380336, "episode_return_min": -1243.3522053044896, "episode_return_mean": -681.537244232667, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.03587897821564, "num_env_steps_trained_throughput_per_sec": 307.03587897821564, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13391.476, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13391.399, "sample_time_ms": 1032.236, "learn_time_ms": 12295.599, "learn_throughput": 325.32, "synch_weights_time_ms": 62.751}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00002", "date": "2024-08-03_10-29-09", "timestamp": 1722661149, "time_this_iter_s": 13.040185689926147, "time_total_s": 237.10603713989258, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0ecb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 237.10603713989258, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.294736842105262, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 146.4124572654565, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.967289019251863, "policy_loss": -0.009336446730594616, "vf_loss": 1.9864616908753912, "vf_explained_var": 0.9924821780994535, "kl": 0.015015546033252274, "entropy": 1.4340888616939387, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -10.746486690447437, "episode_reward_min": -1243.3522053044896, "episode_reward_mean": -688.1435892394326, "episode_len_mean": 137.0, "episode_media": {}, "episodes_timesteps_total": 13700, "policy_reward_min": {"policy_0": -1243.3522053044896}, "policy_reward_max": {"policy_0": -10.746486690447437}, "policy_reward_mean": {"policy_0": -688.1435892394326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1212.8787879410359, -161.2566830191686, -1111.1602423996148, -355.9861047724835, -1243.3522053044896, -648.9330164160693, -891.9778663253883, -783.1268053932777, -834.7733476598362, -658.0569601127387, -1025.67029623228, -617.3933564381324, -887.6875717038472, -875.003088907763, -895.3319086472355, -756.317797569261, -554.6468664959857, -658.3517905998624, -295.6511700472016, -631.6952892386413, -358.007368500115, -98.39216646510644, -1005.4202178906584, -252.17027865696377, -853.2164910184871, -1020.3234081016719, -14.30230177013537, -438.5473147484237, -344.8599816838106, -766.4432136942862, -1120.3726644831172, -1131.7684165381452, -755.1126038870825, -908.3165296460361, -1191.2958114951875, -877.9945493047348, -25.635857947352918, -554.9176530963088, -413.14632122232695, -1083.9687598612468, -1116.154350980503, -219.79610249642724, -995.3200866575611, -701.9832668920106, -1204.1418518616415, -1010.6353095404227, -24.455229561833825, -508.35223740853314, -1071.0305061365798, -897.2990278924373, -767.6624253105284, -532.4281299530954, -852.6675855544087, -921.2280807703053, -398.48650224049413, -998.428587459896, -148.66303424066106, -712.7664814249232, -639.9894437409927, -1028.8765993199943, -1042.5608520575001, -691.7765356022855, -733.781087313048, -842.217041669782, -877.5022895782937, -895.0680418423192, -758.2968862624775, -228.11520333216825, -459.88544451070004, -836.4522176057786, -647.3268521542852, -817.7293099477828, -578.0432360194023, -902.0584672111374, -892.6493995047636, -201.45277524489111, -731.1556193936626, -109.46047371204969, -453.3458388603537, -886.5661693372538, -95.27026660412902, -935.3910406865075, -501.85512649011656, -229.7595365781921, -936.4352991870891, -87.0102378575879, -1123.3089302741841, -227.19987025543162, -999.7742666414389, -347.91219273829495, -582.5579053149253, -876.6061445180374, -1154.1273017483622, -489.2792051181379, -10.746486690447437, -561.6220438532465, -368.7800701260148, -1235.6362308085315, -802.0093501274202, -599.8057724864575], "episode_lengths": [150, 95, 150, 112, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 134, 91, 150, 89, 150, 150, 43, 150, 96, 150, 150, 150, 150, 150, 150, 150, 43, 150, 119, 150, 150, 103, 150, 150, 150, 150, 45, 140, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 97, 150, 150, 62, 150, 150, 71, 150, 77, 150, 93, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1212.8787879410359, -161.2566830191686, -1111.1602423996148, -355.9861047724835, -1243.3522053044896, -648.9330164160693, -891.9778663253883, -783.1268053932777, -834.7733476598362, -658.0569601127387, -1025.67029623228, -617.3933564381324, -887.6875717038472, -875.003088907763, -895.3319086472355, -756.317797569261, -554.6468664959857, -658.3517905998624, -295.6511700472016, -631.6952892386413, -358.007368500115, -98.39216646510644, -1005.4202178906584, -252.17027865696377, -853.2164910184871, -1020.3234081016719, -14.30230177013537, -438.5473147484237, -344.8599816838106, -766.4432136942862, -1120.3726644831172, -1131.7684165381452, -755.1126038870825, -908.3165296460361, -1191.2958114951875, -877.9945493047348, -25.635857947352918, -554.9176530963088, -413.14632122232695, -1083.9687598612468, -1116.154350980503, -219.79610249642724, -995.3200866575611, -701.9832668920106, -1204.1418518616415, -1010.6353095404227, -24.455229561833825, -508.35223740853314, -1071.0305061365798, -897.2990278924373, -767.6624253105284, -532.4281299530954, -852.6675855544087, -921.2280807703053, -398.48650224049413, -998.428587459896, -148.66303424066106, -712.7664814249232, -639.9894437409927, -1028.8765993199943, -1042.5608520575001, -691.7765356022855, -733.781087313048, -842.217041669782, -877.5022895782937, -895.0680418423192, -758.2968862624775, -228.11520333216825, -459.88544451070004, -836.4522176057786, -647.3268521542852, -817.7293099477828, -578.0432360194023, -902.0584672111374, -892.6493995047636, -201.45277524489111, -731.1556193936626, -109.46047371204969, -453.3458388603537, -886.5661693372538, -95.27026660412902, -935.3910406865075, -501.85512649011656, -229.7595365781921, -936.4352991870891, -87.0102378575879, -1123.3089302741841, -227.19987025543162, -999.7742666414389, -347.91219273829495, -582.5579053149253, -876.6061445180374, -1154.1273017483622, -489.2792051181379, -10.746486690447437, -561.6220438532465, -368.7800701260148, -1235.6362308085315, -802.0093501274202, -599.8057724864575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577774714178699, "mean_inference_ms": 1.6936656836586321, "mean_action_processing_ms": 0.2808897654439349, "mean_env_wait_ms": 3.026816624169626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012221574783325195, "StateBufferConnector_ms": 0.007968425750732422, "ViewRequirementAgentConnector_ms": 0.19874954223632812}, "num_episodes": 32, "episode_return_max": -10.746486690447437, "episode_return_min": -1243.3522053044896, "episode_return_mean": -688.1435892394326, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.887984982828, "num_env_steps_trained_throughput_per_sec": 308.887984982828, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13368.413, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13368.338, "sample_time_ms": 1039.01, "learn_time_ms": 12263.649, "learn_throughput": 326.167, "synch_weights_time_ms": 64.861}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00002", "date": "2024-08-03_10-29-22", "timestamp": 1722661162, "time_this_iter_s": 12.962783813476562, "time_total_s": 250.06882095336914, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a01088b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 250.06882095336914, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 14.399999999999999, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 196.02419304649035, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.9851762937381863, "policy_loss": -0.011792512787117933, "vf_loss": 2.0065403835847975, "vf_explained_var": 0.9940683716908097, "kl": 0.016173523737173432, "entropy": 1.4423628825694323, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -10.746486690447437, "episode_reward_min": -1235.6362308085315, "episode_reward_mean": -697.4963483971254, "episode_len_mean": 136.38, "episode_media": {}, "episodes_timesteps_total": 13638, "policy_reward_min": {"policy_0": -1235.6362308085315}, "policy_reward_max": {"policy_0": -10.746486690447437}, "policy_reward_mean": {"policy_0": -697.4963483971254}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-344.8599816838106, -766.4432136942862, -1120.3726644831172, -1131.7684165381452, -755.1126038870825, -908.3165296460361, -1191.2958114951875, -877.9945493047348, -25.635857947352918, -554.9176530963088, -413.14632122232695, -1083.9687598612468, -1116.154350980503, -219.79610249642724, -995.3200866575611, -701.9832668920106, -1204.1418518616415, -1010.6353095404227, -24.455229561833825, -508.35223740853314, -1071.0305061365798, -897.2990278924373, -767.6624253105284, -532.4281299530954, -852.6675855544087, -921.2280807703053, -398.48650224049413, -998.428587459896, -148.66303424066106, -712.7664814249232, -639.9894437409927, -1028.8765993199943, -1042.5608520575001, -691.7765356022855, -733.781087313048, -842.217041669782, -877.5022895782937, -895.0680418423192, -758.2968862624775, -228.11520333216825, -459.88544451070004, -836.4522176057786, -647.3268521542852, -817.7293099477828, -578.0432360194023, -902.0584672111374, -892.6493995047636, -201.45277524489111, -731.1556193936626, -109.46047371204969, -453.3458388603537, -886.5661693372538, -95.27026660412902, -935.3910406865075, -501.85512649011656, -229.7595365781921, -936.4352991870891, -87.0102378575879, -1123.3089302741841, -227.19987025543162, -999.7742666414389, -347.91219273829495, -582.5579053149253, -876.6061445180374, -1154.1273017483622, -489.2792051181379, -10.746486690447437, -561.6220438532465, -368.7800701260148, -1235.6362308085315, -802.0093501274202, -599.8057724864575, -991.3657867721018, -239.24757966891897, -324.1234047007918, -653.8752594948661, -888.9294651370423, -871.3276271703286, -1093.9229757357514, -516.72369541812, -1000.2381447359745, -133.39559362448273, -845.3878572229862, -1126.1835285021864, -700.1905274494272, -976.2439180132583, -877.0839491077154, -890.35426782157, -558.393231095857, -859.865785312263, -546.9397771510237, -853.4466762632152, -926.6820798185041, -258.5338750132853, -899.153132516393, -958.4986659142695, -50.6375590023092, -874.7417023994992, -64.78236407608465, -1094.638189006955], "episode_lengths": [96, 150, 150, 150, 150, 150, 150, 150, 43, 150, 119, 150, 150, 103, 150, 150, 150, 150, 45, 140, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 97, 150, 150, 62, 150, 150, 71, 150, 77, 150, 93, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 97, 95, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 68, 150, 55, 150], "policy_policy_0_reward": [-344.8599816838106, -766.4432136942862, -1120.3726644831172, -1131.7684165381452, -755.1126038870825, -908.3165296460361, -1191.2958114951875, -877.9945493047348, -25.635857947352918, -554.9176530963088, -413.14632122232695, -1083.9687598612468, -1116.154350980503, -219.79610249642724, -995.3200866575611, -701.9832668920106, -1204.1418518616415, -1010.6353095404227, -24.455229561833825, -508.35223740853314, -1071.0305061365798, -897.2990278924373, -767.6624253105284, -532.4281299530954, -852.6675855544087, -921.2280807703053, -398.48650224049413, -998.428587459896, -148.66303424066106, -712.7664814249232, -639.9894437409927, -1028.8765993199943, -1042.5608520575001, -691.7765356022855, -733.781087313048, -842.217041669782, -877.5022895782937, -895.0680418423192, -758.2968862624775, -228.11520333216825, -459.88544451070004, -836.4522176057786, -647.3268521542852, -817.7293099477828, -578.0432360194023, -902.0584672111374, -892.6493995047636, -201.45277524489111, -731.1556193936626, -109.46047371204969, -453.3458388603537, -886.5661693372538, -95.27026660412902, -935.3910406865075, -501.85512649011656, -229.7595365781921, -936.4352991870891, -87.0102378575879, -1123.3089302741841, -227.19987025543162, -999.7742666414389, -347.91219273829495, -582.5579053149253, -876.6061445180374, -1154.1273017483622, -489.2792051181379, -10.746486690447437, -561.6220438532465, -368.7800701260148, -1235.6362308085315, -802.0093501274202, -599.8057724864575, -991.3657867721018, -239.24757966891897, -324.1234047007918, -653.8752594948661, -888.9294651370423, -871.3276271703286, -1093.9229757357514, -516.72369541812, -1000.2381447359745, -133.39559362448273, -845.3878572229862, -1126.1835285021864, -700.1905274494272, -976.2439180132583, -877.0839491077154, -890.35426782157, -558.393231095857, -859.865785312263, -546.9397771510237, -853.4466762632152, -926.6820798185041, -258.5338750132853, -899.153132516393, -958.4986659142695, -50.6375590023092, -874.7417023994992, -64.78236407608465, -1094.638189006955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577535587976326, "mean_inference_ms": 1.6945290595830367, "mean_action_processing_ms": 0.2808995170189882, "mean_env_wait_ms": 3.0287278508841173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012079000473022461, "StateBufferConnector_ms": 0.008077621459960938, "ViewRequirementAgentConnector_ms": 0.20084571838378906}, "num_episodes": 28, "episode_return_max": -10.746486690447437, "episode_return_min": -1235.6362308085315, "episode_return_mean": -697.4963483971254, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.74959669679833, "num_env_steps_trained_throughput_per_sec": 298.74959669679833, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13376.083, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13376.007, "sample_time_ms": 1038.989, "learn_time_ms": 12270.216, "learn_throughput": 325.993, "synch_weights_time_ms": 65.971}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00002", "date": "2024-08-03_10-29-36", "timestamp": 1722661176, "time_this_iter_s": 13.40261459350586, "time_total_s": 263.471435546875, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0f880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 263.471435546875, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.484210526315792, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.1383058130741, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.0950180729230246, "policy_loss": -0.011830191940922911, "vf_loss": 2.1178508748610816, "vf_explained_var": 0.9951215015724302, "kl": 0.013257402179321313, "entropy": 1.4979826766997575, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -10.746486690447437, "episode_reward_min": -1249.673627900664, "episode_reward_mean": -682.3272857021414, "episode_len_mean": 138.11, "episode_media": {}, "episodes_timesteps_total": 13811, "policy_reward_min": {"policy_0": -1249.673627900664}, "policy_reward_max": {"policy_0": -10.746486690447437}, "policy_reward_mean": {"policy_0": -682.3272857021414}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1042.5608520575001, -691.7765356022855, -733.781087313048, -842.217041669782, -877.5022895782937, -895.0680418423192, -758.2968862624775, -228.11520333216825, -459.88544451070004, -836.4522176057786, -647.3268521542852, -817.7293099477828, -578.0432360194023, -902.0584672111374, -892.6493995047636, -201.45277524489111, -731.1556193936626, -109.46047371204969, -453.3458388603537, -886.5661693372538, -95.27026660412902, -935.3910406865075, -501.85512649011656, -229.7595365781921, -936.4352991870891, -87.0102378575879, -1123.3089302741841, -227.19987025543162, -999.7742666414389, -347.91219273829495, -582.5579053149253, -876.6061445180374, -1154.1273017483622, -489.2792051181379, -10.746486690447437, -561.6220438532465, -368.7800701260148, -1235.6362308085315, -802.0093501274202, -599.8057724864575, -991.3657867721018, -239.24757966891897, -324.1234047007918, -653.8752594948661, -888.9294651370423, -871.3276271703286, -1093.9229757357514, -516.72369541812, -1000.2381447359745, -133.39559362448273, -845.3878572229862, -1126.1835285021864, -700.1905274494272, -976.2439180132583, -877.0839491077154, -890.35426782157, -558.393231095857, -859.865785312263, -546.9397771510237, -853.4466762632152, -926.6820798185041, -258.5338750132853, -899.153132516393, -958.4986659142695, -50.6375590023092, -874.7417023994992, -64.78236407608465, -1094.638189006955, -786.2372156859449, -354.76655450301666, -407.74991871628146, -735.1574730646742, -1229.6143542434534, -876.2922096114097, -495.08373354459576, -807.8554393843099, -738.6923303277366, -817.7108039121588, -764.6981072959965, -784.44426276801, -680.056265178138, -999.9813955845849, -282.85258039473524, -1249.673627900664, -206.3565194370252, -1028.0354795638027, -1071.9283763996593, -174.1016653569932, -973.5763994039044, -703.5681257389658, -775.9463255994679, -779.3495209023619, -934.7223283822572, -1170.5580903795071, -481.08957558641856, -111.59307079566692, -500.2576609425566, -491.84171930487656, -173.36410310484501, -820.135699790435], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 97, 150, 150, 62, 150, 150, 71, 150, 77, 150, 93, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 97, 95, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 68, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 107, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 107, 150], "policy_policy_0_reward": [-1042.5608520575001, -691.7765356022855, -733.781087313048, -842.217041669782, -877.5022895782937, -895.0680418423192, -758.2968862624775, -228.11520333216825, -459.88544451070004, -836.4522176057786, -647.3268521542852, -817.7293099477828, -578.0432360194023, -902.0584672111374, -892.6493995047636, -201.45277524489111, -731.1556193936626, -109.46047371204969, -453.3458388603537, -886.5661693372538, -95.27026660412902, -935.3910406865075, -501.85512649011656, -229.7595365781921, -936.4352991870891, -87.0102378575879, -1123.3089302741841, -227.19987025543162, -999.7742666414389, -347.91219273829495, -582.5579053149253, -876.6061445180374, -1154.1273017483622, -489.2792051181379, -10.746486690447437, -561.6220438532465, -368.7800701260148, -1235.6362308085315, -802.0093501274202, -599.8057724864575, -991.3657867721018, -239.24757966891897, -324.1234047007918, -653.8752594948661, -888.9294651370423, -871.3276271703286, -1093.9229757357514, -516.72369541812, -1000.2381447359745, -133.39559362448273, -845.3878572229862, -1126.1835285021864, -700.1905274494272, -976.2439180132583, -877.0839491077154, -890.35426782157, -558.393231095857, -859.865785312263, -546.9397771510237, -853.4466762632152, -926.6820798185041, -258.5338750132853, -899.153132516393, -958.4986659142695, -50.6375590023092, -874.7417023994992, -64.78236407608465, -1094.638189006955, -786.2372156859449, -354.76655450301666, -407.74991871628146, -735.1574730646742, -1229.6143542434534, -876.2922096114097, -495.08373354459576, -807.8554393843099, -738.6923303277366, -817.7108039121588, -764.6981072959965, -784.44426276801, -680.056265178138, -999.9813955845849, -282.85258039473524, -1249.673627900664, -206.3565194370252, -1028.0354795638027, -1071.9283763996593, -174.1016653569932, -973.5763994039044, -703.5681257389658, -775.9463255994679, -779.3495209023619, -934.7223283822572, -1170.5580903795071, -481.08957558641856, -111.59307079566692, -500.2576609425566, -491.84171930487656, -173.36410310484501, -820.135699790435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5579166765411113, "mean_inference_ms": 1.6946646813368975, "mean_action_processing_ms": 0.28100720287666686, "mean_env_wait_ms": 3.0292921052335178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01211690902709961, "StateBufferConnector_ms": 0.008088111877441406, "ViewRequirementAgentConnector_ms": 0.20111751556396484}, "num_episodes": 32, "episode_return_max": -10.746486690447437, "episode_return_min": -1249.673627900664, "episode_return_mean": -682.3272857021414, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.48901694357335, "num_env_steps_trained_throughput_per_sec": 299.48901694357335, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13349.461, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13349.381, "sample_time_ms": 1037.413, "learn_time_ms": 12246.192, "learn_throughput": 326.632, "synch_weights_time_ms": 64.954}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00002", "date": "2024-08-03_10-29-49", "timestamp": 1722661189, "time_this_iter_s": 13.368272304534912, "time_total_s": 276.8397078514099, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00be050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 276.8397078514099, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.442105263157895, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.69610034823418, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.2949786093086004, "policy_loss": -0.01888003396015847, "vf_loss": 2.323435082224508, "vf_explained_var": 0.9941983652611573, "kl": 0.017131338519660252, "entropy": 1.4715843055397273, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -10.746486690447437, "episode_reward_min": -1331.0141537473182, "episode_reward_mean": -680.3250260322873, "episode_len_mean": 136.72, "episode_media": {}, "episodes_timesteps_total": 13672, "policy_reward_min": {"policy_0": -1331.0141537473182}, "policy_reward_max": {"policy_0": -10.746486690447437}, "policy_reward_mean": {"policy_0": -680.3250260322873}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-347.91219273829495, -582.5579053149253, -876.6061445180374, -1154.1273017483622, -489.2792051181379, -10.746486690447437, -561.6220438532465, -368.7800701260148, -1235.6362308085315, -802.0093501274202, -599.8057724864575, -991.3657867721018, -239.24757966891897, -324.1234047007918, -653.8752594948661, -888.9294651370423, -871.3276271703286, -1093.9229757357514, -516.72369541812, -1000.2381447359745, -133.39559362448273, -845.3878572229862, -1126.1835285021864, -700.1905274494272, -976.2439180132583, -877.0839491077154, -890.35426782157, -558.393231095857, -859.865785312263, -546.9397771510237, -853.4466762632152, -926.6820798185041, -258.5338750132853, -899.153132516393, -958.4986659142695, -50.6375590023092, -874.7417023994992, -64.78236407608465, -1094.638189006955, -786.2372156859449, -354.76655450301666, -407.74991871628146, -735.1574730646742, -1229.6143542434534, -876.2922096114097, -495.08373354459576, -807.8554393843099, -738.6923303277366, -817.7108039121588, -764.6981072959965, -784.44426276801, -680.056265178138, -999.9813955845849, -282.85258039473524, -1249.673627900664, -206.3565194370252, -1028.0354795638027, -1071.9283763996593, -174.1016653569932, -973.5763994039044, -703.5681257389658, -775.9463255994679, -779.3495209023619, -934.7223283822572, -1170.5580903795071, -481.08957558641856, -111.59307079566692, -500.2576609425566, -491.84171930487656, -173.36410310484501, -820.135699790435, -1150.2444361618986, -1045.151693325392, -547.1932768932543, -678.3364079313751, -842.6214530502837, -159.56952609284187, -1065.3133818780232, -92.20326430862207, -191.6393345578314, -681.7590315160746, -377.20544009264876, -883.7477849951318, -784.8929587350515, -250.15772450837704, -92.0874021815915, -164.84964647529932, -1077.3737336698189, -184.49271840119934, -67.31594169476922, -1011.7199629553498, -891.9520246772099, -648.5805561538166, -1038.2234943026144, -424.1408607825484, -1076.9306412287592, -1331.0141537473182, -717.6103357970491, -89.4477576672839, -955.4474049677945], "episode_lengths": [150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 97, 95, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 68, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 107, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 107, 150, 150, 150, 150, 150, 150, 83, 150, 77, 123, 150, 141, 150, 150, 118, 75, 96, 150, 74, 79, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150], "policy_policy_0_reward": [-347.91219273829495, -582.5579053149253, -876.6061445180374, -1154.1273017483622, -489.2792051181379, -10.746486690447437, -561.6220438532465, -368.7800701260148, -1235.6362308085315, -802.0093501274202, -599.8057724864575, -991.3657867721018, -239.24757966891897, -324.1234047007918, -653.8752594948661, -888.9294651370423, -871.3276271703286, -1093.9229757357514, -516.72369541812, -1000.2381447359745, -133.39559362448273, -845.3878572229862, -1126.1835285021864, -700.1905274494272, -976.2439180132583, -877.0839491077154, -890.35426782157, -558.393231095857, -859.865785312263, -546.9397771510237, -853.4466762632152, -926.6820798185041, -258.5338750132853, -899.153132516393, -958.4986659142695, -50.6375590023092, -874.7417023994992, -64.78236407608465, -1094.638189006955, -786.2372156859449, -354.76655450301666, -407.74991871628146, -735.1574730646742, -1229.6143542434534, -876.2922096114097, -495.08373354459576, -807.8554393843099, -738.6923303277366, -817.7108039121588, -764.6981072959965, -784.44426276801, -680.056265178138, -999.9813955845849, -282.85258039473524, -1249.673627900664, -206.3565194370252, -1028.0354795638027, -1071.9283763996593, -174.1016653569932, -973.5763994039044, -703.5681257389658, -775.9463255994679, -779.3495209023619, -934.7223283822572, -1170.5580903795071, -481.08957558641856, -111.59307079566692, -500.2576609425566, -491.84171930487656, -173.36410310484501, -820.135699790435, -1150.2444361618986, -1045.151693325392, -547.1932768932543, -678.3364079313751, -842.6214530502837, -159.56952609284187, -1065.3133818780232, -92.20326430862207, -191.6393345578314, -681.7590315160746, -377.20544009264876, -883.7477849951318, -784.8929587350515, -250.15772450837704, -92.0874021815915, -164.84964647529932, -1077.3737336698189, -184.49271840119934, -67.31594169476922, -1011.7199629553498, -891.9520246772099, -648.5805561538166, -1038.2234943026144, -424.1408607825484, -1076.9306412287592, -1331.0141537473182, -717.6103357970491, -89.4477576672839, -955.4474049677945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5579872385492618, "mean_inference_ms": 1.6948403594213173, "mean_action_processing_ms": 0.28090319476444625, "mean_env_wait_ms": 3.029725370225314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012314081192016602, "StateBufferConnector_ms": 0.008053302764892578, "ViewRequirementAgentConnector_ms": 0.19916701316833496}, "num_episodes": 29, "episode_return_max": -10.746486690447437, "episode_return_min": -1331.0141537473182, "episode_return_mean": -680.3250260322873, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.13768854390264, "num_env_steps_trained_throughput_per_sec": 303.13768854390264, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13327.581, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13327.502, "sample_time_ms": 1039.738, "learn_time_ms": 12222.677, "learn_throughput": 327.261, "synch_weights_time_ms": 64.27}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00002", "date": "2024-08-03_10-30-02", "timestamp": 1722661202, "time_this_iter_s": 13.208114862442017, "time_total_s": 290.04782271385193, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf563b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 290.04782271385193, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.226315789473682, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 190.5088370025158, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.8027036064614852, "policy_loss": -0.016287593487262105, "vf_loss": 1.8297465732942024, "vf_explained_var": 0.9958693465838829, "kl": 0.016699638551896594, "entropy": 1.5765259881814322, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -50.6375590023092, "episode_reward_min": -1331.0141537473182, "episode_reward_mean": -665.6989518324555, "episode_len_mean": 135.93, "episode_media": {}, "episodes_timesteps_total": 13593, "policy_reward_min": {"policy_0": -1331.0141537473182}, "policy_reward_max": {"policy_0": -50.6375590023092}, "policy_reward_mean": {"policy_0": -665.6989518324555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-877.0839491077154, -890.35426782157, -558.393231095857, -859.865785312263, -546.9397771510237, -853.4466762632152, -926.6820798185041, -258.5338750132853, -899.153132516393, -958.4986659142695, -50.6375590023092, -874.7417023994992, -64.78236407608465, -1094.638189006955, -786.2372156859449, -354.76655450301666, -407.74991871628146, -735.1574730646742, -1229.6143542434534, -876.2922096114097, -495.08373354459576, -807.8554393843099, -738.6923303277366, -817.7108039121588, -764.6981072959965, -784.44426276801, -680.056265178138, -999.9813955845849, -282.85258039473524, -1249.673627900664, -206.3565194370252, -1028.0354795638027, -1071.9283763996593, -174.1016653569932, -973.5763994039044, -703.5681257389658, -775.9463255994679, -779.3495209023619, -934.7223283822572, -1170.5580903795071, -481.08957558641856, -111.59307079566692, -500.2576609425566, -491.84171930487656, -173.36410310484501, -820.135699790435, -1150.2444361618986, -1045.151693325392, -547.1932768932543, -678.3364079313751, -842.6214530502837, -159.56952609284187, -1065.3133818780232, -92.20326430862207, -191.6393345578314, -681.7590315160746, -377.20544009264876, -883.7477849951318, -784.8929587350515, -250.15772450837704, -92.0874021815915, -164.84964647529932, -1077.3737336698189, -184.49271840119934, -67.31594169476922, -1011.7199629553498, -891.9520246772099, -648.5805561538166, -1038.2234943026144, -424.1408607825484, -1076.9306412287592, -1331.0141537473182, -717.6103357970491, -89.4477576672839, -955.4474049677945, -527.4729325089409, -303.218722479696, -665.49348810761, -825.6137983787613, -306.0490001696856, -407.6244914345012, -650.9385990590422, -281.8579719547852, -141.70293155030174, -400.88449185961287, -51.94752864429107, -1065.9837146755929, -1087.9935342085896, -639.7565827490579, -925.4252140573509, -833.2582465999255, -965.9356866148051, -814.7060562090732, -51.1618619230782, -958.853023811676, -700.4884666568329, -782.6864903436474, -747.5551070146738, -660.1552349064934, -1130.8674712748948], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 68, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 107, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 107, 150, 150, 150, 150, 150, 150, 83, 150, 77, 123, 150, 141, 150, 150, 118, 75, 96, 150, 74, 79, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 113, 150, 150, 150, 150, 150, 90, 77, 119, 58, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-877.0839491077154, -890.35426782157, -558.393231095857, -859.865785312263, -546.9397771510237, -853.4466762632152, -926.6820798185041, -258.5338750132853, -899.153132516393, -958.4986659142695, -50.6375590023092, -874.7417023994992, -64.78236407608465, -1094.638189006955, -786.2372156859449, -354.76655450301666, -407.74991871628146, -735.1574730646742, -1229.6143542434534, -876.2922096114097, -495.08373354459576, -807.8554393843099, -738.6923303277366, -817.7108039121588, -764.6981072959965, -784.44426276801, -680.056265178138, -999.9813955845849, -282.85258039473524, -1249.673627900664, -206.3565194370252, -1028.0354795638027, -1071.9283763996593, -174.1016653569932, -973.5763994039044, -703.5681257389658, -775.9463255994679, -779.3495209023619, -934.7223283822572, -1170.5580903795071, -481.08957558641856, -111.59307079566692, -500.2576609425566, -491.84171930487656, -173.36410310484501, -820.135699790435, -1150.2444361618986, -1045.151693325392, -547.1932768932543, -678.3364079313751, -842.6214530502837, -159.56952609284187, -1065.3133818780232, -92.20326430862207, -191.6393345578314, -681.7590315160746, -377.20544009264876, -883.7477849951318, -784.8929587350515, -250.15772450837704, -92.0874021815915, -164.84964647529932, -1077.3737336698189, -184.49271840119934, -67.31594169476922, -1011.7199629553498, -891.9520246772099, -648.5805561538166, -1038.2234943026144, -424.1408607825484, -1076.9306412287592, -1331.0141537473182, -717.6103357970491, -89.4477576672839, -955.4474049677945, -527.4729325089409, -303.218722479696, -665.49348810761, -825.6137983787613, -306.0490001696856, -407.6244914345012, -650.9385990590422, -281.8579719547852, -141.70293155030174, -400.88449185961287, -51.94752864429107, -1065.9837146755929, -1087.9935342085896, -639.7565827490579, -925.4252140573509, -833.2582465999255, -965.9356866148051, -814.7060562090732, -51.1618619230782, -958.853023811676, -700.4884666568329, -782.6864903436474, -747.5551070146738, -660.1552349064934, -1130.8674712748948]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5581677134532529, "mean_inference_ms": 1.6944716488895049, "mean_action_processing_ms": 0.2807661540423003, "mean_env_wait_ms": 3.0310426276252804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012271881103515625, "StateBufferConnector_ms": 0.007969141006469727, "ViewRequirementAgentConnector_ms": 0.196486234664917}, "num_episodes": 25, "episode_return_max": -50.6375590023092, "episode_return_min": -1331.0141537473182, "episode_return_mean": -665.6989518324555, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.4197746903977, "num_env_steps_trained_throughput_per_sec": 300.4197746903977, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13297.126, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13297.048, "sample_time_ms": 1036.091, "learn_time_ms": 12192.489, "learn_throughput": 328.071, "synch_weights_time_ms": 67.636}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00002", "date": "2024-08-03_10-30-16", "timestamp": 1722661216, "time_this_iter_s": 13.326656818389893, "time_total_s": 303.3744795322418, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0f880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 303.3744795322418, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 14.11578947368421, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 134.05355920592945, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.0636075167606274, "policy_loss": -0.014903985829247783, "vf_loss": 2.0877107123533887, "vf_explained_var": 0.991238218297561, "kl": 0.015383155800615592, "entropy": 1.3814154591411352, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -26.33853962549536, "episode_reward_min": -1331.0141537473182, "episode_reward_mean": -629.421441385792, "episode_len_mean": 133.43, "episode_media": {}, "episodes_timesteps_total": 13343, "policy_reward_min": {"policy_0": -1331.0141537473182}, "policy_reward_max": {"policy_0": -26.33853962549536}, "policy_reward_mean": {"policy_0": -629.421441385792}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-703.5681257389658, -775.9463255994679, -779.3495209023619, -934.7223283822572, -1170.5580903795071, -481.08957558641856, -111.59307079566692, -500.2576609425566, -491.84171930487656, -173.36410310484501, -820.135699790435, -1150.2444361618986, -1045.151693325392, -547.1932768932543, -678.3364079313751, -842.6214530502837, -159.56952609284187, -1065.3133818780232, -92.20326430862207, -191.6393345578314, -681.7590315160746, -377.20544009264876, -883.7477849951318, -784.8929587350515, -250.15772450837704, -92.0874021815915, -164.84964647529932, -1077.3737336698189, -184.49271840119934, -67.31594169476922, -1011.7199629553498, -891.9520246772099, -648.5805561538166, -1038.2234943026144, -424.1408607825484, -1076.9306412287592, -1331.0141537473182, -717.6103357970491, -89.4477576672839, -955.4474049677945, -527.4729325089409, -303.218722479696, -665.49348810761, -825.6137983787613, -306.0490001696856, -407.6244914345012, -650.9385990590422, -281.8579719547852, -141.70293155030174, -400.88449185961287, -51.94752864429107, -1065.9837146755929, -1087.9935342085896, -639.7565827490579, -925.4252140573509, -833.2582465999255, -965.9356866148051, -814.7060562090732, -51.1618619230782, -958.853023811676, -700.4884666568329, -782.6864903436474, -747.5551070146738, -660.1552349064934, -1130.8674712748948, -508.4689290211352, -240.15092513635295, -967.3455823160858, -458.91337345365184, -184.6270349694031, -26.33853962549536, -987.0076785096896, -956.4133811479343, -462.8553596153114, -66.90110483884142, -1099.2340994514711, -720.1421030569575, -760.5384912071916, -610.9654788041855, -731.719273191644, -866.066190424265, -311.99076958818847, -1172.3192783821362, -345.44293354552275, -1018.7231798231513, -705.6480370755214, -513.9942667067536, -722.2814310497465, -41.129698053707216, -892.6308658798267, -745.3330329814289, -1164.5614768534233, -77.74937539372299, -470.6361597709748, -572.6154482797656, -137.2419040467921, -900.9178890721716, -294.615521466586, -788.9366865304683, -1026.4094228401925], "episode_lengths": [150, 150, 150, 150, 150, 150, 73, 150, 150, 107, 150, 150, 150, 150, 150, 150, 83, 150, 77, 123, 150, 141, 150, 150, 118, 75, 96, 150, 74, 79, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 113, 150, 150, 150, 150, 150, 90, 77, 119, 58, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 97, 49, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 99, 150, 91, 150, 150, 150, 150, 59, 150, 150, 150, 72, 150, 150, 93, 150, 134, 150, 150], "policy_policy_0_reward": [-703.5681257389658, -775.9463255994679, -779.3495209023619, -934.7223283822572, -1170.5580903795071, -481.08957558641856, -111.59307079566692, -500.2576609425566, -491.84171930487656, -173.36410310484501, -820.135699790435, -1150.2444361618986, -1045.151693325392, -547.1932768932543, -678.3364079313751, -842.6214530502837, -159.56952609284187, -1065.3133818780232, -92.20326430862207, -191.6393345578314, -681.7590315160746, -377.20544009264876, -883.7477849951318, -784.8929587350515, -250.15772450837704, -92.0874021815915, -164.84964647529932, -1077.3737336698189, -184.49271840119934, -67.31594169476922, -1011.7199629553498, -891.9520246772099, -648.5805561538166, -1038.2234943026144, -424.1408607825484, -1076.9306412287592, -1331.0141537473182, -717.6103357970491, -89.4477576672839, -955.4474049677945, -527.4729325089409, -303.218722479696, -665.49348810761, -825.6137983787613, -306.0490001696856, -407.6244914345012, -650.9385990590422, -281.8579719547852, -141.70293155030174, -400.88449185961287, -51.94752864429107, -1065.9837146755929, -1087.9935342085896, -639.7565827490579, -925.4252140573509, -833.2582465999255, -965.9356866148051, -814.7060562090732, -51.1618619230782, -958.853023811676, -700.4884666568329, -782.6864903436474, -747.5551070146738, -660.1552349064934, -1130.8674712748948, -508.4689290211352, -240.15092513635295, -967.3455823160858, -458.91337345365184, -184.6270349694031, -26.33853962549536, -987.0076785096896, -956.4133811479343, -462.8553596153114, -66.90110483884142, -1099.2340994514711, -720.1421030569575, -760.5384912071916, -610.9654788041855, -731.719273191644, -866.066190424265, -311.99076958818847, -1172.3192783821362, -345.44293354552275, -1018.7231798231513, -705.6480370755214, -513.9942667067536, -722.2814310497465, -41.129698053707216, -892.6308658798267, -745.3330329814289, -1164.5614768534233, -77.74937539372299, -470.6361597709748, -572.6154482797656, -137.2419040467921, -900.9178890721716, -294.615521466586, -788.9366865304683, -1026.4094228401925]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577467826111839, "mean_inference_ms": 1.6930814681926614, "mean_action_processing_ms": 0.2806471494134275, "mean_env_wait_ms": 3.0317480365824103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01239156723022461, "StateBufferConnector_ms": 0.007996320724487305, "ViewRequirementAgentConnector_ms": 0.19722843170166016}, "num_episodes": 35, "episode_return_max": -26.33853962549536, "episode_return_min": -1331.0141537473182, "episode_return_mean": -629.421441385792, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.9056545141593, "num_env_steps_trained_throughput_per_sec": 298.9056545141593, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13281.193, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13281.113, "sample_time_ms": 1038.508, "learn_time_ms": 12172.14, "learn_throughput": 328.619, "synch_weights_time_ms": 69.599}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00002", "date": "2024-08-03_10-30-29", "timestamp": 1722661229, "time_this_iter_s": 13.39512848854065, "time_total_s": 316.76960802078247, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf54e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 316.76960802078247, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 14.200000000000001, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 142.23423061966895, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.945989356872936, "policy_loss": -0.0178471000030792, "vf_loss": 1.9721480819086235, "vf_explained_var": 0.9905232435713212, "kl": 0.01935422155481018, "entropy": 1.4117893860985835, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -22.762699251027612, "episode_reward_min": -1331.0141537473182, "episode_reward_mean": -634.7080223951976, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"policy_0": -1331.0141537473182}, "policy_reward_max": {"policy_0": -22.762699251027612}, "policy_reward_mean": {"policy_0": -634.7080223951976}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-648.5805561538166, -1038.2234943026144, -424.1408607825484, -1076.9306412287592, -1331.0141537473182, -717.6103357970491, -89.4477576672839, -955.4474049677945, -527.4729325089409, -303.218722479696, -665.49348810761, -825.6137983787613, -306.0490001696856, -407.6244914345012, -650.9385990590422, -281.8579719547852, -141.70293155030174, -400.88449185961287, -51.94752864429107, -1065.9837146755929, -1087.9935342085896, -639.7565827490579, -925.4252140573509, -833.2582465999255, -965.9356866148051, -814.7060562090732, -51.1618619230782, -958.853023811676, -700.4884666568329, -782.6864903436474, -747.5551070146738, -660.1552349064934, -1130.8674712748948, -508.4689290211352, -240.15092513635295, -967.3455823160858, -458.91337345365184, -184.6270349694031, -26.33853962549536, -987.0076785096896, -956.4133811479343, -462.8553596153114, -66.90110483884142, -1099.2340994514711, -720.1421030569575, -760.5384912071916, -610.9654788041855, -731.719273191644, -866.066190424265, -311.99076958818847, -1172.3192783821362, -345.44293354552275, -1018.7231798231513, -705.6480370755214, -513.9942667067536, -722.2814310497465, -41.129698053707216, -892.6308658798267, -745.3330329814289, -1164.5614768534233, -77.74937539372299, -470.6361597709748, -572.6154482797656, -137.2419040467921, -900.9178890721716, -294.615521466586, -788.9366865304683, -1026.4094228401925, -578.4936378556588, -775.6048689856884, -542.7388098591547, -737.706062106574, -476.679530039688, -892.1409121036659, -633.4510745780491, -931.4203676292192, -871.5241061612222, -815.4392728681827, -516.6399630768993, -386.40649455195705, -394.6479740458958, -902.3972599790206, -768.6098093540812, -1053.7514760722802, -485.7240172016036, -106.31010624682028, -835.6799036831782, -908.7675375907874, -774.5366852489747, -481.09758645370084, -315.30467958126303, -433.4362743191094, -859.9288608533245, -928.1569389425108, -22.762699251027612, -772.6279890282818, -687.4409812503908, -93.4749871054792, -549.0338439609484, -178.97675558533166], "episode_lengths": [150, 150, 150, 150, 150, 150, 78, 150, 150, 113, 150, 150, 150, 150, 150, 90, 77, 119, 58, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 97, 49, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 99, 150, 91, 150, 150, 150, 150, 59, 150, 150, 150, 72, 150, 150, 93, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 105, 150, 150, 150, 149, 84, 150, 150, 150, 150, 86, 150, 150, 150, 46, 150, 150, 80, 132, 89], "policy_policy_0_reward": [-648.5805561538166, -1038.2234943026144, -424.1408607825484, -1076.9306412287592, -1331.0141537473182, -717.6103357970491, -89.4477576672839, -955.4474049677945, -527.4729325089409, -303.218722479696, -665.49348810761, -825.6137983787613, -306.0490001696856, -407.6244914345012, -650.9385990590422, -281.8579719547852, -141.70293155030174, -400.88449185961287, -51.94752864429107, -1065.9837146755929, -1087.9935342085896, -639.7565827490579, -925.4252140573509, -833.2582465999255, -965.9356866148051, -814.7060562090732, -51.1618619230782, -958.853023811676, -700.4884666568329, -782.6864903436474, -747.5551070146738, -660.1552349064934, -1130.8674712748948, -508.4689290211352, -240.15092513635295, -967.3455823160858, -458.91337345365184, -184.6270349694031, -26.33853962549536, -987.0076785096896, -956.4133811479343, -462.8553596153114, -66.90110483884142, -1099.2340994514711, -720.1421030569575, -760.5384912071916, -610.9654788041855, -731.719273191644, -866.066190424265, -311.99076958818847, -1172.3192783821362, -345.44293354552275, -1018.7231798231513, -705.6480370755214, -513.9942667067536, -722.2814310497465, -41.129698053707216, -892.6308658798267, -745.3330329814289, -1164.5614768534233, -77.74937539372299, -470.6361597709748, -572.6154482797656, -137.2419040467921, -900.9178890721716, -294.615521466586, -788.9366865304683, -1026.4094228401925, -578.4936378556588, -775.6048689856884, -542.7388098591547, -737.706062106574, -476.679530039688, -892.1409121036659, -633.4510745780491, -931.4203676292192, -871.5241061612222, -815.4392728681827, -516.6399630768993, -386.40649455195705, -394.6479740458958, -902.3972599790206, -768.6098093540812, -1053.7514760722802, -485.7240172016036, -106.31010624682028, -835.6799036831782, -908.7675375907874, -774.5366852489747, -481.09758645370084, -315.30467958126303, -433.4362743191094, -859.9288608533245, -928.1569389425108, -22.762699251027612, -772.6279890282818, -687.4409812503908, -93.4749871054792, -549.0338439609484, -178.97675558533166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578115317243842, "mean_inference_ms": 1.6924823502248423, "mean_action_processing_ms": 0.2807364076422479, "mean_env_wait_ms": 3.0310399327594304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011914253234863281, "StateBufferConnector_ms": 0.008220672607421875, "ViewRequirementAgentConnector_ms": 0.1974163055419922}, "num_episodes": 32, "episode_return_max": -22.762699251027612, "episode_return_min": -1331.0141537473182, "episode_return_mean": -634.7080223951976, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.1508116850084, "num_env_steps_trained_throughput_per_sec": 298.1508116850084, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13280.025, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13279.946, "sample_time_ms": 1038.363, "learn_time_ms": 12168.383, "learn_throughput": 328.721, "synch_weights_time_ms": 72.325}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00002", "date": "2024-08-03_10-30-43", "timestamp": 1722661243, "time_this_iter_s": 13.430131435394287, "time_total_s": 330.19973945617676, "pid": 508529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a0109fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 330.19973945617676, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 12.965, "ram_util_percent": 27.600000000000005}}
