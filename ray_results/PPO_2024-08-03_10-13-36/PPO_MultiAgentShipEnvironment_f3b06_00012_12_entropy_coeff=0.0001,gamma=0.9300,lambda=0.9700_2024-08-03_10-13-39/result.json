{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.071020011138171, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.564346547921499, "policy_loss": -0.0066385652443083625, "vf_loss": 9.569036188721658, "vf_explained_var": 0.020150453162690003, "kl": 0.010455293534755583, "entropy": 1.4215356717507044, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -143.99862174047996, "episode_reward_min": -1191.938266116073, "episode_reward_mean": -763.065787003449, "episode_len_mean": 143.34782608695653, "episode_media": {}, "episodes_timesteps_total": 3297, "policy_reward_min": {"policy_0": -1191.938266116073}, "policy_reward_max": {"policy_0": -143.99862174047996}, "policy_reward_mean": {"policy_0": -763.065787003449}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-950.6286996056571, -1189.178450787551, -1191.938266116073, -830.9714842651508, -1158.7583070988214, -573.5014889433072, -830.9417726272843, -378.086085760525, -151.80736934015331, -609.0886742715638, -787.8950552043399, -811.6660843328597, -1050.7250747547066, -402.49358935124707, -143.99862174047996, -902.1747913793656, -766.9409531160841, -1107.5999850095752, -767.2548541689987, -572.6357562876562, -773.9852976675427, -765.7360146616307, -832.5064245887522], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 123, 100, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-950.6286996056571, -1189.178450787551, -1191.938266116073, -830.9714842651508, -1158.7583070988214, -573.5014889433072, -830.9417726272843, -378.086085760525, -151.80736934015331, -609.0886742715638, -787.8950552043399, -811.6660843328597, -1050.7250747547066, -402.49358935124707, -143.99862174047996, -902.1747913793656, -766.9409531160841, -1107.5999850095752, -767.2548541689987, -572.6357562876562, -773.9852976675427, -765.7360146616307, -832.5064245887522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5609545051017495, "mean_inference_ms": 1.653591365913614, "mean_action_processing_ms": 0.2796413063228517, "mean_env_wait_ms": 2.9184835411764065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01218526259712551, "StateBufferConnector_ms": 0.0075982964557150135, "ViewRequirementAgentConnector_ms": 0.1759456551593283}, "num_episodes": 23, "episode_return_max": -143.99862174047996, "episode_return_min": -1191.938266116073, "episode_return_mean": -763.065787003449, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 462.1065269496192, "num_env_steps_trained_throughput_per_sec": 462.1065269496192, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 8656.024, "restore_workers_time_ms": 0.028, "training_step_time_ms": 8655.954, "sample_time_ms": 1001.413, "learn_time_ms": 7606.874, "learn_throughput": 525.84, "synch_weights_time_ms": 46.983}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00012", "date": "2024-08-03_11-22-02", "timestamp": 1722664322, "time_this_iter_s": 8.666779518127441, "time_total_s": 8.666779518127441, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b3010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8.666779518127441, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 15.869230769230768, "ram_util_percent": 27.5923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.507782607867072, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.316753286123276, "policy_loss": -0.012014435842866078, "vf_loss": 9.325918273131053, "vf_explained_var": 0.0693199119841059, "kl": 0.014984637866306608, "entropy": 1.4746350169181823, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -29.51800832744753, "episode_reward_min": -1191.938266116073, "episode_reward_mean": -623.559275413964, "episode_len_mean": 134.77551020408163, "episode_media": {}, "episodes_timesteps_total": 6604, "policy_reward_min": {"policy_0": -1191.938266116073}, "policy_reward_max": {"policy_0": -29.51800832744753}, "policy_reward_mean": {"policy_0": -623.559275413964}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-950.6286996056571, -1189.178450787551, -1191.938266116073, -830.9714842651508, -1158.7583070988214, -573.5014889433072, -830.9417726272843, -378.086085760525, -151.80736934015331, -609.0886742715638, -787.8950552043399, -811.6660843328597, -1050.7250747547066, -402.49358935124707, -143.99862174047996, -902.1747913793656, -766.9409531160841, -1107.5999850095752, -767.2548541689987, -572.6357562876562, -773.9852976675427, -765.7360146616307, -832.5064245887522, -75.27708486018874, -522.3137268107047, -370.03879565267147, -666.2908818861847, -388.06259138273015, -950.3550898025666, -190.95182136042584, -257.69314970558764, -192.01140833935955, -1010.5980517477101, -711.283583284391, -29.51800832744753, -906.0957258379781, -440.0561196711735, -648.7380347447137, -864.8711451914096, -94.92724060515748, -706.8100604718325, -416.57872152633615, -95.70883689148302, -753.9910124455741, -177.4974329350476, -413.27713152788505, -447.2327382939897, -1002.054570540317, -671.6584303620426], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 123, 100, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 79, 104, 118, 150, 137, 63, 150, 150, 150, 150, 67, 150, 120, 58, 150, 87, 150, 150, 150, 150], "policy_policy_0_reward": [-950.6286996056571, -1189.178450787551, -1191.938266116073, -830.9714842651508, -1158.7583070988214, -573.5014889433072, -830.9417726272843, -378.086085760525, -151.80736934015331, -609.0886742715638, -787.8950552043399, -811.6660843328597, -1050.7250747547066, -402.49358935124707, -143.99862174047996, -902.1747913793656, -766.9409531160841, -1107.5999850095752, -767.2548541689987, -572.6357562876562, -773.9852976675427, -765.7360146616307, -832.5064245887522, -75.27708486018874, -522.3137268107047, -370.03879565267147, -666.2908818861847, -388.06259138273015, -950.3550898025666, -190.95182136042584, -257.69314970558764, -192.01140833935955, -1010.5980517477101, -711.283583284391, -29.51800832744753, -906.0957258379781, -440.0561196711735, -648.7380347447137, -864.8711451914096, -94.92724060515748, -706.8100604718325, -416.57872152633615, -95.70883689148302, -753.9910124455741, -177.4974329350476, -413.27713152788505, -447.2327382939897, -1002.054570540317, -671.6584303620426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551930293801144, "mean_inference_ms": 1.6476456552128864, "mean_action_processing_ms": 0.27863327067794713, "mean_env_wait_ms": 2.9112168227815816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013629757628148916, "StateBufferConnector_ms": 0.00787219222711057, "ViewRequirementAgentConnector_ms": 0.1779454095023019}, "num_episodes": 26, "episode_return_max": -29.51800832744753, "episode_return_min": -1191.938266116073, "episode_return_mean": -623.559275413964, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.32780583513807, "num_env_steps_trained_throughput_per_sec": 302.32780583513807, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 10943.353, "restore_workers_time_ms": 0.025, "training_step_time_ms": 10943.286, "sample_time_ms": 992.808, "learn_time_ms": 9890.205, "learn_throughput": 404.441, "synch_weights_time_ms": 59.48}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00012", "date": "2024-08-03_11-22-15", "timestamp": 1722664335, "time_this_iter_s": 13.242008447647095, "time_total_s": 21.908787965774536, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b2b00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21.908787965774536, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.863157894736844, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9651277225464583, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.106693965196609, "policy_loss": -0.012498001839170077, "vf_loss": 9.116143791874249, "vf_explained_var": 0.140141788435479, "kl": 0.016002376865374878, "entropy": 1.5230256085594496, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -29.51800832744753, "episode_reward_min": -1259.4642040138365, "episode_reward_mean": -671.8791108000021, "episode_len_mean": 136.62666666666667, "episode_media": {}, "episodes_timesteps_total": 10247, "policy_reward_min": {"policy_0": -1259.4642040138365}, "policy_reward_max": {"policy_0": -29.51800832744753}, "policy_reward_mean": {"policy_0": -671.8791108000021}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-950.6286996056571, -1189.178450787551, -1191.938266116073, -830.9714842651508, -1158.7583070988214, -573.5014889433072, -830.9417726272843, -378.086085760525, -151.80736934015331, -609.0886742715638, -787.8950552043399, -811.6660843328597, -1050.7250747547066, -402.49358935124707, -143.99862174047996, -902.1747913793656, -766.9409531160841, -1107.5999850095752, -767.2548541689987, -572.6357562876562, -773.9852976675427, -765.7360146616307, -832.5064245887522, -75.27708486018874, -522.3137268107047, -370.03879565267147, -666.2908818861847, -388.06259138273015, -950.3550898025666, -190.95182136042584, -257.69314970558764, -192.01140833935955, -1010.5980517477101, -711.283583284391, -29.51800832744753, -906.0957258379781, -440.0561196711735, -648.7380347447137, -864.8711451914096, -94.92724060515748, -706.8100604718325, -416.57872152633615, -95.70883689148302, -753.9910124455741, -177.4974329350476, -413.27713152788505, -447.2327382939897, -1002.054570540317, -671.6584303620426, -821.8765936382099, -1203.665186820869, -1259.4642040138365, -873.3753990994852, -1206.7918577188009, -713.2273266735067, -121.53412759796294, -953.8665410229969, -807.8504143144013, -282.31119010803496, -40.78534870120705, -325.3673864199629, -1071.439051145352, -1082.8405473195492, -874.5134582029065, -740.4485286829788, -388.8792792067877, -1066.6687326629312, -860.9418000862378, -840.6781075491152, -857.3082099840506, -300.34365099316744, -943.21025025417, -941.8200324482742, -719.4142032088453, -537.9073868422856], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 123, 100, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 79, 104, 118, 150, 137, 63, 150, 150, 150, 150, 67, 150, 120, 58, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 79, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-950.6286996056571, -1189.178450787551, -1191.938266116073, -830.9714842651508, -1158.7583070988214, -573.5014889433072, -830.9417726272843, -378.086085760525, -151.80736934015331, -609.0886742715638, -787.8950552043399, -811.6660843328597, -1050.7250747547066, -402.49358935124707, -143.99862174047996, -902.1747913793656, -766.9409531160841, -1107.5999850095752, -767.2548541689987, -572.6357562876562, -773.9852976675427, -765.7360146616307, -832.5064245887522, -75.27708486018874, -522.3137268107047, -370.03879565267147, -666.2908818861847, -388.06259138273015, -950.3550898025666, -190.95182136042584, -257.69314970558764, -192.01140833935955, -1010.5980517477101, -711.283583284391, -29.51800832744753, -906.0957258379781, -440.0561196711735, -648.7380347447137, -864.8711451914096, -94.92724060515748, -706.8100604718325, -416.57872152633615, -95.70883689148302, -753.9910124455741, -177.4974329350476, -413.27713152788505, -447.2327382939897, -1002.054570540317, -671.6584303620426, -821.8765936382099, -1203.665186820869, -1259.4642040138365, -873.3753990994852, -1206.7918577188009, -713.2273266735067, -121.53412759796294, -953.8665410229969, -807.8504143144013, -282.31119010803496, -40.78534870120705, -325.3673864199629, -1071.439051145352, -1082.8405473195492, -874.5134582029065, -740.4485286829788, -388.8792792067877, -1066.6687326629312, -860.9418000862378, -840.6781075491152, -857.3082099840506, -300.34365099316744, -943.21025025417, -941.8200324482742, -719.4142032088453, -537.9073868422856]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554019877690047, "mean_inference_ms": 1.6489770316678787, "mean_action_processing_ms": 0.2790499529616809, "mean_env_wait_ms": 2.9182818260614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013080596923828125, "StateBufferConnector_ms": 0.008056004842122396, "ViewRequirementAgentConnector_ms": 0.1814419428507487}, "num_episodes": 26, "episode_return_max": -29.51800832744753, "episode_return_min": -1259.4642040138365, "episode_return_mean": -671.8791108000021, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.52987042786157, "num_env_steps_trained_throughput_per_sec": 289.52987042786157, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11900.739, "restore_workers_time_ms": 0.024, "training_step_time_ms": 11900.673, "sample_time_ms": 999.146, "learn_time_ms": 10838.066, "learn_throughput": 369.07, "synch_weights_time_ms": 62.621}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00012", "date": "2024-08-03_11-22-29", "timestamp": 1722664349, "time_this_iter_s": 13.828267335891724, "time_total_s": 35.73705530166626, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457603a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 35.73705530166626, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.657894736842104, "ram_util_percent": 27.610526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.365929472011825, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.268966913223267, "policy_loss": -0.010489689363263702, "vf_loss": 8.27698770960172, "vf_explained_var": 0.2297421627988418, "kl": 0.013101570112545839, "entropy": 1.5142535763482252, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -29.51800832744753, "episode_reward_min": -1259.4642040138365, "episode_reward_mean": -673.0932357787864, "episode_len_mean": 136.92, "episode_media": {}, "episodes_timesteps_total": 13692, "policy_reward_min": {"policy_0": -1259.4642040138365}, "policy_reward_max": {"policy_0": -29.51800832744753}, "policy_reward_mean": {"policy_0": -673.0932357787864}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1158.7583070988214, -573.5014889433072, -830.9417726272843, -378.086085760525, -151.80736934015331, -609.0886742715638, -787.8950552043399, -811.6660843328597, -1050.7250747547066, -402.49358935124707, -143.99862174047996, -902.1747913793656, -766.9409531160841, -1107.5999850095752, -767.2548541689987, -572.6357562876562, -773.9852976675427, -765.7360146616307, -832.5064245887522, -75.27708486018874, -522.3137268107047, -370.03879565267147, -666.2908818861847, -388.06259138273015, -950.3550898025666, -190.95182136042584, -257.69314970558764, -192.01140833935955, -1010.5980517477101, -711.283583284391, -29.51800832744753, -906.0957258379781, -440.0561196711735, -648.7380347447137, -864.8711451914096, -94.92724060515748, -706.8100604718325, -416.57872152633615, -95.70883689148302, -753.9910124455741, -177.4974329350476, -413.27713152788505, -447.2327382939897, -1002.054570540317, -671.6584303620426, -821.8765936382099, -1203.665186820869, -1259.4642040138365, -873.3753990994852, -1206.7918577188009, -713.2273266735067, -121.53412759796294, -953.8665410229969, -807.8504143144013, -282.31119010803496, -40.78534870120705, -325.3673864199629, -1071.439051145352, -1082.8405473195492, -874.5134582029065, -740.4485286829788, -388.8792792067877, -1066.6687326629312, -860.9418000862378, -840.6781075491152, -857.3082099840506, -300.34365099316744, -943.21025025417, -941.8200324482742, -719.4142032088453, -537.9073868422856, -1127.946937989148, -175.71432889961633, -852.9695803485696, -1046.4189804052846, -757.1274028654298, -779.604304326571, -856.20936314188, -1083.111786170569, -891.6101689798635, -738.8315634587259, -867.1859508977601, -996.5577773401901, -521.9422780693598, -1131.5092072747648, -664.5270030874839, -792.7850313512929, -253.54878241526364, -1240.7617342025994, -1105.8225705020006, -329.2321324498464, -438.8126998555285, -313.25822549275676, -442.6502897122213, -534.0753234776587, -874.0711819622867, -62.81719261949624, -600.4470489418759, -676.867385841524, -924.6909365733346], "episode_lengths": [150, 150, 150, 150, 74, 150, 150, 150, 150, 123, 100, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 79, 104, 118, 150, 137, 63, 150, 150, 150, 150, 67, 150, 120, 58, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 79, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 91, 130, 97, 150, 150, 150, 74, 150, 150, 150], "policy_policy_0_reward": [-1158.7583070988214, -573.5014889433072, -830.9417726272843, -378.086085760525, -151.80736934015331, -609.0886742715638, -787.8950552043399, -811.6660843328597, -1050.7250747547066, -402.49358935124707, -143.99862174047996, -902.1747913793656, -766.9409531160841, -1107.5999850095752, -767.2548541689987, -572.6357562876562, -773.9852976675427, -765.7360146616307, -832.5064245887522, -75.27708486018874, -522.3137268107047, -370.03879565267147, -666.2908818861847, -388.06259138273015, -950.3550898025666, -190.95182136042584, -257.69314970558764, -192.01140833935955, -1010.5980517477101, -711.283583284391, -29.51800832744753, -906.0957258379781, -440.0561196711735, -648.7380347447137, -864.8711451914096, -94.92724060515748, -706.8100604718325, -416.57872152633615, -95.70883689148302, -753.9910124455741, -177.4974329350476, -413.27713152788505, -447.2327382939897, -1002.054570540317, -671.6584303620426, -821.8765936382099, -1203.665186820869, -1259.4642040138365, -873.3753990994852, -1206.7918577188009, -713.2273266735067, -121.53412759796294, -953.8665410229969, -807.8504143144013, -282.31119010803496, -40.78534870120705, -325.3673864199629, -1071.439051145352, -1082.8405473195492, -874.5134582029065, -740.4485286829788, -388.8792792067877, -1066.6687326629312, -860.9418000862378, -840.6781075491152, -857.3082099840506, -300.34365099316744, -943.21025025417, -941.8200324482742, -719.4142032088453, -537.9073868422856, -1127.946937989148, -175.71432889961633, -852.9695803485696, -1046.4189804052846, -757.1274028654298, -779.604304326571, -856.20936314188, -1083.111786170569, -891.6101689798635, -738.8315634587259, -867.1859508977601, -996.5577773401901, -521.9422780693598, -1131.5092072747648, -664.5270030874839, -792.7850313512929, -253.54878241526364, -1240.7617342025994, -1105.8225705020006, -329.2321324498464, -438.8126998555285, -313.25822549275676, -442.6502897122213, -534.0753234776587, -874.0711819622867, -62.81719261949624, -600.4470489418759, -676.867385841524, -924.6909365733346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5529693016422573, "mean_inference_ms": 1.6547935280742718, "mean_action_processing_ms": 0.2800518819838385, "mean_env_wait_ms": 2.9283484157898574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013959884643554688, "StateBufferConnector_ms": 0.008273601531982422, "ViewRequirementAgentConnector_ms": 0.18454957008361816}, "num_episodes": 29, "episode_return_max": -29.51800832744753, "episode_return_min": -1259.4642040138365, "episode_return_mean": -673.0932357787864, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.6331468589746, "num_env_steps_trained_throughput_per_sec": 302.6331468589746, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12229.892, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12229.821, "sample_time_ms": 1007.065, "learn_time_ms": 11154.269, "learn_throughput": 358.607, "synch_weights_time_ms": 67.604}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00012", "date": "2024-08-03_11-22-43", "timestamp": 1722664363, "time_this_iter_s": 13.230128049850464, "time_total_s": 48.967183351516724, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245760430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 48.967183351516724, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.821052631578949, "ram_util_percent": 27.694736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.765862579147022, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.72689543068409, "policy_loss": -0.010917503387706045, "vf_loss": 7.734895066916943, "vf_explained_var": 0.43375434397409357, "kl": 0.015377602319009991, "entropy": 1.5765093119194111, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -16.808797367669598, "episode_reward_min": -1308.1045000159093, "episode_reward_mean": -693.8788654928728, "episode_len_mean": 135.78, "episode_media": {}, "episodes_timesteps_total": 13578, "policy_reward_min": {"policy_0": -1308.1045000159093}, "policy_reward_max": {"policy_0": -16.808797367669598}, "policy_reward_mean": {"policy_0": -693.8788654928728}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1010.5980517477101, -711.283583284391, -29.51800832744753, -906.0957258379781, -440.0561196711735, -648.7380347447137, -864.8711451914096, -94.92724060515748, -706.8100604718325, -416.57872152633615, -95.70883689148302, -753.9910124455741, -177.4974329350476, -413.27713152788505, -447.2327382939897, -1002.054570540317, -671.6584303620426, -821.8765936382099, -1203.665186820869, -1259.4642040138365, -873.3753990994852, -1206.7918577188009, -713.2273266735067, -121.53412759796294, -953.8665410229969, -807.8504143144013, -282.31119010803496, -40.78534870120705, -325.3673864199629, -1071.439051145352, -1082.8405473195492, -874.5134582029065, -740.4485286829788, -388.8792792067877, -1066.6687326629312, -860.9418000862378, -840.6781075491152, -857.3082099840506, -300.34365099316744, -943.21025025417, -941.8200324482742, -719.4142032088453, -537.9073868422856, -1127.946937989148, -175.71432889961633, -852.9695803485696, -1046.4189804052846, -757.1274028654298, -779.604304326571, -856.20936314188, -1083.111786170569, -891.6101689798635, -738.8315634587259, -867.1859508977601, -996.5577773401901, -521.9422780693598, -1131.5092072747648, -664.5270030874839, -792.7850313512929, -253.54878241526364, -1240.7617342025994, -1105.8225705020006, -329.2321324498464, -438.8126998555285, -313.25822549275676, -442.6502897122213, -534.0753234776587, -874.0711819622867, -62.81719261949624, -600.4470489418759, -676.867385841524, -924.6909365733346, -879.3566697187817, -595.6636812595699, -776.332511025243, -150.63684340174052, -669.1718941084731, -871.221217855093, -873.679001938211, -1100.7319265912763, -656.5916679254152, -34.86992655716538, -1174.5356486503345, -875.5918860568911, -547.4834527150203, -737.6166895386663, -1005.9684633844654, -937.4502703379295, -306.08330748423396, -767.1577424972845, -271.822991136497, -871.8211362126054, -407.5698247396007, -16.808797367669598, -549.8331511127967, -367.01200694060776, -1308.1045000159093, -454.6181094308243, -1248.1344175681425, -623.4859859435293], "episode_lengths": [150, 137, 63, 150, 150, 150, 150, 67, 150, 120, 58, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 79, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 91, 130, 97, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 71, 150, 150, 150, 142, 150, 150, 99, 150, 88, 150, 150, 37, 130, 99, 150, 108, 150, 132], "policy_policy_0_reward": [-1010.5980517477101, -711.283583284391, -29.51800832744753, -906.0957258379781, -440.0561196711735, -648.7380347447137, -864.8711451914096, -94.92724060515748, -706.8100604718325, -416.57872152633615, -95.70883689148302, -753.9910124455741, -177.4974329350476, -413.27713152788505, -447.2327382939897, -1002.054570540317, -671.6584303620426, -821.8765936382099, -1203.665186820869, -1259.4642040138365, -873.3753990994852, -1206.7918577188009, -713.2273266735067, -121.53412759796294, -953.8665410229969, -807.8504143144013, -282.31119010803496, -40.78534870120705, -325.3673864199629, -1071.439051145352, -1082.8405473195492, -874.5134582029065, -740.4485286829788, -388.8792792067877, -1066.6687326629312, -860.9418000862378, -840.6781075491152, -857.3082099840506, -300.34365099316744, -943.21025025417, -941.8200324482742, -719.4142032088453, -537.9073868422856, -1127.946937989148, -175.71432889961633, -852.9695803485696, -1046.4189804052846, -757.1274028654298, -779.604304326571, -856.20936314188, -1083.111786170569, -891.6101689798635, -738.8315634587259, -867.1859508977601, -996.5577773401901, -521.9422780693598, -1131.5092072747648, -664.5270030874839, -792.7850313512929, -253.54878241526364, -1240.7617342025994, -1105.8225705020006, -329.2321324498464, -438.8126998555285, -313.25822549275676, -442.6502897122213, -534.0753234776587, -874.0711819622867, -62.81719261949624, -600.4470489418759, -676.867385841524, -924.6909365733346, -879.3566697187817, -595.6636812595699, -776.332511025243, -150.63684340174052, -669.1718941084731, -871.221217855093, -873.679001938211, -1100.7319265912763, -656.5916679254152, -34.86992655716538, -1174.5356486503345, -875.5918860568911, -547.4834527150203, -737.6166895386663, -1005.9684633844654, -937.4502703379295, -306.08330748423396, -767.1577424972845, -271.822991136497, -871.8211362126054, -407.5698247396007, -16.808797367669598, -549.8331511127967, -367.01200694060776, -1308.1045000159093, -454.6181094308243, -1248.1344175681425, -623.4859859435293]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5496655312247181, "mean_inference_ms": 1.6577207986030038, "mean_action_processing_ms": 0.2804775315797077, "mean_env_wait_ms": 2.938912549913259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013460397720336914, "StateBufferConnector_ms": 0.008383989334106445, "ViewRequirementAgentConnector_ms": 0.18620777130126953}, "num_episodes": 28, "episode_return_max": -16.808797367669598, "episode_return_min": -1308.1045000159093, "episode_return_mean": -693.8788654928728, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.1849930376355, "num_env_steps_trained_throughput_per_sec": 294.1849930376355, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12503.293, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12503.218, "sample_time_ms": 1007.493, "learn_time_ms": 11424.669, "learn_throughput": 350.12, "synch_weights_time_ms": 70.162}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00012", "date": "2024-08-03_11-22-56", "timestamp": 1722664376, "time_this_iter_s": 13.610054969787598, "time_total_s": 62.57723832130432, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244526440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.57723832130432, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.429999999999998, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.4413039803505, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.224337922533353, "policy_loss": -0.017980860749958083, "vf_loss": 6.238302041093508, "vf_explained_var": 0.7634056436518828, "kl": 0.020876403447133884, "entropy": 1.5853495062639316, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -16.808797367669598, "episode_reward_min": -1308.1045000159093, "episode_reward_mean": -721.429295579449, "episode_len_mean": 138.33, "episode_media": {}, "episodes_timesteps_total": 13833, "policy_reward_min": {"policy_0": -1308.1045000159093}, "policy_reward_max": {"policy_0": -16.808797367669598}, "policy_reward_mean": {"policy_0": -721.429295579449}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1071.439051145352, -1082.8405473195492, -874.5134582029065, -740.4485286829788, -388.8792792067877, -1066.6687326629312, -860.9418000862378, -840.6781075491152, -857.3082099840506, -300.34365099316744, -943.21025025417, -941.8200324482742, -719.4142032088453, -537.9073868422856, -1127.946937989148, -175.71432889961633, -852.9695803485696, -1046.4189804052846, -757.1274028654298, -779.604304326571, -856.20936314188, -1083.111786170569, -891.6101689798635, -738.8315634587259, -867.1859508977601, -996.5577773401901, -521.9422780693598, -1131.5092072747648, -664.5270030874839, -792.7850313512929, -253.54878241526364, -1240.7617342025994, -1105.8225705020006, -329.2321324498464, -438.8126998555285, -313.25822549275676, -442.6502897122213, -534.0753234776587, -874.0711819622867, -62.81719261949624, -600.4470489418759, -676.867385841524, -924.6909365733346, -879.3566697187817, -595.6636812595699, -776.332511025243, -150.63684340174052, -669.1718941084731, -871.221217855093, -873.679001938211, -1100.7319265912763, -656.5916679254152, -34.86992655716538, -1174.5356486503345, -875.5918860568911, -547.4834527150203, -737.6166895386663, -1005.9684633844654, -937.4502703379295, -306.08330748423396, -767.1577424972845, -271.822991136497, -871.8211362126054, -407.5698247396007, -16.808797367669598, -549.8331511127967, -367.01200694060776, -1308.1045000159093, -454.6181094308243, -1248.1344175681425, -623.4859859435293, -855.5412063650936, -829.6409372281023, -743.0360326903841, -907.3711582489009, -323.5168571407854, -1216.943808302123, -1246.3503549863633, -987.9951793926318, -289.71861442546015, -1028.446724115062, -663.8848017986503, -616.4351397679784, -533.7958288467667, -1016.5803850549803, -879.7178879437668, -993.6856702815171, -828.7397180585328, -578.7581809848398, -595.3772061498872, -812.7913206788809, -87.14977060567715, -51.29427096381313, -694.6493855692038, -1220.3255984394136, -376.8798496566333, -1028.4946952457542, -190.90830071614036, -854.7032516362201, -303.3232938977951], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 91, 130, 97, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 71, 150, 150, 150, 142, 150, 150, 99, 150, 88, 150, 150, 37, 130, 99, 150, 108, 150, 132, 150, 150, 150, 150, 103, 150, 150, 150, 125, 150, 150, 122, 137, 150, 150, 150, 150, 150, 150, 150, 70, 63, 150, 150, 114, 150, 120, 150, 126], "policy_policy_0_reward": [-1071.439051145352, -1082.8405473195492, -874.5134582029065, -740.4485286829788, -388.8792792067877, -1066.6687326629312, -860.9418000862378, -840.6781075491152, -857.3082099840506, -300.34365099316744, -943.21025025417, -941.8200324482742, -719.4142032088453, -537.9073868422856, -1127.946937989148, -175.71432889961633, -852.9695803485696, -1046.4189804052846, -757.1274028654298, -779.604304326571, -856.20936314188, -1083.111786170569, -891.6101689798635, -738.8315634587259, -867.1859508977601, -996.5577773401901, -521.9422780693598, -1131.5092072747648, -664.5270030874839, -792.7850313512929, -253.54878241526364, -1240.7617342025994, -1105.8225705020006, -329.2321324498464, -438.8126998555285, -313.25822549275676, -442.6502897122213, -534.0753234776587, -874.0711819622867, -62.81719261949624, -600.4470489418759, -676.867385841524, -924.6909365733346, -879.3566697187817, -595.6636812595699, -776.332511025243, -150.63684340174052, -669.1718941084731, -871.221217855093, -873.679001938211, -1100.7319265912763, -656.5916679254152, -34.86992655716538, -1174.5356486503345, -875.5918860568911, -547.4834527150203, -737.6166895386663, -1005.9684633844654, -937.4502703379295, -306.08330748423396, -767.1577424972845, -271.822991136497, -871.8211362126054, -407.5698247396007, -16.808797367669598, -549.8331511127967, -367.01200694060776, -1308.1045000159093, -454.6181094308243, -1248.1344175681425, -623.4859859435293, -855.5412063650936, -829.6409372281023, -743.0360326903841, -907.3711582489009, -323.5168571407854, -1216.943808302123, -1246.3503549863633, -987.9951793926318, -289.71861442546015, -1028.446724115062, -663.8848017986503, -616.4351397679784, -533.7958288467667, -1016.5803850549803, -879.7178879437668, -993.6856702815171, -828.7397180585328, -578.7581809848398, -595.3772061498872, -812.7913206788809, -87.14977060567715, -51.29427096381313, -694.6493855692038, -1220.3255984394136, -376.8798496566333, -1028.4946952457542, -190.90830071614036, -854.7032516362201, -303.3232938977951]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.549430083461733, "mean_inference_ms": 1.6654874730993736, "mean_action_processing_ms": 0.2815940122183523, "mean_env_wait_ms": 2.955178395173342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01399993896484375, "StateBufferConnector_ms": 0.008550882339477539, "ViewRequirementAgentConnector_ms": 0.18932676315307617}, "num_episodes": 29, "episode_return_max": -16.808797367669598, "episode_return_min": -1308.1045000159093, "episode_return_mean": -721.429295579449, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.4581021073677, "num_env_steps_trained_throughput_per_sec": 329.4581021073677, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12442.938, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12442.863, "sample_time_ms": 1011.323, "learn_time_ms": 11361.321, "learn_throughput": 352.072, "synch_weights_time_ms": 69.331}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00012", "date": "2024-08-03_11-23-08", "timestamp": 1722664388, "time_this_iter_s": 12.153500318527222, "time_total_s": 74.73073863983154, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244527880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 74.73073863983154, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 14.605882352941176, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 66.22128784060479, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.172748448948066, "policy_loss": -0.01487440630638351, "vf_loss": 5.1823544273773825, "vf_explained_var": 0.8685243641957641, "kl": 0.018095250982757233, "entropy": 1.601290004948775, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -16.808797367669598, "episode_reward_min": -1308.1045000159093, "episode_reward_mean": -711.2727745750153, "episode_len_mean": 136.92, "episode_media": {}, "episodes_timesteps_total": 13692, "policy_reward_min": {"policy_0": -1308.1045000159093}, "policy_reward_max": {"policy_0": -16.808797367669598}, "policy_reward_mean": {"policy_0": -711.2727745750153}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-329.2321324498464, -438.8126998555285, -313.25822549275676, -442.6502897122213, -534.0753234776587, -874.0711819622867, -62.81719261949624, -600.4470489418759, -676.867385841524, -924.6909365733346, -879.3566697187817, -595.6636812595699, -776.332511025243, -150.63684340174052, -669.1718941084731, -871.221217855093, -873.679001938211, -1100.7319265912763, -656.5916679254152, -34.86992655716538, -1174.5356486503345, -875.5918860568911, -547.4834527150203, -737.6166895386663, -1005.9684633844654, -937.4502703379295, -306.08330748423396, -767.1577424972845, -271.822991136497, -871.8211362126054, -407.5698247396007, -16.808797367669598, -549.8331511127967, -367.01200694060776, -1308.1045000159093, -454.6181094308243, -1248.1344175681425, -623.4859859435293, -855.5412063650936, -829.6409372281023, -743.0360326903841, -907.3711582489009, -323.5168571407854, -1216.943808302123, -1246.3503549863633, -987.9951793926318, -289.71861442546015, -1028.446724115062, -663.8848017986503, -616.4351397679784, -533.7958288467667, -1016.5803850549803, -879.7178879437668, -993.6856702815171, -828.7397180585328, -578.7581809848398, -595.3772061498872, -812.7913206788809, -87.14977060567715, -51.29427096381313, -694.6493855692038, -1220.3255984394136, -376.8798496566333, -1028.4946952457542, -190.90830071614036, -854.7032516362201, -303.3232938977951, -282.99348218740965, -829.1335847863536, -1123.3940287211985, -192.35453521850374, -1170.080026397217, -386.7242832771928, -966.0909050553031, -1061.3396364983573, -1084.1877340892659, -788.2831528392738, -675.5568306478939, -1244.9971439824221, -850.9959622496782, -812.2197439459766, -1290.280264544136, -812.9417015635404, -136.79035879589333, -113.66083326729823, -919.9070584779819, -963.6852577912219, -805.9994519738939, -1156.3868311245021, -736.5418772100343, -807.9908995323497, -830.7285782229094, -406.40499548815023, -923.4592583564203, -1083.1250355362863, -212.24954997119934, -734.2620806796167, -1171.217326967063, -767.6158906308596, -753.3475898402655], "episode_lengths": [91, 130, 97, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 71, 150, 150, 150, 142, 150, 150, 99, 150, 88, 150, 150, 37, 130, 99, 150, 108, 150, 132, 150, 150, 150, 150, 103, 150, 150, 150, 125, 150, 150, 122, 137, 150, 150, 150, 150, 150, 150, 150, 70, 63, 150, 150, 114, 150, 120, 150, 126, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150], "policy_policy_0_reward": [-329.2321324498464, -438.8126998555285, -313.25822549275676, -442.6502897122213, -534.0753234776587, -874.0711819622867, -62.81719261949624, -600.4470489418759, -676.867385841524, -924.6909365733346, -879.3566697187817, -595.6636812595699, -776.332511025243, -150.63684340174052, -669.1718941084731, -871.221217855093, -873.679001938211, -1100.7319265912763, -656.5916679254152, -34.86992655716538, -1174.5356486503345, -875.5918860568911, -547.4834527150203, -737.6166895386663, -1005.9684633844654, -937.4502703379295, -306.08330748423396, -767.1577424972845, -271.822991136497, -871.8211362126054, -407.5698247396007, -16.808797367669598, -549.8331511127967, -367.01200694060776, -1308.1045000159093, -454.6181094308243, -1248.1344175681425, -623.4859859435293, -855.5412063650936, -829.6409372281023, -743.0360326903841, -907.3711582489009, -323.5168571407854, -1216.943808302123, -1246.3503549863633, -987.9951793926318, -289.71861442546015, -1028.446724115062, -663.8848017986503, -616.4351397679784, -533.7958288467667, -1016.5803850549803, -879.7178879437668, -993.6856702815171, -828.7397180585328, -578.7581809848398, -595.3772061498872, -812.7913206788809, -87.14977060567715, -51.29427096381313, -694.6493855692038, -1220.3255984394136, -376.8798496566333, -1028.4946952457542, -190.90830071614036, -854.7032516362201, -303.3232938977951, -282.99348218740965, -829.1335847863536, -1123.3940287211985, -192.35453521850374, -1170.080026397217, -386.7242832771928, -966.0909050553031, -1061.3396364983573, -1084.1877340892659, -788.2831528392738, -675.5568306478939, -1244.9971439824221, -850.9959622496782, -812.2197439459766, -1290.280264544136, -812.9417015635404, -136.79035879589333, -113.66083326729823, -919.9070584779819, -963.6852577912219, -805.9994519738939, -1156.3868311245021, -736.5418772100343, -807.9908995323497, -830.7285782229094, -406.40499548815023, -923.4592583564203, -1083.1250355362863, -212.24954997119934, -734.2620806796167, -1171.217326967063, -767.6158906308596, -753.3475898402655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5493496757063916, "mean_inference_ms": 1.6702324301469025, "mean_action_processing_ms": 0.28196377668517075, "mean_env_wait_ms": 2.9701067838233137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013648748397827148, "StateBufferConnector_ms": 0.008499622344970703, "ViewRequirementAgentConnector_ms": 0.19391107559204102}, "num_episodes": 33, "episode_return_max": -16.808797367669598, "episode_return_min": -1308.1045000159093, "episode_return_mean": -711.2727745750153, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.1828994014607, "num_env_steps_trained_throughput_per_sec": 414.1828994014607, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12045.03, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12044.955, "sample_time_ms": 1010.795, "learn_time_ms": 10962.537, "learn_throughput": 364.879, "synch_weights_time_ms": 70.738}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00012", "date": "2024-08-03_11-23-18", "timestamp": 1722664398, "time_this_iter_s": 9.670863628387451, "time_total_s": 84.401602268219, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245762b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 84.401602268219, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 16.499999999999996, "ram_util_percent": 27.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 86.6549332588911, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.2274870604276655, "policy_loss": -0.007610935575212352, "vf_loss": 4.231228795399269, "vf_explained_var": 0.8475485943257809, "kl": 0.013406855689906176, "entropy": 1.5286039367318154, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -16.808797367669598, "episode_reward_min": -1432.2995751496685, "episode_reward_mean": -731.0371110396605, "episode_len_mean": 138.91, "episode_media": {}, "episodes_timesteps_total": 13891, "policy_reward_min": {"policy_0": -1432.2995751496685}, "policy_reward_max": {"policy_0": -16.808797367669598}, "policy_reward_mean": {"policy_0": -731.0371110396605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-937.4502703379295, -306.08330748423396, -767.1577424972845, -271.822991136497, -871.8211362126054, -407.5698247396007, -16.808797367669598, -549.8331511127967, -367.01200694060776, -1308.1045000159093, -454.6181094308243, -1248.1344175681425, -623.4859859435293, -855.5412063650936, -829.6409372281023, -743.0360326903841, -907.3711582489009, -323.5168571407854, -1216.943808302123, -1246.3503549863633, -987.9951793926318, -289.71861442546015, -1028.446724115062, -663.8848017986503, -616.4351397679784, -533.7958288467667, -1016.5803850549803, -879.7178879437668, -993.6856702815171, -828.7397180585328, -578.7581809848398, -595.3772061498872, -812.7913206788809, -87.14977060567715, -51.29427096381313, -694.6493855692038, -1220.3255984394136, -376.8798496566333, -1028.4946952457542, -190.90830071614036, -854.7032516362201, -303.3232938977951, -282.99348218740965, -829.1335847863536, -1123.3940287211985, -192.35453521850374, -1170.080026397217, -386.7242832771928, -966.0909050553031, -1061.3396364983573, -1084.1877340892659, -788.2831528392738, -675.5568306478939, -1244.9971439824221, -850.9959622496782, -812.2197439459766, -1290.280264544136, -812.9417015635404, -136.79035879589333, -113.66083326729823, -919.9070584779819, -963.6852577912219, -805.9994519738939, -1156.3868311245021, -736.5418772100343, -807.9908995323497, -830.7285782229094, -406.40499548815023, -923.4592583564203, -1083.1250355362863, -212.24954997119934, -734.2620806796167, -1171.217326967063, -767.6158906308596, -753.3475898402655, -380.65554031939007, -1432.2995751496685, -902.3353763280035, -818.3072174399305, -996.7966839085518, -596.1715919699849, -686.9239822501386, -529.9821110621341, -729.9774061934819, -994.5359488140907, -885.6429748291088, -770.1143990921865, -705.8934873452962, -1012.5606527783633, -811.2656183484527, -688.7041180535695, -458.3020045223232, -353.5816658834635, -1098.7314835095058, -1120.6691850432337, -384.68586310820734, -461.7155095058939, -576.0818504638896, -229.559729502074, -497.3135686964464], "episode_lengths": [150, 99, 150, 88, 150, 150, 37, 130, 99, 150, 108, 150, 132, 150, 150, 150, 150, 103, 150, 150, 150, 125, 150, 150, 122, 137, 150, 150, 150, 150, 150, 150, 150, 70, 63, 150, 150, 114, 150, 120, 150, 126, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 124, 99, 150], "policy_policy_0_reward": [-937.4502703379295, -306.08330748423396, -767.1577424972845, -271.822991136497, -871.8211362126054, -407.5698247396007, -16.808797367669598, -549.8331511127967, -367.01200694060776, -1308.1045000159093, -454.6181094308243, -1248.1344175681425, -623.4859859435293, -855.5412063650936, -829.6409372281023, -743.0360326903841, -907.3711582489009, -323.5168571407854, -1216.943808302123, -1246.3503549863633, -987.9951793926318, -289.71861442546015, -1028.446724115062, -663.8848017986503, -616.4351397679784, -533.7958288467667, -1016.5803850549803, -879.7178879437668, -993.6856702815171, -828.7397180585328, -578.7581809848398, -595.3772061498872, -812.7913206788809, -87.14977060567715, -51.29427096381313, -694.6493855692038, -1220.3255984394136, -376.8798496566333, -1028.4946952457542, -190.90830071614036, -854.7032516362201, -303.3232938977951, -282.99348218740965, -829.1335847863536, -1123.3940287211985, -192.35453521850374, -1170.080026397217, -386.7242832771928, -966.0909050553031, -1061.3396364983573, -1084.1877340892659, -788.2831528392738, -675.5568306478939, -1244.9971439824221, -850.9959622496782, -812.2197439459766, -1290.280264544136, -812.9417015635404, -136.79035879589333, -113.66083326729823, -919.9070584779819, -963.6852577912219, -805.9994519738939, -1156.3868311245021, -736.5418772100343, -807.9908995323497, -830.7285782229094, -406.40499548815023, -923.4592583564203, -1083.1250355362863, -212.24954997119934, -734.2620806796167, -1171.217326967063, -767.6158906308596, -753.3475898402655, -380.65554031939007, -1432.2995751496685, -902.3353763280035, -818.3072174399305, -996.7966839085518, -596.1715919699849, -686.9239822501386, -529.9821110621341, -729.9774061934819, -994.5359488140907, -885.6429748291088, -770.1143990921865, -705.8934873452962, -1012.5606527783633, -811.2656183484527, -688.7041180535695, -458.3020045223232, -353.5816658834635, -1098.7314835095058, -1120.6691850432337, -384.68586310820734, -461.7155095058939, -576.0818504638896, -229.559729502074, -497.3135686964464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5494053033659972, "mean_inference_ms": 1.6731142924646787, "mean_action_processing_ms": 0.2823499789280391, "mean_env_wait_ms": 2.977848206255186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013480901718139648, "StateBufferConnector_ms": 0.0084228515625, "ViewRequirementAgentConnector_ms": 0.1966409683227539}, "num_episodes": 25, "episode_return_max": -16.808797367669598, "episode_return_min": -1432.2995751496685, "episode_return_mean": -731.0371110396605, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.8349246503495, "num_env_steps_trained_throughput_per_sec": 295.8349246503495, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12229.535, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12229.459, "sample_time_ms": 1014.918, "learn_time_ms": 11143.089, "learn_throughput": 358.967, "synch_weights_time_ms": 70.521}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00012", "date": "2024-08-03_11-23-32", "timestamp": 1722664412, "time_this_iter_s": 13.5348482131958, "time_total_s": 97.9364504814148, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b1ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 97.9364504814148, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.605, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 77.33997599581878, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.011505863070488, "policy_loss": -0.014694514518972331, "vf_loss": 4.021569558729728, "vf_explained_var": 0.911756527920564, "kl": 0.015996562878899577, "entropy": 1.6815321224431197, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -51.29427096381313, "episode_reward_min": -1432.2995751496685, "episode_reward_mean": -734.5018405883333, "episode_len_mean": 141.6, "episode_media": {}, "episodes_timesteps_total": 14160, "policy_reward_min": {"policy_0": -1432.2995751496685}, "policy_reward_max": {"policy_0": -51.29427096381313}, "policy_reward_mean": {"policy_0": -734.5018405883333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1016.5803850549803, -879.7178879437668, -993.6856702815171, -828.7397180585328, -578.7581809848398, -595.3772061498872, -812.7913206788809, -87.14977060567715, -51.29427096381313, -694.6493855692038, -1220.3255984394136, -376.8798496566333, -1028.4946952457542, -190.90830071614036, -854.7032516362201, -303.3232938977951, -282.99348218740965, -829.1335847863536, -1123.3940287211985, -192.35453521850374, -1170.080026397217, -386.7242832771928, -966.0909050553031, -1061.3396364983573, -1084.1877340892659, -788.2831528392738, -675.5568306478939, -1244.9971439824221, -850.9959622496782, -812.2197439459766, -1290.280264544136, -812.9417015635404, -136.79035879589333, -113.66083326729823, -919.9070584779819, -963.6852577912219, -805.9994519738939, -1156.3868311245021, -736.5418772100343, -807.9908995323497, -830.7285782229094, -406.40499548815023, -923.4592583564203, -1083.1250355362863, -212.24954997119934, -734.2620806796167, -1171.217326967063, -767.6158906308596, -753.3475898402655, -380.65554031939007, -1432.2995751496685, -902.3353763280035, -818.3072174399305, -996.7966839085518, -596.1715919699849, -686.9239822501386, -529.9821110621341, -729.9774061934819, -994.5359488140907, -885.6429748291088, -770.1143990921865, -705.8934873452962, -1012.5606527783633, -811.2656183484527, -688.7041180535695, -458.3020045223232, -353.5816658834635, -1098.7314835095058, -1120.6691850432337, -384.68586310820734, -461.7155095058939, -576.0818504638896, -229.559729502074, -497.3135686964464, -301.83864155154436, -662.5028945654426, -1173.7639516900483, -1070.6257434478214, -155.9017581851034, -1130.942065974942, -912.5603857582588, -617.4103400012731, -925.7764455080962, -1122.3185477777733, -660.4317618807146, -1222.2811639321142, -406.2760787508367, -423.5515924287317, -438.26262931204593, -817.5597382469783, -158.74926636332717, -908.5819112276644, -681.4962369051889, -345.230969459671, -1090.197865684104, -950.3648139323403, -835.4672645507777, -461.63929610810044, -771.2116749578099, -474.10880076250606], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 70, 63, 150, 150, 114, 150, 120, 150, 126, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 124, 99, 150, 150, 150, 150, 150, 107, 150, 150, 128, 150, 150, 150, 150, 124, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 106], "policy_policy_0_reward": [-1016.5803850549803, -879.7178879437668, -993.6856702815171, -828.7397180585328, -578.7581809848398, -595.3772061498872, -812.7913206788809, -87.14977060567715, -51.29427096381313, -694.6493855692038, -1220.3255984394136, -376.8798496566333, -1028.4946952457542, -190.90830071614036, -854.7032516362201, -303.3232938977951, -282.99348218740965, -829.1335847863536, -1123.3940287211985, -192.35453521850374, -1170.080026397217, -386.7242832771928, -966.0909050553031, -1061.3396364983573, -1084.1877340892659, -788.2831528392738, -675.5568306478939, -1244.9971439824221, -850.9959622496782, -812.2197439459766, -1290.280264544136, -812.9417015635404, -136.79035879589333, -113.66083326729823, -919.9070584779819, -963.6852577912219, -805.9994519738939, -1156.3868311245021, -736.5418772100343, -807.9908995323497, -830.7285782229094, -406.40499548815023, -923.4592583564203, -1083.1250355362863, -212.24954997119934, -734.2620806796167, -1171.217326967063, -767.6158906308596, -753.3475898402655, -380.65554031939007, -1432.2995751496685, -902.3353763280035, -818.3072174399305, -996.7966839085518, -596.1715919699849, -686.9239822501386, -529.9821110621341, -729.9774061934819, -994.5359488140907, -885.6429748291088, -770.1143990921865, -705.8934873452962, -1012.5606527783633, -811.2656183484527, -688.7041180535695, -458.3020045223232, -353.5816658834635, -1098.7314835095058, -1120.6691850432337, -384.68586310820734, -461.7155095058939, -576.0818504638896, -229.559729502074, -497.3135686964464, -301.83864155154436, -662.5028945654426, -1173.7639516900483, -1070.6257434478214, -155.9017581851034, -1130.942065974942, -912.5603857582588, -617.4103400012731, -925.7764455080962, -1122.3185477777733, -660.4317618807146, -1222.2811639321142, -406.2760787508367, -423.5515924287317, -438.26262931204593, -817.5597382469783, -158.74926636332717, -908.5819112276644, -681.4962369051889, -345.230969459671, -1090.197865684104, -950.3648139323403, -835.4672645507777, -461.63929610810044, -771.2116749578099, -474.10880076250606]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5501087111284516, "mean_inference_ms": 1.6756214138614263, "mean_action_processing_ms": 0.2821040675825013, "mean_env_wait_ms": 2.9847419907337915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012935400009155273, "StateBufferConnector_ms": 0.008215188980102539, "ViewRequirementAgentConnector_ms": 0.1978747844696045}, "num_episodes": 26, "episode_return_max": -51.29427096381313, "episode_return_min": -1432.2995751496685, "episode_return_mean": -734.5018405883333, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.1424873569817, "num_env_steps_trained_throughput_per_sec": 306.1424873569817, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12322.456, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12322.381, "sample_time_ms": 1014.618, "learn_time_ms": 11237.419, "learn_throughput": 355.954, "synch_weights_time_ms": 69.424}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00012", "date": "2024-08-03_11-23-45", "timestamp": 1722664425, "time_this_iter_s": 13.079819440841675, "time_total_s": 111.01626992225647, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245760430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 111.01626992225647, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.994444444444445, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.55099188188711, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.6585726754118997, "policy_loss": -0.011164999341902633, "vf_loss": 3.6649624223510426, "vf_explained_var": 0.946485261246562, "kl": 0.01645861268207227, "entropy": 1.6233115844428538, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -73.68532496009094, "episode_reward_min": -1432.2995751496685, "episode_reward_mean": -727.6999245831382, "episode_len_mean": 140.75, "episode_media": {}, "episodes_timesteps_total": 14075, "policy_reward_min": {"policy_0": -1432.2995751496685}, "policy_reward_max": {"policy_0": -73.68532496009094}, "policy_reward_mean": {"policy_0": -727.6999245831382}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-812.9417015635404, -136.79035879589333, -113.66083326729823, -919.9070584779819, -963.6852577912219, -805.9994519738939, -1156.3868311245021, -736.5418772100343, -807.9908995323497, -830.7285782229094, -406.40499548815023, -923.4592583564203, -1083.1250355362863, -212.24954997119934, -734.2620806796167, -1171.217326967063, -767.6158906308596, -753.3475898402655, -380.65554031939007, -1432.2995751496685, -902.3353763280035, -818.3072174399305, -996.7966839085518, -596.1715919699849, -686.9239822501386, -529.9821110621341, -729.9774061934819, -994.5359488140907, -885.6429748291088, -770.1143990921865, -705.8934873452962, -1012.5606527783633, -811.2656183484527, -688.7041180535695, -458.3020045223232, -353.5816658834635, -1098.7314835095058, -1120.6691850432337, -384.68586310820734, -461.7155095058939, -576.0818504638896, -229.559729502074, -497.3135686964464, -301.83864155154436, -662.5028945654426, -1173.7639516900483, -1070.6257434478214, -155.9017581851034, -1130.942065974942, -912.5603857582588, -617.4103400012731, -925.7764455080962, -1122.3185477777733, -660.4317618807146, -1222.2811639321142, -406.2760787508367, -423.5515924287317, -438.26262931204593, -817.5597382469783, -158.74926636332717, -908.5819112276644, -681.4962369051889, -345.230969459671, -1090.197865684104, -950.3648139323403, -835.4672645507777, -461.63929610810044, -771.2116749578099, -474.10880076250606, -1028.479064060838, -243.1653340058861, -841.6894038421779, -926.9600117948262, -588.2705055306909, -969.0948699431806, -990.8965338071054, -738.2330544575617, -802.4186052849228, -492.9414798122074, -866.6961187280974, -779.6903996518922, -945.2341318710073, -874.762106847563, -204.2611196620149, -151.02884396324723, -224.07565677373296, -1103.1390302004454, -639.4062222131985, -884.2141957907148, -1230.400228242145, -848.9823363874581, -806.9995743116586, -789.7199605363313, -73.68532496009094, -255.30184212755503, -1238.9091596016046, -874.7915791930699, -951.633144882436, -583.2606048285888, -643.4780564914646], "episode_lengths": [150, 66, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 124, 99, 150, 150, 150, 150, 150, 107, 150, 150, 128, 150, 150, 150, 150, 124, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 84, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 81, 83, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-812.9417015635404, -136.79035879589333, -113.66083326729823, -919.9070584779819, -963.6852577912219, -805.9994519738939, -1156.3868311245021, -736.5418772100343, -807.9908995323497, -830.7285782229094, -406.40499548815023, -923.4592583564203, -1083.1250355362863, -212.24954997119934, -734.2620806796167, -1171.217326967063, -767.6158906308596, -753.3475898402655, -380.65554031939007, -1432.2995751496685, -902.3353763280035, -818.3072174399305, -996.7966839085518, -596.1715919699849, -686.9239822501386, -529.9821110621341, -729.9774061934819, -994.5359488140907, -885.6429748291088, -770.1143990921865, -705.8934873452962, -1012.5606527783633, -811.2656183484527, -688.7041180535695, -458.3020045223232, -353.5816658834635, -1098.7314835095058, -1120.6691850432337, -384.68586310820734, -461.7155095058939, -576.0818504638896, -229.559729502074, -497.3135686964464, -301.83864155154436, -662.5028945654426, -1173.7639516900483, -1070.6257434478214, -155.9017581851034, -1130.942065974942, -912.5603857582588, -617.4103400012731, -925.7764455080962, -1122.3185477777733, -660.4317618807146, -1222.2811639321142, -406.2760787508367, -423.5515924287317, -438.26262931204593, -817.5597382469783, -158.74926636332717, -908.5819112276644, -681.4962369051889, -345.230969459671, -1090.197865684104, -950.3648139323403, -835.4672645507777, -461.63929610810044, -771.2116749578099, -474.10880076250606, -1028.479064060838, -243.1653340058861, -841.6894038421779, -926.9600117948262, -588.2705055306909, -969.0948699431806, -990.8965338071054, -738.2330544575617, -802.4186052849228, -492.9414798122074, -866.6961187280974, -779.6903996518922, -945.2341318710073, -874.762106847563, -204.2611196620149, -151.02884396324723, -224.07565677373296, -1103.1390302004454, -639.4062222131985, -884.2141957907148, -1230.400228242145, -848.9823363874581, -806.9995743116586, -789.7199605363313, -73.68532496009094, -255.30184212755503, -1238.9091596016046, -874.7915791930699, -951.633144882436, -583.2606048285888, -643.4780564914646]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5506286622596263, "mean_inference_ms": 1.6794969972455056, "mean_action_processing_ms": 0.28194341060062983, "mean_env_wait_ms": 2.9940047579335443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012303829193115234, "StateBufferConnector_ms": 0.008005142211914062, "ViewRequirementAgentConnector_ms": 0.19580817222595215}, "num_episodes": 31, "episode_return_max": -73.68532496009094, "episode_return_min": -1432.2995751496685, "episode_return_mean": -727.6999245831382, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.61780257341104, "num_env_steps_trained_throughput_per_sec": 285.61780257341104, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12490.685, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12490.609, "sample_time_ms": 1018.954, "learn_time_ms": 11401.929, "learn_throughput": 350.818, "synch_weights_time_ms": 68.812}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00012", "date": "2024-08-03_11-23-59", "timestamp": 1722664439, "time_this_iter_s": 14.017799377441406, "time_total_s": 125.03406929969788, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244526830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 125.03406929969788, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.530000000000001, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 129.57842223544915, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.2592370690157018, "policy_loss": -0.009563382442865986, "vf_loss": 3.2647056894997757, "vf_explained_var": 0.9639789635315538, "kl": 0.014219268068942862, "entropy": 1.710215801994006, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -73.68532496009094, "episode_reward_min": -1299.3026907411793, "episode_reward_mean": -739.3751301102476, "episode_len_mean": 141.51, "episode_media": {}, "episodes_timesteps_total": 14151, "policy_reward_min": {"policy_0": -1299.3026907411793}, "policy_reward_max": {"policy_0": -73.68532496009094}, "policy_reward_mean": {"policy_0": -739.3751301102476}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-705.8934873452962, -1012.5606527783633, -811.2656183484527, -688.7041180535695, -458.3020045223232, -353.5816658834635, -1098.7314835095058, -1120.6691850432337, -384.68586310820734, -461.7155095058939, -576.0818504638896, -229.559729502074, -497.3135686964464, -301.83864155154436, -662.5028945654426, -1173.7639516900483, -1070.6257434478214, -155.9017581851034, -1130.942065974942, -912.5603857582588, -617.4103400012731, -925.7764455080962, -1122.3185477777733, -660.4317618807146, -1222.2811639321142, -406.2760787508367, -423.5515924287317, -438.26262931204593, -817.5597382469783, -158.74926636332717, -908.5819112276644, -681.4962369051889, -345.230969459671, -1090.197865684104, -950.3648139323403, -835.4672645507777, -461.63929610810044, -771.2116749578099, -474.10880076250606, -1028.479064060838, -243.1653340058861, -841.6894038421779, -926.9600117948262, -588.2705055306909, -969.0948699431806, -990.8965338071054, -738.2330544575617, -802.4186052849228, -492.9414798122074, -866.6961187280974, -779.6903996518922, -945.2341318710073, -874.762106847563, -204.2611196620149, -151.02884396324723, -224.07565677373296, -1103.1390302004454, -639.4062222131985, -884.2141957907148, -1230.400228242145, -848.9823363874581, -806.9995743116586, -789.7199605363313, -73.68532496009094, -255.30184212755503, -1238.9091596016046, -874.7915791930699, -951.633144882436, -583.2606048285888, -643.4780564914646, -424.5511324903852, -968.8762178697334, -572.9621570992538, -725.7022776668323, -1205.912560922373, -1127.0175909077007, -1010.8747348454315, -808.3061720667799, -391.83369561883626, -629.1526023827785, -1055.2244364224632, -755.2592361096023, -1299.3026907411793, -722.7155990926957, -1092.6494738345834, -1017.3010031097276, -231.53630221280682, -404.07338628343047, -882.7516238557026, -387.05951966463664, -574.6966470567868, -1120.3858751369457, -932.4122367851455, -776.9295253951007, -1079.4187424261352, -862.1913993320225, -531.1495607867745, -777.9411422289749, -1015.6707318915879, -843.7196612607021], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 124, 99, 150, 150, 150, 150, 150, 107, 150, 150, 128, 150, 150, 150, 150, 124, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 84, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 81, 83, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 119, 150, 150, 148, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-705.8934873452962, -1012.5606527783633, -811.2656183484527, -688.7041180535695, -458.3020045223232, -353.5816658834635, -1098.7314835095058, -1120.6691850432337, -384.68586310820734, -461.7155095058939, -576.0818504638896, -229.559729502074, -497.3135686964464, -301.83864155154436, -662.5028945654426, -1173.7639516900483, -1070.6257434478214, -155.9017581851034, -1130.942065974942, -912.5603857582588, -617.4103400012731, -925.7764455080962, -1122.3185477777733, -660.4317618807146, -1222.2811639321142, -406.2760787508367, -423.5515924287317, -438.26262931204593, -817.5597382469783, -158.74926636332717, -908.5819112276644, -681.4962369051889, -345.230969459671, -1090.197865684104, -950.3648139323403, -835.4672645507777, -461.63929610810044, -771.2116749578099, -474.10880076250606, -1028.479064060838, -243.1653340058861, -841.6894038421779, -926.9600117948262, -588.2705055306909, -969.0948699431806, -990.8965338071054, -738.2330544575617, -802.4186052849228, -492.9414798122074, -866.6961187280974, -779.6903996518922, -945.2341318710073, -874.762106847563, -204.2611196620149, -151.02884396324723, -224.07565677373296, -1103.1390302004454, -639.4062222131985, -884.2141957907148, -1230.400228242145, -848.9823363874581, -806.9995743116586, -789.7199605363313, -73.68532496009094, -255.30184212755503, -1238.9091596016046, -874.7915791930699, -951.633144882436, -583.2606048285888, -643.4780564914646, -424.5511324903852, -968.8762178697334, -572.9621570992538, -725.7022776668323, -1205.912560922373, -1127.0175909077007, -1010.8747348454315, -808.3061720667799, -391.83369561883626, -629.1526023827785, -1055.2244364224632, -755.2592361096023, -1299.3026907411793, -722.7155990926957, -1092.6494738345834, -1017.3010031097276, -231.53630221280682, -404.07338628343047, -882.7516238557026, -387.05951966463664, -574.6966470567868, -1120.3858751369457, -932.4122367851455, -776.9295253951007, -1079.4187424261352, -862.1913993320225, -531.1495607867745, -777.9411422289749, -1015.6707318915879, -843.7196612607021]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5508690677143693, "mean_inference_ms": 1.6826746512553137, "mean_action_processing_ms": 0.2817458053903276, "mean_env_wait_ms": 3.0050013580088843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01253366470336914, "StateBufferConnector_ms": 0.008052349090576172, "ViewRequirementAgentConnector_ms": 0.19647836685180664}, "num_episodes": 30, "episode_return_max": -73.68532496009094, "episode_return_min": -1299.3026907411793, "episode_return_mean": -739.3751301102476, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.2984328031882, "num_env_steps_trained_throughput_per_sec": 301.2984328031882, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12952.674, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12952.593, "sample_time_ms": 1025.571, "learn_time_ms": 11855.494, "learn_throughput": 337.396, "synch_weights_time_ms": 70.587}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00012", "date": "2024-08-03_11-24-12", "timestamp": 1722664452, "time_this_iter_s": 13.289087057113647, "time_total_s": 138.32315635681152, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445268c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 138.32315635681152, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 14.01052631578947, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 137.0448908418417, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.894628723959128, "policy_loss": -0.00963457033940358, "vf_loss": 2.899404195075234, "vf_explained_var": 0.9751075093944868, "kl": 0.01672478834752839, "entropy": 1.583385429655512, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -8.52746563449349, "episode_reward_min": -1299.3026907411793, "episode_reward_mean": -716.7990782011029, "episode_len_mean": 137.2, "episode_media": {}, "episodes_timesteps_total": 13720, "policy_reward_min": {"policy_0": -1299.3026907411793}, "policy_reward_max": {"policy_0": -8.52746563449349}, "policy_reward_mean": {"policy_0": -716.7990782011029}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-158.74926636332717, -908.5819112276644, -681.4962369051889, -345.230969459671, -1090.197865684104, -950.3648139323403, -835.4672645507777, -461.63929610810044, -771.2116749578099, -474.10880076250606, -1028.479064060838, -243.1653340058861, -841.6894038421779, -926.9600117948262, -588.2705055306909, -969.0948699431806, -990.8965338071054, -738.2330544575617, -802.4186052849228, -492.9414798122074, -866.6961187280974, -779.6903996518922, -945.2341318710073, -874.762106847563, -204.2611196620149, -151.02884396324723, -224.07565677373296, -1103.1390302004454, -639.4062222131985, -884.2141957907148, -1230.400228242145, -848.9823363874581, -806.9995743116586, -789.7199605363313, -73.68532496009094, -255.30184212755503, -1238.9091596016046, -874.7915791930699, -951.633144882436, -583.2606048285888, -643.4780564914646, -424.5511324903852, -968.8762178697334, -572.9621570992538, -725.7022776668323, -1205.912560922373, -1127.0175909077007, -1010.8747348454315, -808.3061720667799, -391.83369561883626, -629.1526023827785, -1055.2244364224632, -755.2592361096023, -1299.3026907411793, -722.7155990926957, -1092.6494738345834, -1017.3010031097276, -231.53630221280682, -404.07338628343047, -882.7516238557026, -387.05951966463664, -574.6966470567868, -1120.3858751369457, -932.4122367851455, -776.9295253951007, -1079.4187424261352, -862.1913993320225, -531.1495607867745, -777.9411422289749, -1015.6707318915879, -843.7196612607021, -1243.1952305815264, -915.934656966859, -878.1455103297243, -170.23450053022432, -113.63630579601303, -740.749418293212, -1020.0145954930302, -744.6791468955761, -349.59367886703524, -715.093750281857, -95.32474525328438, -752.9402652010218, -350.3373365808353, -1019.5043134926029, -337.360416415487, -341.9555420249666, -1052.1869306797623, -861.5861455740351, -195.0125727012072, -1216.5407177591014, -8.52746563449349, -903.1915943113444, -819.2038718063613, -845.4648666978873, -48.482677737885595, -425.68754832007517, -1071.4040583934043, -480.69785805671387, -466.77756418245764], "episode_lengths": [84, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 84, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 81, 83, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 119, 150, 150, 148, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 54, 150, 150, 150, 140, 150, 65, 150, 93, 150, 95, 150, 150, 150, 85, 150, 36, 150, 150, 150, 56, 150, 150, 150, 147], "policy_policy_0_reward": [-158.74926636332717, -908.5819112276644, -681.4962369051889, -345.230969459671, -1090.197865684104, -950.3648139323403, -835.4672645507777, -461.63929610810044, -771.2116749578099, -474.10880076250606, -1028.479064060838, -243.1653340058861, -841.6894038421779, -926.9600117948262, -588.2705055306909, -969.0948699431806, -990.8965338071054, -738.2330544575617, -802.4186052849228, -492.9414798122074, -866.6961187280974, -779.6903996518922, -945.2341318710073, -874.762106847563, -204.2611196620149, -151.02884396324723, -224.07565677373296, -1103.1390302004454, -639.4062222131985, -884.2141957907148, -1230.400228242145, -848.9823363874581, -806.9995743116586, -789.7199605363313, -73.68532496009094, -255.30184212755503, -1238.9091596016046, -874.7915791930699, -951.633144882436, -583.2606048285888, -643.4780564914646, -424.5511324903852, -968.8762178697334, -572.9621570992538, -725.7022776668323, -1205.912560922373, -1127.0175909077007, -1010.8747348454315, -808.3061720667799, -391.83369561883626, -629.1526023827785, -1055.2244364224632, -755.2592361096023, -1299.3026907411793, -722.7155990926957, -1092.6494738345834, -1017.3010031097276, -231.53630221280682, -404.07338628343047, -882.7516238557026, -387.05951966463664, -574.6966470567868, -1120.3858751369457, -932.4122367851455, -776.9295253951007, -1079.4187424261352, -862.1913993320225, -531.1495607867745, -777.9411422289749, -1015.6707318915879, -843.7196612607021, -1243.1952305815264, -915.934656966859, -878.1455103297243, -170.23450053022432, -113.63630579601303, -740.749418293212, -1020.0145954930302, -744.6791468955761, -349.59367886703524, -715.093750281857, -95.32474525328438, -752.9402652010218, -350.3373365808353, -1019.5043134926029, -337.360416415487, -341.9555420249666, -1052.1869306797623, -861.5861455740351, -195.0125727012072, -1216.5407177591014, -8.52746563449349, -903.1915943113444, -819.2038718063613, -845.4648666978873, -48.482677737885595, -425.68754832007517, -1071.4040583934043, -480.69785805671387, -466.77756418245764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5515352877053323, "mean_inference_ms": 1.686091599525749, "mean_action_processing_ms": 0.28157960762302403, "mean_env_wait_ms": 3.0137117288694046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012422323226928711, "StateBufferConnector_ms": 0.008194684982299805, "ViewRequirementAgentConnector_ms": 0.20279335975646973}, "num_episodes": 29, "episode_return_max": -8.52746563449349, "episode_return_min": -1299.3026907411793, "episode_return_mean": -716.7990782011029, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.7795084512734, "num_env_steps_trained_throughput_per_sec": 301.7795084512734, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12955.078, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12954.992, "sample_time_ms": 1031.912, "learn_time_ms": 11852.406, "learn_throughput": 337.484, "synch_weights_time_ms": 69.737}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00012", "date": "2024-08-03_11-24-26", "timestamp": 1722664466, "time_this_iter_s": 13.268495321273804, "time_total_s": 151.59165167808533, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245760430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 151.59165167808533, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.878947368421052, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 121.25761776765188, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.961868925516804, "policy_loss": -0.01425434966464915, "vf_loss": 2.971522416671117, "vf_explained_var": 0.9845526518300176, "kl": 0.015856903445486153, "entropy": 1.5621666827549536, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -8.52746563449349, "episode_reward_min": -1299.3026907411793, "episode_reward_mean": -717.9036364566288, "episode_len_mean": 137.85, "episode_media": {}, "episodes_timesteps_total": 13785, "policy_reward_min": {"policy_0": -1299.3026907411793}, "policy_reward_max": {"policy_0": -8.52746563449349}, "policy_reward_mean": {"policy_0": -717.9036364566288}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1230.400228242145, -848.9823363874581, -806.9995743116586, -789.7199605363313, -73.68532496009094, -255.30184212755503, -1238.9091596016046, -874.7915791930699, -951.633144882436, -583.2606048285888, -643.4780564914646, -424.5511324903852, -968.8762178697334, -572.9621570992538, -725.7022776668323, -1205.912560922373, -1127.0175909077007, -1010.8747348454315, -808.3061720667799, -391.83369561883626, -629.1526023827785, -1055.2244364224632, -755.2592361096023, -1299.3026907411793, -722.7155990926957, -1092.6494738345834, -1017.3010031097276, -231.53630221280682, -404.07338628343047, -882.7516238557026, -387.05951966463664, -574.6966470567868, -1120.3858751369457, -932.4122367851455, -776.9295253951007, -1079.4187424261352, -862.1913993320225, -531.1495607867745, -777.9411422289749, -1015.6707318915879, -843.7196612607021, -1243.1952305815264, -915.934656966859, -878.1455103297243, -170.23450053022432, -113.63630579601303, -740.749418293212, -1020.0145954930302, -744.6791468955761, -349.59367886703524, -715.093750281857, -95.32474525328438, -752.9402652010218, -350.3373365808353, -1019.5043134926029, -337.360416415487, -341.9555420249666, -1052.1869306797623, -861.5861455740351, -195.0125727012072, -1216.5407177591014, -8.52746563449349, -903.1915943113444, -819.2038718063613, -845.4648666978873, -48.482677737885595, -425.68754832007517, -1071.4040583934043, -480.69785805671387, -466.77756418245764, -862.8195853727821, -998.1389084875142, -435.84421953006654, -1194.3860111065078, -874.9823697080486, -1169.1942645729944, -1041.036213169975, -690.4057210396321, -588.2967660012047, -447.08349370733896, -614.2281053654152, -714.0186399897713, -59.94332885616639, -708.7740497107923, -1101.314174832399, -141.68537172248747, -253.7618475015997, -1128.7121899291835, -605.5202867876524, -653.6516499146231, -784.8161168475762, -486.07914422744994, -53.11419273838426, -1170.7769337701955, -118.90208637715152, -1057.43908650812, -442.3774511577433, -748.3814510851524, -1034.0823594768908, -902.3945942505629], "episode_lengths": [150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 119, 150, 150, 148, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 54, 150, 150, 150, 140, 150, 65, 150, 93, 150, 95, 150, 150, 150, 85, 150, 36, 150, 150, 150, 56, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 80, 150, 150, 150, 144, 150, 150, 62, 150, 85, 150, 122, 150, 150, 150], "policy_policy_0_reward": [-1230.400228242145, -848.9823363874581, -806.9995743116586, -789.7199605363313, -73.68532496009094, -255.30184212755503, -1238.9091596016046, -874.7915791930699, -951.633144882436, -583.2606048285888, -643.4780564914646, -424.5511324903852, -968.8762178697334, -572.9621570992538, -725.7022776668323, -1205.912560922373, -1127.0175909077007, -1010.8747348454315, -808.3061720667799, -391.83369561883626, -629.1526023827785, -1055.2244364224632, -755.2592361096023, -1299.3026907411793, -722.7155990926957, -1092.6494738345834, -1017.3010031097276, -231.53630221280682, -404.07338628343047, -882.7516238557026, -387.05951966463664, -574.6966470567868, -1120.3858751369457, -932.4122367851455, -776.9295253951007, -1079.4187424261352, -862.1913993320225, -531.1495607867745, -777.9411422289749, -1015.6707318915879, -843.7196612607021, -1243.1952305815264, -915.934656966859, -878.1455103297243, -170.23450053022432, -113.63630579601303, -740.749418293212, -1020.0145954930302, -744.6791468955761, -349.59367886703524, -715.093750281857, -95.32474525328438, -752.9402652010218, -350.3373365808353, -1019.5043134926029, -337.360416415487, -341.9555420249666, -1052.1869306797623, -861.5861455740351, -195.0125727012072, -1216.5407177591014, -8.52746563449349, -903.1915943113444, -819.2038718063613, -845.4648666978873, -48.482677737885595, -425.68754832007517, -1071.4040583934043, -480.69785805671387, -466.77756418245764, -862.8195853727821, -998.1389084875142, -435.84421953006654, -1194.3860111065078, -874.9823697080486, -1169.1942645729944, -1041.036213169975, -690.4057210396321, -588.2967660012047, -447.08349370733896, -614.2281053654152, -714.0186399897713, -59.94332885616639, -708.7740497107923, -1101.314174832399, -141.68537172248747, -253.7618475015997, -1128.7121899291835, -605.5202867876524, -653.6516499146231, -784.8161168475762, -486.07914422744994, -53.11419273838426, -1170.7769337701955, -118.90208637715152, -1057.43908650812, -442.3774511577433, -748.3814510851524, -1034.0823594768908, -902.3945942505629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523209352207182, "mean_inference_ms": 1.6893608329304413, "mean_action_processing_ms": 0.28187466378499537, "mean_env_wait_ms": 3.0202113849961023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012698173522949219, "StateBufferConnector_ms": 0.008276700973510742, "ViewRequirementAgentConnector_ms": 0.20608139038085938}, "num_episodes": 30, "episode_return_max": -8.52746563449349, "episode_return_min": -1299.3026907411793, "episode_return_mean": -717.9036364566288, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.5484099744384, "num_env_steps_trained_throughput_per_sec": 292.5484099744384, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12940.824, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12940.736, "sample_time_ms": 1036.174, "learn_time_ms": 11834.872, "learn_throughput": 337.984, "synch_weights_time_ms": 68.758}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00012", "date": "2024-08-03_11-24-39", "timestamp": 1722664479, "time_this_iter_s": 13.688189029693604, "time_total_s": 165.27984070777893, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d3eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 165.27984070777893, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.84, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 142.82601553698382, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.994512260084351, "policy_loss": -0.010704121338009524, "vf_loss": 2.999648930753271, "vf_explained_var": 0.97974982727319, "kl": 0.01912142870084305, "entropy": 1.6897563986480235, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -8.52746563449349, "episode_reward_min": -1254.2654711229577, "episode_reward_mean": -690.6444631511647, "episode_len_mean": 133.8, "episode_media": {}, "episodes_timesteps_total": 13380, "policy_reward_min": {"policy_0": -1254.2654711229577}, "policy_reward_max": {"policy_0": -8.52746563449349}, "policy_reward_mean": {"policy_0": -690.6444631511647}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-574.6966470567868, -1120.3858751369457, -932.4122367851455, -776.9295253951007, -1079.4187424261352, -862.1913993320225, -531.1495607867745, -777.9411422289749, -1015.6707318915879, -843.7196612607021, -1243.1952305815264, -915.934656966859, -878.1455103297243, -170.23450053022432, -113.63630579601303, -740.749418293212, -1020.0145954930302, -744.6791468955761, -349.59367886703524, -715.093750281857, -95.32474525328438, -752.9402652010218, -350.3373365808353, -1019.5043134926029, -337.360416415487, -341.9555420249666, -1052.1869306797623, -861.5861455740351, -195.0125727012072, -1216.5407177591014, -8.52746563449349, -903.1915943113444, -819.2038718063613, -845.4648666978873, -48.482677737885595, -425.68754832007517, -1071.4040583934043, -480.69785805671387, -466.77756418245764, -862.8195853727821, -998.1389084875142, -435.84421953006654, -1194.3860111065078, -874.9823697080486, -1169.1942645729944, -1041.036213169975, -690.4057210396321, -588.2967660012047, -447.08349370733896, -614.2281053654152, -714.0186399897713, -59.94332885616639, -708.7740497107923, -1101.314174832399, -141.68537172248747, -253.7618475015997, -1128.7121899291835, -605.5202867876524, -653.6516499146231, -784.8161168475762, -486.07914422744994, -53.11419273838426, -1170.7769337701955, -118.90208637715152, -1057.43908650812, -442.3774511577433, -748.3814510851524, -1034.0823594768908, -902.3945942505629, -258.9309060453186, -156.40696512173426, -433.361359356633, -176.3800101537669, -477.23744546387485, -1090.0682595432102, -730.786242028955, -1254.2654711229577, -1191.5851684875863, -1161.4027633002765, -1034.0805672011898, -982.7449568379025, -503.42319983442457, -191.09221894550402, -73.90691113440862, -754.6009146041818, -73.09383276083004, -1208.4047349039215, -921.0012273727646, -955.7291153869336, -295.5757171360406, -1013.198524356382, -688.1152185765545, -953.4379454571227, -904.6686757581891, -1053.9394150961664, -17.55486700614473, -688.04345829684, -1207.6485118877788, -81.73163815035544, -751.8906528849695], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 54, 150, 150, 150, 140, 150, 65, 150, 93, 150, 95, 150, 150, 150, 85, 150, 36, 150, 150, 150, 56, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 80, 150, 150, 150, 144, 150, 150, 62, 150, 85, 150, 122, 150, 150, 150, 150, 71, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 128, 105, 49, 150, 66, 150, 150, 150, 127, 150, 150, 150, 150, 150, 44, 150, 150, 57, 150], "policy_policy_0_reward": [-574.6966470567868, -1120.3858751369457, -932.4122367851455, -776.9295253951007, -1079.4187424261352, -862.1913993320225, -531.1495607867745, -777.9411422289749, -1015.6707318915879, -843.7196612607021, -1243.1952305815264, -915.934656966859, -878.1455103297243, -170.23450053022432, -113.63630579601303, -740.749418293212, -1020.0145954930302, -744.6791468955761, -349.59367886703524, -715.093750281857, -95.32474525328438, -752.9402652010218, -350.3373365808353, -1019.5043134926029, -337.360416415487, -341.9555420249666, -1052.1869306797623, -861.5861455740351, -195.0125727012072, -1216.5407177591014, -8.52746563449349, -903.1915943113444, -819.2038718063613, -845.4648666978873, -48.482677737885595, -425.68754832007517, -1071.4040583934043, -480.69785805671387, -466.77756418245764, -862.8195853727821, -998.1389084875142, -435.84421953006654, -1194.3860111065078, -874.9823697080486, -1169.1942645729944, -1041.036213169975, -690.4057210396321, -588.2967660012047, -447.08349370733896, -614.2281053654152, -714.0186399897713, -59.94332885616639, -708.7740497107923, -1101.314174832399, -141.68537172248747, -253.7618475015997, -1128.7121899291835, -605.5202867876524, -653.6516499146231, -784.8161168475762, -486.07914422744994, -53.11419273838426, -1170.7769337701955, -118.90208637715152, -1057.43908650812, -442.3774511577433, -748.3814510851524, -1034.0823594768908, -902.3945942505629, -258.9309060453186, -156.40696512173426, -433.361359356633, -176.3800101537669, -477.23744546387485, -1090.0682595432102, -730.786242028955, -1254.2654711229577, -1191.5851684875863, -1161.4027633002765, -1034.0805672011898, -982.7449568379025, -503.42319983442457, -191.09221894550402, -73.90691113440862, -754.6009146041818, -73.09383276083004, -1208.4047349039215, -921.0012273727646, -955.7291153869336, -295.5757171360406, -1013.198524356382, -688.1152185765545, -953.4379454571227, -904.6686757581891, -1053.9394150961664, -17.55486700614473, -688.04345829684, -1207.6485118877788, -81.73163815035544, -751.8906528849695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527425767593493, "mean_inference_ms": 1.6915494841458893, "mean_action_processing_ms": 0.28185598253783, "mean_env_wait_ms": 3.027125899603339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012350797653198242, "StateBufferConnector_ms": 0.008162736892700195, "ViewRequirementAgentConnector_ms": 0.2043008804321289}, "num_episodes": 31, "episode_return_max": -8.52746563449349, "episode_return_min": -1254.2654711229577, "episode_return_mean": -690.6444631511647, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.88367356417905, "num_env_steps_trained_throughput_per_sec": 297.88367356417905, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12961.896, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12961.809, "sample_time_ms": 1037.117, "learn_time_ms": 11857.159, "learn_throughput": 337.349, "synch_weights_time_ms": 66.616}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00012", "date": "2024-08-03_11-24-53", "timestamp": 1722664493, "time_this_iter_s": 13.44157075881958, "time_total_s": 178.7214114665985, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244526a70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 178.7214114665985, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.584210526315792, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 169.429048148791, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.3775350980460646, "policy_loss": -0.010635134357047112, "vf_loss": 2.3842562639464933, "vf_explained_var": 0.9893001730864247, "kl": 0.013586999027605406, "entropy": 1.6212773547818264, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -8.52746563449349, "episode_reward_min": -1320.3314808978816, "episode_reward_mean": -710.2975051334276, "episode_len_mean": 135.98, "episode_media": {}, "episodes_timesteps_total": 13598, "policy_reward_min": {"policy_0": -1320.3314808978816}, "policy_reward_max": {"policy_0": -8.52746563449349}, "policy_reward_mean": {"policy_0": -710.2975051334276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1052.1869306797623, -861.5861455740351, -195.0125727012072, -1216.5407177591014, -8.52746563449349, -903.1915943113444, -819.2038718063613, -845.4648666978873, -48.482677737885595, -425.68754832007517, -1071.4040583934043, -480.69785805671387, -466.77756418245764, -862.8195853727821, -998.1389084875142, -435.84421953006654, -1194.3860111065078, -874.9823697080486, -1169.1942645729944, -1041.036213169975, -690.4057210396321, -588.2967660012047, -447.08349370733896, -614.2281053654152, -714.0186399897713, -59.94332885616639, -708.7740497107923, -1101.314174832399, -141.68537172248747, -253.7618475015997, -1128.7121899291835, -605.5202867876524, -653.6516499146231, -784.8161168475762, -486.07914422744994, -53.11419273838426, -1170.7769337701955, -118.90208637715152, -1057.43908650812, -442.3774511577433, -748.3814510851524, -1034.0823594768908, -902.3945942505629, -258.9309060453186, -156.40696512173426, -433.361359356633, -176.3800101537669, -477.23744546387485, -1090.0682595432102, -730.786242028955, -1254.2654711229577, -1191.5851684875863, -1161.4027633002765, -1034.0805672011898, -982.7449568379025, -503.42319983442457, -191.09221894550402, -73.90691113440862, -754.6009146041818, -73.09383276083004, -1208.4047349039215, -921.0012273727646, -955.7291153869336, -295.5757171360406, -1013.198524356382, -688.1152185765545, -953.4379454571227, -904.6686757581891, -1053.9394150961664, -17.55486700614473, -688.04345829684, -1207.6485118877788, -81.73163815035544, -751.8906528849695, -518.9667774055158, -926.7594920647377, -168.0313098023902, -955.4579802086785, -698.9899297818181, -1111.0440235826593, -826.3112943098238, -699.9078506877303, -957.783031778748, -687.401518246116, -782.2827418885123, -865.2019026841285, -829.9348282380513, -938.7857646138782, -142.70245049453854, -473.9944021412701, -998.6666332171756, -1320.3314808978816, -599.5010090420957, -783.0748301143926, -1102.1674423266031, -648.4139916622909, -506.4105206454988, -480.2124104552135, -1023.635201172696, -1222.550316067284], "episode_lengths": [150, 150, 85, 150, 36, 150, 150, 150, 56, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 80, 150, 150, 150, 144, 150, 150, 62, 150, 85, 150, 122, 150, 150, 150, 150, 71, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 128, 105, 49, 150, 66, 150, 150, 150, 127, 150, 150, 150, 150, 150, 44, 150, 150, 57, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1052.1869306797623, -861.5861455740351, -195.0125727012072, -1216.5407177591014, -8.52746563449349, -903.1915943113444, -819.2038718063613, -845.4648666978873, -48.482677737885595, -425.68754832007517, -1071.4040583934043, -480.69785805671387, -466.77756418245764, -862.8195853727821, -998.1389084875142, -435.84421953006654, -1194.3860111065078, -874.9823697080486, -1169.1942645729944, -1041.036213169975, -690.4057210396321, -588.2967660012047, -447.08349370733896, -614.2281053654152, -714.0186399897713, -59.94332885616639, -708.7740497107923, -1101.314174832399, -141.68537172248747, -253.7618475015997, -1128.7121899291835, -605.5202867876524, -653.6516499146231, -784.8161168475762, -486.07914422744994, -53.11419273838426, -1170.7769337701955, -118.90208637715152, -1057.43908650812, -442.3774511577433, -748.3814510851524, -1034.0823594768908, -902.3945942505629, -258.9309060453186, -156.40696512173426, -433.361359356633, -176.3800101537669, -477.23744546387485, -1090.0682595432102, -730.786242028955, -1254.2654711229577, -1191.5851684875863, -1161.4027633002765, -1034.0805672011898, -982.7449568379025, -503.42319983442457, -191.09221894550402, -73.90691113440862, -754.6009146041818, -73.09383276083004, -1208.4047349039215, -921.0012273727646, -955.7291153869336, -295.5757171360406, -1013.198524356382, -688.1152185765545, -953.4379454571227, -904.6686757581891, -1053.9394150961664, -17.55486700614473, -688.04345829684, -1207.6485118877788, -81.73163815035544, -751.8906528849695, -518.9667774055158, -926.7594920647377, -168.0313098023902, -955.4579802086785, -698.9899297818181, -1111.0440235826593, -826.3112943098238, -699.9078506877303, -957.783031778748, -687.401518246116, -782.2827418885123, -865.2019026841285, -829.9348282380513, -938.7857646138782, -142.70245049453854, -473.9944021412701, -998.6666332171756, -1320.3314808978816, -599.5010090420957, -783.0748301143926, -1102.1674423266031, -648.4139916622909, -506.4105206454988, -480.2124104552135, -1023.635201172696, -1222.550316067284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527733285318782, "mean_inference_ms": 1.6929009650627593, "mean_action_processing_ms": 0.2819191618112259, "mean_env_wait_ms": 3.0311691811029293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012398481369018555, "StateBufferConnector_ms": 0.008193016052246094, "ViewRequirementAgentConnector_ms": 0.20070242881774902}, "num_episodes": 26, "episode_return_max": -8.52746563449349, "episode_return_min": -1320.3314808978816, "episode_return_mean": -710.2975051334276, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.3773086062347, "num_env_steps_trained_throughput_per_sec": 298.3773086062347, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12942.792, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12942.707, "sample_time_ms": 1039.886, "learn_time_ms": 11836.489, "learn_throughput": 337.938, "synch_weights_time_ms": 65.389}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00012", "date": "2024-08-03_11-25-06", "timestamp": 1722664506, "time_this_iter_s": 13.417275667190552, "time_total_s": 192.13868713378906, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244526830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.13868713378906, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 13.973684210526315, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.00567496617634, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.692465983952085, "policy_loss": -0.005955622253046992, "vf_loss": 2.693758160620928, "vf_explained_var": 0.9867230741307139, "kl": 0.016076898547301727, "entropy": 1.5961783102403084, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -17.55486700614473, "episode_reward_min": -1320.3314808978816, "episode_reward_mean": -743.6116439536116, "episode_len_mean": 137.58, "episode_media": {}, "episodes_timesteps_total": 13758, "policy_reward_min": {"policy_0": -1320.3314808978816}, "policy_reward_max": {"policy_0": -17.55486700614473}, "policy_reward_mean": {"policy_0": -743.6116439536116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1101.314174832399, -141.68537172248747, -253.7618475015997, -1128.7121899291835, -605.5202867876524, -653.6516499146231, -784.8161168475762, -486.07914422744994, -53.11419273838426, -1170.7769337701955, -118.90208637715152, -1057.43908650812, -442.3774511577433, -748.3814510851524, -1034.0823594768908, -902.3945942505629, -258.9309060453186, -156.40696512173426, -433.361359356633, -176.3800101537669, -477.23744546387485, -1090.0682595432102, -730.786242028955, -1254.2654711229577, -1191.5851684875863, -1161.4027633002765, -1034.0805672011898, -982.7449568379025, -503.42319983442457, -191.09221894550402, -73.90691113440862, -754.6009146041818, -73.09383276083004, -1208.4047349039215, -921.0012273727646, -955.7291153869336, -295.5757171360406, -1013.198524356382, -688.1152185765545, -953.4379454571227, -904.6686757581891, -1053.9394150961664, -17.55486700614473, -688.04345829684, -1207.6485118877788, -81.73163815035544, -751.8906528849695, -518.9667774055158, -926.7594920647377, -168.0313098023902, -955.4579802086785, -698.9899297818181, -1111.0440235826593, -826.3112943098238, -699.9078506877303, -957.783031778748, -687.401518246116, -782.2827418885123, -865.2019026841285, -829.9348282380513, -938.7857646138782, -142.70245049453854, -473.9944021412701, -998.6666332171756, -1320.3314808978816, -599.5010090420957, -783.0748301143926, -1102.1674423266031, -648.4139916622909, -506.4105206454988, -480.2124104552135, -1023.635201172696, -1222.550316067284, -285.52982785191637, -964.1735920374223, -967.4734889450543, -835.041000791357, -693.8648022154907, -829.9663431196035, -1196.8870074990436, -493.27006161990784, -249.6588612311589, -688.9083179535276, -448.8379226886133, -80.00737658309909, -871.8999559870978, -1071.5558768943927, -1071.5711263069845, -867.0934973783341, -1117.157246001047, -717.6944555238439, -1318.8225399993275, -1068.8679104776531, -1017.027497103979, -865.6965518255458, -742.2692142146827, -774.883014382195, -957.4724418064576, -870.1475744739388, -1059.5519255796728], "episode_lengths": [150, 80, 150, 150, 150, 144, 150, 150, 62, 150, 85, 150, 122, 150, 150, 150, 150, 71, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 128, 105, 49, 150, 66, 150, 150, 150, 127, 150, 150, 150, 150, 150, 44, 150, 150, 57, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1101.314174832399, -141.68537172248747, -253.7618475015997, -1128.7121899291835, -605.5202867876524, -653.6516499146231, -784.8161168475762, -486.07914422744994, -53.11419273838426, -1170.7769337701955, -118.90208637715152, -1057.43908650812, -442.3774511577433, -748.3814510851524, -1034.0823594768908, -902.3945942505629, -258.9309060453186, -156.40696512173426, -433.361359356633, -176.3800101537669, -477.23744546387485, -1090.0682595432102, -730.786242028955, -1254.2654711229577, -1191.5851684875863, -1161.4027633002765, -1034.0805672011898, -982.7449568379025, -503.42319983442457, -191.09221894550402, -73.90691113440862, -754.6009146041818, -73.09383276083004, -1208.4047349039215, -921.0012273727646, -955.7291153869336, -295.5757171360406, -1013.198524356382, -688.1152185765545, -953.4379454571227, -904.6686757581891, -1053.9394150961664, -17.55486700614473, -688.04345829684, -1207.6485118877788, -81.73163815035544, -751.8906528849695, -518.9667774055158, -926.7594920647377, -168.0313098023902, -955.4579802086785, -698.9899297818181, -1111.0440235826593, -826.3112943098238, -699.9078506877303, -957.783031778748, -687.401518246116, -782.2827418885123, -865.2019026841285, -829.9348282380513, -938.7857646138782, -142.70245049453854, -473.9944021412701, -998.6666332171756, -1320.3314808978816, -599.5010090420957, -783.0748301143926, -1102.1674423266031, -648.4139916622909, -506.4105206454988, -480.2124104552135, -1023.635201172696, -1222.550316067284, -285.52982785191637, -964.1735920374223, -967.4734889450543, -835.041000791357, -693.8648022154907, -829.9663431196035, -1196.8870074990436, -493.27006161990784, -249.6588612311589, -688.9083179535276, -448.8379226886133, -80.00737658309909, -871.8999559870978, -1071.5558768943927, -1071.5711263069845, -867.0934973783341, -1117.157246001047, -717.6944555238439, -1318.8225399993275, -1068.8679104776531, -1017.027497103979, -865.6965518255458, -742.2692142146827, -774.883014382195, -957.4724418064576, -870.1475744739388, -1059.5519255796728]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5529299680891855, "mean_inference_ms": 1.6931430139541055, "mean_action_processing_ms": 0.2816715827095317, "mean_env_wait_ms": 3.033258234280117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012213945388793945, "StateBufferConnector_ms": 0.008107662200927734, "ViewRequirementAgentConnector_ms": 0.1989457607269287}, "num_episodes": 27, "episode_return_max": -17.55486700614473, "episode_return_min": -1320.3314808978816, "episode_return_mean": -743.6116439536116, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.05963130181135, "num_env_steps_trained_throughput_per_sec": 288.05963130181135, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13117.278, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13117.192, "sample_time_ms": 1041.061, "learn_time_ms": 12007.534, "learn_throughput": 333.124, "synch_weights_time_ms": 67.632}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00012", "date": "2024-08-03_11-25-20", "timestamp": 1722664520, "time_this_iter_s": 13.899702548980713, "time_total_s": 206.03838968276978, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b2440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 206.03838968276978, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.430000000000001, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 120.64626936614513, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.2632352159669002, "policy_loss": -0.014250505749563066, "vf_loss": 3.2732250769933064, "vf_explained_var": 0.9729493282735348, "kl": 0.014727271442113003, "entropy": 1.5753561366349458, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -17.55486700614473, "episode_reward_min": -1348.7149378567158, "episode_reward_mean": -722.0281825781345, "episode_len_mean": 135.96, "episode_media": {}, "episodes_timesteps_total": 13596, "policy_reward_min": {"policy_0": -1348.7149378567158}, "policy_reward_max": {"policy_0": -17.55486700614473}, "policy_reward_mean": {"policy_0": -722.0281825781345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1208.4047349039215, -921.0012273727646, -955.7291153869336, -295.5757171360406, -1013.198524356382, -688.1152185765545, -953.4379454571227, -904.6686757581891, -1053.9394150961664, -17.55486700614473, -688.04345829684, -1207.6485118877788, -81.73163815035544, -751.8906528849695, -518.9667774055158, -926.7594920647377, -168.0313098023902, -955.4579802086785, -698.9899297818181, -1111.0440235826593, -826.3112943098238, -699.9078506877303, -957.783031778748, -687.401518246116, -782.2827418885123, -865.2019026841285, -829.9348282380513, -938.7857646138782, -142.70245049453854, -473.9944021412701, -998.6666332171756, -1320.3314808978816, -599.5010090420957, -783.0748301143926, -1102.1674423266031, -648.4139916622909, -506.4105206454988, -480.2124104552135, -1023.635201172696, -1222.550316067284, -285.52982785191637, -964.1735920374223, -967.4734889450543, -835.041000791357, -693.8648022154907, -829.9663431196035, -1196.8870074990436, -493.27006161990784, -249.6588612311589, -688.9083179535276, -448.8379226886133, -80.00737658309909, -871.8999559870978, -1071.5558768943927, -1071.5711263069845, -867.0934973783341, -1117.157246001047, -717.6944555238439, -1318.8225399993275, -1068.8679104776531, -1017.027497103979, -865.6965518255458, -742.2692142146827, -774.883014382195, -957.4724418064576, -870.1475744739388, -1059.5519255796728, -739.8178491156727, -60.43121085195222, -472.46993587958417, -1269.648200759096, -510.51272338602706, -661.9485080890925, -262.6532390665135, -825.4714206296816, -270.41248788393955, -61.60800957984839, -751.0407156267362, -226.21982406801408, -566.6986719442071, -711.3794828398238, -118.28864705024553, -1006.969386532591, -827.9193942059986, -684.376898866429, -560.9058756541604, -1086.7927487224526, -540.9827168010838, -44.99220047908893, -728.4841610443337, -736.1444981939169, -667.4298535589198, -333.2847526725811, -1238.236389178006, -1348.7149378567158, -238.9382272027555, -269.0626995678425, -60.49276516300282, -266.2208358878028, -919.4807231640993], "episode_lengths": [150, 150, 150, 127, 150, 150, 150, 150, 150, 44, 150, 150, 57, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 113, 150, 83, 50, 150, 87, 142, 150, 55, 150, 150, 150, 122, 150, 150, 67, 150, 143, 143, 113, 150, 150, 112, 118, 47, 119, 150], "policy_policy_0_reward": [-1208.4047349039215, -921.0012273727646, -955.7291153869336, -295.5757171360406, -1013.198524356382, -688.1152185765545, -953.4379454571227, -904.6686757581891, -1053.9394150961664, -17.55486700614473, -688.04345829684, -1207.6485118877788, -81.73163815035544, -751.8906528849695, -518.9667774055158, -926.7594920647377, -168.0313098023902, -955.4579802086785, -698.9899297818181, -1111.0440235826593, -826.3112943098238, -699.9078506877303, -957.783031778748, -687.401518246116, -782.2827418885123, -865.2019026841285, -829.9348282380513, -938.7857646138782, -142.70245049453854, -473.9944021412701, -998.6666332171756, -1320.3314808978816, -599.5010090420957, -783.0748301143926, -1102.1674423266031, -648.4139916622909, -506.4105206454988, -480.2124104552135, -1023.635201172696, -1222.550316067284, -285.52982785191637, -964.1735920374223, -967.4734889450543, -835.041000791357, -693.8648022154907, -829.9663431196035, -1196.8870074990436, -493.27006161990784, -249.6588612311589, -688.9083179535276, -448.8379226886133, -80.00737658309909, -871.8999559870978, -1071.5558768943927, -1071.5711263069845, -867.0934973783341, -1117.157246001047, -717.6944555238439, -1318.8225399993275, -1068.8679104776531, -1017.027497103979, -865.6965518255458, -742.2692142146827, -774.883014382195, -957.4724418064576, -870.1475744739388, -1059.5519255796728, -739.8178491156727, -60.43121085195222, -472.46993587958417, -1269.648200759096, -510.51272338602706, -661.9485080890925, -262.6532390665135, -825.4714206296816, -270.41248788393955, -61.60800957984839, -751.0407156267362, -226.21982406801408, -566.6986719442071, -711.3794828398238, -118.28864705024553, -1006.969386532591, -827.9193942059986, -684.376898866429, -560.9058756541604, -1086.7927487224526, -540.9827168010838, -44.99220047908893, -728.4841610443337, -736.1444981939169, -667.4298535589198, -333.2847526725811, -1238.236389178006, -1348.7149378567158, -238.9382272027555, -269.0626995678425, -60.49276516300282, -266.2208358878028, -919.4807231640993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532896388862142, "mean_inference_ms": 1.6933818577457276, "mean_action_processing_ms": 0.28124308801948, "mean_env_wait_ms": 3.0355336549352554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012217521667480469, "StateBufferConnector_ms": 0.008111953735351562, "ViewRequirementAgentConnector_ms": 0.1974031925201416}, "num_episodes": 33, "episode_return_max": -17.55486700614473, "episode_return_min": -1348.7149378567158, "episode_return_mean": -722.0281825781345, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.95503327890646, "num_env_steps_trained_throughput_per_sec": 303.95503327890646, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13467.505, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13467.42, "sample_time_ms": 1045.226, "learn_time_ms": 12355.953, "learn_throughput": 323.731, "synch_weights_time_ms": 65.278}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00012", "date": "2024-08-03_11-25-34", "timestamp": 1722664534, "time_this_iter_s": 13.171794414520264, "time_total_s": 219.21018409729004, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245761fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 219.21018409729004, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 14.127777777777778, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 159.36421856284142, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.5721669497589272, "policy_loss": -0.01472089479599769, "vf_loss": 2.5823978553215663, "vf_explained_var": 0.9896282507727544, "kl": 0.015485950144829985, "entropy": 1.5579204076280198, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -42.36569275834338, "episode_reward_min": -1348.7149378567158, "episode_reward_mean": -688.892318658299, "episode_len_mean": 135.61, "episode_media": {}, "episodes_timesteps_total": 13561, "policy_reward_min": {"policy_0": -1348.7149378567158}, "policy_reward_max": {"policy_0": -42.36569275834338}, "policy_reward_mean": {"policy_0": -688.892318658299}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-998.6666332171756, -1320.3314808978816, -599.5010090420957, -783.0748301143926, -1102.1674423266031, -648.4139916622909, -506.4105206454988, -480.2124104552135, -1023.635201172696, -1222.550316067284, -285.52982785191637, -964.1735920374223, -967.4734889450543, -835.041000791357, -693.8648022154907, -829.9663431196035, -1196.8870074990436, -493.27006161990784, -249.6588612311589, -688.9083179535276, -448.8379226886133, -80.00737658309909, -871.8999559870978, -1071.5558768943927, -1071.5711263069845, -867.0934973783341, -1117.157246001047, -717.6944555238439, -1318.8225399993275, -1068.8679104776531, -1017.027497103979, -865.6965518255458, -742.2692142146827, -774.883014382195, -957.4724418064576, -870.1475744739388, -1059.5519255796728, -739.8178491156727, -60.43121085195222, -472.46993587958417, -1269.648200759096, -510.51272338602706, -661.9485080890925, -262.6532390665135, -825.4714206296816, -270.41248788393955, -61.60800957984839, -751.0407156267362, -226.21982406801408, -566.6986719442071, -711.3794828398238, -118.28864705024553, -1006.969386532591, -827.9193942059986, -684.376898866429, -560.9058756541604, -1086.7927487224526, -540.9827168010838, -44.99220047908893, -728.4841610443337, -736.1444981939169, -667.4298535589198, -333.2847526725811, -1238.236389178006, -1348.7149378567158, -238.9382272027555, -269.0626995678425, -60.49276516300282, -266.2208358878028, -919.4807231640993, -124.39197850595805, -420.227133279767, -1303.350903589088, -42.36569275834338, -465.827070402864, -529.4892479212917, -753.1781529565768, -957.7397986410962, -633.8162777801462, -89.7973304774749, -1138.4404229182094, -703.2046629384831, -854.1639175519094, -340.9170760395009, -265.2624412247615, -973.9291876242085, -1167.1338173099782, -1241.309864055729, -755.6002111010882, -384.19367359335257, -716.9982285250777, -727.0337610573124, -470.59213431267506, -152.26822576537526, -746.7286966230324, -265.7139060825051, -643.5906475966838, -704.8793070766678, -771.2769014900762, -667.4879390159967], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 113, 150, 83, 50, 150, 87, 142, 150, 55, 150, 150, 150, 122, 150, 150, 67, 150, 143, 143, 113, 150, 150, 112, 118, 47, 119, 150, 72, 150, 150, 62, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 82, 150, 150, 150, 150], "policy_policy_0_reward": [-998.6666332171756, -1320.3314808978816, -599.5010090420957, -783.0748301143926, -1102.1674423266031, -648.4139916622909, -506.4105206454988, -480.2124104552135, -1023.635201172696, -1222.550316067284, -285.52982785191637, -964.1735920374223, -967.4734889450543, -835.041000791357, -693.8648022154907, -829.9663431196035, -1196.8870074990436, -493.27006161990784, -249.6588612311589, -688.9083179535276, -448.8379226886133, -80.00737658309909, -871.8999559870978, -1071.5558768943927, -1071.5711263069845, -867.0934973783341, -1117.157246001047, -717.6944555238439, -1318.8225399993275, -1068.8679104776531, -1017.027497103979, -865.6965518255458, -742.2692142146827, -774.883014382195, -957.4724418064576, -870.1475744739388, -1059.5519255796728, -739.8178491156727, -60.43121085195222, -472.46993587958417, -1269.648200759096, -510.51272338602706, -661.9485080890925, -262.6532390665135, -825.4714206296816, -270.41248788393955, -61.60800957984839, -751.0407156267362, -226.21982406801408, -566.6986719442071, -711.3794828398238, -118.28864705024553, -1006.969386532591, -827.9193942059986, -684.376898866429, -560.9058756541604, -1086.7927487224526, -540.9827168010838, -44.99220047908893, -728.4841610443337, -736.1444981939169, -667.4298535589198, -333.2847526725811, -1238.236389178006, -1348.7149378567158, -238.9382272027555, -269.0626995678425, -60.49276516300282, -266.2208358878028, -919.4807231640993, -124.39197850595805, -420.227133279767, -1303.350903589088, -42.36569275834338, -465.827070402864, -529.4892479212917, -753.1781529565768, -957.7397986410962, -633.8162777801462, -89.7973304774749, -1138.4404229182094, -703.2046629384831, -854.1639175519094, -340.9170760395009, -265.2624412247615, -973.9291876242085, -1167.1338173099782, -1241.309864055729, -755.6002111010882, -384.19367359335257, -716.9982285250777, -727.0337610573124, -470.59213431267506, -152.26822576537526, -746.7286966230324, -265.7139060825051, -643.5906475966838, -704.8793070766678, -771.2769014900762, -667.4879390159967]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540660824132506, "mean_inference_ms": 1.6955095249256353, "mean_action_processing_ms": 0.281512566145998, "mean_env_wait_ms": 3.037775018561947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012244462966918945, "StateBufferConnector_ms": 0.008192300796508789, "ViewRequirementAgentConnector_ms": 0.19993257522583008}, "num_episodes": 30, "episode_return_max": -42.36569275834338, "episode_return_min": -1348.7149378567158, "episode_return_mean": -688.892318658299, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.6530145996492, "num_env_steps_trained_throughput_per_sec": 299.6530145996492, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13450.278, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13450.191, "sample_time_ms": 1044.351, "learn_time_ms": 12340.195, "learn_throughput": 324.144, "synch_weights_time_ms": 64.723}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00012", "date": "2024-08-03_11-25-47", "timestamp": 1722664547, "time_this_iter_s": 13.362027168273926, "time_total_s": 232.57221126556396, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244526830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 232.57221126556396, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.604999999999999, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 183.61139108935993, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.407607009758552, "policy_loss": -0.013492156967307286, "vf_loss": 2.4169915369401376, "vf_explained_var": 0.9896646732464432, "kl": 0.014305562390230394, "entropy": 1.8403328326841195, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -42.36569275834338, "episode_reward_min": -1363.1679938474222, "episode_reward_mean": -703.6724244992218, "episode_len_mean": 136.87, "episode_media": {}, "episodes_timesteps_total": 13687, "policy_reward_min": {"policy_0": -1363.1679938474222}, "policy_reward_max": {"policy_0": -42.36569275834338}, "policy_reward_mean": {"policy_0": -703.6724244992218}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1318.8225399993275, -1068.8679104776531, -1017.027497103979, -865.6965518255458, -742.2692142146827, -774.883014382195, -957.4724418064576, -870.1475744739388, -1059.5519255796728, -739.8178491156727, -60.43121085195222, -472.46993587958417, -1269.648200759096, -510.51272338602706, -661.9485080890925, -262.6532390665135, -825.4714206296816, -270.41248788393955, -61.60800957984839, -751.0407156267362, -226.21982406801408, -566.6986719442071, -711.3794828398238, -118.28864705024553, -1006.969386532591, -827.9193942059986, -684.376898866429, -560.9058756541604, -1086.7927487224526, -540.9827168010838, -44.99220047908893, -728.4841610443337, -736.1444981939169, -667.4298535589198, -333.2847526725811, -1238.236389178006, -1348.7149378567158, -238.9382272027555, -269.0626995678425, -60.49276516300282, -266.2208358878028, -919.4807231640993, -124.39197850595805, -420.227133279767, -1303.350903589088, -42.36569275834338, -465.827070402864, -529.4892479212917, -753.1781529565768, -957.7397986410962, -633.8162777801462, -89.7973304774749, -1138.4404229182094, -703.2046629384831, -854.1639175519094, -340.9170760395009, -265.2624412247615, -973.9291876242085, -1167.1338173099782, -1241.309864055729, -755.6002111010882, -384.19367359335257, -716.9982285250777, -727.0337610573124, -470.59213431267506, -152.26822576537526, -746.7286966230324, -265.7139060825051, -643.5906475966838, -704.8793070766678, -771.2769014900762, -667.4879390159967, -873.9258508666071, -885.3557329747072, -1127.5694457468903, -1076.3853894570782, -970.6097064325888, -973.8547124850427, -384.0912368984419, -798.5430129988216, -865.729513446553, -1086.7365858521875, -1093.2542216067984, -433.93255436570684, -450.7686761404211, -954.2814939867629, -777.0518913016733, -866.869433295838, -1267.7537279264498, -1363.1679938474222, -762.160579680701, -657.740489590421, -1140.8694619864873, -649.7159896679767, -654.2643828136039, -1184.422005601381, -196.29094587551384, -434.246104530258, -981.4344458157207, -702.5395951292357], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 113, 150, 83, 50, 150, 87, 142, 150, 55, 150, 150, 150, 122, 150, 150, 67, 150, 143, 143, 113, 150, 150, 112, 118, 47, 119, 150, 72, 150, 150, 62, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150], "policy_policy_0_reward": [-1318.8225399993275, -1068.8679104776531, -1017.027497103979, -865.6965518255458, -742.2692142146827, -774.883014382195, -957.4724418064576, -870.1475744739388, -1059.5519255796728, -739.8178491156727, -60.43121085195222, -472.46993587958417, -1269.648200759096, -510.51272338602706, -661.9485080890925, -262.6532390665135, -825.4714206296816, -270.41248788393955, -61.60800957984839, -751.0407156267362, -226.21982406801408, -566.6986719442071, -711.3794828398238, -118.28864705024553, -1006.969386532591, -827.9193942059986, -684.376898866429, -560.9058756541604, -1086.7927487224526, -540.9827168010838, -44.99220047908893, -728.4841610443337, -736.1444981939169, -667.4298535589198, -333.2847526725811, -1238.236389178006, -1348.7149378567158, -238.9382272027555, -269.0626995678425, -60.49276516300282, -266.2208358878028, -919.4807231640993, -124.39197850595805, -420.227133279767, -1303.350903589088, -42.36569275834338, -465.827070402864, -529.4892479212917, -753.1781529565768, -957.7397986410962, -633.8162777801462, -89.7973304774749, -1138.4404229182094, -703.2046629384831, -854.1639175519094, -340.9170760395009, -265.2624412247615, -973.9291876242085, -1167.1338173099782, -1241.309864055729, -755.6002111010882, -384.19367359335257, -716.9982285250777, -727.0337610573124, -470.59213431267506, -152.26822576537526, -746.7286966230324, -265.7139060825051, -643.5906475966838, -704.8793070766678, -771.2769014900762, -667.4879390159967, -873.9258508666071, -885.3557329747072, -1127.5694457468903, -1076.3853894570782, -970.6097064325888, -973.8547124850427, -384.0912368984419, -798.5430129988216, -865.729513446553, -1086.7365858521875, -1093.2542216067984, -433.93255436570684, -450.7686761404211, -954.2814939867629, -777.0518913016733, -866.869433295838, -1267.7537279264498, -1363.1679938474222, -762.160579680701, -657.740489590421, -1140.8694619864873, -649.7159896679767, -654.2643828136039, -1184.422005601381, -196.29094587551384, -434.246104530258, -981.4344458157207, -702.5395951292357]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541685844378837, "mean_inference_ms": 1.695809424413617, "mean_action_processing_ms": 0.28156881878953144, "mean_env_wait_ms": 3.038989891761362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01227879524230957, "StateBufferConnector_ms": 0.008107662200927734, "ViewRequirementAgentConnector_ms": 0.19957852363586426}, "num_episodes": 28, "episode_return_max": -42.36569275834338, "episode_return_min": -1363.1679938474222, "episode_return_mean": -703.6724244992218, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.0907615342327, "num_env_steps_trained_throughput_per_sec": 303.0907615342327, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13463.433, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13463.346, "sample_time_ms": 1050.041, "learn_time_ms": 12347.214, "learn_throughput": 323.96, "synch_weights_time_ms": 65.168}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00012", "date": "2024-08-03_11-26-00", "timestamp": 1722664560, "time_this_iter_s": 13.210967063903809, "time_total_s": 245.78317832946777, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c01f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 245.78317832946777, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.8, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 180.9077785273393, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.3677360030512014, "policy_loss": -0.010079753835452721, "vf_loss": 2.3735155052194994, "vf_explained_var": 0.9927082672094305, "kl": 0.014899258290188311, "entropy": 1.695239578684171, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -42.36569275834338, "episode_reward_min": -1363.1679938474222, "episode_reward_mean": -712.0681426521674, "episode_len_mean": 139.04, "episode_media": {}, "episodes_timesteps_total": 13904, "policy_reward_min": {"policy_0": -1363.1679938474222}, "policy_reward_max": {"policy_0": -42.36569275834338}, "policy_reward_mean": {"policy_0": -712.0681426521674}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.99220047908893, -728.4841610443337, -736.1444981939169, -667.4298535589198, -333.2847526725811, -1238.236389178006, -1348.7149378567158, -238.9382272027555, -269.0626995678425, -60.49276516300282, -266.2208358878028, -919.4807231640993, -124.39197850595805, -420.227133279767, -1303.350903589088, -42.36569275834338, -465.827070402864, -529.4892479212917, -753.1781529565768, -957.7397986410962, -633.8162777801462, -89.7973304774749, -1138.4404229182094, -703.2046629384831, -854.1639175519094, -340.9170760395009, -265.2624412247615, -973.9291876242085, -1167.1338173099782, -1241.309864055729, -755.6002111010882, -384.19367359335257, -716.9982285250777, -727.0337610573124, -470.59213431267506, -152.26822576537526, -746.7286966230324, -265.7139060825051, -643.5906475966838, -704.8793070766678, -771.2769014900762, -667.4879390159967, -873.9258508666071, -885.3557329747072, -1127.5694457468903, -1076.3853894570782, -970.6097064325888, -973.8547124850427, -384.0912368984419, -798.5430129988216, -865.729513446553, -1086.7365858521875, -1093.2542216067984, -433.93255436570684, -450.7686761404211, -954.2814939867629, -777.0518913016733, -866.869433295838, -1267.7537279264498, -1363.1679938474222, -762.160579680701, -657.740489590421, -1140.8694619864873, -649.7159896679767, -654.2643828136039, -1184.422005601381, -196.29094587551384, -434.246104530258, -981.4344458157207, -702.5395951292357, -1064.4335319364077, -543.1673041766738, -970.673961006436, -559.5205437146777, -890.3610947609932, -569.6110099991002, -334.3494804327451, -562.5312711940229, -851.7487560098205, -1089.6403337003323, -962.85587865534, -1010.0983014407068, -855.5392272793583, -301.518930415631, -1018.1571202839929, -775.3013538087015, -1277.38363894263, -203.0684953967529, -977.9096901872857, -65.16015039894513, -550.6351595526535, -902.470222464277, -935.3673615666517, -405.38045889464564, -983.0398162710019, -913.7367991893582, -216.98493281363585, -1040.3406239465162, -666.8767644014911, -232.9962198703769], "episode_lengths": [67, 150, 143, 143, 113, 150, 150, 112, 118, 47, 119, 150, 72, 150, 150, 62, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 142, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 70, 150, 150, 150, 150, 150, 150, 120, 150, 150, 89], "policy_policy_0_reward": [-44.99220047908893, -728.4841610443337, -736.1444981939169, -667.4298535589198, -333.2847526725811, -1238.236389178006, -1348.7149378567158, -238.9382272027555, -269.0626995678425, -60.49276516300282, -266.2208358878028, -919.4807231640993, -124.39197850595805, -420.227133279767, -1303.350903589088, -42.36569275834338, -465.827070402864, -529.4892479212917, -753.1781529565768, -957.7397986410962, -633.8162777801462, -89.7973304774749, -1138.4404229182094, -703.2046629384831, -854.1639175519094, -340.9170760395009, -265.2624412247615, -973.9291876242085, -1167.1338173099782, -1241.309864055729, -755.6002111010882, -384.19367359335257, -716.9982285250777, -727.0337610573124, -470.59213431267506, -152.26822576537526, -746.7286966230324, -265.7139060825051, -643.5906475966838, -704.8793070766678, -771.2769014900762, -667.4879390159967, -873.9258508666071, -885.3557329747072, -1127.5694457468903, -1076.3853894570782, -970.6097064325888, -973.8547124850427, -384.0912368984419, -798.5430129988216, -865.729513446553, -1086.7365858521875, -1093.2542216067984, -433.93255436570684, -450.7686761404211, -954.2814939867629, -777.0518913016733, -866.869433295838, -1267.7537279264498, -1363.1679938474222, -762.160579680701, -657.740489590421, -1140.8694619864873, -649.7159896679767, -654.2643828136039, -1184.422005601381, -196.29094587551384, -434.246104530258, -981.4344458157207, -702.5395951292357, -1064.4335319364077, -543.1673041766738, -970.673961006436, -559.5205437146777, -890.3610947609932, -569.6110099991002, -334.3494804327451, -562.5312711940229, -851.7487560098205, -1089.6403337003323, -962.85587865534, -1010.0983014407068, -855.5392272793583, -301.518930415631, -1018.1571202839929, -775.3013538087015, -1277.38363894263, -203.0684953967529, -977.9096901872857, -65.16015039894513, -550.6351595526535, -902.470222464277, -935.3673615666517, -405.38045889464564, -983.0398162710019, -913.7367991893582, -216.98493281363585, -1040.3406239465162, -666.8767644014911, -232.9962198703769]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536236221693168, "mean_inference_ms": 1.6951095696476983, "mean_action_processing_ms": 0.28117577660086523, "mean_env_wait_ms": 3.041247072031812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012096405029296875, "StateBufferConnector_ms": 0.007984638214111328, "ViewRequirementAgentConnector_ms": 0.197556734085083}, "num_episodes": 30, "episode_return_max": -42.36569275834338, "episode_return_min": -1363.1679938474222, "episode_return_mean": -712.0681426521674, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.6392043429815, "num_env_steps_trained_throughput_per_sec": 291.6392043429815, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13434.518, "restore_workers_time_ms": 0.036, "training_step_time_ms": 13434.426, "sample_time_ms": 1045.841, "learn_time_ms": 12320.741, "learn_throughput": 324.656, "synch_weights_time_ms": 66.897}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00012", "date": "2024-08-03_11-26-14", "timestamp": 1722664574, "time_this_iter_s": 13.72952914237976, "time_total_s": 259.51270747184753, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457624d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 259.51270747184753, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.645, "ram_util_percent": 27.749999999999993}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 162.01945372025173, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.062708896646897, "policy_loss": -0.015938380317917715, "vf_loss": 2.074181432897846, "vf_explained_var": 0.9912525381272038, "kl": 0.015393629224854521, "entropy": 1.5224524557590484, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -65.16015039894513, "episode_reward_min": -1363.1679938474222, "episode_reward_mean": -749.7959564724812, "episode_len_mean": 142.88, "episode_media": {}, "episodes_timesteps_total": 14288, "policy_reward_min": {"policy_0": -1363.1679938474222}, "policy_reward_max": {"policy_0": -65.16015039894513}, "policy_reward_mean": {"policy_0": -749.7959564724812}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-265.2624412247615, -973.9291876242085, -1167.1338173099782, -1241.309864055729, -755.6002111010882, -384.19367359335257, -716.9982285250777, -727.0337610573124, -470.59213431267506, -152.26822576537526, -746.7286966230324, -265.7139060825051, -643.5906475966838, -704.8793070766678, -771.2769014900762, -667.4879390159967, -873.9258508666071, -885.3557329747072, -1127.5694457468903, -1076.3853894570782, -970.6097064325888, -973.8547124850427, -384.0912368984419, -798.5430129988216, -865.729513446553, -1086.7365858521875, -1093.2542216067984, -433.93255436570684, -450.7686761404211, -954.2814939867629, -777.0518913016733, -866.869433295838, -1267.7537279264498, -1363.1679938474222, -762.160579680701, -657.740489590421, -1140.8694619864873, -649.7159896679767, -654.2643828136039, -1184.422005601381, -196.29094587551384, -434.246104530258, -981.4344458157207, -702.5395951292357, -1064.4335319364077, -543.1673041766738, -970.673961006436, -559.5205437146777, -890.3610947609932, -569.6110099991002, -334.3494804327451, -562.5312711940229, -851.7487560098205, -1089.6403337003323, -962.85587865534, -1010.0983014407068, -855.5392272793583, -301.518930415631, -1018.1571202839929, -775.3013538087015, -1277.38363894263, -203.0684953967529, -977.9096901872857, -65.16015039894513, -550.6351595526535, -902.470222464277, -935.3673615666517, -405.38045889464564, -983.0398162710019, -913.7367991893582, -216.98493281363585, -1040.3406239465162, -666.8767644014911, -232.9962198703769, -506.12743634807435, -509.6341612505933, -797.8655861955292, -608.0476037230574, -592.734151121361, -189.1296858458932, -487.8733504369996, -1210.5432459970848, -955.6535029358514, -571.0388862548454, -921.6306607352069, -75.59047649027491, -1262.993801506061, -834.9321821300894, -862.3751283270739, -498.1698676913507, -414.1772872912844, -844.8055815687853, -447.1754389380956, -1080.5403589282255, -461.8169079620625, -857.8507083938717, -1023.5726439019152, -1104.1756138245064, -1046.4114505363636, -816.3073734266728], "episode_lengths": [101, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 142, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 70, 150, 150, 150, 150, 150, 150, 120, 150, 150, 89, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-265.2624412247615, -973.9291876242085, -1167.1338173099782, -1241.309864055729, -755.6002111010882, -384.19367359335257, -716.9982285250777, -727.0337610573124, -470.59213431267506, -152.26822576537526, -746.7286966230324, -265.7139060825051, -643.5906475966838, -704.8793070766678, -771.2769014900762, -667.4879390159967, -873.9258508666071, -885.3557329747072, -1127.5694457468903, -1076.3853894570782, -970.6097064325888, -973.8547124850427, -384.0912368984419, -798.5430129988216, -865.729513446553, -1086.7365858521875, -1093.2542216067984, -433.93255436570684, -450.7686761404211, -954.2814939867629, -777.0518913016733, -866.869433295838, -1267.7537279264498, -1363.1679938474222, -762.160579680701, -657.740489590421, -1140.8694619864873, -649.7159896679767, -654.2643828136039, -1184.422005601381, -196.29094587551384, -434.246104530258, -981.4344458157207, -702.5395951292357, -1064.4335319364077, -543.1673041766738, -970.673961006436, -559.5205437146777, -890.3610947609932, -569.6110099991002, -334.3494804327451, -562.5312711940229, -851.7487560098205, -1089.6403337003323, -962.85587865534, -1010.0983014407068, -855.5392272793583, -301.518930415631, -1018.1571202839929, -775.3013538087015, -1277.38363894263, -203.0684953967529, -977.9096901872857, -65.16015039894513, -550.6351595526535, -902.470222464277, -935.3673615666517, -405.38045889464564, -983.0398162710019, -913.7367991893582, -216.98493281363585, -1040.3406239465162, -666.8767644014911, -232.9962198703769, -506.12743634807435, -509.6341612505933, -797.8655861955292, -608.0476037230574, -592.734151121361, -189.1296858458932, -487.8733504369996, -1210.5432459970848, -955.6535029358514, -571.0388862548454, -921.6306607352069, -75.59047649027491, -1262.993801506061, -834.9321821300894, -862.3751283270739, -498.1698676913507, -414.1772872912844, -844.8055815687853, -447.1754389380956, -1080.5403589282255, -461.8169079620625, -857.8507083938717, -1023.5726439019152, -1104.1756138245064, -1046.4114505363636, -816.3073734266728]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530682321507033, "mean_inference_ms": 1.694311957862923, "mean_action_processing_ms": 0.28097765393194846, "mean_env_wait_ms": 3.0439398950619716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012092828750610352, "StateBufferConnector_ms": 0.007772922515869141, "ViewRequirementAgentConnector_ms": 0.19636011123657227}, "num_episodes": 26, "episode_return_max": -65.16015039894513, "episode_return_min": -1363.1679938474222, "episode_return_mean": -749.7959564724812, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.6772149422488, "num_env_steps_trained_throughput_per_sec": 295.6772149422488, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13459.756, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13459.668, "sample_time_ms": 1041.748, "learn_time_ms": 12350.775, "learn_throughput": 323.866, "synch_weights_time_ms": 66.207}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00012", "date": "2024-08-03_11-26-28", "timestamp": 1722664588, "time_this_iter_s": 13.540752172470093, "time_total_s": 273.0534596443176, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b2dd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 273.0534596443176, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.531578947368422, "ram_util_percent": 27.78421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 190.35288575092952, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.26079410413901, "policy_loss": -0.010443875603959896, "vf_loss": 2.2670720973362526, "vf_explained_var": 0.9895064369464914, "kl": 0.014460908493674667, "entropy": 1.723800177872181, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -65.16015039894513, "episode_reward_min": -1363.1679938474222, "episode_reward_mean": -710.6395697306315, "episode_len_mean": 140.41, "episode_media": {}, "episodes_timesteps_total": 14041, "policy_reward_min": {"policy_0": -1363.1679938474222}, "policy_reward_max": {"policy_0": -65.16015039894513}, "policy_reward_mean": {"policy_0": -710.6395697306315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-777.0518913016733, -866.869433295838, -1267.7537279264498, -1363.1679938474222, -762.160579680701, -657.740489590421, -1140.8694619864873, -649.7159896679767, -654.2643828136039, -1184.422005601381, -196.29094587551384, -434.246104530258, -981.4344458157207, -702.5395951292357, -1064.4335319364077, -543.1673041766738, -970.673961006436, -559.5205437146777, -890.3610947609932, -569.6110099991002, -334.3494804327451, -562.5312711940229, -851.7487560098205, -1089.6403337003323, -962.85587865534, -1010.0983014407068, -855.5392272793583, -301.518930415631, -1018.1571202839929, -775.3013538087015, -1277.38363894263, -203.0684953967529, -977.9096901872857, -65.16015039894513, -550.6351595526535, -902.470222464277, -935.3673615666517, -405.38045889464564, -983.0398162710019, -913.7367991893582, -216.98493281363585, -1040.3406239465162, -666.8767644014911, -232.9962198703769, -506.12743634807435, -509.6341612505933, -797.8655861955292, -608.0476037230574, -592.734151121361, -189.1296858458932, -487.8733504369996, -1210.5432459970848, -955.6535029358514, -571.0388862548454, -921.6306607352069, -75.59047649027491, -1262.993801506061, -834.9321821300894, -862.3751283270739, -498.1698676913507, -414.1772872912844, -844.8055815687853, -447.1754389380956, -1080.5403589282255, -461.8169079620625, -857.8507083938717, -1023.5726439019152, -1104.1756138245064, -1046.4114505363636, -816.3073734266728, -496.96762184436204, -834.3422553804223, -435.04091036289935, -663.768098615375, -986.2197586885331, -89.61282338903852, -650.5710681778754, -916.2276150173145, -571.6002478383751, -650.3451085839117, -615.7479696291355, -986.3397971876706, -976.5776747591832, -77.57590366413652, -106.57890868099706, -717.8783470220935, -865.1499367104578, -118.46505308489634, -155.12455178306777, -591.9810543447658, -583.1717494529428, -1096.4150028646382, -852.4859546998467, -672.1569460310521, -1008.4820547576493, -623.368333961767, -326.4954486537941, -864.7795405982037, -656.4535574566577, -523.475108287116], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 142, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 70, 150, 150, 150, 150, 150, 150, 120, 150, 150, 89, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 119, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 59, 74, 150, 150, 75, 100, 150, 150, 150, 150, 150, 150, 137, 121, 150, 150, 150], "policy_policy_0_reward": [-777.0518913016733, -866.869433295838, -1267.7537279264498, -1363.1679938474222, -762.160579680701, -657.740489590421, -1140.8694619864873, -649.7159896679767, -654.2643828136039, -1184.422005601381, -196.29094587551384, -434.246104530258, -981.4344458157207, -702.5395951292357, -1064.4335319364077, -543.1673041766738, -970.673961006436, -559.5205437146777, -890.3610947609932, -569.6110099991002, -334.3494804327451, -562.5312711940229, -851.7487560098205, -1089.6403337003323, -962.85587865534, -1010.0983014407068, -855.5392272793583, -301.518930415631, -1018.1571202839929, -775.3013538087015, -1277.38363894263, -203.0684953967529, -977.9096901872857, -65.16015039894513, -550.6351595526535, -902.470222464277, -935.3673615666517, -405.38045889464564, -983.0398162710019, -913.7367991893582, -216.98493281363585, -1040.3406239465162, -666.8767644014911, -232.9962198703769, -506.12743634807435, -509.6341612505933, -797.8655861955292, -608.0476037230574, -592.734151121361, -189.1296858458932, -487.8733504369996, -1210.5432459970848, -955.6535029358514, -571.0388862548454, -921.6306607352069, -75.59047649027491, -1262.993801506061, -834.9321821300894, -862.3751283270739, -498.1698676913507, -414.1772872912844, -844.8055815687853, -447.1754389380956, -1080.5403589282255, -461.8169079620625, -857.8507083938717, -1023.5726439019152, -1104.1756138245064, -1046.4114505363636, -816.3073734266728, -496.96762184436204, -834.3422553804223, -435.04091036289935, -663.768098615375, -986.2197586885331, -89.61282338903852, -650.5710681778754, -916.2276150173145, -571.6002478383751, -650.3451085839117, -615.7479696291355, -986.3397971876706, -976.5776747591832, -77.57590366413652, -106.57890868099706, -717.8783470220935, -865.1499367104578, -118.46505308489634, -155.12455178306777, -591.9810543447658, -583.1717494529428, -1096.4150028646382, -852.4859546998467, -672.1569460310521, -1008.4820547576493, -623.368333961767, -326.4954486537941, -864.7795405982037, -656.4535574566577, -523.475108287116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530639953429168, "mean_inference_ms": 1.694281265272496, "mean_action_processing_ms": 0.28081025953592303, "mean_env_wait_ms": 3.0457426120771847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012228250503540039, "StateBufferConnector_ms": 0.007802486419677734, "ViewRequirementAgentConnector_ms": 0.1985642910003662}, "num_episodes": 30, "episode_return_max": -65.16015039894513, "episode_return_min": -1363.1679938474222, "episode_return_mean": -710.6395697306315, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.56064221331457, "num_env_steps_trained_throughput_per_sec": 289.56064221331457, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13515.687, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13515.603, "sample_time_ms": 1045.473, "learn_time_ms": 12402.339, "learn_throughput": 322.52, "synch_weights_time_ms": 66.845}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00012", "date": "2024-08-03_11-26-41", "timestamp": 1722664601, "time_this_iter_s": 13.828245878219604, "time_total_s": 286.88170552253723, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f53520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 286.88170552253723, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.75, "ram_util_percent": 27.794999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.16068456570306, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.8207187886039415, "policy_loss": -0.014068221183454929, "vf_loss": 2.8305497540781897, "vf_explained_var": 0.9847792899236083, "kl": 0.01464952516307676, "entropy": 1.5760522890836, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -65.16015039894513, "episode_reward_min": -1277.38363894263, "episode_reward_mean": -694.7288976343672, "episode_len_mean": 137.97, "episode_media": {}, "episodes_timesteps_total": 13797, "policy_reward_min": {"policy_0": -1277.38363894263}, "policy_reward_max": {"policy_0": -65.16015039894513}, "policy_reward_mean": {"policy_0": -694.7288976343672}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-775.3013538087015, -1277.38363894263, -203.0684953967529, -977.9096901872857, -65.16015039894513, -550.6351595526535, -902.470222464277, -935.3673615666517, -405.38045889464564, -983.0398162710019, -913.7367991893582, -216.98493281363585, -1040.3406239465162, -666.8767644014911, -232.9962198703769, -506.12743634807435, -509.6341612505933, -797.8655861955292, -608.0476037230574, -592.734151121361, -189.1296858458932, -487.8733504369996, -1210.5432459970848, -955.6535029358514, -571.0388862548454, -921.6306607352069, -75.59047649027491, -1262.993801506061, -834.9321821300894, -862.3751283270739, -498.1698676913507, -414.1772872912844, -844.8055815687853, -447.1754389380956, -1080.5403589282255, -461.8169079620625, -857.8507083938717, -1023.5726439019152, -1104.1756138245064, -1046.4114505363636, -816.3073734266728, -496.96762184436204, -834.3422553804223, -435.04091036289935, -663.768098615375, -986.2197586885331, -89.61282338903852, -650.5710681778754, -916.2276150173145, -571.6002478383751, -650.3451085839117, -615.7479696291355, -986.3397971876706, -976.5776747591832, -77.57590366413652, -106.57890868099706, -717.8783470220935, -865.1499367104578, -118.46505308489634, -155.12455178306777, -591.9810543447658, -583.1717494529428, -1096.4150028646382, -852.4859546998467, -672.1569460310521, -1008.4820547576493, -623.368333961767, -326.4954486537941, -864.7795405982037, -656.4535574566577, -523.475108287116, -1077.9468174359824, -321.2576667982243, -508.7300198800208, -880.6278798502881, -223.3969741123019, -707.5225398355136, -812.1676399449796, -1104.3077730039654, -1048.9761744207085, -901.3015950292676, -1177.9642451375967, -555.9008012876475, -639.3024765699861, -1163.9809801991657, -568.5020474096434, -726.0883142956986, -676.636710476729, -1003.026999263222, -769.4122307188478, -306.29632926225213, -965.2991661964135, -1235.294434017147, -324.3911190208493, -1016.7831403102902, -926.5065448059669, -266.9112910677336, -954.7906497084969, -241.6599972257762, -526.6840251577581], "episode_lengths": [150, 150, 106, 150, 70, 150, 150, 150, 150, 150, 150, 120, 150, 150, 89, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 119, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 59, 74, 150, 150, 75, 100, 150, 150, 150, 150, 150, 150, 137, 121, 150, 150, 150, 150, 131, 108, 150, 73, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 118, 150, 150, 95, 150, 150, 83, 150, 96, 150], "policy_policy_0_reward": [-775.3013538087015, -1277.38363894263, -203.0684953967529, -977.9096901872857, -65.16015039894513, -550.6351595526535, -902.470222464277, -935.3673615666517, -405.38045889464564, -983.0398162710019, -913.7367991893582, -216.98493281363585, -1040.3406239465162, -666.8767644014911, -232.9962198703769, -506.12743634807435, -509.6341612505933, -797.8655861955292, -608.0476037230574, -592.734151121361, -189.1296858458932, -487.8733504369996, -1210.5432459970848, -955.6535029358514, -571.0388862548454, -921.6306607352069, -75.59047649027491, -1262.993801506061, -834.9321821300894, -862.3751283270739, -498.1698676913507, -414.1772872912844, -844.8055815687853, -447.1754389380956, -1080.5403589282255, -461.8169079620625, -857.8507083938717, -1023.5726439019152, -1104.1756138245064, -1046.4114505363636, -816.3073734266728, -496.96762184436204, -834.3422553804223, -435.04091036289935, -663.768098615375, -986.2197586885331, -89.61282338903852, -650.5710681778754, -916.2276150173145, -571.6002478383751, -650.3451085839117, -615.7479696291355, -986.3397971876706, -976.5776747591832, -77.57590366413652, -106.57890868099706, -717.8783470220935, -865.1499367104578, -118.46505308489634, -155.12455178306777, -591.9810543447658, -583.1717494529428, -1096.4150028646382, -852.4859546998467, -672.1569460310521, -1008.4820547576493, -623.368333961767, -326.4954486537941, -864.7795405982037, -656.4535574566577, -523.475108287116, -1077.9468174359824, -321.2576667982243, -508.7300198800208, -880.6278798502881, -223.3969741123019, -707.5225398355136, -812.1676399449796, -1104.3077730039654, -1048.9761744207085, -901.3015950292676, -1177.9642451375967, -555.9008012876475, -639.3024765699861, -1163.9809801991657, -568.5020474096434, -726.0883142956986, -676.636710476729, -1003.026999263222, -769.4122307188478, -306.29632926225213, -965.2991661964135, -1235.294434017147, -324.3911190208493, -1016.7831403102902, -926.5065448059669, -266.9112910677336, -954.7906497084969, -241.6599972257762, -526.6840251577581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533627514790063, "mean_inference_ms": 1.6942107718563029, "mean_action_processing_ms": 0.2807978803276955, "mean_env_wait_ms": 3.046400181858113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012530326843261719, "StateBufferConnector_ms": 0.007913351058959961, "ViewRequirementAgentConnector_ms": 0.20090174674987793}, "num_episodes": 29, "episode_return_max": -65.16015039894513, "episode_return_min": -1277.38363894263, "episode_return_mean": -694.7288976343672, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.8335855707497, "num_env_steps_trained_throughput_per_sec": 311.8335855707497, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13431.128, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13431.044, "sample_time_ms": 1044.017, "learn_time_ms": 12317.323, "learn_throughput": 324.746, "synch_weights_time_ms": 68.759}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00012", "date": "2024-08-03_11-26-54", "timestamp": 1722664614, "time_this_iter_s": 12.840909957885742, "time_total_s": 299.722615480423, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244526e60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 299.722615480423, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 14.005555555555555, "ram_util_percent": 27.755555555555553}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 178.83029311498007, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.574013153091073, "policy_loss": -0.011677908882362923, "vf_loss": 2.5813883615036803, "vf_explained_var": 0.9873941425854961, "kl": 0.014874498248051787, "entropy": 1.5965281845380863, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 0.21452996703160143, "episode_reward_min": -1235.294434017147, "episode_reward_mean": -689.9811211844049, "episode_len_mean": 135.57, "episode_media": {}, "episodes_timesteps_total": 13557, "policy_reward_min": {"policy_0": -1235.294434017147}, "policy_reward_max": {"policy_0": 0.21452996703160143}, "policy_reward_mean": {"policy_0": -689.9811211844049}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-414.1772872912844, -844.8055815687853, -447.1754389380956, -1080.5403589282255, -461.8169079620625, -857.8507083938717, -1023.5726439019152, -1104.1756138245064, -1046.4114505363636, -816.3073734266728, -496.96762184436204, -834.3422553804223, -435.04091036289935, -663.768098615375, -986.2197586885331, -89.61282338903852, -650.5710681778754, -916.2276150173145, -571.6002478383751, -650.3451085839117, -615.7479696291355, -986.3397971876706, -976.5776747591832, -77.57590366413652, -106.57890868099706, -717.8783470220935, -865.1499367104578, -118.46505308489634, -155.12455178306777, -591.9810543447658, -583.1717494529428, -1096.4150028646382, -852.4859546998467, -672.1569460310521, -1008.4820547576493, -623.368333961767, -326.4954486537941, -864.7795405982037, -656.4535574566577, -523.475108287116, -1077.9468174359824, -321.2576667982243, -508.7300198800208, -880.6278798502881, -223.3969741123019, -707.5225398355136, -812.1676399449796, -1104.3077730039654, -1048.9761744207085, -901.3015950292676, -1177.9642451375967, -555.9008012876475, -639.3024765699861, -1163.9809801991657, -568.5020474096434, -726.0883142956986, -676.636710476729, -1003.026999263222, -769.4122307188478, -306.29632926225213, -965.2991661964135, -1235.294434017147, -324.3911190208493, -1016.7831403102902, -926.5065448059669, -266.9112910677336, -954.7906497084969, -241.6599972257762, -526.6840251577581, -89.95914204043699, -342.3239105958292, -1225.329631316424, -922.7122429753425, -295.1734331832009, -741.929111019344, -822.829768112152, 0.21452996703160143, -255.5358834930447, -1036.9201392973075, -1106.2794710617115, -1011.9722829685535, -482.01746313376765, -625.4680132563534, -859.7102565300112, -89.44677074949149, -873.3527969443134, -628.7592573855111, -836.4494432232005, -93.53031173445733, -845.1421464469986, -675.0133644750466, -75.84557355959036, -876.4870744929643, -1119.6297956343244, -833.1437666269325, -266.1994128513862, -701.370417282787, -1007.3600562401555, -1129.6625653728702, -686.8747976615794], "episode_lengths": [118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 119, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 59, 74, 150, 150, 75, 100, 150, 150, 150, 150, 150, 150, 137, 121, 150, 150, 150, 150, 131, 108, 150, 73, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 118, 150, 150, 95, 150, 150, 83, 150, 96, 150, 67, 126, 150, 150, 90, 150, 150, 38, 103, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 87, 150, 150, 66, 150, 150, 150, 101, 133, 150, 150, 150], "policy_policy_0_reward": [-414.1772872912844, -844.8055815687853, -447.1754389380956, -1080.5403589282255, -461.8169079620625, -857.8507083938717, -1023.5726439019152, -1104.1756138245064, -1046.4114505363636, -816.3073734266728, -496.96762184436204, -834.3422553804223, -435.04091036289935, -663.768098615375, -986.2197586885331, -89.61282338903852, -650.5710681778754, -916.2276150173145, -571.6002478383751, -650.3451085839117, -615.7479696291355, -986.3397971876706, -976.5776747591832, -77.57590366413652, -106.57890868099706, -717.8783470220935, -865.1499367104578, -118.46505308489634, -155.12455178306777, -591.9810543447658, -583.1717494529428, -1096.4150028646382, -852.4859546998467, -672.1569460310521, -1008.4820547576493, -623.368333961767, -326.4954486537941, -864.7795405982037, -656.4535574566577, -523.475108287116, -1077.9468174359824, -321.2576667982243, -508.7300198800208, -880.6278798502881, -223.3969741123019, -707.5225398355136, -812.1676399449796, -1104.3077730039654, -1048.9761744207085, -901.3015950292676, -1177.9642451375967, -555.9008012876475, -639.3024765699861, -1163.9809801991657, -568.5020474096434, -726.0883142956986, -676.636710476729, -1003.026999263222, -769.4122307188478, -306.29632926225213, -965.2991661964135, -1235.294434017147, -324.3911190208493, -1016.7831403102902, -926.5065448059669, -266.9112910677336, -954.7906497084969, -241.6599972257762, -526.6840251577581, -89.95914204043699, -342.3239105958292, -1225.329631316424, -922.7122429753425, -295.1734331832009, -741.929111019344, -822.829768112152, 0.21452996703160143, -255.5358834930447, -1036.9201392973075, -1106.2794710617115, -1011.9722829685535, -482.01746313376765, -625.4680132563534, -859.7102565300112, -89.44677074949149, -873.3527969443134, -628.7592573855111, -836.4494432232005, -93.53031173445733, -845.1421464469986, -675.0133644750466, -75.84557355959036, -876.4870744929643, -1119.6297956343244, -833.1437666269325, -266.1994128513862, -701.370417282787, -1007.3600562401555, -1129.6625653728702, -686.8747976615794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540258269587596, "mean_inference_ms": 1.694626086313617, "mean_action_processing_ms": 0.2809390472227838, "mean_env_wait_ms": 3.044126686979947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012736082077026367, "StateBufferConnector_ms": 0.00808095932006836, "ViewRequirementAgentConnector_ms": 0.22120165824890137}, "num_episodes": 31, "episode_return_max": 0.21452996703160143, "episode_return_min": -1235.294434017147, "episode_return_mean": -689.9811211844049, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.47862758742303, "num_env_steps_trained_throughput_per_sec": 297.47862758742303, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13432.957, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13432.871, "sample_time_ms": 1043.974, "learn_time_ms": 12318.568, "learn_throughput": 324.713, "synch_weights_time_ms": 69.389}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00012", "date": "2024-08-03_11-27-08", "timestamp": 1722664628, "time_this_iter_s": 13.45947790145874, "time_total_s": 313.1820933818817, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c03a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 313.1820933818817, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.910526315789474, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 157.39651420911153, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.30631088539958, "policy_loss": -0.009663924155756832, "vf_loss": 2.3124601280937593, "vf_explained_var": 0.9785408280789852, "kl": 0.01228054205354662, "entropy": 1.6948444034904242, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": 0.21452996703160143, "episode_reward_min": -1397.1322739569769, "episode_reward_mean": -689.2607054465312, "episode_len_mean": 134.29, "episode_media": {}, "episodes_timesteps_total": 13429, "policy_reward_min": {"policy_0": -1397.1322739569769}, "policy_reward_max": {"policy_0": 0.21452996703160143}, "policy_reward_mean": {"policy_0": -689.2607054465312}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1096.4150028646382, -852.4859546998467, -672.1569460310521, -1008.4820547576493, -623.368333961767, -326.4954486537941, -864.7795405982037, -656.4535574566577, -523.475108287116, -1077.9468174359824, -321.2576667982243, -508.7300198800208, -880.6278798502881, -223.3969741123019, -707.5225398355136, -812.1676399449796, -1104.3077730039654, -1048.9761744207085, -901.3015950292676, -1177.9642451375967, -555.9008012876475, -639.3024765699861, -1163.9809801991657, -568.5020474096434, -726.0883142956986, -676.636710476729, -1003.026999263222, -769.4122307188478, -306.29632926225213, -965.2991661964135, -1235.294434017147, -324.3911190208493, -1016.7831403102902, -926.5065448059669, -266.9112910677336, -954.7906497084969, -241.6599972257762, -526.6840251577581, -89.95914204043699, -342.3239105958292, -1225.329631316424, -922.7122429753425, -295.1734331832009, -741.929111019344, -822.829768112152, 0.21452996703160143, -255.5358834930447, -1036.9201392973075, -1106.2794710617115, -1011.9722829685535, -482.01746313376765, -625.4680132563534, -859.7102565300112, -89.44677074949149, -873.3527969443134, -628.7592573855111, -836.4494432232005, -93.53031173445733, -845.1421464469986, -675.0133644750466, -75.84557355959036, -876.4870744929643, -1119.6297956343244, -833.1437666269325, -266.1994128513862, -701.370417282787, -1007.3600562401555, -1129.6625653728702, -686.8747976615794, -1397.1322739569769, -697.7585928718375, -295.4998242109726, -857.6692833350636, -168.33663854371662, -412.0746742264828, -787.4063633621562, -1088.7013091626368, -73.94782583246042, -147.72262856938335, -1004.1996875697614, -264.9789338159656, -956.3993995295997, -510.16647769115457, -1024.1043364175164, -1250.8375369093283, -741.5778327974723, -695.4617414405803, -664.0241510990593, -707.6315128367545, -443.04280031635557, -752.2975230796925, -411.82275646725304, -886.0056657441106, -763.1891994932001, -36.40465734230592, -714.7751320917359, -193.85393293190245, -1016.8914782316323, -250.27793190151252, -899.886143423295], "episode_lengths": [150, 150, 150, 150, 137, 121, 150, 150, 150, 150, 131, 108, 150, 73, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 118, 150, 150, 95, 150, 150, 83, 150, 96, 150, 67, 126, 150, 150, 90, 150, 150, 38, 103, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 87, 150, 150, 66, 150, 150, 150, 101, 133, 150, 150, 150, 150, 150, 90, 150, 116, 99, 149, 150, 64, 81, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 53, 150, 73, 150, 84, 150], "policy_policy_0_reward": [-1096.4150028646382, -852.4859546998467, -672.1569460310521, -1008.4820547576493, -623.368333961767, -326.4954486537941, -864.7795405982037, -656.4535574566577, -523.475108287116, -1077.9468174359824, -321.2576667982243, -508.7300198800208, -880.6278798502881, -223.3969741123019, -707.5225398355136, -812.1676399449796, -1104.3077730039654, -1048.9761744207085, -901.3015950292676, -1177.9642451375967, -555.9008012876475, -639.3024765699861, -1163.9809801991657, -568.5020474096434, -726.0883142956986, -676.636710476729, -1003.026999263222, -769.4122307188478, -306.29632926225213, -965.2991661964135, -1235.294434017147, -324.3911190208493, -1016.7831403102902, -926.5065448059669, -266.9112910677336, -954.7906497084969, -241.6599972257762, -526.6840251577581, -89.95914204043699, -342.3239105958292, -1225.329631316424, -922.7122429753425, -295.1734331832009, -741.929111019344, -822.829768112152, 0.21452996703160143, -255.5358834930447, -1036.9201392973075, -1106.2794710617115, -1011.9722829685535, -482.01746313376765, -625.4680132563534, -859.7102565300112, -89.44677074949149, -873.3527969443134, -628.7592573855111, -836.4494432232005, -93.53031173445733, -845.1421464469986, -675.0133644750466, -75.84557355959036, -876.4870744929643, -1119.6297956343244, -833.1437666269325, -266.1994128513862, -701.370417282787, -1007.3600562401555, -1129.6625653728702, -686.8747976615794, -1397.1322739569769, -697.7585928718375, -295.4998242109726, -857.6692833350636, -168.33663854371662, -412.0746742264828, -787.4063633621562, -1088.7013091626368, -73.94782583246042, -147.72262856938335, -1004.1996875697614, -264.9789338159656, -956.3993995295997, -510.16647769115457, -1024.1043364175164, -1250.8375369093283, -741.5778327974723, -695.4617414405803, -664.0241510990593, -707.6315128367545, -443.04280031635557, -752.2975230796925, -411.82275646725304, -886.0056657441106, -763.1891994932001, -36.40465734230592, -714.7751320917359, -193.85393293190245, -1016.8914782316323, -250.27793190151252, -899.886143423295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5546303425036543, "mean_inference_ms": 1.6947103546941094, "mean_action_processing_ms": 0.2808332562263461, "mean_env_wait_ms": 3.041649154101969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012408256530761719, "StateBufferConnector_ms": 0.008066415786743164, "ViewRequirementAgentConnector_ms": 0.2174062728881836}, "num_episodes": 31, "episode_return_max": 0.21452996703160143, "episode_return_min": -1397.1322739569769, "episode_return_mean": -689.2607054465312, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.41265665394417, "num_env_steps_trained_throughput_per_sec": 297.41265665394417, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13437.305, "restore_workers_time_ms": 0.04, "training_step_time_ms": 13437.211, "sample_time_ms": 1046.325, "learn_time_ms": 12320.558, "learn_throughput": 324.661, "synch_weights_time_ms": 69.42}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00012", "date": "2024-08-03_11-27-21", "timestamp": 1722664641, "time_this_iter_s": 13.462202310562134, "time_total_s": 326.64429569244385, "pid": 525640, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c2830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 326.64429569244385, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.915789473684208, "ram_util_percent": 27.710526315789473}}
