{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2685835846078892, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.60824559132258, "policy_loss": -0.008400387954801166, "vf_loss": 9.62882065474987, "vf_explained_var": 0.08993672703703244, "kl": 0.012061905674075508, "entropy": 1.4587064310908318, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -67.38236025265525, "episode_reward_min": -1103.9534668855133, "episode_reward_mean": -713.5845914316523, "episode_len_mean": 136.375, "episode_media": {}, "episodes_timesteps_total": 3273, "policy_reward_min": {"policy_0": -1103.9534668855133}, "policy_reward_max": {"policy_0": -67.38236025265525}, "policy_reward_mean": {"policy_0": -713.5845914316523}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-935.786205417908, -972.1416190058345, -801.4093747569292, -478.489809029355, -100.63090020254721, -704.9751908573488, -1080.685221333039, -864.6313714122052, -1098.2765923043567, -375.3428756364141, -948.6354491247638, -118.45163051320698, -864.4755529347481, -1001.5615084881701, -733.1081303507552, -468.6031146229691, -813.2138084274055, -897.4989787644939, -411.729473070789, -67.38236025265525, -985.9801390161143, -769.2152459242305, -529.8521760279019, -1103.9534668855133], "episode_lengths": [150, 150, 150, 124, 58, 150, 150, 150, 150, 139, 150, 92, 150, 150, 150, 150, 150, 150, 104, 56, 150, 150, 150, 150], "policy_policy_0_reward": [-935.786205417908, -972.1416190058345, -801.4093747569292, -478.489809029355, -100.63090020254721, -704.9751908573488, -1080.685221333039, -864.6313714122052, -1098.2765923043567, -375.3428756364141, -948.6354491247638, -118.45163051320698, -864.4755529347481, -1001.5615084881701, -733.1081303507552, -468.6031146229691, -813.2138084274055, -897.4989787644939, -411.729473070789, -67.38236025265525, -985.9801390161143, -769.2152459242305, -529.8521760279019, -1103.9534668855133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.566545619165956, "mean_inference_ms": 1.6640726568663649, "mean_action_processing_ms": 0.28107979125381494, "mean_env_wait_ms": 2.97240521781224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011064608891805014, "StateBufferConnector_ms": 0.0076323747634887695, "ViewRequirementAgentConnector_ms": 0.17349322636922201}, "num_episodes": 24, "episode_return_max": -67.38236025265525, "episode_return_min": -1103.9534668855133, "episode_return_mean": -713.5845914316523, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.2251343434865, "num_env_steps_trained_throughput_per_sec": 310.2251343434865, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12893.871, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12893.804, "sample_time_ms": 1015.706, "learn_time_ms": 11808.15, "learn_throughput": 338.749, "synch_weights_time_ms": 68.975}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00014", "date": "2024-08-03_11-33-30", "timestamp": 1722665010, "time_this_iter_s": 12.904501914978027, "time_total_s": 12.904501914978027, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457624d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.904501914978027, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 13.136842105263158, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.418960167374462, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.276954076190789, "policy_loss": -0.006567289230103294, "vf_loss": 9.296117303768794, "vf_explained_var": 0.11384420270721117, "kl": 0.010012635132519184, "entropy": 1.4598465297371148, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -62.140539479585016, "episode_reward_min": -1193.5332918131007, "episode_reward_mean": -734.1907739506835, "episode_len_mean": 141.10638297872342, "episode_media": {}, "episodes_timesteps_total": 6632, "policy_reward_min": {"policy_0": -1193.5332918131007}, "policy_reward_max": {"policy_0": -62.140539479585016}, "policy_reward_mean": {"policy_0": -734.1907739506835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-935.786205417908, -972.1416190058345, -801.4093747569292, -478.489809029355, -100.63090020254721, -704.9751908573488, -1080.685221333039, -864.6313714122052, -1098.2765923043567, -375.3428756364141, -948.6354491247638, -118.45163051320698, -864.4755529347481, -1001.5615084881701, -733.1081303507552, -468.6031146229691, -813.2138084274055, -897.4989787644939, -411.729473070789, -67.38236025265525, -985.9801390161143, -769.2152459242305, -529.8521760279019, -1103.9534668855133, -1193.5332918131007, -1156.2009465250437, -797.3659217951946, -1031.3904665965401, -871.4740354119053, -462.88627264105236, -456.7550369366438, -967.5004555355774, -1159.8552760353903, -670.8526843507449, -878.5216989157135, -1000.150111810026, -639.6668457741239, -610.562743361804, -757.2406458404271, -976.435805032328, -479.398951539648, -856.541529814117, -619.6377494969468, -435.27649897377177, -436.3205786595928, -861.2280949831903, -62.140539479585016], "episode_lengths": [150, 150, 150, 124, 58, 150, 150, 150, 150, 139, 150, 92, 150, 150, 150, 150, 150, 150, 104, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59], "policy_policy_0_reward": [-935.786205417908, -972.1416190058345, -801.4093747569292, -478.489809029355, -100.63090020254721, -704.9751908573488, -1080.685221333039, -864.6313714122052, -1098.2765923043567, -375.3428756364141, -948.6354491247638, -118.45163051320698, -864.4755529347481, -1001.5615084881701, -733.1081303507552, -468.6031146229691, -813.2138084274055, -897.4989787644939, -411.729473070789, -67.38236025265525, -985.9801390161143, -769.2152459242305, -529.8521760279019, -1103.9534668855133, -1193.5332918131007, -1156.2009465250437, -797.3659217951946, -1031.3904665965401, -871.4740354119053, -462.88627264105236, -456.7550369366438, -967.5004555355774, -1159.8552760353903, -670.8526843507449, -878.5216989157135, -1000.150111810026, -639.6668457741239, -610.562743361804, -757.2406458404271, -976.435805032328, -479.398951539648, -856.541529814117, -619.6377494969468, -435.27649897377177, -436.3205786595928, -861.2280949831903, -62.140539479585016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5693009894119408, "mean_inference_ms": 1.6831680032134053, "mean_action_processing_ms": 0.28340831484395873, "mean_env_wait_ms": 2.9840877594428803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014327434783286236, "StateBufferConnector_ms": 0.008015936993538066, "ViewRequirementAgentConnector_ms": 0.18290053022668717}, "num_episodes": 23, "episode_return_max": -62.140539479585016, "episode_return_min": -1193.5332918131007, "episode_return_mean": -734.1907739506835, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.770675660296, "num_env_steps_trained_throughput_per_sec": 307.770675660296, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12945.287, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12945.217, "sample_time_ms": 1021.753, "learn_time_ms": 11850.337, "learn_throughput": 337.543, "synch_weights_time_ms": 72.253}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00014", "date": "2024-08-03_11-33-43", "timestamp": 1722665023, "time_this_iter_s": 13.009360313415527, "time_total_s": 25.913862228393555, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b24d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.913862228393555, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 14.377777777777778, "ram_util_percent": 27.65555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.197155801517268, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.723762654761474, "policy_loss": -0.010404883444910714, "vf_loss": 8.74589399298032, "vf_explained_var": 0.2690232725193103, "kl": 0.01376698544700048, "entropy": 1.447984129562974, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -62.140539479585016, "episode_reward_min": -1240.226442717783, "episode_reward_mean": -732.6690913446427, "episode_len_mean": 141.05479452054794, "episode_media": {}, "episodes_timesteps_total": 10297, "policy_reward_min": {"policy_0": -1240.226442717783}, "policy_reward_max": {"policy_0": -62.140539479585016}, "policy_reward_mean": {"policy_0": -732.6690913446427}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-935.786205417908, -972.1416190058345, -801.4093747569292, -478.489809029355, -100.63090020254721, -704.9751908573488, -1080.685221333039, -864.6313714122052, -1098.2765923043567, -375.3428756364141, -948.6354491247638, -118.45163051320698, -864.4755529347481, -1001.5615084881701, -733.1081303507552, -468.6031146229691, -813.2138084274055, -897.4989787644939, -411.729473070789, -67.38236025265525, -985.9801390161143, -769.2152459242305, -529.8521760279019, -1103.9534668855133, -1193.5332918131007, -1156.2009465250437, -797.3659217951946, -1031.3904665965401, -871.4740354119053, -462.88627264105236, -456.7550369366438, -967.5004555355774, -1159.8552760353903, -670.8526843507449, -878.5216989157135, -1000.150111810026, -639.6668457741239, -610.562743361804, -757.2406458404271, -976.435805032328, -479.398951539648, -856.541529814117, -619.6377494969468, -435.27649897377177, -436.3205786595928, -861.2280949831903, -62.140539479585016, -649.3759240985534, -668.3092570887987, -652.7935529199739, -916.3471954765289, -761.5735145959447, -237.58394921790398, -583.9628832320329, -420.01637766303725, -1139.5179419153799, -769.436340307, -614.0611051041573, -180.46041663957746, -1133.5789092738166, -1130.6978930595208, -906.0053545719288, -389.329492075343, -85.04269984198193, -1240.226442717783, -859.2832189468531, -1110.7137874046741, -321.1723181512683, -976.8092657688026, -568.1679063704084, -1104.260486769227, -444.56507978167275, -1114.585979484623], "episode_lengths": [150, 150, 150, 124, 58, 150, 150, 150, 150, 139, 150, 92, 150, 150, 150, 150, 150, 150, 104, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 95, 150, 150, 150, 104, 64, 150, 150, 150, 107, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-935.786205417908, -972.1416190058345, -801.4093747569292, -478.489809029355, -100.63090020254721, -704.9751908573488, -1080.685221333039, -864.6313714122052, -1098.2765923043567, -375.3428756364141, -948.6354491247638, -118.45163051320698, -864.4755529347481, -1001.5615084881701, -733.1081303507552, -468.6031146229691, -813.2138084274055, -897.4989787644939, -411.729473070789, -67.38236025265525, -985.9801390161143, -769.2152459242305, -529.8521760279019, -1103.9534668855133, -1193.5332918131007, -1156.2009465250437, -797.3659217951946, -1031.3904665965401, -871.4740354119053, -462.88627264105236, -456.7550369366438, -967.5004555355774, -1159.8552760353903, -670.8526843507449, -878.5216989157135, -1000.150111810026, -639.6668457741239, -610.562743361804, -757.2406458404271, -976.435805032328, -479.398951539648, -856.541529814117, -619.6377494969468, -435.27649897377177, -436.3205786595928, -861.2280949831903, -62.140539479585016, -649.3759240985534, -668.3092570887987, -652.7935529199739, -916.3471954765289, -761.5735145959447, -237.58394921790398, -583.9628832320329, -420.01637766303725, -1139.5179419153799, -769.436340307, -614.0611051041573, -180.46041663957746, -1133.5789092738166, -1130.6978930595208, -906.0053545719288, -389.329492075343, -85.04269984198193, -1240.226442717783, -859.2832189468531, -1110.7137874046741, -321.1723181512683, -976.8092657688026, -568.1679063704084, -1104.260486769227, -444.56507978167275, -1114.585979484623]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5688537974674265, "mean_inference_ms": 1.6888128255503145, "mean_action_processing_ms": 0.2841318402045325, "mean_env_wait_ms": 2.9849938827846914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013544134897728488, "StateBufferConnector_ms": 0.008146403587027772, "ViewRequirementAgentConnector_ms": 0.18601482861662563}, "num_episodes": 26, "episode_return_max": -62.140539479585016, "episode_return_min": -1240.226442717783, "episode_return_mean": -732.6690913446427, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.6674988089584, "num_env_steps_trained_throughput_per_sec": 308.6674988089584, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12949.838, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12949.767, "sample_time_ms": 1016.095, "learn_time_ms": 11860.146, "learn_throughput": 337.264, "synch_weights_time_ms": 72.654}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00014", "date": "2024-08-03_11-33-56", "timestamp": 1722665036, "time_this_iter_s": 12.970959663391113, "time_total_s": 38.88482189178467, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444353f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.88482189178467, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.547368421052633, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.009582087149223, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.517874995370706, "policy_loss": -0.009925108329237748, "vf_loss": 7.539183056354522, "vf_explained_var": 0.6017656054968635, "kl": 0.016015826800139625, "entropy": 1.4586091625193756, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -57.00345120578245, "episode_reward_min": -1240.226442717783, "episode_reward_mean": -729.8436017914112, "episode_len_mean": 141.33, "episode_media": {}, "episodes_timesteps_total": 14133, "policy_reward_min": {"policy_0": -1240.226442717783}, "policy_reward_max": {"policy_0": -57.00345120578245}, "policy_reward_mean": {"policy_0": -729.8436017914112}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-935.786205417908, -972.1416190058345, -801.4093747569292, -478.489809029355, -100.63090020254721, -704.9751908573488, -1080.685221333039, -864.6313714122052, -1098.2765923043567, -375.3428756364141, -948.6354491247638, -118.45163051320698, -864.4755529347481, -1001.5615084881701, -733.1081303507552, -468.6031146229691, -813.2138084274055, -897.4989787644939, -411.729473070789, -67.38236025265525, -985.9801390161143, -769.2152459242305, -529.8521760279019, -1103.9534668855133, -1193.5332918131007, -1156.2009465250437, -797.3659217951946, -1031.3904665965401, -871.4740354119053, -462.88627264105236, -456.7550369366438, -967.5004555355774, -1159.8552760353903, -670.8526843507449, -878.5216989157135, -1000.150111810026, -639.6668457741239, -610.562743361804, -757.2406458404271, -976.435805032328, -479.398951539648, -856.541529814117, -619.6377494969468, -435.27649897377177, -436.3205786595928, -861.2280949831903, -62.140539479585016, -649.3759240985534, -668.3092570887987, -652.7935529199739, -916.3471954765289, -761.5735145959447, -237.58394921790398, -583.9628832320329, -420.01637766303725, -1139.5179419153799, -769.436340307, -614.0611051041573, -180.46041663957746, -1133.5789092738166, -1130.6978930595208, -906.0053545719288, -389.329492075343, -85.04269984198193, -1240.226442717783, -859.2832189468531, -1110.7137874046741, -321.1723181512683, -976.8092657688026, -568.1679063704084, -1104.260486769227, -444.56507978167275, -1114.585979484623, -1035.278746923468, -1058.8387857768482, -962.3027146179376, -479.6909401618088, -602.6659396826694, -916.3302500301241, -958.2965484533239, -808.7147287761046, -772.904590358595, -731.015573480424, -1070.764555238569, -166.9888461487513, -595.9927484977728, -746.4766886296571, -872.2313775932613, -801.1686277234224, -57.00345120578245, -901.0269461746797, -905.7785869796146, -748.0356145826761, -711.8990878896705, -512.9220928274804, -70.1250756297702, -830.1280909970084, -582.0920331584782, -926.5319139705537, -674.3119554737435], "episode_lengths": [150, 150, 150, 124, 58, 150, 150, 150, 150, 139, 150, 92, 150, 150, 150, 150, 150, 150, 104, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 95, 150, 150, 150, 104, 64, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150], "policy_policy_0_reward": [-935.786205417908, -972.1416190058345, -801.4093747569292, -478.489809029355, -100.63090020254721, -704.9751908573488, -1080.685221333039, -864.6313714122052, -1098.2765923043567, -375.3428756364141, -948.6354491247638, -118.45163051320698, -864.4755529347481, -1001.5615084881701, -733.1081303507552, -468.6031146229691, -813.2138084274055, -897.4989787644939, -411.729473070789, -67.38236025265525, -985.9801390161143, -769.2152459242305, -529.8521760279019, -1103.9534668855133, -1193.5332918131007, -1156.2009465250437, -797.3659217951946, -1031.3904665965401, -871.4740354119053, -462.88627264105236, -456.7550369366438, -967.5004555355774, -1159.8552760353903, -670.8526843507449, -878.5216989157135, -1000.150111810026, -639.6668457741239, -610.562743361804, -757.2406458404271, -976.435805032328, -479.398951539648, -856.541529814117, -619.6377494969468, -435.27649897377177, -436.3205786595928, -861.2280949831903, -62.140539479585016, -649.3759240985534, -668.3092570887987, -652.7935529199739, -916.3471954765289, -761.5735145959447, -237.58394921790398, -583.9628832320329, -420.01637766303725, -1139.5179419153799, -769.436340307, -614.0611051041573, -180.46041663957746, -1133.5789092738166, -1130.6978930595208, -906.0053545719288, -389.329492075343, -85.04269984198193, -1240.226442717783, -859.2832189468531, -1110.7137874046741, -321.1723181512683, -976.8092657688026, -568.1679063704084, -1104.260486769227, -444.56507978167275, -1114.585979484623, -1035.278746923468, -1058.8387857768482, -962.3027146179376, -479.6909401618088, -602.6659396826694, -916.3302500301241, -958.2965484533239, -808.7147287761046, -772.904590358595, -731.015573480424, -1070.764555238569, -166.9888461487513, -595.9927484977728, -746.4766886296571, -872.2313775932613, -801.1686277234224, -57.00345120578245, -901.0269461746797, -905.7785869796146, -748.0356145826761, -711.8990878896705, -512.9220928274804, -70.1250756297702, -830.1280909970084, -582.0920331584782, -926.5319139705537, -674.3119554737435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5674488493996211, "mean_inference_ms": 1.6935380237666116, "mean_action_processing_ms": 0.28477322770159097, "mean_env_wait_ms": 2.986199860806071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014338493347167969, "StateBufferConnector_ms": 0.008338451385498047, "ViewRequirementAgentConnector_ms": 0.18814492225646973}, "num_episodes": 27, "episode_return_max": -57.00345120578245, "episode_return_min": -1240.226442717783, "episode_return_mean": -729.8436017914112, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.06283393786873, "num_env_steps_trained_throughput_per_sec": 304.06283393786873, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13001.176, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13001.103, "sample_time_ms": 1017.137, "learn_time_ms": 11907.658, "learn_throughput": 335.918, "synch_weights_time_ms": 75.445}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00014", "date": "2024-08-03_11-34-09", "timestamp": 1722665049, "time_this_iter_s": 13.168461799621582, "time_total_s": 52.05328369140625, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457624d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.05328369140625, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.652631578947368, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.49136737932761, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.3185692946116125, "policy_loss": -0.014120741128863301, "vf_loss": 6.343899693091711, "vf_explained_var": 0.7577779877309998, "kl": 0.01776469704938488, "entropy": 1.4762573421001435, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -16.77511030611402, "episode_reward_min": -1263.6980189642634, "episode_reward_mean": -677.7443299304255, "episode_len_mean": 139.77, "episode_media": {}, "episodes_timesteps_total": 13977, "policy_reward_min": {"policy_0": -1263.6980189642634}, "policy_reward_max": {"policy_0": -16.77511030611402}, "policy_reward_mean": {"policy_0": -677.7443299304255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-462.88627264105236, -456.7550369366438, -967.5004555355774, -1159.8552760353903, -670.8526843507449, -878.5216989157135, -1000.150111810026, -639.6668457741239, -610.562743361804, -757.2406458404271, -976.435805032328, -479.398951539648, -856.541529814117, -619.6377494969468, -435.27649897377177, -436.3205786595928, -861.2280949831903, -62.140539479585016, -649.3759240985534, -668.3092570887987, -652.7935529199739, -916.3471954765289, -761.5735145959447, -237.58394921790398, -583.9628832320329, -420.01637766303725, -1139.5179419153799, -769.436340307, -614.0611051041573, -180.46041663957746, -1133.5789092738166, -1130.6978930595208, -906.0053545719288, -389.329492075343, -85.04269984198193, -1240.226442717783, -859.2832189468531, -1110.7137874046741, -321.1723181512683, -976.8092657688026, -568.1679063704084, -1104.260486769227, -444.56507978167275, -1114.585979484623, -1035.278746923468, -1058.8387857768482, -962.3027146179376, -479.6909401618088, -602.6659396826694, -916.3302500301241, -958.2965484533239, -808.7147287761046, -772.904590358595, -731.015573480424, -1070.764555238569, -166.9888461487513, -595.9927484977728, -746.4766886296571, -872.2313775932613, -801.1686277234224, -57.00345120578245, -901.0269461746797, -905.7785869796146, -748.0356145826761, -711.8990878896705, -512.9220928274804, -70.1250756297702, -830.1280909970084, -582.0920331584782, -926.5319139705537, -674.3119554737435, -378.0306878547446, -641.5761198891959, -314.6764143717458, -311.171381741417, -673.3908572588447, -402.39158912307926, -1263.6980189642634, -564.0455004524755, -16.77511030611402, -768.9834972383296, -224.69881286104678, -796.2491246573226, -646.2609916457546, -184.3873909024325, -384.43161895267764, -579.3052089027475, -762.3493687100186, -54.46402470121884, -924.3545091383311, -657.9057769586581, -839.1848704863647, -403.27545054727904, -692.6727663438014, -162.850199478088, -1071.8285852324036, -979.1192753581086, -644.0435141757212, -776.0336947651172, -847.913309385572], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 95, 150, 150, 150, 104, 64, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 55, 150, 119, 150, 150, 65, 123, 150, 150, 66, 150, 150, 150, 135, 150, 66, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-462.88627264105236, -456.7550369366438, -967.5004555355774, -1159.8552760353903, -670.8526843507449, -878.5216989157135, -1000.150111810026, -639.6668457741239, -610.562743361804, -757.2406458404271, -976.435805032328, -479.398951539648, -856.541529814117, -619.6377494969468, -435.27649897377177, -436.3205786595928, -861.2280949831903, -62.140539479585016, -649.3759240985534, -668.3092570887987, -652.7935529199739, -916.3471954765289, -761.5735145959447, -237.58394921790398, -583.9628832320329, -420.01637766303725, -1139.5179419153799, -769.436340307, -614.0611051041573, -180.46041663957746, -1133.5789092738166, -1130.6978930595208, -906.0053545719288, -389.329492075343, -85.04269984198193, -1240.226442717783, -859.2832189468531, -1110.7137874046741, -321.1723181512683, -976.8092657688026, -568.1679063704084, -1104.260486769227, -444.56507978167275, -1114.585979484623, -1035.278746923468, -1058.8387857768482, -962.3027146179376, -479.6909401618088, -602.6659396826694, -916.3302500301241, -958.2965484533239, -808.7147287761046, -772.904590358595, -731.015573480424, -1070.764555238569, -166.9888461487513, -595.9927484977728, -746.4766886296571, -872.2313775932613, -801.1686277234224, -57.00345120578245, -901.0269461746797, -905.7785869796146, -748.0356145826761, -711.8990878896705, -512.9220928274804, -70.1250756297702, -830.1280909970084, -582.0920331584782, -926.5319139705537, -674.3119554737435, -378.0306878547446, -641.5761198891959, -314.6764143717458, -311.171381741417, -673.3908572588447, -402.39158912307926, -1263.6980189642634, -564.0455004524755, -16.77511030611402, -768.9834972383296, -224.69881286104678, -796.2491246573226, -646.2609916457546, -184.3873909024325, -384.43161895267764, -579.3052089027475, -762.3493687100186, -54.46402470121884, -924.3545091383311, -657.9057769586581, -839.1848704863647, -403.27545054727904, -692.6727663438014, -162.850199478088, -1071.8285852324036, -979.1192753581086, -644.0435141757212, -776.0336947651172, -847.913309385572]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5658235431797529, "mean_inference_ms": 1.7011955758252955, "mean_action_processing_ms": 0.2855945908584863, "mean_env_wait_ms": 2.990824477683502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014528274536132812, "StateBufferConnector_ms": 0.008851766586303711, "ViewRequirementAgentConnector_ms": 0.19171643257141113}, "num_episodes": 29, "episode_return_max": -16.77511030611402, "episode_return_min": -1263.6980189642634, "episode_return_mean": -677.7443299304255, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.0239744069716, "num_env_steps_trained_throughput_per_sec": 346.0239744069716, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12712.922, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12712.85, "sample_time_ms": 1013.949, "learn_time_ms": 11625.949, "learn_throughput": 344.058, "synch_weights_time_ms": 72.097}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00014", "date": "2024-08-03_11-34-21", "timestamp": 1722665061, "time_this_iter_s": 11.572027921676636, "time_total_s": 63.625311613082886, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244437ac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 63.625311613082886, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 14.887500000000001, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.16347851753235, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.2192996000250185, "policy_loss": -0.010954299810691737, "vf_loss": 5.243280196686586, "vf_explained_var": 0.8625198513890306, "kl": 0.01483133948653025, "entropy": 1.599256664266189, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -16.77511030611402, "episode_reward_min": -1263.6980189642634, "episode_reward_mean": -701.1431736434964, "episode_len_mean": 137.46, "episode_media": {}, "episodes_timesteps_total": 13746, "policy_reward_min": {"policy_0": -1263.6980189642634}, "policy_reward_max": {"policy_0": -16.77511030611402}, "policy_reward_mean": {"policy_0": -701.1431736434964}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-614.0611051041573, -180.46041663957746, -1133.5789092738166, -1130.6978930595208, -906.0053545719288, -389.329492075343, -85.04269984198193, -1240.226442717783, -859.2832189468531, -1110.7137874046741, -321.1723181512683, -976.8092657688026, -568.1679063704084, -1104.260486769227, -444.56507978167275, -1114.585979484623, -1035.278746923468, -1058.8387857768482, -962.3027146179376, -479.6909401618088, -602.6659396826694, -916.3302500301241, -958.2965484533239, -808.7147287761046, -772.904590358595, -731.015573480424, -1070.764555238569, -166.9888461487513, -595.9927484977728, -746.4766886296571, -872.2313775932613, -801.1686277234224, -57.00345120578245, -901.0269461746797, -905.7785869796146, -748.0356145826761, -711.8990878896705, -512.9220928274804, -70.1250756297702, -830.1280909970084, -582.0920331584782, -926.5319139705537, -674.3119554737435, -378.0306878547446, -641.5761198891959, -314.6764143717458, -311.171381741417, -673.3908572588447, -402.39158912307926, -1263.6980189642634, -564.0455004524755, -16.77511030611402, -768.9834972383296, -224.69881286104678, -796.2491246573226, -646.2609916457546, -184.3873909024325, -384.43161895267764, -579.3052089027475, -762.3493687100186, -54.46402470121884, -924.3545091383311, -657.9057769586581, -839.1848704863647, -403.27545054727904, -692.6727663438014, -162.850199478088, -1071.8285852324036, -979.1192753581086, -644.0435141757212, -776.0336947651172, -847.913309385572, -1096.0015312452224, -1072.3339750212685, -472.4171316493797, -1106.947482379939, -449.1725484133514, -1072.5390350024618, -986.9220473007958, -1086.582538543522, -681.4544822902873, -1249.4265222831011, -458.59697602418066, -520.3832547240607, -1094.3936952442218, -780.2055626956678, -19.310717675629874, -707.8985005715382, -31.263542234870375, -211.22557990192388, -675.8328577058475, -525.6673037049895, -1092.8214161118074, -1062.799922704381, -250.73238181736602, -838.1209424400156, -1147.6969411138912, -823.8476826427674, -977.4207046869352, -977.7575508735056], "episode_lengths": [150, 95, 150, 150, 150, 104, 64, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 55, 150, 119, 150, 150, 65, 123, 150, 150, 66, 150, 150, 150, 135, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 48, 108, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-614.0611051041573, -180.46041663957746, -1133.5789092738166, -1130.6978930595208, -906.0053545719288, -389.329492075343, -85.04269984198193, -1240.226442717783, -859.2832189468531, -1110.7137874046741, -321.1723181512683, -976.8092657688026, -568.1679063704084, -1104.260486769227, -444.56507978167275, -1114.585979484623, -1035.278746923468, -1058.8387857768482, -962.3027146179376, -479.6909401618088, -602.6659396826694, -916.3302500301241, -958.2965484533239, -808.7147287761046, -772.904590358595, -731.015573480424, -1070.764555238569, -166.9888461487513, -595.9927484977728, -746.4766886296571, -872.2313775932613, -801.1686277234224, -57.00345120578245, -901.0269461746797, -905.7785869796146, -748.0356145826761, -711.8990878896705, -512.9220928274804, -70.1250756297702, -830.1280909970084, -582.0920331584782, -926.5319139705537, -674.3119554737435, -378.0306878547446, -641.5761198891959, -314.6764143717458, -311.171381741417, -673.3908572588447, -402.39158912307926, -1263.6980189642634, -564.0455004524755, -16.77511030611402, -768.9834972383296, -224.69881286104678, -796.2491246573226, -646.2609916457546, -184.3873909024325, -384.43161895267764, -579.3052089027475, -762.3493687100186, -54.46402470121884, -924.3545091383311, -657.9057769586581, -839.1848704863647, -403.27545054727904, -692.6727663438014, -162.850199478088, -1071.8285852324036, -979.1192753581086, -644.0435141757212, -776.0336947651172, -847.913309385572, -1096.0015312452224, -1072.3339750212685, -472.4171316493797, -1106.947482379939, -449.1725484133514, -1072.5390350024618, -986.9220473007958, -1086.582538543522, -681.4544822902873, -1249.4265222831011, -458.59697602418066, -520.3832547240607, -1094.3936952442218, -780.2055626956678, -19.310717675629874, -707.8985005715382, -31.263542234870375, -211.22557990192388, -675.8328577058475, -525.6673037049895, -1092.8214161118074, -1062.799922704381, -250.73238181736602, -838.1209424400156, -1147.6969411138912, -823.8476826427674, -977.4207046869352, -977.7575508735056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5630526419593807, "mean_inference_ms": 1.6983150052759641, "mean_action_processing_ms": 0.28507188882637957, "mean_env_wait_ms": 2.987278413088433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014174938201904297, "StateBufferConnector_ms": 0.009003400802612305, "ViewRequirementAgentConnector_ms": 0.1922450065612793}, "num_episodes": 28, "episode_return_max": -16.77511030611402, "episode_return_min": -1263.6980189642634, "episode_return_mean": -701.1431736434964, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.7405533219203, "num_env_steps_trained_throughput_per_sec": 298.7405533219203, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12825.694, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12825.624, "sample_time_ms": 1014.898, "learn_time_ms": 11739.066, "learn_throughput": 340.743, "synch_weights_time_ms": 70.711}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00014", "date": "2024-08-03_11-34-34", "timestamp": 1722665074, "time_this_iter_s": 13.401050567626953, "time_total_s": 77.02636218070984, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244490430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.02636218070984, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.663157894736843, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 79.30129949847857, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.199635620663563, "policy_loss": -0.008990483559318817, "vf_loss": 5.22151143203179, "vf_explained_var": 0.8932005587344368, "kl": 0.013327666559537956, "entropy": 1.5550857281933228, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -16.77511030611402, "episode_reward_min": -1279.9769920315005, "episode_reward_mean": -713.9245481617894, "episode_len_mean": 138.39, "episode_media": {}, "episodes_timesteps_total": 13839, "policy_reward_min": {"policy_0": -1279.9769920315005}, "policy_reward_max": {"policy_0": -16.77511030611402}, "policy_reward_mean": {"policy_0": -713.9245481617894}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-901.0269461746797, -905.7785869796146, -748.0356145826761, -711.8990878896705, -512.9220928274804, -70.1250756297702, -830.1280909970084, -582.0920331584782, -926.5319139705537, -674.3119554737435, -378.0306878547446, -641.5761198891959, -314.6764143717458, -311.171381741417, -673.3908572588447, -402.39158912307926, -1263.6980189642634, -564.0455004524755, -16.77511030611402, -768.9834972383296, -224.69881286104678, -796.2491246573226, -646.2609916457546, -184.3873909024325, -384.43161895267764, -579.3052089027475, -762.3493687100186, -54.46402470121884, -924.3545091383311, -657.9057769586581, -839.1848704863647, -403.27545054727904, -692.6727663438014, -162.850199478088, -1071.8285852324036, -979.1192753581086, -644.0435141757212, -776.0336947651172, -847.913309385572, -1096.0015312452224, -1072.3339750212685, -472.4171316493797, -1106.947482379939, -449.1725484133514, -1072.5390350024618, -986.9220473007958, -1086.582538543522, -681.4544822902873, -1249.4265222831011, -458.59697602418066, -520.3832547240607, -1094.3936952442218, -780.2055626956678, -19.310717675629874, -707.8985005715382, -31.263542234870375, -211.22557990192388, -675.8328577058475, -525.6673037049895, -1092.8214161118074, -1062.799922704381, -250.73238181736602, -838.1209424400156, -1147.6969411138912, -823.8476826427674, -977.4207046869352, -977.7575508735056, -1224.2306484500134, -846.1579365525256, -834.7039021273952, -249.73550441230714, -67.85813066832479, -742.8627876023569, -864.9208074099388, -255.46253346192321, -1279.9769920315005, -971.471229442294, -1247.4746206177965, -997.4841604220428, -561.5331805799965, -1215.1477142962187, -692.3785490691458, -1134.392464437835, -752.6920017444902, -141.58254435213607, -467.8968322814397, -808.1186722683836, -1019.8164539306619, -554.8601711804948, -1261.3437344226954, -563.0689923548553, -843.7591734789765, -743.2552036584241, -918.1917446935817, -775.100203063077, -823.2077735738756, -1109.2311580772446, -783.4317296936499, -720.7324720772116, -621.6828986566403], "episode_lengths": [150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 55, 150, 119, 150, 150, 65, 123, 150, 150, 66, 150, 150, 150, 135, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 48, 108, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 145, 61, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-901.0269461746797, -905.7785869796146, -748.0356145826761, -711.8990878896705, -512.9220928274804, -70.1250756297702, -830.1280909970084, -582.0920331584782, -926.5319139705537, -674.3119554737435, -378.0306878547446, -641.5761198891959, -314.6764143717458, -311.171381741417, -673.3908572588447, -402.39158912307926, -1263.6980189642634, -564.0455004524755, -16.77511030611402, -768.9834972383296, -224.69881286104678, -796.2491246573226, -646.2609916457546, -184.3873909024325, -384.43161895267764, -579.3052089027475, -762.3493687100186, -54.46402470121884, -924.3545091383311, -657.9057769586581, -839.1848704863647, -403.27545054727904, -692.6727663438014, -162.850199478088, -1071.8285852324036, -979.1192753581086, -644.0435141757212, -776.0336947651172, -847.913309385572, -1096.0015312452224, -1072.3339750212685, -472.4171316493797, -1106.947482379939, -449.1725484133514, -1072.5390350024618, -986.9220473007958, -1086.582538543522, -681.4544822902873, -1249.4265222831011, -458.59697602418066, -520.3832547240607, -1094.3936952442218, -780.2055626956678, -19.310717675629874, -707.8985005715382, -31.263542234870375, -211.22557990192388, -675.8328577058475, -525.6673037049895, -1092.8214161118074, -1062.799922704381, -250.73238181736602, -838.1209424400156, -1147.6969411138912, -823.8476826427674, -977.4207046869352, -977.7575508735056, -1224.2306484500134, -846.1579365525256, -834.7039021273952, -249.73550441230714, -67.85813066832479, -742.8627876023569, -864.9208074099388, -255.46253346192321, -1279.9769920315005, -971.471229442294, -1247.4746206177965, -997.4841604220428, -561.5331805799965, -1215.1477142962187, -692.3785490691458, -1134.392464437835, -752.6920017444902, -141.58254435213607, -467.8968322814397, -808.1186722683836, -1019.8164539306619, -554.8601711804948, -1261.3437344226954, -563.0689923548553, -843.7591734789765, -743.2552036584241, -918.1917446935817, -775.100203063077, -823.2077735738756, -1109.2311580772446, -783.4317296936499, -720.7324720772116, -621.6828986566403]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5623013379105802, "mean_inference_ms": 1.6985499481291988, "mean_action_processing_ms": 0.2847369732424616, "mean_env_wait_ms": 2.9905909516646356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014100074768066406, "StateBufferConnector_ms": 0.009057998657226562, "ViewRequirementAgentConnector_ms": 0.19926762580871582}, "num_episodes": 33, "episode_return_max": -16.77511030611402, "episode_return_min": -1279.9769920315005, "episode_return_mean": -713.9245481617894, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.6838520530473, "num_env_steps_trained_throughput_per_sec": 300.6838520530473, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12893.884, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12893.812, "sample_time_ms": 1019.219, "learn_time_ms": 11803.94, "learn_throughput": 338.87, "synch_weights_time_ms": 69.716}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00014", "date": "2024-08-03_11-34-47", "timestamp": 1722665087, "time_this_iter_s": 13.315829038619995, "time_total_s": 90.34219121932983, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244436e60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 90.34219121932983, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.70526315789474, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 81.62732765773931, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.059934900949399, "policy_loss": -0.011397327862990398, "vf_loss": 4.0825550707678, "vf_explained_var": 0.9507228450228771, "kl": 0.016177647336189694, "entropy": 1.445835892856121, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -19.310717675629874, "episode_reward_min": -1279.9769920315005, "episode_reward_mean": -750.2069984604361, "episode_len_mean": 139.76, "episode_media": {}, "episodes_timesteps_total": 13976, "policy_reward_min": {"policy_0": -1279.9769920315005}, "policy_reward_max": {"policy_0": -19.310717675629874}, "policy_reward_mean": {"policy_0": -750.2069984604361}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-762.3493687100186, -54.46402470121884, -924.3545091383311, -657.9057769586581, -839.1848704863647, -403.27545054727904, -692.6727663438014, -162.850199478088, -1071.8285852324036, -979.1192753581086, -644.0435141757212, -776.0336947651172, -847.913309385572, -1096.0015312452224, -1072.3339750212685, -472.4171316493797, -1106.947482379939, -449.1725484133514, -1072.5390350024618, -986.9220473007958, -1086.582538543522, -681.4544822902873, -1249.4265222831011, -458.59697602418066, -520.3832547240607, -1094.3936952442218, -780.2055626956678, -19.310717675629874, -707.8985005715382, -31.263542234870375, -211.22557990192388, -675.8328577058475, -525.6673037049895, -1092.8214161118074, -1062.799922704381, -250.73238181736602, -838.1209424400156, -1147.6969411138912, -823.8476826427674, -977.4207046869352, -977.7575508735056, -1224.2306484500134, -846.1579365525256, -834.7039021273952, -249.73550441230714, -67.85813066832479, -742.8627876023569, -864.9208074099388, -255.46253346192321, -1279.9769920315005, -971.471229442294, -1247.4746206177965, -997.4841604220428, -561.5331805799965, -1215.1477142962187, -692.3785490691458, -1134.392464437835, -752.6920017444902, -141.58254435213607, -467.8968322814397, -808.1186722683836, -1019.8164539306619, -554.8601711804948, -1261.3437344226954, -563.0689923548553, -843.7591734789765, -743.2552036584241, -918.1917446935817, -775.100203063077, -823.2077735738756, -1109.2311580772446, -783.4317296936499, -720.7324720772116, -621.6828986566403, -1258.9413422363318, -749.6455599460014, -1178.2308025515563, -1002.3869504132263, -952.0545022165823, -546.6204794753959, -1108.8537907056118, -552.4073218939276, -370.5281896170021, -530.3456065801935, -844.0417325666504, -186.0469649064014, -483.33283622055137, -892.4047426046052, -489.95060109603094, -828.9472294144315, -328.55657385775834, -880.8146985431599, -97.31961700733093, -855.3712804507219, -509.1082110449535, -674.9596823740512, -1086.5758133847835, -382.5394828552913, -1019.0344060617178, -832.1503346462896], "episode_lengths": [150, 66, 150, 150, 150, 135, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 48, 108, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 145, 61, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 106, 150, 150, 150, 150, 109, 150, 72, 150, 122, 150, 150, 135, 150, 150], "policy_policy_0_reward": [-762.3493687100186, -54.46402470121884, -924.3545091383311, -657.9057769586581, -839.1848704863647, -403.27545054727904, -692.6727663438014, -162.850199478088, -1071.8285852324036, -979.1192753581086, -644.0435141757212, -776.0336947651172, -847.913309385572, -1096.0015312452224, -1072.3339750212685, -472.4171316493797, -1106.947482379939, -449.1725484133514, -1072.5390350024618, -986.9220473007958, -1086.582538543522, -681.4544822902873, -1249.4265222831011, -458.59697602418066, -520.3832547240607, -1094.3936952442218, -780.2055626956678, -19.310717675629874, -707.8985005715382, -31.263542234870375, -211.22557990192388, -675.8328577058475, -525.6673037049895, -1092.8214161118074, -1062.799922704381, -250.73238181736602, -838.1209424400156, -1147.6969411138912, -823.8476826427674, -977.4207046869352, -977.7575508735056, -1224.2306484500134, -846.1579365525256, -834.7039021273952, -249.73550441230714, -67.85813066832479, -742.8627876023569, -864.9208074099388, -255.46253346192321, -1279.9769920315005, -971.471229442294, -1247.4746206177965, -997.4841604220428, -561.5331805799965, -1215.1477142962187, -692.3785490691458, -1134.392464437835, -752.6920017444902, -141.58254435213607, -467.8968322814397, -808.1186722683836, -1019.8164539306619, -554.8601711804948, -1261.3437344226954, -563.0689923548553, -843.7591734789765, -743.2552036584241, -918.1917446935817, -775.100203063077, -823.2077735738756, -1109.2311580772446, -783.4317296936499, -720.7324720772116, -621.6828986566403, -1258.9413422363318, -749.6455599460014, -1178.2308025515563, -1002.3869504132263, -952.0545022165823, -546.6204794753959, -1108.8537907056118, -552.4073218939276, -370.5281896170021, -530.3456065801935, -844.0417325666504, -186.0469649064014, -483.33283622055137, -892.4047426046052, -489.95060109603094, -828.9472294144315, -328.55657385775834, -880.8146985431599, -97.31961700733093, -855.3712804507219, -509.1082110449535, -674.9596823740512, -1086.5758133847835, -382.5394828552913, -1019.0344060617178, -832.1503346462896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5612836037203659, "mean_inference_ms": 1.695876771943094, "mean_action_processing_ms": 0.28404748794331963, "mean_env_wait_ms": 2.9927836312170633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01320195198059082, "StateBufferConnector_ms": 0.00853276252746582, "ViewRequirementAgentConnector_ms": 0.19735383987426758}, "num_episodes": 26, "episode_return_max": -19.310717675629874, "episode_return_min": -1279.9769920315005, "episode_return_mean": -750.2069984604361, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.5682345155203, "num_env_steps_trained_throughput_per_sec": 300.5682345155203, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12945.666, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12945.594, "sample_time_ms": 1017.5, "learn_time_ms": 11858.194, "learn_throughput": 337.32, "synch_weights_time_ms": 68.973}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00014", "date": "2024-08-03_11-35-01", "timestamp": 1722665101, "time_this_iter_s": 13.321753978729248, "time_total_s": 103.66394519805908, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244434550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 103.66394519805908, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.584210526315792, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.53974044720331, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.8353958331048488, "policy_loss": -0.0091659592789559, "vf_loss": 3.856771678477526, "vf_explained_var": 0.937527646869421, "kl": 0.01569475984994521, "entropy": 1.5348835987349352, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -35.749606695964914, "episode_reward_min": -1373.5425196188562, "episode_reward_mean": -754.1189398095233, "episode_len_mean": 141.22, "episode_media": {}, "episodes_timesteps_total": 14122, "policy_reward_min": {"policy_0": -1373.5425196188562}, "policy_reward_max": {"policy_0": -35.749606695964914}, "policy_reward_mean": {"policy_0": -754.1189398095233}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-525.6673037049895, -1092.8214161118074, -1062.799922704381, -250.73238181736602, -838.1209424400156, -1147.6969411138912, -823.8476826427674, -977.4207046869352, -977.7575508735056, -1224.2306484500134, -846.1579365525256, -834.7039021273952, -249.73550441230714, -67.85813066832479, -742.8627876023569, -864.9208074099388, -255.46253346192321, -1279.9769920315005, -971.471229442294, -1247.4746206177965, -997.4841604220428, -561.5331805799965, -1215.1477142962187, -692.3785490691458, -1134.392464437835, -752.6920017444902, -141.58254435213607, -467.8968322814397, -808.1186722683836, -1019.8164539306619, -554.8601711804948, -1261.3437344226954, -563.0689923548553, -843.7591734789765, -743.2552036584241, -918.1917446935817, -775.100203063077, -823.2077735738756, -1109.2311580772446, -783.4317296936499, -720.7324720772116, -621.6828986566403, -1258.9413422363318, -749.6455599460014, -1178.2308025515563, -1002.3869504132263, -952.0545022165823, -546.6204794753959, -1108.8537907056118, -552.4073218939276, -370.5281896170021, -530.3456065801935, -844.0417325666504, -186.0469649064014, -483.33283622055137, -892.4047426046052, -489.95060109603094, -828.9472294144315, -328.55657385775834, -880.8146985431599, -97.31961700733093, -855.3712804507219, -509.1082110449535, -674.9596823740512, -1086.5758133847835, -382.5394828552913, -1019.0344060617178, -832.1503346462896, -720.3280150852991, -906.0655198232948, -395.4896007639798, -1163.3138078433274, -558.8418486910173, -245.81751351011314, -997.0775798208193, -265.9713732748663, -940.8040111485577, -846.9719568173891, -35.749606695964914, -1066.541691224712, -1373.5425196188562, -692.8983072205481, -1126.7676837001861, -816.4102251446893, -704.6208677939901, -1012.1372258201025, -1069.3812013694321, -727.70949333614, -814.3536599662699, -147.17405159855946, -443.49650266716503, -1329.5213624400367, -764.9297354436487, -296.36462292883147, -541.0564862769228, -943.2591313463574, -541.5869890901688, -742.0345571394985, -472.58500083193854, -277.2953126639806], "episode_lengths": [150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 145, 61, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 106, 150, 150, 150, 150, 109, 150, 72, 150, 122, 150, 150, 135, 150, 150, 150, 150, 150, 150, 126, 85, 150, 133, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86], "policy_policy_0_reward": [-525.6673037049895, -1092.8214161118074, -1062.799922704381, -250.73238181736602, -838.1209424400156, -1147.6969411138912, -823.8476826427674, -977.4207046869352, -977.7575508735056, -1224.2306484500134, -846.1579365525256, -834.7039021273952, -249.73550441230714, -67.85813066832479, -742.8627876023569, -864.9208074099388, -255.46253346192321, -1279.9769920315005, -971.471229442294, -1247.4746206177965, -997.4841604220428, -561.5331805799965, -1215.1477142962187, -692.3785490691458, -1134.392464437835, -752.6920017444902, -141.58254435213607, -467.8968322814397, -808.1186722683836, -1019.8164539306619, -554.8601711804948, -1261.3437344226954, -563.0689923548553, -843.7591734789765, -743.2552036584241, -918.1917446935817, -775.100203063077, -823.2077735738756, -1109.2311580772446, -783.4317296936499, -720.7324720772116, -621.6828986566403, -1258.9413422363318, -749.6455599460014, -1178.2308025515563, -1002.3869504132263, -952.0545022165823, -546.6204794753959, -1108.8537907056118, -552.4073218939276, -370.5281896170021, -530.3456065801935, -844.0417325666504, -186.0469649064014, -483.33283622055137, -892.4047426046052, -489.95060109603094, -828.9472294144315, -328.55657385775834, -880.8146985431599, -97.31961700733093, -855.3712804507219, -509.1082110449535, -674.9596823740512, -1086.5758133847835, -382.5394828552913, -1019.0344060617178, -832.1503346462896, -720.3280150852991, -906.0655198232948, -395.4896007639798, -1163.3138078433274, -558.8418486910173, -245.81751351011314, -997.0775798208193, -265.9713732748663, -940.8040111485577, -846.9719568173891, -35.749606695964914, -1066.541691224712, -1373.5425196188562, -692.8983072205481, -1126.7676837001861, -816.4102251446893, -704.6208677939901, -1012.1372258201025, -1069.3812013694321, -727.70949333614, -814.3536599662699, -147.17405159855946, -443.49650266716503, -1329.5213624400367, -764.9297354436487, -296.36462292883147, -541.0564862769228, -943.2591313463574, -541.5869890901688, -742.0345571394985, -472.58500083193854, -277.2953126639806]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5590103302875197, "mean_inference_ms": 1.6942047428593228, "mean_action_processing_ms": 0.28326872561578387, "mean_env_wait_ms": 2.9931774740851624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012762784957885742, "StateBufferConnector_ms": 0.008048295974731445, "ViewRequirementAgentConnector_ms": 0.19315481185913086}, "num_episodes": 32, "episode_return_max": -35.749606695964914, "episode_return_min": -1373.5425196188562, "episode_return_mean": -754.1189398095233, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.40463102677774, "num_env_steps_trained_throughput_per_sec": 303.40463102677774, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12972.117, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12972.045, "sample_time_ms": 1018.929, "learn_time_ms": 11883.654, "learn_throughput": 336.597, "synch_weights_time_ms": 68.529}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00014", "date": "2024-08-03_11-35-14", "timestamp": 1722665114, "time_this_iter_s": 13.196122884750366, "time_total_s": 116.86006808280945, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f53520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 116.86006808280945, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.478947368421053, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 100.04114442070325, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.310874798769752, "policy_loss": -0.016676624588823567, "vf_loss": 3.3383078457166753, "vf_explained_var": 0.9720994617169102, "kl": 0.021218181083562136, "entropy": 1.500005721921722, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -35.749606695964914, "episode_reward_min": -1373.5425196188562, "episode_reward_mean": -727.1634335055933, "episode_len_mean": 140.39, "episode_media": {}, "episodes_timesteps_total": 14039, "policy_reward_min": {"policy_0": -1373.5425196188562}, "policy_reward_max": {"policy_0": -35.749606695964914}, "policy_reward_mean": {"policy_0": -727.1634335055933}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.1186722683836, -1019.8164539306619, -554.8601711804948, -1261.3437344226954, -563.0689923548553, -843.7591734789765, -743.2552036584241, -918.1917446935817, -775.100203063077, -823.2077735738756, -1109.2311580772446, -783.4317296936499, -720.7324720772116, -621.6828986566403, -1258.9413422363318, -749.6455599460014, -1178.2308025515563, -1002.3869504132263, -952.0545022165823, -546.6204794753959, -1108.8537907056118, -552.4073218939276, -370.5281896170021, -530.3456065801935, -844.0417325666504, -186.0469649064014, -483.33283622055137, -892.4047426046052, -489.95060109603094, -828.9472294144315, -328.55657385775834, -880.8146985431599, -97.31961700733093, -855.3712804507219, -509.1082110449535, -674.9596823740512, -1086.5758133847835, -382.5394828552913, -1019.0344060617178, -832.1503346462896, -720.3280150852991, -906.0655198232948, -395.4896007639798, -1163.3138078433274, -558.8418486910173, -245.81751351011314, -997.0775798208193, -265.9713732748663, -940.8040111485577, -846.9719568173891, -35.749606695964914, -1066.541691224712, -1373.5425196188562, -692.8983072205481, -1126.7676837001861, -816.4102251446893, -704.6208677939901, -1012.1372258201025, -1069.3812013694321, -727.70949333614, -814.3536599662699, -147.17405159855946, -443.49650266716503, -1329.5213624400367, -764.9297354436487, -296.36462292883147, -541.0564862769228, -943.2591313463574, -541.5869890901688, -742.0345571394985, -472.58500083193854, -277.2953126639806, -720.3864742721737, -847.3329954189185, -1288.5513844057923, -1132.9879166591434, -985.8275641570016, -526.6552670630832, -880.1237474394326, -45.09046282898374, -955.9381049114875, -387.12088592482854, -1275.435994695421, -910.7930235265962, -850.8816939699715, -1001.1794707698446, -934.4109484645891, -420.0721971847131, -212.3595365792133, -69.25454623339445, -788.812350434779, -42.06641652930086, -730.3982804476097, -911.8008173131309, -636.7583466367089, -310.1119388949114, -1055.633092410717, -850.3896166673464, -697.250478234069, -81.65320358917279], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 106, 150, 150, 150, 150, 109, 150, 72, 150, 122, 150, 150, 135, 150, 150, 150, 150, 150, 150, 126, 85, 150, 133, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 78, 66, 150, 65, 150, 150, 138, 150, 150, 150, 150, 78], "policy_policy_0_reward": [-808.1186722683836, -1019.8164539306619, -554.8601711804948, -1261.3437344226954, -563.0689923548553, -843.7591734789765, -743.2552036584241, -918.1917446935817, -775.100203063077, -823.2077735738756, -1109.2311580772446, -783.4317296936499, -720.7324720772116, -621.6828986566403, -1258.9413422363318, -749.6455599460014, -1178.2308025515563, -1002.3869504132263, -952.0545022165823, -546.6204794753959, -1108.8537907056118, -552.4073218939276, -370.5281896170021, -530.3456065801935, -844.0417325666504, -186.0469649064014, -483.33283622055137, -892.4047426046052, -489.95060109603094, -828.9472294144315, -328.55657385775834, -880.8146985431599, -97.31961700733093, -855.3712804507219, -509.1082110449535, -674.9596823740512, -1086.5758133847835, -382.5394828552913, -1019.0344060617178, -832.1503346462896, -720.3280150852991, -906.0655198232948, -395.4896007639798, -1163.3138078433274, -558.8418486910173, -245.81751351011314, -997.0775798208193, -265.9713732748663, -940.8040111485577, -846.9719568173891, -35.749606695964914, -1066.541691224712, -1373.5425196188562, -692.8983072205481, -1126.7676837001861, -816.4102251446893, -704.6208677939901, -1012.1372258201025, -1069.3812013694321, -727.70949333614, -814.3536599662699, -147.17405159855946, -443.49650266716503, -1329.5213624400367, -764.9297354436487, -296.36462292883147, -541.0564862769228, -943.2591313463574, -541.5869890901688, -742.0345571394985, -472.58500083193854, -277.2953126639806, -720.3864742721737, -847.3329954189185, -1288.5513844057923, -1132.9879166591434, -985.8275641570016, -526.6552670630832, -880.1237474394326, -45.09046282898374, -955.9381049114875, -387.12088592482854, -1275.435994695421, -910.7930235265962, -850.8816939699715, -1001.1794707698446, -934.4109484645891, -420.0721971847131, -212.3595365792133, -69.25454623339445, -788.812350434779, -42.06641652930086, -730.3982804476097, -911.8008173131309, -636.7583466367089, -310.1119388949114, -1055.633092410717, -850.3896166673464, -697.250478234069, -81.65320358917279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578601467588846, "mean_inference_ms": 1.692515797910751, "mean_action_processing_ms": 0.2824928985553738, "mean_env_wait_ms": 2.9944801833287853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012103796005249023, "StateBufferConnector_ms": 0.007767438888549805, "ViewRequirementAgentConnector_ms": 0.18864107131958008}, "num_episodes": 28, "episode_return_max": -35.749606695964914, "episode_return_min": -1373.5425196188562, "episode_return_mean": -727.1634335055933, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.97109513086565, "num_env_steps_trained_throughput_per_sec": 301.97109513086565, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12999.537, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12999.465, "sample_time_ms": 1019.133, "learn_time_ms": 11911.781, "learn_throughput": 335.802, "synch_weights_time_ms": 67.633}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00014", "date": "2024-08-03_11-35-27", "timestamp": 1722665127, "time_this_iter_s": 13.260451793670654, "time_total_s": 130.1205198764801, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244491870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 130.1205198764801, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.873684210526314, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 118.01041143635909, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.782064157600204, "policy_loss": -0.01315555395752502, "vf_loss": 2.8057807426899672, "vf_explained_var": 0.978631484011809, "kl": 0.016141336540689128, "entropy": 1.5403428945690394, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -35.749606695964914, "episode_reward_min": -1373.5425196188562, "episode_reward_mean": -711.515797872051, "episode_len_mean": 139.84, "episode_media": {}, "episodes_timesteps_total": 13984, "policy_reward_min": {"policy_0": -1373.5425196188562}, "policy_reward_max": {"policy_0": -35.749606695964914}, "policy_reward_mean": {"policy_0": -711.515797872051}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-844.0417325666504, -186.0469649064014, -483.33283622055137, -892.4047426046052, -489.95060109603094, -828.9472294144315, -328.55657385775834, -880.8146985431599, -97.31961700733093, -855.3712804507219, -509.1082110449535, -674.9596823740512, -1086.5758133847835, -382.5394828552913, -1019.0344060617178, -832.1503346462896, -720.3280150852991, -906.0655198232948, -395.4896007639798, -1163.3138078433274, -558.8418486910173, -245.81751351011314, -997.0775798208193, -265.9713732748663, -940.8040111485577, -846.9719568173891, -35.749606695964914, -1066.541691224712, -1373.5425196188562, -692.8983072205481, -1126.7676837001861, -816.4102251446893, -704.6208677939901, -1012.1372258201025, -1069.3812013694321, -727.70949333614, -814.3536599662699, -147.17405159855946, -443.49650266716503, -1329.5213624400367, -764.9297354436487, -296.36462292883147, -541.0564862769228, -943.2591313463574, -541.5869890901688, -742.0345571394985, -472.58500083193854, -277.2953126639806, -720.3864742721737, -847.3329954189185, -1288.5513844057923, -1132.9879166591434, -985.8275641570016, -526.6552670630832, -880.1237474394326, -45.09046282898374, -955.9381049114875, -387.12088592482854, -1275.435994695421, -910.7930235265962, -850.8816939699715, -1001.1794707698446, -934.4109484645891, -420.0721971847131, -212.3595365792133, -69.25454623339445, -788.812350434779, -42.06641652930086, -730.3982804476097, -911.8008173131309, -636.7583466367089, -310.1119388949114, -1055.633092410717, -850.3896166673464, -697.250478234069, -81.65320358917279, -710.9961343733174, -485.4978988273145, -992.9614553097663, -364.4710681673712, -586.0676517259697, -822.6964363499392, -395.59351664749653, -1026.9801288809404, -1006.4387252833191, -557.3816822330608, -1105.738585012538, -750.7738075979045, -1058.6754741508134, -941.9011558154417, -607.1764131692703, -931.2514640397006, -875.5346349596348, -578.5897859660663, -907.2497605941833, -944.9713390446472, -726.2143806258007, -402.0437255814817, -840.5739971832603, -611.272141872147], "episode_lengths": [150, 106, 150, 150, 150, 150, 109, 150, 72, 150, 122, 150, 150, 135, 150, 150, 150, 150, 150, 150, 126, 85, 150, 133, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 78, 66, 150, 65, 150, 150, 138, 150, 150, 150, 150, 78, 150, 150, 150, 102, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-844.0417325666504, -186.0469649064014, -483.33283622055137, -892.4047426046052, -489.95060109603094, -828.9472294144315, -328.55657385775834, -880.8146985431599, -97.31961700733093, -855.3712804507219, -509.1082110449535, -674.9596823740512, -1086.5758133847835, -382.5394828552913, -1019.0344060617178, -832.1503346462896, -720.3280150852991, -906.0655198232948, -395.4896007639798, -1163.3138078433274, -558.8418486910173, -245.81751351011314, -997.0775798208193, -265.9713732748663, -940.8040111485577, -846.9719568173891, -35.749606695964914, -1066.541691224712, -1373.5425196188562, -692.8983072205481, -1126.7676837001861, -816.4102251446893, -704.6208677939901, -1012.1372258201025, -1069.3812013694321, -727.70949333614, -814.3536599662699, -147.17405159855946, -443.49650266716503, -1329.5213624400367, -764.9297354436487, -296.36462292883147, -541.0564862769228, -943.2591313463574, -541.5869890901688, -742.0345571394985, -472.58500083193854, -277.2953126639806, -720.3864742721737, -847.3329954189185, -1288.5513844057923, -1132.9879166591434, -985.8275641570016, -526.6552670630832, -880.1237474394326, -45.09046282898374, -955.9381049114875, -387.12088592482854, -1275.435994695421, -910.7930235265962, -850.8816939699715, -1001.1794707698446, -934.4109484645891, -420.0721971847131, -212.3595365792133, -69.25454623339445, -788.812350434779, -42.06641652930086, -730.3982804476097, -911.8008173131309, -636.7583466367089, -310.1119388949114, -1055.633092410717, -850.3896166673464, -697.250478234069, -81.65320358917279, -710.9961343733174, -485.4978988273145, -992.9614553097663, -364.4710681673712, -586.0676517259697, -822.6964363499392, -395.59351664749653, -1026.9801288809404, -1006.4387252833191, -557.3816822330608, -1105.738585012538, -750.7738075979045, -1058.6754741508134, -941.9011558154417, -607.1764131692703, -931.2514640397006, -875.5346349596348, -578.5897859660663, -907.2497605941833, -944.9713390446472, -726.2143806258007, -402.0437255814817, -840.5739971832603, -611.272141872147]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567212665048245, "mean_inference_ms": 1.6909445245043297, "mean_action_processing_ms": 0.2819716762020419, "mean_env_wait_ms": 2.9949140053788756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011872053146362305, "StateBufferConnector_ms": 0.0077207088470458984, "ViewRequirementAgentConnector_ms": 0.18871164321899414}, "num_episodes": 24, "episode_return_max": -35.749606695964914, "episode_return_min": -1373.5425196188562, "episode_return_mean": -711.515797872051, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.37212069717674, "num_env_steps_trained_throughput_per_sec": 299.37212069717674, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13046.281, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13046.209, "sample_time_ms": 1020.519, "learn_time_ms": 11957.327, "learn_throughput": 334.523, "synch_weights_time_ms": 67.454}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00014", "date": "2024-08-03_11-35-41", "timestamp": 1722665141, "time_this_iter_s": 13.373372554779053, "time_total_s": 143.49389243125916, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244434550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 143.49389243125916, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 13.515789473684212, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.25400077700615, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.471031664125621, "policy_loss": -0.00924226654266628, "vf_loss": 2.491539658481876, "vf_explained_var": 0.9837072550008694, "kl": 0.014889904223006548, "entropy": 1.5732682928442956, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -42.06641652930086, "episode_reward_min": -1373.5425196188562, "episode_reward_mean": -742.4468441112863, "episode_len_mean": 142.75, "episode_media": {}, "episodes_timesteps_total": 14275, "policy_reward_min": {"policy_0": -1373.5425196188562}, "policy_reward_max": {"policy_0": -42.06641652930086}, "policy_reward_mean": {"policy_0": -742.4468441112863}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1373.5425196188562, -692.8983072205481, -1126.7676837001861, -816.4102251446893, -704.6208677939901, -1012.1372258201025, -1069.3812013694321, -727.70949333614, -814.3536599662699, -147.17405159855946, -443.49650266716503, -1329.5213624400367, -764.9297354436487, -296.36462292883147, -541.0564862769228, -943.2591313463574, -541.5869890901688, -742.0345571394985, -472.58500083193854, -277.2953126639806, -720.3864742721737, -847.3329954189185, -1288.5513844057923, -1132.9879166591434, -985.8275641570016, -526.6552670630832, -880.1237474394326, -45.09046282898374, -955.9381049114875, -387.12088592482854, -1275.435994695421, -910.7930235265962, -850.8816939699715, -1001.1794707698446, -934.4109484645891, -420.0721971847131, -212.3595365792133, -69.25454623339445, -788.812350434779, -42.06641652930086, -730.3982804476097, -911.8008173131309, -636.7583466367089, -310.1119388949114, -1055.633092410717, -850.3896166673464, -697.250478234069, -81.65320358917279, -710.9961343733174, -485.4978988273145, -992.9614553097663, -364.4710681673712, -586.0676517259697, -822.6964363499392, -395.59351664749653, -1026.9801288809404, -1006.4387252833191, -557.3816822330608, -1105.738585012538, -750.7738075979045, -1058.6754741508134, -941.9011558154417, -607.1764131692703, -931.2514640397006, -875.5346349596348, -578.5897859660663, -907.2497605941833, -944.9713390446472, -726.2143806258007, -402.0437255814817, -840.5739971832603, -611.272141872147, -323.12424522038975, -752.3928490384288, -736.6381839603891, -924.4961169984069, -1149.0343903847483, -765.6394013054307, -1015.8830472657789, -748.6663066863858, -670.5586522457367, -451.87980763072903, -324.69453449763296, -1168.6562770152846, -359.43098146132263, -773.13298322875, -1136.0409085972326, -854.7277667518165, -677.3511354030439, -858.8749996583872, -650.4709653053694, -370.2312939401717, -818.4515828417303, -1135.9495483226872, -1149.619289720694, -1178.499320914007, -446.80312531047673, -799.1281208987656, -675.769716254475, -711.0858047993229], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 78, 66, 150, 65, 150, 150, 138, 150, 150, 150, 150, 78, 150, 150, 150, 102, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1373.5425196188562, -692.8983072205481, -1126.7676837001861, -816.4102251446893, -704.6208677939901, -1012.1372258201025, -1069.3812013694321, -727.70949333614, -814.3536599662699, -147.17405159855946, -443.49650266716503, -1329.5213624400367, -764.9297354436487, -296.36462292883147, -541.0564862769228, -943.2591313463574, -541.5869890901688, -742.0345571394985, -472.58500083193854, -277.2953126639806, -720.3864742721737, -847.3329954189185, -1288.5513844057923, -1132.9879166591434, -985.8275641570016, -526.6552670630832, -880.1237474394326, -45.09046282898374, -955.9381049114875, -387.12088592482854, -1275.435994695421, -910.7930235265962, -850.8816939699715, -1001.1794707698446, -934.4109484645891, -420.0721971847131, -212.3595365792133, -69.25454623339445, -788.812350434779, -42.06641652930086, -730.3982804476097, -911.8008173131309, -636.7583466367089, -310.1119388949114, -1055.633092410717, -850.3896166673464, -697.250478234069, -81.65320358917279, -710.9961343733174, -485.4978988273145, -992.9614553097663, -364.4710681673712, -586.0676517259697, -822.6964363499392, -395.59351664749653, -1026.9801288809404, -1006.4387252833191, -557.3816822330608, -1105.738585012538, -750.7738075979045, -1058.6754741508134, -941.9011558154417, -607.1764131692703, -931.2514640397006, -875.5346349596348, -578.5897859660663, -907.2497605941833, -944.9713390446472, -726.2143806258007, -402.0437255814817, -840.5739971832603, -611.272141872147, -323.12424522038975, -752.3928490384288, -736.6381839603891, -924.4961169984069, -1149.0343903847483, -765.6394013054307, -1015.8830472657789, -748.6663066863858, -670.5586522457367, -451.87980763072903, -324.69453449763296, -1168.6562770152846, -359.43098146132263, -773.13298322875, -1136.0409085972326, -854.7277667518165, -677.3511354030439, -858.8749996583872, -650.4709653053694, -370.2312939401717, -818.4515828417303, -1135.9495483226872, -1149.619289720694, -1178.499320914007, -446.80312531047673, -799.1281208987656, -675.769716254475, -711.0858047993229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555622669740184, "mean_inference_ms": 1.6900197496370806, "mean_action_processing_ms": 0.28142202048746723, "mean_env_wait_ms": 2.9972686357984744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012119770050048828, "StateBufferConnector_ms": 0.008027315139770508, "ViewRequirementAgentConnector_ms": 0.19504642486572266}, "num_episodes": 28, "episode_return_max": -42.06641652930086, "episode_return_min": -1373.5425196188562, "episode_return_mean": -742.4468441112863, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.1503524000085, "num_env_steps_trained_throughput_per_sec": 307.1503524000085, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13048.906, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13048.833, "sample_time_ms": 1019.764, "learn_time_ms": 11961.708, "learn_throughput": 334.4, "synch_weights_time_ms": 66.449}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00014", "date": "2024-08-03_11-35-54", "timestamp": 1722665154, "time_this_iter_s": 13.036320686340332, "time_total_s": 156.5302131175995, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244492170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 156.5302131175995, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.826315789473687, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 100.58884703914325, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.002481577234964, "policy_loss": -0.013771772091179931, "vf_loss": 3.024839557831486, "vf_explained_var": 0.9743712618326147, "kl": 0.014211217086191634, "entropy": 1.2849573562542598, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -42.06641652930086, "episode_reward_min": -1227.5132757832096, "episode_reward_mean": -694.2961590367976, "episode_len_mean": 140.74, "episode_media": {}, "episodes_timesteps_total": 14074, "policy_reward_min": {"policy_0": -1227.5132757832096}, "policy_reward_max": {"policy_0": -42.06641652930086}, "policy_reward_mean": {"policy_0": -694.2961590367976}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-850.8816939699715, -1001.1794707698446, -934.4109484645891, -420.0721971847131, -212.3595365792133, -69.25454623339445, -788.812350434779, -42.06641652930086, -730.3982804476097, -911.8008173131309, -636.7583466367089, -310.1119388949114, -1055.633092410717, -850.3896166673464, -697.250478234069, -81.65320358917279, -710.9961343733174, -485.4978988273145, -992.9614553097663, -364.4710681673712, -586.0676517259697, -822.6964363499392, -395.59351664749653, -1026.9801288809404, -1006.4387252833191, -557.3816822330608, -1105.738585012538, -750.7738075979045, -1058.6754741508134, -941.9011558154417, -607.1764131692703, -931.2514640397006, -875.5346349596348, -578.5897859660663, -907.2497605941833, -944.9713390446472, -726.2143806258007, -402.0437255814817, -840.5739971832603, -611.272141872147, -323.12424522038975, -752.3928490384288, -736.6381839603891, -924.4961169984069, -1149.0343903847483, -765.6394013054307, -1015.8830472657789, -748.6663066863858, -670.5586522457367, -451.87980763072903, -324.69453449763296, -1168.6562770152846, -359.43098146132263, -773.13298322875, -1136.0409085972326, -854.7277667518165, -677.3511354030439, -858.8749996583872, -650.4709653053694, -370.2312939401717, -818.4515828417303, -1135.9495483226872, -1149.619289720694, -1178.499320914007, -446.80312531047673, -799.1281208987656, -675.769716254475, -711.0858047993229, -812.8087222271084, -925.3879029010491, -171.69475144737257, -630.5747687100057, -274.7216435011659, -170.99872098839754, -942.4398309461764, -1050.1836532409861, -113.04570724708667, -793.1637420407081, -1049.6987496587562, -1204.7108945381185, -548.6726811618261, -1015.4025050901944, -251.17066699534075, -60.75403854283678, -535.2524407335095, -636.6334001233793, -1161.8634053947226, -676.3852452960524, -629.2057276017642, -745.8762516563294, -425.80935755170447, -292.01465634278594, -1093.0358557568486, -400.2429476380645, -351.37450466779114, -500.9660361248472, -135.51048295425394, -581.7422164651688, -1227.5132757832096, -569.4454669237626], "episode_lengths": [150, 150, 150, 150, 78, 66, 150, 65, 150, 150, 138, 150, 150, 150, 150, 78, 150, 150, 150, 102, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 130, 96, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 67, 138, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 74, 150, 150, 150], "policy_policy_0_reward": [-850.8816939699715, -1001.1794707698446, -934.4109484645891, -420.0721971847131, -212.3595365792133, -69.25454623339445, -788.812350434779, -42.06641652930086, -730.3982804476097, -911.8008173131309, -636.7583466367089, -310.1119388949114, -1055.633092410717, -850.3896166673464, -697.250478234069, -81.65320358917279, -710.9961343733174, -485.4978988273145, -992.9614553097663, -364.4710681673712, -586.0676517259697, -822.6964363499392, -395.59351664749653, -1026.9801288809404, -1006.4387252833191, -557.3816822330608, -1105.738585012538, -750.7738075979045, -1058.6754741508134, -941.9011558154417, -607.1764131692703, -931.2514640397006, -875.5346349596348, -578.5897859660663, -907.2497605941833, -944.9713390446472, -726.2143806258007, -402.0437255814817, -840.5739971832603, -611.272141872147, -323.12424522038975, -752.3928490384288, -736.6381839603891, -924.4961169984069, -1149.0343903847483, -765.6394013054307, -1015.8830472657789, -748.6663066863858, -670.5586522457367, -451.87980763072903, -324.69453449763296, -1168.6562770152846, -359.43098146132263, -773.13298322875, -1136.0409085972326, -854.7277667518165, -677.3511354030439, -858.8749996583872, -650.4709653053694, -370.2312939401717, -818.4515828417303, -1135.9495483226872, -1149.619289720694, -1178.499320914007, -446.80312531047673, -799.1281208987656, -675.769716254475, -711.0858047993229, -812.8087222271084, -925.3879029010491, -171.69475144737257, -630.5747687100057, -274.7216435011659, -170.99872098839754, -942.4398309461764, -1050.1836532409861, -113.04570724708667, -793.1637420407081, -1049.6987496587562, -1204.7108945381185, -548.6726811618261, -1015.4025050901944, -251.17066699534075, -60.75403854283678, -535.2524407335095, -636.6334001233793, -1161.8634053947226, -676.3852452960524, -629.2057276017642, -745.8762516563294, -425.80935755170447, -292.01465634278594, -1093.0358557568486, -400.2429476380645, -351.37450466779114, -500.9660361248472, -135.51048295425394, -581.7422164651688, -1227.5132757832096, -569.4454669237626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545440274641849, "mean_inference_ms": 1.6880542116165729, "mean_action_processing_ms": 0.2809494356459401, "mean_env_wait_ms": 2.9990309768336645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011691808700561523, "StateBufferConnector_ms": 0.007951498031616211, "ViewRequirementAgentConnector_ms": 0.19422292709350586}, "num_episodes": 32, "episode_return_max": -42.06641652930086, "episode_return_min": -1227.5132757832096, "episode_return_mean": -694.2961590367976, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.5901327569793, "num_env_steps_trained_throughput_per_sec": 297.5901327569793, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13097.143, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13097.072, "sample_time_ms": 1018.234, "learn_time_ms": 12012.647, "learn_throughput": 332.982, "synch_weights_time_ms": 65.275}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00014", "date": "2024-08-03_11-36-07", "timestamp": 1722665167, "time_this_iter_s": 13.45455551147461, "time_total_s": 169.9847686290741, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244435fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 169.9847686290741, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.289473684210524, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.1201360563437, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.0217212760200103, "policy_loss": -0.00946984526332623, "vf_loss": 2.041732208865384, "vf_explained_var": 0.9924937746797998, "kl": 0.015508766530714032, "entropy": 1.5193718065818151, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -14.984233379862447, "episode_reward_min": -1227.5132757832096, "episode_reward_mean": -710.8905088603839, "episode_len_mean": 140.67, "episode_media": {}, "episodes_timesteps_total": 14067, "policy_reward_min": {"policy_0": -1227.5132757832096}, "policy_reward_max": {"policy_0": -14.984233379862447}, "policy_reward_mean": {"policy_0": -710.8905088603839}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-607.1764131692703, -931.2514640397006, -875.5346349596348, -578.5897859660663, -907.2497605941833, -944.9713390446472, -726.2143806258007, -402.0437255814817, -840.5739971832603, -611.272141872147, -323.12424522038975, -752.3928490384288, -736.6381839603891, -924.4961169984069, -1149.0343903847483, -765.6394013054307, -1015.8830472657789, -748.6663066863858, -670.5586522457367, -451.87980763072903, -324.69453449763296, -1168.6562770152846, -359.43098146132263, -773.13298322875, -1136.0409085972326, -854.7277667518165, -677.3511354030439, -858.8749996583872, -650.4709653053694, -370.2312939401717, -818.4515828417303, -1135.9495483226872, -1149.619289720694, -1178.499320914007, -446.80312531047673, -799.1281208987656, -675.769716254475, -711.0858047993229, -812.8087222271084, -925.3879029010491, -171.69475144737257, -630.5747687100057, -274.7216435011659, -170.99872098839754, -942.4398309461764, -1050.1836532409861, -113.04570724708667, -793.1637420407081, -1049.6987496587562, -1204.7108945381185, -548.6726811618261, -1015.4025050901944, -251.17066699534075, -60.75403854283678, -535.2524407335095, -636.6334001233793, -1161.8634053947226, -676.3852452960524, -629.2057276017642, -745.8762516563294, -425.80935755170447, -292.01465634278594, -1093.0358557568486, -400.2429476380645, -351.37450466779114, -500.9660361248472, -135.51048295425394, -581.7422164651688, -1227.5132757832096, -569.4454669237626, -958.0630867870772, -419.2275782901741, -1076.6889846199883, -618.3328683580412, -889.0418251100089, -212.58337602315922, -726.0367667795324, -293.1688783545248, -937.196990593667, -719.6899575461467, -1218.2734686401081, -841.3034403008311, -1180.8853440782425, -773.6716836355937, -660.2552919398553, -1007.0537622743971, -1012.7921680062952, -815.1477894385152, -14.984233379862447, -26.36320171323495, -890.5264125929731, -413.7752743537974, -1181.8580603227645, -745.5223468073472, -733.238981079287, -1063.2349239866858, -723.9557724232684, -826.3998162185126, -102.82292324539983, -976.5464301939666], "episode_lengths": [141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 130, 96, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 67, 138, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 39, 48, 150, 104, 150, 150, 150, 150, 150, 150, 77, 150], "policy_policy_0_reward": [-607.1764131692703, -931.2514640397006, -875.5346349596348, -578.5897859660663, -907.2497605941833, -944.9713390446472, -726.2143806258007, -402.0437255814817, -840.5739971832603, -611.272141872147, -323.12424522038975, -752.3928490384288, -736.6381839603891, -924.4961169984069, -1149.0343903847483, -765.6394013054307, -1015.8830472657789, -748.6663066863858, -670.5586522457367, -451.87980763072903, -324.69453449763296, -1168.6562770152846, -359.43098146132263, -773.13298322875, -1136.0409085972326, -854.7277667518165, -677.3511354030439, -858.8749996583872, -650.4709653053694, -370.2312939401717, -818.4515828417303, -1135.9495483226872, -1149.619289720694, -1178.499320914007, -446.80312531047673, -799.1281208987656, -675.769716254475, -711.0858047993229, -812.8087222271084, -925.3879029010491, -171.69475144737257, -630.5747687100057, -274.7216435011659, -170.99872098839754, -942.4398309461764, -1050.1836532409861, -113.04570724708667, -793.1637420407081, -1049.6987496587562, -1204.7108945381185, -548.6726811618261, -1015.4025050901944, -251.17066699534075, -60.75403854283678, -535.2524407335095, -636.6334001233793, -1161.8634053947226, -676.3852452960524, -629.2057276017642, -745.8762516563294, -425.80935755170447, -292.01465634278594, -1093.0358557568486, -400.2429476380645, -351.37450466779114, -500.9660361248472, -135.51048295425394, -581.7422164651688, -1227.5132757832096, -569.4454669237626, -958.0630867870772, -419.2275782901741, -1076.6889846199883, -618.3328683580412, -889.0418251100089, -212.58337602315922, -726.0367667795324, -293.1688783545248, -937.196990593667, -719.6899575461467, -1218.2734686401081, -841.3034403008311, -1180.8853440782425, -773.6716836355937, -660.2552919398553, -1007.0537622743971, -1012.7921680062952, -815.1477894385152, -14.984233379862447, -26.36320171323495, -890.5264125929731, -413.7752743537974, -1181.8580603227645, -745.5223468073472, -733.238981079287, -1063.2349239866858, -723.9557724232684, -826.3998162185126, -102.82292324539983, -976.5464301939666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553277558528783, "mean_inference_ms": 1.6848502260471006, "mean_action_processing_ms": 0.28015215081883205, "mean_env_wait_ms": 2.9964016577476285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011621952056884766, "StateBufferConnector_ms": 0.007872343063354492, "ViewRequirementAgentConnector_ms": 0.19234395027160645}, "num_episodes": 30, "episode_return_max": -14.984233379862447, "episode_return_min": -1227.5132757832096, "episode_return_mean": -710.8905088603839, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.232689678457, "num_env_steps_trained_throughput_per_sec": 311.232689678457, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13066.837, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13066.766, "sample_time_ms": 1017.073, "learn_time_ms": 11983.744, "learn_throughput": 333.785, "synch_weights_time_ms": 65.029}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00014", "date": "2024-08-03_11-36-20", "timestamp": 1722665180, "time_this_iter_s": 12.865418910980225, "time_total_s": 182.85018754005432, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244435ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 182.85018754005432, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.75, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.16241083343823, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.4798558867846925, "policy_loss": -0.01222902142762905, "vf_loss": 2.5024325483789047, "vf_explained_var": 0.9944004391630491, "kl": 0.016700110302735993, "entropy": 1.5357666943222283, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -14.984233379862447, "episode_reward_min": -1227.5132757832096, "episode_reward_mean": -722.1865210153301, "episode_len_mean": 139.94, "episode_media": {}, "episodes_timesteps_total": 13994, "policy_reward_min": {"policy_0": -1227.5132757832096}, "policy_reward_max": {"policy_0": -14.984233379862447}, "policy_reward_mean": {"policy_0": -722.1865210153301}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-858.8749996583872, -650.4709653053694, -370.2312939401717, -818.4515828417303, -1135.9495483226872, -1149.619289720694, -1178.499320914007, -446.80312531047673, -799.1281208987656, -675.769716254475, -711.0858047993229, -812.8087222271084, -925.3879029010491, -171.69475144737257, -630.5747687100057, -274.7216435011659, -170.99872098839754, -942.4398309461764, -1050.1836532409861, -113.04570724708667, -793.1637420407081, -1049.6987496587562, -1204.7108945381185, -548.6726811618261, -1015.4025050901944, -251.17066699534075, -60.75403854283678, -535.2524407335095, -636.6334001233793, -1161.8634053947226, -676.3852452960524, -629.2057276017642, -745.8762516563294, -425.80935755170447, -292.01465634278594, -1093.0358557568486, -400.2429476380645, -351.37450466779114, -500.9660361248472, -135.51048295425394, -581.7422164651688, -1227.5132757832096, -569.4454669237626, -958.0630867870772, -419.2275782901741, -1076.6889846199883, -618.3328683580412, -889.0418251100089, -212.58337602315922, -726.0367667795324, -293.1688783545248, -937.196990593667, -719.6899575461467, -1218.2734686401081, -841.3034403008311, -1180.8853440782425, -773.6716836355937, -660.2552919398553, -1007.0537622743971, -1012.7921680062952, -815.1477894385152, -14.984233379862447, -26.36320171323495, -890.5264125929731, -413.7752743537974, -1181.8580603227645, -745.5223468073472, -733.238981079287, -1063.2349239866858, -723.9557724232684, -826.3998162185126, -102.82292324539983, -976.5464301939666, -442.42925972752766, -1135.2608400938498, -1148.5583431108116, -1143.285258329412, -299.95167109832124, -936.3375924073073, -1105.0483361713607, -864.0688868584232, -868.3021736016069, -80.9405372511353, -911.6833133063942, -628.1325801365778, -1051.022762671495, -993.075853195336, -751.3010699316851, -1169.6948104044134, -928.8983273618225, -1171.1862967140098, -127.19613210105938, -936.3789673366464, -764.3736015208488, -352.61748584109927, -774.3837107483105, -1172.5316314387605, -443.6943787290593, -557.4489975568931, -629.023628578177], "episode_lengths": [150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 130, 96, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 67, 138, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 39, 48, 150, 104, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-858.8749996583872, -650.4709653053694, -370.2312939401717, -818.4515828417303, -1135.9495483226872, -1149.619289720694, -1178.499320914007, -446.80312531047673, -799.1281208987656, -675.769716254475, -711.0858047993229, -812.8087222271084, -925.3879029010491, -171.69475144737257, -630.5747687100057, -274.7216435011659, -170.99872098839754, -942.4398309461764, -1050.1836532409861, -113.04570724708667, -793.1637420407081, -1049.6987496587562, -1204.7108945381185, -548.6726811618261, -1015.4025050901944, -251.17066699534075, -60.75403854283678, -535.2524407335095, -636.6334001233793, -1161.8634053947226, -676.3852452960524, -629.2057276017642, -745.8762516563294, -425.80935755170447, -292.01465634278594, -1093.0358557568486, -400.2429476380645, -351.37450466779114, -500.9660361248472, -135.51048295425394, -581.7422164651688, -1227.5132757832096, -569.4454669237626, -958.0630867870772, -419.2275782901741, -1076.6889846199883, -618.3328683580412, -889.0418251100089, -212.58337602315922, -726.0367667795324, -293.1688783545248, -937.196990593667, -719.6899575461467, -1218.2734686401081, -841.3034403008311, -1180.8853440782425, -773.6716836355937, -660.2552919398553, -1007.0537622743971, -1012.7921680062952, -815.1477894385152, -14.984233379862447, -26.36320171323495, -890.5264125929731, -413.7752743537974, -1181.8580603227645, -745.5223468073472, -733.238981079287, -1063.2349239866858, -723.9557724232684, -826.3998162185126, -102.82292324539983, -976.5464301939666, -442.42925972752766, -1135.2608400938498, -1148.5583431108116, -1143.285258329412, -299.95167109832124, -936.3375924073073, -1105.0483361713607, -864.0688868584232, -868.3021736016069, -80.9405372511353, -911.6833133063942, -628.1325801365778, -1051.022762671495, -993.075853195336, -751.3010699316851, -1169.6948104044134, -928.8983273618225, -1171.1862967140098, -127.19613210105938, -936.3789673366464, -764.3736015208488, -352.61748584109927, -774.3837107483105, -1172.5316314387605, -443.6943787290593, -557.4489975568931, -629.023628578177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553085106982802, "mean_inference_ms": 1.6849131542735845, "mean_action_processing_ms": 0.279937445190601, "mean_env_wait_ms": 2.997050760743491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01173257827758789, "StateBufferConnector_ms": 0.00785970687866211, "ViewRequirementAgentConnector_ms": 0.19346117973327637}, "num_episodes": 27, "episode_return_max": -14.984233379862447, "episode_return_min": -1227.5132757832096, "episode_return_mean": -722.1865210153301, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.63471975345414, "num_env_steps_trained_throughput_per_sec": 301.63471975345414, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13236.956, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13236.883, "sample_time_ms": 1025.274, "learn_time_ms": 12144.894, "learn_throughput": 329.357, "synch_weights_time_ms": 65.784}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00014", "date": "2024-08-03_11-36-34", "timestamp": 1722665194, "time_this_iter_s": 13.275433778762817, "time_total_s": 196.12562131881714, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444353f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 196.12562131881714, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 14.005263157894738, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 125.79455307821432, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.8309978334854047, "policy_loss": -0.012630572531876775, "vf_loss": 2.8540572984764974, "vf_explained_var": 0.9723543596764406, "kl": 0.011176290367257036, "entropy": 1.3781786714990933, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -14.984233379862447, "episode_reward_min": -1268.7742995813849, "episode_reward_mean": -703.3041572268761, "episode_len_mean": 140.29, "episode_media": {}, "episodes_timesteps_total": 14029, "policy_reward_min": {"policy_0": -1268.7742995813849}, "policy_reward_max": {"policy_0": -14.984233379862447}, "policy_reward_mean": {"policy_0": -703.3041572268761}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1161.8634053947226, -676.3852452960524, -629.2057276017642, -745.8762516563294, -425.80935755170447, -292.01465634278594, -1093.0358557568486, -400.2429476380645, -351.37450466779114, -500.9660361248472, -135.51048295425394, -581.7422164651688, -1227.5132757832096, -569.4454669237626, -958.0630867870772, -419.2275782901741, -1076.6889846199883, -618.3328683580412, -889.0418251100089, -212.58337602315922, -726.0367667795324, -293.1688783545248, -937.196990593667, -719.6899575461467, -1218.2734686401081, -841.3034403008311, -1180.8853440782425, -773.6716836355937, -660.2552919398553, -1007.0537622743971, -1012.7921680062952, -815.1477894385152, -14.984233379862447, -26.36320171323495, -890.5264125929731, -413.7752743537974, -1181.8580603227645, -745.5223468073472, -733.238981079287, -1063.2349239866858, -723.9557724232684, -826.3998162185126, -102.82292324539983, -976.5464301939666, -442.42925972752766, -1135.2608400938498, -1148.5583431108116, -1143.285258329412, -299.95167109832124, -936.3375924073073, -1105.0483361713607, -864.0688868584232, -868.3021736016069, -80.9405372511353, -911.6833133063942, -628.1325801365778, -1051.022762671495, -993.075853195336, -751.3010699316851, -1169.6948104044134, -928.8983273618225, -1171.1862967140098, -127.19613210105938, -936.3789673366464, -764.3736015208488, -352.61748584109927, -774.3837107483105, -1172.5316314387605, -443.6943787290593, -557.4489975568931, -629.023628578177, -518.9471097237147, -632.6033520362213, -330.4723605644607, -1132.6359531964224, -951.5412405643713, -613.9796984834223, -712.0490431748888, -791.8122855756399, -661.8325082125509, -417.35428093588706, -135.45719344458254, -826.2340867624846, -893.5658808882156, -640.2149669809795, -586.601827980937, -893.7349075102791, -1268.7742995813849, -140.11590788361605, -388.4583502924408, -636.5945097841663, -503.42052339822817, -526.8246853644297, -630.635583082815, -854.4554932367332, -734.7159317166063, -235.55650835030812, -158.09418843055855, -607.3446685309749, -669.9348635273756], "episode_lengths": [150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 39, 48, 150, 104, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 60, 120, 150, 150, 150, 150, 150, 150, 81, 100, 126, 148], "policy_policy_0_reward": [-1161.8634053947226, -676.3852452960524, -629.2057276017642, -745.8762516563294, -425.80935755170447, -292.01465634278594, -1093.0358557568486, -400.2429476380645, -351.37450466779114, -500.9660361248472, -135.51048295425394, -581.7422164651688, -1227.5132757832096, -569.4454669237626, -958.0630867870772, -419.2275782901741, -1076.6889846199883, -618.3328683580412, -889.0418251100089, -212.58337602315922, -726.0367667795324, -293.1688783545248, -937.196990593667, -719.6899575461467, -1218.2734686401081, -841.3034403008311, -1180.8853440782425, -773.6716836355937, -660.2552919398553, -1007.0537622743971, -1012.7921680062952, -815.1477894385152, -14.984233379862447, -26.36320171323495, -890.5264125929731, -413.7752743537974, -1181.8580603227645, -745.5223468073472, -733.238981079287, -1063.2349239866858, -723.9557724232684, -826.3998162185126, -102.82292324539983, -976.5464301939666, -442.42925972752766, -1135.2608400938498, -1148.5583431108116, -1143.285258329412, -299.95167109832124, -936.3375924073073, -1105.0483361713607, -864.0688868584232, -868.3021736016069, -80.9405372511353, -911.6833133063942, -628.1325801365778, -1051.022762671495, -993.075853195336, -751.3010699316851, -1169.6948104044134, -928.8983273618225, -1171.1862967140098, -127.19613210105938, -936.3789673366464, -764.3736015208488, -352.61748584109927, -774.3837107483105, -1172.5316314387605, -443.6943787290593, -557.4489975568931, -629.023628578177, -518.9471097237147, -632.6033520362213, -330.4723605644607, -1132.6359531964224, -951.5412405643713, -613.9796984834223, -712.0490431748888, -791.8122855756399, -661.8325082125509, -417.35428093588706, -135.45719344458254, -826.2340867624846, -893.5658808882156, -640.2149669809795, -586.601827980937, -893.7349075102791, -1268.7742995813849, -140.11590788361605, -388.4583502924408, -636.5945097841663, -503.42052339822817, -526.8246853644297, -630.635583082815, -854.4554932367332, -734.7159317166063, -235.55650835030812, -158.09418843055855, -607.3446685309749, -669.9348635273756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5529452666458732, "mean_inference_ms": 1.6841685274304314, "mean_action_processing_ms": 0.27960787417875477, "mean_env_wait_ms": 2.998101446824385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011903524398803711, "StateBufferConnector_ms": 0.007881641387939453, "ViewRequirementAgentConnector_ms": 0.19516372680664062}, "num_episodes": 29, "episode_return_max": -14.984233379862447, "episode_return_min": -1268.7742995813849, "episode_return_mean": -703.3041572268761, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.25922428842716, "num_env_steps_trained_throughput_per_sec": 304.25922428842716, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13212.67, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13212.595, "sample_time_ms": 1028.016, "learn_time_ms": 12118.403, "learn_throughput": 330.076, "synch_weights_time_ms": 65.3}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00014", "date": "2024-08-03_11-36-47", "timestamp": 1722665207, "time_this_iter_s": 13.16013765335083, "time_total_s": 209.28575897216797, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c1a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 209.28575897216797, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.468421052631578, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.95090543429058, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.476377812648813, "policy_loss": -0.008405766913589711, "vf_loss": 2.495620982721448, "vf_explained_var": 0.9819474431375662, "kl": 0.013509110534776407, "entropy": 1.489012837037444, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -14.984233379862447, "episode_reward_min": -1268.7742995813849, "episode_reward_mean": -700.6469631421112, "episode_len_mean": 139.01, "episode_media": {}, "episodes_timesteps_total": 13901, "policy_reward_min": {"policy_0": -1268.7742995813849}, "policy_reward_max": {"policy_0": -14.984233379862447}, "policy_reward_mean": {"policy_0": -700.6469631421112}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1180.8853440782425, -773.6716836355937, -660.2552919398553, -1007.0537622743971, -1012.7921680062952, -815.1477894385152, -14.984233379862447, -26.36320171323495, -890.5264125929731, -413.7752743537974, -1181.8580603227645, -745.5223468073472, -733.238981079287, -1063.2349239866858, -723.9557724232684, -826.3998162185126, -102.82292324539983, -976.5464301939666, -442.42925972752766, -1135.2608400938498, -1148.5583431108116, -1143.285258329412, -299.95167109832124, -936.3375924073073, -1105.0483361713607, -864.0688868584232, -868.3021736016069, -80.9405372511353, -911.6833133063942, -628.1325801365778, -1051.022762671495, -993.075853195336, -751.3010699316851, -1169.6948104044134, -928.8983273618225, -1171.1862967140098, -127.19613210105938, -936.3789673366464, -764.3736015208488, -352.61748584109927, -774.3837107483105, -1172.5316314387605, -443.6943787290593, -557.4489975568931, -629.023628578177, -518.9471097237147, -632.6033520362213, -330.4723605644607, -1132.6359531964224, -951.5412405643713, -613.9796984834223, -712.0490431748888, -791.8122855756399, -661.8325082125509, -417.35428093588706, -135.45719344458254, -826.2340867624846, -893.5658808882156, -640.2149669809795, -586.601827980937, -893.7349075102791, -1268.7742995813849, -140.11590788361605, -388.4583502924408, -636.5945097841663, -503.42052339822817, -526.8246853644297, -630.635583082815, -854.4554932367332, -734.7159317166063, -235.55650835030812, -158.09418843055855, -607.3446685309749, -669.9348635273756, -552.0541493679044, -608.8257597619531, -223.10206771720144, -1078.268894356978, -1106.2037144593692, -830.8949424532246, -780.599609062397, -897.7431887292336, -35.25600830373439, -838.2067658487223, -270.62400122771135, -680.0934299088694, -111.27208002070107, -637.9117168384647, -773.9485198070698, -482.4328736237796, -894.6822796525769, -712.7897911284233, -295.8774064192286, -910.3394819671946, -896.9303921657433, -1037.9932921534012, -430.61276698258837, -940.7794663398088, -353.4074938793465, -1054.0231509084413], "episode_lengths": [150, 150, 150, 150, 150, 150, 39, 48, 150, 104, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 60, 120, 150, 150, 150, 150, 150, 150, 81, 100, 126, 148, 150, 150, 114, 150, 150, 150, 150, 150, 54, 150, 150, 150, 88, 150, 150, 131, 150, 141, 135, 150, 150, 150, 124, 150, 116, 150], "policy_policy_0_reward": [-1180.8853440782425, -773.6716836355937, -660.2552919398553, -1007.0537622743971, -1012.7921680062952, -815.1477894385152, -14.984233379862447, -26.36320171323495, -890.5264125929731, -413.7752743537974, -1181.8580603227645, -745.5223468073472, -733.238981079287, -1063.2349239866858, -723.9557724232684, -826.3998162185126, -102.82292324539983, -976.5464301939666, -442.42925972752766, -1135.2608400938498, -1148.5583431108116, -1143.285258329412, -299.95167109832124, -936.3375924073073, -1105.0483361713607, -864.0688868584232, -868.3021736016069, -80.9405372511353, -911.6833133063942, -628.1325801365778, -1051.022762671495, -993.075853195336, -751.3010699316851, -1169.6948104044134, -928.8983273618225, -1171.1862967140098, -127.19613210105938, -936.3789673366464, -764.3736015208488, -352.61748584109927, -774.3837107483105, -1172.5316314387605, -443.6943787290593, -557.4489975568931, -629.023628578177, -518.9471097237147, -632.6033520362213, -330.4723605644607, -1132.6359531964224, -951.5412405643713, -613.9796984834223, -712.0490431748888, -791.8122855756399, -661.8325082125509, -417.35428093588706, -135.45719344458254, -826.2340867624846, -893.5658808882156, -640.2149669809795, -586.601827980937, -893.7349075102791, -1268.7742995813849, -140.11590788361605, -388.4583502924408, -636.5945097841663, -503.42052339822817, -526.8246853644297, -630.635583082815, -854.4554932367332, -734.7159317166063, -235.55650835030812, -158.09418843055855, -607.3446685309749, -669.9348635273756, -552.0541493679044, -608.8257597619531, -223.10206771720144, -1078.268894356978, -1106.2037144593692, -830.8949424532246, -780.599609062397, -897.7431887292336, -35.25600830373439, -838.2067658487223, -270.62400122771135, -680.0934299088694, -111.27208002070107, -637.9117168384647, -773.9485198070698, -482.4328736237796, -894.6822796525769, -712.7897911284233, -295.8774064192286, -910.3394819671946, -896.9303921657433, -1037.9932921534012, -430.61276698258837, -940.7794663398088, -353.4074938793465, -1054.0231509084413]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5528378490451453, "mean_inference_ms": 1.685158492105223, "mean_action_processing_ms": 0.27971890683507433, "mean_env_wait_ms": 3.0007812984936235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012135982513427734, "StateBufferConnector_ms": 0.007932901382446289, "ViewRequirementAgentConnector_ms": 0.19634723663330078}, "num_episodes": 26, "episode_return_max": -14.984233379862447, "episode_return_min": -1268.7742995813849, "episode_return_mean": -700.6469631421112, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.1880356949454, "num_env_steps_trained_throughput_per_sec": 301.1880356949454, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13210.443, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13210.369, "sample_time_ms": 1028.394, "learn_time_ms": 12115.967, "learn_throughput": 330.143, "synch_weights_time_ms": 65.142}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00014", "date": "2024-08-03_11-37-00", "timestamp": 1722665220, "time_this_iter_s": 13.290740013122559, "time_total_s": 222.57649898529053, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244490040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 222.57649898529053, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.957894736842107, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.17359076539677, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.7234071735292673, "policy_loss": -0.013337582712604974, "vf_loss": 2.7468014251440764, "vf_explained_var": 0.9828967659423749, "kl": 0.013527890833271779, "entropy": 1.4115041842063267, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -35.25600830373439, "episode_reward_min": -1268.7742995813849, "episode_reward_mean": -645.7468303647107, "episode_len_mean": 136.98, "episode_media": {}, "episodes_timesteps_total": 13698, "policy_reward_min": {"policy_0": -1268.7742995813849}, "policy_reward_max": {"policy_0": -35.25600830373439}, "policy_reward_mean": {"policy_0": -645.7468303647107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-751.3010699316851, -1169.6948104044134, -928.8983273618225, -1171.1862967140098, -127.19613210105938, -936.3789673366464, -764.3736015208488, -352.61748584109927, -774.3837107483105, -1172.5316314387605, -443.6943787290593, -557.4489975568931, -629.023628578177, -518.9471097237147, -632.6033520362213, -330.4723605644607, -1132.6359531964224, -951.5412405643713, -613.9796984834223, -712.0490431748888, -791.8122855756399, -661.8325082125509, -417.35428093588706, -135.45719344458254, -826.2340867624846, -893.5658808882156, -640.2149669809795, -586.601827980937, -893.7349075102791, -1268.7742995813849, -140.11590788361605, -388.4583502924408, -636.5945097841663, -503.42052339822817, -526.8246853644297, -630.635583082815, -854.4554932367332, -734.7159317166063, -235.55650835030812, -158.09418843055855, -607.3446685309749, -669.9348635273756, -552.0541493679044, -608.8257597619531, -223.10206771720144, -1078.268894356978, -1106.2037144593692, -830.8949424532246, -780.599609062397, -897.7431887292336, -35.25600830373439, -838.2067658487223, -270.62400122771135, -680.0934299088694, -111.27208002070107, -637.9117168384647, -773.9485198070698, -482.4328736237796, -894.6822796525769, -712.7897911284233, -295.8774064192286, -910.3394819671946, -896.9303921657433, -1037.9932921534012, -430.61276698258837, -940.7794663398088, -353.4074938793465, -1054.0231509084413, -374.730898706646, -173.62171622269904, -894.9097307480853, -43.22093302922137, -279.2879269016511, -660.9417041966055, -579.0180203931675, -704.3918086176143, -959.0201607764454, -665.8391370433533, -872.5726228697329, -528.8401939027516, -108.18397971440525, -136.97910692285345, -439.4626003932356, -1007.9236292292691, -1217.5946402944699, -754.1122006749513, -688.4229687733183, -1128.7438758729159, -128.42099345449284, -754.9107697198824, -758.917532146379, -878.6289166685606, -252.08265147586644, -928.5603838119144, -151.1985100567836, -119.48983507762046, -744.2541615295098, -430.90169808570784, -1241.5139685114368, -660.4212700879797], "episode_lengths": [150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 60, 120, 150, 150, 150, 150, 150, 150, 81, 100, 126, 148, 150, 150, 114, 150, 150, 150, 150, 150, 54, 150, 150, 150, 88, 150, 150, 131, 150, 141, 135, 150, 150, 150, 124, 150, 116, 150, 150, 78, 150, 56, 91, 150, 150, 150, 150, 150, 150, 150, 82, 85, 146, 150, 150, 150, 150, 150, 79, 150, 150, 150, 92, 150, 102, 91, 146, 150, 150, 150], "policy_policy_0_reward": [-751.3010699316851, -1169.6948104044134, -928.8983273618225, -1171.1862967140098, -127.19613210105938, -936.3789673366464, -764.3736015208488, -352.61748584109927, -774.3837107483105, -1172.5316314387605, -443.6943787290593, -557.4489975568931, -629.023628578177, -518.9471097237147, -632.6033520362213, -330.4723605644607, -1132.6359531964224, -951.5412405643713, -613.9796984834223, -712.0490431748888, -791.8122855756399, -661.8325082125509, -417.35428093588706, -135.45719344458254, -826.2340867624846, -893.5658808882156, -640.2149669809795, -586.601827980937, -893.7349075102791, -1268.7742995813849, -140.11590788361605, -388.4583502924408, -636.5945097841663, -503.42052339822817, -526.8246853644297, -630.635583082815, -854.4554932367332, -734.7159317166063, -235.55650835030812, -158.09418843055855, -607.3446685309749, -669.9348635273756, -552.0541493679044, -608.8257597619531, -223.10206771720144, -1078.268894356978, -1106.2037144593692, -830.8949424532246, -780.599609062397, -897.7431887292336, -35.25600830373439, -838.2067658487223, -270.62400122771135, -680.0934299088694, -111.27208002070107, -637.9117168384647, -773.9485198070698, -482.4328736237796, -894.6822796525769, -712.7897911284233, -295.8774064192286, -910.3394819671946, -896.9303921657433, -1037.9932921534012, -430.61276698258837, -940.7794663398088, -353.4074938793465, -1054.0231509084413, -374.730898706646, -173.62171622269904, -894.9097307480853, -43.22093302922137, -279.2879269016511, -660.9417041966055, -579.0180203931675, -704.3918086176143, -959.0201607764454, -665.8391370433533, -872.5726228697329, -528.8401939027516, -108.18397971440525, -136.97910692285345, -439.4626003932356, -1007.9236292292691, -1217.5946402944699, -754.1122006749513, -688.4229687733183, -1128.7438758729159, -128.42099345449284, -754.9107697198824, -758.917532146379, -878.6289166685606, -252.08265147586644, -928.5603838119144, -151.1985100567836, -119.48983507762046, -744.2541615295098, -430.90169808570784, -1241.5139685114368, -660.4212700879797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552889419664777, "mean_inference_ms": 1.6845286802813348, "mean_action_processing_ms": 0.2797842249649698, "mean_env_wait_ms": 3.0011558411367663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011806249618530273, "StateBufferConnector_ms": 0.007883548736572266, "ViewRequirementAgentConnector_ms": 0.1947939395904541}, "num_episodes": 32, "episode_return_max": -35.25600830373439, "episode_return_min": -1268.7742995813849, "episode_return_mean": -645.7468303647107, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.10796253252994, "num_env_steps_trained_throughput_per_sec": 388.10796253252994, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12910.271, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12910.199, "sample_time_ms": 1028.345, "learn_time_ms": 11817.76, "learn_throughput": 338.474, "synch_weights_time_ms": 63.242}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00014", "date": "2024-08-03_11-37-10", "timestamp": 1722665230, "time_this_iter_s": 10.31837773323059, "time_total_s": 232.89487671852112, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444353f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 232.89487671852112, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 15.557142857142859, "ram_util_percent": 27.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.84515539507072, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.4495429870362084, "policy_loss": -0.015374841672504165, "vf_loss": 2.4754192924747866, "vf_explained_var": 0.9832076258336504, "kl": 0.015538543091474821, "entropy": 1.516302511592706, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -35.25600830373439, "episode_reward_min": -1268.7742995813849, "episode_reward_mean": -660.9596611234422, "episode_len_mean": 136.45, "episode_media": {}, "episodes_timesteps_total": 13645, "policy_reward_min": {"policy_0": -1268.7742995813849}, "policy_reward_max": {"policy_0": -35.25600830373439}, "policy_reward_mean": {"policy_0": -660.9596611234422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-586.601827980937, -893.7349075102791, -1268.7742995813849, -140.11590788361605, -388.4583502924408, -636.5945097841663, -503.42052339822817, -526.8246853644297, -630.635583082815, -854.4554932367332, -734.7159317166063, -235.55650835030812, -158.09418843055855, -607.3446685309749, -669.9348635273756, -552.0541493679044, -608.8257597619531, -223.10206771720144, -1078.268894356978, -1106.2037144593692, -830.8949424532246, -780.599609062397, -897.7431887292336, -35.25600830373439, -838.2067658487223, -270.62400122771135, -680.0934299088694, -111.27208002070107, -637.9117168384647, -773.9485198070698, -482.4328736237796, -894.6822796525769, -712.7897911284233, -295.8774064192286, -910.3394819671946, -896.9303921657433, -1037.9932921534012, -430.61276698258837, -940.7794663398088, -353.4074938793465, -1054.0231509084413, -374.730898706646, -173.62171622269904, -894.9097307480853, -43.22093302922137, -279.2879269016511, -660.9417041966055, -579.0180203931675, -704.3918086176143, -959.0201607764454, -665.8391370433533, -872.5726228697329, -528.8401939027516, -108.18397971440525, -136.97910692285345, -439.4626003932356, -1007.9236292292691, -1217.5946402944699, -754.1122006749513, -688.4229687733183, -1128.7438758729159, -128.42099345449284, -754.9107697198824, -758.917532146379, -878.6289166685606, -252.08265147586644, -928.5603838119144, -151.1985100567836, -119.48983507762046, -744.2541615295098, -430.90169808570784, -1241.5139685114368, -660.4212700879797, -1150.4516717114532, -981.9558062334778, -854.2440167160755, -746.5462310885923, -875.4970103602748, -604.6954056879055, -997.7009164374142, -857.2801019899053, -752.0555784656108, -627.7560822636859, -725.2457065176252, -370.676277008802, -895.0034306422309, -215.25281367889195, -346.29448169611413, -714.9974838602831, -978.988252672362, -1059.8474769289255, -146.20137487901744, -893.1492614659772, -775.5988059848472, -814.4591491333119, -384.55140837467127, -960.2675623146666, -855.1324143549803, -1067.4256204849235, -907.4377337277415], "episode_lengths": [150, 150, 150, 60, 120, 150, 150, 150, 150, 150, 150, 81, 100, 126, 148, 150, 150, 114, 150, 150, 150, 150, 150, 54, 150, 150, 150, 88, 150, 150, 131, 150, 141, 135, 150, 150, 150, 124, 150, 116, 150, 150, 78, 150, 56, 91, 150, 150, 150, 150, 150, 150, 150, 82, 85, 146, 150, 150, 150, 150, 150, 79, 150, 150, 150, 92, 150, 102, 91, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 114, 122, 150, 150, 150, 81, 150, 150, 150, 143, 150, 150, 150, 150], "policy_policy_0_reward": [-586.601827980937, -893.7349075102791, -1268.7742995813849, -140.11590788361605, -388.4583502924408, -636.5945097841663, -503.42052339822817, -526.8246853644297, -630.635583082815, -854.4554932367332, -734.7159317166063, -235.55650835030812, -158.09418843055855, -607.3446685309749, -669.9348635273756, -552.0541493679044, -608.8257597619531, -223.10206771720144, -1078.268894356978, -1106.2037144593692, -830.8949424532246, -780.599609062397, -897.7431887292336, -35.25600830373439, -838.2067658487223, -270.62400122771135, -680.0934299088694, -111.27208002070107, -637.9117168384647, -773.9485198070698, -482.4328736237796, -894.6822796525769, -712.7897911284233, -295.8774064192286, -910.3394819671946, -896.9303921657433, -1037.9932921534012, -430.61276698258837, -940.7794663398088, -353.4074938793465, -1054.0231509084413, -374.730898706646, -173.62171622269904, -894.9097307480853, -43.22093302922137, -279.2879269016511, -660.9417041966055, -579.0180203931675, -704.3918086176143, -959.0201607764454, -665.8391370433533, -872.5726228697329, -528.8401939027516, -108.18397971440525, -136.97910692285345, -439.4626003932356, -1007.9236292292691, -1217.5946402944699, -754.1122006749513, -688.4229687733183, -1128.7438758729159, -128.42099345449284, -754.9107697198824, -758.917532146379, -878.6289166685606, -252.08265147586644, -928.5603838119144, -151.1985100567836, -119.48983507762046, -744.2541615295098, -430.90169808570784, -1241.5139685114368, -660.4212700879797, -1150.4516717114532, -981.9558062334778, -854.2440167160755, -746.5462310885923, -875.4970103602748, -604.6954056879055, -997.7009164374142, -857.2801019899053, -752.0555784656108, -627.7560822636859, -725.2457065176252, -370.676277008802, -895.0034306422309, -215.25281367889195, -346.29448169611413, -714.9974838602831, -978.988252672362, -1059.8474769289255, -146.20137487901744, -893.1492614659772, -775.5988059848472, -814.4591491333119, -384.55140837467127, -960.2675623146666, -855.1324143549803, -1067.4256204849235, -907.4377337277415]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523571069980676, "mean_inference_ms": 1.6830041482523723, "mean_action_processing_ms": 0.27946072704324826, "mean_env_wait_ms": 3.0007748548574047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011835575103759766, "StateBufferConnector_ms": 0.008045434951782227, "ViewRequirementAgentConnector_ms": 0.19399762153625488}, "num_episodes": 27, "episode_return_max": -35.25600830373439, "episode_return_min": -1268.7742995813849, "episode_return_mean": -660.9596611234422, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.39352661259994, "num_env_steps_trained_throughput_per_sec": 304.39352661259994, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12905.988, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12905.916, "sample_time_ms": 1032.746, "learn_time_ms": 11808.319, "learn_throughput": 338.744, "synch_weights_time_ms": 64.009}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00014", "date": "2024-08-03_11-37-24", "timestamp": 1722665244, "time_this_iter_s": 13.15325927734375, "time_total_s": 246.04813599586487, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c1a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 246.04813599586487, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.705263157894736, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.73792568544548, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.3933151715124645, "policy_loss": -0.018195498531713383, "vf_loss": 2.421673490727941, "vf_explained_var": 0.9858437237019341, "kl": 0.014720040230107164, "entropy": 1.4578832836200795, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -43.22093302922137, "episode_reward_min": -1489.277288140948, "episode_reward_mean": -688.8337092003754, "episode_len_mean": 137.32, "episode_media": {}, "episodes_timesteps_total": 13732, "policy_reward_min": {"policy_0": -1489.277288140948}, "policy_reward_max": {"policy_0": -43.22093302922137}, "policy_reward_mean": {"policy_0": -688.8337092003754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-482.4328736237796, -894.6822796525769, -712.7897911284233, -295.8774064192286, -910.3394819671946, -896.9303921657433, -1037.9932921534012, -430.61276698258837, -940.7794663398088, -353.4074938793465, -1054.0231509084413, -374.730898706646, -173.62171622269904, -894.9097307480853, -43.22093302922137, -279.2879269016511, -660.9417041966055, -579.0180203931675, -704.3918086176143, -959.0201607764454, -665.8391370433533, -872.5726228697329, -528.8401939027516, -108.18397971440525, -136.97910692285345, -439.4626003932356, -1007.9236292292691, -1217.5946402944699, -754.1122006749513, -688.4229687733183, -1128.7438758729159, -128.42099345449284, -754.9107697198824, -758.917532146379, -878.6289166685606, -252.08265147586644, -928.5603838119144, -151.1985100567836, -119.48983507762046, -744.2541615295098, -430.90169808570784, -1241.5139685114368, -660.4212700879797, -1150.4516717114532, -981.9558062334778, -854.2440167160755, -746.5462310885923, -875.4970103602748, -604.6954056879055, -997.7009164374142, -857.2801019899053, -752.0555784656108, -627.7560822636859, -725.2457065176252, -370.676277008802, -895.0034306422309, -215.25281367889195, -346.29448169611413, -714.9974838602831, -978.988252672362, -1059.8474769289255, -146.20137487901744, -893.1492614659772, -775.5988059848472, -814.4591491333119, -384.55140837467127, -960.2675623146666, -855.1324143549803, -1067.4256204849235, -907.4377337277415, -911.7671727091074, -901.2860549014812, -1330.2926220699303, -771.9992958151878, -422.12415509134763, -725.7076016801103, -149.19360308625758, -1121.769392156301, -184.77539428169865, -1025.0132035751317, -793.0161914743587, -495.94020083500556, -881.5465078763223, -1197.1259200273312, -845.2776582343158, -313.889014656542, -537.3489664174818, -691.2320806732766, -754.611811613793, -50.75146239425322, -800.9066345867517, -409.0949256120878, -1018.4659962086606, -313.76562250799793, -729.463183019986, -417.1044867047109, -656.2769522507801, -583.5383419878577, -1489.277288140948, -525.1101636387015], "episode_lengths": [131, 150, 141, 135, 150, 150, 150, 124, 150, 116, 150, 150, 78, 150, 56, 91, 150, 150, 150, 150, 150, 150, 150, 82, 85, 146, 150, 150, 150, 150, 150, 79, 150, 150, 150, 92, 150, 102, 91, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 114, 122, 150, 150, 150, 81, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 104, 150, 72, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 61, 150, 117, 150, 101, 150, 150, 150, 150, 150, 134], "policy_policy_0_reward": [-482.4328736237796, -894.6822796525769, -712.7897911284233, -295.8774064192286, -910.3394819671946, -896.9303921657433, -1037.9932921534012, -430.61276698258837, -940.7794663398088, -353.4074938793465, -1054.0231509084413, -374.730898706646, -173.62171622269904, -894.9097307480853, -43.22093302922137, -279.2879269016511, -660.9417041966055, -579.0180203931675, -704.3918086176143, -959.0201607764454, -665.8391370433533, -872.5726228697329, -528.8401939027516, -108.18397971440525, -136.97910692285345, -439.4626003932356, -1007.9236292292691, -1217.5946402944699, -754.1122006749513, -688.4229687733183, -1128.7438758729159, -128.42099345449284, -754.9107697198824, -758.917532146379, -878.6289166685606, -252.08265147586644, -928.5603838119144, -151.1985100567836, -119.48983507762046, -744.2541615295098, -430.90169808570784, -1241.5139685114368, -660.4212700879797, -1150.4516717114532, -981.9558062334778, -854.2440167160755, -746.5462310885923, -875.4970103602748, -604.6954056879055, -997.7009164374142, -857.2801019899053, -752.0555784656108, -627.7560822636859, -725.2457065176252, -370.676277008802, -895.0034306422309, -215.25281367889195, -346.29448169611413, -714.9974838602831, -978.988252672362, -1059.8474769289255, -146.20137487901744, -893.1492614659772, -775.5988059848472, -814.4591491333119, -384.55140837467127, -960.2675623146666, -855.1324143549803, -1067.4256204849235, -907.4377337277415, -911.7671727091074, -901.2860549014812, -1330.2926220699303, -771.9992958151878, -422.12415509134763, -725.7076016801103, -149.19360308625758, -1121.769392156301, -184.77539428169865, -1025.0132035751317, -793.0161914743587, -495.94020083500556, -881.5465078763223, -1197.1259200273312, -845.2776582343158, -313.889014656542, -537.3489664174818, -691.2320806732766, -754.611811613793, -50.75146239425322, -800.9066345867517, -409.0949256120878, -1018.4659962086606, -313.76562250799793, -729.463183019986, -417.1044867047109, -656.2769522507801, -583.5383419878577, -1489.277288140948, -525.1101636387015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520459687559303, "mean_inference_ms": 1.682231405529614, "mean_action_processing_ms": 0.27930109751702303, "mean_env_wait_ms": 3.000759759125874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011810064315795898, "StateBufferConnector_ms": 0.007985353469848633, "ViewRequirementAgentConnector_ms": 0.19232678413391113}, "num_episodes": 30, "episode_return_max": -43.22093302922137, "episode_return_min": -1489.277288140948, "episode_return_mean": -688.8337092003754, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.4077231582915, "num_env_steps_trained_throughput_per_sec": 296.4077231582915, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12930.851, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12930.776, "sample_time_ms": 1034.278, "learn_time_ms": 11831.928, "learn_throughput": 338.068, "synch_weights_time_ms": 63.721}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00014", "date": "2024-08-03_11-37-37", "timestamp": 1722665257, "time_this_iter_s": 13.507484912872314, "time_total_s": 259.5556209087372, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244437880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 259.5556209087372, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.63684210526316, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 157.80666314562163, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.358300664337973, "policy_loss": -0.015874215168878436, "vf_loss": 2.3843525586028895, "vf_explained_var": 0.9886095804472764, "kl": 0.018346209278903795, "entropy": 1.5681551236659288, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -25.243800002169483, "episode_reward_min": -1489.277288140948, "episode_reward_mean": -681.9693364373462, "episode_len_mean": 137.69, "episode_media": {}, "episodes_timesteps_total": 13769, "policy_reward_min": {"policy_0": -1489.277288140948}, "policy_reward_max": {"policy_0": -25.243800002169483}, "policy_reward_mean": {"policy_0": -681.9693364373462}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-688.4229687733183, -1128.7438758729159, -128.42099345449284, -754.9107697198824, -758.917532146379, -878.6289166685606, -252.08265147586644, -928.5603838119144, -151.1985100567836, -119.48983507762046, -744.2541615295098, -430.90169808570784, -1241.5139685114368, -660.4212700879797, -1150.4516717114532, -981.9558062334778, -854.2440167160755, -746.5462310885923, -875.4970103602748, -604.6954056879055, -997.7009164374142, -857.2801019899053, -752.0555784656108, -627.7560822636859, -725.2457065176252, -370.676277008802, -895.0034306422309, -215.25281367889195, -346.29448169611413, -714.9974838602831, -978.988252672362, -1059.8474769289255, -146.20137487901744, -893.1492614659772, -775.5988059848472, -814.4591491333119, -384.55140837467127, -960.2675623146666, -855.1324143549803, -1067.4256204849235, -907.4377337277415, -911.7671727091074, -901.2860549014812, -1330.2926220699303, -771.9992958151878, -422.12415509134763, -725.7076016801103, -149.19360308625758, -1121.769392156301, -184.77539428169865, -1025.0132035751317, -793.0161914743587, -495.94020083500556, -881.5465078763223, -1197.1259200273312, -845.2776582343158, -313.889014656542, -537.3489664174818, -691.2320806732766, -754.611811613793, -50.75146239425322, -800.9066345867517, -409.0949256120878, -1018.4659962086606, -313.76562250799793, -729.463183019986, -417.1044867047109, -656.2769522507801, -583.5383419878577, -1489.277288140948, -525.1101636387015, -461.2047309300565, -1029.8384277773214, -622.1796965338922, -409.55802798382285, -733.7570760191873, -604.548571613669, -1189.4266658101292, -911.7646747709133, -733.5928821653554, -993.8701547795932, -981.0525393241968, -769.5429169571117, -263.4953816354341, -172.64913373407342, -379.51746574095296, -349.38997621123286, -589.9789824653302, -702.1109638459358, -851.0566790437205, -907.875470149276, -25.243800002169483, -371.14628365702504, -305.2695154990018, -61.279260290768306, -1279.2488178978, -51.2733552566397, -845.0495626043077, -849.351734210602, -279.80938264523235], "episode_lengths": [150, 150, 79, 150, 150, 150, 92, 150, 102, 91, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 114, 122, 150, 150, 150, 81, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 104, 150, 72, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 61, 150, 117, 150, 101, 150, 150, 150, 150, 150, 134, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 93, 150, 150, 150, 150, 150, 150, 56, 124, 150, 75, 150, 47, 150, 150, 150], "policy_policy_0_reward": [-688.4229687733183, -1128.7438758729159, -128.42099345449284, -754.9107697198824, -758.917532146379, -878.6289166685606, -252.08265147586644, -928.5603838119144, -151.1985100567836, -119.48983507762046, -744.2541615295098, -430.90169808570784, -1241.5139685114368, -660.4212700879797, -1150.4516717114532, -981.9558062334778, -854.2440167160755, -746.5462310885923, -875.4970103602748, -604.6954056879055, -997.7009164374142, -857.2801019899053, -752.0555784656108, -627.7560822636859, -725.2457065176252, -370.676277008802, -895.0034306422309, -215.25281367889195, -346.29448169611413, -714.9974838602831, -978.988252672362, -1059.8474769289255, -146.20137487901744, -893.1492614659772, -775.5988059848472, -814.4591491333119, -384.55140837467127, -960.2675623146666, -855.1324143549803, -1067.4256204849235, -907.4377337277415, -911.7671727091074, -901.2860549014812, -1330.2926220699303, -771.9992958151878, -422.12415509134763, -725.7076016801103, -149.19360308625758, -1121.769392156301, -184.77539428169865, -1025.0132035751317, -793.0161914743587, -495.94020083500556, -881.5465078763223, -1197.1259200273312, -845.2776582343158, -313.889014656542, -537.3489664174818, -691.2320806732766, -754.611811613793, -50.75146239425322, -800.9066345867517, -409.0949256120878, -1018.4659962086606, -313.76562250799793, -729.463183019986, -417.1044867047109, -656.2769522507801, -583.5383419878577, -1489.277288140948, -525.1101636387015, -461.2047309300565, -1029.8384277773214, -622.1796965338922, -409.55802798382285, -733.7570760191873, -604.548571613669, -1189.4266658101292, -911.7646747709133, -733.5928821653554, -993.8701547795932, -981.0525393241968, -769.5429169571117, -263.4953816354341, -172.64913373407342, -379.51746574095296, -349.38997621123286, -589.9789824653302, -702.1109638459358, -851.0566790437205, -907.875470149276, -25.243800002169483, -371.14628365702504, -305.2695154990018, -61.279260290768306, -1279.2488178978, -51.2733552566397, -845.0495626043077, -849.351734210602, -279.80938264523235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520263152366645, "mean_inference_ms": 1.6811738849511104, "mean_action_processing_ms": 0.27902970525606824, "mean_env_wait_ms": 3.002187682682758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0120086669921875, "StateBufferConnector_ms": 0.00805807113647461, "ViewRequirementAgentConnector_ms": 0.19420242309570312}, "num_episodes": 29, "episode_return_max": -25.243800002169483, "episode_return_min": -1489.277288140948, "episode_return_mean": -681.9693364373462, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.43856589541707, "num_env_steps_trained_throughput_per_sec": 302.43856589541707, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12917.304, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12917.228, "sample_time_ms": 1033.663, "learn_time_ms": 11818.822, "learn_throughput": 338.443, "synch_weights_time_ms": 63.894}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00014", "date": "2024-08-03_11-37-50", "timestamp": 1722665270, "time_this_iter_s": 13.239304780960083, "time_total_s": 272.79492568969727, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244437370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 272.79492568969727, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.836842105263157, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.18056412637233, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.841120949635903, "policy_loss": -0.012451922945911065, "vf_loss": 2.8650182099392016, "vf_explained_var": 0.9877886723726987, "kl": 0.017308042630005138, "entropy": 1.6637747305134931, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -25.243800002169483, "episode_reward_min": -1489.277288140948, "episode_reward_mean": -701.2035961304055, "episode_len_mean": 136.64, "episode_media": {}, "episodes_timesteps_total": 13664, "policy_reward_min": {"policy_0": -1489.277288140948}, "policy_reward_max": {"policy_0": -25.243800002169483}, "policy_reward_mean": {"policy_0": -701.2035961304055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-978.988252672362, -1059.8474769289255, -146.20137487901744, -893.1492614659772, -775.5988059848472, -814.4591491333119, -384.55140837467127, -960.2675623146666, -855.1324143549803, -1067.4256204849235, -907.4377337277415, -911.7671727091074, -901.2860549014812, -1330.2926220699303, -771.9992958151878, -422.12415509134763, -725.7076016801103, -149.19360308625758, -1121.769392156301, -184.77539428169865, -1025.0132035751317, -793.0161914743587, -495.94020083500556, -881.5465078763223, -1197.1259200273312, -845.2776582343158, -313.889014656542, -537.3489664174818, -691.2320806732766, -754.611811613793, -50.75146239425322, -800.9066345867517, -409.0949256120878, -1018.4659962086606, -313.76562250799793, -729.463183019986, -417.1044867047109, -656.2769522507801, -583.5383419878577, -1489.277288140948, -525.1101636387015, -461.2047309300565, -1029.8384277773214, -622.1796965338922, -409.55802798382285, -733.7570760191873, -604.548571613669, -1189.4266658101292, -911.7646747709133, -733.5928821653554, -993.8701547795932, -981.0525393241968, -769.5429169571117, -263.4953816354341, -172.64913373407342, -379.51746574095296, -349.38997621123286, -589.9789824653302, -702.1109638459358, -851.0566790437205, -907.875470149276, -25.243800002169483, -371.14628365702504, -305.2695154990018, -61.279260290768306, -1279.2488178978, -51.2733552566397, -845.0495626043077, -849.351734210602, -279.80938264523235, -637.8355075482999, -1345.5928981510701, -764.0396040844747, -1178.93567887457, -1130.1052180017914, -939.6703451072071, -1050.7490582686964, -637.5436679754775, -461.8468427520323, -1038.1510387066176, -92.98827285229895, -1165.2206223797828, -777.471669319753, -1022.8671513116034, -1278.6233769154612, -727.988242866223, -48.46085197600619, -990.7434593980281, -684.7330171993553, -746.4760827164904, -746.1747527998609, -83.96516502736239, -89.16007583775071, -837.8044692498975, -1120.8836659886463, -713.6344967028832, -478.27150680927, -25.724704653082448, -780.8025163615916, -909.0825591010803], "episode_lengths": [150, 150, 81, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 104, 150, 72, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 61, 150, 117, 150, 101, 150, 150, 150, 150, 150, 134, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 93, 150, 150, 150, 150, 150, 150, 56, 124, 150, 75, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 150, 79, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 63, 46, 150, 150, 150, 150, 41, 150, 150], "policy_policy_0_reward": [-978.988252672362, -1059.8474769289255, -146.20137487901744, -893.1492614659772, -775.5988059848472, -814.4591491333119, -384.55140837467127, -960.2675623146666, -855.1324143549803, -1067.4256204849235, -907.4377337277415, -911.7671727091074, -901.2860549014812, -1330.2926220699303, -771.9992958151878, -422.12415509134763, -725.7076016801103, -149.19360308625758, -1121.769392156301, -184.77539428169865, -1025.0132035751317, -793.0161914743587, -495.94020083500556, -881.5465078763223, -1197.1259200273312, -845.2776582343158, -313.889014656542, -537.3489664174818, -691.2320806732766, -754.611811613793, -50.75146239425322, -800.9066345867517, -409.0949256120878, -1018.4659962086606, -313.76562250799793, -729.463183019986, -417.1044867047109, -656.2769522507801, -583.5383419878577, -1489.277288140948, -525.1101636387015, -461.2047309300565, -1029.8384277773214, -622.1796965338922, -409.55802798382285, -733.7570760191873, -604.548571613669, -1189.4266658101292, -911.7646747709133, -733.5928821653554, -993.8701547795932, -981.0525393241968, -769.5429169571117, -263.4953816354341, -172.64913373407342, -379.51746574095296, -349.38997621123286, -589.9789824653302, -702.1109638459358, -851.0566790437205, -907.875470149276, -25.243800002169483, -371.14628365702504, -305.2695154990018, -61.279260290768306, -1279.2488178978, -51.2733552566397, -845.0495626043077, -849.351734210602, -279.80938264523235, -637.8355075482999, -1345.5928981510701, -764.0396040844747, -1178.93567887457, -1130.1052180017914, -939.6703451072071, -1050.7490582686964, -637.5436679754775, -461.8468427520323, -1038.1510387066176, -92.98827285229895, -1165.2206223797828, -777.471669319753, -1022.8671513116034, -1278.6233769154612, -727.988242866223, -48.46085197600619, -990.7434593980281, -684.7330171993553, -746.4760827164904, -746.1747527998609, -83.96516502736239, -89.16007583775071, -837.8044692498975, -1120.8836659886463, -713.6344967028832, -478.27150680927, -25.724704653082448, -780.8025163615916, -909.0825591010803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5517048268357716, "mean_inference_ms": 1.6817284133875248, "mean_action_processing_ms": 0.2790761278437893, "mean_env_wait_ms": 3.004359356732631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012526273727416992, "StateBufferConnector_ms": 0.008004188537597656, "ViewRequirementAgentConnector_ms": 0.19732236862182617}, "num_episodes": 30, "episode_return_max": -25.243800002169483, "episode_return_min": -1489.277288140948, "episode_return_mean": -701.2035961304055, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.9839485485455, "num_env_steps_trained_throughput_per_sec": 308.9839485485455, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12909.576, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12909.501, "sample_time_ms": 1036.682, "learn_time_ms": 11808.084, "learn_throughput": 338.751, "synch_weights_time_ms": 63.89}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00014", "date": "2024-08-03_11-38-03", "timestamp": 1722665283, "time_this_iter_s": 12.957619190216064, "time_total_s": 285.75254487991333, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c1a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 285.75254487991333, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.442105263157895, "ram_util_percent": 27.77894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 146.71710676948229, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.5326232268164555, "policy_loss": -0.00773279976080327, "vf_loss": 2.551998423412442, "vf_explained_var": 0.9823322396725416, "kl": 0.01489816038653468, "entropy": 1.6111841273804506, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -10.350178796909368, "episode_reward_min": -1489.277288140948, "episode_reward_mean": -640.7069737443809, "episode_len_mean": 133.11, "episode_media": {}, "episodes_timesteps_total": 13311, "policy_reward_min": {"policy_0": -1489.277288140948}, "policy_reward_max": {"policy_0": -10.350178796909368}, "policy_reward_mean": {"policy_0": -640.7069737443809}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-800.9066345867517, -409.0949256120878, -1018.4659962086606, -313.76562250799793, -729.463183019986, -417.1044867047109, -656.2769522507801, -583.5383419878577, -1489.277288140948, -525.1101636387015, -461.2047309300565, -1029.8384277773214, -622.1796965338922, -409.55802798382285, -733.7570760191873, -604.548571613669, -1189.4266658101292, -911.7646747709133, -733.5928821653554, -993.8701547795932, -981.0525393241968, -769.5429169571117, -263.4953816354341, -172.64913373407342, -379.51746574095296, -349.38997621123286, -589.9789824653302, -702.1109638459358, -851.0566790437205, -907.875470149276, -25.243800002169483, -371.14628365702504, -305.2695154990018, -61.279260290768306, -1279.2488178978, -51.2733552566397, -845.0495626043077, -849.351734210602, -279.80938264523235, -637.8355075482999, -1345.5928981510701, -764.0396040844747, -1178.93567887457, -1130.1052180017914, -939.6703451072071, -1050.7490582686964, -637.5436679754775, -461.8468427520323, -1038.1510387066176, -92.98827285229895, -1165.2206223797828, -777.471669319753, -1022.8671513116034, -1278.6233769154612, -727.988242866223, -48.46085197600619, -990.7434593980281, -684.7330171993553, -746.4760827164904, -746.1747527998609, -83.96516502736239, -89.16007583775071, -837.8044692498975, -1120.8836659886463, -713.6344967028832, -478.27150680927, -25.724704653082448, -780.8025163615916, -909.0825591010803, -1067.0207309524342, -665.7184130518489, -470.63661007064707, -893.3721953027778, -636.877425642574, -1150.6137613984956, -155.9913432506621, -80.59081777171129, -727.5123699614124, -216.3325796445772, -242.31720884677512, -910.5447708479646, -405.9836432324208, -712.6882632013437, -83.31415646990006, -412.0618397613337, -239.2363488383397, -866.2617993601912, -644.6075030388614, -283.73853223186194, -434.920438533652, -702.0403063514674, -311.1350836742861, -1237.979429842117, -10.350178796909368, -140.16408793640753, -13.855180010821329, -453.71246018407726, -795.9313190096378, -925.4177194985823, -1007.1386145740972], "episode_lengths": [150, 117, 150, 101, 150, 150, 150, 150, 150, 134, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 93, 150, 150, 150, 150, 150, 150, 56, 124, 150, 75, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 150, 79, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 63, 46, 150, 150, 150, 150, 41, 150, 150, 150, 150, 150, 150, 143, 150, 88, 74, 150, 73, 104, 150, 97, 150, 63, 150, 127, 150, 138, 150, 150, 150, 150, 150, 50, 84, 56, 150, 150, 150, 150], "policy_policy_0_reward": [-800.9066345867517, -409.0949256120878, -1018.4659962086606, -313.76562250799793, -729.463183019986, -417.1044867047109, -656.2769522507801, -583.5383419878577, -1489.277288140948, -525.1101636387015, -461.2047309300565, -1029.8384277773214, -622.1796965338922, -409.55802798382285, -733.7570760191873, -604.548571613669, -1189.4266658101292, -911.7646747709133, -733.5928821653554, -993.8701547795932, -981.0525393241968, -769.5429169571117, -263.4953816354341, -172.64913373407342, -379.51746574095296, -349.38997621123286, -589.9789824653302, -702.1109638459358, -851.0566790437205, -907.875470149276, -25.243800002169483, -371.14628365702504, -305.2695154990018, -61.279260290768306, -1279.2488178978, -51.2733552566397, -845.0495626043077, -849.351734210602, -279.80938264523235, -637.8355075482999, -1345.5928981510701, -764.0396040844747, -1178.93567887457, -1130.1052180017914, -939.6703451072071, -1050.7490582686964, -637.5436679754775, -461.8468427520323, -1038.1510387066176, -92.98827285229895, -1165.2206223797828, -777.471669319753, -1022.8671513116034, -1278.6233769154612, -727.988242866223, -48.46085197600619, -990.7434593980281, -684.7330171993553, -746.4760827164904, -746.1747527998609, -83.96516502736239, -89.16007583775071, -837.8044692498975, -1120.8836659886463, -713.6344967028832, -478.27150680927, -25.724704653082448, -780.8025163615916, -909.0825591010803, -1067.0207309524342, -665.7184130518489, -470.63661007064707, -893.3721953027778, -636.877425642574, -1150.6137613984956, -155.9913432506621, -80.59081777171129, -727.5123699614124, -216.3325796445772, -242.31720884677512, -910.5447708479646, -405.9836432324208, -712.6882632013437, -83.31415646990006, -412.0618397613337, -239.2363488383397, -866.2617993601912, -644.6075030388614, -283.73853223186194, -434.920438533652, -702.0403063514674, -311.1350836742861, -1237.979429842117, -10.350178796909368, -140.16408793640753, -13.855180010821329, -453.71246018407726, -795.9313190096378, -925.4177194985823, -1007.1386145740972]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5518536927586463, "mean_inference_ms": 1.6819112035770685, "mean_action_processing_ms": 0.2791362772865393, "mean_env_wait_ms": 3.0066836191084207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012310981750488281, "StateBufferConnector_ms": 0.007991790771484375, "ViewRequirementAgentConnector_ms": 0.19697833061218262}, "num_episodes": 31, "episode_return_max": -10.350178796909368, "episode_return_min": -1489.277288140948, "episode_return_mean": -640.7069737443809, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.72339370137007, "num_env_steps_trained_throughput_per_sec": 305.72339370137007, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12873.817, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12873.74, "sample_time_ms": 1041.127, "learn_time_ms": 11767.023, "learn_throughput": 339.933, "synch_weights_time_ms": 64.742}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00014", "date": "2024-08-03_11-38-17", "timestamp": 1722665297, "time_this_iter_s": 13.098441123962402, "time_total_s": 298.85098600387573, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444904c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 298.85098600387573, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.733333333333334, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 142.13309789001943, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.4085481030245623, "policy_loss": -0.01168114818962446, "vf_loss": 2.4329552326351402, "vf_explained_var": 0.9766114717970292, "kl": 0.01449163925681205, "entropy": 1.7073468666523695, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -10.350178796909368, "episode_reward_min": -1505.5248989236106, "episode_reward_mean": -648.328380903501, "episode_len_mean": 133.02, "episode_media": {}, "episodes_timesteps_total": 13302, "policy_reward_min": {"policy_0": -1505.5248989236106}, "policy_reward_max": {"policy_0": -10.350178796909368}, "policy_reward_mean": {"policy_0": -648.328380903501}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-371.14628365702504, -305.2695154990018, -61.279260290768306, -1279.2488178978, -51.2733552566397, -845.0495626043077, -849.351734210602, -279.80938264523235, -637.8355075482999, -1345.5928981510701, -764.0396040844747, -1178.93567887457, -1130.1052180017914, -939.6703451072071, -1050.7490582686964, -637.5436679754775, -461.8468427520323, -1038.1510387066176, -92.98827285229895, -1165.2206223797828, -777.471669319753, -1022.8671513116034, -1278.6233769154612, -727.988242866223, -48.46085197600619, -990.7434593980281, -684.7330171993553, -746.4760827164904, -746.1747527998609, -83.96516502736239, -89.16007583775071, -837.8044692498975, -1120.8836659886463, -713.6344967028832, -478.27150680927, -25.724704653082448, -780.8025163615916, -909.0825591010803, -1067.0207309524342, -665.7184130518489, -470.63661007064707, -893.3721953027778, -636.877425642574, -1150.6137613984956, -155.9913432506621, -80.59081777171129, -727.5123699614124, -216.3325796445772, -242.31720884677512, -910.5447708479646, -405.9836432324208, -712.6882632013437, -83.31415646990006, -412.0618397613337, -239.2363488383397, -866.2617993601912, -644.6075030388614, -283.73853223186194, -434.920438533652, -702.0403063514674, -311.1350836742861, -1237.979429842117, -10.350178796909368, -140.16408793640753, -13.855180010821329, -453.71246018407726, -795.9313190096378, -925.4177194985823, -1007.1386145740972, -453.95018745704954, -785.4074071788768, -729.5140675299771, -713.0394371756995, -95.82010151805027, -480.1926672769239, -674.715872277582, -944.5113353434282, -109.82952984112207, -1105.2086241770164, -761.6561188958584, -762.7882001264597, -762.4917305412587, -120.76980384830276, -896.7457004887392, -431.207530745252, -1285.7187790497655, -965.4848878164698, -480.4671119457874, -642.81863835071, -1505.5248989236106, -562.1739889663381, -170.1950053646739, -1092.9577153831706, -477.0139716257648, -748.9971919695942, -402.9383514893474, -834.144825310736, -929.2444194133379, -602.8911408567561, -858.3792871762124], "episode_lengths": [124, 150, 75, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 150, 79, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 63, 46, 150, 150, 150, 150, 41, 150, 150, 150, 150, 150, 150, 143, 150, 88, 74, 150, 73, 104, 150, 97, 150, 63, 150, 127, 150, 138, 150, 150, 150, 150, 150, 50, 84, 56, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 62, 150, 147, 150, 150, 83, 150, 112, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 144, 150, 150, 150, 150], "policy_policy_0_reward": [-371.14628365702504, -305.2695154990018, -61.279260290768306, -1279.2488178978, -51.2733552566397, -845.0495626043077, -849.351734210602, -279.80938264523235, -637.8355075482999, -1345.5928981510701, -764.0396040844747, -1178.93567887457, -1130.1052180017914, -939.6703451072071, -1050.7490582686964, -637.5436679754775, -461.8468427520323, -1038.1510387066176, -92.98827285229895, -1165.2206223797828, -777.471669319753, -1022.8671513116034, -1278.6233769154612, -727.988242866223, -48.46085197600619, -990.7434593980281, -684.7330171993553, -746.4760827164904, -746.1747527998609, -83.96516502736239, -89.16007583775071, -837.8044692498975, -1120.8836659886463, -713.6344967028832, -478.27150680927, -25.724704653082448, -780.8025163615916, -909.0825591010803, -1067.0207309524342, -665.7184130518489, -470.63661007064707, -893.3721953027778, -636.877425642574, -1150.6137613984956, -155.9913432506621, -80.59081777171129, -727.5123699614124, -216.3325796445772, -242.31720884677512, -910.5447708479646, -405.9836432324208, -712.6882632013437, -83.31415646990006, -412.0618397613337, -239.2363488383397, -866.2617993601912, -644.6075030388614, -283.73853223186194, -434.920438533652, -702.0403063514674, -311.1350836742861, -1237.979429842117, -10.350178796909368, -140.16408793640753, -13.855180010821329, -453.71246018407726, -795.9313190096378, -925.4177194985823, -1007.1386145740972, -453.95018745704954, -785.4074071788768, -729.5140675299771, -713.0394371756995, -95.82010151805027, -480.1926672769239, -674.715872277582, -944.5113353434282, -109.82952984112207, -1105.2086241770164, -761.6561188958584, -762.7882001264597, -762.4917305412587, -120.76980384830276, -896.7457004887392, -431.207530745252, -1285.7187790497655, -965.4848878164698, -480.4671119457874, -642.81863835071, -1505.5248989236106, -562.1739889663381, -170.1950053646739, -1092.9577153831706, -477.0139716257648, -748.9971919695942, -402.9383514893474, -834.144825310736, -929.2444194133379, -602.8911408567561, -858.3792871762124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5515049285991002, "mean_inference_ms": 1.68107019283877, "mean_action_processing_ms": 0.27886013348257377, "mean_env_wait_ms": 3.0088809599136135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012450456619262695, "StateBufferConnector_ms": 0.007905244827270508, "ViewRequirementAgentConnector_ms": 0.19501996040344238}, "num_episodes": 31, "episode_return_max": -10.350178796909368, "episode_return_min": -1505.5248989236106, "episode_return_mean": -648.328380903501, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.8497734525968, "num_env_steps_trained_throughput_per_sec": 294.8497734525968, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12945.229, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12945.15, "sample_time_ms": 1046.415, "learn_time_ms": 11835.346, "learn_throughput": 337.971, "synch_weights_time_ms": 62.54}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00014", "date": "2024-08-03_11-38-30", "timestamp": 1722665310, "time_this_iter_s": 13.580764770507812, "time_total_s": 312.43175077438354, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b4550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 312.43175077438354, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.670000000000002, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 119.32870559692383, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.5706072700520357, "policy_loss": -0.009258025707579994, "vf_loss": 2.590168932576974, "vf_explained_var": 0.9792246645937364, "kl": 0.018921262544366376, "entropy": 1.5980018547425667, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -0.0059908091621052595, "episode_reward_min": -1505.5248989236106, "episode_reward_mean": -613.4634822922459, "episode_len_mean": 131.24, "episode_media": {}, "episodes_timesteps_total": 13124, "policy_reward_min": {"policy_0": -1505.5248989236106}, "policy_reward_max": {"policy_0": -0.0059908091621052595}, "policy_reward_mean": {"policy_0": -613.4634822922459}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-837.8044692498975, -1120.8836659886463, -713.6344967028832, -478.27150680927, -25.724704653082448, -780.8025163615916, -909.0825591010803, -1067.0207309524342, -665.7184130518489, -470.63661007064707, -893.3721953027778, -636.877425642574, -1150.6137613984956, -155.9913432506621, -80.59081777171129, -727.5123699614124, -216.3325796445772, -242.31720884677512, -910.5447708479646, -405.9836432324208, -712.6882632013437, -83.31415646990006, -412.0618397613337, -239.2363488383397, -866.2617993601912, -644.6075030388614, -283.73853223186194, -434.920438533652, -702.0403063514674, -311.1350836742861, -1237.979429842117, -10.350178796909368, -140.16408793640753, -13.855180010821329, -453.71246018407726, -795.9313190096378, -925.4177194985823, -1007.1386145740972, -453.95018745704954, -785.4074071788768, -729.5140675299771, -713.0394371756995, -95.82010151805027, -480.1926672769239, -674.715872277582, -944.5113353434282, -109.82952984112207, -1105.2086241770164, -761.6561188958584, -762.7882001264597, -762.4917305412587, -120.76980384830276, -896.7457004887392, -431.207530745252, -1285.7187790497655, -965.4848878164698, -480.4671119457874, -642.81863835071, -1505.5248989236106, -562.1739889663381, -170.1950053646739, -1092.9577153831706, -477.0139716257648, -748.9971919695942, -402.9383514893474, -834.144825310736, -929.2444194133379, -602.8911408567561, -858.3792871762124, -1026.1892452173188, -411.03870412501516, -1054.1740081064365, -832.2983256646258, -768.669857414123, -1205.9723473758497, -613.6296619504993, -40.391862018706476, -139.16021636388834, -1335.5146396021787, -372.97422630776373, -1088.1415820789898, -68.21168298957069, -917.302995191881, -446.52302544551696, -699.3901851097535, -287.7183910912578, -300.0935734790232, -1244.588441341372, -473.43386380688753, -189.01667430904885, -495.188688751915, -327.2142162981191, -38.32811136904962, -0.0059908091621052595, -682.8827771901764, -434.3241111655829, -674.1742830891953, -595.4424588163874, -738.8963059468454, -694.3901985799339], "episode_lengths": [150, 150, 150, 150, 41, 150, 150, 150, 150, 150, 150, 143, 150, 88, 74, 150, 73, 104, 150, 97, 150, 63, 150, 127, 150, 138, 150, 150, 150, 150, 150, 50, 84, 56, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 62, 150, 147, 150, 150, 83, 150, 112, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 61, 150, 150, 150, 73, 150, 113, 150, 108, 125, 150, 150, 66, 150, 84, 52, 43, 150, 150, 150, 150, 150, 142], "policy_policy_0_reward": [-837.8044692498975, -1120.8836659886463, -713.6344967028832, -478.27150680927, -25.724704653082448, -780.8025163615916, -909.0825591010803, -1067.0207309524342, -665.7184130518489, -470.63661007064707, -893.3721953027778, -636.877425642574, -1150.6137613984956, -155.9913432506621, -80.59081777171129, -727.5123699614124, -216.3325796445772, -242.31720884677512, -910.5447708479646, -405.9836432324208, -712.6882632013437, -83.31415646990006, -412.0618397613337, -239.2363488383397, -866.2617993601912, -644.6075030388614, -283.73853223186194, -434.920438533652, -702.0403063514674, -311.1350836742861, -1237.979429842117, -10.350178796909368, -140.16408793640753, -13.855180010821329, -453.71246018407726, -795.9313190096378, -925.4177194985823, -1007.1386145740972, -453.95018745704954, -785.4074071788768, -729.5140675299771, -713.0394371756995, -95.82010151805027, -480.1926672769239, -674.715872277582, -944.5113353434282, -109.82952984112207, -1105.2086241770164, -761.6561188958584, -762.7882001264597, -762.4917305412587, -120.76980384830276, -896.7457004887392, -431.207530745252, -1285.7187790497655, -965.4848878164698, -480.4671119457874, -642.81863835071, -1505.5248989236106, -562.1739889663381, -170.1950053646739, -1092.9577153831706, -477.0139716257648, -748.9971919695942, -402.9383514893474, -834.144825310736, -929.2444194133379, -602.8911408567561, -858.3792871762124, -1026.1892452173188, -411.03870412501516, -1054.1740081064365, -832.2983256646258, -768.669857414123, -1205.9723473758497, -613.6296619504993, -40.391862018706476, -139.16021636388834, -1335.5146396021787, -372.97422630776373, -1088.1415820789898, -68.21168298957069, -917.302995191881, -446.52302544551696, -699.3901851097535, -287.7183910912578, -300.0935734790232, -1244.588441341372, -473.43386380688753, -189.01667430904885, -495.188688751915, -327.2142162981191, -38.32811136904962, -0.0059908091621052595, -682.8827771901764, -434.3241111655829, -674.1742830891953, -595.4424588163874, -738.8963059468454, -694.3901985799339]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5511387959636043, "mean_inference_ms": 1.6806975618555804, "mean_action_processing_ms": 0.2787729795986477, "mean_env_wait_ms": 3.008470715174335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012026309967041016, "StateBufferConnector_ms": 0.007827043533325195, "ViewRequirementAgentConnector_ms": 0.1916050910949707}, "num_episodes": 31, "episode_return_max": -0.0059908091621052595, "episode_return_min": -1505.5248989236106, "episode_return_mean": -613.4634822922459, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.09744052930375, "num_env_steps_trained_throughput_per_sec": 300.09744052930375, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12952.022, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12951.941, "sample_time_ms": 1042.285, "learn_time_ms": 11846.17, "learn_throughput": 337.662, "synch_weights_time_ms": 62.645}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00014", "date": "2024-08-03_11-38-44", "timestamp": 1722665324, "time_this_iter_s": 13.342083215713501, "time_total_s": 325.77383399009705, "pid": 528904, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244491750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 325.77383399009705, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.715789473684211, "ram_util_percent": 27.8}}
