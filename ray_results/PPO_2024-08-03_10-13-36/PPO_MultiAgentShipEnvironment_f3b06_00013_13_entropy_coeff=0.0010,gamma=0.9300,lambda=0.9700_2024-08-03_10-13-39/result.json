{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2820377154275775, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.26231617728869, "policy_loss": -0.010029191655727724, "vf_loss": 9.27153715590636, "vf_explained_var": -0.009112253847221533, "kl": 0.011232632995461244, "entropy": 1.4382928031186262, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": 0.6560563380681513, "episode_reward_min": -1132.9898328866684, "episode_reward_mean": -567.9428608579832, "episode_len_mean": 119.44, "episode_media": {}, "episodes_timesteps_total": 2986, "policy_reward_min": {"policy_0": -1132.9898328866684}, "policy_reward_max": {"policy_0": 0.6560563380681513}, "policy_reward_mean": {"policy_0": -567.9428608579832}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.31373210197957, -118.48127606867857, -530.4261415872161, -1047.7409942501558, -141.024734557366, -20.98934486013118, -770.4408999402747, -989.673162180062, -224.53066602038652, -838.6087695874531, 0.6560563380681513, -163.10218205097723, -710.227054368799, -1132.9898328866684, -817.4443287023589, -367.57710314260675, -973.2235818374943, -872.7192663923241, -962.7401988606455, -1011.486766977589, -32.40245935156718, -49.671345688548726, -582.7611108260144, -834.6698855052128, -927.9827400431393], "episode_lengths": [74, 80, 150, 150, 62, 53, 150, 150, 119, 150, 38, 64, 150, 150, 150, 150, 150, 150, 150, 150, 50, 46, 150, 150, 150], "policy_policy_0_reward": [-78.31373210197957, -118.48127606867857, -530.4261415872161, -1047.7409942501558, -141.024734557366, -20.98934486013118, -770.4408999402747, -989.673162180062, -224.53066602038652, -838.6087695874531, 0.6560563380681513, -163.10218205097723, -710.227054368799, -1132.9898328866684, -817.4443287023589, -367.57710314260675, -973.2235818374943, -872.7192663923241, -962.7401988606455, -1011.486766977589, -32.40245935156718, -49.671345688548726, -582.7611108260144, -834.6698855052128, -927.9827400431393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5587508481907336, "mean_inference_ms": 1.6556189973953324, "mean_action_processing_ms": 0.28061128124619156, "mean_env_wait_ms": 2.9536351606372153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012126922607421875, "StateBufferConnector_ms": 0.008498191833496094, "ViewRequirementAgentConnector_ms": 0.1817760467529297}, "num_episodes": 25, "episode_return_max": 0.6560563380681513, "episode_return_min": -1132.9898328866684, "episode_return_mean": -567.9428608579832, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.3942750448106, "num_env_steps_trained_throughput_per_sec": 301.3942750448106, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13271.663, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13271.597, "sample_time_ms": 1036.477, "learn_time_ms": 12167.399, "learn_throughput": 328.747, "synch_weights_time_ms": 66.911}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00013", "date": "2024-08-03_11-27-52", "timestamp": 1722664672, "time_this_iter_s": 13.283843517303467, "time_total_s": 13.283843517303467, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445241f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.283843517303467, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 13.442105263157895, "ram_util_percent": 27.615789473684213}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1681183774024246, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.216078730424245, "policy_loss": -0.008679294145743673, "vf_loss": 9.22405509551366, "vf_explained_var": 0.11085367649793625, "kl": 0.011217916507121117, "entropy": 1.540662636483709, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": 0.6560563380681513, "episode_reward_min": -1268.291303667802, "episode_reward_mean": -617.0384472668728, "episode_len_mean": 126.07843137254902, "episode_media": {}, "episodes_timesteps_total": 6430, "policy_reward_min": {"policy_0": -1268.291303667802}, "policy_reward_max": {"policy_0": 0.6560563380681513}, "policy_reward_mean": {"policy_0": -617.0384472668728}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.31373210197957, -118.48127606867857, -530.4261415872161, -1047.7409942501558, -141.024734557366, -20.98934486013118, -770.4408999402747, -989.673162180062, -224.53066602038652, -838.6087695874531, 0.6560563380681513, -163.10218205097723, -710.227054368799, -1132.9898328866684, -817.4443287023589, -367.57710314260675, -973.2235818374943, -872.7192663923241, -962.7401988606455, -1011.486766977589, -32.40245935156718, -49.671345688548726, -582.7611108260144, -834.6698855052128, -927.9827400431393, -764.8242801724477, -497.30021372946345, -783.5173768651085, -834.0108593871445, -413.4935905470872, -793.7980129638852, -64.04702300534754, -152.0408839591358, -493.0132132488681, -1268.291303667802, -1023.4958072734914, -106.67269693321222, -1032.7413079165028, -469.9807548340273, -1256.5756007721855, -989.2095150058874, -782.5867011555894, -770.508050007382, -569.1602269971589, -600.0073483464034, -933.1891076422984, -860.7729632867513, -914.0898147610972, -20.270151618855063, -787.3882908381256, -89.40419422568172], "episode_lengths": [74, 80, 150, 150, 62, 53, 150, 150, 119, 150, 38, 64, 150, 150, 150, 150, 150, 150, 150, 150, 50, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 62, 128, 150, 150, 82, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 58], "policy_policy_0_reward": [-78.31373210197957, -118.48127606867857, -530.4261415872161, -1047.7409942501558, -141.024734557366, -20.98934486013118, -770.4408999402747, -989.673162180062, -224.53066602038652, -838.6087695874531, 0.6560563380681513, -163.10218205097723, -710.227054368799, -1132.9898328866684, -817.4443287023589, -367.57710314260675, -973.2235818374943, -872.7192663923241, -962.7401988606455, -1011.486766977589, -32.40245935156718, -49.671345688548726, -582.7611108260144, -834.6698855052128, -927.9827400431393, -764.8242801724477, -497.30021372946345, -783.5173768651085, -834.0108593871445, -413.4935905470872, -793.7980129638852, -64.04702300534754, -152.0408839591358, -493.0132132488681, -1268.291303667802, -1023.4958072734914, -106.67269693321222, -1032.7413079165028, -469.9807548340273, -1256.5756007721855, -989.2095150058874, -782.5867011555894, -770.508050007382, -569.1602269971589, -600.0073483464034, -933.1891076422984, -860.7729632867513, -914.0898147610972, -20.270151618855063, -787.3882908381256, -89.40419422568172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5583308685777221, "mean_inference_ms": 1.6662257296439293, "mean_action_processing_ms": 0.2815516874717239, "mean_env_wait_ms": 2.965815950100202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01428080540077359, "StateBufferConnector_ms": 0.008550344728956036, "ViewRequirementAgentConnector_ms": 0.18616704379811005}, "num_episodes": 26, "episode_return_max": 0.6560563380681513, "episode_return_min": -1268.291303667802, "episode_return_mean": -617.0384472668728, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.85237684132187, "num_env_steps_trained_throughput_per_sec": 307.85237684132187, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13132.46, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13132.381, "sample_time_ms": 1031.074, "learn_time_ms": 12032.363, "learn_throughput": 332.437, "synch_weights_time_ms": 68.127}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00013", "date": "2024-08-03_11-28-05", "timestamp": 1722664685, "time_this_iter_s": 13.005972862243652, "time_total_s": 26.28981637954712, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244525fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.28981637954712, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.9, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.375355996191502, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.982785589993, "policy_loss": -0.005279978441346127, "vf_loss": 8.987777544061343, "vf_explained_var": 0.3219587249681354, "kl": 0.009301278416789202, "entropy": 1.5722211122512817, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": 0.6560563380681513, "episode_reward_min": -1268.291303667802, "episode_reward_mean": -632.005742342369, "episode_len_mean": 128.6951219512195, "episode_media": {}, "episodes_timesteps_total": 10553, "policy_reward_min": {"policy_0": -1268.291303667802}, "policy_reward_max": {"policy_0": 0.6560563380681513}, "policy_reward_mean": {"policy_0": -632.005742342369}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.31373210197957, -118.48127606867857, -530.4261415872161, -1047.7409942501558, -141.024734557366, -20.98934486013118, -770.4408999402747, -989.673162180062, -224.53066602038652, -838.6087695874531, 0.6560563380681513, -163.10218205097723, -710.227054368799, -1132.9898328866684, -817.4443287023589, -367.57710314260675, -973.2235818374943, -872.7192663923241, -962.7401988606455, -1011.486766977589, -32.40245935156718, -49.671345688548726, -582.7611108260144, -834.6698855052128, -927.9827400431393, -764.8242801724477, -497.30021372946345, -783.5173768651085, -834.0108593871445, -413.4935905470872, -793.7980129638852, -64.04702300534754, -152.0408839591358, -493.0132132488681, -1268.291303667802, -1023.4958072734914, -106.67269693321222, -1032.7413079165028, -469.9807548340273, -1256.5756007721855, -989.2095150058874, -782.5867011555894, -770.508050007382, -569.1602269971589, -600.0073483464034, -933.1891076422984, -860.7729632867513, -914.0898147610972, -20.270151618855063, -787.3882908381256, -89.40419422568172, -817.5840604669487, -775.2134139463162, -68.84046002868624, -58.62633156002832, -323.4474673897803, -1235.2619617511914, -898.2785542954903, -1198.971479995589, -131.85453280068788, -580.0211034710447, -604.9798407977877, -887.1512712214953, -962.5485858150369, -929.3816667789365, -804.8955989178742, -481.5697799160328, -1159.785258089237, -979.0069138960548, -105.21881807021437, -814.0022584266321, -151.32552279771213, -424.020144421691, -876.2523544377858, -608.2391655347102, -1070.4018923614362, -273.14658403815355, -240.58185575035108, -234.78578311283653, -830.1012156759441, -1071.078394185203, -758.937791512848], "episode_lengths": [74, 80, 150, 150, 62, 53, 150, 150, 119, 150, 38, 64, 150, 150, 150, 150, 150, 150, 150, 150, 50, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 62, 128, 150, 150, 82, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 58, 150, 150, 61, 60, 89, 150, 150, 150, 96, 131, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 109, 150, 150, 150, 150, 150, 99, 120, 150, 150, 150], "policy_policy_0_reward": [-78.31373210197957, -118.48127606867857, -530.4261415872161, -1047.7409942501558, -141.024734557366, -20.98934486013118, -770.4408999402747, -989.673162180062, -224.53066602038652, -838.6087695874531, 0.6560563380681513, -163.10218205097723, -710.227054368799, -1132.9898328866684, -817.4443287023589, -367.57710314260675, -973.2235818374943, -872.7192663923241, -962.7401988606455, -1011.486766977589, -32.40245935156718, -49.671345688548726, -582.7611108260144, -834.6698855052128, -927.9827400431393, -764.8242801724477, -497.30021372946345, -783.5173768651085, -834.0108593871445, -413.4935905470872, -793.7980129638852, -64.04702300534754, -152.0408839591358, -493.0132132488681, -1268.291303667802, -1023.4958072734914, -106.67269693321222, -1032.7413079165028, -469.9807548340273, -1256.5756007721855, -989.2095150058874, -782.5867011555894, -770.508050007382, -569.1602269971589, -600.0073483464034, -933.1891076422984, -860.7729632867513, -914.0898147610972, -20.270151618855063, -787.3882908381256, -89.40419422568172, -817.5840604669487, -775.2134139463162, -68.84046002868624, -58.62633156002832, -323.4474673897803, -1235.2619617511914, -898.2785542954903, -1198.971479995589, -131.85453280068788, -580.0211034710447, -604.9798407977877, -887.1512712214953, -962.5485858150369, -929.3816667789365, -804.8955989178742, -481.5697799160328, -1159.785258089237, -979.0069138960548, -105.21881807021437, -814.0022584266321, -151.32552279771213, -424.020144421691, -876.2523544377858, -608.2391655347102, -1070.4018923614362, -273.14658403815355, -240.58185575035108, -234.78578311283653, -830.1012156759441, -1071.078394185203, -758.937791512848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5616362676072334, "mean_inference_ms": 1.6809011460755747, "mean_action_processing_ms": 0.28326767745391085, "mean_env_wait_ms": 2.9838267213141996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013875089040616663, "StateBufferConnector_ms": 0.009189000943811929, "ViewRequirementAgentConnector_ms": 0.1947786749863043}, "num_episodes": 31, "episode_return_max": 0.6560563380681513, "episode_return_min": -1268.291303667802, "episode_return_mean": -632.005742342369, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.4316099264965, "num_env_steps_trained_throughput_per_sec": 300.4316099264965, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13193.039, "restore_workers_time_ms": 0.038, "training_step_time_ms": 13192.952, "sample_time_ms": 1045.65, "learn_time_ms": 12079.825, "learn_throughput": 331.131, "synch_weights_time_ms": 66.684}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00013", "date": "2024-08-03_11-28-18", "timestamp": 1722664698, "time_this_iter_s": 13.327411413192749, "time_total_s": 39.61722779273987, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244526560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.61722779273987, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 14.22105263157895, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.260237015845875, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.7956622377038, "policy_loss": -0.013532848106115125, "vf_loss": 8.807191582024098, "vf_explained_var": 0.19250157413383326, "kl": 0.01814217056398775, "entropy": 1.6249299738556147, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 0.6560563380681513, "episode_reward_min": -1268.291303667802, "episode_reward_mean": -682.2815084034198, "episode_len_mean": 132.87, "episode_media": {}, "episodes_timesteps_total": 13287, "policy_reward_min": {"policy_0": -1268.291303667802}, "policy_reward_max": {"policy_0": 0.6560563380681513}, "policy_reward_mean": {"policy_0": -682.2815084034198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-224.53066602038652, -838.6087695874531, 0.6560563380681513, -163.10218205097723, -710.227054368799, -1132.9898328866684, -817.4443287023589, -367.57710314260675, -973.2235818374943, -872.7192663923241, -962.7401988606455, -1011.486766977589, -32.40245935156718, -49.671345688548726, -582.7611108260144, -834.6698855052128, -927.9827400431393, -764.8242801724477, -497.30021372946345, -783.5173768651085, -834.0108593871445, -413.4935905470872, -793.7980129638852, -64.04702300534754, -152.0408839591358, -493.0132132488681, -1268.291303667802, -1023.4958072734914, -106.67269693321222, -1032.7413079165028, -469.9807548340273, -1256.5756007721855, -989.2095150058874, -782.5867011555894, -770.508050007382, -569.1602269971589, -600.0073483464034, -933.1891076422984, -860.7729632867513, -914.0898147610972, -20.270151618855063, -787.3882908381256, -89.40419422568172, -817.5840604669487, -775.2134139463162, -68.84046002868624, -58.62633156002832, -323.4474673897803, -1235.2619617511914, -898.2785542954903, -1198.971479995589, -131.85453280068788, -580.0211034710447, -604.9798407977877, -887.1512712214953, -962.5485858150369, -929.3816667789365, -804.8955989178742, -481.5697799160328, -1159.785258089237, -979.0069138960548, -105.21881807021437, -814.0022584266321, -151.32552279771213, -424.020144421691, -876.2523544377858, -608.2391655347102, -1070.4018923614362, -273.14658403815355, -240.58185575035108, -234.78578311283653, -830.1012156759441, -1071.078394185203, -758.937791512848, -963.6462227030203, -451.26553096474953, -93.69168289981482, -917.4287342686837, -698.7780972551931, -1148.296993673829, -1195.5497131618993, -778.6181260420343, -1027.1535352029548, -898.1386068200313, -696.9268428856844, -639.8610541227166, -668.7514685946885, -676.8985138077735, -302.25250572779703, -1134.620545138266, -1193.8246672834205, -992.0519507533465, -237.64618567263008, -986.3606342249348, -76.81537369061134, -1084.6965634509763, -713.9327630237811, -769.2498083618123, -823.1531640483022, -931.1609700346469], "episode_lengths": [119, 150, 38, 64, 150, 150, 150, 150, 150, 150, 150, 150, 50, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 62, 128, 150, 150, 82, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 58, 150, 150, 61, 60, 89, 150, 150, 150, 96, 131, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 109, 150, 150, 150, 150, 150, 99, 120, 150, 150, 150, 150, 118, 74, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 72, 150, 47, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-224.53066602038652, -838.6087695874531, 0.6560563380681513, -163.10218205097723, -710.227054368799, -1132.9898328866684, -817.4443287023589, -367.57710314260675, -973.2235818374943, -872.7192663923241, -962.7401988606455, -1011.486766977589, -32.40245935156718, -49.671345688548726, -582.7611108260144, -834.6698855052128, -927.9827400431393, -764.8242801724477, -497.30021372946345, -783.5173768651085, -834.0108593871445, -413.4935905470872, -793.7980129638852, -64.04702300534754, -152.0408839591358, -493.0132132488681, -1268.291303667802, -1023.4958072734914, -106.67269693321222, -1032.7413079165028, -469.9807548340273, -1256.5756007721855, -989.2095150058874, -782.5867011555894, -770.508050007382, -569.1602269971589, -600.0073483464034, -933.1891076422984, -860.7729632867513, -914.0898147610972, -20.270151618855063, -787.3882908381256, -89.40419422568172, -817.5840604669487, -775.2134139463162, -68.84046002868624, -58.62633156002832, -323.4474673897803, -1235.2619617511914, -898.2785542954903, -1198.971479995589, -131.85453280068788, -580.0211034710447, -604.9798407977877, -887.1512712214953, -962.5485858150369, -929.3816667789365, -804.8955989178742, -481.5697799160328, -1159.785258089237, -979.0069138960548, -105.21881807021437, -814.0022584266321, -151.32552279771213, -424.020144421691, -876.2523544377858, -608.2391655347102, -1070.4018923614362, -273.14658403815355, -240.58185575035108, -234.78578311283653, -830.1012156759441, -1071.078394185203, -758.937791512848, -963.6462227030203, -451.26553096474953, -93.69168289981482, -917.4287342686837, -698.7780972551931, -1148.296993673829, -1195.5497131618993, -778.6181260420343, -1027.1535352029548, -898.1386068200313, -696.9268428856844, -639.8610541227166, -668.7514685946885, -676.8985138077735, -302.25250572779703, -1134.620545138266, -1193.8246672834205, -992.0519507533465, -237.64618567263008, -986.3606342249348, -76.81537369061134, -1084.6965634509763, -713.9327630237811, -769.2498083618123, -823.1531640483022, -931.1609700346469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5618447945138634, "mean_inference_ms": 1.6917262051021362, "mean_action_processing_ms": 0.28450278650338573, "mean_env_wait_ms": 3.001456439753014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014161825180053711, "StateBufferConnector_ms": 0.009026288986206055, "ViewRequirementAgentConnector_ms": 0.19481730461120605}, "num_episodes": 26, "episode_return_max": 0.6560563380681513, "episode_return_min": -1268.291303667802, "episode_return_mean": -682.2815084034198, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.1957072492759, "num_env_steps_trained_throughput_per_sec": 298.1957072492759, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13248.286, "restore_workers_time_ms": 0.04, "training_step_time_ms": 13248.196, "sample_time_ms": 1043.656, "learn_time_ms": 12132.239, "learn_throughput": 329.7, "synch_weights_time_ms": 71.499}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00013", "date": "2024-08-03_11-28-32", "timestamp": 1722664712, "time_this_iter_s": 13.42700743675232, "time_total_s": 53.04423522949219, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c15a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 53.04423522949219, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.826315789473684, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.84403201987346, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.298203086853027, "policy_loss": -0.011582344876175436, "vf_loss": 7.3077945679426195, "vf_explained_var": 0.47112766162802777, "kl": 0.01798759540607383, "entropy": 1.6066478059937557, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -20.270151618855063, "episode_reward_min": -1256.5756007721855, "episode_reward_mean": -716.5868191603264, "episode_len_mean": 136.37, "episode_media": {}, "episodes_timesteps_total": 13637, "policy_reward_min": {"policy_0": -1256.5756007721855}, "policy_reward_max": {"policy_0": -20.270151618855063}, "policy_reward_mean": {"policy_0": -716.5868191603264}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1032.7413079165028, -469.9807548340273, -1256.5756007721855, -989.2095150058874, -782.5867011555894, -770.508050007382, -569.1602269971589, -600.0073483464034, -933.1891076422984, -860.7729632867513, -914.0898147610972, -20.270151618855063, -787.3882908381256, -89.40419422568172, -817.5840604669487, -775.2134139463162, -68.84046002868624, -58.62633156002832, -323.4474673897803, -1235.2619617511914, -898.2785542954903, -1198.971479995589, -131.85453280068788, -580.0211034710447, -604.9798407977877, -887.1512712214953, -962.5485858150369, -929.3816667789365, -804.8955989178742, -481.5697799160328, -1159.785258089237, -979.0069138960548, -105.21881807021437, -814.0022584266321, -151.32552279771213, -424.020144421691, -876.2523544377858, -608.2391655347102, -1070.4018923614362, -273.14658403815355, -240.58185575035108, -234.78578311283653, -830.1012156759441, -1071.078394185203, -758.937791512848, -963.6462227030203, -451.26553096474953, -93.69168289981482, -917.4287342686837, -698.7780972551931, -1148.296993673829, -1195.5497131618993, -778.6181260420343, -1027.1535352029548, -898.1386068200313, -696.9268428856844, -639.8610541227166, -668.7514685946885, -676.8985138077735, -302.25250572779703, -1134.620545138266, -1193.8246672834205, -992.0519507533465, -237.64618567263008, -986.3606342249348, -76.81537369061134, -1084.6965634509763, -713.9327630237811, -769.2498083618123, -823.1531640483022, -931.1609700346469, -1121.4778390535384, -721.7415017832384, -961.216344530692, -247.22627763513253, -1102.8279200841566, -609.721320843072, -799.2244021048257, -901.5436723846719, -143.4710071279425, -871.0691910941471, -217.8314134190302, -716.1293901192732, -707.7153372906297, -947.4724813120723, -919.0668144504418, -385.64810375166405, -25.202317930444117, -654.7514758808213, -505.1459557893678, -972.9430171294421, -716.1678306278212, -801.4531011076184, -1033.9086995023977, -826.2122073504469, -486.84262417895934, -761.4026571243753, -1100.6506686398695, -881.1427778248644, -987.3112232764079], "episode_lengths": [150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 58, 150, 150, 61, 60, 89, 150, 150, 150, 96, 131, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 109, 150, 150, 150, 150, 150, 99, 120, 150, 150, 150, 150, 118, 74, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 72, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 89, 150, 77, 140, 150, 150, 150, 115, 53, 150, 147, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1032.7413079165028, -469.9807548340273, -1256.5756007721855, -989.2095150058874, -782.5867011555894, -770.508050007382, -569.1602269971589, -600.0073483464034, -933.1891076422984, -860.7729632867513, -914.0898147610972, -20.270151618855063, -787.3882908381256, -89.40419422568172, -817.5840604669487, -775.2134139463162, -68.84046002868624, -58.62633156002832, -323.4474673897803, -1235.2619617511914, -898.2785542954903, -1198.971479995589, -131.85453280068788, -580.0211034710447, -604.9798407977877, -887.1512712214953, -962.5485858150369, -929.3816667789365, -804.8955989178742, -481.5697799160328, -1159.785258089237, -979.0069138960548, -105.21881807021437, -814.0022584266321, -151.32552279771213, -424.020144421691, -876.2523544377858, -608.2391655347102, -1070.4018923614362, -273.14658403815355, -240.58185575035108, -234.78578311283653, -830.1012156759441, -1071.078394185203, -758.937791512848, -963.6462227030203, -451.26553096474953, -93.69168289981482, -917.4287342686837, -698.7780972551931, -1148.296993673829, -1195.5497131618993, -778.6181260420343, -1027.1535352029548, -898.1386068200313, -696.9268428856844, -639.8610541227166, -668.7514685946885, -676.8985138077735, -302.25250572779703, -1134.620545138266, -1193.8246672834205, -992.0519507533465, -237.64618567263008, -986.3606342249348, -76.81537369061134, -1084.6965634509763, -713.9327630237811, -769.2498083618123, -823.1531640483022, -931.1609700346469, -1121.4778390535384, -721.7415017832384, -961.216344530692, -247.22627763513253, -1102.8279200841566, -609.721320843072, -799.2244021048257, -901.5436723846719, -143.4710071279425, -871.0691910941471, -217.8314134190302, -716.1293901192732, -707.7153372906297, -947.4724813120723, -919.0668144504418, -385.64810375166405, -25.202317930444117, -654.7514758808213, -505.1459557893678, -972.9430171294421, -716.1678306278212, -801.4531011076184, -1033.9086995023977, -826.2122073504469, -486.84262417895934, -761.4026571243753, -1100.6506686398695, -881.1427778248644, -987.3112232764079]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5634365737783731, "mean_inference_ms": 1.7050271439932636, "mean_action_processing_ms": 0.28622572841438454, "mean_env_wait_ms": 3.019472577806023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014080286026000977, "StateBufferConnector_ms": 0.00910639762878418, "ViewRequirementAgentConnector_ms": 0.19831585884094238}, "num_episodes": 29, "episode_return_max": -20.270151618855063, "episode_return_min": -1256.5756007721855, "episode_return_mean": -716.5868191603264, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.01993930184506, "num_env_steps_trained_throughput_per_sec": 315.01993930184506, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13138.155, "restore_workers_time_ms": 0.041, "training_step_time_ms": 13138.062, "sample_time_ms": 1046.396, "learn_time_ms": 12022.773, "learn_throughput": 332.702, "synch_weights_time_ms": 68.103}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00013", "date": "2024-08-03_11-28-45", "timestamp": 1722664725, "time_this_iter_s": 12.709412097930908, "time_total_s": 65.7536473274231, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245762b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 65.7536473274231, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 14.566666666666666, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.087042521437006, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.511239490906397, "policy_loss": -0.01371154184404683, "vf_loss": 6.522617111603419, "vf_explained_var": 0.7754067623987794, "kl": 0.01989419467220917, "entropy": 1.644916338970264, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -12.682971633056864, "episode_reward_min": -1357.1782579565217, "episode_reward_mean": -728.4062587188527, "episode_len_mean": 136.64, "episode_media": {}, "episodes_timesteps_total": 13664, "policy_reward_min": {"policy_0": -1357.1782579565217}, "policy_reward_max": {"policy_0": -12.682971633056864}, "policy_reward_mean": {"policy_0": -728.4062587188527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1159.785258089237, -979.0069138960548, -105.21881807021437, -814.0022584266321, -151.32552279771213, -424.020144421691, -876.2523544377858, -608.2391655347102, -1070.4018923614362, -273.14658403815355, -240.58185575035108, -234.78578311283653, -830.1012156759441, -1071.078394185203, -758.937791512848, -963.6462227030203, -451.26553096474953, -93.69168289981482, -917.4287342686837, -698.7780972551931, -1148.296993673829, -1195.5497131618993, -778.6181260420343, -1027.1535352029548, -898.1386068200313, -696.9268428856844, -639.8610541227166, -668.7514685946885, -676.8985138077735, -302.25250572779703, -1134.620545138266, -1193.8246672834205, -992.0519507533465, -237.64618567263008, -986.3606342249348, -76.81537369061134, -1084.6965634509763, -713.9327630237811, -769.2498083618123, -823.1531640483022, -931.1609700346469, -1121.4778390535384, -721.7415017832384, -961.216344530692, -247.22627763513253, -1102.8279200841566, -609.721320843072, -799.2244021048257, -901.5436723846719, -143.4710071279425, -871.0691910941471, -217.8314134190302, -716.1293901192732, -707.7153372906297, -947.4724813120723, -919.0668144504418, -385.64810375166405, -25.202317930444117, -654.7514758808213, -505.1459557893678, -972.9430171294421, -716.1678306278212, -801.4531011076184, -1033.9086995023977, -826.2122073504469, -486.84262417895934, -761.4026571243753, -1100.6506686398695, -881.1427778248644, -987.3112232764079, -959.6241605767045, -255.56453247555476, -375.7283202757449, -471.0240842783956, -799.7717201505519, -1231.964650197415, -798.4770974322976, -643.8378016758179, -799.5335298845065, -12.682971633056864, -380.1200048553583, -180.1023092035796, -30.276211817500872, -1011.007362013034, -981.7005676927176, -1045.4898606135453, -560.8367623126428, -1357.1782579565217, -1036.9690944930614, -567.6771829180306, -989.3301738855306, -1189.3460679205132, -1204.8026306209013, -1075.260340721207, -515.1720541635568, -1064.5438325368489, -129.13311930077307, -282.7707780775998, -1117.741479411454, -948.7871333190666], "episode_lengths": [150, 150, 58, 150, 109, 150, 150, 150, 150, 150, 99, 120, 150, 150, 150, 150, 118, 74, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 72, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 89, 150, 77, 140, 150, 150, 150, 115, 53, 150, 147, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 126, 150, 150, 150, 150, 150, 150, 48, 150, 91, 48, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 85, 150, 150], "policy_policy_0_reward": [-1159.785258089237, -979.0069138960548, -105.21881807021437, -814.0022584266321, -151.32552279771213, -424.020144421691, -876.2523544377858, -608.2391655347102, -1070.4018923614362, -273.14658403815355, -240.58185575035108, -234.78578311283653, -830.1012156759441, -1071.078394185203, -758.937791512848, -963.6462227030203, -451.26553096474953, -93.69168289981482, -917.4287342686837, -698.7780972551931, -1148.296993673829, -1195.5497131618993, -778.6181260420343, -1027.1535352029548, -898.1386068200313, -696.9268428856844, -639.8610541227166, -668.7514685946885, -676.8985138077735, -302.25250572779703, -1134.620545138266, -1193.8246672834205, -992.0519507533465, -237.64618567263008, -986.3606342249348, -76.81537369061134, -1084.6965634509763, -713.9327630237811, -769.2498083618123, -823.1531640483022, -931.1609700346469, -1121.4778390535384, -721.7415017832384, -961.216344530692, -247.22627763513253, -1102.8279200841566, -609.721320843072, -799.2244021048257, -901.5436723846719, -143.4710071279425, -871.0691910941471, -217.8314134190302, -716.1293901192732, -707.7153372906297, -947.4724813120723, -919.0668144504418, -385.64810375166405, -25.202317930444117, -654.7514758808213, -505.1459557893678, -972.9430171294421, -716.1678306278212, -801.4531011076184, -1033.9086995023977, -826.2122073504469, -486.84262417895934, -761.4026571243753, -1100.6506686398695, -881.1427778248644, -987.3112232764079, -959.6241605767045, -255.56453247555476, -375.7283202757449, -471.0240842783956, -799.7717201505519, -1231.964650197415, -798.4770974322976, -643.8378016758179, -799.5335298845065, -12.682971633056864, -380.1200048553583, -180.1023092035796, -30.276211817500872, -1011.007362013034, -981.7005676927176, -1045.4898606135453, -560.8367623126428, -1357.1782579565217, -1036.9690944930614, -567.6771829180306, -989.3301738855306, -1189.3460679205132, -1204.8026306209013, -1075.260340721207, -515.1720541635568, -1064.5438325368489, -129.13311930077307, -282.7707780775998, -1117.741479411454, -948.7871333190666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5624052845283859, "mean_inference_ms": 1.7080997264770161, "mean_action_processing_ms": 0.28658100443099327, "mean_env_wait_ms": 3.0266830843285315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01331472396850586, "StateBufferConnector_ms": 0.008909940719604492, "ViewRequirementAgentConnector_ms": 0.19406604766845703}, "num_episodes": 30, "episode_return_max": -12.682971633056864, "episode_return_min": -1357.1782579565217, "episode_return_mean": -728.4062587188527, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.11092796985633, "num_env_steps_trained_throughput_per_sec": 299.11092796985633, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13177.292, "restore_workers_time_ms": 0.039, "training_step_time_ms": 13177.202, "sample_time_ms": 1041.879, "learn_time_ms": 12066.118, "learn_throughput": 331.507, "synch_weights_time_ms": 68.396}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00013", "date": "2024-08-03_11-28-58", "timestamp": 1722664738, "time_this_iter_s": 13.386917352676392, "time_total_s": 79.14056468009949, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c3f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 79.14056468009949, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 14.026315789473685, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.267301758130394, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.901547425488631, "policy_loss": -0.0060741709787786625, "vf_loss": 4.906043023616076, "vf_explained_var": 0.8477790605897705, "kl": 0.015927502938029654, "entropy": 1.6069223595162232, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -12.682971633056864, "episode_reward_min": -1357.1782579565217, "episode_reward_mean": -736.7079516358106, "episode_len_mean": 136.93, "episode_media": {}, "episodes_timesteps_total": 13693, "policy_reward_min": {"policy_0": -1357.1782579565217}, "policy_reward_max": {"policy_0": -12.682971633056864}, "policy_reward_mean": {"policy_0": -736.7079516358106}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-992.0519507533465, -237.64618567263008, -986.3606342249348, -76.81537369061134, -1084.6965634509763, -713.9327630237811, -769.2498083618123, -823.1531640483022, -931.1609700346469, -1121.4778390535384, -721.7415017832384, -961.216344530692, -247.22627763513253, -1102.8279200841566, -609.721320843072, -799.2244021048257, -901.5436723846719, -143.4710071279425, -871.0691910941471, -217.8314134190302, -716.1293901192732, -707.7153372906297, -947.4724813120723, -919.0668144504418, -385.64810375166405, -25.202317930444117, -654.7514758808213, -505.1459557893678, -972.9430171294421, -716.1678306278212, -801.4531011076184, -1033.9086995023977, -826.2122073504469, -486.84262417895934, -761.4026571243753, -1100.6506686398695, -881.1427778248644, -987.3112232764079, -959.6241605767045, -255.56453247555476, -375.7283202757449, -471.0240842783956, -799.7717201505519, -1231.964650197415, -798.4770974322976, -643.8378016758179, -799.5335298845065, -12.682971633056864, -380.1200048553583, -180.1023092035796, -30.276211817500872, -1011.007362013034, -981.7005676927176, -1045.4898606135453, -560.8367623126428, -1357.1782579565217, -1036.9690944930614, -567.6771829180306, -989.3301738855306, -1189.3460679205132, -1204.8026306209013, -1075.260340721207, -515.1720541635568, -1064.5438325368489, -129.13311930077307, -282.7707780775998, -1117.741479411454, -948.7871333190666, -770.2010503416335, -895.2139762849204, -878.3597951575255, -1220.0826845853494, -541.3450212633497, -823.9957582199036, -970.4851845151267, -1318.0491303767994, -26.64599131098251, -420.90903665988697, -943.399027843596, -1131.4415704670985, -857.5295819831566, -1080.8893417070608, -803.1706253830665, -316.89309207822197, -305.6811012079346, -618.7022776285032, -1235.0646536300746, -532.4239797464908, -864.9372349308844, -344.0007993246397, -1126.7435559639, -1060.355762545868, -927.8754793222384, -212.43381372916906, -875.6557634631835, -451.92725094652803, -1317.7819903343882, -150.83396877550854, -333.68388389778175, -556.043700934383], "episode_lengths": [150, 72, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 89, 150, 77, 140, 150, 150, 150, 115, 53, 150, 147, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 126, 150, 150, 150, 150, 150, 150, 48, 150, 91, 48, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 85, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 41, 103, 150, 150, 150, 150, 150, 123, 150, 138, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 106, 144], "policy_policy_0_reward": [-992.0519507533465, -237.64618567263008, -986.3606342249348, -76.81537369061134, -1084.6965634509763, -713.9327630237811, -769.2498083618123, -823.1531640483022, -931.1609700346469, -1121.4778390535384, -721.7415017832384, -961.216344530692, -247.22627763513253, -1102.8279200841566, -609.721320843072, -799.2244021048257, -901.5436723846719, -143.4710071279425, -871.0691910941471, -217.8314134190302, -716.1293901192732, -707.7153372906297, -947.4724813120723, -919.0668144504418, -385.64810375166405, -25.202317930444117, -654.7514758808213, -505.1459557893678, -972.9430171294421, -716.1678306278212, -801.4531011076184, -1033.9086995023977, -826.2122073504469, -486.84262417895934, -761.4026571243753, -1100.6506686398695, -881.1427778248644, -987.3112232764079, -959.6241605767045, -255.56453247555476, -375.7283202757449, -471.0240842783956, -799.7717201505519, -1231.964650197415, -798.4770974322976, -643.8378016758179, -799.5335298845065, -12.682971633056864, -380.1200048553583, -180.1023092035796, -30.276211817500872, -1011.007362013034, -981.7005676927176, -1045.4898606135453, -560.8367623126428, -1357.1782579565217, -1036.9690944930614, -567.6771829180306, -989.3301738855306, -1189.3460679205132, -1204.8026306209013, -1075.260340721207, -515.1720541635568, -1064.5438325368489, -129.13311930077307, -282.7707780775998, -1117.741479411454, -948.7871333190666, -770.2010503416335, -895.2139762849204, -878.3597951575255, -1220.0826845853494, -541.3450212633497, -823.9957582199036, -970.4851845151267, -1318.0491303767994, -26.64599131098251, -420.90903665988697, -943.399027843596, -1131.4415704670985, -857.5295819831566, -1080.8893417070608, -803.1706253830665, -316.89309207822197, -305.6811012079346, -618.7022776285032, -1235.0646536300746, -532.4239797464908, -864.9372349308844, -344.0007993246397, -1126.7435559639, -1060.355762545868, -927.8754793222384, -212.43381372916906, -875.6557634631835, -451.92725094652803, -1317.7819903343882, -150.83396877550854, -333.68388389778175, -556.043700934383]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5610635651665281, "mean_inference_ms": 1.706350898569533, "mean_action_processing_ms": 0.2860614739004705, "mean_env_wait_ms": 3.0323332294002467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012908935546875, "StateBufferConnector_ms": 0.008337974548339844, "ViewRequirementAgentConnector_ms": 0.19152092933654785}, "num_episodes": 32, "episode_return_max": -12.682971633056864, "episode_return_min": -1357.1782579565217, "episode_return_mean": -736.7079516358106, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.8034000574637, "num_env_steps_trained_throughput_per_sec": 301.8034000574637, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13188.204, "restore_workers_time_ms": 0.038, "training_step_time_ms": 13188.115, "sample_time_ms": 1042.553, "learn_time_ms": 12076.99, "learn_throughput": 331.208, "synch_weights_time_ms": 67.67}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00013", "date": "2024-08-03_11-29-11", "timestamp": 1722664751, "time_this_iter_s": 13.26785683631897, "time_total_s": 92.40842151641846, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c2d40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 92.40842151641846, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.810526315789472, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 71.6124240765969, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.29685680779318, "policy_loss": -0.016156550604985873, "vf_loss": 4.3113050676882265, "vf_explained_var": 0.8559572524701555, "kl": 0.01683284928752377, "entropy": 1.658272714416186, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -12.682971633056864, "episode_reward_min": -1476.3436850788976, "episode_reward_mean": -751.6470214020591, "episode_len_mean": 138.94, "episode_media": {}, "episodes_timesteps_total": 13894, "policy_reward_min": {"policy_0": -1476.3436850788976}, "policy_reward_max": {"policy_0": -12.682971633056864}, "policy_reward_mean": {"policy_0": -751.6470214020591}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-505.1459557893678, -972.9430171294421, -716.1678306278212, -801.4531011076184, -1033.9086995023977, -826.2122073504469, -486.84262417895934, -761.4026571243753, -1100.6506686398695, -881.1427778248644, -987.3112232764079, -959.6241605767045, -255.56453247555476, -375.7283202757449, -471.0240842783956, -799.7717201505519, -1231.964650197415, -798.4770974322976, -643.8378016758179, -799.5335298845065, -12.682971633056864, -380.1200048553583, -180.1023092035796, -30.276211817500872, -1011.007362013034, -981.7005676927176, -1045.4898606135453, -560.8367623126428, -1357.1782579565217, -1036.9690944930614, -567.6771829180306, -989.3301738855306, -1189.3460679205132, -1204.8026306209013, -1075.260340721207, -515.1720541635568, -1064.5438325368489, -129.13311930077307, -282.7707780775998, -1117.741479411454, -948.7871333190666, -770.2010503416335, -895.2139762849204, -878.3597951575255, -1220.0826845853494, -541.3450212633497, -823.9957582199036, -970.4851845151267, -1318.0491303767994, -26.64599131098251, -420.90903665988697, -943.399027843596, -1131.4415704670985, -857.5295819831566, -1080.8893417070608, -803.1706253830665, -316.89309207822197, -305.6811012079346, -618.7022776285032, -1235.0646536300746, -532.4239797464908, -864.9372349308844, -344.0007993246397, -1126.7435559639, -1060.355762545868, -927.8754793222384, -212.43381372916906, -875.6557634631835, -451.92725094652803, -1317.7819903343882, -150.83396877550854, -333.68388389778175, -556.043700934383, -538.6143015896777, -382.92170863804864, -590.5628809052579, -391.47684557898424, -990.6107192006483, -493.7118432971602, -911.85252042476, -1188.6916218244396, -1084.5274203707888, -821.604055324867, -340.8657468506594, -830.512276042079, -903.4376459445388, -1057.4850889245756, -827.7709401995535, -821.8890582037415, -428.41063227796417, -433.80263714159025, -851.7885594932704, -786.9777321365434, -752.5643354689425, -1103.3237515815722, -93.50950785421745, -1476.3436850788976, -195.90883340053148, -939.651119748131, -923.495733180264], "episode_lengths": [147, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 126, 150, 150, 150, 150, 150, 150, 48, 150, 91, 48, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 85, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 41, 103, 150, 150, 150, 150, 150, 123, 150, 138, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 106, 144, 150, 150, 150, 94, 150, 147, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 79, 150, 70, 150, 150], "policy_policy_0_reward": [-505.1459557893678, -972.9430171294421, -716.1678306278212, -801.4531011076184, -1033.9086995023977, -826.2122073504469, -486.84262417895934, -761.4026571243753, -1100.6506686398695, -881.1427778248644, -987.3112232764079, -959.6241605767045, -255.56453247555476, -375.7283202757449, -471.0240842783956, -799.7717201505519, -1231.964650197415, -798.4770974322976, -643.8378016758179, -799.5335298845065, -12.682971633056864, -380.1200048553583, -180.1023092035796, -30.276211817500872, -1011.007362013034, -981.7005676927176, -1045.4898606135453, -560.8367623126428, -1357.1782579565217, -1036.9690944930614, -567.6771829180306, -989.3301738855306, -1189.3460679205132, -1204.8026306209013, -1075.260340721207, -515.1720541635568, -1064.5438325368489, -129.13311930077307, -282.7707780775998, -1117.741479411454, -948.7871333190666, -770.2010503416335, -895.2139762849204, -878.3597951575255, -1220.0826845853494, -541.3450212633497, -823.9957582199036, -970.4851845151267, -1318.0491303767994, -26.64599131098251, -420.90903665988697, -943.399027843596, -1131.4415704670985, -857.5295819831566, -1080.8893417070608, -803.1706253830665, -316.89309207822197, -305.6811012079346, -618.7022776285032, -1235.0646536300746, -532.4239797464908, -864.9372349308844, -344.0007993246397, -1126.7435559639, -1060.355762545868, -927.8754793222384, -212.43381372916906, -875.6557634631835, -451.92725094652803, -1317.7819903343882, -150.83396877550854, -333.68388389778175, -556.043700934383, -538.6143015896777, -382.92170863804864, -590.5628809052579, -391.47684557898424, -990.6107192006483, -493.7118432971602, -911.85252042476, -1188.6916218244396, -1084.5274203707888, -821.604055324867, -340.8657468506594, -830.512276042079, -903.4376459445388, -1057.4850889245756, -827.7709401995535, -821.8890582037415, -428.41063227796417, -433.80263714159025, -851.7885594932704, -786.9777321365434, -752.5643354689425, -1103.3237515815722, -93.50950785421745, -1476.3436850788976, -195.90883340053148, -939.651119748131, -923.495733180264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5591704393675512, "mean_inference_ms": 1.7038095698715343, "mean_action_processing_ms": 0.2853480620267626, "mean_env_wait_ms": 3.037024902408257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012254953384399414, "StateBufferConnector_ms": 0.008066892623901367, "ViewRequirementAgentConnector_ms": 0.18872928619384766}, "num_episodes": 27, "episode_return_max": -12.682971633056864, "episode_return_min": -1476.3436850788976, "episode_return_mean": -751.6470214020591, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.1427745565188, "num_env_steps_trained_throughput_per_sec": 295.1427745565188, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13233.776, "restore_workers_time_ms": 0.038, "training_step_time_ms": 13233.686, "sample_time_ms": 1047.984, "learn_time_ms": 12117.448, "learn_throughput": 330.103, "synch_weights_time_ms": 67.289}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00013", "date": "2024-08-03_11-29-25", "timestamp": 1722664765, "time_this_iter_s": 13.565227031707764, "time_total_s": 105.97364854812622, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245761cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 105.97364854812622, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.75, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 91.10091195205847, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.141606212407351, "policy_loss": -0.009776183600479271, "vf_loss": 4.149548208216826, "vf_explained_var": 0.9617779063681762, "kl": 0.017071275681276657, "entropy": 1.580064819380641, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -26.64599131098251, "episode_reward_min": -1476.3436850788976, "episode_reward_mean": -727.9296550251503, "episode_len_mean": 138.37, "episode_media": {}, "episodes_timesteps_total": 13837, "policy_reward_min": {"policy_0": -1476.3436850788976}, "policy_reward_max": {"policy_0": -26.64599131098251}, "policy_reward_mean": {"policy_0": -727.9296550251503}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-567.6771829180306, -989.3301738855306, -1189.3460679205132, -1204.8026306209013, -1075.260340721207, -515.1720541635568, -1064.5438325368489, -129.13311930077307, -282.7707780775998, -1117.741479411454, -948.7871333190666, -770.2010503416335, -895.2139762849204, -878.3597951575255, -1220.0826845853494, -541.3450212633497, -823.9957582199036, -970.4851845151267, -1318.0491303767994, -26.64599131098251, -420.90903665988697, -943.399027843596, -1131.4415704670985, -857.5295819831566, -1080.8893417070608, -803.1706253830665, -316.89309207822197, -305.6811012079346, -618.7022776285032, -1235.0646536300746, -532.4239797464908, -864.9372349308844, -344.0007993246397, -1126.7435559639, -1060.355762545868, -927.8754793222384, -212.43381372916906, -875.6557634631835, -451.92725094652803, -1317.7819903343882, -150.83396877550854, -333.68388389778175, -556.043700934383, -538.6143015896777, -382.92170863804864, -590.5628809052579, -391.47684557898424, -990.6107192006483, -493.7118432971602, -911.85252042476, -1188.6916218244396, -1084.5274203707888, -821.604055324867, -340.8657468506594, -830.512276042079, -903.4376459445388, -1057.4850889245756, -827.7709401995535, -821.8890582037415, -428.41063227796417, -433.80263714159025, -851.7885594932704, -786.9777321365434, -752.5643354689425, -1103.3237515815722, -93.50950785421745, -1476.3436850788976, -195.90883340053148, -939.651119748131, -923.495733180264, -985.4292443822488, -472.2844192664439, -642.0983959357591, -737.2081183874195, -951.4016490989056, -54.42318107469679, -460.5265306738164, -280.11841355507056, -31.910740727004445, -330.58285460725955, -536.1874414420926, -862.4612779240833, -658.5262614332738, -876.640815805088, -103.81811542122021, -342.3237255719651, -1103.5534528943692, -667.9689391457673, -607.6520048662934, -429.5484954483458, -1058.1842645131574, -363.70914675312133, -1150.060911914551, -885.5482637440003, -978.2665999923223, -729.1037733514639, -962.2947822938314, -907.5254310684323, -954.0150051963292, -509.96116791035956], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 85, 85, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 41, 103, 150, 150, 150, 150, 150, 123, 150, 138, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 106, 144, 150, 150, 150, 94, 150, 147, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 79, 150, 70, 150, 150, 150, 150, 150, 150, 150, 62, 111, 150, 53, 97, 150, 150, 150, 150, 83, 150, 150, 150, 150, 99, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-567.6771829180306, -989.3301738855306, -1189.3460679205132, -1204.8026306209013, -1075.260340721207, -515.1720541635568, -1064.5438325368489, -129.13311930077307, -282.7707780775998, -1117.741479411454, -948.7871333190666, -770.2010503416335, -895.2139762849204, -878.3597951575255, -1220.0826845853494, -541.3450212633497, -823.9957582199036, -970.4851845151267, -1318.0491303767994, -26.64599131098251, -420.90903665988697, -943.399027843596, -1131.4415704670985, -857.5295819831566, -1080.8893417070608, -803.1706253830665, -316.89309207822197, -305.6811012079346, -618.7022776285032, -1235.0646536300746, -532.4239797464908, -864.9372349308844, -344.0007993246397, -1126.7435559639, -1060.355762545868, -927.8754793222384, -212.43381372916906, -875.6557634631835, -451.92725094652803, -1317.7819903343882, -150.83396877550854, -333.68388389778175, -556.043700934383, -538.6143015896777, -382.92170863804864, -590.5628809052579, -391.47684557898424, -990.6107192006483, -493.7118432971602, -911.85252042476, -1188.6916218244396, -1084.5274203707888, -821.604055324867, -340.8657468506594, -830.512276042079, -903.4376459445388, -1057.4850889245756, -827.7709401995535, -821.8890582037415, -428.41063227796417, -433.80263714159025, -851.7885594932704, -786.9777321365434, -752.5643354689425, -1103.3237515815722, -93.50950785421745, -1476.3436850788976, -195.90883340053148, -939.651119748131, -923.495733180264, -985.4292443822488, -472.2844192664439, -642.0983959357591, -737.2081183874195, -951.4016490989056, -54.42318107469679, -460.5265306738164, -280.11841355507056, -31.910740727004445, -330.58285460725955, -536.1874414420926, -862.4612779240833, -658.5262614332738, -876.640815805088, -103.81811542122021, -342.3237255719651, -1103.5534528943692, -667.9689391457673, -607.6520048662934, -429.5484954483458, -1058.1842645131574, -363.70914675312133, -1150.060911914551, -885.5482637440003, -978.2665999923223, -729.1037733514639, -962.2947822938314, -907.5254310684323, -954.0150051963292, -509.96116791035956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5588921153506103, "mean_inference_ms": 1.7039434836647902, "mean_action_processing_ms": 0.2846506058034095, "mean_env_wait_ms": 3.040084327957388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012133121490478516, "StateBufferConnector_ms": 0.00792241096496582, "ViewRequirementAgentConnector_ms": 0.18910527229309082}, "num_episodes": 30, "episode_return_max": -26.64599131098251, "episode_return_min": -1476.3436850788976, "episode_return_mean": -727.9296550251503, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.8404541350211, "num_env_steps_trained_throughput_per_sec": 304.8404541350211, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13221.315, "restore_workers_time_ms": 0.036, "training_step_time_ms": 13221.228, "sample_time_ms": 1045.269, "learn_time_ms": 12107.722, "learn_throughput": 330.368, "synch_weights_time_ms": 67.281}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00013", "date": "2024-08-03_11-29-38", "timestamp": 1722664778, "time_this_iter_s": 13.13474440574646, "time_total_s": 119.10839295387268, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c2cb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 119.10839295387268, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 14.233333333333329, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 106.06992024679978, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.6646121216317016, "policy_loss": 0.004332162164306889, "vf_loss": 3.6531163806716602, "vf_explained_var": 0.9639403289804857, "kl": 0.043700986485964675, "entropy": 1.5766238478322825, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -31.910740727004445, "episode_reward_min": -1476.3436850788976, "episode_reward_mean": -704.9417465171574, "episode_len_mean": 138.16, "episode_media": {}, "episodes_timesteps_total": 13816, "policy_reward_min": {"policy_0": -1476.3436850788976}, "policy_reward_max": {"policy_0": -31.910740727004445}, "policy_reward_mean": {"policy_0": -704.9417465171574}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-305.6811012079346, -618.7022776285032, -1235.0646536300746, -532.4239797464908, -864.9372349308844, -344.0007993246397, -1126.7435559639, -1060.355762545868, -927.8754793222384, -212.43381372916906, -875.6557634631835, -451.92725094652803, -1317.7819903343882, -150.83396877550854, -333.68388389778175, -556.043700934383, -538.6143015896777, -382.92170863804864, -590.5628809052579, -391.47684557898424, -990.6107192006483, -493.7118432971602, -911.85252042476, -1188.6916218244396, -1084.5274203707888, -821.604055324867, -340.8657468506594, -830.512276042079, -903.4376459445388, -1057.4850889245756, -827.7709401995535, -821.8890582037415, -428.41063227796417, -433.80263714159025, -851.7885594932704, -786.9777321365434, -752.5643354689425, -1103.3237515815722, -93.50950785421745, -1476.3436850788976, -195.90883340053148, -939.651119748131, -923.495733180264, -985.4292443822488, -472.2844192664439, -642.0983959357591, -737.2081183874195, -951.4016490989056, -54.42318107469679, -460.5265306738164, -280.11841355507056, -31.910740727004445, -330.58285460725955, -536.1874414420926, -862.4612779240833, -658.5262614332738, -876.640815805088, -103.81811542122021, -342.3237255719651, -1103.5534528943692, -667.9689391457673, -607.6520048662934, -429.5484954483458, -1058.1842645131574, -363.70914675312133, -1150.060911914551, -885.5482637440003, -978.2665999923223, -729.1037733514639, -962.2947822938314, -907.5254310684323, -954.0150051963292, -509.96116791035956, -994.5013395596976, -923.3271281150293, -622.9167563347231, -65.86106838992157, -995.880642474883, -352.0882422835481, -441.82168822798724, -1165.9529701189456, -1404.8780867398543, -214.11874242756923, -740.6368618267708, -1217.2818629763171, -699.9118033442846, -932.6040282041957, -295.53799211416066, -440.70818835970067, -881.6678742806462, -53.45706869604423, -896.7885274301385, -824.2264452293767, -873.2041638129964, -913.2745055862499, -1086.3531836255474, -892.6339434208656, -811.7598781952206, -760.5541624967254, -282.43765598246466], "episode_lengths": [150, 138, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 106, 144, 150, 150, 150, 94, 150, 147, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 79, 150, 70, 150, 150, 150, 150, 150, 150, 150, 62, 111, 150, 53, 97, 150, 150, 150, 150, 83, 150, 150, 150, 150, 99, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 92, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 117], "policy_policy_0_reward": [-305.6811012079346, -618.7022776285032, -1235.0646536300746, -532.4239797464908, -864.9372349308844, -344.0007993246397, -1126.7435559639, -1060.355762545868, -927.8754793222384, -212.43381372916906, -875.6557634631835, -451.92725094652803, -1317.7819903343882, -150.83396877550854, -333.68388389778175, -556.043700934383, -538.6143015896777, -382.92170863804864, -590.5628809052579, -391.47684557898424, -990.6107192006483, -493.7118432971602, -911.85252042476, -1188.6916218244396, -1084.5274203707888, -821.604055324867, -340.8657468506594, -830.512276042079, -903.4376459445388, -1057.4850889245756, -827.7709401995535, -821.8890582037415, -428.41063227796417, -433.80263714159025, -851.7885594932704, -786.9777321365434, -752.5643354689425, -1103.3237515815722, -93.50950785421745, -1476.3436850788976, -195.90883340053148, -939.651119748131, -923.495733180264, -985.4292443822488, -472.2844192664439, -642.0983959357591, -737.2081183874195, -951.4016490989056, -54.42318107469679, -460.5265306738164, -280.11841355507056, -31.910740727004445, -330.58285460725955, -536.1874414420926, -862.4612779240833, -658.5262614332738, -876.640815805088, -103.81811542122021, -342.3237255719651, -1103.5534528943692, -667.9689391457673, -607.6520048662934, -429.5484954483458, -1058.1842645131574, -363.70914675312133, -1150.060911914551, -885.5482637440003, -978.2665999923223, -729.1037733514639, -962.2947822938314, -907.5254310684323, -954.0150051963292, -509.96116791035956, -994.5013395596976, -923.3271281150293, -622.9167563347231, -65.86106838992157, -995.880642474883, -352.0882422835481, -441.82168822798724, -1165.9529701189456, -1404.8780867398543, -214.11874242756923, -740.6368618267708, -1217.2818629763171, -699.9118033442846, -932.6040282041957, -295.53799211416066, -440.70818835970067, -881.6678742806462, -53.45706869604423, -896.7885274301385, -824.2264452293767, -873.2041638129964, -913.2745055862499, -1086.3531836255474, -892.6339434208656, -811.7598781952206, -760.5541624967254, -282.43765598246466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5580583624176125, "mean_inference_ms": 1.7042172041371941, "mean_action_processing_ms": 0.2839524632814483, "mean_env_wait_ms": 3.0416772902191713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012091875076293945, "StateBufferConnector_ms": 0.007833480834960938, "ViewRequirementAgentConnector_ms": 0.189009428024292}, "num_episodes": 27, "episode_return_max": -31.910740727004445, "episode_return_min": -1476.3436850788976, "episode_return_mean": -704.9417465171574, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.3316677456495, "num_env_steps_trained_throughput_per_sec": 303.3316677456495, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13217.874, "restore_workers_time_ms": 0.036, "training_step_time_ms": 13217.788, "sample_time_ms": 1042.087, "learn_time_ms": 12108.401, "learn_throughput": 330.349, "synch_weights_time_ms": 66.366}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00013", "date": "2024-08-03_11-29-51", "timestamp": 1722664791, "time_this_iter_s": 13.199248313903809, "time_total_s": 132.3076412677765, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244526ef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 132.3076412677765, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.921052631578947, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 121.56050663590432, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.877469494069616, "policy_loss": -0.00528841129077288, "vf_loss": 2.879399048288663, "vf_explained_var": 0.9651504204298059, "kl": 0.0163016980811032, "entropy": 1.5316476746151844, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -31.910740727004445, "episode_reward_min": -1476.3436850788976, "episode_reward_mean": -706.2899834824573, "episode_len_mean": 136.93, "episode_media": {}, "episodes_timesteps_total": 13693, "policy_reward_min": {"policy_0": -1476.3436850788976}, "policy_reward_max": {"policy_0": -31.910740727004445}, "policy_reward_mean": {"policy_0": -706.2899834824573}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-903.4376459445388, -1057.4850889245756, -827.7709401995535, -821.8890582037415, -428.41063227796417, -433.80263714159025, -851.7885594932704, -786.9777321365434, -752.5643354689425, -1103.3237515815722, -93.50950785421745, -1476.3436850788976, -195.90883340053148, -939.651119748131, -923.495733180264, -985.4292443822488, -472.2844192664439, -642.0983959357591, -737.2081183874195, -951.4016490989056, -54.42318107469679, -460.5265306738164, -280.11841355507056, -31.910740727004445, -330.58285460725955, -536.1874414420926, -862.4612779240833, -658.5262614332738, -876.640815805088, -103.81811542122021, -342.3237255719651, -1103.5534528943692, -667.9689391457673, -607.6520048662934, -429.5484954483458, -1058.1842645131574, -363.70914675312133, -1150.060911914551, -885.5482637440003, -978.2665999923223, -729.1037733514639, -962.2947822938314, -907.5254310684323, -954.0150051963292, -509.96116791035956, -994.5013395596976, -923.3271281150293, -622.9167563347231, -65.86106838992157, -995.880642474883, -352.0882422835481, -441.82168822798724, -1165.9529701189456, -1404.8780867398543, -214.11874242756923, -740.6368618267708, -1217.2818629763171, -699.9118033442846, -932.6040282041957, -295.53799211416066, -440.70818835970067, -881.6678742806462, -53.45706869604423, -896.7885274301385, -824.2264452293767, -873.2041638129964, -913.2745055862499, -1086.3531836255474, -892.6339434208656, -811.7598781952206, -760.5541624967254, -282.43765598246466, -1199.3515020386164, -754.564303664123, -361.70981348584735, -938.6058137491012, -898.0340100115166, -644.0621052988545, -552.2742012235736, -1034.621034630108, -291.6924836259312, -1166.7614461385897, -270.55918418785683, -1000.7113293714241, -732.9145412179492, -1176.3587686397914, -247.80828513821223, -482.34302230678855, -455.4921938440752, -487.7907309625589, -782.0482955146199, -1025.5283347052796, -162.69136411006428, -932.4944104601914, -678.3065164216034, -106.5808171285474, -646.8271794443789, -1157.2273338652344, -724.1625750302244, -703.3992567437891], "episode_lengths": [150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 79, 150, 70, 150, 150, 150, 150, 150, 150, 150, 62, 111, 150, 53, 97, 150, 150, 150, 150, 83, 150, 150, 150, 150, 99, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 92, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 94, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 61, 150, 150, 53, 150, 150, 135, 150], "policy_policy_0_reward": [-903.4376459445388, -1057.4850889245756, -827.7709401995535, -821.8890582037415, -428.41063227796417, -433.80263714159025, -851.7885594932704, -786.9777321365434, -752.5643354689425, -1103.3237515815722, -93.50950785421745, -1476.3436850788976, -195.90883340053148, -939.651119748131, -923.495733180264, -985.4292443822488, -472.2844192664439, -642.0983959357591, -737.2081183874195, -951.4016490989056, -54.42318107469679, -460.5265306738164, -280.11841355507056, -31.910740727004445, -330.58285460725955, -536.1874414420926, -862.4612779240833, -658.5262614332738, -876.640815805088, -103.81811542122021, -342.3237255719651, -1103.5534528943692, -667.9689391457673, -607.6520048662934, -429.5484954483458, -1058.1842645131574, -363.70914675312133, -1150.060911914551, -885.5482637440003, -978.2665999923223, -729.1037733514639, -962.2947822938314, -907.5254310684323, -954.0150051963292, -509.96116791035956, -994.5013395596976, -923.3271281150293, -622.9167563347231, -65.86106838992157, -995.880642474883, -352.0882422835481, -441.82168822798724, -1165.9529701189456, -1404.8780867398543, -214.11874242756923, -740.6368618267708, -1217.2818629763171, -699.9118033442846, -932.6040282041957, -295.53799211416066, -440.70818835970067, -881.6678742806462, -53.45706869604423, -896.7885274301385, -824.2264452293767, -873.2041638129964, -913.2745055862499, -1086.3531836255474, -892.6339434208656, -811.7598781952206, -760.5541624967254, -282.43765598246466, -1199.3515020386164, -754.564303664123, -361.70981348584735, -938.6058137491012, -898.0340100115166, -644.0621052988545, -552.2742012235736, -1034.621034630108, -291.6924836259312, -1166.7614461385897, -270.55918418785683, -1000.7113293714241, -732.9145412179492, -1176.3587686397914, -247.80828513821223, -482.34302230678855, -455.4921938440752, -487.7907309625589, -782.0482955146199, -1025.5283347052796, -162.69136411006428, -932.4944104601914, -678.3065164216034, -106.5808171285474, -646.8271794443789, -1157.2273338652344, -724.1625750302244, -703.3992567437891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5574033526924267, "mean_inference_ms": 1.703176849851265, "mean_action_processing_ms": 0.28340869529890894, "mean_env_wait_ms": 3.0429891371900264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011954069137573242, "StateBufferConnector_ms": 0.007836341857910156, "ViewRequirementAgentConnector_ms": 0.1898796558380127}, "num_episodes": 28, "episode_return_max": -31.910740727004445, "episode_return_min": -1476.3436850788976, "episode_return_mean": -706.2899834824573, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.9518638581551, "num_env_steps_trained_throughput_per_sec": 333.9518638581551, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13088.486, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13088.401, "sample_time_ms": 1039.451, "learn_time_ms": 11982.42, "learn_throughput": 333.822, "synch_weights_time_ms": 65.605}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00013", "date": "2024-08-03_11-30-04", "timestamp": 1722664804, "time_this_iter_s": 11.991227149963379, "time_total_s": 144.29886841773987, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244434dc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 144.29886841773987, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 14.552941176470588, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.79763777454693, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.9789527799313267, "policy_loss": -0.01151979214628227, "vf_loss": 2.9870850269372267, "vf_explained_var": 0.9867207629606127, "kl": 0.01652815647933798, "entropy": 1.5709009658545257, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -5.5205862795590885, "episode_reward_min": -1404.8780867398543, "episode_reward_mean": -732.9393083878447, "episode_len_mean": 138.91, "episode_media": {}, "episodes_timesteps_total": 13891, "policy_reward_min": {"policy_0": -1404.8780867398543}, "policy_reward_max": {"policy_0": -5.5205862795590885}, "policy_reward_mean": {"policy_0": -732.9393083878447}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.3237255719651, -1103.5534528943692, -667.9689391457673, -607.6520048662934, -429.5484954483458, -1058.1842645131574, -363.70914675312133, -1150.060911914551, -885.5482637440003, -978.2665999923223, -729.1037733514639, -962.2947822938314, -907.5254310684323, -954.0150051963292, -509.96116791035956, -994.5013395596976, -923.3271281150293, -622.9167563347231, -65.86106838992157, -995.880642474883, -352.0882422835481, -441.82168822798724, -1165.9529701189456, -1404.8780867398543, -214.11874242756923, -740.6368618267708, -1217.2818629763171, -699.9118033442846, -932.6040282041957, -295.53799211416066, -440.70818835970067, -881.6678742806462, -53.45706869604423, -896.7885274301385, -824.2264452293767, -873.2041638129964, -913.2745055862499, -1086.3531836255474, -892.6339434208656, -811.7598781952206, -760.5541624967254, -282.43765598246466, -1199.3515020386164, -754.564303664123, -361.70981348584735, -938.6058137491012, -898.0340100115166, -644.0621052988545, -552.2742012235736, -1034.621034630108, -291.6924836259312, -1166.7614461385897, -270.55918418785683, -1000.7113293714241, -732.9145412179492, -1176.3587686397914, -247.80828513821223, -482.34302230678855, -455.4921938440752, -487.7907309625589, -782.0482955146199, -1025.5283347052796, -162.69136411006428, -932.4944104601914, -678.3065164216034, -106.5808171285474, -646.8271794443789, -1157.2273338652344, -724.1625750302244, -703.3992567437891, -1078.863719709973, -1119.2635003365504, -509.1091173442646, -797.2993594125285, -744.994292472956, -1272.9186441721463, -1053.2287523142725, -72.21018420511933, -1137.8011156184848, -408.1395274236898, -194.55339192167398, -671.1301070008883, -358.6412322944957, -660.9103655254734, -828.433734364635, -844.25231001459, -1001.5503955902827, -1033.5391083972495, -447.5776965972988, -929.4132710501902, -1005.7961251268434, -5.5205862795590885, -495.5504587176501, -998.0303495352765, -859.9535043526424, -817.276732968453, -986.2097091416999, -883.2096867733012, -859.3453741083175, -170.18685813693747], "episode_lengths": [150, 150, 150, 150, 99, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 92, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 94, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 61, 150, 150, 53, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 35, 137, 150, 150, 150, 150, 150, 150, 86], "policy_policy_0_reward": [-342.3237255719651, -1103.5534528943692, -667.9689391457673, -607.6520048662934, -429.5484954483458, -1058.1842645131574, -363.70914675312133, -1150.060911914551, -885.5482637440003, -978.2665999923223, -729.1037733514639, -962.2947822938314, -907.5254310684323, -954.0150051963292, -509.96116791035956, -994.5013395596976, -923.3271281150293, -622.9167563347231, -65.86106838992157, -995.880642474883, -352.0882422835481, -441.82168822798724, -1165.9529701189456, -1404.8780867398543, -214.11874242756923, -740.6368618267708, -1217.2818629763171, -699.9118033442846, -932.6040282041957, -295.53799211416066, -440.70818835970067, -881.6678742806462, -53.45706869604423, -896.7885274301385, -824.2264452293767, -873.2041638129964, -913.2745055862499, -1086.3531836255474, -892.6339434208656, -811.7598781952206, -760.5541624967254, -282.43765598246466, -1199.3515020386164, -754.564303664123, -361.70981348584735, -938.6058137491012, -898.0340100115166, -644.0621052988545, -552.2742012235736, -1034.621034630108, -291.6924836259312, -1166.7614461385897, -270.55918418785683, -1000.7113293714241, -732.9145412179492, -1176.3587686397914, -247.80828513821223, -482.34302230678855, -455.4921938440752, -487.7907309625589, -782.0482955146199, -1025.5283347052796, -162.69136411006428, -932.4944104601914, -678.3065164216034, -106.5808171285474, -646.8271794443789, -1157.2273338652344, -724.1625750302244, -703.3992567437891, -1078.863719709973, -1119.2635003365504, -509.1091173442646, -797.2993594125285, -744.994292472956, -1272.9186441721463, -1053.2287523142725, -72.21018420511933, -1137.8011156184848, -408.1395274236898, -194.55339192167398, -671.1301070008883, -358.6412322944957, -660.9103655254734, -828.433734364635, -844.25231001459, -1001.5503955902827, -1033.5391083972495, -447.5776965972988, -929.4132710501902, -1005.7961251268434, -5.5205862795590885, -495.5504587176501, -998.0303495352765, -859.9535043526424, -817.276732968453, -986.2097091416999, -883.2096867733012, -859.3453741083175, -170.18685813693747]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569725221293805, "mean_inference_ms": 1.7007806900725486, "mean_action_processing_ms": 0.28253693371669863, "mean_env_wait_ms": 3.044692013431584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011988639831542969, "StateBufferConnector_ms": 0.007890939712524414, "ViewRequirementAgentConnector_ms": 0.19139766693115234}, "num_episodes": 30, "episode_return_max": -5.5205862795590885, "episode_return_min": -1404.8780867398543, "episode_return_mean": -732.9393083878447, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.08626919021015, "num_env_steps_trained_throughput_per_sec": 295.08626919021015, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13144.697, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13144.616, "sample_time_ms": 1056.862, "learn_time_ms": 12021.483, "learn_throughput": 332.738, "synch_weights_time_ms": 65.344}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00013", "date": "2024-08-03_11-30-17", "timestamp": 1722664817, "time_this_iter_s": 13.567209243774414, "time_total_s": 157.86607766151428, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244435a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 157.86607766151428, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.919999999999998, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.45454503397147, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.995353992904226, "policy_loss": -0.013633517060467663, "vf_loss": 3.0058002565056086, "vf_explained_var": 0.9853290539234877, "kl": 0.01591554766619084, "entropy": 1.5874063895394406, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -5.5205862795590885, "episode_reward_min": -1358.2066879176555, "episode_reward_mean": -740.0847321643575, "episode_len_mean": 139.6, "episode_media": {}, "episodes_timesteps_total": 13960, "policy_reward_min": {"policy_0": -1358.2066879176555}, "policy_reward_max": {"policy_0": -5.5205862795590885}, "policy_reward_mean": {"policy_0": -740.0847321643575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-881.6678742806462, -53.45706869604423, -896.7885274301385, -824.2264452293767, -873.2041638129964, -913.2745055862499, -1086.3531836255474, -892.6339434208656, -811.7598781952206, -760.5541624967254, -282.43765598246466, -1199.3515020386164, -754.564303664123, -361.70981348584735, -938.6058137491012, -898.0340100115166, -644.0621052988545, -552.2742012235736, -1034.621034630108, -291.6924836259312, -1166.7614461385897, -270.55918418785683, -1000.7113293714241, -732.9145412179492, -1176.3587686397914, -247.80828513821223, -482.34302230678855, -455.4921938440752, -487.7907309625589, -782.0482955146199, -1025.5283347052796, -162.69136411006428, -932.4944104601914, -678.3065164216034, -106.5808171285474, -646.8271794443789, -1157.2273338652344, -724.1625750302244, -703.3992567437891, -1078.863719709973, -1119.2635003365504, -509.1091173442646, -797.2993594125285, -744.994292472956, -1272.9186441721463, -1053.2287523142725, -72.21018420511933, -1137.8011156184848, -408.1395274236898, -194.55339192167398, -671.1301070008883, -358.6412322944957, -660.9103655254734, -828.433734364635, -844.25231001459, -1001.5503955902827, -1033.5391083972495, -447.5776965972988, -929.4132710501902, -1005.7961251268434, -5.5205862795590885, -495.5504587176501, -998.0303495352765, -859.9535043526424, -817.276732968453, -986.2097091416999, -883.2096867733012, -859.3453741083175, -170.18685813693747, -847.8965778660297, -972.7307392231157, -1081.598284828911, -903.5790281385069, -487.75027948160226, -1358.2066879176555, -983.9683202791095, -683.0257149210514, -441.4557480298174, -58.52789659460957, -358.5930242417307, -421.3895076246377, -673.711154916027, -590.3460708218508, -1248.403728161598, -31.713888648709297, -149.28554295819404, -915.2318485408955, -860.7288701498946, -921.6683439503124, -539.1147378568465, -917.016196195037, -722.9922422812734, -1108.01353069692, -547.62153132965, -1224.1204366100526, -868.018988486546, -838.0999704206862, -1095.390505609974, -1109.5195596158521, -912.5667874160848], "episode_lengths": [150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 94, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 61, 150, 150, 53, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 35, 137, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 60, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-881.6678742806462, -53.45706869604423, -896.7885274301385, -824.2264452293767, -873.2041638129964, -913.2745055862499, -1086.3531836255474, -892.6339434208656, -811.7598781952206, -760.5541624967254, -282.43765598246466, -1199.3515020386164, -754.564303664123, -361.70981348584735, -938.6058137491012, -898.0340100115166, -644.0621052988545, -552.2742012235736, -1034.621034630108, -291.6924836259312, -1166.7614461385897, -270.55918418785683, -1000.7113293714241, -732.9145412179492, -1176.3587686397914, -247.80828513821223, -482.34302230678855, -455.4921938440752, -487.7907309625589, -782.0482955146199, -1025.5283347052796, -162.69136411006428, -932.4944104601914, -678.3065164216034, -106.5808171285474, -646.8271794443789, -1157.2273338652344, -724.1625750302244, -703.3992567437891, -1078.863719709973, -1119.2635003365504, -509.1091173442646, -797.2993594125285, -744.994292472956, -1272.9186441721463, -1053.2287523142725, -72.21018420511933, -1137.8011156184848, -408.1395274236898, -194.55339192167398, -671.1301070008883, -358.6412322944957, -660.9103655254734, -828.433734364635, -844.25231001459, -1001.5503955902827, -1033.5391083972495, -447.5776965972988, -929.4132710501902, -1005.7961251268434, -5.5205862795590885, -495.5504587176501, -998.0303495352765, -859.9535043526424, -817.276732968453, -986.2097091416999, -883.2096867733012, -859.3453741083175, -170.18685813693747, -847.8965778660297, -972.7307392231157, -1081.598284828911, -903.5790281385069, -487.75027948160226, -1358.2066879176555, -983.9683202791095, -683.0257149210514, -441.4557480298174, -58.52789659460957, -358.5930242417307, -421.3895076246377, -673.711154916027, -590.3460708218508, -1248.403728161598, -31.713888648709297, -149.28554295819404, -915.2318485408955, -860.7288701498946, -921.6683439503124, -539.1147378568465, -917.016196195037, -722.9922422812734, -1108.01353069692, -547.62153132965, -1224.1204366100526, -868.018988486546, -838.0999704206862, -1095.390505609974, -1109.5195596158521, -912.5667874160848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.557076656063144, "mean_inference_ms": 1.6987900663721018, "mean_action_processing_ms": 0.28204544216224736, "mean_env_wait_ms": 3.0445681403096394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01212620735168457, "StateBufferConnector_ms": 0.008145570755004883, "ViewRequirementAgentConnector_ms": 0.19725918769836426}, "num_episodes": 31, "episode_return_max": -5.5205862795590885, "episode_return_min": -1358.2066879176555, "episode_return_mean": -740.0847321643575, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.6315372473427, "num_env_steps_trained_throughput_per_sec": 294.6315372473427, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13170.907, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13170.827, "sample_time_ms": 1056.385, "learn_time_ms": 12048.028, "learn_throughput": 332.005, "synch_weights_time_ms": 65.486}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00013", "date": "2024-08-03_11-30-31", "timestamp": 1722664831, "time_this_iter_s": 13.589191198348999, "time_total_s": 171.45526885986328, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b17e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 171.45526885986328, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 14.073684210526318, "ram_util_percent": 27.715789473684207}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 144.5333993256092, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.436030569051703, "policy_loss": -0.0057089465946774, "vf_loss": 2.4386791538447143, "vf_explained_var": 0.9888844792420666, "kl": 0.015188905354595297, "entropy": 1.4963178873062133, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -5.5205862795590885, "episode_reward_min": -1358.2066879176555, "episode_reward_mean": -724.4006610709954, "episode_len_mean": 139.6, "episode_media": {}, "episodes_timesteps_total": 13960, "policy_reward_min": {"policy_0": -1358.2066879176555}, "policy_reward_max": {"policy_0": -5.5205862795590885}, "policy_reward_mean": {"policy_0": -724.4006610709954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-487.7907309625589, -782.0482955146199, -1025.5283347052796, -162.69136411006428, -932.4944104601914, -678.3065164216034, -106.5808171285474, -646.8271794443789, -1157.2273338652344, -724.1625750302244, -703.3992567437891, -1078.863719709973, -1119.2635003365504, -509.1091173442646, -797.2993594125285, -744.994292472956, -1272.9186441721463, -1053.2287523142725, -72.21018420511933, -1137.8011156184848, -408.1395274236898, -194.55339192167398, -671.1301070008883, -358.6412322944957, -660.9103655254734, -828.433734364635, -844.25231001459, -1001.5503955902827, -1033.5391083972495, -447.5776965972988, -929.4132710501902, -1005.7961251268434, -5.5205862795590885, -495.5504587176501, -998.0303495352765, -859.9535043526424, -817.276732968453, -986.2097091416999, -883.2096867733012, -859.3453741083175, -170.18685813693747, -847.8965778660297, -972.7307392231157, -1081.598284828911, -903.5790281385069, -487.75027948160226, -1358.2066879176555, -983.9683202791095, -683.0257149210514, -441.4557480298174, -58.52789659460957, -358.5930242417307, -421.3895076246377, -673.711154916027, -590.3460708218508, -1248.403728161598, -31.713888648709297, -149.28554295819404, -915.2318485408955, -860.7288701498946, -921.6683439503124, -539.1147378568465, -917.016196195037, -722.9922422812734, -1108.01353069692, -547.62153132965, -1224.1204366100526, -868.018988486546, -838.0999704206862, -1095.390505609974, -1109.5195596158521, -912.5667874160848, -293.89475574223883, -584.7548977094597, -469.9565756820753, -935.6182506549284, -527.4999455990362, -1238.1301239248048, -261.4417218370631, -1042.672194687234, -415.7177618344843, -797.490281561399, -602.3092101101847, -863.5607806909879, -871.8804544463834, -970.8118640307731, -755.8131873106762, -707.7502305713776, -1061.5769632799165, -977.3875513798026, -545.7673109098374, -557.1877677386613, -668.1539701898403, -826.4261631117733, -71.90382484741723, -865.5803566859191, -46.34236080223146, -791.9218042127782, -649.4138741541409, -514.8501542870029], "episode_lengths": [150, 150, 150, 61, 150, 150, 53, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 35, 137, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 60, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 51, 150, 150, 138], "policy_policy_0_reward": [-487.7907309625589, -782.0482955146199, -1025.5283347052796, -162.69136411006428, -932.4944104601914, -678.3065164216034, -106.5808171285474, -646.8271794443789, -1157.2273338652344, -724.1625750302244, -703.3992567437891, -1078.863719709973, -1119.2635003365504, -509.1091173442646, -797.2993594125285, -744.994292472956, -1272.9186441721463, -1053.2287523142725, -72.21018420511933, -1137.8011156184848, -408.1395274236898, -194.55339192167398, -671.1301070008883, -358.6412322944957, -660.9103655254734, -828.433734364635, -844.25231001459, -1001.5503955902827, -1033.5391083972495, -447.5776965972988, -929.4132710501902, -1005.7961251268434, -5.5205862795590885, -495.5504587176501, -998.0303495352765, -859.9535043526424, -817.276732968453, -986.2097091416999, -883.2096867733012, -859.3453741083175, -170.18685813693747, -847.8965778660297, -972.7307392231157, -1081.598284828911, -903.5790281385069, -487.75027948160226, -1358.2066879176555, -983.9683202791095, -683.0257149210514, -441.4557480298174, -58.52789659460957, -358.5930242417307, -421.3895076246377, -673.711154916027, -590.3460708218508, -1248.403728161598, -31.713888648709297, -149.28554295819404, -915.2318485408955, -860.7288701498946, -921.6683439503124, -539.1147378568465, -917.016196195037, -722.9922422812734, -1108.01353069692, -547.62153132965, -1224.1204366100526, -868.018988486546, -838.0999704206862, -1095.390505609974, -1109.5195596158521, -912.5667874160848, -293.89475574223883, -584.7548977094597, -469.9565756820753, -935.6182506549284, -527.4999455990362, -1238.1301239248048, -261.4417218370631, -1042.672194687234, -415.7177618344843, -797.490281561399, -602.3092101101847, -863.5607806909879, -871.8804544463834, -970.8118640307731, -755.8131873106762, -707.7502305713776, -1061.5769632799165, -977.3875513798026, -545.7673109098374, -557.1877677386613, -668.1539701898403, -826.4261631117733, -71.90382484741723, -865.5803566859191, -46.34236080223146, -791.9218042127782, -649.4138741541409, -514.8501542870029]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.558101041154046, "mean_inference_ms": 1.7002138409395113, "mean_action_processing_ms": 0.28206264708657164, "mean_env_wait_ms": 3.0513406098865863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012200593948364258, "StateBufferConnector_ms": 0.0081939697265625, "ViewRequirementAgentConnector_ms": 0.19869446754455566}, "num_episodes": 28, "episode_return_max": -5.5205862795590885, "episode_return_min": -1358.2066879176555, "episode_return_mean": -724.4006610709954, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.6973136479044, "num_env_steps_trained_throughput_per_sec": 399.6973136479044, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12830.263, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12830.187, "sample_time_ms": 1055.635, "learn_time_ms": 11712.243, "learn_throughput": 341.523, "synch_weights_time_ms": 61.395}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00013", "date": "2024-08-03_11-30-41", "timestamp": 1722664841, "time_this_iter_s": 10.018967628479004, "time_total_s": 181.47423648834229, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244527a30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 181.47423648834229, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 16.335714285714285, "ram_util_percent": 27.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 159.61429203152656, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.6529989423851172, "policy_loss": -0.006041441224321413, "vf_loss": 2.65642626148959, "vf_explained_var": 0.9868158004557093, "kl": 0.013745604267372376, "entropy": 1.5095545435945192, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -5.5205862795590885, "episode_reward_min": -1388.9651932036456, "episode_reward_mean": -737.2436960006245, "episode_len_mean": 139.5, "episode_media": {}, "episodes_timesteps_total": 13950, "policy_reward_min": {"policy_0": -1388.9651932036456}, "policy_reward_max": {"policy_0": -5.5205862795590885}, "policy_reward_mean": {"policy_0": -737.2436960006245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-447.5776965972988, -929.4132710501902, -1005.7961251268434, -5.5205862795590885, -495.5504587176501, -998.0303495352765, -859.9535043526424, -817.276732968453, -986.2097091416999, -883.2096867733012, -859.3453741083175, -170.18685813693747, -847.8965778660297, -972.7307392231157, -1081.598284828911, -903.5790281385069, -487.75027948160226, -1358.2066879176555, -983.9683202791095, -683.0257149210514, -441.4557480298174, -58.52789659460957, -358.5930242417307, -421.3895076246377, -673.711154916027, -590.3460708218508, -1248.403728161598, -31.713888648709297, -149.28554295819404, -915.2318485408955, -860.7288701498946, -921.6683439503124, -539.1147378568465, -917.016196195037, -722.9922422812734, -1108.01353069692, -547.62153132965, -1224.1204366100526, -868.018988486546, -838.0999704206862, -1095.390505609974, -1109.5195596158521, -912.5667874160848, -293.89475574223883, -584.7548977094597, -469.9565756820753, -935.6182506549284, -527.4999455990362, -1238.1301239248048, -261.4417218370631, -1042.672194687234, -415.7177618344843, -797.490281561399, -602.3092101101847, -863.5607806909879, -871.8804544463834, -970.8118640307731, -755.8131873106762, -707.7502305713776, -1061.5769632799165, -977.3875513798026, -545.7673109098374, -557.1877677386613, -668.1539701898403, -826.4261631117733, -71.90382484741723, -865.5803566859191, -46.34236080223146, -791.9218042127782, -649.4138741541409, -514.8501542870029, -84.7032002328793, -841.7812093107452, -1046.9671906969452, -486.53651978905253, -472.16922250142824, -1173.1495953982687, -356.8660846164825, -928.7510526879653, -1095.900184639833, -1135.5227711275757, -944.7623252691825, -215.0517078170995, -549.2446338670309, -1241.6314933952583, -761.1769519457519, -954.36137387953, -214.41037152466401, -522.3900408498242, -945.6644201730522, -1023.7186858687726, -1388.9651932036456, -687.0753062564146, -210.1731031386167, -930.7275563445123, -1347.911622106374, -241.1444413843226, -785.1114266245945, -806.2450394634767, -1086.0864413553463], "episode_lengths": [147, 150, 150, 35, 137, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 60, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 51, 150, 150, 138, 56, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 112, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 67, 150, 150, 109, 150, 150, 150], "policy_policy_0_reward": [-447.5776965972988, -929.4132710501902, -1005.7961251268434, -5.5205862795590885, -495.5504587176501, -998.0303495352765, -859.9535043526424, -817.276732968453, -986.2097091416999, -883.2096867733012, -859.3453741083175, -170.18685813693747, -847.8965778660297, -972.7307392231157, -1081.598284828911, -903.5790281385069, -487.75027948160226, -1358.2066879176555, -983.9683202791095, -683.0257149210514, -441.4557480298174, -58.52789659460957, -358.5930242417307, -421.3895076246377, -673.711154916027, -590.3460708218508, -1248.403728161598, -31.713888648709297, -149.28554295819404, -915.2318485408955, -860.7288701498946, -921.6683439503124, -539.1147378568465, -917.016196195037, -722.9922422812734, -1108.01353069692, -547.62153132965, -1224.1204366100526, -868.018988486546, -838.0999704206862, -1095.390505609974, -1109.5195596158521, -912.5667874160848, -293.89475574223883, -584.7548977094597, -469.9565756820753, -935.6182506549284, -527.4999455990362, -1238.1301239248048, -261.4417218370631, -1042.672194687234, -415.7177618344843, -797.490281561399, -602.3092101101847, -863.5607806909879, -871.8804544463834, -970.8118640307731, -755.8131873106762, -707.7502305713776, -1061.5769632799165, -977.3875513798026, -545.7673109098374, -557.1877677386613, -668.1539701898403, -826.4261631117733, -71.90382484741723, -865.5803566859191, -46.34236080223146, -791.9218042127782, -649.4138741541409, -514.8501542870029, -84.7032002328793, -841.7812093107452, -1046.9671906969452, -486.53651978905253, -472.16922250142824, -1173.1495953982687, -356.8660846164825, -928.7510526879653, -1095.900184639833, -1135.5227711275757, -944.7623252691825, -215.0517078170995, -549.2446338670309, -1241.6314933952583, -761.1769519457519, -954.36137387953, -214.41037152466401, -522.3900408498242, -945.6644201730522, -1023.7186858687726, -1388.9651932036456, -687.0753062564146, -210.1731031386167, -930.7275563445123, -1347.911622106374, -241.1444413843226, -785.1114266245945, -806.2450394634767, -1086.0864413553463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5585255801099265, "mean_inference_ms": 1.7002796314906619, "mean_action_processing_ms": 0.2818780811212126, "mean_env_wait_ms": 3.0527914453765153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012174606323242188, "StateBufferConnector_ms": 0.008173227310180664, "ViewRequirementAgentConnector_ms": 0.1990361213684082}, "num_episodes": 29, "episode_return_max": -5.5205862795590885, "episode_return_min": -1388.9651932036456, "episode_return_mean": -737.2436960006245, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 430.8621973945975, "num_env_steps_trained_throughput_per_sec": 430.8621973945975, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12488.872, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12488.801, "sample_time_ms": 1052.673, "learn_time_ms": 11373.116, "learn_throughput": 351.707, "synch_weights_time_ms": 62.088}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00013", "date": "2024-08-03_11-30-50", "timestamp": 1722664850, "time_this_iter_s": 9.297002792358398, "time_total_s": 190.77123928070068, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c2b00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 190.77123928070068, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 16.630769230769232, "ram_util_percent": 27.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 155.14967820644378, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.3880716452375053, "policy_loss": -0.007054773900502672, "vf_loss": 2.392063337688645, "vf_explained_var": 0.9841933220624923, "kl": 0.015662881176109995, "entropy": 1.6357862409204245, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -31.713888648709297, "episode_reward_min": -1388.9651932036456, "episode_reward_mean": -761.9298604606171, "episode_len_mean": 141.58, "episode_media": {}, "episodes_timesteps_total": 14158, "policy_reward_min": {"policy_0": -1388.9651932036456}, "policy_reward_max": {"policy_0": -31.713888648709297}, "policy_reward_mean": {"policy_0": -761.9298604606171}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-590.3460708218508, -1248.403728161598, -31.713888648709297, -149.28554295819404, -915.2318485408955, -860.7288701498946, -921.6683439503124, -539.1147378568465, -917.016196195037, -722.9922422812734, -1108.01353069692, -547.62153132965, -1224.1204366100526, -868.018988486546, -838.0999704206862, -1095.390505609974, -1109.5195596158521, -912.5667874160848, -293.89475574223883, -584.7548977094597, -469.9565756820753, -935.6182506549284, -527.4999455990362, -1238.1301239248048, -261.4417218370631, -1042.672194687234, -415.7177618344843, -797.490281561399, -602.3092101101847, -863.5607806909879, -871.8804544463834, -970.8118640307731, -755.8131873106762, -707.7502305713776, -1061.5769632799165, -977.3875513798026, -545.7673109098374, -557.1877677386613, -668.1539701898403, -826.4261631117733, -71.90382484741723, -865.5803566859191, -46.34236080223146, -791.9218042127782, -649.4138741541409, -514.8501542870029, -84.7032002328793, -841.7812093107452, -1046.9671906969452, -486.53651978905253, -472.16922250142824, -1173.1495953982687, -356.8660846164825, -928.7510526879653, -1095.900184639833, -1135.5227711275757, -944.7623252691825, -215.0517078170995, -549.2446338670309, -1241.6314933952583, -761.1769519457519, -954.36137387953, -214.41037152466401, -522.3900408498242, -945.6644201730522, -1023.7186858687726, -1388.9651932036456, -687.0753062564146, -210.1731031386167, -930.7275563445123, -1347.911622106374, -241.1444413843226, -785.1114266245945, -806.2450394634767, -1086.0864413553463, -734.5045755013077, -350.1437305662468, -1136.5611358927513, -1045.607693732833, -1202.2179393604051, -513.258018763216, -800.9203960390747, -885.4472893880209, -316.23362015974476, -681.6307269108146, -908.4342448656827, -959.604859449071, -964.5852882882451, -705.8525452802879, -741.2867106179069, -726.6381778852289, -321.7637214964206, -1191.6192590058665, -438.9102421406279, -581.8188442698915, -1174.7120875956018, -759.8714003598327, -1204.446481935223, -719.0573397426272, -1133.993433603324], "episode_lengths": [150, 150, 60, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 51, 150, 150, 138, 56, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 112, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 67, 150, 150, 109, 150, 150, 150, 150, 125, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 148, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-590.3460708218508, -1248.403728161598, -31.713888648709297, -149.28554295819404, -915.2318485408955, -860.7288701498946, -921.6683439503124, -539.1147378568465, -917.016196195037, -722.9922422812734, -1108.01353069692, -547.62153132965, -1224.1204366100526, -868.018988486546, -838.0999704206862, -1095.390505609974, -1109.5195596158521, -912.5667874160848, -293.89475574223883, -584.7548977094597, -469.9565756820753, -935.6182506549284, -527.4999455990362, -1238.1301239248048, -261.4417218370631, -1042.672194687234, -415.7177618344843, -797.490281561399, -602.3092101101847, -863.5607806909879, -871.8804544463834, -970.8118640307731, -755.8131873106762, -707.7502305713776, -1061.5769632799165, -977.3875513798026, -545.7673109098374, -557.1877677386613, -668.1539701898403, -826.4261631117733, -71.90382484741723, -865.5803566859191, -46.34236080223146, -791.9218042127782, -649.4138741541409, -514.8501542870029, -84.7032002328793, -841.7812093107452, -1046.9671906969452, -486.53651978905253, -472.16922250142824, -1173.1495953982687, -356.8660846164825, -928.7510526879653, -1095.900184639833, -1135.5227711275757, -944.7623252691825, -215.0517078170995, -549.2446338670309, -1241.6314933952583, -761.1769519457519, -954.36137387953, -214.41037152466401, -522.3900408498242, -945.6644201730522, -1023.7186858687726, -1388.9651932036456, -687.0753062564146, -210.1731031386167, -930.7275563445123, -1347.911622106374, -241.1444413843226, -785.1114266245945, -806.2450394634767, -1086.0864413553463, -734.5045755013077, -350.1437305662468, -1136.5611358927513, -1045.607693732833, -1202.2179393604051, -513.258018763216, -800.9203960390747, -885.4472893880209, -316.23362015974476, -681.6307269108146, -908.4342448656827, -959.604859449071, -964.5852882882451, -705.8525452802879, -741.2867106179069, -726.6381778852289, -321.7637214964206, -1191.6192590058665, -438.9102421406279, -581.8188442698915, -1174.7120875956018, -759.8714003598327, -1204.446481935223, -719.0573397426272, -1133.993433603324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5583029457220625, "mean_inference_ms": 1.700403997231208, "mean_action_processing_ms": 0.28161512030265906, "mean_env_wait_ms": 3.051890299091813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012097358703613281, "StateBufferConnector_ms": 0.008218765258789062, "ViewRequirementAgentConnector_ms": 0.19684958457946777}, "num_episodes": 25, "episode_return_max": -31.713888648709297, "episode_return_min": -1388.9651932036456, "episode_return_mean": -761.9298604606171, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.0771365093192, "num_env_steps_trained_throughput_per_sec": 320.0771365093192, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12401.274, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12401.203, "sample_time_ms": 1059.502, "learn_time_ms": 11278.169, "learn_throughput": 354.668, "synch_weights_time_ms": 62.613}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00013", "date": "2024-08-03_11-31-03", "timestamp": 1722664863, "time_this_iter_s": 12.509769439697266, "time_total_s": 203.28100872039795, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c35b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 203.28100872039795, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 14.43333333333333, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 161.46542290449142, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.022005195046465, "policy_loss": -0.010824268366074344, "vf_loss": 2.0296742162356773, "vf_explained_var": 0.9923810830960671, "kl": 0.015534359690718712, "entropy": 1.5050616305321456, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -46.34236080223146, "episode_reward_min": -1388.9651932036456, "episode_reward_mean": -792.3281395990344, "episode_len_mean": 143.54, "episode_media": {}, "episodes_timesteps_total": 14354, "policy_reward_min": {"policy_0": -1388.9651932036456}, "policy_reward_max": {"policy_0": -46.34236080223146}, "policy_reward_mean": {"policy_0": -792.3281395990344}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-415.7177618344843, -797.490281561399, -602.3092101101847, -863.5607806909879, -871.8804544463834, -970.8118640307731, -755.8131873106762, -707.7502305713776, -1061.5769632799165, -977.3875513798026, -545.7673109098374, -557.1877677386613, -668.1539701898403, -826.4261631117733, -71.90382484741723, -865.5803566859191, -46.34236080223146, -791.9218042127782, -649.4138741541409, -514.8501542870029, -84.7032002328793, -841.7812093107452, -1046.9671906969452, -486.53651978905253, -472.16922250142824, -1173.1495953982687, -356.8660846164825, -928.7510526879653, -1095.900184639833, -1135.5227711275757, -944.7623252691825, -215.0517078170995, -549.2446338670309, -1241.6314933952583, -761.1769519457519, -954.36137387953, -214.41037152466401, -522.3900408498242, -945.6644201730522, -1023.7186858687726, -1388.9651932036456, -687.0753062564146, -210.1731031386167, -930.7275563445123, -1347.911622106374, -241.1444413843226, -785.1114266245945, -806.2450394634767, -1086.0864413553463, -734.5045755013077, -350.1437305662468, -1136.5611358927513, -1045.607693732833, -1202.2179393604051, -513.258018763216, -800.9203960390747, -885.4472893880209, -316.23362015974476, -681.6307269108146, -908.4342448656827, -959.604859449071, -964.5852882882451, -705.8525452802879, -741.2867106179069, -726.6381778852289, -321.7637214964206, -1191.6192590058665, -438.9102421406279, -581.8188442698915, -1174.7120875956018, -759.8714003598327, -1204.446481935223, -719.0573397426272, -1133.993433603324, -1145.8288021619155, -1131.9802860804064, -1213.0046340629417, -1037.9144525935833, -618.5848825527042, -749.5856310909398, -878.345099144009, -888.1428320523436, -720.8033592282555, -877.2211236396647, -810.9501397545898, -1317.5612120255128, -477.26148891160835, -1101.3325830231488, -336.71453416175615, -858.6984208790157, -841.0495340344894, -772.4492817281097, -670.2114999195996, -738.9550765118034, -1273.3673993706398, -1057.9688556043332, -777.9072973198848, -933.1932133694525, -900.5381708879837, -864.0793493202734], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 51, 150, 150, 138, 56, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 112, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 67, 150, 150, 109, 150, 150, 150, 150, 125, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-415.7177618344843, -797.490281561399, -602.3092101101847, -863.5607806909879, -871.8804544463834, -970.8118640307731, -755.8131873106762, -707.7502305713776, -1061.5769632799165, -977.3875513798026, -545.7673109098374, -557.1877677386613, -668.1539701898403, -826.4261631117733, -71.90382484741723, -865.5803566859191, -46.34236080223146, -791.9218042127782, -649.4138741541409, -514.8501542870029, -84.7032002328793, -841.7812093107452, -1046.9671906969452, -486.53651978905253, -472.16922250142824, -1173.1495953982687, -356.8660846164825, -928.7510526879653, -1095.900184639833, -1135.5227711275757, -944.7623252691825, -215.0517078170995, -549.2446338670309, -1241.6314933952583, -761.1769519457519, -954.36137387953, -214.41037152466401, -522.3900408498242, -945.6644201730522, -1023.7186858687726, -1388.9651932036456, -687.0753062564146, -210.1731031386167, -930.7275563445123, -1347.911622106374, -241.1444413843226, -785.1114266245945, -806.2450394634767, -1086.0864413553463, -734.5045755013077, -350.1437305662468, -1136.5611358927513, -1045.607693732833, -1202.2179393604051, -513.258018763216, -800.9203960390747, -885.4472893880209, -316.23362015974476, -681.6307269108146, -908.4342448656827, -959.604859449071, -964.5852882882451, -705.8525452802879, -741.2867106179069, -726.6381778852289, -321.7637214964206, -1191.6192590058665, -438.9102421406279, -581.8188442698915, -1174.7120875956018, -759.8714003598327, -1204.446481935223, -719.0573397426272, -1133.993433603324, -1145.8288021619155, -1131.9802860804064, -1213.0046340629417, -1037.9144525935833, -618.5848825527042, -749.5856310909398, -878.345099144009, -888.1428320523436, -720.8033592282555, -877.2211236396647, -810.9501397545898, -1317.5612120255128, -477.26148891160835, -1101.3325830231488, -336.71453416175615, -858.6984208790157, -841.0495340344894, -772.4492817281097, -670.2114999195996, -738.9550765118034, -1273.3673993706398, -1057.9688556043332, -777.9072973198848, -933.1932133694525, -900.5381708879837, -864.0793493202734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577611494718512, "mean_inference_ms": 1.6991426799814375, "mean_action_processing_ms": 0.28129691728987777, "mean_env_wait_ms": 3.0517702620251264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011830329895019531, "StateBufferConnector_ms": 0.008142471313476562, "ViewRequirementAgentConnector_ms": 0.195418119430542}, "num_episodes": 26, "episode_return_max": -46.34236080223146, "episode_return_min": -1388.9651932036456, "episode_return_mean": -792.3281395990344, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.0937840523343, "num_env_steps_trained_throughput_per_sec": 303.0937840523343, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12395.631, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12395.562, "sample_time_ms": 1058.755, "learn_time_ms": 11271.428, "learn_throughput": 354.88, "synch_weights_time_ms": 64.518}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00013", "date": "2024-08-03_11-31-16", "timestamp": 1722664876, "time_this_iter_s": 13.210193157196045, "time_total_s": 216.491201877594, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244435bd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 216.491201877594, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.789473684210526, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 178.52165579199792, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.2756177636484307, "policy_loss": -0.008450568809833688, "vf_loss": 2.280213969759643, "vf_explained_var": 0.9819651392598947, "kl": 0.017575976455433812, "entropy": 1.4184496694554884, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -55.21597056039449, "episode_reward_min": -1388.9651932036456, "episode_reward_mean": -780.264787260699, "episode_len_mean": 141.84, "episode_media": {}, "episodes_timesteps_total": 14184, "policy_reward_min": {"policy_0": -1388.9651932036456}, "policy_reward_max": {"policy_0": -55.21597056039449}, "policy_reward_mean": {"policy_0": -780.264787260699}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-549.2446338670309, -1241.6314933952583, -761.1769519457519, -954.36137387953, -214.41037152466401, -522.3900408498242, -945.6644201730522, -1023.7186858687726, -1388.9651932036456, -687.0753062564146, -210.1731031386167, -930.7275563445123, -1347.911622106374, -241.1444413843226, -785.1114266245945, -806.2450394634767, -1086.0864413553463, -734.5045755013077, -350.1437305662468, -1136.5611358927513, -1045.607693732833, -1202.2179393604051, -513.258018763216, -800.9203960390747, -885.4472893880209, -316.23362015974476, -681.6307269108146, -908.4342448656827, -959.604859449071, -964.5852882882451, -705.8525452802879, -741.2867106179069, -726.6381778852289, -321.7637214964206, -1191.6192590058665, -438.9102421406279, -581.8188442698915, -1174.7120875956018, -759.8714003598327, -1204.446481935223, -719.0573397426272, -1133.993433603324, -1145.8288021619155, -1131.9802860804064, -1213.0046340629417, -1037.9144525935833, -618.5848825527042, -749.5856310909398, -878.345099144009, -888.1428320523436, -720.8033592282555, -877.2211236396647, -810.9501397545898, -1317.5612120255128, -477.26148891160835, -1101.3325830231488, -336.71453416175615, -858.6984208790157, -841.0495340344894, -772.4492817281097, -670.2114999195996, -738.9550765118034, -1273.3673993706398, -1057.9688556043332, -777.9072973198848, -933.1932133694525, -900.5381708879837, -864.0793493202734, -976.9226049036365, -852.126500248506, -839.604052223319, -276.3952774486094, -1026.336799266316, -953.8559941907649, -520.9236015456383, -926.6439547660736, -714.5688722876766, -821.1673508455569, -830.8825477478572, -953.5975105546322, -1014.5121810907494, -1172.9972923418784, -55.21597056039449, -364.1054132388808, -1054.0340356213685, -658.4971768013891, -931.9056469118665, -969.9410688928625, -249.16795789798428, -162.48115943703726, -565.5562821098837, -96.31519224943182, -560.1969519130055, -1020.0819950101936, -602.9684992492778, -357.532028466251, -212.95098672894025, -386.1767193142634, -131.62570943627009, -878.38436910899], "episode_lengths": [150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 67, 150, 150, 109, 150, 150, 150, 150, 125, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 143, 150, 150, 150, 150, 93, 88, 142, 79, 125, 150, 129, 113, 100, 150, 60, 150], "policy_policy_0_reward": [-549.2446338670309, -1241.6314933952583, -761.1769519457519, -954.36137387953, -214.41037152466401, -522.3900408498242, -945.6644201730522, -1023.7186858687726, -1388.9651932036456, -687.0753062564146, -210.1731031386167, -930.7275563445123, -1347.911622106374, -241.1444413843226, -785.1114266245945, -806.2450394634767, -1086.0864413553463, -734.5045755013077, -350.1437305662468, -1136.5611358927513, -1045.607693732833, -1202.2179393604051, -513.258018763216, -800.9203960390747, -885.4472893880209, -316.23362015974476, -681.6307269108146, -908.4342448656827, -959.604859449071, -964.5852882882451, -705.8525452802879, -741.2867106179069, -726.6381778852289, -321.7637214964206, -1191.6192590058665, -438.9102421406279, -581.8188442698915, -1174.7120875956018, -759.8714003598327, -1204.446481935223, -719.0573397426272, -1133.993433603324, -1145.8288021619155, -1131.9802860804064, -1213.0046340629417, -1037.9144525935833, -618.5848825527042, -749.5856310909398, -878.345099144009, -888.1428320523436, -720.8033592282555, -877.2211236396647, -810.9501397545898, -1317.5612120255128, -477.26148891160835, -1101.3325830231488, -336.71453416175615, -858.6984208790157, -841.0495340344894, -772.4492817281097, -670.2114999195996, -738.9550765118034, -1273.3673993706398, -1057.9688556043332, -777.9072973198848, -933.1932133694525, -900.5381708879837, -864.0793493202734, -976.9226049036365, -852.126500248506, -839.604052223319, -276.3952774486094, -1026.336799266316, -953.8559941907649, -520.9236015456383, -926.6439547660736, -714.5688722876766, -821.1673508455569, -830.8825477478572, -953.5975105546322, -1014.5121810907494, -1172.9972923418784, -55.21597056039449, -364.1054132388808, -1054.0340356213685, -658.4971768013891, -931.9056469118665, -969.9410688928625, -249.16795789798428, -162.48115943703726, -565.5562821098837, -96.31519224943182, -560.1969519130055, -1020.0819950101936, -602.9684992492778, -357.532028466251, -212.95098672894025, -386.1767193142634, -131.62570943627009, -878.38436910899]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5568560390627201, "mean_inference_ms": 1.6979967267574663, "mean_action_processing_ms": 0.2809024928409325, "mean_env_wait_ms": 3.0516419784630586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012169361114501953, "StateBufferConnector_ms": 0.008163928985595703, "ViewRequirementAgentConnector_ms": 0.19660043716430664}, "num_episodes": 32, "episode_return_max": -55.21597056039449, "episode_return_min": -1388.9651932036456, "episode_return_mean": -780.264787260699, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.717681243811, "num_env_steps_trained_throughput_per_sec": 302.717681243811, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12361.718, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12361.65, "sample_time_ms": 1055.669, "learn_time_ms": 11241.002, "learn_throughput": 355.84, "synch_weights_time_ms": 64.173}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00013", "date": "2024-08-03_11-31-29", "timestamp": 1722664889, "time_this_iter_s": 13.22695016860962, "time_total_s": 229.7181520462036, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c2b00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 229.7181520462036, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.794736842105264, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.7386303126812, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.144418293299774, "policy_loss": -0.009225791291100904, "vf_loss": 2.1497470093270143, "vf_explained_var": 0.9931981792673469, "kl": 0.01802310321099867, "entropy": 1.5098586374272902, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -28.61168337081105, "episode_reward_min": -1321.597581283666, "episode_reward_mean": -787.7050742906051, "episode_len_mean": 142.2, "episode_media": {}, "episodes_timesteps_total": 14220, "policy_reward_min": {"policy_0": -1321.597581283666}, "policy_reward_max": {"policy_0": -28.61168337081105}, "policy_reward_mean": {"policy_0": -787.7050742906051}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-908.4342448656827, -959.604859449071, -964.5852882882451, -705.8525452802879, -741.2867106179069, -726.6381778852289, -321.7637214964206, -1191.6192590058665, -438.9102421406279, -581.8188442698915, -1174.7120875956018, -759.8714003598327, -1204.446481935223, -719.0573397426272, -1133.993433603324, -1145.8288021619155, -1131.9802860804064, -1213.0046340629417, -1037.9144525935833, -618.5848825527042, -749.5856310909398, -878.345099144009, -888.1428320523436, -720.8033592282555, -877.2211236396647, -810.9501397545898, -1317.5612120255128, -477.26148891160835, -1101.3325830231488, -336.71453416175615, -858.6984208790157, -841.0495340344894, -772.4492817281097, -670.2114999195996, -738.9550765118034, -1273.3673993706398, -1057.9688556043332, -777.9072973198848, -933.1932133694525, -900.5381708879837, -864.0793493202734, -976.9226049036365, -852.126500248506, -839.604052223319, -276.3952774486094, -1026.336799266316, -953.8559941907649, -520.9236015456383, -926.6439547660736, -714.5688722876766, -821.1673508455569, -830.8825477478572, -953.5975105546322, -1014.5121810907494, -1172.9972923418784, -55.21597056039449, -364.1054132388808, -1054.0340356213685, -658.4971768013891, -931.9056469118665, -969.9410688928625, -249.16795789798428, -162.48115943703726, -565.5562821098837, -96.31519224943182, -560.1969519130055, -1020.0819950101936, -602.9684992492778, -357.532028466251, -212.95098672894025, -386.1767193142634, -131.62570943627009, -878.38436910899, -1095.5905966569856, -410.4870452995113, -1060.6053264990412, -1034.3415519402286, -1034.0108860690582, -964.4407358690339, -1256.0838109713536, -1131.223219297553, -1161.8574638893076, -555.7292317972973, -679.4399735774842, -856.6304344894143, -883.8690563102283, -807.570630768352, -1321.597581283666, -143.40643291266147, -732.6834049404454, -864.2082704850392, -1019.934323226062, -707.3357913640781, -670.3780259447215, -835.1557641071093, -933.7946687768924, -417.68764898522744, -857.9224238974722, -641.995947957165, -28.61168337081105], "episode_lengths": [150, 150, 150, 150, 150, 150, 130, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 143, 150, 150, 150, 150, 93, 88, 142, 79, 125, 150, 129, 113, 100, 150, 60, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43], "policy_policy_0_reward": [-908.4342448656827, -959.604859449071, -964.5852882882451, -705.8525452802879, -741.2867106179069, -726.6381778852289, -321.7637214964206, -1191.6192590058665, -438.9102421406279, -581.8188442698915, -1174.7120875956018, -759.8714003598327, -1204.446481935223, -719.0573397426272, -1133.993433603324, -1145.8288021619155, -1131.9802860804064, -1213.0046340629417, -1037.9144525935833, -618.5848825527042, -749.5856310909398, -878.345099144009, -888.1428320523436, -720.8033592282555, -877.2211236396647, -810.9501397545898, -1317.5612120255128, -477.26148891160835, -1101.3325830231488, -336.71453416175615, -858.6984208790157, -841.0495340344894, -772.4492817281097, -670.2114999195996, -738.9550765118034, -1273.3673993706398, -1057.9688556043332, -777.9072973198848, -933.1932133694525, -900.5381708879837, -864.0793493202734, -976.9226049036365, -852.126500248506, -839.604052223319, -276.3952774486094, -1026.336799266316, -953.8559941907649, -520.9236015456383, -926.6439547660736, -714.5688722876766, -821.1673508455569, -830.8825477478572, -953.5975105546322, -1014.5121810907494, -1172.9972923418784, -55.21597056039449, -364.1054132388808, -1054.0340356213685, -658.4971768013891, -931.9056469118665, -969.9410688928625, -249.16795789798428, -162.48115943703726, -565.5562821098837, -96.31519224943182, -560.1969519130055, -1020.0819950101936, -602.9684992492778, -357.532028466251, -212.95098672894025, -386.1767193142634, -131.62570943627009, -878.38436910899, -1095.5905966569856, -410.4870452995113, -1060.6053264990412, -1034.3415519402286, -1034.0108860690582, -964.4407358690339, -1256.0838109713536, -1131.223219297553, -1161.8574638893076, -555.7292317972973, -679.4399735774842, -856.6304344894143, -883.8690563102283, -807.570630768352, -1321.597581283666, -143.40643291266147, -732.6834049404454, -864.2082704850392, -1019.934323226062, -707.3357913640781, -670.3780259447215, -835.1557641071093, -933.7946687768924, -417.68764898522744, -857.9224238974722, -641.995947957165, -28.61168337081105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5561998157907585, "mean_inference_ms": 1.6962571910429076, "mean_action_processing_ms": 0.28067861309976083, "mean_env_wait_ms": 3.0528156409448304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012377023696899414, "StateBufferConnector_ms": 0.007976531982421875, "ViewRequirementAgentConnector_ms": 0.19794964790344238}, "num_episodes": 27, "episode_return_max": -28.61168337081105, "episode_return_min": -1321.597581283666, "episode_return_mean": -787.7050742906051, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.3218458517569, "num_env_steps_trained_throughput_per_sec": 302.3218458517569, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12372.65, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12372.578, "sample_time_ms": 1058.709, "learn_time_ms": 11249.222, "learn_throughput": 355.58, "synch_weights_time_ms": 63.844}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00013", "date": "2024-08-03_11-31-43", "timestamp": 1722664903, "time_this_iter_s": 13.245252132415771, "time_total_s": 242.96340417861938, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457630a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 242.96340417861938, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 14.084210526315792, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 163.41374055743216, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.2920886132866145, "policy_loss": -0.01369149573923399, "vf_loss": 2.3025255541006726, "vf_explained_var": 0.9899913926298419, "kl": 0.01568855735646745, "entropy": 1.4520041556408008, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -5.113118789188293, "episode_reward_min": -1321.597581283666, "episode_reward_mean": -742.6749263442373, "episode_len_mean": 138.25, "episode_media": {}, "episodes_timesteps_total": 13825, "policy_reward_min": {"policy_0": -1321.597581283666}, "policy_reward_max": {"policy_0": -5.113118789188293}, "policy_reward_mean": {"policy_0": -742.6749263442373}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-841.0495340344894, -772.4492817281097, -670.2114999195996, -738.9550765118034, -1273.3673993706398, -1057.9688556043332, -777.9072973198848, -933.1932133694525, -900.5381708879837, -864.0793493202734, -976.9226049036365, -852.126500248506, -839.604052223319, -276.3952774486094, -1026.336799266316, -953.8559941907649, -520.9236015456383, -926.6439547660736, -714.5688722876766, -821.1673508455569, -830.8825477478572, -953.5975105546322, -1014.5121810907494, -1172.9972923418784, -55.21597056039449, -364.1054132388808, -1054.0340356213685, -658.4971768013891, -931.9056469118665, -969.9410688928625, -249.16795789798428, -162.48115943703726, -565.5562821098837, -96.31519224943182, -560.1969519130055, -1020.0819950101936, -602.9684992492778, -357.532028466251, -212.95098672894025, -386.1767193142634, -131.62570943627009, -878.38436910899, -1095.5905966569856, -410.4870452995113, -1060.6053264990412, -1034.3415519402286, -1034.0108860690582, -964.4407358690339, -1256.0838109713536, -1131.223219297553, -1161.8574638893076, -555.7292317972973, -679.4399735774842, -856.6304344894143, -883.8690563102283, -807.570630768352, -1321.597581283666, -143.40643291266147, -732.6834049404454, -864.2082704850392, -1019.934323226062, -707.3357913640781, -670.3780259447215, -835.1557641071093, -933.7946687768924, -417.68764898522744, -857.9224238974722, -641.995947957165, -28.61168337081105, -950.9537887855737, -431.06594498985714, -640.9172813408694, -907.8508340102411, -844.1382080431576, -1057.625818690432, -1180.2406277646396, -766.071128516814, -742.5146401785734, -1031.0296318796734, -385.6195643410512, -972.7279902671688, -753.7308099090361, -92.30049183983066, -145.00821144447698, -603.7116024254223, -848.2189410994059, -946.401511684904, -625.2437241942575, -5.113118789188293, -720.0966972861488, -1184.3181416681746, -1049.2925718855356, -12.87904284586336, -839.4673128696702, -376.67720316123086, -103.01456287352593, -1069.6151666828937, -1123.1153354074743, -894.9034492889067, -889.6459690974617], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 143, 150, 150, 150, 150, 93, 88, 142, 79, 125, 150, 129, 113, 100, 150, 60, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 98, 145, 150, 150, 150, 43, 150, 150, 150, 49, 150, 150, 69, 150, 150, 150, 150], "policy_policy_0_reward": [-841.0495340344894, -772.4492817281097, -670.2114999195996, -738.9550765118034, -1273.3673993706398, -1057.9688556043332, -777.9072973198848, -933.1932133694525, -900.5381708879837, -864.0793493202734, -976.9226049036365, -852.126500248506, -839.604052223319, -276.3952774486094, -1026.336799266316, -953.8559941907649, -520.9236015456383, -926.6439547660736, -714.5688722876766, -821.1673508455569, -830.8825477478572, -953.5975105546322, -1014.5121810907494, -1172.9972923418784, -55.21597056039449, -364.1054132388808, -1054.0340356213685, -658.4971768013891, -931.9056469118665, -969.9410688928625, -249.16795789798428, -162.48115943703726, -565.5562821098837, -96.31519224943182, -560.1969519130055, -1020.0819950101936, -602.9684992492778, -357.532028466251, -212.95098672894025, -386.1767193142634, -131.62570943627009, -878.38436910899, -1095.5905966569856, -410.4870452995113, -1060.6053264990412, -1034.3415519402286, -1034.0108860690582, -964.4407358690339, -1256.0838109713536, -1131.223219297553, -1161.8574638893076, -555.7292317972973, -679.4399735774842, -856.6304344894143, -883.8690563102283, -807.570630768352, -1321.597581283666, -143.40643291266147, -732.6834049404454, -864.2082704850392, -1019.934323226062, -707.3357913640781, -670.3780259447215, -835.1557641071093, -933.7946687768924, -417.68764898522744, -857.9224238974722, -641.995947957165, -28.61168337081105, -950.9537887855737, -431.06594498985714, -640.9172813408694, -907.8508340102411, -844.1382080431576, -1057.625818690432, -1180.2406277646396, -766.071128516814, -742.5146401785734, -1031.0296318796734, -385.6195643410512, -972.7279902671688, -753.7308099090361, -92.30049183983066, -145.00821144447698, -603.7116024254223, -848.2189410994059, -946.401511684904, -625.2437241942575, -5.113118789188293, -720.0966972861488, -1184.3181416681746, -1049.2925718855356, -12.87904284586336, -839.4673128696702, -376.67720316123086, -103.01456287352593, -1069.6151666828937, -1123.1153354074743, -894.9034492889067, -889.6459690974617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555362004622659, "mean_inference_ms": 1.6955910302587907, "mean_action_processing_ms": 0.28053318273944106, "mean_env_wait_ms": 3.052265240395467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01264333724975586, "StateBufferConnector_ms": 0.008066177368164062, "ViewRequirementAgentConnector_ms": 0.1998615264892578}, "num_episodes": 31, "episode_return_max": -5.113118789188293, "episode_return_min": -1321.597581283666, "episode_return_mean": -742.6749263442373, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.8693796515676, "num_env_steps_trained_throughput_per_sec": 292.8693796515676, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12419.758, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12419.686, "sample_time_ms": 1061.056, "learn_time_ms": 11293.299, "learn_throughput": 354.192, "synch_weights_time_ms": 64.516}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00013", "date": "2024-08-03_11-31-56", "timestamp": 1722664916, "time_this_iter_s": 13.67034101486206, "time_total_s": 256.63374519348145, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b2c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 256.63374519348145, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.852631578947367, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.70205766558647, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.3427307517578204, "policy_loss": -0.010573435907523769, "vf_loss": 2.349552501613895, "vf_explained_var": 0.9878393183772762, "kl": 0.01720308875204258, "entropy": 1.409245208154122, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -5.113118789188293, "episode_reward_min": -1321.597581283666, "episode_reward_mean": -701.4616657929955, "episode_len_mean": 134.56, "episode_media": {}, "episodes_timesteps_total": 13456, "policy_reward_min": {"policy_0": -1321.597581283666}, "policy_reward_max": {"policy_0": -5.113118789188293}, "policy_reward_mean": {"policy_0": -701.4616657929955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-249.16795789798428, -162.48115943703726, -565.5562821098837, -96.31519224943182, -560.1969519130055, -1020.0819950101936, -602.9684992492778, -357.532028466251, -212.95098672894025, -386.1767193142634, -131.62570943627009, -878.38436910899, -1095.5905966569856, -410.4870452995113, -1060.6053264990412, -1034.3415519402286, -1034.0108860690582, -964.4407358690339, -1256.0838109713536, -1131.223219297553, -1161.8574638893076, -555.7292317972973, -679.4399735774842, -856.6304344894143, -883.8690563102283, -807.570630768352, -1321.597581283666, -143.40643291266147, -732.6834049404454, -864.2082704850392, -1019.934323226062, -707.3357913640781, -670.3780259447215, -835.1557641071093, -933.7946687768924, -417.68764898522744, -857.9224238974722, -641.995947957165, -28.61168337081105, -950.9537887855737, -431.06594498985714, -640.9172813408694, -907.8508340102411, -844.1382080431576, -1057.625818690432, -1180.2406277646396, -766.071128516814, -742.5146401785734, -1031.0296318796734, -385.6195643410512, -972.7279902671688, -753.7308099090361, -92.30049183983066, -145.00821144447698, -603.7116024254223, -848.2189410994059, -946.401511684904, -625.2437241942575, -5.113118789188293, -720.0966972861488, -1184.3181416681746, -1049.2925718855356, -12.87904284586336, -839.4673128696702, -376.67720316123086, -103.01456287352593, -1069.6151666828937, -1123.1153354074743, -894.9034492889067, -889.6459690974617, -946.9583572427055, -225.46809963369358, -742.4539436801597, -762.3639425456446, -471.2912268398862, -899.0900837414416, -739.8827076316597, -974.4815597218735, -966.3254157988612, -406.5059082763997, -485.34222785377614, -203.03773509878, -676.9565842365486, -1230.4264171727375, -55.69303567355216, -520.9275287188533, -989.0914779150683, -646.2487519132462, -677.97224523027, -847.9185721956339, -784.7676192129575, -297.2258262674208, -1287.1429188442091, -781.5352343233783, -1140.1185527479079, -1229.5194896266391, -108.57836493167729, -399.1938353557135, -969.6241618192993, -156.4856501803615], "episode_lengths": [93, 88, 142, 79, 125, 150, 129, 113, 100, 150, 60, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 98, 145, 150, 150, 150, 43, 150, 150, 150, 49, 150, 150, 69, 150, 150, 150, 150, 150, 112, 150, 150, 114, 150, 150, 150, 150, 150, 130, 101, 150, 150, 47, 129, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 55, 124, 150, 84], "policy_policy_0_reward": [-249.16795789798428, -162.48115943703726, -565.5562821098837, -96.31519224943182, -560.1969519130055, -1020.0819950101936, -602.9684992492778, -357.532028466251, -212.95098672894025, -386.1767193142634, -131.62570943627009, -878.38436910899, -1095.5905966569856, -410.4870452995113, -1060.6053264990412, -1034.3415519402286, -1034.0108860690582, -964.4407358690339, -1256.0838109713536, -1131.223219297553, -1161.8574638893076, -555.7292317972973, -679.4399735774842, -856.6304344894143, -883.8690563102283, -807.570630768352, -1321.597581283666, -143.40643291266147, -732.6834049404454, -864.2082704850392, -1019.934323226062, -707.3357913640781, -670.3780259447215, -835.1557641071093, -933.7946687768924, -417.68764898522744, -857.9224238974722, -641.995947957165, -28.61168337081105, -950.9537887855737, -431.06594498985714, -640.9172813408694, -907.8508340102411, -844.1382080431576, -1057.625818690432, -1180.2406277646396, -766.071128516814, -742.5146401785734, -1031.0296318796734, -385.6195643410512, -972.7279902671688, -753.7308099090361, -92.30049183983066, -145.00821144447698, -603.7116024254223, -848.2189410994059, -946.401511684904, -625.2437241942575, -5.113118789188293, -720.0966972861488, -1184.3181416681746, -1049.2925718855356, -12.87904284586336, -839.4673128696702, -376.67720316123086, -103.01456287352593, -1069.6151666828937, -1123.1153354074743, -894.9034492889067, -889.6459690974617, -946.9583572427055, -225.46809963369358, -742.4539436801597, -762.3639425456446, -471.2912268398862, -899.0900837414416, -739.8827076316597, -974.4815597218735, -966.3254157988612, -406.5059082763997, -485.34222785377614, -203.03773509878, -676.9565842365486, -1230.4264171727375, -55.69303567355216, -520.9275287188533, -989.0914779150683, -646.2487519132462, -677.97224523027, -847.9185721956339, -784.7676192129575, -297.2258262674208, -1287.1429188442091, -781.5352343233783, -1140.1185527479079, -1229.5194896266391, -108.57836493167729, -399.1938353557135, -969.6241618192993, -156.4856501803615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555530130123126, "mean_inference_ms": 1.6952445423889357, "mean_action_processing_ms": 0.2804758935572247, "mean_env_wait_ms": 3.054948938392971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012320756912231445, "StateBufferConnector_ms": 0.008027791976928711, "ViewRequirementAgentConnector_ms": 0.19732379913330078}, "num_episodes": 30, "episode_return_max": -5.113118789188293, "episode_return_min": -1321.597581283666, "episode_return_mean": -701.4616657929955, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.10629201901554, "num_env_steps_trained_throughput_per_sec": 304.10629201901554, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12537.311, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12537.237, "sample_time_ms": 1064.884, "learn_time_ms": 11405.917, "learn_throughput": 350.695, "synch_weights_time_ms": 65.609}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00013", "date": "2024-08-03_11-32-09", "timestamp": 1722664929, "time_this_iter_s": 13.16566514968872, "time_total_s": 269.79941034317017, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c2b00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 269.79941034317017, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.810526315789476, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.23008989195029, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.2003599078084033, "policy_loss": -0.014443534981789222, "vf_loss": 2.2109245870262386, "vf_explained_var": 0.988555661464731, "kl": 0.017712310009725736, "entropy": 1.4348368539164464, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -5.113118789188293, "episode_reward_min": -1388.6223609811068, "episode_reward_mean": -696.0496506584537, "episode_len_mean": 136.14, "episode_media": {}, "episodes_timesteps_total": 13614, "policy_reward_min": {"policy_0": -1388.6223609811068}, "policy_reward_max": {"policy_0": -5.113118789188293}, "policy_reward_mean": {"policy_0": -696.0496506584537}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-143.40643291266147, -732.6834049404454, -864.2082704850392, -1019.934323226062, -707.3357913640781, -670.3780259447215, -835.1557641071093, -933.7946687768924, -417.68764898522744, -857.9224238974722, -641.995947957165, -28.61168337081105, -950.9537887855737, -431.06594498985714, -640.9172813408694, -907.8508340102411, -844.1382080431576, -1057.625818690432, -1180.2406277646396, -766.071128516814, -742.5146401785734, -1031.0296318796734, -385.6195643410512, -972.7279902671688, -753.7308099090361, -92.30049183983066, -145.00821144447698, -603.7116024254223, -848.2189410994059, -946.401511684904, -625.2437241942575, -5.113118789188293, -720.0966972861488, -1184.3181416681746, -1049.2925718855356, -12.87904284586336, -839.4673128696702, -376.67720316123086, -103.01456287352593, -1069.6151666828937, -1123.1153354074743, -894.9034492889067, -889.6459690974617, -946.9583572427055, -225.46809963369358, -742.4539436801597, -762.3639425456446, -471.2912268398862, -899.0900837414416, -739.8827076316597, -974.4815597218735, -966.3254157988612, -406.5059082763997, -485.34222785377614, -203.03773509878, -676.9565842365486, -1230.4264171727375, -55.69303567355216, -520.9275287188533, -989.0914779150683, -646.2487519132462, -677.97224523027, -847.9185721956339, -784.7676192129575, -297.2258262674208, -1287.1429188442091, -781.5352343233783, -1140.1185527479079, -1229.5194896266391, -108.57836493167729, -399.1938353557135, -969.6241618192993, -156.4856501803615, -332.50024886820927, -164.93375600652666, -194.3028404240165, -843.9265986725151, -170.69176364382778, -718.267945590253, -707.3752854379003, -1283.4320282574067, -636.8432184027354, -917.2635960935188, -730.8873546901183, -710.7460936013688, -1137.7767984963293, -1388.6223609811068, -437.0845888732212, -989.1819267458173, -981.1562199647686, -924.7056230027341, -737.1303334283825, -520.8678609544842, -468.98891526259837, -939.033994118151, -818.4171529687137, -597.5229744453319, -366.58524082536906, -426.69941229401763, -790.7697501364509], "episode_lengths": [103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 98, 145, 150, 150, 150, 43, 150, 150, 150, 49, 150, 150, 69, 150, 150, 150, 150, 150, 112, 150, 150, 114, 150, 150, 150, 150, 150, 130, 101, 150, 150, 47, 129, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 55, 124, 150, 84, 130, 93, 78, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150], "policy_policy_0_reward": [-143.40643291266147, -732.6834049404454, -864.2082704850392, -1019.934323226062, -707.3357913640781, -670.3780259447215, -835.1557641071093, -933.7946687768924, -417.68764898522744, -857.9224238974722, -641.995947957165, -28.61168337081105, -950.9537887855737, -431.06594498985714, -640.9172813408694, -907.8508340102411, -844.1382080431576, -1057.625818690432, -1180.2406277646396, -766.071128516814, -742.5146401785734, -1031.0296318796734, -385.6195643410512, -972.7279902671688, -753.7308099090361, -92.30049183983066, -145.00821144447698, -603.7116024254223, -848.2189410994059, -946.401511684904, -625.2437241942575, -5.113118789188293, -720.0966972861488, -1184.3181416681746, -1049.2925718855356, -12.87904284586336, -839.4673128696702, -376.67720316123086, -103.01456287352593, -1069.6151666828937, -1123.1153354074743, -894.9034492889067, -889.6459690974617, -946.9583572427055, -225.46809963369358, -742.4539436801597, -762.3639425456446, -471.2912268398862, -899.0900837414416, -739.8827076316597, -974.4815597218735, -966.3254157988612, -406.5059082763997, -485.34222785377614, -203.03773509878, -676.9565842365486, -1230.4264171727375, -55.69303567355216, -520.9275287188533, -989.0914779150683, -646.2487519132462, -677.97224523027, -847.9185721956339, -784.7676192129575, -297.2258262674208, -1287.1429188442091, -781.5352343233783, -1140.1185527479079, -1229.5194896266391, -108.57836493167729, -399.1938353557135, -969.6241618192993, -156.4856501803615, -332.50024886820927, -164.93375600652666, -194.3028404240165, -843.9265986725151, -170.69176364382778, -718.267945590253, -707.3752854379003, -1283.4320282574067, -636.8432184027354, -917.2635960935188, -730.8873546901183, -710.7460936013688, -1137.7767984963293, -1388.6223609811068, -437.0845888732212, -989.1819267458173, -981.1562199647686, -924.7056230027341, -737.1303334283825, -520.8678609544842, -468.98891526259837, -939.033994118151, -818.4171529687137, -597.5229744453319, -366.58524082536906, -426.69941229401763, -790.7697501364509]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551716310895712, "mean_inference_ms": 1.694891149308403, "mean_action_processing_ms": 0.28032019880946746, "mean_env_wait_ms": 3.0538662988696887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012270450592041016, "StateBufferConnector_ms": 0.007994413375854492, "ViewRequirementAgentConnector_ms": 0.19585299491882324}, "num_episodes": 27, "episode_return_max": -5.113118789188293, "episode_return_min": -1388.6223609811068, "episode_return_mean": -696.0496506584537, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 432.6588357379798, "num_env_steps_trained_throughput_per_sec": 432.6588357379798, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12106.291, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12106.214, "sample_time_ms": 1047.963, "learn_time_ms": 10992.891, "learn_throughput": 363.872, "synch_weights_time_ms": 64.548}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00013", "date": "2024-08-03_11-32-19", "timestamp": 1722664939, "time_this_iter_s": 9.25670051574707, "time_total_s": 279.05611085891724, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444351b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 279.05611085891724, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 16.784615384615385, "ram_util_percent": 27.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 159.0158364524444, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.1825155426437655, "policy_loss": -0.016378619392829325, "vf_loss": 2.19437319735686, "vf_explained_var": 0.9906651413689057, "kl": 0.02091491015362409, "entropy": 1.753513907516996, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -5.113118789188293, "episode_reward_min": -1388.6223609811068, "episode_reward_mean": -703.0174868306613, "episode_len_mean": 133.64, "episode_media": {}, "episodes_timesteps_total": 13364, "policy_reward_min": {"policy_0": -1388.6223609811068}, "policy_reward_max": {"policy_0": -5.113118789188293}, "policy_reward_mean": {"policy_0": -703.0174868306613}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.113118789188293, -720.0966972861488, -1184.3181416681746, -1049.2925718855356, -12.87904284586336, -839.4673128696702, -376.67720316123086, -103.01456287352593, -1069.6151666828937, -1123.1153354074743, -894.9034492889067, -889.6459690974617, -946.9583572427055, -225.46809963369358, -742.4539436801597, -762.3639425456446, -471.2912268398862, -899.0900837414416, -739.8827076316597, -974.4815597218735, -966.3254157988612, -406.5059082763997, -485.34222785377614, -203.03773509878, -676.9565842365486, -1230.4264171727375, -55.69303567355216, -520.9275287188533, -989.0914779150683, -646.2487519132462, -677.97224523027, -847.9185721956339, -784.7676192129575, -297.2258262674208, -1287.1429188442091, -781.5352343233783, -1140.1185527479079, -1229.5194896266391, -108.57836493167729, -399.1938353557135, -969.6241618192993, -156.4856501803615, -332.50024886820927, -164.93375600652666, -194.3028404240165, -843.9265986725151, -170.69176364382778, -718.267945590253, -707.3752854379003, -1283.4320282574067, -636.8432184027354, -917.2635960935188, -730.8873546901183, -710.7460936013688, -1137.7767984963293, -1388.6223609811068, -437.0845888732212, -989.1819267458173, -981.1562199647686, -924.7056230027341, -737.1303334283825, -520.8678609544842, -468.98891526259837, -939.033994118151, -818.4171529687137, -597.5229744453319, -366.58524082536906, -426.69941229401763, -790.7697501364509, -289.3999083215567, -1263.2608043428636, -569.4875023367651, -21.181526839540226, -1013.1038881134774, -1035.7757141921313, -119.59232665932855, -930.1289394230326, -546.2943806939855, -970.9241795252503, -802.4732636559646, -1032.4154750305272, -1016.0676945866443, -396.2433177500293, -673.1953581017947, -1278.2763019663653, -712.5781586224781, -1078.0001908416134, -794.4923074398105, -895.0885732639015, -831.1067975544736, -924.6604267640345, -1270.5737190418986, -154.19954333762124, -50.878250149581035, -513.7775985198119, -1233.383652623992, -967.8245162604843, -153.46639818254988, -732.1149646280004, -205.3030758243069], "episode_lengths": [43, 150, 150, 150, 49, 150, 150, 69, 150, 150, 150, 150, 150, 112, 150, 150, 114, 150, 150, 150, 150, 150, 130, 101, 150, 150, 47, 129, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 55, 124, 150, 84, 130, 93, 78, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 43, 150, 150, 55, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 56, 123, 150, 150, 92, 150, 75], "policy_policy_0_reward": [-5.113118789188293, -720.0966972861488, -1184.3181416681746, -1049.2925718855356, -12.87904284586336, -839.4673128696702, -376.67720316123086, -103.01456287352593, -1069.6151666828937, -1123.1153354074743, -894.9034492889067, -889.6459690974617, -946.9583572427055, -225.46809963369358, -742.4539436801597, -762.3639425456446, -471.2912268398862, -899.0900837414416, -739.8827076316597, -974.4815597218735, -966.3254157988612, -406.5059082763997, -485.34222785377614, -203.03773509878, -676.9565842365486, -1230.4264171727375, -55.69303567355216, -520.9275287188533, -989.0914779150683, -646.2487519132462, -677.97224523027, -847.9185721956339, -784.7676192129575, -297.2258262674208, -1287.1429188442091, -781.5352343233783, -1140.1185527479079, -1229.5194896266391, -108.57836493167729, -399.1938353557135, -969.6241618192993, -156.4856501803615, -332.50024886820927, -164.93375600652666, -194.3028404240165, -843.9265986725151, -170.69176364382778, -718.267945590253, -707.3752854379003, -1283.4320282574067, -636.8432184027354, -917.2635960935188, -730.8873546901183, -710.7460936013688, -1137.7767984963293, -1388.6223609811068, -437.0845888732212, -989.1819267458173, -981.1562199647686, -924.7056230027341, -737.1303334283825, -520.8678609544842, -468.98891526259837, -939.033994118151, -818.4171529687137, -597.5229744453319, -366.58524082536906, -426.69941229401763, -790.7697501364509, -289.3999083215567, -1263.2608043428636, -569.4875023367651, -21.181526839540226, -1013.1038881134774, -1035.7757141921313, -119.59232665932855, -930.1289394230326, -546.2943806939855, -970.9241795252503, -802.4732636559646, -1032.4154750305272, -1016.0676945866443, -396.2433177500293, -673.1953581017947, -1278.2763019663653, -712.5781586224781, -1078.0001908416134, -794.4923074398105, -895.0885732639015, -831.1067975544736, -924.6604267640345, -1270.5737190418986, -154.19954333762124, -50.878250149581035, -513.7775985198119, -1233.383652623992, -967.8245162604843, -153.46639818254988, -732.1149646280004, -205.3030758243069]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554522916528647, "mean_inference_ms": 1.6944959278979759, "mean_action_processing_ms": 0.2801772180248124, "mean_env_wait_ms": 3.056361913975004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012090921401977539, "StateBufferConnector_ms": 0.007834672927856445, "ViewRequirementAgentConnector_ms": 0.1933889389038086}, "num_episodes": 31, "episode_return_max": -5.113118789188293, "episode_return_min": -1388.6223609811068, "episode_return_mean": -703.0174868306613, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.49608430545965, "num_env_steps_trained_throughput_per_sec": 288.49608430545965, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12135.164, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12135.088, "sample_time_ms": 1052.53, "learn_time_ms": 11016.818, "learn_throughput": 363.081, "synch_weights_time_ms": 64.913}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00013", "date": "2024-08-03_11-32-33", "timestamp": 1722664953, "time_this_iter_s": 13.878275632858276, "time_total_s": 292.9343864917755, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444343a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 292.9343864917755, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.835000000000003, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 134.74772216677667, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.4700787015259267, "policy_loss": -0.012326126120751724, "vf_loss": 2.4773888046542805, "vf_explained_var": 0.9891489413256447, "kl": 0.014509377844903307, "entropy": 1.5132034718990326, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -21.181526839540226, "episode_reward_min": -1414.3984186540656, "episode_reward_mean": -682.048667870174, "episode_len_mean": 133.2, "episode_media": {}, "episodes_timesteps_total": 13320, "policy_reward_min": {"policy_0": -1414.3984186540656}, "policy_reward_max": {"policy_0": -21.181526839540226}, "policy_reward_mean": {"policy_0": -682.048667870174}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-784.7676192129575, -297.2258262674208, -1287.1429188442091, -781.5352343233783, -1140.1185527479079, -1229.5194896266391, -108.57836493167729, -399.1938353557135, -969.6241618192993, -156.4856501803615, -332.50024886820927, -164.93375600652666, -194.3028404240165, -843.9265986725151, -170.69176364382778, -718.267945590253, -707.3752854379003, -1283.4320282574067, -636.8432184027354, -917.2635960935188, -730.8873546901183, -710.7460936013688, -1137.7767984963293, -1388.6223609811068, -437.0845888732212, -989.1819267458173, -981.1562199647686, -924.7056230027341, -737.1303334283825, -520.8678609544842, -468.98891526259837, -939.033994118151, -818.4171529687137, -597.5229744453319, -366.58524082536906, -426.69941229401763, -790.7697501364509, -289.3999083215567, -1263.2608043428636, -569.4875023367651, -21.181526839540226, -1013.1038881134774, -1035.7757141921313, -119.59232665932855, -930.1289394230326, -546.2943806939855, -970.9241795252503, -802.4732636559646, -1032.4154750305272, -1016.0676945866443, -396.2433177500293, -673.1953581017947, -1278.2763019663653, -712.5781586224781, -1078.0001908416134, -794.4923074398105, -895.0885732639015, -831.1067975544736, -924.6604267640345, -1270.5737190418986, -154.19954333762124, -50.878250149581035, -513.7775985198119, -1233.383652623992, -967.8245162604843, -153.46639818254988, -732.1149646280004, -205.3030758243069, -1414.3984186540656, -350.7495583697033, -739.9140807341514, -124.9652800385385, -122.91293679239472, -804.2442544773863, -518.2557910785702, -565.7000384548584, -1129.5689140810782, -37.384831558393735, -478.18074517311913, -779.4627394031369, -479.0829899455695, -567.7117086831812, -133.37946748076288, -114.09779487725386, -98.21294678526995, -715.2426983536633, -783.7551021123171, -1108.407069084623, -843.2208251451754, -855.8724485350124, -1286.2735647377651, -737.089734150349, -742.0110879950382, -315.2938072984881, -1076.0293505592065, -425.0069513658261, -804.6373813798754, -330.3524333405834, -802.7496675221131, -355.5278787606758], "episode_lengths": [150, 94, 150, 150, 150, 150, 55, 124, 150, 84, 130, 93, 78, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 43, 150, 150, 55, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 56, 123, 150, 150, 92, 150, 75, 150, 107, 150, 93, 90, 150, 150, 136, 150, 46, 150, 150, 150, 150, 59, 83, 56, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 133, 150, 150], "policy_policy_0_reward": [-784.7676192129575, -297.2258262674208, -1287.1429188442091, -781.5352343233783, -1140.1185527479079, -1229.5194896266391, -108.57836493167729, -399.1938353557135, -969.6241618192993, -156.4856501803615, -332.50024886820927, -164.93375600652666, -194.3028404240165, -843.9265986725151, -170.69176364382778, -718.267945590253, -707.3752854379003, -1283.4320282574067, -636.8432184027354, -917.2635960935188, -730.8873546901183, -710.7460936013688, -1137.7767984963293, -1388.6223609811068, -437.0845888732212, -989.1819267458173, -981.1562199647686, -924.7056230027341, -737.1303334283825, -520.8678609544842, -468.98891526259837, -939.033994118151, -818.4171529687137, -597.5229744453319, -366.58524082536906, -426.69941229401763, -790.7697501364509, -289.3999083215567, -1263.2608043428636, -569.4875023367651, -21.181526839540226, -1013.1038881134774, -1035.7757141921313, -119.59232665932855, -930.1289394230326, -546.2943806939855, -970.9241795252503, -802.4732636559646, -1032.4154750305272, -1016.0676945866443, -396.2433177500293, -673.1953581017947, -1278.2763019663653, -712.5781586224781, -1078.0001908416134, -794.4923074398105, -895.0885732639015, -831.1067975544736, -924.6604267640345, -1270.5737190418986, -154.19954333762124, -50.878250149581035, -513.7775985198119, -1233.383652623992, -967.8245162604843, -153.46639818254988, -732.1149646280004, -205.3030758243069, -1414.3984186540656, -350.7495583697033, -739.9140807341514, -124.9652800385385, -122.91293679239472, -804.2442544773863, -518.2557910785702, -565.7000384548584, -1129.5689140810782, -37.384831558393735, -478.18074517311913, -779.4627394031369, -479.0829899455695, -567.7117086831812, -133.37946748076288, -114.09779487725386, -98.21294678526995, -715.2426983536633, -783.7551021123171, -1108.407069084623, -843.2208251451754, -855.8724485350124, -1286.2735647377651, -737.089734150349, -742.0110879950382, -315.2938072984881, -1076.0293505592065, -425.0069513658261, -804.6373813798754, -330.3524333405834, -802.7496675221131, -355.5278787606758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5557808693233476, "mean_inference_ms": 1.6947995771875393, "mean_action_processing_ms": 0.2802297393149228, "mean_env_wait_ms": 3.0596692025314742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013227462768554688, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.1972496509552002}, "num_episodes": 32, "episode_return_max": -21.181526839540226, "episode_return_min": -1414.3984186540656, "episode_return_mean": -682.048667870174, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.3373047008445, "num_env_steps_trained_throughput_per_sec": 301.3373047008445, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12461.823, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12461.747, "sample_time_ms": 1055.119, "learn_time_ms": 11339.531, "learn_throughput": 352.748, "synch_weights_time_ms": 66.253}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00013", "date": "2024-08-03_11-32-46", "timestamp": 1722664966, "time_this_iter_s": 13.289355993270874, "time_total_s": 306.2237424850464, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244437520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 306.2237424850464, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.905263157894737, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 165.3162434856097, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.1761565446853637, "policy_loss": -0.013553841804241528, "vf_loss": 2.1837156816075245, "vf_explained_var": 0.9922467960665623, "kl": 0.016341033804140655, "entropy": 1.3587667641540369, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -4.128285977730926, "episode_reward_min": -1414.3984186540656, "episode_reward_mean": -668.2502858923696, "episode_len_mean": 133.93, "episode_media": {}, "episodes_timesteps_total": 13393, "policy_reward_min": {"policy_0": -1414.3984186540656}, "policy_reward_max": {"policy_0": -4.128285977730926}, "policy_reward_mean": {"policy_0": -668.2502858923696}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-737.1303334283825, -520.8678609544842, -468.98891526259837, -939.033994118151, -818.4171529687137, -597.5229744453319, -366.58524082536906, -426.69941229401763, -790.7697501364509, -289.3999083215567, -1263.2608043428636, -569.4875023367651, -21.181526839540226, -1013.1038881134774, -1035.7757141921313, -119.59232665932855, -930.1289394230326, -546.2943806939855, -970.9241795252503, -802.4732636559646, -1032.4154750305272, -1016.0676945866443, -396.2433177500293, -673.1953581017947, -1278.2763019663653, -712.5781586224781, -1078.0001908416134, -794.4923074398105, -895.0885732639015, -831.1067975544736, -924.6604267640345, -1270.5737190418986, -154.19954333762124, -50.878250149581035, -513.7775985198119, -1233.383652623992, -967.8245162604843, -153.46639818254988, -732.1149646280004, -205.3030758243069, -1414.3984186540656, -350.7495583697033, -739.9140807341514, -124.9652800385385, -122.91293679239472, -804.2442544773863, -518.2557910785702, -565.7000384548584, -1129.5689140810782, -37.384831558393735, -478.18074517311913, -779.4627394031369, -479.0829899455695, -567.7117086831812, -133.37946748076288, -114.09779487725386, -98.21294678526995, -715.2426983536633, -783.7551021123171, -1108.407069084623, -843.2208251451754, -855.8724485350124, -1286.2735647377651, -737.089734150349, -742.0110879950382, -315.2938072984881, -1076.0293505592065, -425.0069513658261, -804.6373813798754, -330.3524333405834, -802.7496675221131, -355.5278787606758, -860.7931999298062, -342.98475044194583, -70.77329767698482, -640.7503427360073, -937.5188672830407, -467.9032245501613, -1142.255666681336, -21.522489544446206, -985.451712851364, -398.93881880712775, -614.7233114483257, -1097.8087441877974, -289.97286604232147, -766.9246507931387, -886.5912843107856, -161.75918365592557, -769.3677365199795, -452.056729802957, -1034.9763442031333, -872.7138894810766, -1075.1761781762173, -775.9494883248736, -4.128285977730926, -811.8186426501709, -1030.7361932532888, -938.089175172672, -833.1495485611655, -759.217080217728], "episode_lengths": [150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 43, 150, 150, 55, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 56, 123, 150, 150, 92, 150, 75, 150, 107, 150, 93, 90, 150, 150, 136, 150, 46, 150, 150, 150, 150, 59, 83, 56, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 133, 150, 150, 150, 150, 67, 150, 150, 150, 150, 41, 150, 114, 150, 150, 150, 150, 150, 67, 150, 142, 150, 150, 150, 150, 39, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-737.1303334283825, -520.8678609544842, -468.98891526259837, -939.033994118151, -818.4171529687137, -597.5229744453319, -366.58524082536906, -426.69941229401763, -790.7697501364509, -289.3999083215567, -1263.2608043428636, -569.4875023367651, -21.181526839540226, -1013.1038881134774, -1035.7757141921313, -119.59232665932855, -930.1289394230326, -546.2943806939855, -970.9241795252503, -802.4732636559646, -1032.4154750305272, -1016.0676945866443, -396.2433177500293, -673.1953581017947, -1278.2763019663653, -712.5781586224781, -1078.0001908416134, -794.4923074398105, -895.0885732639015, -831.1067975544736, -924.6604267640345, -1270.5737190418986, -154.19954333762124, -50.878250149581035, -513.7775985198119, -1233.383652623992, -967.8245162604843, -153.46639818254988, -732.1149646280004, -205.3030758243069, -1414.3984186540656, -350.7495583697033, -739.9140807341514, -124.9652800385385, -122.91293679239472, -804.2442544773863, -518.2557910785702, -565.7000384548584, -1129.5689140810782, -37.384831558393735, -478.18074517311913, -779.4627394031369, -479.0829899455695, -567.7117086831812, -133.37946748076288, -114.09779487725386, -98.21294678526995, -715.2426983536633, -783.7551021123171, -1108.407069084623, -843.2208251451754, -855.8724485350124, -1286.2735647377651, -737.089734150349, -742.0110879950382, -315.2938072984881, -1076.0293505592065, -425.0069513658261, -804.6373813798754, -330.3524333405834, -802.7496675221131, -355.5278787606758, -860.7931999298062, -342.98475044194583, -70.77329767698482, -640.7503427360073, -937.5188672830407, -467.9032245501613, -1142.255666681336, -21.522489544446206, -985.451712851364, -398.93881880712775, -614.7233114483257, -1097.8087441877974, -289.97286604232147, -766.9246507931387, -886.5912843107856, -161.75918365592557, -769.3677365199795, -452.056729802957, -1034.9763442031333, -872.7138894810766, -1075.1761781762173, -775.9494883248736, -4.128285977730926, -811.8186426501709, -1030.7361932532888, -938.089175172672, -833.1495485611655, -759.217080217728]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552255949040635, "mean_inference_ms": 1.6948121729629322, "mean_action_processing_ms": 0.2801362449902179, "mean_env_wait_ms": 3.058360450909185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013063669204711914, "StateBufferConnector_ms": 0.007972478866577148, "ViewRequirementAgentConnector_ms": 0.19651222229003906}, "num_episodes": 28, "episode_return_max": -4.128285977730926, "episode_return_min": -1414.3984186540656, "episode_return_mean": -668.2502858923696, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.93405375091226, "num_env_steps_trained_throughput_per_sec": 301.93405375091226, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12858.244, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12858.168, "sample_time_ms": 1055.326, "learn_time_ms": 11735.137, "learn_throughput": 340.857, "synch_weights_time_ms": 66.87}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00013", "date": "2024-08-03_11-32-59", "timestamp": 1722664979, "time_this_iter_s": 13.261436223983765, "time_total_s": 319.48517870903015, "pid": 527291, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b36d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 319.48517870903015, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.921052631578947, "ram_util_percent": 27.8}}
