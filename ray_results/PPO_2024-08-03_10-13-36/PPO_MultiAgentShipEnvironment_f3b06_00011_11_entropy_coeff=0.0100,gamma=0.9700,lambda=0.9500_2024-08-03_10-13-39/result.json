{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9026555221527814, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.67519701719284, "policy_loss": -0.005914581254667913, "vf_loss": 9.693547585606575, "vf_explained_var": 0.0120015657817324, "kl": 0.009039036271292388, "entropy": 1.4243765145540237, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -154.747777813838, "episode_reward_min": -1183.8088402924209, "episode_reward_mean": -644.6718044626939, "episode_len_mean": 138.47826086956522, "episode_media": {}, "episodes_timesteps_total": 3185, "policy_reward_min": {"policy_0": -1183.8088402924209}, "policy_reward_max": {"policy_0": -154.747777813838}, "policy_reward_mean": {"policy_0": -644.6718044626939}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1183.8088402924209, -435.5872480294288, -812.6057889685272, -828.974738446692, -154.8087903504612, -723.5727410566126, -630.7811550497338, -396.724271775265, -505.43915030129233, -760.4577432325317, -154.747777813838, -878.1302448261181, -528.3660894705464, -925.3238077198278, -876.5512307011688, -438.22407647322564, -396.7637966374102, -291.00209733953494, -760.9795809738479, -1070.8178733118182, -310.3138714256106, -989.6750231691561, -773.7955652768885], "episode_lengths": [150, 111, 150, 150, 80, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 127, 150, 150, 101, 150, 150], "policy_policy_0_reward": [-1183.8088402924209, -435.5872480294288, -812.6057889685272, -828.974738446692, -154.8087903504612, -723.5727410566126, -630.7811550497338, -396.724271775265, -505.43915030129233, -760.4577432325317, -154.747777813838, -878.1302448261181, -528.3660894705464, -925.3238077198278, -876.5512307011688, -438.22407647322564, -396.7637966374102, -291.00209733953494, -760.9795809738479, -1070.8178733118182, -310.3138714256106, -989.6750231691561, -773.7955652768885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5625649309434072, "mean_inference_ms": 1.6459020326077458, "mean_action_processing_ms": 0.2804770646347533, "mean_env_wait_ms": 2.9293256780613914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011056402455205503, "StateBufferConnector_ms": 0.007982875989831013, "ViewRequirementAgentConnector_ms": 0.17650438391644022}, "num_episodes": 23, "episode_return_max": -154.747777813838, "episode_return_min": -1183.8088402924209, "episode_return_mean": -644.6718044626939, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.48339529294105, "num_env_steps_trained_throughput_per_sec": 301.48339529294105, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13267.738, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13267.678, "sample_time_ms": 1012.423, "learn_time_ms": 12173.347, "learn_throughput": 328.587, "synch_weights_time_ms": 81.171}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00011", "date": "2024-08-03_11-16-19", "timestamp": 1722663979, "time_this_iter_s": 13.279568672180176, "time_total_s": 13.279568672180176, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d3eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.279568672180176, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 13.11578947368421, "ram_util_percent": 27.594736842105267}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0608476889319718, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.550281188885371, "policy_loss": -0.008377018995815888, "vf_loss": 9.570148028930028, "vf_explained_var": 0.04120287212232749, "kl": 0.011323700289540285, "entropy": 1.3754605566461882, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -12.877601589256265, "episode_reward_min": -1183.8088402924209, "episode_reward_mean": -609.7499071598802, "episode_len_mean": 132.71428571428572, "episode_media": {}, "episodes_timesteps_total": 6503, "policy_reward_min": {"policy_0": -1183.8088402924209}, "policy_reward_max": {"policy_0": -12.877601589256265}, "policy_reward_mean": {"policy_0": -609.7499071598802}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1183.8088402924209, -435.5872480294288, -812.6057889685272, -828.974738446692, -154.8087903504612, -723.5727410566126, -630.7811550497338, -396.724271775265, -505.43915030129233, -760.4577432325317, -154.747777813838, -878.1302448261181, -528.3660894705464, -925.3238077198278, -876.5512307011688, -438.22407647322564, -396.7637966374102, -291.00209733953494, -760.9795809738479, -1070.8178733118182, -310.3138714256106, -989.6750231691561, -773.7955652768885, -66.19811694688183, -924.2999029793748, -887.3052288855812, -508.4543970057707, -492.96079880516163, -245.44574419599743, -921.549167591525, -731.8323412244717, -914.0031672982433, -402.5058485373099, -870.1229028510835, -975.4755150709024, -143.4237027647929, -703.538223825562, -64.43920554781391, -1059.6267374177305, -292.3862701114227, -953.2338320966912, -715.5202718477765, -1024.4818320157117, -163.1015695554705, -12.877601589256265, -460.780023221216, -803.5398215757145, -544.786275932917, -168.4054492977911], "episode_lengths": [150, 111, 150, 150, 80, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 127, 150, 150, 101, 150, 150, 73, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 85, 150, 71, 150, 111, 150, 150, 150, 83, 38, 150, 150, 150, 71], "policy_policy_0_reward": [-1183.8088402924209, -435.5872480294288, -812.6057889685272, -828.974738446692, -154.8087903504612, -723.5727410566126, -630.7811550497338, -396.724271775265, -505.43915030129233, -760.4577432325317, -154.747777813838, -878.1302448261181, -528.3660894705464, -925.3238077198278, -876.5512307011688, -438.22407647322564, -396.7637966374102, -291.00209733953494, -760.9795809738479, -1070.8178733118182, -310.3138714256106, -989.6750231691561, -773.7955652768885, -66.19811694688183, -924.2999029793748, -887.3052288855812, -508.4543970057707, -492.96079880516163, -245.44574419599743, -921.549167591525, -731.8323412244717, -914.0031672982433, -402.5058485373099, -870.1229028510835, -975.4755150709024, -143.4237027647929, -703.538223825562, -64.43920554781391, -1059.6267374177305, -292.3862701114227, -953.2338320966912, -715.5202718477765, -1024.4818320157117, -163.1015695554705, -12.877601589256265, -460.780023221216, -803.5398215757145, -544.786275932917, -168.4054492977911]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5610841986032852, "mean_inference_ms": 1.6601571744218884, "mean_action_processing_ms": 0.282220704788255, "mean_env_wait_ms": 2.9437808564285817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013163138409050144, "StateBufferConnector_ms": 0.008171431872309471, "ViewRequirementAgentConnector_ms": 0.18053006152717435}, "num_episodes": 26, "episode_return_max": -12.877601589256265, "episode_return_min": -1183.8088402924209, "episode_return_mean": -609.7499071598802, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.9337529379447, "num_env_steps_trained_throughput_per_sec": 297.9337529379447, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13346.777, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13346.706, "sample_time_ms": 1013.71, "learn_time_ms": 12257.784, "learn_throughput": 326.323, "synch_weights_time_ms": 74.355}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00011", "date": "2024-08-03_11-16-32", "timestamp": 1722663992, "time_this_iter_s": 13.438263177871704, "time_total_s": 26.71783185005188, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245761c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.71783185005188, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.355, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8981829238745074, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.359750079115232, "policy_loss": -0.007721018941568522, "vf_loss": 9.378495105107625, "vf_explained_var": 0.12097584002961716, "kl": 0.011254142464955904, "entropy": 1.3274822050084671, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -12.877601589256265, "episode_reward_min": -1183.8088402924209, "episode_reward_mean": -606.9312982221584, "episode_len_mean": 132.01298701298703, "episode_media": {}, "episodes_timesteps_total": 10165, "policy_reward_min": {"policy_0": -1183.8088402924209}, "policy_reward_max": {"policy_0": -12.877601589256265}, "policy_reward_mean": {"policy_0": -606.9312982221584}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1183.8088402924209, -435.5872480294288, -812.6057889685272, -828.974738446692, -154.8087903504612, -723.5727410566126, -630.7811550497338, -396.724271775265, -505.43915030129233, -760.4577432325317, -154.747777813838, -878.1302448261181, -528.3660894705464, -925.3238077198278, -876.5512307011688, -438.22407647322564, -396.7637966374102, -291.00209733953494, -760.9795809738479, -1070.8178733118182, -310.3138714256106, -989.6750231691561, -773.7955652768885, -66.19811694688183, -924.2999029793748, -887.3052288855812, -508.4543970057707, -492.96079880516163, -245.44574419599743, -921.549167591525, -731.8323412244717, -914.0031672982433, -402.5058485373099, -870.1229028510835, -975.4755150709024, -143.4237027647929, -703.538223825562, -64.43920554781391, -1059.6267374177305, -292.3862701114227, -953.2338320966912, -715.5202718477765, -1024.4818320157117, -163.1015695554705, -12.877601589256265, -460.780023221216, -803.5398215757145, -544.786275932917, -168.4054492977911, -911.6107835197441, -794.586676273391, -176.1307615188492, -467.37860460291057, -521.4108191882108, -39.205651299269874, -954.7994657074124, -361.43842307930817, -1117.464568328807, -236.91745318750108, -14.838459446658938, -429.2419279824695, -616.9788893739283, -477.425675940614, -461.58618070488234, -667.8370620207335, -640.0109468640372, -114.66265874456803, -942.5591375865573, -990.533075657021, -755.9329679557372, -612.813090063615, -949.2876091325036, -1146.614798352201, -735.5686042955824, -78.27212585570597, -745.0586584086577, -895.7994371811787], "episode_lengths": [150, 111, 150, 150, 80, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 127, 150, 150, 101, 150, 150, 73, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 85, 150, 71, 150, 111, 150, 150, 150, 83, 38, 150, 150, 150, 71, 150, 150, 97, 150, 150, 51, 150, 108, 150, 101, 43, 106, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150], "policy_policy_0_reward": [-1183.8088402924209, -435.5872480294288, -812.6057889685272, -828.974738446692, -154.8087903504612, -723.5727410566126, -630.7811550497338, -396.724271775265, -505.43915030129233, -760.4577432325317, -154.747777813838, -878.1302448261181, -528.3660894705464, -925.3238077198278, -876.5512307011688, -438.22407647322564, -396.7637966374102, -291.00209733953494, -760.9795809738479, -1070.8178733118182, -310.3138714256106, -989.6750231691561, -773.7955652768885, -66.19811694688183, -924.2999029793748, -887.3052288855812, -508.4543970057707, -492.96079880516163, -245.44574419599743, -921.549167591525, -731.8323412244717, -914.0031672982433, -402.5058485373099, -870.1229028510835, -975.4755150709024, -143.4237027647929, -703.538223825562, -64.43920554781391, -1059.6267374177305, -292.3862701114227, -953.2338320966912, -715.5202718477765, -1024.4818320157117, -163.1015695554705, -12.877601589256265, -460.780023221216, -803.5398215757145, -544.786275932917, -168.4054492977911, -911.6107835197441, -794.586676273391, -176.1307615188492, -467.37860460291057, -521.4108191882108, -39.205651299269874, -954.7994657074124, -361.43842307930817, -1117.464568328807, -236.91745318750108, -14.838459446658938, -429.2419279824695, -616.9788893739283, -477.425675940614, -461.58618070488234, -667.8370620207335, -640.0109468640372, -114.66265874456803, -942.5591375865573, -990.533075657021, -755.9329679557372, -612.813090063615, -949.2876091325036, -1146.614798352201, -735.5686042955824, -78.27212585570597, -745.0586584086577, -895.7994371811787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620923834931754, "mean_inference_ms": 1.6701498505747825, "mean_action_processing_ms": 0.28354031785761663, "mean_env_wait_ms": 2.9569869819571113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013012080997615666, "StateBufferConnector_ms": 0.008314615720278256, "ViewRequirementAgentConnector_ms": 0.184505016772778}, "num_episodes": 28, "episode_return_max": -12.877601589256265, "episode_return_min": -1183.8088402924209, "episode_return_mean": -606.9312982221584, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.07761798597073, "num_env_steps_trained_throughput_per_sec": 302.07761798597073, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13311.732, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13311.664, "sample_time_ms": 1017.958, "learn_time_ms": 12221.873, "learn_throughput": 327.282, "synch_weights_time_ms": 71.01}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00011", "date": "2024-08-03_11-16-46", "timestamp": 1722664006, "time_this_iter_s": 13.25338888168335, "time_total_s": 39.97122073173523, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245744f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.97122073173523, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.772222222222219, "ram_util_percent": 27.66111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.261197233820955, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.366989183425904, "policy_loss": -0.007799935495131649, "vf_loss": 9.385772900780042, "vf_explained_var": 0.1545489052310586, "kl": 0.011477694134441663, "entropy": 1.3279315603276094, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -12.877601589256265, "episode_reward_min": -1157.6285050160363, "episode_reward_mean": -620.9212146747861, "episode_len_mean": 135.17, "episode_media": {}, "episodes_timesteps_total": 13517, "policy_reward_min": {"policy_0": -1157.6285050160363}, "policy_reward_max": {"policy_0": -12.877601589256265}, "policy_reward_mean": {"policy_0": -620.9212146747861}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-723.5727410566126, -630.7811550497338, -396.724271775265, -505.43915030129233, -760.4577432325317, -154.747777813838, -878.1302448261181, -528.3660894705464, -925.3238077198278, -876.5512307011688, -438.22407647322564, -396.7637966374102, -291.00209733953494, -760.9795809738479, -1070.8178733118182, -310.3138714256106, -989.6750231691561, -773.7955652768885, -66.19811694688183, -924.2999029793748, -887.3052288855812, -508.4543970057707, -492.96079880516163, -245.44574419599743, -921.549167591525, -731.8323412244717, -914.0031672982433, -402.5058485373099, -870.1229028510835, -975.4755150709024, -143.4237027647929, -703.538223825562, -64.43920554781391, -1059.6267374177305, -292.3862701114227, -953.2338320966912, -715.5202718477765, -1024.4818320157117, -163.1015695554705, -12.877601589256265, -460.780023221216, -803.5398215757145, -544.786275932917, -168.4054492977911, -911.6107835197441, -794.586676273391, -176.1307615188492, -467.37860460291057, -521.4108191882108, -39.205651299269874, -954.7994657074124, -361.43842307930817, -1117.464568328807, -236.91745318750108, -14.838459446658938, -429.2419279824695, -616.9788893739283, -477.425675940614, -461.58618070488234, -667.8370620207335, -640.0109468640372, -114.66265874456803, -942.5591375865573, -990.533075657021, -755.9329679557372, -612.813090063615, -949.2876091325036, -1146.614798352201, -735.5686042955824, -78.27212585570597, -745.0586584086577, -895.7994371811787, -924.6847793064734, -904.7892686951063, -1001.896482697265, -1020.882047719978, -755.9823604664554, -600.3978465984532, -842.7993404912596, -1030.188706231313, -63.309439377977455, -905.5408034780438, -463.29849126202953, -108.09475894784757, -490.1007597529768, -741.2522671990168, -598.5435792297806, -724.8887899578828, -642.5897106712887, -1157.6285050160363, -653.7887799174633, -414.9590999655866, -780.7405775687383, -229.34376886201915, -642.6284803044902, -914.8642683792262, -415.0001557481131, -597.972537588395, -612.0517769951782, -535.9795280315707], "episode_lengths": [150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 127, 150, 150, 101, 150, 150, 73, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 85, 150, 71, 150, 111, 150, 150, 150, 83, 38, 150, 150, 150, 71, 150, 150, 97, 150, 150, 51, 150, 108, 150, 101, 43, 106, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 138, 71, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 131, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-723.5727410566126, -630.7811550497338, -396.724271775265, -505.43915030129233, -760.4577432325317, -154.747777813838, -878.1302448261181, -528.3660894705464, -925.3238077198278, -876.5512307011688, -438.22407647322564, -396.7637966374102, -291.00209733953494, -760.9795809738479, -1070.8178733118182, -310.3138714256106, -989.6750231691561, -773.7955652768885, -66.19811694688183, -924.2999029793748, -887.3052288855812, -508.4543970057707, -492.96079880516163, -245.44574419599743, -921.549167591525, -731.8323412244717, -914.0031672982433, -402.5058485373099, -870.1229028510835, -975.4755150709024, -143.4237027647929, -703.538223825562, -64.43920554781391, -1059.6267374177305, -292.3862701114227, -953.2338320966912, -715.5202718477765, -1024.4818320157117, -163.1015695554705, -12.877601589256265, -460.780023221216, -803.5398215757145, -544.786275932917, -168.4054492977911, -911.6107835197441, -794.586676273391, -176.1307615188492, -467.37860460291057, -521.4108191882108, -39.205651299269874, -954.7994657074124, -361.43842307930817, -1117.464568328807, -236.91745318750108, -14.838459446658938, -429.2419279824695, -616.9788893739283, -477.425675940614, -461.58618070488234, -667.8370620207335, -640.0109468640372, -114.66265874456803, -942.5591375865573, -990.533075657021, -755.9329679557372, -612.813090063615, -949.2876091325036, -1146.614798352201, -735.5686042955824, -78.27212585570597, -745.0586584086577, -895.7994371811787, -924.6847793064734, -904.7892686951063, -1001.896482697265, -1020.882047719978, -755.9823604664554, -600.3978465984532, -842.7993404912596, -1030.188706231313, -63.309439377977455, -905.5408034780438, -463.29849126202953, -108.09475894784757, -490.1007597529768, -741.2522671990168, -598.5435792297806, -724.8887899578828, -642.5897106712887, -1157.6285050160363, -653.7887799174633, -414.9590999655866, -780.7405775687383, -229.34376886201915, -642.6284803044902, -914.8642683792262, -415.0001557481131, -597.972537588395, -612.0517769951782, -535.9795280315707]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.561382197945337, "mean_inference_ms": 1.673489897385056, "mean_action_processing_ms": 0.28394872877104116, "mean_env_wait_ms": 2.958396056303404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013422727584838867, "StateBufferConnector_ms": 0.008421659469604492, "ViewRequirementAgentConnector_ms": 0.18531131744384766}, "num_episodes": 28, "episode_return_max": -12.877601589256265, "episode_return_min": -1157.6285050160363, "episode_return_mean": -620.9212146747861, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.56709100356824, "num_env_steps_trained_throughput_per_sec": 302.56709100356824, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13288.854, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13288.783, "sample_time_ms": 1013.964, "learn_time_ms": 12205.8, "learn_throughput": 327.713, "synch_weights_time_ms": 68.189}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00011", "date": "2024-08-03_11-16-59", "timestamp": 1722664019, "time_this_iter_s": 13.234409809112549, "time_total_s": 53.20563054084778, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245762320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 53.20563054084778, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.673684210526316, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5932549706970653, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.326551108558972, "policy_loss": -0.01154792562010698, "vf_loss": 9.34812676012516, "vf_explained_var": 0.25773446715126436, "kl": 0.014630098823545271, "entropy": 1.2953714386870463, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -9.436358579930705, "episode_reward_min": -1157.6285050160363, "episode_reward_mean": -626.7777306213401, "episode_len_mean": 135.12, "episode_media": {}, "episodes_timesteps_total": 13512, "policy_reward_min": {"policy_0": -1157.6285050160363}, "policy_reward_max": {"policy_0": -9.436358579930705}, "policy_reward_mean": {"policy_0": -626.7777306213401}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-703.538223825562, -64.43920554781391, -1059.6267374177305, -292.3862701114227, -953.2338320966912, -715.5202718477765, -1024.4818320157117, -163.1015695554705, -12.877601589256265, -460.780023221216, -803.5398215757145, -544.786275932917, -168.4054492977911, -911.6107835197441, -794.586676273391, -176.1307615188492, -467.37860460291057, -521.4108191882108, -39.205651299269874, -954.7994657074124, -361.43842307930817, -1117.464568328807, -236.91745318750108, -14.838459446658938, -429.2419279824695, -616.9788893739283, -477.425675940614, -461.58618070488234, -667.8370620207335, -640.0109468640372, -114.66265874456803, -942.5591375865573, -990.533075657021, -755.9329679557372, -612.813090063615, -949.2876091325036, -1146.614798352201, -735.5686042955824, -78.27212585570597, -745.0586584086577, -895.7994371811787, -924.6847793064734, -904.7892686951063, -1001.896482697265, -1020.882047719978, -755.9823604664554, -600.3978465984532, -842.7993404912596, -1030.188706231313, -63.309439377977455, -905.5408034780438, -463.29849126202953, -108.09475894784757, -490.1007597529768, -741.2522671990168, -598.5435792297806, -724.8887899578828, -642.5897106712887, -1157.6285050160363, -653.7887799174633, -414.9590999655866, -780.7405775687383, -229.34376886201915, -642.6284803044902, -914.8642683792262, -415.0001557481131, -597.972537588395, -612.0517769951782, -535.9795280315707, -881.9344218967013, -362.2548150103831, -9.436358579930705, -763.0401568278602, -437.5566844781921, -433.04261521692445, -264.5750321701845, -596.4253354740064, -742.3584339929992, -848.677401961077, -224.2523510980181, -693.8972324385298, -274.4492141838083, -806.6729118637035, -737.6321126010145, -933.0723099746315, -433.4002723473668, -488.1140203675301, -639.3921793740302, -964.536988513784, -907.1833438063109, -828.6236385041158, -913.6700666370198, -691.3175685102964, -673.8408625153046, -835.7520815603987, -578.1170639624797, -899.2440591184202, -1021.4834938257422, -467.43567432989585, -729.5058242262552], "episode_lengths": [150, 71, 150, 111, 150, 150, 150, 83, 38, 150, 150, 150, 71, 150, 150, 97, 150, 150, 51, 150, 108, 150, 101, 43, 106, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 138, 71, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 131, 150, 150, 150, 150, 150, 150, 150, 48, 143, 124, 150, 82, 150, 150, 150, 104, 150, 114, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 128, 150], "policy_policy_0_reward": [-703.538223825562, -64.43920554781391, -1059.6267374177305, -292.3862701114227, -953.2338320966912, -715.5202718477765, -1024.4818320157117, -163.1015695554705, -12.877601589256265, -460.780023221216, -803.5398215757145, -544.786275932917, -168.4054492977911, -911.6107835197441, -794.586676273391, -176.1307615188492, -467.37860460291057, -521.4108191882108, -39.205651299269874, -954.7994657074124, -361.43842307930817, -1117.464568328807, -236.91745318750108, -14.838459446658938, -429.2419279824695, -616.9788893739283, -477.425675940614, -461.58618070488234, -667.8370620207335, -640.0109468640372, -114.66265874456803, -942.5591375865573, -990.533075657021, -755.9329679557372, -612.813090063615, -949.2876091325036, -1146.614798352201, -735.5686042955824, -78.27212585570597, -745.0586584086577, -895.7994371811787, -924.6847793064734, -904.7892686951063, -1001.896482697265, -1020.882047719978, -755.9823604664554, -600.3978465984532, -842.7993404912596, -1030.188706231313, -63.309439377977455, -905.5408034780438, -463.29849126202953, -108.09475894784757, -490.1007597529768, -741.2522671990168, -598.5435792297806, -724.8887899578828, -642.5897106712887, -1157.6285050160363, -653.7887799174633, -414.9590999655866, -780.7405775687383, -229.34376886201915, -642.6284803044902, -914.8642683792262, -415.0001557481131, -597.972537588395, -612.0517769951782, -535.9795280315707, -881.9344218967013, -362.2548150103831, -9.436358579930705, -763.0401568278602, -437.5566844781921, -433.04261521692445, -264.5750321701845, -596.4253354740064, -742.3584339929992, -848.677401961077, -224.2523510980181, -693.8972324385298, -274.4492141838083, -806.6729118637035, -737.6321126010145, -933.0723099746315, -433.4002723473668, -488.1140203675301, -639.3921793740302, -964.536988513784, -907.1833438063109, -828.6236385041158, -913.6700666370198, -691.3175685102964, -673.8408625153046, -835.7520815603987, -578.1170639624797, -899.2440591184202, -1021.4834938257422, -467.43567432989585, -729.5058242262552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.561106520962521, "mean_inference_ms": 1.6786830350277113, "mean_action_processing_ms": 0.284070056133846, "mean_env_wait_ms": 2.9629736505527706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013473033905029297, "StateBufferConnector_ms": 0.008709430694580078, "ViewRequirementAgentConnector_ms": 0.19219708442687988}, "num_episodes": 31, "episode_return_max": -9.436358579930705, "episode_return_min": -1157.6285050160363, "episode_return_mean": -626.7777306213401, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.75858544607377, "num_env_steps_trained_throughput_per_sec": 353.75858544607377, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12892.515, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12892.444, "sample_time_ms": 1012.567, "learn_time_ms": 11812.721, "learn_throughput": 338.618, "synch_weights_time_ms": 66.324}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00011", "date": "2024-08-03_11-17-10", "timestamp": 1722664030, "time_this_iter_s": 11.320345163345337, "time_total_s": 64.52597570419312, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245761c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 64.52597570419312, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 14.906249999999998, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1677813955272236, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.66527700126171, "policy_loss": -0.012216111381227772, "vf_loss": 9.68842583199342, "vf_explained_var": 0.2994690298413237, "kl": 0.016272309235212865, "entropy": 1.4187176177899044, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -9.436358579930705, "episode_reward_min": -1205.1831425441126, "episode_reward_mean": -691.908678223047, "episode_len_mean": 140.19, "episode_media": {}, "episodes_timesteps_total": 14019, "policy_reward_min": {"policy_0": -1205.1831425441126}, "policy_reward_max": {"policy_0": -9.436358579930705}, "policy_reward_mean": {"policy_0": -691.908678223047}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-667.8370620207335, -640.0109468640372, -114.66265874456803, -942.5591375865573, -990.533075657021, -755.9329679557372, -612.813090063615, -949.2876091325036, -1146.614798352201, -735.5686042955824, -78.27212585570597, -745.0586584086577, -895.7994371811787, -924.6847793064734, -904.7892686951063, -1001.896482697265, -1020.882047719978, -755.9823604664554, -600.3978465984532, -842.7993404912596, -1030.188706231313, -63.309439377977455, -905.5408034780438, -463.29849126202953, -108.09475894784757, -490.1007597529768, -741.2522671990168, -598.5435792297806, -724.8887899578828, -642.5897106712887, -1157.6285050160363, -653.7887799174633, -414.9590999655866, -780.7405775687383, -229.34376886201915, -642.6284803044902, -914.8642683792262, -415.0001557481131, -597.972537588395, -612.0517769951782, -535.9795280315707, -881.9344218967013, -362.2548150103831, -9.436358579930705, -763.0401568278602, -437.5566844781921, -433.04261521692445, -264.5750321701845, -596.4253354740064, -742.3584339929992, -848.677401961077, -224.2523510980181, -693.8972324385298, -274.4492141838083, -806.6729118637035, -737.6321126010145, -933.0723099746315, -433.4002723473668, -488.1140203675301, -639.3921793740302, -964.536988513784, -907.1833438063109, -828.6236385041158, -913.6700666370198, -691.3175685102964, -673.8408625153046, -835.7520815603987, -578.1170639624797, -899.2440591184202, -1021.4834938257422, -467.43567432989585, -729.5058242262552, -783.8131528488357, -626.6912170385637, -12.291245492276243, -848.8297095666717, -1130.404889790221, -1046.4367396445298, -566.7643309950761, -1205.1831425441126, -858.0192173388782, -618.341495314375, -926.0845394437179, -492.61381618174477, -1066.7598747819802, -694.7398297052581, -69.88367967783859, -657.7133635257134, -985.0836811227634, -796.7170261624202, -728.9477798977726, -1166.6321818061392, -98.00184346155984, -866.6491635860699, -431.4987561750578, -1054.8579129297243, -953.2819284723411, -539.4104142649555, -1034.1612976935266, -801.0139848976069], "episode_lengths": [150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 138, 71, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 131, 150, 150, 150, 150, 150, 150, 150, 48, 143, 124, 150, 82, 150, 150, 150, 104, 150, 114, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 128, 150, 150, 150, 37, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 64, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-667.8370620207335, -640.0109468640372, -114.66265874456803, -942.5591375865573, -990.533075657021, -755.9329679557372, -612.813090063615, -949.2876091325036, -1146.614798352201, -735.5686042955824, -78.27212585570597, -745.0586584086577, -895.7994371811787, -924.6847793064734, -904.7892686951063, -1001.896482697265, -1020.882047719978, -755.9823604664554, -600.3978465984532, -842.7993404912596, -1030.188706231313, -63.309439377977455, -905.5408034780438, -463.29849126202953, -108.09475894784757, -490.1007597529768, -741.2522671990168, -598.5435792297806, -724.8887899578828, -642.5897106712887, -1157.6285050160363, -653.7887799174633, -414.9590999655866, -780.7405775687383, -229.34376886201915, -642.6284803044902, -914.8642683792262, -415.0001557481131, -597.972537588395, -612.0517769951782, -535.9795280315707, -881.9344218967013, -362.2548150103831, -9.436358579930705, -763.0401568278602, -437.5566844781921, -433.04261521692445, -264.5750321701845, -596.4253354740064, -742.3584339929992, -848.677401961077, -224.2523510980181, -693.8972324385298, -274.4492141838083, -806.6729118637035, -737.6321126010145, -933.0723099746315, -433.4002723473668, -488.1140203675301, -639.3921793740302, -964.536988513784, -907.1833438063109, -828.6236385041158, -913.6700666370198, -691.3175685102964, -673.8408625153046, -835.7520815603987, -578.1170639624797, -899.2440591184202, -1021.4834938257422, -467.43567432989585, -729.5058242262552, -783.8131528488357, -626.6912170385637, -12.291245492276243, -848.8297095666717, -1130.404889790221, -1046.4367396445298, -566.7643309950761, -1205.1831425441126, -858.0192173388782, -618.341495314375, -926.0845394437179, -492.61381618174477, -1066.7598747819802, -694.7398297052581, -69.88367967783859, -657.7133635257134, -985.0836811227634, -796.7170261624202, -728.9477798977726, -1166.6321818061392, -98.00184346155984, -866.6491635860699, -431.4987561750578, -1054.8579129297243, -953.2819284723411, -539.4104142649555, -1034.1612976935266, -801.0139848976069]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5608252423129548, "mean_inference_ms": 1.6827475507736827, "mean_action_processing_ms": 0.2845715208304408, "mean_env_wait_ms": 2.9697117414132164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0135955810546875, "StateBufferConnector_ms": 0.008903741836547852, "ViewRequirementAgentConnector_ms": 0.19402360916137695}, "num_episodes": 28, "episode_return_max": -9.436358579930705, "episode_return_min": -1205.1831425441126, "episode_return_mean": -691.908678223047, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.0935036406046, "num_env_steps_trained_throughput_per_sec": 298.0935036406046, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12980.2, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12980.122, "sample_time_ms": 1017.217, "learn_time_ms": 11895.36, "learn_throughput": 336.266, "synch_weights_time_ms": 66.692}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00011", "date": "2024-08-03_11-17-24", "timestamp": 1722664044, "time_this_iter_s": 13.431906700134277, "time_total_s": 77.95788240432739, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b1750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.95788240432739, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.325000000000003, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.7962493080024915, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.101815328001976, "policy_loss": -0.008802795854959793, "vf_loss": 9.1207766075929, "vf_explained_var": 0.4328262208029628, "kl": 0.015715579831233603, "entropy": 1.3301591257254282, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -9.436358579930705, "episode_reward_min": -1205.1831425441126, "episode_reward_mean": -703.3652817347753, "episode_len_mean": 140.25, "episode_media": {}, "episodes_timesteps_total": 14025, "policy_reward_min": {"policy_0": -1205.1831425441126}, "policy_reward_max": {"policy_0": -9.436358579930705}, "policy_reward_mean": {"policy_0": -703.3652817347753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-642.5897106712887, -1157.6285050160363, -653.7887799174633, -414.9590999655866, -780.7405775687383, -229.34376886201915, -642.6284803044902, -914.8642683792262, -415.0001557481131, -597.972537588395, -612.0517769951782, -535.9795280315707, -881.9344218967013, -362.2548150103831, -9.436358579930705, -763.0401568278602, -437.5566844781921, -433.04261521692445, -264.5750321701845, -596.4253354740064, -742.3584339929992, -848.677401961077, -224.2523510980181, -693.8972324385298, -274.4492141838083, -806.6729118637035, -737.6321126010145, -933.0723099746315, -433.4002723473668, -488.1140203675301, -639.3921793740302, -964.536988513784, -907.1833438063109, -828.6236385041158, -913.6700666370198, -691.3175685102964, -673.8408625153046, -835.7520815603987, -578.1170639624797, -899.2440591184202, -1021.4834938257422, -467.43567432989585, -729.5058242262552, -783.8131528488357, -626.6912170385637, -12.291245492276243, -848.8297095666717, -1130.404889790221, -1046.4367396445298, -566.7643309950761, -1205.1831425441126, -858.0192173388782, -618.341495314375, -926.0845394437179, -492.61381618174477, -1066.7598747819802, -694.7398297052581, -69.88367967783859, -657.7133635257134, -985.0836811227634, -796.7170261624202, -728.9477798977726, -1166.6321818061392, -98.00184346155984, -866.6491635860699, -431.4987561750578, -1054.8579129297243, -953.2819284723411, -539.4104142649555, -1034.1612976935266, -801.0139848976069, -903.8125618867133, -993.371816426606, -1039.6481919434618, -632.2613594212711, -979.130078590618, -269.8908496792033, -920.1363470460815, -937.8460528517123, -473.0009357849224, -957.2044000273038, -893.4556528655721, -1044.405496876527, -1033.0786010944555, -1026.559119621845, -629.6098932877679, -488.3597618520524, -1163.8181198518134, -251.24142774039825, -1076.87827059667, -265.63463823368545, -426.63414619836936, -110.61336572477548, -1106.7612970819528, -1115.207447013735, -527.932791138572, -672.2323371493242, -134.80468430316384, -836.3190439446354, -687.41155646957], "episode_lengths": [150, 150, 150, 150, 150, 130, 131, 150, 150, 150, 150, 150, 150, 150, 48, 143, 124, 150, 82, 150, 150, 150, 104, 150, 114, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 128, 150, 150, 150, 37, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 64, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 104, 96, 150, 150, 150, 150, 68, 150, 150], "policy_policy_0_reward": [-642.5897106712887, -1157.6285050160363, -653.7887799174633, -414.9590999655866, -780.7405775687383, -229.34376886201915, -642.6284803044902, -914.8642683792262, -415.0001557481131, -597.972537588395, -612.0517769951782, -535.9795280315707, -881.9344218967013, -362.2548150103831, -9.436358579930705, -763.0401568278602, -437.5566844781921, -433.04261521692445, -264.5750321701845, -596.4253354740064, -742.3584339929992, -848.677401961077, -224.2523510980181, -693.8972324385298, -274.4492141838083, -806.6729118637035, -737.6321126010145, -933.0723099746315, -433.4002723473668, -488.1140203675301, -639.3921793740302, -964.536988513784, -907.1833438063109, -828.6236385041158, -913.6700666370198, -691.3175685102964, -673.8408625153046, -835.7520815603987, -578.1170639624797, -899.2440591184202, -1021.4834938257422, -467.43567432989585, -729.5058242262552, -783.8131528488357, -626.6912170385637, -12.291245492276243, -848.8297095666717, -1130.404889790221, -1046.4367396445298, -566.7643309950761, -1205.1831425441126, -858.0192173388782, -618.341495314375, -926.0845394437179, -492.61381618174477, -1066.7598747819802, -694.7398297052581, -69.88367967783859, -657.7133635257134, -985.0836811227634, -796.7170261624202, -728.9477798977726, -1166.6321818061392, -98.00184346155984, -866.6491635860699, -431.4987561750578, -1054.8579129297243, -953.2819284723411, -539.4104142649555, -1034.1612976935266, -801.0139848976069, -903.8125618867133, -993.371816426606, -1039.6481919434618, -632.2613594212711, -979.130078590618, -269.8908496792033, -920.1363470460815, -937.8460528517123, -473.0009357849224, -957.2044000273038, -893.4556528655721, -1044.405496876527, -1033.0786010944555, -1026.559119621845, -629.6098932877679, -488.3597618520524, -1163.8181198518134, -251.24142774039825, -1076.87827059667, -265.63463823368545, -426.63414619836936, -110.61336572477548, -1106.7612970819528, -1115.207447013735, -527.932791138572, -672.2323371493242, -134.80468430316384, -836.3190439446354, -687.41155646957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5605212108913011, "mean_inference_ms": 1.6847309778584563, "mean_action_processing_ms": 0.28503139088933893, "mean_env_wait_ms": 2.974718029831249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018340587615966797, "StateBufferConnector_ms": 0.008783340454101562, "ViewRequirementAgentConnector_ms": 0.19846487045288086}, "num_episodes": 29, "episode_return_max": -9.436358579930705, "episode_return_min": -1205.1831425441126, "episode_return_mean": -703.3652817347753, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.87131203416357, "num_env_steps_trained_throughput_per_sec": 291.87131203416357, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13083.698, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13083.618, "sample_time_ms": 1023.805, "learn_time_ms": 11991.008, "learn_throughput": 333.583, "synch_weights_time_ms": 67.949}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00011", "date": "2024-08-03_11-17-37", "timestamp": 1722664057, "time_this_iter_s": 13.718279123306274, "time_total_s": 91.67616152763367, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245762290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 91.67616152763367, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.663157894736843, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.514039640811583, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.370944321652253, "policy_loss": -0.011668941892276052, "vf_loss": 9.39291222691536, "vf_explained_var": 0.3895003338654836, "kl": 0.01653418645128114, "entropy": 1.360579957316319, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -12.291245492276243, "episode_reward_min": -1222.6288239473415, "episode_reward_mean": -748.6966111193676, "episode_len_mean": 140.75, "episode_media": {}, "episodes_timesteps_total": 14075, "policy_reward_min": {"policy_0": -1222.6288239473415}, "policy_reward_max": {"policy_0": -12.291245492276243}, "policy_reward_mean": {"policy_0": -748.6966111193676}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-964.536988513784, -907.1833438063109, -828.6236385041158, -913.6700666370198, -691.3175685102964, -673.8408625153046, -835.7520815603987, -578.1170639624797, -899.2440591184202, -1021.4834938257422, -467.43567432989585, -729.5058242262552, -783.8131528488357, -626.6912170385637, -12.291245492276243, -848.8297095666717, -1130.404889790221, -1046.4367396445298, -566.7643309950761, -1205.1831425441126, -858.0192173388782, -618.341495314375, -926.0845394437179, -492.61381618174477, -1066.7598747819802, -694.7398297052581, -69.88367967783859, -657.7133635257134, -985.0836811227634, -796.7170261624202, -728.9477798977726, -1166.6321818061392, -98.00184346155984, -866.6491635860699, -431.4987561750578, -1054.8579129297243, -953.2819284723411, -539.4104142649555, -1034.1612976935266, -801.0139848976069, -903.8125618867133, -993.371816426606, -1039.6481919434618, -632.2613594212711, -979.130078590618, -269.8908496792033, -920.1363470460815, -937.8460528517123, -473.0009357849224, -957.2044000273038, -893.4556528655721, -1044.405496876527, -1033.0786010944555, -1026.559119621845, -629.6098932877679, -488.3597618520524, -1163.8181198518134, -251.24142774039825, -1076.87827059667, -265.63463823368545, -426.63414619836936, -110.61336572477548, -1106.7612970819528, -1115.207447013735, -527.932791138572, -672.2323371493242, -134.80468430316384, -836.3190439446354, -687.41155646957, -1079.3127675952592, -395.5618324239499, -104.3563028586197, -1029.1051412112909, -985.0356320330966, -1059.7708100314169, -1222.6288239473415, -952.3293967917504, -79.82503130587982, -816.0604659478859, -445.1464998776598, -746.5026321649823, -764.7336453840173, -682.6451885147648, -578.7156736864537, -585.4592389507752, -1075.5115043669327, -1195.0386677174617, -1101.3796214275337, -146.27714132059683, -557.0752709264177, -771.3900593118988, -299.4161914805293, -637.7168343907438, -579.1811919882542, -847.710939418655, -1037.940530223038, -319.6726116605267, -850.3726912745283, -723.8770268732198, -1031.1146222587367], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 128, 150, 150, 150, 37, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 64, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 104, 96, 150, 150, 150, 150, 68, 150, 150, 150, 119, 85, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 131, 150, 150, 90, 150, 150, 150], "policy_policy_0_reward": [-964.536988513784, -907.1833438063109, -828.6236385041158, -913.6700666370198, -691.3175685102964, -673.8408625153046, -835.7520815603987, -578.1170639624797, -899.2440591184202, -1021.4834938257422, -467.43567432989585, -729.5058242262552, -783.8131528488357, -626.6912170385637, -12.291245492276243, -848.8297095666717, -1130.404889790221, -1046.4367396445298, -566.7643309950761, -1205.1831425441126, -858.0192173388782, -618.341495314375, -926.0845394437179, -492.61381618174477, -1066.7598747819802, -694.7398297052581, -69.88367967783859, -657.7133635257134, -985.0836811227634, -796.7170261624202, -728.9477798977726, -1166.6321818061392, -98.00184346155984, -866.6491635860699, -431.4987561750578, -1054.8579129297243, -953.2819284723411, -539.4104142649555, -1034.1612976935266, -801.0139848976069, -903.8125618867133, -993.371816426606, -1039.6481919434618, -632.2613594212711, -979.130078590618, -269.8908496792033, -920.1363470460815, -937.8460528517123, -473.0009357849224, -957.2044000273038, -893.4556528655721, -1044.405496876527, -1033.0786010944555, -1026.559119621845, -629.6098932877679, -488.3597618520524, -1163.8181198518134, -251.24142774039825, -1076.87827059667, -265.63463823368545, -426.63414619836936, -110.61336572477548, -1106.7612970819528, -1115.207447013735, -527.932791138572, -672.2323371493242, -134.80468430316384, -836.3190439446354, -687.41155646957, -1079.3127675952592, -395.5618324239499, -104.3563028586197, -1029.1051412112909, -985.0356320330966, -1059.7708100314169, -1222.6288239473415, -952.3293967917504, -79.82503130587982, -816.0604659478859, -445.1464998776598, -746.5026321649823, -764.7336453840173, -682.6451885147648, -578.7156736864537, -585.4592389507752, -1075.5115043669327, -1195.0386677174617, -1101.3796214275337, -146.27714132059683, -557.0752709264177, -771.3900593118988, -299.4161914805293, -637.7168343907438, -579.1811919882542, -847.710939418655, -1037.940530223038, -319.6726116605267, -850.3726912745283, -723.8770268732198, -1031.1146222587367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5611981686754633, "mean_inference_ms": 1.6903032705761276, "mean_action_processing_ms": 0.28549043007573816, "mean_env_wait_ms": 2.983459945999677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0182192325592041, "StateBufferConnector_ms": 0.008844614028930664, "ViewRequirementAgentConnector_ms": 0.20226383209228516}, "num_episodes": 31, "episode_return_max": -12.291245492276243, "episode_return_min": -1222.6288239473415, "episode_return_mean": -748.6966111193676, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.6104594256049, "num_env_steps_trained_throughput_per_sec": 308.6104594256049, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13068.403, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13068.322, "sample_time_ms": 1024.165, "learn_time_ms": 11973.983, "learn_throughput": 334.058, "synch_weights_time_ms": 69.303}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00011", "date": "2024-08-03_11-17-50", "timestamp": 1722664070, "time_this_iter_s": 12.976609706878662, "time_total_s": 104.65277123451233, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457630a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 104.65277123451233, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.71578947368421, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.813240966262916, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.418342153231302, "policy_loss": -0.006517889069315667, "vf_loss": 9.43529394765695, "vf_explained_var": 0.3488919441898664, "kl": 0.015148480570648342, "entropy": 1.3463567456851402, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -69.88367967783859, "episode_reward_min": -1251.8141474771285, "episode_reward_mean": -752.3100560835992, "episode_len_mean": 141.43, "episode_media": {}, "episodes_timesteps_total": 14143, "policy_reward_min": {"policy_0": -1251.8141474771285}, "policy_reward_max": {"policy_0": -69.88367967783859}, "policy_reward_mean": {"policy_0": -752.3100560835992}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-694.7398297052581, -69.88367967783859, -657.7133635257134, -985.0836811227634, -796.7170261624202, -728.9477798977726, -1166.6321818061392, -98.00184346155984, -866.6491635860699, -431.4987561750578, -1054.8579129297243, -953.2819284723411, -539.4104142649555, -1034.1612976935266, -801.0139848976069, -903.8125618867133, -993.371816426606, -1039.6481919434618, -632.2613594212711, -979.130078590618, -269.8908496792033, -920.1363470460815, -937.8460528517123, -473.0009357849224, -957.2044000273038, -893.4556528655721, -1044.405496876527, -1033.0786010944555, -1026.559119621845, -629.6098932877679, -488.3597618520524, -1163.8181198518134, -251.24142774039825, -1076.87827059667, -265.63463823368545, -426.63414619836936, -110.61336572477548, -1106.7612970819528, -1115.207447013735, -527.932791138572, -672.2323371493242, -134.80468430316384, -836.3190439446354, -687.41155646957, -1079.3127675952592, -395.5618324239499, -104.3563028586197, -1029.1051412112909, -985.0356320330966, -1059.7708100314169, -1222.6288239473415, -952.3293967917504, -79.82503130587982, -816.0604659478859, -445.1464998776598, -746.5026321649823, -764.7336453840173, -682.6451885147648, -578.7156736864537, -585.4592389507752, -1075.5115043669327, -1195.0386677174617, -1101.3796214275337, -146.27714132059683, -557.0752709264177, -771.3900593118988, -299.4161914805293, -637.7168343907438, -579.1811919882542, -847.710939418655, -1037.940530223038, -319.6726116605267, -850.3726912745283, -723.8770268732198, -1031.1146222587367, -1072.003793316313, -859.8179889266588, -1085.845004056503, -689.0269569990603, -836.1334534391883, -1069.0269334595914, -319.48967651084007, -976.5857281179203, -1251.8141474771285, -830.8630954223095, -885.8417625151949, -851.6332637913965, -577.7615580328011, -554.0590696732784, -584.6180706730977, -1078.2678516808103, -1211.6409166455473, -818.1726414229174, -721.2251969959412, -732.4409840343483, -583.1040989772625, -840.1431539250297, -151.4973428651538, -1026.8495100343598, -446.4263339215274], "episode_lengths": [150, 64, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 104, 96, 150, 150, 150, 150, 68, 150, 150, 150, 119, 85, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 131, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 113], "policy_policy_0_reward": [-694.7398297052581, -69.88367967783859, -657.7133635257134, -985.0836811227634, -796.7170261624202, -728.9477798977726, -1166.6321818061392, -98.00184346155984, -866.6491635860699, -431.4987561750578, -1054.8579129297243, -953.2819284723411, -539.4104142649555, -1034.1612976935266, -801.0139848976069, -903.8125618867133, -993.371816426606, -1039.6481919434618, -632.2613594212711, -979.130078590618, -269.8908496792033, -920.1363470460815, -937.8460528517123, -473.0009357849224, -957.2044000273038, -893.4556528655721, -1044.405496876527, -1033.0786010944555, -1026.559119621845, -629.6098932877679, -488.3597618520524, -1163.8181198518134, -251.24142774039825, -1076.87827059667, -265.63463823368545, -426.63414619836936, -110.61336572477548, -1106.7612970819528, -1115.207447013735, -527.932791138572, -672.2323371493242, -134.80468430316384, -836.3190439446354, -687.41155646957, -1079.3127675952592, -395.5618324239499, -104.3563028586197, -1029.1051412112909, -985.0356320330966, -1059.7708100314169, -1222.6288239473415, -952.3293967917504, -79.82503130587982, -816.0604659478859, -445.1464998776598, -746.5026321649823, -764.7336453840173, -682.6451885147648, -578.7156736864537, -585.4592389507752, -1075.5115043669327, -1195.0386677174617, -1101.3796214275337, -146.27714132059683, -557.0752709264177, -771.3900593118988, -299.4161914805293, -637.7168343907438, -579.1811919882542, -847.710939418655, -1037.940530223038, -319.6726116605267, -850.3726912745283, -723.8770268732198, -1031.1146222587367, -1072.003793316313, -859.8179889266588, -1085.845004056503, -689.0269569990603, -836.1334534391883, -1069.0269334595914, -319.48967651084007, -976.5857281179203, -1251.8141474771285, -830.8630954223095, -885.8417625151949, -851.6332637913965, -577.7615580328011, -554.0590696732784, -584.6180706730977, -1078.2678516808103, -1211.6409166455473, -818.1726414229174, -721.2251969959412, -732.4409840343483, -583.1040989772625, -840.1431539250297, -151.4973428651538, -1026.8495100343598, -446.4263339215274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5602578348285318, "mean_inference_ms": 1.6904609029003572, "mean_action_processing_ms": 0.28501345194387384, "mean_env_wait_ms": 2.983859367332118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017460107803344727, "StateBufferConnector_ms": 0.008448362350463867, "ViewRequirementAgentConnector_ms": 0.19625067710876465}, "num_episodes": 25, "episode_return_max": -69.88367967783859, "episode_return_min": -1251.8141474771285, "episode_return_mean": -752.3100560835992, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.3497698899584, "num_env_steps_trained_throughput_per_sec": 331.3497698899584, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12957.675, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12957.595, "sample_time_ms": 1021.395, "learn_time_ms": 11865.751, "learn_throughput": 337.105, "synch_weights_time_ms": 69.587}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00011", "date": "2024-08-03_11-18-03", "timestamp": 1722664083, "time_this_iter_s": 12.083126544952393, "time_total_s": 116.73589777946472, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b1750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 116.73589777946472, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 14.011764705882353, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.350286219144861, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.652262018620968, "policy_loss": -0.012712513857695739, "vf_loss": 8.673182567954063, "vf_explained_var": 0.5204744592308999, "kl": 0.0188209136800045, "entropy": 1.1972227179755768, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -44.674753682067035, "episode_reward_min": -1332.5630865354237, "episode_reward_mean": -730.011497259679, "episode_len_mean": 141.45, "episode_media": {}, "episodes_timesteps_total": 14145, "policy_reward_min": {"policy_0": -1332.5630865354237}, "policy_reward_max": {"policy_0": -44.674753682067035}, "policy_reward_mean": {"policy_0": -730.011497259679}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1033.0786010944555, -1026.559119621845, -629.6098932877679, -488.3597618520524, -1163.8181198518134, -251.24142774039825, -1076.87827059667, -265.63463823368545, -426.63414619836936, -110.61336572477548, -1106.7612970819528, -1115.207447013735, -527.932791138572, -672.2323371493242, -134.80468430316384, -836.3190439446354, -687.41155646957, -1079.3127675952592, -395.5618324239499, -104.3563028586197, -1029.1051412112909, -985.0356320330966, -1059.7708100314169, -1222.6288239473415, -952.3293967917504, -79.82503130587982, -816.0604659478859, -445.1464998776598, -746.5026321649823, -764.7336453840173, -682.6451885147648, -578.7156736864537, -585.4592389507752, -1075.5115043669327, -1195.0386677174617, -1101.3796214275337, -146.27714132059683, -557.0752709264177, -771.3900593118988, -299.4161914805293, -637.7168343907438, -579.1811919882542, -847.710939418655, -1037.940530223038, -319.6726116605267, -850.3726912745283, -723.8770268732198, -1031.1146222587367, -1072.003793316313, -859.8179889266588, -1085.845004056503, -689.0269569990603, -836.1334534391883, -1069.0269334595914, -319.48967651084007, -976.5857281179203, -1251.8141474771285, -830.8630954223095, -885.8417625151949, -851.6332637913965, -577.7615580328011, -554.0590696732784, -584.6180706730977, -1078.2678516808103, -1211.6409166455473, -818.1726414229174, -721.2251969959412, -732.4409840343483, -583.1040989772625, -840.1431539250297, -151.4973428651538, -1026.8495100343598, -446.4263339215274, -870.9393511012801, -632.00505928692, -470.92086004195795, -807.8643323778296, -639.406638357846, -483.00093989514284, -44.674753682067035, -821.5203569533684, -711.3883239788245, -604.4026921500966, -185.19368551371613, -721.0866328768367, -891.8332624252181, -951.2198696280702, -1031.8669454169535, -1332.5630865354237, -773.1664060083973, -539.5884787019003, -605.4712922378454, -793.3835002520241, -763.4906402425959, -731.0094043731189, -516.0893971993602, -1264.824797861367, -663.0945189135673, -135.69187288907105, -707.2036054859235], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 95, 104, 96, 150, 150, 150, 150, 68, 150, 150, 150, 119, 85, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 131, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 113, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150], "policy_policy_0_reward": [-1033.0786010944555, -1026.559119621845, -629.6098932877679, -488.3597618520524, -1163.8181198518134, -251.24142774039825, -1076.87827059667, -265.63463823368545, -426.63414619836936, -110.61336572477548, -1106.7612970819528, -1115.207447013735, -527.932791138572, -672.2323371493242, -134.80468430316384, -836.3190439446354, -687.41155646957, -1079.3127675952592, -395.5618324239499, -104.3563028586197, -1029.1051412112909, -985.0356320330966, -1059.7708100314169, -1222.6288239473415, -952.3293967917504, -79.82503130587982, -816.0604659478859, -445.1464998776598, -746.5026321649823, -764.7336453840173, -682.6451885147648, -578.7156736864537, -585.4592389507752, -1075.5115043669327, -1195.0386677174617, -1101.3796214275337, -146.27714132059683, -557.0752709264177, -771.3900593118988, -299.4161914805293, -637.7168343907438, -579.1811919882542, -847.710939418655, -1037.940530223038, -319.6726116605267, -850.3726912745283, -723.8770268732198, -1031.1146222587367, -1072.003793316313, -859.8179889266588, -1085.845004056503, -689.0269569990603, -836.1334534391883, -1069.0269334595914, -319.48967651084007, -976.5857281179203, -1251.8141474771285, -830.8630954223095, -885.8417625151949, -851.6332637913965, -577.7615580328011, -554.0590696732784, -584.6180706730977, -1078.2678516808103, -1211.6409166455473, -818.1726414229174, -721.2251969959412, -732.4409840343483, -583.1040989772625, -840.1431539250297, -151.4973428651538, -1026.8495100343598, -446.4263339215274, -870.9393511012801, -632.00505928692, -470.92086004195795, -807.8643323778296, -639.406638357846, -483.00093989514284, -44.674753682067035, -821.5203569533684, -711.3883239788245, -604.4026921500966, -185.19368551371613, -721.0866328768367, -891.8332624252181, -951.2198696280702, -1031.8669454169535, -1332.5630865354237, -773.1664060083973, -539.5884787019003, -605.4712922378454, -793.3835002520241, -763.4906402425959, -731.0094043731189, -516.0893971993602, -1264.824797861367, -663.0945189135673, -135.69187288907105, -707.2036054859235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5588325351516387, "mean_inference_ms": 1.6893199979774582, "mean_action_processing_ms": 0.2842343405924369, "mean_env_wait_ms": 2.983202325650514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01702570915222168, "StateBufferConnector_ms": 0.00809931755065918, "ViewRequirementAgentConnector_ms": 0.19317197799682617}, "num_episodes": 27, "episode_return_max": -44.674753682067035, "episode_return_min": -1332.5630865354237, "episode_return_mean": -730.011497259679, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.1691464041271, "num_env_steps_trained_throughput_per_sec": 310.1691464041271, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12951.528, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12951.45, "sample_time_ms": 1019.417, "learn_time_ms": 11862.904, "learn_throughput": 337.186, "synch_weights_time_ms": 68.272}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00011", "date": "2024-08-03_11-18-15", "timestamp": 1722664095, "time_this_iter_s": 12.908878087997437, "time_total_s": 129.64477586746216, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b2b00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 129.64477586746216, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 14.000000000000002, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.449410377691189, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.59617361674706, "policy_loss": -0.01864126588043291, "vf_loss": 8.621563326319059, "vf_explained_var": 0.6353135564054052, "kl": 0.02866972350050978, "entropy": 1.2482369766260186, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -21.718866611911317, "episode_reward_min": -1332.5630865354237, "episode_reward_mean": -706.7320066962282, "episode_len_mean": 139.97, "episode_media": {}, "episodes_timesteps_total": 13997, "policy_reward_min": {"policy_0": -1332.5630865354237}, "policy_reward_max": {"policy_0": -21.718866611911317}, "policy_reward_mean": {"policy_0": -706.7320066962282}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-578.7156736864537, -585.4592389507752, -1075.5115043669327, -1195.0386677174617, -1101.3796214275337, -146.27714132059683, -557.0752709264177, -771.3900593118988, -299.4161914805293, -637.7168343907438, -579.1811919882542, -847.710939418655, -1037.940530223038, -319.6726116605267, -850.3726912745283, -723.8770268732198, -1031.1146222587367, -1072.003793316313, -859.8179889266588, -1085.845004056503, -689.0269569990603, -836.1334534391883, -1069.0269334595914, -319.48967651084007, -976.5857281179203, -1251.8141474771285, -830.8630954223095, -885.8417625151949, -851.6332637913965, -577.7615580328011, -554.0590696732784, -584.6180706730977, -1078.2678516808103, -1211.6409166455473, -818.1726414229174, -721.2251969959412, -732.4409840343483, -583.1040989772625, -840.1431539250297, -151.4973428651538, -1026.8495100343598, -446.4263339215274, -870.9393511012801, -632.00505928692, -470.92086004195795, -807.8643323778296, -639.406638357846, -483.00093989514284, -44.674753682067035, -821.5203569533684, -711.3883239788245, -604.4026921500966, -185.19368551371613, -721.0866328768367, -891.8332624252181, -951.2198696280702, -1031.8669454169535, -1332.5630865354237, -773.1664060083973, -539.5884787019003, -605.4712922378454, -793.3835002520241, -763.4906402425959, -731.0094043731189, -516.0893971993602, -1264.824797861367, -663.0945189135673, -135.69187288907105, -707.2036054859235, -893.5756154621216, -21.718866611911317, -499.2457768670992, -162.25494870196434, -143.15061522660164, -225.9744635658723, -755.7283588818328, -392.29944674496426, -620.3712822771415, -853.0575667097413, -895.1559009747697, -192.84297332161194, -1148.969118783926, -876.0274206508556, -1053.8191350974125, -489.5333108555822, -770.5938365461357, -234.60117720715286, -1040.3103572041825, -637.8285053371213, -371.3072991497101, -1195.174762433744, -686.1487088720861, -745.7576637762749, -450.51683304597935, -913.0361902778118, -45.704603303973926, -572.7948719134627, -767.2369601632225, -860.433869352691, -1072.9911757286577], "episode_lengths": [150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 131, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 113, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 43, 150, 88, 63, 101, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 79, 150, 150, 127, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150], "policy_policy_0_reward": [-578.7156736864537, -585.4592389507752, -1075.5115043669327, -1195.0386677174617, -1101.3796214275337, -146.27714132059683, -557.0752709264177, -771.3900593118988, -299.4161914805293, -637.7168343907438, -579.1811919882542, -847.710939418655, -1037.940530223038, -319.6726116605267, -850.3726912745283, -723.8770268732198, -1031.1146222587367, -1072.003793316313, -859.8179889266588, -1085.845004056503, -689.0269569990603, -836.1334534391883, -1069.0269334595914, -319.48967651084007, -976.5857281179203, -1251.8141474771285, -830.8630954223095, -885.8417625151949, -851.6332637913965, -577.7615580328011, -554.0590696732784, -584.6180706730977, -1078.2678516808103, -1211.6409166455473, -818.1726414229174, -721.2251969959412, -732.4409840343483, -583.1040989772625, -840.1431539250297, -151.4973428651538, -1026.8495100343598, -446.4263339215274, -870.9393511012801, -632.00505928692, -470.92086004195795, -807.8643323778296, -639.406638357846, -483.00093989514284, -44.674753682067035, -821.5203569533684, -711.3883239788245, -604.4026921500966, -185.19368551371613, -721.0866328768367, -891.8332624252181, -951.2198696280702, -1031.8669454169535, -1332.5630865354237, -773.1664060083973, -539.5884787019003, -605.4712922378454, -793.3835002520241, -763.4906402425959, -731.0094043731189, -516.0893971993602, -1264.824797861367, -663.0945189135673, -135.69187288907105, -707.2036054859235, -893.5756154621216, -21.718866611911317, -499.2457768670992, -162.25494870196434, -143.15061522660164, -225.9744635658723, -755.7283588818328, -392.29944674496426, -620.3712822771415, -853.0575667097413, -895.1559009747697, -192.84297332161194, -1148.969118783926, -876.0274206508556, -1053.8191350974125, -489.5333108555822, -770.5938365461357, -234.60117720715286, -1040.3103572041825, -637.8285053371213, -371.3072991497101, -1195.174762433744, -686.1487088720861, -745.7576637762749, -450.51683304597935, -913.0361902778118, -45.704603303973926, -572.7948719134627, -767.2369601632225, -860.433869352691, -1072.9911757286577]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577806132852969, "mean_inference_ms": 1.6884991779028624, "mean_action_processing_ms": 0.283498102152224, "mean_env_wait_ms": 2.981947754832713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012048959732055664, "StateBufferConnector_ms": 0.007997274398803711, "ViewRequirementAgentConnector_ms": 0.1895275115966797}, "num_episodes": 31, "episode_return_max": -21.718866611911317, "episode_return_min": -1332.5630865354237, "episode_return_mean": -706.7320066962282, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.72954880241184, "num_env_steps_trained_throughput_per_sec": 303.72954880241184, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12941.716, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12941.638, "sample_time_ms": 1018.364, "learn_time_ms": 11856.383, "learn_throughput": 337.371, "synch_weights_time_ms": 66.021}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00011", "date": "2024-08-03_11-18-29", "timestamp": 1722664109, "time_this_iter_s": 13.182827711105347, "time_total_s": 142.8276035785675, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b3760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 142.8276035785675, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 13.763157894736839, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.53963669165969, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.55144734531641, "policy_loss": -0.01588224338775035, "vf_loss": 8.57280166745186, "vf_explained_var": 0.6262391661604245, "kl": 0.024233251914499, "entropy": 1.274205708441635, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -21.718866611911317, "episode_reward_min": -1332.5630865354237, "episode_reward_mean": -655.0831548245798, "episode_len_mean": 138.01, "episode_media": {}, "episodes_timesteps_total": 13801, "policy_reward_min": {"policy_0": -1332.5630865354237}, "policy_reward_max": {"policy_0": -21.718866611911317}, "policy_reward_mean": {"policy_0": -655.0831548245798}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-577.7615580328011, -554.0590696732784, -584.6180706730977, -1078.2678516808103, -1211.6409166455473, -818.1726414229174, -721.2251969959412, -732.4409840343483, -583.1040989772625, -840.1431539250297, -151.4973428651538, -1026.8495100343598, -446.4263339215274, -870.9393511012801, -632.00505928692, -470.92086004195795, -807.8643323778296, -639.406638357846, -483.00093989514284, -44.674753682067035, -821.5203569533684, -711.3883239788245, -604.4026921500966, -185.19368551371613, -721.0866328768367, -891.8332624252181, -951.2198696280702, -1031.8669454169535, -1332.5630865354237, -773.1664060083973, -539.5884787019003, -605.4712922378454, -793.3835002520241, -763.4906402425959, -731.0094043731189, -516.0893971993602, -1264.824797861367, -663.0945189135673, -135.69187288907105, -707.2036054859235, -893.5756154621216, -21.718866611911317, -499.2457768670992, -162.25494870196434, -143.15061522660164, -225.9744635658723, -755.7283588818328, -392.29944674496426, -620.3712822771415, -853.0575667097413, -895.1559009747697, -192.84297332161194, -1148.969118783926, -876.0274206508556, -1053.8191350974125, -489.5333108555822, -770.5938365461357, -234.60117720715286, -1040.3103572041825, -637.8285053371213, -371.3072991497101, -1195.174762433744, -686.1487088720861, -745.7576637762749, -450.51683304597935, -913.0361902778118, -45.704603303973926, -572.7948719134627, -767.2369601632225, -860.433869352691, -1072.9911757286577, -489.7041524408953, -301.785090224641, -864.9687206518709, -331.69945786942435, -994.3454340430366, -91.18789343170756, -695.9511560576075, -859.1536764709508, -1243.0620757532022, -538.7366209946475, -873.5470473670814, -880.6405654113112, -697.783878474844, -452.7791267325948, -761.0267541354907, -820.3591576583541, -212.42749462904283, -496.60651876056534, -658.9089326250339, -521.9242571382938, -150.24145194482927, -1248.1055605047789, -186.91162607906472, -461.17252330095016, -429.5471542760077, -994.0687308002034, -654.6204427597562, -913.2878145785667, -76.4931190288113], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 113, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 43, 150, 88, 63, 101, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 79, 150, 150, 127, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 139, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 75, 150, 90, 150, 150, 150, 150, 150, 72], "policy_policy_0_reward": [-577.7615580328011, -554.0590696732784, -584.6180706730977, -1078.2678516808103, -1211.6409166455473, -818.1726414229174, -721.2251969959412, -732.4409840343483, -583.1040989772625, -840.1431539250297, -151.4973428651538, -1026.8495100343598, -446.4263339215274, -870.9393511012801, -632.00505928692, -470.92086004195795, -807.8643323778296, -639.406638357846, -483.00093989514284, -44.674753682067035, -821.5203569533684, -711.3883239788245, -604.4026921500966, -185.19368551371613, -721.0866328768367, -891.8332624252181, -951.2198696280702, -1031.8669454169535, -1332.5630865354237, -773.1664060083973, -539.5884787019003, -605.4712922378454, -793.3835002520241, -763.4906402425959, -731.0094043731189, -516.0893971993602, -1264.824797861367, -663.0945189135673, -135.69187288907105, -707.2036054859235, -893.5756154621216, -21.718866611911317, -499.2457768670992, -162.25494870196434, -143.15061522660164, -225.9744635658723, -755.7283588818328, -392.29944674496426, -620.3712822771415, -853.0575667097413, -895.1559009747697, -192.84297332161194, -1148.969118783926, -876.0274206508556, -1053.8191350974125, -489.5333108555822, -770.5938365461357, -234.60117720715286, -1040.3103572041825, -637.8285053371213, -371.3072991497101, -1195.174762433744, -686.1487088720861, -745.7576637762749, -450.51683304597935, -913.0361902778118, -45.704603303973926, -572.7948719134627, -767.2369601632225, -860.433869352691, -1072.9911757286577, -489.7041524408953, -301.785090224641, -864.9687206518709, -331.69945786942435, -994.3454340430366, -91.18789343170756, -695.9511560576075, -859.1536764709508, -1243.0620757532022, -538.7366209946475, -873.5470473670814, -880.6405654113112, -697.783878474844, -452.7791267325948, -761.0267541354907, -820.3591576583541, -212.42749462904283, -496.60651876056534, -658.9089326250339, -521.9242571382938, -150.24145194482927, -1248.1055605047789, -186.91162607906472, -461.17252330095016, -429.5471542760077, -994.0687308002034, -654.6204427597562, -913.2878145785667, -76.4931190288113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565433364734708, "mean_inference_ms": 1.6877431515738712, "mean_action_processing_ms": 0.282905694005046, "mean_env_wait_ms": 2.980433010339133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011847496032714844, "StateBufferConnector_ms": 0.007782459259033203, "ViewRequirementAgentConnector_ms": 0.1888725757598877}, "num_episodes": 29, "episode_return_max": -21.718866611911317, "episode_return_min": -1332.5630865354237, "episode_return_mean": -655.0831548245798, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.8936025021993, "num_env_steps_trained_throughput_per_sec": 307.8936025021993, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12898.286, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12898.208, "sample_time_ms": 1021.039, "learn_time_ms": 11811.16, "learn_throughput": 338.663, "synch_weights_time_ms": 65.159}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00011", "date": "2024-08-03_11-18-42", "timestamp": 1722664122, "time_this_iter_s": 13.00397253036499, "time_total_s": 155.8315761089325, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b3400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 155.8315761089325, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 14.194444444444448, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.795427345981201, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.591290883719921, "policy_loss": -0.018857092696028605, "vf_loss": 8.616199844082196, "vf_explained_var": 0.6482398593177398, "kl": 0.0173146204487542, "entropy": 1.3843456039826074, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -21.718866611911317, "episode_reward_min": -1285.7328043218422, "episode_reward_mean": -668.9998410849264, "episode_len_mean": 137.11, "episode_media": {}, "episodes_timesteps_total": 13711, "policy_reward_min": {"policy_0": -1285.7328043218422}, "policy_reward_max": {"policy_0": -21.718866611911317}, "policy_reward_mean": {"policy_0": -668.9998410849264}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-605.4712922378454, -793.3835002520241, -763.4906402425959, -731.0094043731189, -516.0893971993602, -1264.824797861367, -663.0945189135673, -135.69187288907105, -707.2036054859235, -893.5756154621216, -21.718866611911317, -499.2457768670992, -162.25494870196434, -143.15061522660164, -225.9744635658723, -755.7283588818328, -392.29944674496426, -620.3712822771415, -853.0575667097413, -895.1559009747697, -192.84297332161194, -1148.969118783926, -876.0274206508556, -1053.8191350974125, -489.5333108555822, -770.5938365461357, -234.60117720715286, -1040.3103572041825, -637.8285053371213, -371.3072991497101, -1195.174762433744, -686.1487088720861, -745.7576637762749, -450.51683304597935, -913.0361902778118, -45.704603303973926, -572.7948719134627, -767.2369601632225, -860.433869352691, -1072.9911757286577, -489.7041524408953, -301.785090224641, -864.9687206518709, -331.69945786942435, -994.3454340430366, -91.18789343170756, -695.9511560576075, -859.1536764709508, -1243.0620757532022, -538.7366209946475, -873.5470473670814, -880.6405654113112, -697.783878474844, -452.7791267325948, -761.0267541354907, -820.3591576583541, -212.42749462904283, -496.60651876056534, -658.9089326250339, -521.9242571382938, -150.24145194482927, -1248.1055605047789, -186.91162607906472, -461.17252330095016, -429.5471542760077, -994.0687308002034, -654.6204427597562, -913.2878145785667, -76.4931190288113, -771.3343139659844, -475.3302957444394, -744.8260290294492, -374.7230332618905, -1151.7746798982664, -692.271837046974, -1137.022390471871, -619.510971240368, -949.564015905457, -594.3907397005598, -815.2803605800383, -1285.7328043218422, -133.31112352043138, -864.3444782429572, -527.0117038607478, -794.3707256695418, -846.7171032744789, -857.8972382086762, -1199.4751746322238, -1116.5104374152481, -1114.7125884511597, -225.3381497791169, -113.83044965608126, -1005.2323997071757, -974.6734333066408, -831.6227648397991, -118.36161764444651, -781.4923179828593, -786.8413864734719, -292.4947379657106, -1034.5177280506782], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 43, 150, 88, 63, 101, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 79, 150, 150, 127, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 139, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 75, 150, 90, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 93, 82, 150, 150, 150, 59, 150, 150, 125, 150], "policy_policy_0_reward": [-605.4712922378454, -793.3835002520241, -763.4906402425959, -731.0094043731189, -516.0893971993602, -1264.824797861367, -663.0945189135673, -135.69187288907105, -707.2036054859235, -893.5756154621216, -21.718866611911317, -499.2457768670992, -162.25494870196434, -143.15061522660164, -225.9744635658723, -755.7283588818328, -392.29944674496426, -620.3712822771415, -853.0575667097413, -895.1559009747697, -192.84297332161194, -1148.969118783926, -876.0274206508556, -1053.8191350974125, -489.5333108555822, -770.5938365461357, -234.60117720715286, -1040.3103572041825, -637.8285053371213, -371.3072991497101, -1195.174762433744, -686.1487088720861, -745.7576637762749, -450.51683304597935, -913.0361902778118, -45.704603303973926, -572.7948719134627, -767.2369601632225, -860.433869352691, -1072.9911757286577, -489.7041524408953, -301.785090224641, -864.9687206518709, -331.69945786942435, -994.3454340430366, -91.18789343170756, -695.9511560576075, -859.1536764709508, -1243.0620757532022, -538.7366209946475, -873.5470473670814, -880.6405654113112, -697.783878474844, -452.7791267325948, -761.0267541354907, -820.3591576583541, -212.42749462904283, -496.60651876056534, -658.9089326250339, -521.9242571382938, -150.24145194482927, -1248.1055605047789, -186.91162607906472, -461.17252330095016, -429.5471542760077, -994.0687308002034, -654.6204427597562, -913.2878145785667, -76.4931190288113, -771.3343139659844, -475.3302957444394, -744.8260290294492, -374.7230332618905, -1151.7746798982664, -692.271837046974, -1137.022390471871, -619.510971240368, -949.564015905457, -594.3907397005598, -815.2803605800383, -1285.7328043218422, -133.31112352043138, -864.3444782429572, -527.0117038607478, -794.3707256695418, -846.7171032744789, -857.8972382086762, -1199.4751746322238, -1116.5104374152481, -1114.7125884511597, -225.3381497791169, -113.83044965608126, -1005.2323997071757, -974.6734333066408, -831.6227648397991, -118.36161764444651, -781.4923179828593, -786.8413864734719, -292.4947379657106, -1034.5177280506782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562547897423032, "mean_inference_ms": 1.6869557538173103, "mean_action_processing_ms": 0.2825263492206877, "mean_env_wait_ms": 2.9820656975728594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01199030876159668, "StateBufferConnector_ms": 0.007946252822875977, "ViewRequirementAgentConnector_ms": 0.1938610076904297}, "num_episodes": 31, "episode_return_max": -21.718866611911317, "episode_return_min": -1285.7328043218422, "episode_return_mean": -668.9998410849264, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.63191606812103, "num_env_steps_trained_throughput_per_sec": 301.63191606812103, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12900.242, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12900.165, "sample_time_ms": 1021.288, "learn_time_ms": 11812.494, "learn_throughput": 338.625, "synch_weights_time_ms": 65.52}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00011", "date": "2024-08-03_11-18-55", "timestamp": 1722664135, "time_this_iter_s": 13.274209022521973, "time_total_s": 169.10578513145447, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b3010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 169.10578513145447, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.700000000000001, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.579802305996418, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.259712447226047, "policy_loss": -0.010976368825261791, "vf_loss": 8.277792770663897, "vf_explained_var": 0.6186712516471744, "kl": 0.015244444603558805, "entropy": 1.3963991946230332, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -20.96180979222371, "episode_reward_min": -1285.7328043218422, "episode_reward_mean": -698.573612613164, "episode_len_mean": 139.11, "episode_media": {}, "episodes_timesteps_total": 13911, "policy_reward_min": {"policy_0": -1285.7328043218422}, "policy_reward_max": {"policy_0": -20.96180979222371}, "policy_reward_mean": {"policy_0": -698.573612613164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1040.3103572041825, -637.8285053371213, -371.3072991497101, -1195.174762433744, -686.1487088720861, -745.7576637762749, -450.51683304597935, -913.0361902778118, -45.704603303973926, -572.7948719134627, -767.2369601632225, -860.433869352691, -1072.9911757286577, -489.7041524408953, -301.785090224641, -864.9687206518709, -331.69945786942435, -994.3454340430366, -91.18789343170756, -695.9511560576075, -859.1536764709508, -1243.0620757532022, -538.7366209946475, -873.5470473670814, -880.6405654113112, -697.783878474844, -452.7791267325948, -761.0267541354907, -820.3591576583541, -212.42749462904283, -496.60651876056534, -658.9089326250339, -521.9242571382938, -150.24145194482927, -1248.1055605047789, -186.91162607906472, -461.17252330095016, -429.5471542760077, -994.0687308002034, -654.6204427597562, -913.2878145785667, -76.4931190288113, -771.3343139659844, -475.3302957444394, -744.8260290294492, -374.7230332618905, -1151.7746798982664, -692.271837046974, -1137.022390471871, -619.510971240368, -949.564015905457, -594.3907397005598, -815.2803605800383, -1285.7328043218422, -133.31112352043138, -864.3444782429572, -527.0117038607478, -794.3707256695418, -846.7171032744789, -857.8972382086762, -1199.4751746322238, -1116.5104374152481, -1114.7125884511597, -225.3381497791169, -113.83044965608126, -1005.2323997071757, -974.6734333066408, -831.6227648397991, -118.36161764444651, -781.4923179828593, -786.8413864734719, -292.4947379657106, -1034.5177280506782, -774.6258161072066, -1107.4297997871606, -447.64195618709414, -1136.3952982145606, -1200.4430233080618, -660.9832242111189, -1031.85553166392, -783.2135426718332, -495.43614349785776, -1238.645440884847, -740.8068272434655, -903.577941895932, -762.3406157729883, -464.1314687895454, -348.53258974285177, -905.8358834851595, -968.0815120042176, -164.1493837471419, -519.4477624203786, -868.8114576312407, -150.7232605217177, -77.423609146906, -761.0342524615513, -1151.7510732666303, -20.96180979222371, -990.5922200416403, -691.6845522680958], "episode_lengths": [150, 150, 127, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 139, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 75, 150, 90, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 93, 82, 150, 150, 150, 59, 150, 150, 125, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 122, 150, 150, 86, 68, 150, 150, 48, 150, 150], "policy_policy_0_reward": [-1040.3103572041825, -637.8285053371213, -371.3072991497101, -1195.174762433744, -686.1487088720861, -745.7576637762749, -450.51683304597935, -913.0361902778118, -45.704603303973926, -572.7948719134627, -767.2369601632225, -860.433869352691, -1072.9911757286577, -489.7041524408953, -301.785090224641, -864.9687206518709, -331.69945786942435, -994.3454340430366, -91.18789343170756, -695.9511560576075, -859.1536764709508, -1243.0620757532022, -538.7366209946475, -873.5470473670814, -880.6405654113112, -697.783878474844, -452.7791267325948, -761.0267541354907, -820.3591576583541, -212.42749462904283, -496.60651876056534, -658.9089326250339, -521.9242571382938, -150.24145194482927, -1248.1055605047789, -186.91162607906472, -461.17252330095016, -429.5471542760077, -994.0687308002034, -654.6204427597562, -913.2878145785667, -76.4931190288113, -771.3343139659844, -475.3302957444394, -744.8260290294492, -374.7230332618905, -1151.7746798982664, -692.271837046974, -1137.022390471871, -619.510971240368, -949.564015905457, -594.3907397005598, -815.2803605800383, -1285.7328043218422, -133.31112352043138, -864.3444782429572, -527.0117038607478, -794.3707256695418, -846.7171032744789, -857.8972382086762, -1199.4751746322238, -1116.5104374152481, -1114.7125884511597, -225.3381497791169, -113.83044965608126, -1005.2323997071757, -974.6734333066408, -831.6227648397991, -118.36161764444651, -781.4923179828593, -786.8413864734719, -292.4947379657106, -1034.5177280506782, -774.6258161072066, -1107.4297997871606, -447.64195618709414, -1136.3952982145606, -1200.4430233080618, -660.9832242111189, -1031.85553166392, -783.2135426718332, -495.43614349785776, -1238.645440884847, -740.8068272434655, -903.577941895932, -762.3406157729883, -464.1314687895454, -348.53258974285177, -905.8358834851595, -968.0815120042176, -164.1493837471419, -519.4477624203786, -868.8114576312407, -150.7232605217177, -77.423609146906, -761.0342524615513, -1151.7510732666303, -20.96180979222371, -990.5922200416403, -691.6845522680958]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556106398209695, "mean_inference_ms": 1.6884580835326128, "mean_action_processing_ms": 0.2824263194993173, "mean_env_wait_ms": 2.9851777894855736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011984109878540039, "StateBufferConnector_ms": 0.007993221282958984, "ViewRequirementAgentConnector_ms": 0.1962146759033203}, "num_episodes": 27, "episode_return_max": -20.96180979222371, "episode_return_min": -1285.7328043218422, "episode_return_mean": -698.573612613164, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.4586138944659, "num_env_steps_trained_throughput_per_sec": 300.4586138944659, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12909.52, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12909.441, "sample_time_ms": 1030.408, "learn_time_ms": 11812.006, "learn_throughput": 338.638, "synch_weights_time_ms": 66.155}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00011", "date": "2024-08-03_11-19-09", "timestamp": 1722664149, "time_this_iter_s": 13.32528305053711, "time_total_s": 182.43106818199158, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b17e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 182.43106818199158, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.631578947368421, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.339547328154246, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.836663943529129, "policy_loss": -0.015023956495375993, "vf_loss": 7.858245453735193, "vf_explained_var": 0.6588745643074314, "kl": 0.015692296500734927, "entropy": 1.3619065547982852, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -20.96180979222371, "episode_reward_min": -1376.651304579133, "episode_reward_mean": -703.81771114157, "episode_len_mean": 138.29, "episode_media": {}, "episodes_timesteps_total": 13829, "policy_reward_min": {"policy_0": -1376.651304579133}, "policy_reward_max": {"policy_0": -20.96180979222371}, "policy_reward_mean": {"policy_0": -703.81771114157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-761.0267541354907, -820.3591576583541, -212.42749462904283, -496.60651876056534, -658.9089326250339, -521.9242571382938, -150.24145194482927, -1248.1055605047789, -186.91162607906472, -461.17252330095016, -429.5471542760077, -994.0687308002034, -654.6204427597562, -913.2878145785667, -76.4931190288113, -771.3343139659844, -475.3302957444394, -744.8260290294492, -374.7230332618905, -1151.7746798982664, -692.271837046974, -1137.022390471871, -619.510971240368, -949.564015905457, -594.3907397005598, -815.2803605800383, -1285.7328043218422, -133.31112352043138, -864.3444782429572, -527.0117038607478, -794.3707256695418, -846.7171032744789, -857.8972382086762, -1199.4751746322238, -1116.5104374152481, -1114.7125884511597, -225.3381497791169, -113.83044965608126, -1005.2323997071757, -974.6734333066408, -831.6227648397991, -118.36161764444651, -781.4923179828593, -786.8413864734719, -292.4947379657106, -1034.5177280506782, -774.6258161072066, -1107.4297997871606, -447.64195618709414, -1136.3952982145606, -1200.4430233080618, -660.9832242111189, -1031.85553166392, -783.2135426718332, -495.43614349785776, -1238.645440884847, -740.8068272434655, -903.577941895932, -762.3406157729883, -464.1314687895454, -348.53258974285177, -905.8358834851595, -968.0815120042176, -164.1493837471419, -519.4477624203786, -868.8114576312407, -150.7232605217177, -77.423609146906, -761.0342524615513, -1151.7510732666303, -20.96180979222371, -990.5922200416403, -691.6845522680958, -561.1950688355038, -596.3651331829815, -973.2056164454923, -165.11992416435262, -220.08805670796795, -1376.651304579133, -817.3449172920429, -1011.0703611178496, -963.078981842758, -1121.3562824523024, -719.4136456381307, -1084.7456386586546, -357.50659135673436, -773.9828812852805, -358.6472531029479, -408.64645289777144, -984.5973242366656, -1019.2738341750165, -892.9028728274734, -237.51196953261, -739.1242674057024, -336.42222764773305, -414.5730194202173, -1047.4125163582892, -798.0017542264585, -548.8637087062979, -671.8949452269461], "episode_lengths": [150, 150, 131, 150, 150, 150, 75, 150, 90, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 93, 82, 150, 150, 150, 59, 150, 150, 125, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 122, 150, 150, 86, 68, 150, 150, 48, 150, 150, 128, 150, 150, 93, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 101, 150, 103, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-761.0267541354907, -820.3591576583541, -212.42749462904283, -496.60651876056534, -658.9089326250339, -521.9242571382938, -150.24145194482927, -1248.1055605047789, -186.91162607906472, -461.17252330095016, -429.5471542760077, -994.0687308002034, -654.6204427597562, -913.2878145785667, -76.4931190288113, -771.3343139659844, -475.3302957444394, -744.8260290294492, -374.7230332618905, -1151.7746798982664, -692.271837046974, -1137.022390471871, -619.510971240368, -949.564015905457, -594.3907397005598, -815.2803605800383, -1285.7328043218422, -133.31112352043138, -864.3444782429572, -527.0117038607478, -794.3707256695418, -846.7171032744789, -857.8972382086762, -1199.4751746322238, -1116.5104374152481, -1114.7125884511597, -225.3381497791169, -113.83044965608126, -1005.2323997071757, -974.6734333066408, -831.6227648397991, -118.36161764444651, -781.4923179828593, -786.8413864734719, -292.4947379657106, -1034.5177280506782, -774.6258161072066, -1107.4297997871606, -447.64195618709414, -1136.3952982145606, -1200.4430233080618, -660.9832242111189, -1031.85553166392, -783.2135426718332, -495.43614349785776, -1238.645440884847, -740.8068272434655, -903.577941895932, -762.3406157729883, -464.1314687895454, -348.53258974285177, -905.8358834851595, -968.0815120042176, -164.1493837471419, -519.4477624203786, -868.8114576312407, -150.7232605217177, -77.423609146906, -761.0342524615513, -1151.7510732666303, -20.96180979222371, -990.5922200416403, -691.6845522680958, -561.1950688355038, -596.3651331829815, -973.2056164454923, -165.11992416435262, -220.08805670796795, -1376.651304579133, -817.3449172920429, -1011.0703611178496, -963.078981842758, -1121.3562824523024, -719.4136456381307, -1084.7456386586546, -357.50659135673436, -773.9828812852805, -358.6472531029479, -408.64645289777144, -984.5973242366656, -1019.2738341750165, -892.9028728274734, -237.51196953261, -739.1242674057024, -336.42222764773305, -414.5730194202173, -1047.4125163582892, -798.0017542264585, -548.8637087062979, -671.8949452269461]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559446391564523, "mean_inference_ms": 1.6887333494437222, "mean_action_processing_ms": 0.2819400445500544, "mean_env_wait_ms": 2.989505989316064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011864185333251953, "StateBufferConnector_ms": 0.007922649383544922, "ViewRequirementAgentConnector_ms": 0.19557738304138184}, "num_episodes": 27, "episode_return_max": -20.96180979222371, "episode_return_min": -1376.651304579133, "episode_return_mean": -703.81771114157, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.66872894279135, "num_env_steps_trained_throughput_per_sec": 299.66872894279135, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13113.613, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13113.533, "sample_time_ms": 1034.896, "learn_time_ms": 12010.103, "learn_throughput": 333.053, "synch_weights_time_ms": 67.646}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00011", "date": "2024-08-03_11-19-22", "timestamp": 1722664162, "time_this_iter_s": 13.363149642944336, "time_total_s": 195.7942178249359, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b29e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 195.7942178249359, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 13.655000000000001, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.11537040521701, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.80894250869751, "policy_loss": -0.010634927068895194, "vf_loss": 7.826771102845669, "vf_explained_var": 0.6410807731871804, "kl": 0.014816211631811408, "entropy": 1.3860962068041165, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -20.96180979222371, "episode_reward_min": -1376.651304579133, "episode_reward_mean": -728.0328990985022, "episode_len_mean": 137.82, "episode_media": {}, "episodes_timesteps_total": 13782, "policy_reward_min": {"policy_0": -1376.651304579133}, "policy_reward_max": {"policy_0": -20.96180979222371}, "policy_reward_mean": {"policy_0": -728.0328990985022}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-846.7171032744789, -857.8972382086762, -1199.4751746322238, -1116.5104374152481, -1114.7125884511597, -225.3381497791169, -113.83044965608126, -1005.2323997071757, -974.6734333066408, -831.6227648397991, -118.36161764444651, -781.4923179828593, -786.8413864734719, -292.4947379657106, -1034.5177280506782, -774.6258161072066, -1107.4297997871606, -447.64195618709414, -1136.3952982145606, -1200.4430233080618, -660.9832242111189, -1031.85553166392, -783.2135426718332, -495.43614349785776, -1238.645440884847, -740.8068272434655, -903.577941895932, -762.3406157729883, -464.1314687895454, -348.53258974285177, -905.8358834851595, -968.0815120042176, -164.1493837471419, -519.4477624203786, -868.8114576312407, -150.7232605217177, -77.423609146906, -761.0342524615513, -1151.7510732666303, -20.96180979222371, -990.5922200416403, -691.6845522680958, -561.1950688355038, -596.3651331829815, -973.2056164454923, -165.11992416435262, -220.08805670796795, -1376.651304579133, -817.3449172920429, -1011.0703611178496, -963.078981842758, -1121.3562824523024, -719.4136456381307, -1084.7456386586546, -357.50659135673436, -773.9828812852805, -358.6472531029479, -408.64645289777144, -984.5973242366656, -1019.2738341750165, -892.9028728274734, -237.51196953261, -739.1242674057024, -336.42222764773305, -414.5730194202173, -1047.4125163582892, -798.0017542264585, -548.8637087062979, -671.8949452269461, -631.0183508636749, -222.4789409762479, -769.2363840423524, -506.34699915586145, -1113.8834516587858, -720.8703318474003, -401.3837227038796, -1197.5691959285778, -1147.6601782530904, -841.2306982791039, -797.3053221138024, -1228.784179154105, -270.7907749056097, -1071.614178141866, -159.88432991590432, -857.4600833292626, -841.9560635634857, -397.50430563411203, -764.1501005542167, -662.3189199159879, -973.038284196698, -1138.1130317192878, -911.8195045312775, -64.48569538161388, -479.12726122856833, -780.3073578034055, -665.8049693648011, -641.1415176418785, -1268.9170636496183, -825.5849246500237, -586.2337152692998], "episode_lengths": [150, 150, 150, 150, 150, 93, 82, 150, 150, 150, 59, 150, 150, 125, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 122, 150, 150, 86, 68, 150, 150, 48, 150, 150, 128, 150, 150, 93, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 101, 150, 103, 150, 150, 150, 150, 150, 150, 84, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 71, 150, 150, 116, 150, 150, 150, 150, 150, 59, 150, 150, 139, 150, 150, 150, 150], "policy_policy_0_reward": [-846.7171032744789, -857.8972382086762, -1199.4751746322238, -1116.5104374152481, -1114.7125884511597, -225.3381497791169, -113.83044965608126, -1005.2323997071757, -974.6734333066408, -831.6227648397991, -118.36161764444651, -781.4923179828593, -786.8413864734719, -292.4947379657106, -1034.5177280506782, -774.6258161072066, -1107.4297997871606, -447.64195618709414, -1136.3952982145606, -1200.4430233080618, -660.9832242111189, -1031.85553166392, -783.2135426718332, -495.43614349785776, -1238.645440884847, -740.8068272434655, -903.577941895932, -762.3406157729883, -464.1314687895454, -348.53258974285177, -905.8358834851595, -968.0815120042176, -164.1493837471419, -519.4477624203786, -868.8114576312407, -150.7232605217177, -77.423609146906, -761.0342524615513, -1151.7510732666303, -20.96180979222371, -990.5922200416403, -691.6845522680958, -561.1950688355038, -596.3651331829815, -973.2056164454923, -165.11992416435262, -220.08805670796795, -1376.651304579133, -817.3449172920429, -1011.0703611178496, -963.078981842758, -1121.3562824523024, -719.4136456381307, -1084.7456386586546, -357.50659135673436, -773.9828812852805, -358.6472531029479, -408.64645289777144, -984.5973242366656, -1019.2738341750165, -892.9028728274734, -237.51196953261, -739.1242674057024, -336.42222764773305, -414.5730194202173, -1047.4125163582892, -798.0017542264585, -548.8637087062979, -671.8949452269461, -631.0183508636749, -222.4789409762479, -769.2363840423524, -506.34699915586145, -1113.8834516587858, -720.8703318474003, -401.3837227038796, -1197.5691959285778, -1147.6601782530904, -841.2306982791039, -797.3053221138024, -1228.784179154105, -270.7907749056097, -1071.614178141866, -159.88432991590432, -857.4600833292626, -841.9560635634857, -397.50430563411203, -764.1501005542167, -662.3189199159879, -973.038284196698, -1138.1130317192878, -911.8195045312775, -64.48569538161388, -479.12726122856833, -780.3073578034055, -665.8049693648011, -641.1415176418785, -1268.9170636496183, -825.5849246500237, -586.2337152692998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554053842107923, "mean_inference_ms": 1.687459694253897, "mean_action_processing_ms": 0.28133845956146536, "mean_env_wait_ms": 2.991339918452526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011727094650268555, "StateBufferConnector_ms": 0.007911205291748047, "ViewRequirementAgentConnector_ms": 0.19446516036987305}, "num_episodes": 31, "episode_return_max": -20.96180979222371, "episode_return_min": -1376.651304579133, "episode_return_mean": -728.0328990985022, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.22284873573767, "num_env_steps_trained_throughput_per_sec": 308.22284873573767, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13069.514, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13069.437, "sample_time_ms": 1033.69, "learn_time_ms": 11967.629, "learn_throughput": 334.235, "synch_weights_time_ms": 67.23}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00011", "date": "2024-08-03_11-19-35", "timestamp": 1722664175, "time_this_iter_s": 12.990429401397705, "time_total_s": 208.78464722633362, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d3eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 208.78464722633362, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.677777777777779, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.015505954126517, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.6864242096741995, "policy_loss": -0.006553312884837699, "vf_loss": 7.701757351557414, "vf_explained_var": 0.768215068988502, "kl": 0.011588253381372244, "entropy": 1.3994528599083425, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -20.96180979222371, "episode_reward_min": -1428.4288468269513, "episode_reward_mean": -700.1271884408544, "episode_len_mean": 134.0, "episode_media": {}, "episodes_timesteps_total": 13400, "policy_reward_min": {"policy_0": -1428.4288468269513}, "policy_reward_max": {"policy_0": -20.96180979222371}, "policy_reward_mean": {"policy_0": -700.1271884408544}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-164.1493837471419, -519.4477624203786, -868.8114576312407, -150.7232605217177, -77.423609146906, -761.0342524615513, -1151.7510732666303, -20.96180979222371, -990.5922200416403, -691.6845522680958, -561.1950688355038, -596.3651331829815, -973.2056164454923, -165.11992416435262, -220.08805670796795, -1376.651304579133, -817.3449172920429, -1011.0703611178496, -963.078981842758, -1121.3562824523024, -719.4136456381307, -1084.7456386586546, -357.50659135673436, -773.9828812852805, -358.6472531029479, -408.64645289777144, -984.5973242366656, -1019.2738341750165, -892.9028728274734, -237.51196953261, -739.1242674057024, -336.42222764773305, -414.5730194202173, -1047.4125163582892, -798.0017542264585, -548.8637087062979, -671.8949452269461, -631.0183508636749, -222.4789409762479, -769.2363840423524, -506.34699915586145, -1113.8834516587858, -720.8703318474003, -401.3837227038796, -1197.5691959285778, -1147.6601782530904, -841.2306982791039, -797.3053221138024, -1228.784179154105, -270.7907749056097, -1071.614178141866, -159.88432991590432, -857.4600833292626, -841.9560635634857, -397.50430563411203, -764.1501005542167, -662.3189199159879, -973.038284196698, -1138.1130317192878, -911.8195045312775, -64.48569538161388, -479.12726122856833, -780.3073578034055, -665.8049693648011, -641.1415176418785, -1268.9170636496183, -825.5849246500237, -586.2337152692998, -656.3341788387245, -817.0260932816628, -610.1342810206933, -949.113885021294, -71.28898205733036, -1428.4288468269513, -858.9719454825029, -942.1627329838892, -1124.1334136142743, -802.4931597303162, -1025.387886265024, -425.0353578137065, -116.51848116313826, -991.6229780751884, -1054.4777006499694, -1003.2246201078796, -1330.031789571548, -819.3001600873523, -864.5917117329348, -101.11340961002743, -224.64431539237276, -1224.4860247798254, -587.9010216565, -83.95599989729145, -167.39472190465696, -158.45096366924545, -918.7491827128783, -305.15312536402274, -941.510246056942, -896.9066288151274, -110.32688936093733, -868.2523435465877], "episode_lengths": [122, 150, 150, 86, 68, 150, 150, 48, 150, 150, 128, 150, 150, 93, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 101, 150, 103, 150, 150, 150, 150, 150, 150, 84, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 71, 150, 150, 116, 150, 150, 150, 150, 150, 59, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 83, 75, 150, 150, 53, 70, 67, 150, 86, 150, 150, 71, 144], "policy_policy_0_reward": [-164.1493837471419, -519.4477624203786, -868.8114576312407, -150.7232605217177, -77.423609146906, -761.0342524615513, -1151.7510732666303, -20.96180979222371, -990.5922200416403, -691.6845522680958, -561.1950688355038, -596.3651331829815, -973.2056164454923, -165.11992416435262, -220.08805670796795, -1376.651304579133, -817.3449172920429, -1011.0703611178496, -963.078981842758, -1121.3562824523024, -719.4136456381307, -1084.7456386586546, -357.50659135673436, -773.9828812852805, -358.6472531029479, -408.64645289777144, -984.5973242366656, -1019.2738341750165, -892.9028728274734, -237.51196953261, -739.1242674057024, -336.42222764773305, -414.5730194202173, -1047.4125163582892, -798.0017542264585, -548.8637087062979, -671.8949452269461, -631.0183508636749, -222.4789409762479, -769.2363840423524, -506.34699915586145, -1113.8834516587858, -720.8703318474003, -401.3837227038796, -1197.5691959285778, -1147.6601782530904, -841.2306982791039, -797.3053221138024, -1228.784179154105, -270.7907749056097, -1071.614178141866, -159.88432991590432, -857.4600833292626, -841.9560635634857, -397.50430563411203, -764.1501005542167, -662.3189199159879, -973.038284196698, -1138.1130317192878, -911.8195045312775, -64.48569538161388, -479.12726122856833, -780.3073578034055, -665.8049693648011, -641.1415176418785, -1268.9170636496183, -825.5849246500237, -586.2337152692998, -656.3341788387245, -817.0260932816628, -610.1342810206933, -949.113885021294, -71.28898205733036, -1428.4288468269513, -858.9719454825029, -942.1627329838892, -1124.1334136142743, -802.4931597303162, -1025.387886265024, -425.0353578137065, -116.51848116313826, -991.6229780751884, -1054.4777006499694, -1003.2246201078796, -1330.031789571548, -819.3001600873523, -864.5917117329348, -101.11340961002743, -224.64431539237276, -1224.4860247798254, -587.9010216565, -83.95599989729145, -167.39472190465696, -158.45096366924545, -918.7491827128783, -305.15312536402274, -941.510246056942, -896.9066288151274, -110.32688936093733, -868.2523435465877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550375227852312, "mean_inference_ms": 1.6865770251479715, "mean_action_processing_ms": 0.28101165600136413, "mean_env_wait_ms": 2.996155429901547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011780261993408203, "StateBufferConnector_ms": 0.008037805557250977, "ViewRequirementAgentConnector_ms": 0.19674301147460938}, "num_episodes": 32, "episode_return_max": -20.96180979222371, "episode_return_min": -1428.4288468269513, "episode_return_mean": -700.1271884408544, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.6504661627115, "num_env_steps_trained_throughput_per_sec": 303.6504661627115, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13016.351, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13016.276, "sample_time_ms": 1033.313, "learn_time_ms": 11916.029, "learn_throughput": 335.682, "synch_weights_time_ms": 66.043}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00011", "date": "2024-08-03_11-19-48", "timestamp": 1722664188, "time_this_iter_s": 13.186106443405151, "time_total_s": 221.97075366973877, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457624d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 221.97075366973877, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.926315789473685, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.162076410651206, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.8338065480192505, "policy_loss": -0.008965260069817304, "vf_loss": 7.846340521673361, "vf_explained_var": 0.7887870846937101, "kl": 0.016053588239674354, "entropy": 1.0792864869038263, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -64.48569538161388, "episode_reward_min": -1428.4288468269513, "episode_reward_mean": -697.7862405398644, "episode_len_mean": 135.07, "episode_media": {}, "episodes_timesteps_total": 13507, "policy_reward_min": {"policy_0": -1428.4288468269513}, "policy_reward_max": {"policy_0": -64.48569538161388}, "policy_reward_mean": {"policy_0": -697.7862405398644}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1019.2738341750165, -892.9028728274734, -237.51196953261, -739.1242674057024, -336.42222764773305, -414.5730194202173, -1047.4125163582892, -798.0017542264585, -548.8637087062979, -671.8949452269461, -631.0183508636749, -222.4789409762479, -769.2363840423524, -506.34699915586145, -1113.8834516587858, -720.8703318474003, -401.3837227038796, -1197.5691959285778, -1147.6601782530904, -841.2306982791039, -797.3053221138024, -1228.784179154105, -270.7907749056097, -1071.614178141866, -159.88432991590432, -857.4600833292626, -841.9560635634857, -397.50430563411203, -764.1501005542167, -662.3189199159879, -973.038284196698, -1138.1130317192878, -911.8195045312775, -64.48569538161388, -479.12726122856833, -780.3073578034055, -665.8049693648011, -641.1415176418785, -1268.9170636496183, -825.5849246500237, -586.2337152692998, -656.3341788387245, -817.0260932816628, -610.1342810206933, -949.113885021294, -71.28898205733036, -1428.4288468269513, -858.9719454825029, -942.1627329838892, -1124.1334136142743, -802.4931597303162, -1025.387886265024, -425.0353578137065, -116.51848116313826, -991.6229780751884, -1054.4777006499694, -1003.2246201078796, -1330.031789571548, -819.3001600873523, -864.5917117329348, -101.11340961002743, -224.64431539237276, -1224.4860247798254, -587.9010216565, -83.95599989729145, -167.39472190465696, -158.45096366924545, -918.7491827128783, -305.15312536402274, -941.510246056942, -896.9066288151274, -110.32688936093733, -868.2523435465877, -786.8575337637145, -939.5413160598341, -238.9876629531422, -982.6007992587972, -464.36500939590144, -939.2637964430941, -1002.7146708814964, -926.0752230490338, -787.9870283766687, -72.27320258839502, -924.3157893862445, -482.3273312784747, -890.4626495652593, -1263.7747830308917, -414.86520881495323, -627.7633310848263, -520.0239907771966, -804.9165066350901, -374.29851836853294, -118.71082439196789, -427.2644685805492, -280.246149953327, -761.4249321781949, -659.0903969838034, -495.3331555647789, -813.1601248046768, -656.8556208262653], "episode_lengths": [150, 150, 101, 150, 103, 150, 150, 150, 150, 150, 150, 84, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 71, 150, 150, 116, 150, 150, 150, 150, 150, 59, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 83, 75, 150, 150, 53, 70, 67, 150, 86, 150, 150, 71, 144, 150, 150, 114, 150, 127, 150, 150, 150, 150, 48, 150, 137, 150, 150, 150, 150, 130, 150, 112, 90, 143, 90, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1019.2738341750165, -892.9028728274734, -237.51196953261, -739.1242674057024, -336.42222764773305, -414.5730194202173, -1047.4125163582892, -798.0017542264585, -548.8637087062979, -671.8949452269461, -631.0183508636749, -222.4789409762479, -769.2363840423524, -506.34699915586145, -1113.8834516587858, -720.8703318474003, -401.3837227038796, -1197.5691959285778, -1147.6601782530904, -841.2306982791039, -797.3053221138024, -1228.784179154105, -270.7907749056097, -1071.614178141866, -159.88432991590432, -857.4600833292626, -841.9560635634857, -397.50430563411203, -764.1501005542167, -662.3189199159879, -973.038284196698, -1138.1130317192878, -911.8195045312775, -64.48569538161388, -479.12726122856833, -780.3073578034055, -665.8049693648011, -641.1415176418785, -1268.9170636496183, -825.5849246500237, -586.2337152692998, -656.3341788387245, -817.0260932816628, -610.1342810206933, -949.113885021294, -71.28898205733036, -1428.4288468269513, -858.9719454825029, -942.1627329838892, -1124.1334136142743, -802.4931597303162, -1025.387886265024, -425.0353578137065, -116.51848116313826, -991.6229780751884, -1054.4777006499694, -1003.2246201078796, -1330.031789571548, -819.3001600873523, -864.5917117329348, -101.11340961002743, -224.64431539237276, -1224.4860247798254, -587.9010216565, -83.95599989729145, -167.39472190465696, -158.45096366924545, -918.7491827128783, -305.15312536402274, -941.510246056942, -896.9066288151274, -110.32688936093733, -868.2523435465877, -786.8575337637145, -939.5413160598341, -238.9876629531422, -982.6007992587972, -464.36500939590144, -939.2637964430941, -1002.7146708814964, -926.0752230490338, -787.9870283766687, -72.27320258839502, -924.3157893862445, -482.3273312784747, -890.4626495652593, -1263.7747830308917, -414.86520881495323, -627.7633310848263, -520.0239907771966, -804.9165066350901, -374.29851836853294, -118.71082439196789, -427.2644685805492, -280.246149953327, -761.4249321781949, -659.0903969838034, -495.3331555647789, -813.1601248046768, -656.8556208262653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543302061625184, "mean_inference_ms": 1.6868515664207535, "mean_action_processing_ms": 0.28092808541440734, "mean_env_wait_ms": 2.9979083766707406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011670827865600586, "StateBufferConnector_ms": 0.008023977279663086, "ViewRequirementAgentConnector_ms": 0.19736051559448242}, "num_episodes": 27, "episode_return_max": -64.48569538161388, "episode_return_min": -1428.4288468269513, "episode_return_mean": -697.7862405398644, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.4581324292622, "num_env_steps_trained_throughput_per_sec": 295.4581324292622, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13074.048, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13073.974, "sample_time_ms": 1033.878, "learn_time_ms": 11975.008, "learn_throughput": 334.029, "synch_weights_time_ms": 64.204}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00011", "date": "2024-08-03_11-20-02", "timestamp": 1722664202, "time_this_iter_s": 13.551199913024902, "time_total_s": 235.52195358276367, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b29e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 235.52195358276367, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.494736842105262, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.41763900667429, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.776108372211456, "policy_loss": -0.014318206473641718, "vf_loss": 7.7997543906172115, "vf_explained_var": 0.7833372452606757, "kl": 0.015616122291279073, "entropy": 1.6355062610159317, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -49.96488262292365, "episode_reward_min": -1428.4288468269513, "episode_reward_mean": -680.9714716714485, "episode_len_mean": 131.95, "episode_media": {}, "episodes_timesteps_total": 13195, "policy_reward_min": {"policy_0": -1428.4288468269513}, "policy_reward_max": {"policy_0": -49.96488262292365}, "policy_reward_mean": {"policy_0": -680.9714716714485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-479.12726122856833, -780.3073578034055, -665.8049693648011, -641.1415176418785, -1268.9170636496183, -825.5849246500237, -586.2337152692998, -656.3341788387245, -817.0260932816628, -610.1342810206933, -949.113885021294, -71.28898205733036, -1428.4288468269513, -858.9719454825029, -942.1627329838892, -1124.1334136142743, -802.4931597303162, -1025.387886265024, -425.0353578137065, -116.51848116313826, -991.6229780751884, -1054.4777006499694, -1003.2246201078796, -1330.031789571548, -819.3001600873523, -864.5917117329348, -101.11340961002743, -224.64431539237276, -1224.4860247798254, -587.9010216565, -83.95599989729145, -167.39472190465696, -158.45096366924545, -918.7491827128783, -305.15312536402274, -941.510246056942, -896.9066288151274, -110.32688936093733, -868.2523435465877, -786.8575337637145, -939.5413160598341, -238.9876629531422, -982.6007992587972, -464.36500939590144, -939.2637964430941, -1002.7146708814964, -926.0752230490338, -787.9870283766687, -72.27320258839502, -924.3157893862445, -482.3273312784747, -890.4626495652593, -1263.7747830308917, -414.86520881495323, -627.7633310848263, -520.0239907771966, -804.9165066350901, -374.29851836853294, -118.71082439196789, -427.2644685805492, -280.246149953327, -761.4249321781949, -659.0903969838034, -495.3331555647789, -813.1601248046768, -656.8556208262653, -150.094155169176, -1005.3295948093738, -1027.3286847048805, -285.6298560108714, -119.43449990432144, -838.9248742779511, -85.21581721086133, -978.5151886806045, -714.6049912055014, -1257.5165720785883, -712.1782656715029, -131.87480020316292, -373.41121716011025, -742.7118794788196, -497.92133192703, -1385.8378802325155, -131.29829178187407, -978.9725869226502, -890.6839867723934, -897.039809303042, -988.4333454123241, -846.4279772616725, -49.96488262292365, -990.3009561533104, -999.6023493669686, -725.064353545608, -133.8337231602715, -943.3063945896076, -988.7552895085573, -556.730457230454, -156.8986675348571, -83.15679604800222, -921.7771843743641, -1126.6305951371994], "episode_lengths": [150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 83, 75, 150, 150, 53, 70, 67, 150, 86, 150, 150, 71, 144, 150, 150, 114, 150, 127, 150, 150, 150, 150, 48, 150, 137, 150, 150, 150, 150, 130, 150, 112, 90, 143, 90, 150, 150, 150, 150, 150, 100, 150, 150, 105, 60, 150, 59, 150, 150, 150, 150, 68, 106, 147, 150, 150, 91, 150, 150, 150, 150, 150, 59, 150, 150, 150, 94, 150, 150, 150, 89, 76, 150, 150], "policy_policy_0_reward": [-479.12726122856833, -780.3073578034055, -665.8049693648011, -641.1415176418785, -1268.9170636496183, -825.5849246500237, -586.2337152692998, -656.3341788387245, -817.0260932816628, -610.1342810206933, -949.113885021294, -71.28898205733036, -1428.4288468269513, -858.9719454825029, -942.1627329838892, -1124.1334136142743, -802.4931597303162, -1025.387886265024, -425.0353578137065, -116.51848116313826, -991.6229780751884, -1054.4777006499694, -1003.2246201078796, -1330.031789571548, -819.3001600873523, -864.5917117329348, -101.11340961002743, -224.64431539237276, -1224.4860247798254, -587.9010216565, -83.95599989729145, -167.39472190465696, -158.45096366924545, -918.7491827128783, -305.15312536402274, -941.510246056942, -896.9066288151274, -110.32688936093733, -868.2523435465877, -786.8575337637145, -939.5413160598341, -238.9876629531422, -982.6007992587972, -464.36500939590144, -939.2637964430941, -1002.7146708814964, -926.0752230490338, -787.9870283766687, -72.27320258839502, -924.3157893862445, -482.3273312784747, -890.4626495652593, -1263.7747830308917, -414.86520881495323, -627.7633310848263, -520.0239907771966, -804.9165066350901, -374.29851836853294, -118.71082439196789, -427.2644685805492, -280.246149953327, -761.4249321781949, -659.0903969838034, -495.3331555647789, -813.1601248046768, -656.8556208262653, -150.094155169176, -1005.3295948093738, -1027.3286847048805, -285.6298560108714, -119.43449990432144, -838.9248742779511, -85.21581721086133, -978.5151886806045, -714.6049912055014, -1257.5165720785883, -712.1782656715029, -131.87480020316292, -373.41121716011025, -742.7118794788196, -497.92133192703, -1385.8378802325155, -131.29829178187407, -978.9725869226502, -890.6839867723934, -897.039809303042, -988.4333454123241, -846.4279772616725, -49.96488262292365, -990.3009561533104, -999.6023493669686, -725.064353545608, -133.8337231602715, -943.3063945896076, -988.7552895085573, -556.730457230454, -156.8986675348571, -83.15679604800222, -921.7771843743641, -1126.6305951371994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538928442682727, "mean_inference_ms": 1.6849309241368797, "mean_action_processing_ms": 0.28045306108537305, "mean_env_wait_ms": 3.0018509472459654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011696815490722656, "StateBufferConnector_ms": 0.007976055145263672, "ViewRequirementAgentConnector_ms": 0.19643259048461914}, "num_episodes": 34, "episode_return_max": -49.96488262292365, "episode_return_min": -1428.4288468269513, "episode_return_mean": -680.9714716714485, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.0376127093404, "num_env_steps_trained_throughput_per_sec": 301.0376127093404, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13195.602, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13195.526, "sample_time_ms": 1037.046, "learn_time_ms": 12093.177, "learn_throughput": 330.765, "synch_weights_time_ms": 64.424}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00011", "date": "2024-08-03_11-20-15", "timestamp": 1722664215, "time_this_iter_s": 13.29875898361206, "time_total_s": 248.82071256637573, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d3eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 248.82071256637573, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.889473684210525, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.457158190508686, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.31341747144858, "policy_loss": -0.004794526824359006, "vf_loss": 7.3322955513993895, "vf_explained_var": 0.7199805667623878, "kl": 0.011805862618681837, "entropy": 1.9396212007850409, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -49.96488262292365, "episode_reward_min": -1392.0753364835969, "episode_reward_mean": -698.7084737722947, "episode_len_mean": 132.38, "episode_media": {}, "episodes_timesteps_total": 13238, "policy_reward_min": {"policy_0": -1392.0753364835969}, "policy_reward_max": {"policy_0": -49.96488262292365}, "policy_reward_mean": {"policy_0": -698.7084737722947}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.39472190465696, -158.45096366924545, -918.7491827128783, -305.15312536402274, -941.510246056942, -896.9066288151274, -110.32688936093733, -868.2523435465877, -786.8575337637145, -939.5413160598341, -238.9876629531422, -982.6007992587972, -464.36500939590144, -939.2637964430941, -1002.7146708814964, -926.0752230490338, -787.9870283766687, -72.27320258839502, -924.3157893862445, -482.3273312784747, -890.4626495652593, -1263.7747830308917, -414.86520881495323, -627.7633310848263, -520.0239907771966, -804.9165066350901, -374.29851836853294, -118.71082439196789, -427.2644685805492, -280.246149953327, -761.4249321781949, -659.0903969838034, -495.3331555647789, -813.1601248046768, -656.8556208262653, -150.094155169176, -1005.3295948093738, -1027.3286847048805, -285.6298560108714, -119.43449990432144, -838.9248742779511, -85.21581721086133, -978.5151886806045, -714.6049912055014, -1257.5165720785883, -712.1782656715029, -131.87480020316292, -373.41121716011025, -742.7118794788196, -497.92133192703, -1385.8378802325155, -131.29829178187407, -978.9725869226502, -890.6839867723934, -897.039809303042, -988.4333454123241, -846.4279772616725, -49.96488262292365, -990.3009561533104, -999.6023493669686, -725.064353545608, -133.8337231602715, -943.3063945896076, -988.7552895085573, -556.730457230454, -156.8986675348571, -83.15679604800222, -921.7771843743641, -1126.6305951371994, -740.8874716110633, -1054.3334669602418, -525.6698240841425, -926.9662379985477, -802.6158364985832, -1188.5211415464075, -1254.9056760217095, -494.2314255200481, -799.0876713480563, -781.3630507836308, -133.43145676381027, -1367.5622968299344, -801.2198057286677, -882.9928180282918, -1214.7863936407077, -926.9325022139319, -284.9194768147022, -765.7371534571159, -677.784193264635, -172.47345182154316, -855.1871199344035, -674.4016631978922, -921.6669686386948, -1059.8062202131284, -112.981424923144, -1392.0753364835969, -1262.388069534277, -953.4103347590839, -254.02954352984494, -1019.0945026633667, -831.7334605394026], "episode_lengths": [70, 67, 150, 86, 150, 150, 71, 144, 150, 150, 114, 150, 127, 150, 150, 150, 150, 48, 150, 137, 150, 150, 150, 150, 130, 150, 112, 90, 143, 90, 150, 150, 150, 150, 150, 100, 150, 150, 105, 60, 150, 59, 150, 150, 150, 150, 68, 106, 147, 150, 150, 91, 150, 150, 150, 150, 150, 59, 150, 150, 150, 94, 150, 150, 150, 89, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 90, 150, 150, 86, 150, 150, 150, 150, 84, 150, 150, 150, 78, 150, 150], "policy_policy_0_reward": [-167.39472190465696, -158.45096366924545, -918.7491827128783, -305.15312536402274, -941.510246056942, -896.9066288151274, -110.32688936093733, -868.2523435465877, -786.8575337637145, -939.5413160598341, -238.9876629531422, -982.6007992587972, -464.36500939590144, -939.2637964430941, -1002.7146708814964, -926.0752230490338, -787.9870283766687, -72.27320258839502, -924.3157893862445, -482.3273312784747, -890.4626495652593, -1263.7747830308917, -414.86520881495323, -627.7633310848263, -520.0239907771966, -804.9165066350901, -374.29851836853294, -118.71082439196789, -427.2644685805492, -280.246149953327, -761.4249321781949, -659.0903969838034, -495.3331555647789, -813.1601248046768, -656.8556208262653, -150.094155169176, -1005.3295948093738, -1027.3286847048805, -285.6298560108714, -119.43449990432144, -838.9248742779511, -85.21581721086133, -978.5151886806045, -714.6049912055014, -1257.5165720785883, -712.1782656715029, -131.87480020316292, -373.41121716011025, -742.7118794788196, -497.92133192703, -1385.8378802325155, -131.29829178187407, -978.9725869226502, -890.6839867723934, -897.039809303042, -988.4333454123241, -846.4279772616725, -49.96488262292365, -990.3009561533104, -999.6023493669686, -725.064353545608, -133.8337231602715, -943.3063945896076, -988.7552895085573, -556.730457230454, -156.8986675348571, -83.15679604800222, -921.7771843743641, -1126.6305951371994, -740.8874716110633, -1054.3334669602418, -525.6698240841425, -926.9662379985477, -802.6158364985832, -1188.5211415464075, -1254.9056760217095, -494.2314255200481, -799.0876713480563, -781.3630507836308, -133.43145676381027, -1367.5622968299344, -801.2198057286677, -882.9928180282918, -1214.7863936407077, -926.9325022139319, -284.9194768147022, -765.7371534571159, -677.784193264635, -172.47345182154316, -855.1871199344035, -674.4016631978922, -921.6669686386948, -1059.8062202131284, -112.981424923144, -1392.0753364835969, -1262.388069534277, -953.4103347590839, -254.02954352984494, -1019.0945026633667, -831.7334605394026]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536039252431534, "mean_inference_ms": 1.6834864707779185, "mean_action_processing_ms": 0.28015861637472705, "mean_env_wait_ms": 3.005224318831934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011442184448242188, "StateBufferConnector_ms": 0.007745504379272461, "ViewRequirementAgentConnector_ms": 0.19197869300842285}, "num_episodes": 31, "episode_return_max": -49.96488262292365, "episode_return_min": -1392.0753364835969, "episode_return_mean": -698.7084737722947, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.26652778572867, "num_env_steps_trained_throughput_per_sec": 301.26652778572867, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13233.712, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13233.634, "sample_time_ms": 1041.455, "learn_time_ms": 12126.359, "learn_throughput": 329.86, "synch_weights_time_ms": 64.932}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00011", "date": "2024-08-03_11-20-28", "timestamp": 1722664228, "time_this_iter_s": 13.289087772369385, "time_total_s": 262.1098003387451, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245762950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 262.1098003387451, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.72105263157895, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.12257142364979, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.759953883786996, "policy_loss": -0.011886317450747204, "vf_loss": 7.780312871932983, "vf_explained_var": 0.8677389642844597, "kl": 0.01631726045158454, "entropy": 1.5815433171888194, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -49.96488262292365, "episode_reward_min": -1392.0753364835969, "episode_reward_mean": -705.9051512620409, "episode_len_mean": 130.5, "episode_media": {}, "episodes_timesteps_total": 13050, "policy_reward_min": {"policy_0": -1392.0753364835969}, "policy_reward_max": {"policy_0": -49.96488262292365}, "policy_reward_mean": {"policy_0": -705.9051512620409}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-280.246149953327, -761.4249321781949, -659.0903969838034, -495.3331555647789, -813.1601248046768, -656.8556208262653, -150.094155169176, -1005.3295948093738, -1027.3286847048805, -285.6298560108714, -119.43449990432144, -838.9248742779511, -85.21581721086133, -978.5151886806045, -714.6049912055014, -1257.5165720785883, -712.1782656715029, -131.87480020316292, -373.41121716011025, -742.7118794788196, -497.92133192703, -1385.8378802325155, -131.29829178187407, -978.9725869226502, -890.6839867723934, -897.039809303042, -988.4333454123241, -846.4279772616725, -49.96488262292365, -990.3009561533104, -999.6023493669686, -725.064353545608, -133.8337231602715, -943.3063945896076, -988.7552895085573, -556.730457230454, -156.8986675348571, -83.15679604800222, -921.7771843743641, -1126.6305951371994, -740.8874716110633, -1054.3334669602418, -525.6698240841425, -926.9662379985477, -802.6158364985832, -1188.5211415464075, -1254.9056760217095, -494.2314255200481, -799.0876713480563, -781.3630507836308, -133.43145676381027, -1367.5622968299344, -801.2198057286677, -882.9928180282918, -1214.7863936407077, -926.9325022139319, -284.9194768147022, -765.7371534571159, -677.784193264635, -172.47345182154316, -855.1871199344035, -674.4016631978922, -921.6669686386948, -1059.8062202131284, -112.981424923144, -1392.0753364835969, -1262.388069534277, -953.4103347590839, -254.02954352984494, -1019.0945026633667, -831.7334605394026, -383.5945642233917, -140.30112842331886, -1283.4223053691012, -765.0447740246221, -292.06303485869284, -976.1588024497942, -1223.2770237415714, -136.60389307931885, -476.8584359127723, -1004.1576733745433, -528.4780803545212, -1215.4103622685384, -1157.3669199146464, -1017.7604207524935, -1010.6360188680177, -1299.125886644327, -1057.620435395934, -222.75702821900927, -160.82675099049004, -1124.386100186593, -734.6985580209916, -84.20214178005133, -103.67320526917226, -968.272839331013, -294.4919097717065, -57.74705717324679, -369.2807274095773, -859.2550254786761, -128.33039180295137], "episode_lengths": [90, 150, 150, 150, 150, 150, 100, 150, 150, 105, 60, 150, 59, 150, 150, 150, 150, 68, 106, 147, 150, 150, 91, 150, 150, 150, 150, 150, 59, 150, 150, 150, 94, 150, 150, 150, 89, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 90, 150, 150, 86, 150, 150, 150, 150, 84, 150, 150, 150, 78, 150, 150, 113, 71, 150, 150, 90, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 74, 150, 150, 77, 67, 150, 115, 54, 99, 150, 80], "policy_policy_0_reward": [-280.246149953327, -761.4249321781949, -659.0903969838034, -495.3331555647789, -813.1601248046768, -656.8556208262653, -150.094155169176, -1005.3295948093738, -1027.3286847048805, -285.6298560108714, -119.43449990432144, -838.9248742779511, -85.21581721086133, -978.5151886806045, -714.6049912055014, -1257.5165720785883, -712.1782656715029, -131.87480020316292, -373.41121716011025, -742.7118794788196, -497.92133192703, -1385.8378802325155, -131.29829178187407, -978.9725869226502, -890.6839867723934, -897.039809303042, -988.4333454123241, -846.4279772616725, -49.96488262292365, -990.3009561533104, -999.6023493669686, -725.064353545608, -133.8337231602715, -943.3063945896076, -988.7552895085573, -556.730457230454, -156.8986675348571, -83.15679604800222, -921.7771843743641, -1126.6305951371994, -740.8874716110633, -1054.3334669602418, -525.6698240841425, -926.9662379985477, -802.6158364985832, -1188.5211415464075, -1254.9056760217095, -494.2314255200481, -799.0876713480563, -781.3630507836308, -133.43145676381027, -1367.5622968299344, -801.2198057286677, -882.9928180282918, -1214.7863936407077, -926.9325022139319, -284.9194768147022, -765.7371534571159, -677.784193264635, -172.47345182154316, -855.1871199344035, -674.4016631978922, -921.6669686386948, -1059.8062202131284, -112.981424923144, -1392.0753364835969, -1262.388069534277, -953.4103347590839, -254.02954352984494, -1019.0945026633667, -831.7334605394026, -383.5945642233917, -140.30112842331886, -1283.4223053691012, -765.0447740246221, -292.06303485869284, -976.1588024497942, -1223.2770237415714, -136.60389307931885, -476.8584359127723, -1004.1576733745433, -528.4780803545212, -1215.4103622685384, -1157.3669199146464, -1017.7604207524935, -1010.6360188680177, -1299.125886644327, -1057.620435395934, -222.75702821900927, -160.82675099049004, -1124.386100186593, -734.6985580209916, -84.20214178005133, -103.67320526917226, -968.272839331013, -294.4919097717065, -57.74705717324679, -369.2807274095773, -859.2550254786761, -128.33039180295137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553347488549219, "mean_inference_ms": 1.6823495303752065, "mean_action_processing_ms": 0.27977212122868184, "mean_env_wait_ms": 3.009247375015517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01145482063293457, "StateBufferConnector_ms": 0.007713794708251953, "ViewRequirementAgentConnector_ms": 0.1903226375579834}, "num_episodes": 29, "episode_return_max": -49.96488262292365, "episode_return_min": -1392.0753364835969, "episode_return_mean": -705.9051512620409, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.9027945237801, "num_env_steps_trained_throughput_per_sec": 297.9027945237801, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13259.47, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13259.393, "sample_time_ms": 1047.565, "learn_time_ms": 12145.523, "learn_throughput": 329.339, "synch_weights_time_ms": 65.417}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00011", "date": "2024-08-03_11-20-42", "timestamp": 1722664242, "time_this_iter_s": 13.43869161605835, "time_total_s": 275.54849195480347, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b3880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 275.54849195480347, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.521052631578947, "ram_util_percent": 27.72631578947368}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 38.22205118288596, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.685379355649153, "policy_loss": -0.012220599233114627, "vf_loss": 7.707724652687708, "vf_explained_var": 0.8701602915301919, "kl": 0.017225352256809857, "entropy": 1.787608189880848, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -49.96488262292365, "episode_reward_min": -1392.0753364835969, "episode_reward_mean": -737.2639484014624, "episode_len_mean": 132.5, "episode_media": {}, "episodes_timesteps_total": 13250, "policy_reward_min": {"policy_0": -1392.0753364835969}, "policy_reward_max": {"policy_0": -49.96488262292365}, "policy_reward_mean": {"policy_0": -737.2639484014624}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.96488262292365, -990.3009561533104, -999.6023493669686, -725.064353545608, -133.8337231602715, -943.3063945896076, -988.7552895085573, -556.730457230454, -156.8986675348571, -83.15679604800222, -921.7771843743641, -1126.6305951371994, -740.8874716110633, -1054.3334669602418, -525.6698240841425, -926.9662379985477, -802.6158364985832, -1188.5211415464075, -1254.9056760217095, -494.2314255200481, -799.0876713480563, -781.3630507836308, -133.43145676381027, -1367.5622968299344, -801.2198057286677, -882.9928180282918, -1214.7863936407077, -926.9325022139319, -284.9194768147022, -765.7371534571159, -677.784193264635, -172.47345182154316, -855.1871199344035, -674.4016631978922, -921.6669686386948, -1059.8062202131284, -112.981424923144, -1392.0753364835969, -1262.388069534277, -953.4103347590839, -254.02954352984494, -1019.0945026633667, -831.7334605394026, -383.5945642233917, -140.30112842331886, -1283.4223053691012, -765.0447740246221, -292.06303485869284, -976.1588024497942, -1223.2770237415714, -136.60389307931885, -476.8584359127723, -1004.1576733745433, -528.4780803545212, -1215.4103622685384, -1157.3669199146464, -1017.7604207524935, -1010.6360188680177, -1299.125886644327, -1057.620435395934, -222.75702821900927, -160.82675099049004, -1124.386100186593, -734.6985580209916, -84.20214178005133, -103.67320526917226, -968.272839331013, -294.4919097717065, -57.74705717324679, -369.2807274095773, -859.2550254786761, -128.33039180295137, -224.7858753460434, -1221.4004420801691, -502.568877507719, -396.01094742605255, -839.6903890650859, -326.71071967021214, -1324.4841488822883, -935.9024932928933, -988.1096461092652, -899.541960990638, -421.61904856996614, -104.61581556371003, -1031.4108485479474, -1188.587362563216, -341.16397913060604, -1074.6137254503215, -892.4364835917926, -120.04363626317782, -1288.1652829861875, -1206.4912578729145, -908.7711647635762, -833.0290986929698, -1381.3426235328716, -319.3421634668727, -1137.7212323438634, -966.5103294956035, -729.4010349901463, -236.90511223630077], "episode_lengths": [59, 150, 150, 150, 94, 150, 150, 150, 89, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 90, 150, 150, 86, 150, 150, 150, 150, 84, 150, 150, 150, 78, 150, 150, 113, 71, 150, 150, 90, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 74, 150, 150, 77, 67, 150, 115, 54, 99, 150, 80, 113, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 79, 150, 150, 139, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76], "policy_policy_0_reward": [-49.96488262292365, -990.3009561533104, -999.6023493669686, -725.064353545608, -133.8337231602715, -943.3063945896076, -988.7552895085573, -556.730457230454, -156.8986675348571, -83.15679604800222, -921.7771843743641, -1126.6305951371994, -740.8874716110633, -1054.3334669602418, -525.6698240841425, -926.9662379985477, -802.6158364985832, -1188.5211415464075, -1254.9056760217095, -494.2314255200481, -799.0876713480563, -781.3630507836308, -133.43145676381027, -1367.5622968299344, -801.2198057286677, -882.9928180282918, -1214.7863936407077, -926.9325022139319, -284.9194768147022, -765.7371534571159, -677.784193264635, -172.47345182154316, -855.1871199344035, -674.4016631978922, -921.6669686386948, -1059.8062202131284, -112.981424923144, -1392.0753364835969, -1262.388069534277, -953.4103347590839, -254.02954352984494, -1019.0945026633667, -831.7334605394026, -383.5945642233917, -140.30112842331886, -1283.4223053691012, -765.0447740246221, -292.06303485869284, -976.1588024497942, -1223.2770237415714, -136.60389307931885, -476.8584359127723, -1004.1576733745433, -528.4780803545212, -1215.4103622685384, -1157.3669199146464, -1017.7604207524935, -1010.6360188680177, -1299.125886644327, -1057.620435395934, -222.75702821900927, -160.82675099049004, -1124.386100186593, -734.6985580209916, -84.20214178005133, -103.67320526917226, -968.272839331013, -294.4919097717065, -57.74705717324679, -369.2807274095773, -859.2550254786761, -128.33039180295137, -224.7858753460434, -1221.4004420801691, -502.568877507719, -396.01094742605255, -839.6903890650859, -326.71071967021214, -1324.4841488822883, -935.9024932928933, -988.1096461092652, -899.541960990638, -421.61904856996614, -104.61581556371003, -1031.4108485479474, -1188.587362563216, -341.16397913060604, -1074.6137254503215, -892.4364835917926, -120.04363626317782, -1288.1652829861875, -1206.4912578729145, -908.7711647635762, -833.0290986929698, -1381.3426235328716, -319.3421634668727, -1137.7212323438634, -966.5103294956035, -729.4010349901463, -236.90511223630077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532670534764592, "mean_inference_ms": 1.6827045024441798, "mean_action_processing_ms": 0.27978842049185126, "mean_env_wait_ms": 3.0140728598354487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011450052261352539, "StateBufferConnector_ms": 0.007713794708251953, "ViewRequirementAgentConnector_ms": 0.18971014022827148}, "num_episodes": 28, "episode_return_max": -49.96488262292365, "episode_return_min": -1392.0753364835969, "episode_return_mean": -737.2639484014624, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.46138947515965, "num_env_steps_trained_throughput_per_sec": 290.46138947515965, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13337.439, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13337.361, "sample_time_ms": 1049.527, "learn_time_ms": 12221.094, "learn_throughput": 327.303, "synch_weights_time_ms": 65.835}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00011", "date": "2024-08-03_11-20-56", "timestamp": 1722664256, "time_this_iter_s": 13.78324031829834, "time_total_s": 289.3317322731018, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b37f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 289.3317322731018, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.565000000000001, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.4324278652668, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.065164731939634, "policy_loss": -0.007512668824832266, "vf_loss": 7.081826788187027, "vf_explained_var": 0.878842880576849, "kl": 0.015288806963265752, "entropy": 1.6029352266341448, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -57.74705717324679, "episode_reward_min": -1431.1583793385205, "episode_reward_mean": -736.5249986921825, "episode_len_mean": 132.56, "episode_media": {}, "episodes_timesteps_total": 13256, "policy_reward_min": {"policy_0": -1431.1583793385205}, "policy_reward_max": {"policy_0": -57.74705717324679}, "policy_reward_mean": {"policy_0": -736.5249986921825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-765.7371534571159, -677.784193264635, -172.47345182154316, -855.1871199344035, -674.4016631978922, -921.6669686386948, -1059.8062202131284, -112.981424923144, -1392.0753364835969, -1262.388069534277, -953.4103347590839, -254.02954352984494, -1019.0945026633667, -831.7334605394026, -383.5945642233917, -140.30112842331886, -1283.4223053691012, -765.0447740246221, -292.06303485869284, -976.1588024497942, -1223.2770237415714, -136.60389307931885, -476.8584359127723, -1004.1576733745433, -528.4780803545212, -1215.4103622685384, -1157.3669199146464, -1017.7604207524935, -1010.6360188680177, -1299.125886644327, -1057.620435395934, -222.75702821900927, -160.82675099049004, -1124.386100186593, -734.6985580209916, -84.20214178005133, -103.67320526917226, -968.272839331013, -294.4919097717065, -57.74705717324679, -369.2807274095773, -859.2550254786761, -128.33039180295137, -224.7858753460434, -1221.4004420801691, -502.568877507719, -396.01094742605255, -839.6903890650859, -326.71071967021214, -1324.4841488822883, -935.9024932928933, -988.1096461092652, -899.541960990638, -421.61904856996614, -104.61581556371003, -1031.4108485479474, -1188.587362563216, -341.16397913060604, -1074.6137254503215, -892.4364835917926, -120.04363626317782, -1288.1652829861875, -1206.4912578729145, -908.7711647635762, -833.0290986929698, -1381.3426235328716, -319.3421634668727, -1137.7212323438634, -966.5103294956035, -729.4010349901463, -236.90511223630077, -1172.0434664333616, -1013.0669946774261, -650.0593659005415, -442.8904284138287, -1072.5224037645562, -1431.1583793385205, -328.16653564170804, -101.97243241948817, -1062.0593516823378, -71.19363527972702, -63.146478897659854, -833.4594110730839, -374.38999993631194, -998.733341051182, -1109.687768303667, -1177.2729027596895, -918.341493943677, -964.8390811510693, -744.6723904367699, -588.8286949445536, -265.19594145383616, -870.5848051027044, -732.7023272362436, -408.0828158463704, -223.1508491973167, -1277.057650897254, -836.1682583535487, -786.9628057088897, -1264.1432208913188], "episode_lengths": [150, 150, 86, 150, 150, 150, 150, 84, 150, 150, 150, 78, 150, 150, 113, 71, 150, 150, 90, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 74, 150, 150, 77, 67, 150, 115, 54, 99, 150, 80, 113, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 79, 150, 150, 139, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 79, 150, 60, 63, 150, 119, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 67, 150, 150, 150, 150], "policy_policy_0_reward": [-765.7371534571159, -677.784193264635, -172.47345182154316, -855.1871199344035, -674.4016631978922, -921.6669686386948, -1059.8062202131284, -112.981424923144, -1392.0753364835969, -1262.388069534277, -953.4103347590839, -254.02954352984494, -1019.0945026633667, -831.7334605394026, -383.5945642233917, -140.30112842331886, -1283.4223053691012, -765.0447740246221, -292.06303485869284, -976.1588024497942, -1223.2770237415714, -136.60389307931885, -476.8584359127723, -1004.1576733745433, -528.4780803545212, -1215.4103622685384, -1157.3669199146464, -1017.7604207524935, -1010.6360188680177, -1299.125886644327, -1057.620435395934, -222.75702821900927, -160.82675099049004, -1124.386100186593, -734.6985580209916, -84.20214178005133, -103.67320526917226, -968.272839331013, -294.4919097717065, -57.74705717324679, -369.2807274095773, -859.2550254786761, -128.33039180295137, -224.7858753460434, -1221.4004420801691, -502.568877507719, -396.01094742605255, -839.6903890650859, -326.71071967021214, -1324.4841488822883, -935.9024932928933, -988.1096461092652, -899.541960990638, -421.61904856996614, -104.61581556371003, -1031.4108485479474, -1188.587362563216, -341.16397913060604, -1074.6137254503215, -892.4364835917926, -120.04363626317782, -1288.1652829861875, -1206.4912578729145, -908.7711647635762, -833.0290986929698, -1381.3426235328716, -319.3421634668727, -1137.7212323438634, -966.5103294956035, -729.4010349901463, -236.90511223630077, -1172.0434664333616, -1013.0669946774261, -650.0593659005415, -442.8904284138287, -1072.5224037645562, -1431.1583793385205, -328.16653564170804, -101.97243241948817, -1062.0593516823378, -71.19363527972702, -63.146478897659854, -833.4594110730839, -374.38999993631194, -998.733341051182, -1109.687768303667, -1177.2729027596895, -918.341493943677, -964.8390811510693, -744.6723904367699, -588.8286949445536, -265.19594145383616, -870.5848051027044, -732.7023272362436, -408.0828158463704, -223.1508491973167, -1277.057650897254, -836.1682583535487, -786.9628057088897, -1264.1432208913188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553152675371757, "mean_inference_ms": 1.683056461422947, "mean_action_processing_ms": 0.27955429237536067, "mean_env_wait_ms": 3.0214106914072207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011700153350830078, "StateBufferConnector_ms": 0.007922649383544922, "ViewRequirementAgentConnector_ms": 0.19450950622558594}, "num_episodes": 29, "episode_return_max": -57.74705717324679, "episode_return_min": -1431.1583793385205, "episode_return_mean": -736.5249986921825, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.1578480400519, "num_env_steps_trained_throughput_per_sec": 295.1578480400519, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13366.527, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13366.448, "sample_time_ms": 1053.69, "learn_time_ms": 12246.313, "learn_throughput": 326.629, "synch_weights_time_ms": 65.523}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00011", "date": "2024-08-03_11-21-09", "timestamp": 1722664269, "time_this_iter_s": 13.565412521362305, "time_total_s": 302.8971447944641, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244524670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 302.8971447944641, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.642105263157895, "ram_util_percent": 27.71578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.16750592639049, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.297598272562027, "policy_loss": -0.012190372280989929, "vf_loss": 7.320128116011619, "vf_explained_var": 0.9005002706622084, "kl": 0.01692434588173156, "entropy": 1.7955423153936863, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -11.735097349002308, "episode_reward_min": -1431.1583793385205, "episode_reward_mean": -694.3714172686559, "episode_len_mean": 129.37, "episode_media": {}, "episodes_timesteps_total": 12937, "policy_reward_min": {"policy_0": -1431.1583793385205}, "policy_reward_max": {"policy_0": -11.735097349002308}, "policy_reward_mean": {"policy_0": -694.3714172686559}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-222.75702821900927, -160.82675099049004, -1124.386100186593, -734.6985580209916, -84.20214178005133, -103.67320526917226, -968.272839331013, -294.4919097717065, -57.74705717324679, -369.2807274095773, -859.2550254786761, -128.33039180295137, -224.7858753460434, -1221.4004420801691, -502.568877507719, -396.01094742605255, -839.6903890650859, -326.71071967021214, -1324.4841488822883, -935.9024932928933, -988.1096461092652, -899.541960990638, -421.61904856996614, -104.61581556371003, -1031.4108485479474, -1188.587362563216, -341.16397913060604, -1074.6137254503215, -892.4364835917926, -120.04363626317782, -1288.1652829861875, -1206.4912578729145, -908.7711647635762, -833.0290986929698, -1381.3426235328716, -319.3421634668727, -1137.7212323438634, -966.5103294956035, -729.4010349901463, -236.90511223630077, -1172.0434664333616, -1013.0669946774261, -650.0593659005415, -442.8904284138287, -1072.5224037645562, -1431.1583793385205, -328.16653564170804, -101.97243241948817, -1062.0593516823378, -71.19363527972702, -63.146478897659854, -833.4594110730839, -374.38999993631194, -998.733341051182, -1109.687768303667, -1177.2729027596895, -918.341493943677, -964.8390811510693, -744.6723904367699, -588.8286949445536, -265.19594145383616, -870.5848051027044, -732.7023272362436, -408.0828158463704, -223.1508491973167, -1277.057650897254, -836.1682583535487, -786.9628057088897, -1264.1432208913188, -353.2722829335783, -215.5789857855613, -305.64694999434016, -1145.724892999958, -225.1806929869017, -765.9308203594336, -402.3862331345072, -290.900207815694, -1124.5653447669215, -900.4707384841416, -312.49216976054976, -11.735097349002308, -1163.0713304411001, -1027.905368912734, -875.3537444482646, -1317.0256784136543, -927.5490697992617, -1042.924004277156, -213.95132095450575, -1112.4377361274042, -56.95357597876856, -140.29683329195302, -979.8753796349016, -739.4124012285394, -49.39374813966555, -1142.6995669937764, -1034.888316319159, -125.53813450959903, -1231.9448204729208, -1101.7516665977464, -368.4339473513609], "episode_lengths": [88, 74, 150, 150, 77, 67, 150, 115, 54, 99, 150, 80, 113, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 79, 150, 150, 139, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 79, 150, 60, 63, 150, 119, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 67, 150, 150, 150, 150, 150, 74, 107, 150, 68, 150, 150, 137, 150, 150, 128, 40, 150, 150, 150, 150, 150, 150, 73, 150, 62, 57, 150, 150, 61, 150, 150, 69, 150, 150, 150], "policy_policy_0_reward": [-222.75702821900927, -160.82675099049004, -1124.386100186593, -734.6985580209916, -84.20214178005133, -103.67320526917226, -968.272839331013, -294.4919097717065, -57.74705717324679, -369.2807274095773, -859.2550254786761, -128.33039180295137, -224.7858753460434, -1221.4004420801691, -502.568877507719, -396.01094742605255, -839.6903890650859, -326.71071967021214, -1324.4841488822883, -935.9024932928933, -988.1096461092652, -899.541960990638, -421.61904856996614, -104.61581556371003, -1031.4108485479474, -1188.587362563216, -341.16397913060604, -1074.6137254503215, -892.4364835917926, -120.04363626317782, -1288.1652829861875, -1206.4912578729145, -908.7711647635762, -833.0290986929698, -1381.3426235328716, -319.3421634668727, -1137.7212323438634, -966.5103294956035, -729.4010349901463, -236.90511223630077, -1172.0434664333616, -1013.0669946774261, -650.0593659005415, -442.8904284138287, -1072.5224037645562, -1431.1583793385205, -328.16653564170804, -101.97243241948817, -1062.0593516823378, -71.19363527972702, -63.146478897659854, -833.4594110730839, -374.38999993631194, -998.733341051182, -1109.687768303667, -1177.2729027596895, -918.341493943677, -964.8390811510693, -744.6723904367699, -588.8286949445536, -265.19594145383616, -870.5848051027044, -732.7023272362436, -408.0828158463704, -223.1508491973167, -1277.057650897254, -836.1682583535487, -786.9628057088897, -1264.1432208913188, -353.2722829335783, -215.5789857855613, -305.64694999434016, -1145.724892999958, -225.1806929869017, -765.9308203594336, -402.3862331345072, -290.900207815694, -1124.5653447669215, -900.4707384841416, -312.49216976054976, -11.735097349002308, -1163.0713304411001, -1027.905368912734, -875.3537444482646, -1317.0256784136543, -927.5490697992617, -1042.924004277156, -213.95132095450575, -1112.4377361274042, -56.95357597876856, -140.29683329195302, -979.8753796349016, -739.4124012285394, -49.39374813966555, -1142.6995669937764, -1034.888316319159, -125.53813450959903, -1231.9448204729208, -1101.7516665977464, -368.4339473513609]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553438162722864, "mean_inference_ms": 1.6842598789601326, "mean_action_processing_ms": 0.2796038278571828, "mean_env_wait_ms": 3.0283017847698193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011669158935546875, "StateBufferConnector_ms": 0.007932424545288086, "ViewRequirementAgentConnector_ms": 0.1942591667175293}, "num_episodes": 31, "episode_return_max": -11.735097349002308, "episode_return_min": -1431.1583793385205, "episode_return_mean": -694.3714172686559, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.8763634081558, "num_env_steps_trained_throughput_per_sec": 292.8763634081558, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13400.993, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13400.916, "sample_time_ms": 1055.193, "learn_time_ms": 12279.111, "learn_throughput": 325.756, "synch_weights_time_ms": 65.696}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00011", "date": "2024-08-03_11-21-23", "timestamp": 1722664283, "time_this_iter_s": 13.670390605926514, "time_total_s": 316.5675354003906, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244525ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 316.5675354003906, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.574999999999998, "ram_util_percent": 27.71}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 55.194704391558965, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.943408676981926, "policy_loss": -0.012493705717497505, "vf_loss": 6.965949687361717, "vf_explained_var": 0.9109501978382468, "kl": 0.017693453225426044, "entropy": 1.8009370418886343, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -9.380662120052195, "episode_reward_min": -1431.1583793385205, "episode_reward_mean": -708.1526521543394, "episode_len_mean": 129.65, "episode_media": {}, "episodes_timesteps_total": 12965, "policy_reward_min": {"policy_0": -1431.1583793385205}, "policy_reward_max": {"policy_0": -9.380662120052195}, "policy_reward_mean": {"policy_0": -708.1526521543394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1137.7212323438634, -966.5103294956035, -729.4010349901463, -236.90511223630077, -1172.0434664333616, -1013.0669946774261, -650.0593659005415, -442.8904284138287, -1072.5224037645562, -1431.1583793385205, -328.16653564170804, -101.97243241948817, -1062.0593516823378, -71.19363527972702, -63.146478897659854, -833.4594110730839, -374.38999993631194, -998.733341051182, -1109.687768303667, -1177.2729027596895, -918.341493943677, -964.8390811510693, -744.6723904367699, -588.8286949445536, -265.19594145383616, -870.5848051027044, -732.7023272362436, -408.0828158463704, -223.1508491973167, -1277.057650897254, -836.1682583535487, -786.9628057088897, -1264.1432208913188, -353.2722829335783, -215.5789857855613, -305.64694999434016, -1145.724892999958, -225.1806929869017, -765.9308203594336, -402.3862331345072, -290.900207815694, -1124.5653447669215, -900.4707384841416, -312.49216976054976, -11.735097349002308, -1163.0713304411001, -1027.905368912734, -875.3537444482646, -1317.0256784136543, -927.5490697992617, -1042.924004277156, -213.95132095450575, -1112.4377361274042, -56.95357597876856, -140.29683329195302, -979.8753796349016, -739.4124012285394, -49.39374813966555, -1142.6995669937764, -1034.888316319159, -125.53813450959903, -1231.9448204729208, -1101.7516665977464, -368.4339473513609, -1173.3742131594358, -1059.837201928724, -309.870228038977, -841.121184462996, -298.1247008666616, -506.2486365315146, -189.6800015149393, -409.15106161434596, -515.0702046732408, -1212.221208019884, -143.2087273332981, -245.98583686623428, -840.2623088981882, -830.7910637407283, -1097.054636466453, -1016.6442999292666, -874.5941367354808, -974.8130603117343, -1159.053468752995, -1181.3447754434114, -53.35979150777602, -971.2046957183171, -1093.7540641727574, -39.70284201913741, -409.7547825499948, -1193.3497487125444, -98.21713356791948, -1012.8747684405529, -442.68029494238607, -659.6211320521495, -1024.6811776576576, -9.380662120052195, -331.4828519665265, -864.9589245878642, -1050.3399000629129, -1123.0694900012766], "episode_lengths": [150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 79, 150, 60, 63, 150, 119, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 67, 150, 150, 150, 150, 150, 74, 107, 150, 68, 150, 150, 137, 150, 150, 128, 40, 150, 150, 150, 150, 150, 150, 73, 150, 62, 57, 150, 150, 61, 150, 150, 69, 150, 150, 150, 150, 150, 116, 150, 92, 150, 79, 150, 140, 150, 77, 81, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 54, 122, 150, 75, 150, 150, 150, 150, 42, 89, 150, 150, 150], "policy_policy_0_reward": [-1137.7212323438634, -966.5103294956035, -729.4010349901463, -236.90511223630077, -1172.0434664333616, -1013.0669946774261, -650.0593659005415, -442.8904284138287, -1072.5224037645562, -1431.1583793385205, -328.16653564170804, -101.97243241948817, -1062.0593516823378, -71.19363527972702, -63.146478897659854, -833.4594110730839, -374.38999993631194, -998.733341051182, -1109.687768303667, -1177.2729027596895, -918.341493943677, -964.8390811510693, -744.6723904367699, -588.8286949445536, -265.19594145383616, -870.5848051027044, -732.7023272362436, -408.0828158463704, -223.1508491973167, -1277.057650897254, -836.1682583535487, -786.9628057088897, -1264.1432208913188, -353.2722829335783, -215.5789857855613, -305.64694999434016, -1145.724892999958, -225.1806929869017, -765.9308203594336, -402.3862331345072, -290.900207815694, -1124.5653447669215, -900.4707384841416, -312.49216976054976, -11.735097349002308, -1163.0713304411001, -1027.905368912734, -875.3537444482646, -1317.0256784136543, -927.5490697992617, -1042.924004277156, -213.95132095450575, -1112.4377361274042, -56.95357597876856, -140.29683329195302, -979.8753796349016, -739.4124012285394, -49.39374813966555, -1142.6995669937764, -1034.888316319159, -125.53813450959903, -1231.9448204729208, -1101.7516665977464, -368.4339473513609, -1173.3742131594358, -1059.837201928724, -309.870228038977, -841.121184462996, -298.1247008666616, -506.2486365315146, -189.6800015149393, -409.15106161434596, -515.0702046732408, -1212.221208019884, -143.2087273332981, -245.98583686623428, -840.2623088981882, -830.7910637407283, -1097.054636466453, -1016.6442999292666, -874.5941367354808, -974.8130603117343, -1159.053468752995, -1181.3447754434114, -53.35979150777602, -971.2046957183171, -1093.7540641727574, -39.70284201913741, -409.7547825499948, -1193.3497487125444, -98.21713356791948, -1012.8747684405529, -442.68029494238607, -659.6211320521495, -1024.6811776576576, -9.380662120052195, -331.4828519665265, -864.9589245878642, -1050.3399000629129, -1123.0694900012766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553586507559161, "mean_inference_ms": 1.6850504832210453, "mean_action_processing_ms": 0.27969547079523166, "mean_env_wait_ms": 3.0406360095353246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011853456497192383, "StateBufferConnector_ms": 0.007962703704833984, "ViewRequirementAgentConnector_ms": 0.19646620750427246}, "num_episodes": 36, "episode_return_max": -9.380662120052195, "episode_return_min": -1431.1583793385205, "episode_return_mean": -708.1526521543394, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.71126056112774, "num_env_steps_trained_throughput_per_sec": 296.71126056112774, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13414.297, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13414.22, "sample_time_ms": 1055.476, "learn_time_ms": 12293.624, "learn_throughput": 325.372, "synch_weights_time_ms": 64.217}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00011", "date": "2024-08-03_11-21-37", "timestamp": 1722664297, "time_this_iter_s": 13.494233131408691, "time_total_s": 330.0617685317993, "pid": 523964, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457b1870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 330.0617685317993, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.800000000000002, "ram_util_percent": 27.757894736842104}}
