{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1808853050383428, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.519382698337237, "policy_loss": -0.006787384016691552, "vf_loss": 9.525269389152527, "vf_explained_var": 0.006999967619776726, "kl": 0.01167757591465488, "entropy": 1.4348385782291493, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -103.85573489827813, "episode_reward_min": -1135.5388283293382, "episode_reward_mean": -765.8351821961558, "episode_len_mean": 143.52173913043478, "episode_media": {}, "episodes_timesteps_total": 3301, "policy_reward_min": {"policy_0": -1135.5388283293382}, "policy_reward_max": {"policy_0": -103.85573489827813}, "policy_reward_mean": {"policy_0": -765.8351821961558}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-639.7236287318838, -1076.0336794933157, -786.2922660681752, -958.5581993723404, -486.1116301095248, -103.85573489827813, -1024.3121767578928, -1005.2637234231349, -827.2383005033494, -309.16738295372676, -739.0698527875115, -829.2439599153291, -812.7175128550655, -1034.4207993148107, -955.2269025063065, -1135.5388283293382, -585.7134289152913, -111.63057985766999, -462.9371919895008, -764.5864388105078, -929.6894570593842, -999.1728167936496, -1037.7046990655958], "episode_lengths": [150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-639.7236287318838, -1076.0336794933157, -786.2922660681752, -958.5581993723404, -486.1116301095248, -103.85573489827813, -1024.3121767578928, -1005.2637234231349, -827.2383005033494, -309.16738295372676, -739.0698527875115, -829.2439599153291, -812.7175128550655, -1034.4207993148107, -955.2269025063065, -1135.5388283293382, -585.7134289152913, -111.63057985766999, -462.9371919895008, -764.5864388105078, -929.6894570593842, -999.1728167936496, -1037.7046990655958]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5598276711858347, "mean_inference_ms": 1.6581862664047398, "mean_action_processing_ms": 0.2800052709137592, "mean_env_wait_ms": 2.967423191671071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01122847847316576, "StateBufferConnector_ms": 0.009003929469896399, "ViewRequirementAgentConnector_ms": 0.17831843832264777}, "num_episodes": 23, "episode_return_max": -103.85573489827813, "episode_return_min": -1135.5388283293382, "episode_return_mean": -765.8351821961558, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 564.2007986884695, "num_env_steps_trained_throughput_per_sec": 564.2007986884695, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 7089.684, "restore_workers_time_ms": 0.023, "training_step_time_ms": 7089.624, "sample_time_ms": 1026.632, "learn_time_ms": 6009.648, "learn_throughput": 665.596, "synch_weights_time_ms": 52.573}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00010", "date": "2024-08-03_11-10-36", "timestamp": 1722663636, "time_this_iter_s": 7.099967956542969, "time_total_s": 7.099967956542969, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245745090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7.099967956542969, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.272727272727273, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.397623182895283, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.502267166475455, "policy_loss": -0.00585418850920784, "vf_loss": 9.507437013586362, "vf_explained_var": 0.06497490250815947, "kl": 0.010232027532750484, "entropy": 1.3620113323132197, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -67.91667408640879, "episode_reward_min": -1216.2319929777807, "episode_reward_mean": -734.0761528104182, "episode_len_mean": 139.61702127659575, "episode_media": {}, "episodes_timesteps_total": 6562, "policy_reward_min": {"policy_0": -1216.2319929777807}, "policy_reward_max": {"policy_0": -67.91667408640879}, "policy_reward_mean": {"policy_0": -734.0761528104182}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-639.7236287318838, -1076.0336794933157, -786.2922660681752, -958.5581993723404, -486.1116301095248, -103.85573489827813, -1024.3121767578928, -1005.2637234231349, -827.2383005033494, -309.16738295372676, -739.0698527875115, -829.2439599153291, -812.7175128550655, -1034.4207993148107, -955.2269025063065, -1135.5388283293382, -585.7134289152913, -111.63057985766999, -462.9371919895008, -764.5864388105078, -929.6894570593842, -999.1728167936496, -1037.7046990655958, -211.16549459609342, -1186.6770321114798, -644.6774372555025, -1034.522695267612, -824.2796021766296, -937.7073635719473, -835.9799651703789, -1216.2319929777807, -862.3577029868858, -67.91667408640879, -797.3729672345825, -1105.1590963613935, -733.1871643733898, -876.7320589479559, -159.05177886749823, -195.74040300426586, -296.0052482692916, -362.7628751068192, -707.3331815671381, -1009.9344666196266, -610.3745209804914, -1004.6680908702349, -582.1451222213414, -625.3870569533232], "episode_lengths": [150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 113, 76, 109, 111, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-639.7236287318838, -1076.0336794933157, -786.2922660681752, -958.5581993723404, -486.1116301095248, -103.85573489827813, -1024.3121767578928, -1005.2637234231349, -827.2383005033494, -309.16738295372676, -739.0698527875115, -829.2439599153291, -812.7175128550655, -1034.4207993148107, -955.2269025063065, -1135.5388283293382, -585.7134289152913, -111.63057985766999, -462.9371919895008, -764.5864388105078, -929.6894570593842, -999.1728167936496, -1037.7046990655958, -211.16549459609342, -1186.6770321114798, -644.6774372555025, -1034.522695267612, -824.2796021766296, -937.7073635719473, -835.9799651703789, -1216.2319929777807, -862.3577029868858, -67.91667408640879, -797.3729672345825, -1105.1590963613935, -733.1871643733898, -876.7320589479559, -159.05177886749823, -195.74040300426586, -296.0052482692916, -362.7628751068192, -707.3331815671381, -1009.9344666196266, -610.3745209804914, -1004.6680908702349, -582.1451222213414, -625.3870569533232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548990611065464, "mean_inference_ms": 1.6507029694551636, "mean_action_processing_ms": 0.27865282851310785, "mean_env_wait_ms": 2.9494160286373203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013805957550698139, "StateBufferConnector_ms": 0.008621114365597989, "ViewRequirementAgentConnector_ms": 0.1798122487169631}, "num_episodes": 24, "episode_return_max": -67.91667408640879, "episode_return_min": -1216.2319929777807, "episode_return_mean": -734.0761528104182, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.27037189485577, "num_env_steps_trained_throughput_per_sec": 310.27037189485577, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 9990.838, "restore_workers_time_ms": 0.025, "training_step_time_ms": 9990.775, "sample_time_ms": 1012.47, "learn_time_ms": 8912.763, "learn_throughput": 448.795, "synch_weights_time_ms": 64.688}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00010", "date": "2024-08-03_11-10-49", "timestamp": 1722663649, "time_this_iter_s": 12.904959917068481, "time_total_s": 20.00492787361145, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245746200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20.00492787361145, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.583333333333332, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4392226764932277, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.422936124602954, "policy_loss": -0.012205860242829658, "vf_loss": 9.433554715911548, "vf_explained_var": 0.1946463688587149, "kl": 0.014760299091722117, "entropy": 1.364795798063278, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -39.81194850111149, "episode_reward_min": -1216.2319929777807, "episode_reward_mean": -692.7452429453247, "episode_len_mean": 138.39473684210526, "episode_media": {}, "episodes_timesteps_total": 10518, "policy_reward_min": {"policy_0": -1216.2319929777807}, "policy_reward_max": {"policy_0": -39.81194850111149}, "policy_reward_mean": {"policy_0": -692.7452429453247}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-639.7236287318838, -1076.0336794933157, -786.2922660681752, -958.5581993723404, -486.1116301095248, -103.85573489827813, -1024.3121767578928, -1005.2637234231349, -827.2383005033494, -309.16738295372676, -739.0698527875115, -829.2439599153291, -812.7175128550655, -1034.4207993148107, -955.2269025063065, -1135.5388283293382, -585.7134289152913, -111.63057985766999, -462.9371919895008, -764.5864388105078, -929.6894570593842, -999.1728167936496, -1037.7046990655958, -211.16549459609342, -1186.6770321114798, -644.6774372555025, -1034.522695267612, -824.2796021766296, -937.7073635719473, -835.9799651703789, -1216.2319929777807, -862.3577029868858, -67.91667408640879, -797.3729672345825, -1105.1590963613935, -733.1871643733898, -876.7320589479559, -159.05177886749823, -195.74040300426586, -296.0052482692916, -362.7628751068192, -707.3331815671381, -1009.9344666196266, -610.3745209804914, -1004.6680908702349, -582.1451222213414, -625.3870569533232, -818.1878073655262, -75.91469255594131, -203.66118938161296, -721.4212126397273, -294.43139450198476, -885.0138832564048, -599.8806859936477, -730.2955252161104, -1014.2750619940813, -641.5642475696818, -436.8302987542375, -941.6279596981873, -996.793497197882, -907.5202277142877, -675.5631969028431, -936.9181320080131, -39.81194850111149, -944.8766609917857, -405.1786027345321, -313.94022222242825, -551.5175435746726, -858.0590230417889, -137.6559716888147, -714.4403269713422, -887.4489097425924, -54.83356094929568, -267.5022468842634, -932.6292749968361, -1159.2659767053906], "episode_lengths": [150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 113, 76, 109, 111, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 99, 150, 150, 105, 150, 150, 62, 104, 150, 150], "policy_policy_0_reward": [-639.7236287318838, -1076.0336794933157, -786.2922660681752, -958.5581993723404, -486.1116301095248, -103.85573489827813, -1024.3121767578928, -1005.2637234231349, -827.2383005033494, -309.16738295372676, -739.0698527875115, -829.2439599153291, -812.7175128550655, -1034.4207993148107, -955.2269025063065, -1135.5388283293382, -585.7134289152913, -111.63057985766999, -462.9371919895008, -764.5864388105078, -929.6894570593842, -999.1728167936496, -1037.7046990655958, -211.16549459609342, -1186.6770321114798, -644.6774372555025, -1034.522695267612, -824.2796021766296, -937.7073635719473, -835.9799651703789, -1216.2319929777807, -862.3577029868858, -67.91667408640879, -797.3729672345825, -1105.1590963613935, -733.1871643733898, -876.7320589479559, -159.05177886749823, -195.74040300426586, -296.0052482692916, -362.7628751068192, -707.3331815671381, -1009.9344666196266, -610.3745209804914, -1004.6680908702349, -582.1451222213414, -625.3870569533232, -818.1878073655262, -75.91469255594131, -203.66118938161296, -721.4212126397273, -294.43139450198476, -885.0138832564048, -599.8806859936477, -730.2955252161104, -1014.2750619940813, -641.5642475696818, -436.8302987542375, -941.6279596981873, -996.793497197882, -907.5202277142877, -675.5631969028431, -936.9181320080131, -39.81194850111149, -944.8766609917857, -405.1786027345321, -313.94022222242825, -551.5175435746726, -858.0590230417889, -137.6559716888147, -714.4403269713422, -887.4489097425924, -54.83356094929568, -267.5022468842634, -932.6292749968361, -1159.2659767053906]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552500842108976, "mean_inference_ms": 1.6536431829255378, "mean_action_processing_ms": 0.2787704294848816, "mean_env_wait_ms": 2.954209461769433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013533391450580797, "StateBufferConnector_ms": 0.008786352057206003, "ViewRequirementAgentConnector_ms": 0.1849554086986341}, "num_episodes": 29, "episode_return_max": -39.81194850111149, "episode_return_min": -1216.2319929777807, "episode_return_mean": -692.7452429453247, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.21597620207183, "num_env_steps_trained_throughput_per_sec": 301.21597620207183, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11087.066, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11086.998, "sample_time_ms": 1016.922, "learn_time_ms": 10003.158, "learn_throughput": 399.874, "synch_weights_time_ms": 66.039}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00010", "date": "2024-08-03_11-11-03", "timestamp": 1722663663, "time_this_iter_s": 13.29206895828247, "time_total_s": 33.29699683189392, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245746e60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 33.29699683189392, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.531578947368422, "ram_util_percent": 27.694736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5450758749619125, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.542543536424636, "policy_loss": -0.012816008001876374, "vf_loss": 9.553701498111089, "vf_explained_var": 0.22297046103825172, "kl": 0.015337174596485667, "entropy": 1.4093879097451767, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -22.154224224583796, "episode_reward_min": -1216.2319929777807, "episode_reward_mean": -695.9176818875145, "episode_len_mean": 138.44, "episode_media": {}, "episodes_timesteps_total": 13844, "policy_reward_min": {"policy_0": -1216.2319929777807}, "policy_reward_max": {"policy_0": -22.154224224583796}, "policy_reward_mean": {"policy_0": -695.9176818875145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-786.2922660681752, -958.5581993723404, -486.1116301095248, -103.85573489827813, -1024.3121767578928, -1005.2637234231349, -827.2383005033494, -309.16738295372676, -739.0698527875115, -829.2439599153291, -812.7175128550655, -1034.4207993148107, -955.2269025063065, -1135.5388283293382, -585.7134289152913, -111.63057985766999, -462.9371919895008, -764.5864388105078, -929.6894570593842, -999.1728167936496, -1037.7046990655958, -211.16549459609342, -1186.6770321114798, -644.6774372555025, -1034.522695267612, -824.2796021766296, -937.7073635719473, -835.9799651703789, -1216.2319929777807, -862.3577029868858, -67.91667408640879, -797.3729672345825, -1105.1590963613935, -733.1871643733898, -876.7320589479559, -159.05177886749823, -195.74040300426586, -296.0052482692916, -362.7628751068192, -707.3331815671381, -1009.9344666196266, -610.3745209804914, -1004.6680908702349, -582.1451222213414, -625.3870569533232, -818.1878073655262, -75.91469255594131, -203.66118938161296, -721.4212126397273, -294.43139450198476, -885.0138832564048, -599.8806859936477, -730.2955252161104, -1014.2750619940813, -641.5642475696818, -436.8302987542375, -941.6279596981873, -996.793497197882, -907.5202277142877, -675.5631969028431, -936.9181320080131, -39.81194850111149, -944.8766609917857, -405.1786027345321, -313.94022222242825, -551.5175435746726, -858.0590230417889, -137.6559716888147, -714.4403269713422, -887.4489097425924, -54.83356094929568, -267.5022468842634, -932.6292749968361, -1159.2659767053906, -833.8858062644011, -988.8922319259253, -937.285327707719, -585.084180593154, -1055.280531622074, -878.6935980461136, -1174.3580460820606, -22.154224224583796, -986.5041167585441, -900.3302374773796, -169.74926154181082, -875.3381606970106, -838.957634692398, -787.6970165455987, -155.28398590425002, -652.8117306333124, -684.67734311161, -700.9298953169247, -810.157260806471, -858.473775331962, -428.38683384179535, -582.7062693603979, -491.1907498896473, -978.0297890050916, -269.64152865719416, -1012.3874970945502], "episode_lengths": [150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 113, 76, 109, 111, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 99, 150, 150, 105, 150, 150, 62, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 37, 150, 150, 82, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150], "policy_policy_0_reward": [-786.2922660681752, -958.5581993723404, -486.1116301095248, -103.85573489827813, -1024.3121767578928, -1005.2637234231349, -827.2383005033494, -309.16738295372676, -739.0698527875115, -829.2439599153291, -812.7175128550655, -1034.4207993148107, -955.2269025063065, -1135.5388283293382, -585.7134289152913, -111.63057985766999, -462.9371919895008, -764.5864388105078, -929.6894570593842, -999.1728167936496, -1037.7046990655958, -211.16549459609342, -1186.6770321114798, -644.6774372555025, -1034.522695267612, -824.2796021766296, -937.7073635719473, -835.9799651703789, -1216.2319929777807, -862.3577029868858, -67.91667408640879, -797.3729672345825, -1105.1590963613935, -733.1871643733898, -876.7320589479559, -159.05177886749823, -195.74040300426586, -296.0052482692916, -362.7628751068192, -707.3331815671381, -1009.9344666196266, -610.3745209804914, -1004.6680908702349, -582.1451222213414, -625.3870569533232, -818.1878073655262, -75.91469255594131, -203.66118938161296, -721.4212126397273, -294.43139450198476, -885.0138832564048, -599.8806859936477, -730.2955252161104, -1014.2750619940813, -641.5642475696818, -436.8302987542375, -941.6279596981873, -996.793497197882, -907.5202277142877, -675.5631969028431, -936.9181320080131, -39.81194850111149, -944.8766609917857, -405.1786027345321, -313.94022222242825, -551.5175435746726, -858.0590230417889, -137.6559716888147, -714.4403269713422, -887.4489097425924, -54.83356094929568, -267.5022468842634, -932.6292749968361, -1159.2659767053906, -833.8858062644011, -988.8922319259253, -937.285327707719, -585.084180593154, -1055.280531622074, -878.6935980461136, -1174.3580460820606, -22.154224224583796, -986.5041167585441, -900.3302374773796, -169.74926154181082, -875.3381606970106, -838.957634692398, -787.6970165455987, -155.28398590425002, -652.8117306333124, -684.67734311161, -700.9298953169247, -810.157260806471, -858.473775331962, -428.38683384179535, -582.7062693603979, -491.1907498896473, -978.0297890050916, -269.64152865719416, -1012.3874970945502]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545677330252938, "mean_inference_ms": 1.654904493712728, "mean_action_processing_ms": 0.27896772345078047, "mean_env_wait_ms": 2.956317095878094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014059305191040039, "StateBufferConnector_ms": 0.0087432861328125, "ViewRequirementAgentConnector_ms": 0.1849055290222168}, "num_episodes": 26, "episode_return_max": -22.154224224583796, "episode_return_min": -1216.2319929777807, "episode_return_mean": -695.9176818875145, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.1736145573671, "num_env_steps_trained_throughput_per_sec": 348.1736145573671, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 11187.433, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11187.365, "sample_time_ms": 1014.587, "learn_time_ms": 10103.955, "learn_throughput": 395.885, "synch_weights_time_ms": 67.947}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00010", "date": "2024-08-03_11-11-14", "timestamp": 1722663674, "time_this_iter_s": 11.500679731369019, "time_total_s": 44.79767656326294, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457470a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 44.79767656326294, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 14.625, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.759432311169803, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.349743543068568, "policy_loss": -0.007410580237046815, "vf_loss": 9.355446934700012, "vf_explained_var": 0.23302258408317963, "kl": 0.015764582995810395, "entropy": 1.4456785824149847, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -22.154224224583796, "episode_reward_min": -1263.108967291715, "episode_reward_mean": -678.3397150117844, "episode_len_mean": 137.62, "episode_media": {}, "episodes_timesteps_total": 13762, "policy_reward_min": {"policy_0": -1263.108967291715}, "policy_reward_max": {"policy_0": -22.154224224583796}, "policy_reward_mean": {"policy_0": -678.3397150117844}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-862.3577029868858, -67.91667408640879, -797.3729672345825, -1105.1590963613935, -733.1871643733898, -876.7320589479559, -159.05177886749823, -195.74040300426586, -296.0052482692916, -362.7628751068192, -707.3331815671381, -1009.9344666196266, -610.3745209804914, -1004.6680908702349, -582.1451222213414, -625.3870569533232, -818.1878073655262, -75.91469255594131, -203.66118938161296, -721.4212126397273, -294.43139450198476, -885.0138832564048, -599.8806859936477, -730.2955252161104, -1014.2750619940813, -641.5642475696818, -436.8302987542375, -941.6279596981873, -996.793497197882, -907.5202277142877, -675.5631969028431, -936.9181320080131, -39.81194850111149, -944.8766609917857, -405.1786027345321, -313.94022222242825, -551.5175435746726, -858.0590230417889, -137.6559716888147, -714.4403269713422, -887.4489097425924, -54.83356094929568, -267.5022468842634, -932.6292749968361, -1159.2659767053906, -833.8858062644011, -988.8922319259253, -937.285327707719, -585.084180593154, -1055.280531622074, -878.6935980461136, -1174.3580460820606, -22.154224224583796, -986.5041167585441, -900.3302374773796, -169.74926154181082, -875.3381606970106, -838.957634692398, -787.6970165455987, -155.28398590425002, -652.8117306333124, -684.67734311161, -700.9298953169247, -810.157260806471, -858.473775331962, -428.38683384179535, -582.7062693603979, -491.1907498896473, -978.0297890050916, -269.64152865719416, -1012.3874970945502, -713.5388687372907, -543.5358066018975, -718.1769110609233, -1263.108967291715, -806.702362930157, -498.5638869582972, -317.1309583020327, -550.3282549390518, -361.78507212035805, -509.3012964393541, -631.0560733004116, -289.38547073059163, -857.899036724231, -847.7446085711076, -477.35581970044046, -1061.545191038239, -73.72535154163525, -701.2847794374574, -926.7649555367876, -1090.9451703487418, -1056.852001322872, -1143.8880213241239, -927.548936863468, -1038.5799319453693, -1033.5055773931247, -641.0879942686287, -1182.146327123169, -306.4251543408499, -461.98399094847196], "episode_lengths": [150, 63, 150, 150, 150, 150, 113, 76, 109, 111, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 99, 150, 150, 105, 150, 150, 62, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 37, 150, 150, 82, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 127, 150, 117, 150, 133, 115, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 125], "policy_policy_0_reward": [-862.3577029868858, -67.91667408640879, -797.3729672345825, -1105.1590963613935, -733.1871643733898, -876.7320589479559, -159.05177886749823, -195.74040300426586, -296.0052482692916, -362.7628751068192, -707.3331815671381, -1009.9344666196266, -610.3745209804914, -1004.6680908702349, -582.1451222213414, -625.3870569533232, -818.1878073655262, -75.91469255594131, -203.66118938161296, -721.4212126397273, -294.43139450198476, -885.0138832564048, -599.8806859936477, -730.2955252161104, -1014.2750619940813, -641.5642475696818, -436.8302987542375, -941.6279596981873, -996.793497197882, -907.5202277142877, -675.5631969028431, -936.9181320080131, -39.81194850111149, -944.8766609917857, -405.1786027345321, -313.94022222242825, -551.5175435746726, -858.0590230417889, -137.6559716888147, -714.4403269713422, -887.4489097425924, -54.83356094929568, -267.5022468842634, -932.6292749968361, -1159.2659767053906, -833.8858062644011, -988.8922319259253, -937.285327707719, -585.084180593154, -1055.280531622074, -878.6935980461136, -1174.3580460820606, -22.154224224583796, -986.5041167585441, -900.3302374773796, -169.74926154181082, -875.3381606970106, -838.957634692398, -787.6970165455987, -155.28398590425002, -652.8117306333124, -684.67734311161, -700.9298953169247, -810.157260806471, -858.473775331962, -428.38683384179535, -582.7062693603979, -491.1907498896473, -978.0297890050916, -269.64152865719416, -1012.3874970945502, -713.5388687372907, -543.5358066018975, -718.1769110609233, -1263.108967291715, -806.702362930157, -498.5638869582972, -317.1309583020327, -550.3282549390518, -361.78507212035805, -509.3012964393541, -631.0560733004116, -289.38547073059163, -857.899036724231, -847.7446085711076, -477.35581970044046, -1061.545191038239, -73.72535154163525, -701.2847794374574, -926.7649555367876, -1090.9451703487418, -1056.852001322872, -1143.8880213241239, -927.548936863468, -1038.5799319453693, -1033.5055773931247, -641.0879942686287, -1182.146327123169, -306.4251543408499, -461.98399094847196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554639141051235, "mean_inference_ms": 1.6607298411677158, "mean_action_processing_ms": 0.2797555191503804, "mean_env_wait_ms": 2.9621649333484896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014059782028198242, "StateBufferConnector_ms": 0.008810281753540039, "ViewRequirementAgentConnector_ms": 0.18971753120422363}, "num_episodes": 29, "episode_return_max": -22.154224224583796, "episode_return_min": -1263.108967291715, "episode_return_mean": -678.3397150117844, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.8604720807054, "num_env_steps_trained_throughput_per_sec": 313.8604720807054, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 11498.853, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11498.78, "sample_time_ms": 1021.973, "learn_time_ms": 10410.044, "learn_throughput": 384.244, "synch_weights_time_ms": 65.892}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00010", "date": "2024-08-03_11-11-27", "timestamp": 1722663687, "time_this_iter_s": 12.758758783340454, "time_total_s": 57.556435346603394, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245744670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 57.556435346603394, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.844444444444445, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.929886733305951, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.307159012556076, "policy_loss": -0.016870226347236894, "vf_loss": 9.32124989827474, "vf_explained_var": 0.318513500255843, "kl": 0.02115747582320182, "entropy": 1.452170151223739, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -22.0184185329043, "episode_reward_min": -1263.108967291715, "episode_reward_mean": -705.8520686198509, "episode_len_mean": 138.82, "episode_media": {}, "episodes_timesteps_total": 13882, "policy_reward_min": {"policy_0": -1263.108967291715}, "policy_reward_max": {"policy_0": -22.0184185329043}, "policy_reward_mean": {"policy_0": -705.8520686198509}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-996.793497197882, -907.5202277142877, -675.5631969028431, -936.9181320080131, -39.81194850111149, -944.8766609917857, -405.1786027345321, -313.94022222242825, -551.5175435746726, -858.0590230417889, -137.6559716888147, -714.4403269713422, -887.4489097425924, -54.83356094929568, -267.5022468842634, -932.6292749968361, -1159.2659767053906, -833.8858062644011, -988.8922319259253, -937.285327707719, -585.084180593154, -1055.280531622074, -878.6935980461136, -1174.3580460820606, -22.154224224583796, -986.5041167585441, -900.3302374773796, -169.74926154181082, -875.3381606970106, -838.957634692398, -787.6970165455987, -155.28398590425002, -652.8117306333124, -684.67734311161, -700.9298953169247, -810.157260806471, -858.473775331962, -428.38683384179535, -582.7062693603979, -491.1907498896473, -978.0297890050916, -269.64152865719416, -1012.3874970945502, -713.5388687372907, -543.5358066018975, -718.1769110609233, -1263.108967291715, -806.702362930157, -498.5638869582972, -317.1309583020327, -550.3282549390518, -361.78507212035805, -509.3012964393541, -631.0560733004116, -289.38547073059163, -857.899036724231, -847.7446085711076, -477.35581970044046, -1061.545191038239, -73.72535154163525, -701.2847794374574, -926.7649555367876, -1090.9451703487418, -1056.852001322872, -1143.8880213241239, -927.548936863468, -1038.5799319453693, -1033.5055773931247, -641.0879942686287, -1182.146327123169, -306.4251543408499, -461.98399094847196, -1182.589890531324, -1127.7149931200613, -769.9096310836786, -1102.9260194363833, -304.3872539230287, -1083.3164533024246, -935.4287411452945, -676.6447097458691, -904.5675024453135, -632.6779226150696, -67.99457595582538, -920.5964749729569, -22.0184185329043, -260.0434181451621, -413.9154636730155, -1045.5338694604213, -571.0467725607926, -774.7715501793554, -677.1479367599105, -1036.4562488941137, -632.3883827073273, -370.7355436647597, -639.9526543126163, -759.4280660248041, -688.843449089634, -750.8080791654539, -1064.1420285134036, -694.4816782235366], "episode_lengths": [150, 150, 150, 150, 66, 150, 150, 99, 150, 150, 105, 150, 150, 62, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 37, 150, 150, 82, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 127, 150, 117, 150, 133, 115, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 125, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 70, 150, 45, 139, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-996.793497197882, -907.5202277142877, -675.5631969028431, -936.9181320080131, -39.81194850111149, -944.8766609917857, -405.1786027345321, -313.94022222242825, -551.5175435746726, -858.0590230417889, -137.6559716888147, -714.4403269713422, -887.4489097425924, -54.83356094929568, -267.5022468842634, -932.6292749968361, -1159.2659767053906, -833.8858062644011, -988.8922319259253, -937.285327707719, -585.084180593154, -1055.280531622074, -878.6935980461136, -1174.3580460820606, -22.154224224583796, -986.5041167585441, -900.3302374773796, -169.74926154181082, -875.3381606970106, -838.957634692398, -787.6970165455987, -155.28398590425002, -652.8117306333124, -684.67734311161, -700.9298953169247, -810.157260806471, -858.473775331962, -428.38683384179535, -582.7062693603979, -491.1907498896473, -978.0297890050916, -269.64152865719416, -1012.3874970945502, -713.5388687372907, -543.5358066018975, -718.1769110609233, -1263.108967291715, -806.702362930157, -498.5638869582972, -317.1309583020327, -550.3282549390518, -361.78507212035805, -509.3012964393541, -631.0560733004116, -289.38547073059163, -857.899036724231, -847.7446085711076, -477.35581970044046, -1061.545191038239, -73.72535154163525, -701.2847794374574, -926.7649555367876, -1090.9451703487418, -1056.852001322872, -1143.8880213241239, -927.548936863468, -1038.5799319453693, -1033.5055773931247, -641.0879942686287, -1182.146327123169, -306.4251543408499, -461.98399094847196, -1182.589890531324, -1127.7149931200613, -769.9096310836786, -1102.9260194363833, -304.3872539230287, -1083.3164533024246, -935.4287411452945, -676.6447097458691, -904.5675024453135, -632.6779226150696, -67.99457595582538, -920.5964749729569, -22.0184185329043, -260.0434181451621, -413.9154636730155, -1045.5338694604213, -571.0467725607926, -774.7715501793554, -677.1479367599105, -1036.4562488941137, -632.3883827073273, -370.7355436647597, -639.9526543126163, -759.4280660248041, -688.843449089634, -750.8080791654539, -1064.1420285134036, -694.4816782235366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567573706915862, "mean_inference_ms": 1.6723607977515897, "mean_action_processing_ms": 0.281562365060279, "mean_env_wait_ms": 2.979711293544634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014034271240234375, "StateBufferConnector_ms": 0.009007692337036133, "ViewRequirementAgentConnector_ms": 0.19253325462341309}, "num_episodes": 28, "episode_return_max": -22.0184185329043, "episode_return_min": -1263.108967291715, "episode_return_mean": -705.8520686198509, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.04007516148465, "num_env_steps_trained_throughput_per_sec": 296.04007516148465, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 11834.328, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11834.251, "sample_time_ms": 1033.716, "learn_time_ms": 10735.448, "learn_throughput": 372.597, "synch_weights_time_ms": 64.236}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00010", "date": "2024-08-03_11-11-41", "timestamp": 1722663701, "time_this_iter_s": 13.524275302886963, "time_total_s": 71.08071064949036, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245761990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71.08071064949036, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.865, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.60858999385188, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.265175671378772, "policy_loss": -0.01628096846106928, "vf_loss": 9.277510418494542, "vf_explained_var": 0.30216953847557304, "kl": 0.018535181431949845, "entropy": 1.6143299983193478, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -22.0184185329043, "episode_reward_min": -1302.641640261805, "episode_reward_mean": -729.2871633542752, "episode_len_mean": 142.1, "episode_media": {}, "episodes_timesteps_total": 14210, "policy_reward_min": {"policy_0": -1302.641640261805}, "policy_reward_max": {"policy_0": -22.0184185329043}, "policy_reward_mean": {"policy_0": -729.2871633542752}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155.28398590425002, -652.8117306333124, -684.67734311161, -700.9298953169247, -810.157260806471, -858.473775331962, -428.38683384179535, -582.7062693603979, -491.1907498896473, -978.0297890050916, -269.64152865719416, -1012.3874970945502, -713.5388687372907, -543.5358066018975, -718.1769110609233, -1263.108967291715, -806.702362930157, -498.5638869582972, -317.1309583020327, -550.3282549390518, -361.78507212035805, -509.3012964393541, -631.0560733004116, -289.38547073059163, -857.899036724231, -847.7446085711076, -477.35581970044046, -1061.545191038239, -73.72535154163525, -701.2847794374574, -926.7649555367876, -1090.9451703487418, -1056.852001322872, -1143.8880213241239, -927.548936863468, -1038.5799319453693, -1033.5055773931247, -641.0879942686287, -1182.146327123169, -306.4251543408499, -461.98399094847196, -1182.589890531324, -1127.7149931200613, -769.9096310836786, -1102.9260194363833, -304.3872539230287, -1083.3164533024246, -935.4287411452945, -676.6447097458691, -904.5675024453135, -632.6779226150696, -67.99457595582538, -920.5964749729569, -22.0184185329043, -260.0434181451621, -413.9154636730155, -1045.5338694604213, -571.0467725607926, -774.7715501793554, -677.1479367599105, -1036.4562488941137, -632.3883827073273, -370.7355436647597, -639.9526543126163, -759.4280660248041, -688.843449089634, -750.8080791654539, -1064.1420285134036, -694.4816782235366, -913.9742812173125, -1133.6829169651346, -682.5059879090163, -704.2370556701595, -933.9423801072846, -656.309968946392, -708.5085595048902, -424.8969138407798, -180.46592495225002, -190.95085088522643, -1283.1149369929933, -914.2832314345003, -747.4448465368873, -1022.3525091700278, -1131.9423728893432, -559.4937910353754, -801.2504877768351, -651.4381277754807, -845.5434329194973, -444.07924914784655, -797.6538278964249, -836.3159389366913, -948.8275902496173, -1095.707193637604, -656.4448541624344, -1302.641640261805, -795.5740414039873, -766.5179230908888, -248.14387240298274, -643.5262512708772, -1139.904211458542], "episode_lengths": [83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 127, 150, 117, 150, 133, 115, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 125, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 70, 150, 45, 139, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150], "policy_policy_0_reward": [-155.28398590425002, -652.8117306333124, -684.67734311161, -700.9298953169247, -810.157260806471, -858.473775331962, -428.38683384179535, -582.7062693603979, -491.1907498896473, -978.0297890050916, -269.64152865719416, -1012.3874970945502, -713.5388687372907, -543.5358066018975, -718.1769110609233, -1263.108967291715, -806.702362930157, -498.5638869582972, -317.1309583020327, -550.3282549390518, -361.78507212035805, -509.3012964393541, -631.0560733004116, -289.38547073059163, -857.899036724231, -847.7446085711076, -477.35581970044046, -1061.545191038239, -73.72535154163525, -701.2847794374574, -926.7649555367876, -1090.9451703487418, -1056.852001322872, -1143.8880213241239, -927.548936863468, -1038.5799319453693, -1033.5055773931247, -641.0879942686287, -1182.146327123169, -306.4251543408499, -461.98399094847196, -1182.589890531324, -1127.7149931200613, -769.9096310836786, -1102.9260194363833, -304.3872539230287, -1083.3164533024246, -935.4287411452945, -676.6447097458691, -904.5675024453135, -632.6779226150696, -67.99457595582538, -920.5964749729569, -22.0184185329043, -260.0434181451621, -413.9154636730155, -1045.5338694604213, -571.0467725607926, -774.7715501793554, -677.1479367599105, -1036.4562488941137, -632.3883827073273, -370.7355436647597, -639.9526543126163, -759.4280660248041, -688.843449089634, -750.8080791654539, -1064.1420285134036, -694.4816782235366, -913.9742812173125, -1133.6829169651346, -682.5059879090163, -704.2370556701595, -933.9423801072846, -656.309968946392, -708.5085595048902, -424.8969138407798, -180.46592495225002, -190.95085088522643, -1283.1149369929933, -914.2832314345003, -747.4448465368873, -1022.3525091700278, -1131.9423728893432, -559.4937910353754, -801.2504877768351, -651.4381277754807, -845.5434329194973, -444.07924914784655, -797.6538278964249, -836.3159389366913, -948.8275902496173, -1095.707193637604, -656.4448541624344, -1302.641640261805, -795.5740414039873, -766.5179230908888, -248.14387240298274, -643.5262512708772, -1139.904211458542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5587528772961519, "mean_inference_ms": 1.683076966523372, "mean_action_processing_ms": 0.2828516969429065, "mean_env_wait_ms": 2.992173687631275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013518333435058594, "StateBufferConnector_ms": 0.008861541748046875, "ViewRequirementAgentConnector_ms": 0.19856643676757812}, "num_episodes": 31, "episode_return_max": -22.0184185329043, "episode_return_min": -1302.641640261805, "episode_return_mean": -729.2871633542752, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.01656721757877, "num_env_steps_trained_throughput_per_sec": 306.01656721757877, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12011.024, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12010.948, "sample_time_ms": 1036.89, "learn_time_ms": 10908.247, "learn_throughput": 366.695, "synch_weights_time_ms": 64.957}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00010", "date": "2024-08-03_11-11-54", "timestamp": 1722663714, "time_this_iter_s": 13.084150552749634, "time_total_s": 84.16486120223999, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245747d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 84.16486120223999, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.75, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.9461839415133, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.149978714684645, "policy_loss": -0.012780678685521707, "vf_loss": 9.159704032540322, "vf_explained_var": 0.4101070667306582, "kl": 0.015538975342512156, "entropy": 1.6063476219773292, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -22.0184185329043, "episode_reward_min": -1336.1788854824192, "episode_reward_mean": -752.338085968689, "episode_len_mean": 141.56, "episode_media": {}, "episodes_timesteps_total": 14156, "policy_reward_min": {"policy_0": -1336.1788854824192}, "policy_reward_max": {"policy_0": -22.0184185329043}, "policy_reward_mean": {"policy_0": -752.338085968689}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-701.2847794374574, -926.7649555367876, -1090.9451703487418, -1056.852001322872, -1143.8880213241239, -927.548936863468, -1038.5799319453693, -1033.5055773931247, -641.0879942686287, -1182.146327123169, -306.4251543408499, -461.98399094847196, -1182.589890531324, -1127.7149931200613, -769.9096310836786, -1102.9260194363833, -304.3872539230287, -1083.3164533024246, -935.4287411452945, -676.6447097458691, -904.5675024453135, -632.6779226150696, -67.99457595582538, -920.5964749729569, -22.0184185329043, -260.0434181451621, -413.9154636730155, -1045.5338694604213, -571.0467725607926, -774.7715501793554, -677.1479367599105, -1036.4562488941137, -632.3883827073273, -370.7355436647597, -639.9526543126163, -759.4280660248041, -688.843449089634, -750.8080791654539, -1064.1420285134036, -694.4816782235366, -913.9742812173125, -1133.6829169651346, -682.5059879090163, -704.2370556701595, -933.9423801072846, -656.309968946392, -708.5085595048902, -424.8969138407798, -180.46592495225002, -190.95085088522643, -1283.1149369929933, -914.2832314345003, -747.4448465368873, -1022.3525091700278, -1131.9423728893432, -559.4937910353754, -801.2504877768351, -651.4381277754807, -845.5434329194973, -444.07924914784655, -797.6538278964249, -836.3159389366913, -948.8275902496173, -1095.707193637604, -656.4448541624344, -1302.641640261805, -795.5740414039873, -766.5179230908888, -248.14387240298274, -643.5262512708772, -1139.904211458542, -918.0075971924484, -174.564945977339, -874.5567549984544, -419.9789399237887, -45.62723200894807, -655.7744092243322, -1232.5516354994907, -905.997556071005, -805.949055703492, -421.8695011719545, -726.6816474962617, -928.9980880977137, -964.1948790469704, -1073.1520446410514, -170.29915607984253, -905.9640465543376, -1018.3645799818923, -1336.1788854824192, -66.30853078246949, -1125.3402185440777, -281.0771271589138, -922.2966068020278, -566.1207907568712, -242.9121853883006, -1074.6039290341082, -993.1465049908268, -350.3248195090573, -735.2742616448883, -514.5369276190364], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 125, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 70, 150, 45, 139, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 107, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 50, 150, 126, 150, 150, 150, 150, 150, 110, 150, 150], "policy_policy_0_reward": [-701.2847794374574, -926.7649555367876, -1090.9451703487418, -1056.852001322872, -1143.8880213241239, -927.548936863468, -1038.5799319453693, -1033.5055773931247, -641.0879942686287, -1182.146327123169, -306.4251543408499, -461.98399094847196, -1182.589890531324, -1127.7149931200613, -769.9096310836786, -1102.9260194363833, -304.3872539230287, -1083.3164533024246, -935.4287411452945, -676.6447097458691, -904.5675024453135, -632.6779226150696, -67.99457595582538, -920.5964749729569, -22.0184185329043, -260.0434181451621, -413.9154636730155, -1045.5338694604213, -571.0467725607926, -774.7715501793554, -677.1479367599105, -1036.4562488941137, -632.3883827073273, -370.7355436647597, -639.9526543126163, -759.4280660248041, -688.843449089634, -750.8080791654539, -1064.1420285134036, -694.4816782235366, -913.9742812173125, -1133.6829169651346, -682.5059879090163, -704.2370556701595, -933.9423801072846, -656.309968946392, -708.5085595048902, -424.8969138407798, -180.46592495225002, -190.95085088522643, -1283.1149369929933, -914.2832314345003, -747.4448465368873, -1022.3525091700278, -1131.9423728893432, -559.4937910353754, -801.2504877768351, -651.4381277754807, -845.5434329194973, -444.07924914784655, -797.6538278964249, -836.3159389366913, -948.8275902496173, -1095.707193637604, -656.4448541624344, -1302.641640261805, -795.5740414039873, -766.5179230908888, -248.14387240298274, -643.5262512708772, -1139.904211458542, -918.0075971924484, -174.564945977339, -874.5567549984544, -419.9789399237887, -45.62723200894807, -655.7744092243322, -1232.5516354994907, -905.997556071005, -805.949055703492, -421.8695011719545, -726.6816474962617, -928.9980880977137, -964.1948790469704, -1073.1520446410514, -170.29915607984253, -905.9640465543376, -1018.3645799818923, -1336.1788854824192, -66.30853078246949, -1125.3402185440777, -281.0771271589138, -922.2966068020278, -566.1207907568712, -242.9121853883006, -1074.6039290341082, -993.1465049908268, -350.3248195090573, -735.2742616448883, -514.5369276190364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5600294157583395, "mean_inference_ms": 1.6906388462042978, "mean_action_processing_ms": 0.28358071453000233, "mean_env_wait_ms": 3.0030406656568545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013200521469116211, "StateBufferConnector_ms": 0.008690118789672852, "ViewRequirementAgentConnector_ms": 0.20079565048217773}, "num_episodes": 29, "episode_return_max": -22.0184185329043, "episode_return_min": -1336.1788854824192, "episode_return_mean": -752.338085968689, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.26838189370767, "num_env_steps_trained_throughput_per_sec": 305.26838189370767, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12147.551, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12147.475, "sample_time_ms": 1038.212, "learn_time_ms": 11044.466, "learn_throughput": 362.172, "synch_weights_time_ms": 63.956}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00010", "date": "2024-08-03_11-12-07", "timestamp": 1722663727, "time_this_iter_s": 13.116185426712036, "time_total_s": 97.28104662895203, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245747010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 97.28104662895203, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.557894736842107, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.949192354579766, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.92727162539959, "policy_loss": -0.009210267843445762, "vf_loss": 8.933487006028493, "vf_explained_var": 0.5061399005974333, "kl": 0.015309704967179044, "entropy": 1.5980328002323707, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -36.86144235436783, "episode_reward_min": -1336.1788854824192, "episode_reward_mean": -732.2795161331582, "episode_len_mean": 140.18, "episode_media": {}, "episodes_timesteps_total": 14018, "policy_reward_min": {"policy_0": -1336.1788854824192}, "policy_reward_max": {"policy_0": -36.86144235436783}, "policy_reward_mean": {"policy_0": -732.2795161331582}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-571.0467725607926, -774.7715501793554, -677.1479367599105, -1036.4562488941137, -632.3883827073273, -370.7355436647597, -639.9526543126163, -759.4280660248041, -688.843449089634, -750.8080791654539, -1064.1420285134036, -694.4816782235366, -913.9742812173125, -1133.6829169651346, -682.5059879090163, -704.2370556701595, -933.9423801072846, -656.309968946392, -708.5085595048902, -424.8969138407798, -180.46592495225002, -190.95085088522643, -1283.1149369929933, -914.2832314345003, -747.4448465368873, -1022.3525091700278, -1131.9423728893432, -559.4937910353754, -801.2504877768351, -651.4381277754807, -845.5434329194973, -444.07924914784655, -797.6538278964249, -836.3159389366913, -948.8275902496173, -1095.707193637604, -656.4448541624344, -1302.641640261805, -795.5740414039873, -766.5179230908888, -248.14387240298274, -643.5262512708772, -1139.904211458542, -918.0075971924484, -174.564945977339, -874.5567549984544, -419.9789399237887, -45.62723200894807, -655.7744092243322, -1232.5516354994907, -905.997556071005, -805.949055703492, -421.8695011719545, -726.6816474962617, -928.9980880977137, -964.1948790469704, -1073.1520446410514, -170.29915607984253, -905.9640465543376, -1018.3645799818923, -1336.1788854824192, -66.30853078246949, -1125.3402185440777, -281.0771271589138, -922.2966068020278, -566.1207907568712, -242.9121853883006, -1074.6039290341082, -993.1465049908268, -350.3248195090573, -735.2742616448883, -514.5369276190364, -131.54064349914796, -293.78963336581467, -715.6357502852449, -867.8821843528175, -89.28610260995056, -1180.8213374808358, -850.4222447391913, -714.3755338209633, -551.3849152009914, -831.422514061307, -573.1457491310645, -137.79062628111558, -36.86144235436783, -1215.319638232549, -1060.5782584293988, -1135.9929760121997, -942.9326598285356, -899.1480833023985, -985.134918776037, -493.2795022147104, -1040.7675005744065, -900.1368281984392, -838.8594999235025, -1055.769778040217, -1091.496820894668, -276.00938787479294, -412.8950466912059, -632.7416192128456], "episode_lengths": [150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 107, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 50, 150, 126, 150, 150, 150, 150, 150, 110, 150, 150, 89, 90, 150, 150, 54, 150, 150, 150, 146, 150, 150, 84, 60, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 84, 150, 150], "policy_policy_0_reward": [-571.0467725607926, -774.7715501793554, -677.1479367599105, -1036.4562488941137, -632.3883827073273, -370.7355436647597, -639.9526543126163, -759.4280660248041, -688.843449089634, -750.8080791654539, -1064.1420285134036, -694.4816782235366, -913.9742812173125, -1133.6829169651346, -682.5059879090163, -704.2370556701595, -933.9423801072846, -656.309968946392, -708.5085595048902, -424.8969138407798, -180.46592495225002, -190.95085088522643, -1283.1149369929933, -914.2832314345003, -747.4448465368873, -1022.3525091700278, -1131.9423728893432, -559.4937910353754, -801.2504877768351, -651.4381277754807, -845.5434329194973, -444.07924914784655, -797.6538278964249, -836.3159389366913, -948.8275902496173, -1095.707193637604, -656.4448541624344, -1302.641640261805, -795.5740414039873, -766.5179230908888, -248.14387240298274, -643.5262512708772, -1139.904211458542, -918.0075971924484, -174.564945977339, -874.5567549984544, -419.9789399237887, -45.62723200894807, -655.7744092243322, -1232.5516354994907, -905.997556071005, -805.949055703492, -421.8695011719545, -726.6816474962617, -928.9980880977137, -964.1948790469704, -1073.1520446410514, -170.29915607984253, -905.9640465543376, -1018.3645799818923, -1336.1788854824192, -66.30853078246949, -1125.3402185440777, -281.0771271589138, -922.2966068020278, -566.1207907568712, -242.9121853883006, -1074.6039290341082, -993.1465049908268, -350.3248195090573, -735.2742616448883, -514.5369276190364, -131.54064349914796, -293.78963336581467, -715.6357502852449, -867.8821843528175, -89.28610260995056, -1180.8213374808358, -850.4222447391913, -714.3755338209633, -551.3849152009914, -831.422514061307, -573.1457491310645, -137.79062628111558, -36.86144235436783, -1215.319638232549, -1060.5782584293988, -1135.9929760121997, -942.9326598285356, -899.1480833023985, -985.134918776037, -493.2795022147104, -1040.7675005744065, -900.1368281984392, -838.8594999235025, -1055.769778040217, -1091.496820894668, -276.00938787479294, -412.8950466912059, -632.7416192128456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5601966796773167, "mean_inference_ms": 1.6948794245085326, "mean_action_processing_ms": 0.28331746253887236, "mean_env_wait_ms": 3.0162871547306906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012370586395263672, "StateBufferConnector_ms": 0.008139371871948242, "ViewRequirementAgentConnector_ms": 0.197218656539917}, "num_episodes": 28, "episode_return_max": -36.86144235436783, "episode_return_min": -1336.1788854824192, "episode_return_mean": -732.2795161331582, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.24616818834807, "num_env_steps_trained_throughput_per_sec": 340.24616818834807, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12104.068, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12103.992, "sample_time_ms": 1038.811, "learn_time_ms": 10999.452, "learn_throughput": 363.654, "synch_weights_time_ms": 64.896}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00010", "date": "2024-08-03_11-12-19", "timestamp": 1722663739, "time_this_iter_s": 11.768783330917358, "time_total_s": 109.04982995986938, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245747d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 109.04982995986938, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 14.605882352941178, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.452434818384548, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.570168997347356, "policy_loss": -0.015498614351963624, "vf_loss": 8.583188637594382, "vf_explained_var": 0.46696453417340916, "kl": 0.013746862129240386, "entropy": 1.6451058895637591, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -21.880340938772083, "episode_reward_min": -1391.914394866947, "episode_reward_mean": -732.8349140401108, "episode_len_mean": 139.71, "episode_media": {}, "episodes_timesteps_total": 13971, "policy_reward_min": {"policy_0": -1391.914394866947}, "policy_reward_max": {"policy_0": -21.880340938772083}, "policy_reward_mean": {"policy_0": -732.8349140401108}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559.4937910353754, -801.2504877768351, -651.4381277754807, -845.5434329194973, -444.07924914784655, -797.6538278964249, -836.3159389366913, -948.8275902496173, -1095.707193637604, -656.4448541624344, -1302.641640261805, -795.5740414039873, -766.5179230908888, -248.14387240298274, -643.5262512708772, -1139.904211458542, -918.0075971924484, -174.564945977339, -874.5567549984544, -419.9789399237887, -45.62723200894807, -655.7744092243322, -1232.5516354994907, -905.997556071005, -805.949055703492, -421.8695011719545, -726.6816474962617, -928.9980880977137, -964.1948790469704, -1073.1520446410514, -170.29915607984253, -905.9640465543376, -1018.3645799818923, -1336.1788854824192, -66.30853078246949, -1125.3402185440777, -281.0771271589138, -922.2966068020278, -566.1207907568712, -242.9121853883006, -1074.6039290341082, -993.1465049908268, -350.3248195090573, -735.2742616448883, -514.5369276190364, -131.54064349914796, -293.78963336581467, -715.6357502852449, -867.8821843528175, -89.28610260995056, -1180.8213374808358, -850.4222447391913, -714.3755338209633, -551.3849152009914, -831.422514061307, -573.1457491310645, -137.79062628111558, -36.86144235436783, -1215.319638232549, -1060.5782584293988, -1135.9929760121997, -942.9326598285356, -899.1480833023985, -985.134918776037, -493.2795022147104, -1040.7675005744065, -900.1368281984392, -838.8594999235025, -1055.769778040217, -1091.496820894668, -276.00938787479294, -412.8950466912059, -632.7416192128456, -602.5515623699507, -1089.8478295124394, -697.321833509896, -1158.0019635288106, -952.3545271123903, -563.6286228190475, -613.1148546438749, -1009.2331105906169, -214.30035586839213, -606.2604837069864, -837.7023813973667, -1019.247790728773, -1116.5140184148252, -969.6216523467122, -780.0668268722759, -1137.9874869272624, -840.860391836097, -21.880340938772083, -332.96493585628116, -966.2090124051301, -812.2521649238138, -301.9871919444582, -789.9641342753785, -421.43946898362583, -416.8023265163194, -680.3252549166979, -1391.914394866947], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 107, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 50, 150, 126, 150, 150, 150, 150, 150, 110, 150, 150, 89, 90, 150, 150, 54, 150, 150, 150, 146, 150, 150, 84, 60, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 133, 150, 150, 111, 150, 150], "policy_policy_0_reward": [-559.4937910353754, -801.2504877768351, -651.4381277754807, -845.5434329194973, -444.07924914784655, -797.6538278964249, -836.3159389366913, -948.8275902496173, -1095.707193637604, -656.4448541624344, -1302.641640261805, -795.5740414039873, -766.5179230908888, -248.14387240298274, -643.5262512708772, -1139.904211458542, -918.0075971924484, -174.564945977339, -874.5567549984544, -419.9789399237887, -45.62723200894807, -655.7744092243322, -1232.5516354994907, -905.997556071005, -805.949055703492, -421.8695011719545, -726.6816474962617, -928.9980880977137, -964.1948790469704, -1073.1520446410514, -170.29915607984253, -905.9640465543376, -1018.3645799818923, -1336.1788854824192, -66.30853078246949, -1125.3402185440777, -281.0771271589138, -922.2966068020278, -566.1207907568712, -242.9121853883006, -1074.6039290341082, -993.1465049908268, -350.3248195090573, -735.2742616448883, -514.5369276190364, -131.54064349914796, -293.78963336581467, -715.6357502852449, -867.8821843528175, -89.28610260995056, -1180.8213374808358, -850.4222447391913, -714.3755338209633, -551.3849152009914, -831.422514061307, -573.1457491310645, -137.79062628111558, -36.86144235436783, -1215.319638232549, -1060.5782584293988, -1135.9929760121997, -942.9326598285356, -899.1480833023985, -985.134918776037, -493.2795022147104, -1040.7675005744065, -900.1368281984392, -838.8594999235025, -1055.769778040217, -1091.496820894668, -276.00938787479294, -412.8950466912059, -632.7416192128456, -602.5515623699507, -1089.8478295124394, -697.321833509896, -1158.0019635288106, -952.3545271123903, -563.6286228190475, -613.1148546438749, -1009.2331105906169, -214.30035586839213, -606.2604837069864, -837.7023813973667, -1019.247790728773, -1116.5140184148252, -969.6216523467122, -780.0668268722759, -1137.9874869272624, -840.860391836097, -21.880340938772083, -332.96493585628116, -966.2090124051301, -812.2521649238138, -301.9871919444582, -789.9641342753785, -421.43946898362583, -416.8023265163194, -680.3252549166979, -1391.914394866947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5576925003362098, "mean_inference_ms": 1.6950322047863338, "mean_action_processing_ms": 0.282934404658586, "mean_env_wait_ms": 3.0222570829495186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011939048767089844, "StateBufferConnector_ms": 0.007921457290649414, "ViewRequirementAgentConnector_ms": 0.19278264045715332}, "num_episodes": 27, "episode_return_max": -21.880340938772083, "episode_return_min": -1391.914394866947, "episode_return_mean": -732.8349140401108, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.1764648357429, "num_env_steps_trained_throughput_per_sec": 299.1764648357429, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12230.666, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12230.591, "sample_time_ms": 1035.62, "learn_time_ms": 11128.241, "learn_throughput": 359.446, "synch_weights_time_ms": 65.896}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00010", "date": "2024-08-03_11-12-32", "timestamp": 1722663752, "time_this_iter_s": 13.382402181625366, "time_total_s": 122.43223214149475, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245761e10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 122.43223214149475, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.394736842105265, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.917018963272373, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.087074998517831, "policy_loss": -0.009067394789599347, "vf_loss": 9.093612042069434, "vf_explained_var": 0.534084047563374, "kl": 0.01437646876584041, "entropy": 1.7825873780995607, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -21.880340938772083, "episode_reward_min": -1391.914394866947, "episode_reward_mean": -756.9690417166527, "episode_len_mean": 140.82, "episode_media": {}, "episodes_timesteps_total": 14082, "policy_reward_min": {"policy_0": -1391.914394866947}, "policy_reward_max": {"policy_0": -21.880340938772083}, "policy_reward_mean": {"policy_0": -756.9690417166527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726.6816474962617, -928.9980880977137, -964.1948790469704, -1073.1520446410514, -170.29915607984253, -905.9640465543376, -1018.3645799818923, -1336.1788854824192, -66.30853078246949, -1125.3402185440777, -281.0771271589138, -922.2966068020278, -566.1207907568712, -242.9121853883006, -1074.6039290341082, -993.1465049908268, -350.3248195090573, -735.2742616448883, -514.5369276190364, -131.54064349914796, -293.78963336581467, -715.6357502852449, -867.8821843528175, -89.28610260995056, -1180.8213374808358, -850.4222447391913, -714.3755338209633, -551.3849152009914, -831.422514061307, -573.1457491310645, -137.79062628111558, -36.86144235436783, -1215.319638232549, -1060.5782584293988, -1135.9929760121997, -942.9326598285356, -899.1480833023985, -985.134918776037, -493.2795022147104, -1040.7675005744065, -900.1368281984392, -838.8594999235025, -1055.769778040217, -1091.496820894668, -276.00938787479294, -412.8950466912059, -632.7416192128456, -602.5515623699507, -1089.8478295124394, -697.321833509896, -1158.0019635288106, -952.3545271123903, -563.6286228190475, -613.1148546438749, -1009.2331105906169, -214.30035586839213, -606.2604837069864, -837.7023813973667, -1019.247790728773, -1116.5140184148252, -969.6216523467122, -780.0668268722759, -1137.9874869272624, -840.860391836097, -21.880340938772083, -332.96493585628116, -966.2090124051301, -812.2521649238138, -301.9871919444582, -789.9641342753785, -421.43946898362583, -416.8023265163194, -680.3252549166979, -1391.914394866947, -896.0072835538626, -986.4627948487145, -158.6703161343594, -402.27435152693863, -697.1215017007958, -668.9580314753971, -1066.0244838106903, -766.2768218791547, -1214.644786689987, -750.0124208078627, -875.5895923146453, -1224.058682902575, -503.23172871105083, -1113.6678981530933, -474.6289442169575, -1372.0956284971483, -1330.7940725923909, -517.7208990014982, -625.9116184597377, -1026.912748953755, -896.5225908654642, -663.4249465697624, -1198.084523851125, -796.6024225746368, -738.4530379491382, -437.2007008116053], "episode_lengths": [150, 150, 150, 150, 97, 150, 150, 150, 50, 150, 126, 150, 150, 150, 150, 150, 110, 150, 150, 89, 90, 150, 150, 54, 150, 150, 150, 146, 150, 150, 84, 60, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 133, 150, 150, 111, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-726.6816474962617, -928.9980880977137, -964.1948790469704, -1073.1520446410514, -170.29915607984253, -905.9640465543376, -1018.3645799818923, -1336.1788854824192, -66.30853078246949, -1125.3402185440777, -281.0771271589138, -922.2966068020278, -566.1207907568712, -242.9121853883006, -1074.6039290341082, -993.1465049908268, -350.3248195090573, -735.2742616448883, -514.5369276190364, -131.54064349914796, -293.78963336581467, -715.6357502852449, -867.8821843528175, -89.28610260995056, -1180.8213374808358, -850.4222447391913, -714.3755338209633, -551.3849152009914, -831.422514061307, -573.1457491310645, -137.79062628111558, -36.86144235436783, -1215.319638232549, -1060.5782584293988, -1135.9929760121997, -942.9326598285356, -899.1480833023985, -985.134918776037, -493.2795022147104, -1040.7675005744065, -900.1368281984392, -838.8594999235025, -1055.769778040217, -1091.496820894668, -276.00938787479294, -412.8950466912059, -632.7416192128456, -602.5515623699507, -1089.8478295124394, -697.321833509896, -1158.0019635288106, -952.3545271123903, -563.6286228190475, -613.1148546438749, -1009.2331105906169, -214.30035586839213, -606.2604837069864, -837.7023813973667, -1019.247790728773, -1116.5140184148252, -969.6216523467122, -780.0668268722759, -1137.9874869272624, -840.860391836097, -21.880340938772083, -332.96493585628116, -966.2090124051301, -812.2521649238138, -301.9871919444582, -789.9641342753785, -421.43946898362583, -416.8023265163194, -680.3252549166979, -1391.914394866947, -896.0072835538626, -986.4627948487145, -158.6703161343594, -402.27435152693863, -697.1215017007958, -668.9580314753971, -1066.0244838106903, -766.2768218791547, -1214.644786689987, -750.0124208078627, -875.5895923146453, -1224.058682902575, -503.23172871105083, -1113.6678981530933, -474.6289442169575, -1372.0956284971483, -1330.7940725923909, -517.7208990014982, -625.9116184597377, -1026.912748953755, -896.5225908654642, -663.4249465697624, -1198.084523851125, -796.6024225746368, -738.4530379491382, -437.2007008116053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5566463949380699, "mean_inference_ms": 1.6954064360120866, "mean_action_processing_ms": 0.2824524879380431, "mean_env_wait_ms": 3.02718255865325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011977434158325195, "StateBufferConnector_ms": 0.00800633430480957, "ViewRequirementAgentConnector_ms": 0.19457769393920898}, "num_episodes": 26, "episode_return_max": -21.880340938772083, "episode_return_min": -1391.914394866947, "episode_return_mean": -756.9690417166527, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.96927339491316, "num_env_steps_trained_throughput_per_sec": 308.96927339491316, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12816.327, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12816.246, "sample_time_ms": 1038.045, "learn_time_ms": 11710.501, "learn_throughput": 341.574, "synch_weights_time_ms": 66.867}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00010", "date": "2024-08-03_11-12-45", "timestamp": 1722663765, "time_this_iter_s": 12.958459615707397, "time_total_s": 135.39069175720215, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245762170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 135.39069175720215, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 14.111111111111112, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.237263081471124, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.123403231799603, "policy_loss": -0.005311215141167243, "vf_loss": 8.126368018984795, "vf_explained_var": 0.5033016876628001, "kl": 0.013336509331656999, "entropy": 1.6545485207190116, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -21.880340938772083, "episode_reward_min": -1401.1829395213913, "episode_reward_mean": -803.5540877038356, "episode_len_mean": 143.36, "episode_media": {}, "episodes_timesteps_total": 14336, "policy_reward_min": {"policy_0": -1401.1829395213913}, "policy_reward_max": {"policy_0": -21.880340938772083}, "policy_reward_mean": {"policy_0": -803.5540877038356}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1060.5782584293988, -1135.9929760121997, -942.9326598285356, -899.1480833023985, -985.134918776037, -493.2795022147104, -1040.7675005744065, -900.1368281984392, -838.8594999235025, -1055.769778040217, -1091.496820894668, -276.00938787479294, -412.8950466912059, -632.7416192128456, -602.5515623699507, -1089.8478295124394, -697.321833509896, -1158.0019635288106, -952.3545271123903, -563.6286228190475, -613.1148546438749, -1009.2331105906169, -214.30035586839213, -606.2604837069864, -837.7023813973667, -1019.247790728773, -1116.5140184148252, -969.6216523467122, -780.0668268722759, -1137.9874869272624, -840.860391836097, -21.880340938772083, -332.96493585628116, -966.2090124051301, -812.2521649238138, -301.9871919444582, -789.9641342753785, -421.43946898362583, -416.8023265163194, -680.3252549166979, -1391.914394866947, -896.0072835538626, -986.4627948487145, -158.6703161343594, -402.27435152693863, -697.1215017007958, -668.9580314753971, -1066.0244838106903, -766.2768218791547, -1214.644786689987, -750.0124208078627, -875.5895923146453, -1224.058682902575, -503.23172871105083, -1113.6678981530933, -474.6289442169575, -1372.0956284971483, -1330.7940725923909, -517.7208990014982, -625.9116184597377, -1026.912748953755, -896.5225908654642, -663.4249465697624, -1198.084523851125, -796.6024225746368, -738.4530379491382, -437.2007008116053, -1133.491025961812, -1362.353787286737, -234.5228553337077, -374.05674912841397, -214.61363477009212, -691.0641868097334, -1199.9524830735918, -1154.0028435588704, -476.66630072837336, -851.6702024554248, -1236.7819340366984, -705.425106603431, -902.7553727491509, -1147.8186061769038, -701.9696835340367, -961.1937806595098, -581.6728842020351, -485.35322519321835, -1195.823206144637, -687.8240194229268, -557.3800148751783, -533.7071267782004, -328.983508973499, -247.2777789838852, -1401.1829395213913, -168.38992800027114, -1003.1378561856656, -937.6694166313969, -1288.4117681334956, -1236.4359838009639, -798.3467981818716, -980.9315071797678, -1063.0916286698446], "episode_lengths": [150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 133, 150, 150, 111, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 146, 92, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 116, 85, 150, 93, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1060.5782584293988, -1135.9929760121997, -942.9326598285356, -899.1480833023985, -985.134918776037, -493.2795022147104, -1040.7675005744065, -900.1368281984392, -838.8594999235025, -1055.769778040217, -1091.496820894668, -276.00938787479294, -412.8950466912059, -632.7416192128456, -602.5515623699507, -1089.8478295124394, -697.321833509896, -1158.0019635288106, -952.3545271123903, -563.6286228190475, -613.1148546438749, -1009.2331105906169, -214.30035586839213, -606.2604837069864, -837.7023813973667, -1019.247790728773, -1116.5140184148252, -969.6216523467122, -780.0668268722759, -1137.9874869272624, -840.860391836097, -21.880340938772083, -332.96493585628116, -966.2090124051301, -812.2521649238138, -301.9871919444582, -789.9641342753785, -421.43946898362583, -416.8023265163194, -680.3252549166979, -1391.914394866947, -896.0072835538626, -986.4627948487145, -158.6703161343594, -402.27435152693863, -697.1215017007958, -668.9580314753971, -1066.0244838106903, -766.2768218791547, -1214.644786689987, -750.0124208078627, -875.5895923146453, -1224.058682902575, -503.23172871105083, -1113.6678981530933, -474.6289442169575, -1372.0956284971483, -1330.7940725923909, -517.7208990014982, -625.9116184597377, -1026.912748953755, -896.5225908654642, -663.4249465697624, -1198.084523851125, -796.6024225746368, -738.4530379491382, -437.2007008116053, -1133.491025961812, -1362.353787286737, -234.5228553337077, -374.05674912841397, -214.61363477009212, -691.0641868097334, -1199.9524830735918, -1154.0028435588704, -476.66630072837336, -851.6702024554248, -1236.7819340366984, -705.425106603431, -902.7553727491509, -1147.8186061769038, -701.9696835340367, -961.1937806595098, -581.6728842020351, -485.35322519321835, -1195.823206144637, -687.8240194229268, -557.3800148751783, -533.7071267782004, -328.983508973499, -247.2777789838852, -1401.1829395213913, -168.38992800027114, -1003.1378561856656, -937.6694166313969, -1288.4117681334956, -1236.4359838009639, -798.3467981818716, -980.9315071797678, -1063.0916286698446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562208481295329, "mean_inference_ms": 1.694794809445056, "mean_action_processing_ms": 0.28193023112752713, "mean_env_wait_ms": 3.036799883441309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011873006820678711, "StateBufferConnector_ms": 0.008008003234863281, "ViewRequirementAgentConnector_ms": 0.19493484497070312}, "num_episodes": 33, "episode_return_max": -21.880340938772083, "episode_return_min": -1401.1829395213913, "episode_return_mean": -803.5540877038356, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.38342071834114, "num_env_steps_trained_throughput_per_sec": 366.38342071834114, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12618.881, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12618.8, "sample_time_ms": 1042.625, "learn_time_ms": 11509.144, "learn_throughput": 347.55, "synch_weights_time_ms": 66.166}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00010", "date": "2024-08-03_11-12-56", "timestamp": 1722663776, "time_this_iter_s": 10.930727481842041, "time_total_s": 146.3214192390442, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245747d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 146.3214192390442, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 14.90625, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.20030934388439, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.466616768141588, "policy_loss": -0.013457339420953455, "vf_loss": 8.476505102217198, "vf_explained_var": 0.6339014048998555, "kl": 0.017325181785029523, "entropy": 1.6285020211090644, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -21.880340938772083, "episode_reward_min": -1401.1829395213913, "episode_reward_mean": -782.3121450853229, "episode_len_mean": 140.71, "episode_media": {}, "episodes_timesteps_total": 14071, "policy_reward_min": {"policy_0": -1401.1829395213913}, "policy_reward_max": {"policy_0": -21.880340938772083}, "policy_reward_mean": {"policy_0": -782.3121450853229}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-780.0668268722759, -1137.9874869272624, -840.860391836097, -21.880340938772083, -332.96493585628116, -966.2090124051301, -812.2521649238138, -301.9871919444582, -789.9641342753785, -421.43946898362583, -416.8023265163194, -680.3252549166979, -1391.914394866947, -896.0072835538626, -986.4627948487145, -158.6703161343594, -402.27435152693863, -697.1215017007958, -668.9580314753971, -1066.0244838106903, -766.2768218791547, -1214.644786689987, -750.0124208078627, -875.5895923146453, -1224.058682902575, -503.23172871105083, -1113.6678981530933, -474.6289442169575, -1372.0956284971483, -1330.7940725923909, -517.7208990014982, -625.9116184597377, -1026.912748953755, -896.5225908654642, -663.4249465697624, -1198.084523851125, -796.6024225746368, -738.4530379491382, -437.2007008116053, -1133.491025961812, -1362.353787286737, -234.5228553337077, -374.05674912841397, -214.61363477009212, -691.0641868097334, -1199.9524830735918, -1154.0028435588704, -476.66630072837336, -851.6702024554248, -1236.7819340366984, -705.425106603431, -902.7553727491509, -1147.8186061769038, -701.9696835340367, -961.1937806595098, -581.6728842020351, -485.35322519321835, -1195.823206144637, -687.8240194229268, -557.3800148751783, -533.7071267782004, -328.983508973499, -247.2777789838852, -1401.1829395213913, -168.38992800027114, -1003.1378561856656, -937.6694166313969, -1288.4117681334956, -1236.4359838009639, -798.3467981818716, -980.9315071797678, -1063.0916286698446, -929.6844134470078, -740.4077838925562, -562.8468760689718, -1210.961714955774, -652.637532288984, -955.4306100397521, -1241.6570995625714, -806.0803435414524, -1250.098997505744, -747.5431572992817, -638.4175740432321, -424.2093541437486, -355.92098371046967, -434.22758966420275, -126.44622834169644, -124.27794430093608, -501.5037904649353, -1079.754383513226, -746.6425944850375, -634.0981163080107, -498.74545167534956, -883.6904175345906, -785.7142800885971, -1260.9150284559523, -1059.4998676567316, -908.2197512423426, -712.1229794557512, -819.494740985243], "episode_lengths": [150, 150, 150, 51, 150, 150, 150, 133, 150, 150, 111, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 146, 92, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 116, 85, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 133, 150, 129, 150, 150, 150, 150, 150, 150, 108, 91, 117, 76, 66, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-780.0668268722759, -1137.9874869272624, -840.860391836097, -21.880340938772083, -332.96493585628116, -966.2090124051301, -812.2521649238138, -301.9871919444582, -789.9641342753785, -421.43946898362583, -416.8023265163194, -680.3252549166979, -1391.914394866947, -896.0072835538626, -986.4627948487145, -158.6703161343594, -402.27435152693863, -697.1215017007958, -668.9580314753971, -1066.0244838106903, -766.2768218791547, -1214.644786689987, -750.0124208078627, -875.5895923146453, -1224.058682902575, -503.23172871105083, -1113.6678981530933, -474.6289442169575, -1372.0956284971483, -1330.7940725923909, -517.7208990014982, -625.9116184597377, -1026.912748953755, -896.5225908654642, -663.4249465697624, -1198.084523851125, -796.6024225746368, -738.4530379491382, -437.2007008116053, -1133.491025961812, -1362.353787286737, -234.5228553337077, -374.05674912841397, -214.61363477009212, -691.0641868097334, -1199.9524830735918, -1154.0028435588704, -476.66630072837336, -851.6702024554248, -1236.7819340366984, -705.425106603431, -902.7553727491509, -1147.8186061769038, -701.9696835340367, -961.1937806595098, -581.6728842020351, -485.35322519321835, -1195.823206144637, -687.8240194229268, -557.3800148751783, -533.7071267782004, -328.983508973499, -247.2777789838852, -1401.1829395213913, -168.38992800027114, -1003.1378561856656, -937.6694166313969, -1288.4117681334956, -1236.4359838009639, -798.3467981818716, -980.9315071797678, -1063.0916286698446, -929.6844134470078, -740.4077838925562, -562.8468760689718, -1210.961714955774, -652.637532288984, -955.4306100397521, -1241.6570995625714, -806.0803435414524, -1250.098997505744, -747.5431572992817, -638.4175740432321, -424.2093541437486, -355.92098371046967, -434.22758966420275, -126.44622834169644, -124.27794430093608, -501.5037904649353, -1079.754383513226, -746.6425944850375, -634.0981163080107, -498.74545167534956, -883.6904175345906, -785.7142800885971, -1260.9150284559523, -1059.4998676567316, -908.2197512423426, -712.1229794557512, -819.494740985243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560938450402042, "mean_inference_ms": 1.6953319077126574, "mean_action_processing_ms": 0.2817912943058595, "mean_env_wait_ms": 3.0408006706317248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011833667755126953, "StateBufferConnector_ms": 0.00806570053100586, "ViewRequirementAgentConnector_ms": 0.1968085765838623}, "num_episodes": 28, "episode_return_max": -21.880340938772083, "episode_return_min": -1401.1829395213913, "episode_return_mean": -782.3121450853229, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.6411282435373, "num_env_steps_trained_throughput_per_sec": 299.6411282435373, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12625.861, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12625.779, "sample_time_ms": 1044.266, "learn_time_ms": 11512.205, "learn_throughput": 347.457, "synch_weights_time_ms": 68.451}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00010", "date": "2024-08-03_11-13-09", "timestamp": 1722663789, "time_this_iter_s": 13.362205982208252, "time_total_s": 159.68362522125244, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245745750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 159.68362522125244, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.505263157894735, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.92606701304515, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.847311918934186, "policy_loss": -0.011784460024015668, "vf_loss": 7.85622024188439, "vf_explained_var": 0.7296604833876094, "kl": 0.01475598664055724, "entropy": 1.550644446288546, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -35.9682809257037, "episode_reward_min": -1500.9813034116323, "episode_reward_mean": -758.6414355456261, "episode_len_mean": 136.85, "episode_media": {}, "episodes_timesteps_total": 13685, "policy_reward_min": {"policy_0": -1500.9813034116323}, "policy_reward_max": {"policy_0": -35.9682809257037}, "policy_reward_mean": {"policy_0": -758.6414355456261}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-625.9116184597377, -1026.912748953755, -896.5225908654642, -663.4249465697624, -1198.084523851125, -796.6024225746368, -738.4530379491382, -437.2007008116053, -1133.491025961812, -1362.353787286737, -234.5228553337077, -374.05674912841397, -214.61363477009212, -691.0641868097334, -1199.9524830735918, -1154.0028435588704, -476.66630072837336, -851.6702024554248, -1236.7819340366984, -705.425106603431, -902.7553727491509, -1147.8186061769038, -701.9696835340367, -961.1937806595098, -581.6728842020351, -485.35322519321835, -1195.823206144637, -687.8240194229268, -557.3800148751783, -533.7071267782004, -328.983508973499, -247.2777789838852, -1401.1829395213913, -168.38992800027114, -1003.1378561856656, -937.6694166313969, -1288.4117681334956, -1236.4359838009639, -798.3467981818716, -980.9315071797678, -1063.0916286698446, -929.6844134470078, -740.4077838925562, -562.8468760689718, -1210.961714955774, -652.637532288984, -955.4306100397521, -1241.6570995625714, -806.0803435414524, -1250.098997505744, -747.5431572992817, -638.4175740432321, -424.2093541437486, -355.92098371046967, -434.22758966420275, -126.44622834169644, -124.27794430093608, -501.5037904649353, -1079.754383513226, -746.6425944850375, -634.0981163080107, -498.74545167534956, -883.6904175345906, -785.7142800885971, -1260.9150284559523, -1059.4998676567316, -908.2197512423426, -712.1229794557512, -819.494740985243, -793.7054522033039, -106.54617274386354, -453.93797511345116, -1067.5905136046772, -880.1517705147002, -40.90357376640011, -693.4998638620428, -682.5620535471948, -629.6986294055085, -1092.6515488634332, -440.1196355937734, -1500.9813034116323, -851.0324786126879, -899.5515822796862, -1075.4176080972297, -159.26398721226013, -1072.2671912465219, -1104.1090645994232, -971.3239535009008, -99.12034993732091, -1153.9951323738546, -319.4678224218344, -251.81236626682403, -837.942767731925, -710.9719705319344, -123.35284183261744, -899.5325243112022, -755.5953931833599, -816.9394055147853, -35.9682809257037, -1025.8100029004484], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 146, 92, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 116, 85, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 133, 150, 129, 150, 150, 150, 150, 150, 150, 108, 91, 117, 76, 66, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 52, 150, 150, 150, 150, 105, 150, 150, 150, 150, 83, 150, 150, 150, 53, 150, 95, 91, 150, 149, 103, 150, 150, 150, 60, 150], "policy_policy_0_reward": [-625.9116184597377, -1026.912748953755, -896.5225908654642, -663.4249465697624, -1198.084523851125, -796.6024225746368, -738.4530379491382, -437.2007008116053, -1133.491025961812, -1362.353787286737, -234.5228553337077, -374.05674912841397, -214.61363477009212, -691.0641868097334, -1199.9524830735918, -1154.0028435588704, -476.66630072837336, -851.6702024554248, -1236.7819340366984, -705.425106603431, -902.7553727491509, -1147.8186061769038, -701.9696835340367, -961.1937806595098, -581.6728842020351, -485.35322519321835, -1195.823206144637, -687.8240194229268, -557.3800148751783, -533.7071267782004, -328.983508973499, -247.2777789838852, -1401.1829395213913, -168.38992800027114, -1003.1378561856656, -937.6694166313969, -1288.4117681334956, -1236.4359838009639, -798.3467981818716, -980.9315071797678, -1063.0916286698446, -929.6844134470078, -740.4077838925562, -562.8468760689718, -1210.961714955774, -652.637532288984, -955.4306100397521, -1241.6570995625714, -806.0803435414524, -1250.098997505744, -747.5431572992817, -638.4175740432321, -424.2093541437486, -355.92098371046967, -434.22758966420275, -126.44622834169644, -124.27794430093608, -501.5037904649353, -1079.754383513226, -746.6425944850375, -634.0981163080107, -498.74545167534956, -883.6904175345906, -785.7142800885971, -1260.9150284559523, -1059.4998676567316, -908.2197512423426, -712.1229794557512, -819.494740985243, -793.7054522033039, -106.54617274386354, -453.93797511345116, -1067.5905136046772, -880.1517705147002, -40.90357376640011, -693.4998638620428, -682.5620535471948, -629.6986294055085, -1092.6515488634332, -440.1196355937734, -1500.9813034116323, -851.0324786126879, -899.5515822796862, -1075.4176080972297, -159.26398721226013, -1072.2671912465219, -1104.1090645994232, -971.3239535009008, -99.12034993732091, -1153.9951323738546, -319.4678224218344, -251.81236626682403, -837.942767731925, -710.9719705319344, -123.35284183261744, -899.5325243112022, -755.5953931833599, -816.9394055147853, -35.9682809257037, -1025.8100029004484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556597192808686, "mean_inference_ms": 1.694651689798626, "mean_action_processing_ms": 0.2815243829760891, "mean_env_wait_ms": 3.043545844707625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011649608612060547, "StateBufferConnector_ms": 0.007880687713623047, "ViewRequirementAgentConnector_ms": 0.19510841369628906}, "num_episodes": 31, "episode_return_max": -35.9682809257037, "episode_return_min": -1500.9813034116323, "episode_return_mean": -758.6414355456261, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.9854106842563, "num_env_steps_trained_throughput_per_sec": 325.9854106842563, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12704.057, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12703.975, "sample_time_ms": 1045.675, "learn_time_ms": 11590.173, "learn_throughput": 345.12, "synch_weights_time_ms": 67.266}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00010", "date": "2024-08-03_11-13-22", "timestamp": 1722663802, "time_this_iter_s": 12.284239768981934, "time_total_s": 171.96786499023438, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d1990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 171.96786499023438, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.888235294117647, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.304180307189625, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.77204448034366, "policy_loss": -0.010441697091058208, "vf_loss": 7.779518959919612, "vf_explained_var": 0.7771430396785338, "kl": 0.01500156359731289, "entropy": 1.533254593486587, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -35.9682809257037, "episode_reward_min": -1500.9813034116323, "episode_reward_mean": -721.6386700690456, "episode_len_mean": 135.86, "episode_media": {}, "episodes_timesteps_total": 13586, "policy_reward_min": {"policy_0": -1500.9813034116323}, "policy_reward_max": {"policy_0": -35.9682809257037}, "policy_reward_mean": {"policy_0": -721.6386700690456}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1195.823206144637, -687.8240194229268, -557.3800148751783, -533.7071267782004, -328.983508973499, -247.2777789838852, -1401.1829395213913, -168.38992800027114, -1003.1378561856656, -937.6694166313969, -1288.4117681334956, -1236.4359838009639, -798.3467981818716, -980.9315071797678, -1063.0916286698446, -929.6844134470078, -740.4077838925562, -562.8468760689718, -1210.961714955774, -652.637532288984, -955.4306100397521, -1241.6570995625714, -806.0803435414524, -1250.098997505744, -747.5431572992817, -638.4175740432321, -424.2093541437486, -355.92098371046967, -434.22758966420275, -126.44622834169644, -124.27794430093608, -501.5037904649353, -1079.754383513226, -746.6425944850375, -634.0981163080107, -498.74545167534956, -883.6904175345906, -785.7142800885971, -1260.9150284559523, -1059.4998676567316, -908.2197512423426, -712.1229794557512, -819.494740985243, -793.7054522033039, -106.54617274386354, -453.93797511345116, -1067.5905136046772, -880.1517705147002, -40.90357376640011, -693.4998638620428, -682.5620535471948, -629.6986294055085, -1092.6515488634332, -440.1196355937734, -1500.9813034116323, -851.0324786126879, -899.5515822796862, -1075.4176080972297, -159.26398721226013, -1072.2671912465219, -1104.1090645994232, -971.3239535009008, -99.12034993732091, -1153.9951323738546, -319.4678224218344, -251.81236626682403, -837.942767731925, -710.9719705319344, -123.35284183261744, -899.5325243112022, -755.5953931833599, -816.9394055147853, -35.9682809257037, -1025.8100029004484, -596.7972815825036, -954.4443617897427, -301.6700610531517, -856.1724517747372, -1032.8653744681744, -709.8416416247164, -85.31821027124758, -790.0404491362341, -605.4207724612003, -345.5682676069785, -1134.7834879193476, -556.5152448960519, -920.6490826540522, -521.9996410570916, -665.0765577637459, -504.1569334100478, -558.1110981710211, -938.35708931933, -74.43786875378527, -659.8663862023418, -970.7492733061522, -1171.2935025373163, -618.7866239200087, -116.85296973013821, -372.57158935695315, -1035.854483872848], "episode_lengths": [150, 150, 150, 150, 116, 85, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 133, 150, 129, 150, 150, 150, 150, 150, 150, 108, 91, 117, 76, 66, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 52, 150, 150, 150, 150, 105, 150, 150, 150, 150, 83, 150, 150, 150, 53, 150, 95, 91, 150, 149, 103, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 42, 150, 150, 150, 150, 85, 150, 150], "policy_policy_0_reward": [-1195.823206144637, -687.8240194229268, -557.3800148751783, -533.7071267782004, -328.983508973499, -247.2777789838852, -1401.1829395213913, -168.38992800027114, -1003.1378561856656, -937.6694166313969, -1288.4117681334956, -1236.4359838009639, -798.3467981818716, -980.9315071797678, -1063.0916286698446, -929.6844134470078, -740.4077838925562, -562.8468760689718, -1210.961714955774, -652.637532288984, -955.4306100397521, -1241.6570995625714, -806.0803435414524, -1250.098997505744, -747.5431572992817, -638.4175740432321, -424.2093541437486, -355.92098371046967, -434.22758966420275, -126.44622834169644, -124.27794430093608, -501.5037904649353, -1079.754383513226, -746.6425944850375, -634.0981163080107, -498.74545167534956, -883.6904175345906, -785.7142800885971, -1260.9150284559523, -1059.4998676567316, -908.2197512423426, -712.1229794557512, -819.494740985243, -793.7054522033039, -106.54617274386354, -453.93797511345116, -1067.5905136046772, -880.1517705147002, -40.90357376640011, -693.4998638620428, -682.5620535471948, -629.6986294055085, -1092.6515488634332, -440.1196355937734, -1500.9813034116323, -851.0324786126879, -899.5515822796862, -1075.4176080972297, -159.26398721226013, -1072.2671912465219, -1104.1090645994232, -971.3239535009008, -99.12034993732091, -1153.9951323738546, -319.4678224218344, -251.81236626682403, -837.942767731925, -710.9719705319344, -123.35284183261744, -899.5325243112022, -755.5953931833599, -816.9394055147853, -35.9682809257037, -1025.8100029004484, -596.7972815825036, -954.4443617897427, -301.6700610531517, -856.1724517747372, -1032.8653744681744, -709.8416416247164, -85.31821027124758, -790.0404491362341, -605.4207724612003, -345.5682676069785, -1134.7834879193476, -556.5152448960519, -920.6490826540522, -521.9996410570916, -665.0765577637459, -504.1569334100478, -558.1110981710211, -938.35708931933, -74.43786875378527, -659.8663862023418, -970.7492733061522, -1171.2935025373163, -618.7866239200087, -116.85296973013821, -372.57158935695315, -1035.854483872848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556888509116038, "mean_inference_ms": 1.6947674214247914, "mean_action_processing_ms": 0.28127616203052813, "mean_env_wait_ms": 3.0458362333272735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011806011199951172, "StateBufferConnector_ms": 0.007811546325683594, "ViewRequirementAgentConnector_ms": 0.19327926635742188}, "num_episodes": 26, "episode_return_max": -35.9682809257037, "episode_return_min": -1500.9813034116323, "episode_return_mean": -721.6386700690456, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.86462004931275, "num_env_steps_trained_throughput_per_sec": 292.86462004931275, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12795.424, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12795.344, "sample_time_ms": 1048.137, "learn_time_ms": 11677.962, "learn_throughput": 342.526, "synch_weights_time_ms": 68.382}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00010", "date": "2024-08-03_11-13-35", "timestamp": 1722663815, "time_this_iter_s": 13.67131781578064, "time_total_s": 185.63918280601501, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245746dd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 185.63918280601501, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 13.434999999999997, "ram_util_percent": 27.759999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.739176163077353, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.798919718960921, "policy_loss": -0.010426982204565623, "vf_loss": 7.805962905784448, "vf_explained_var": 0.7879155617207289, "kl": 0.016811319912054992, "entropy": 1.6596025401105483, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -21.287484272985296, "episode_reward_min": -1500.9813034116323, "episode_reward_mean": -705.0940006849979, "episode_len_mean": 134.94, "episode_media": {}, "episodes_timesteps_total": 13494, "policy_reward_min": {"policy_0": -1500.9813034116323}, "policy_reward_max": {"policy_0": -21.287484272985296}, "policy_reward_mean": {"policy_0": -705.0940006849979}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1079.754383513226, -746.6425944850375, -634.0981163080107, -498.74545167534956, -883.6904175345906, -785.7142800885971, -1260.9150284559523, -1059.4998676567316, -908.2197512423426, -712.1229794557512, -819.494740985243, -793.7054522033039, -106.54617274386354, -453.93797511345116, -1067.5905136046772, -880.1517705147002, -40.90357376640011, -693.4998638620428, -682.5620535471948, -629.6986294055085, -1092.6515488634332, -440.1196355937734, -1500.9813034116323, -851.0324786126879, -899.5515822796862, -1075.4176080972297, -159.26398721226013, -1072.2671912465219, -1104.1090645994232, -971.3239535009008, -99.12034993732091, -1153.9951323738546, -319.4678224218344, -251.81236626682403, -837.942767731925, -710.9719705319344, -123.35284183261744, -899.5325243112022, -755.5953931833599, -816.9394055147853, -35.9682809257037, -1025.8100029004484, -596.7972815825036, -954.4443617897427, -301.6700610531517, -856.1724517747372, -1032.8653744681744, -709.8416416247164, -85.31821027124758, -790.0404491362341, -605.4207724612003, -345.5682676069785, -1134.7834879193476, -556.5152448960519, -920.6490826540522, -521.9996410570916, -665.0765577637459, -504.1569334100478, -558.1110981710211, -938.35708931933, -74.43786875378527, -659.8663862023418, -970.7492733061522, -1171.2935025373163, -618.7866239200087, -116.85296973013821, -372.57158935695315, -1035.854483872848, -990.9468651406708, -21.350260147327123, -159.33930230698394, -1269.7192237146219, -1340.1193488743224, -175.0383243320919, -732.0056708265431, -661.7367878290931, -21.287484272985296, -727.4747210808252, -805.6122237042812, -753.3310416306815, -443.2598484545706, -933.9472851034652, -681.0906155833682, -846.2764337174223, -577.9858918815959, -699.9685898193025, -148.5620805466188, -1437.756764274769, -1024.3103638914986, -713.037912121963, -296.0502765025967, -1192.8939029105582, -940.7920100408796, -762.5141452480343, -961.5056717623982, -111.56908358925604, -890.0165649081111, -929.392693035648, -410.0803071545263, -817.5068419425247], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 52, 150, 150, 150, 150, 105, 150, 150, 150, 150, 83, 150, 150, 150, 53, 150, 95, 91, 150, 149, 103, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 42, 150, 150, 150, 150, 85, 150, 150, 150, 53, 75, 150, 150, 82, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 100, 150, 150, 150, 150, 60, 150, 150, 148, 150], "policy_policy_0_reward": [-1079.754383513226, -746.6425944850375, -634.0981163080107, -498.74545167534956, -883.6904175345906, -785.7142800885971, -1260.9150284559523, -1059.4998676567316, -908.2197512423426, -712.1229794557512, -819.494740985243, -793.7054522033039, -106.54617274386354, -453.93797511345116, -1067.5905136046772, -880.1517705147002, -40.90357376640011, -693.4998638620428, -682.5620535471948, -629.6986294055085, -1092.6515488634332, -440.1196355937734, -1500.9813034116323, -851.0324786126879, -899.5515822796862, -1075.4176080972297, -159.26398721226013, -1072.2671912465219, -1104.1090645994232, -971.3239535009008, -99.12034993732091, -1153.9951323738546, -319.4678224218344, -251.81236626682403, -837.942767731925, -710.9719705319344, -123.35284183261744, -899.5325243112022, -755.5953931833599, -816.9394055147853, -35.9682809257037, -1025.8100029004484, -596.7972815825036, -954.4443617897427, -301.6700610531517, -856.1724517747372, -1032.8653744681744, -709.8416416247164, -85.31821027124758, -790.0404491362341, -605.4207724612003, -345.5682676069785, -1134.7834879193476, -556.5152448960519, -920.6490826540522, -521.9996410570916, -665.0765577637459, -504.1569334100478, -558.1110981710211, -938.35708931933, -74.43786875378527, -659.8663862023418, -970.7492733061522, -1171.2935025373163, -618.7866239200087, -116.85296973013821, -372.57158935695315, -1035.854483872848, -990.9468651406708, -21.350260147327123, -159.33930230698394, -1269.7192237146219, -1340.1193488743224, -175.0383243320919, -732.0056708265431, -661.7367878290931, -21.287484272985296, -727.4747210808252, -805.6122237042812, -753.3310416306815, -443.2598484545706, -933.9472851034652, -681.0906155833682, -846.2764337174223, -577.9858918815959, -699.9685898193025, -148.5620805466188, -1437.756764274769, -1024.3103638914986, -713.037912121963, -296.0502765025967, -1192.8939029105582, -940.7920100408796, -762.5141452480343, -961.5056717623982, -111.56908358925604, -890.0165649081111, -929.392693035648, -410.0803071545263, -817.5068419425247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553725310495059, "mean_inference_ms": 1.6948939724457093, "mean_action_processing_ms": 0.2809530861620555, "mean_env_wait_ms": 3.04880302767818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011826753616333008, "StateBufferConnector_ms": 0.008121490478515625, "ViewRequirementAgentConnector_ms": 0.19723105430603027}, "num_episodes": 32, "episode_return_max": -21.287484272985296, "episode_return_min": -1500.9813034116323, "episode_return_mean": -705.0940006849979, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.99499597235337, "num_env_steps_trained_throughput_per_sec": 295.99499597235337, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12795.63, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12795.551, "sample_time_ms": 1043.99, "learn_time_ms": 11681.849, "learn_throughput": 342.412, "synch_weights_time_ms": 68.837}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00010", "date": "2024-08-03_11-13-49", "timestamp": 1722663829, "time_this_iter_s": 13.528215885162354, "time_total_s": 199.16739869117737, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245762050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 199.16739869117737, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.510526315789473, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.047326025366786, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.708168211579323, "policy_loss": -0.012596370411726336, "vf_loss": 7.717394669850667, "vf_explained_var": 0.7499372116600473, "kl": 0.01634299907691458, "entropy": 1.533008090655009, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -20.301753063445638, "episode_reward_min": -1516.2394378187203, "episode_reward_mean": -689.4337987699508, "episode_len_mean": 134.15, "episode_media": {}, "episodes_timesteps_total": 13415, "policy_reward_min": {"policy_0": -1516.2394378187203}, "policy_reward_max": {"policy_0": -20.301753063445638}, "policy_reward_mean": {"policy_0": -689.4337987699508}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1153.9951323738546, -319.4678224218344, -251.81236626682403, -837.942767731925, -710.9719705319344, -123.35284183261744, -899.5325243112022, -755.5953931833599, -816.9394055147853, -35.9682809257037, -1025.8100029004484, -596.7972815825036, -954.4443617897427, -301.6700610531517, -856.1724517747372, -1032.8653744681744, -709.8416416247164, -85.31821027124758, -790.0404491362341, -605.4207724612003, -345.5682676069785, -1134.7834879193476, -556.5152448960519, -920.6490826540522, -521.9996410570916, -665.0765577637459, -504.1569334100478, -558.1110981710211, -938.35708931933, -74.43786875378527, -659.8663862023418, -970.7492733061522, -1171.2935025373163, -618.7866239200087, -116.85296973013821, -372.57158935695315, -1035.854483872848, -990.9468651406708, -21.350260147327123, -159.33930230698394, -1269.7192237146219, -1340.1193488743224, -175.0383243320919, -732.0056708265431, -661.7367878290931, -21.287484272985296, -727.4747210808252, -805.6122237042812, -753.3310416306815, -443.2598484545706, -933.9472851034652, -681.0906155833682, -846.2764337174223, -577.9858918815959, -699.9685898193025, -148.5620805466188, -1437.756764274769, -1024.3103638914986, -713.037912121963, -296.0502765025967, -1192.8939029105582, -940.7920100408796, -762.5141452480343, -961.5056717623982, -111.56908358925604, -890.0165649081111, -929.392693035648, -410.0803071545263, -817.5068419425247, -820.8148274024672, -1182.8126526893848, -662.874913821658, -20.301753063445638, -1169.707664715395, -252.24817205774426, -776.6430497290654, -899.4419787415341, -1180.3333642453372, -402.04976505557124, -375.72942324278546, -636.8748518947114, -357.837406479472, -531.1402178636495, -366.773425914009, -532.1342170644555, -903.2363882750464, -136.6037351047544, -1101.6223639434606, -237.94437330142912, -1377.995144901276, -217.15946054551745, -538.6741291104596, -827.7779204129139, -1516.2394378187203, -678.7955193204696, -778.5842241657651, -1444.3811685462035, -1093.8207527997884, -585.7710017315553, -830.9888240541092], "episode_lengths": [150, 95, 91, 150, 149, 103, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 42, 150, 150, 150, 150, 85, 150, 150, 150, 53, 75, 150, 150, 82, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 100, 150, 150, 150, 150, 60, 150, 150, 148, 150, 150, 150, 150, 51, 150, 75, 150, 150, 150, 150, 100, 131, 119, 150, 150, 150, 150, 55, 150, 100, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1153.9951323738546, -319.4678224218344, -251.81236626682403, -837.942767731925, -710.9719705319344, -123.35284183261744, -899.5325243112022, -755.5953931833599, -816.9394055147853, -35.9682809257037, -1025.8100029004484, -596.7972815825036, -954.4443617897427, -301.6700610531517, -856.1724517747372, -1032.8653744681744, -709.8416416247164, -85.31821027124758, -790.0404491362341, -605.4207724612003, -345.5682676069785, -1134.7834879193476, -556.5152448960519, -920.6490826540522, -521.9996410570916, -665.0765577637459, -504.1569334100478, -558.1110981710211, -938.35708931933, -74.43786875378527, -659.8663862023418, -970.7492733061522, -1171.2935025373163, -618.7866239200087, -116.85296973013821, -372.57158935695315, -1035.854483872848, -990.9468651406708, -21.350260147327123, -159.33930230698394, -1269.7192237146219, -1340.1193488743224, -175.0383243320919, -732.0056708265431, -661.7367878290931, -21.287484272985296, -727.4747210808252, -805.6122237042812, -753.3310416306815, -443.2598484545706, -933.9472851034652, -681.0906155833682, -846.2764337174223, -577.9858918815959, -699.9685898193025, -148.5620805466188, -1437.756764274769, -1024.3103638914986, -713.037912121963, -296.0502765025967, -1192.8939029105582, -940.7920100408796, -762.5141452480343, -961.5056717623982, -111.56908358925604, -890.0165649081111, -929.392693035648, -410.0803071545263, -817.5068419425247, -820.8148274024672, -1182.8126526893848, -662.874913821658, -20.301753063445638, -1169.707664715395, -252.24817205774426, -776.6430497290654, -899.4419787415341, -1180.3333642453372, -402.04976505557124, -375.72942324278546, -636.8748518947114, -357.837406479472, -531.1402178636495, -366.773425914009, -532.1342170644555, -903.2363882750464, -136.6037351047544, -1101.6223639434606, -237.94437330142912, -1377.995144901276, -217.15946054551745, -538.6741291104596, -827.7779204129139, -1516.2394378187203, -678.7955193204696, -778.5842241657651, -1444.3811685462035, -1093.8207527997884, -585.7710017315553, -830.9888240541092]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554964325236091, "mean_inference_ms": 1.6942723700575886, "mean_action_processing_ms": 0.2806546559984888, "mean_env_wait_ms": 3.0498326865139216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012285470962524414, "StateBufferConnector_ms": 0.008138895034790039, "ViewRequirementAgentConnector_ms": 0.19753122329711914}, "num_episodes": 31, "episode_return_max": -20.301753063445638, "episode_return_min": -1516.2394378187203, "episode_return_mean": -689.4337987699508, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.3875102156009, "num_env_steps_trained_throughput_per_sec": 306.3875102156009, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12794.047, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12793.968, "sample_time_ms": 1044.935, "learn_time_ms": 11680.311, "learn_throughput": 342.457, "synch_weights_time_ms": 67.859}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00010", "date": "2024-08-03_11-14-02", "timestamp": 1722663842, "time_this_iter_s": 13.066430807113647, "time_total_s": 212.23382949829102, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245760790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 212.23382949829102, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.794736842105264, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.95447844862938, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.250067151586214, "policy_loss": -0.010686384172489245, "vf_loss": 7.257899198432764, "vf_explained_var": 0.8073510929942131, "kl": 0.015370024567588812, "entropy": 1.7566562864929438, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -20.301753063445638, "episode_reward_min": -1516.2394378187203, "episode_reward_mean": -723.6888609027525, "episode_len_mean": 134.84, "episode_media": {}, "episodes_timesteps_total": 13484, "policy_reward_min": {"policy_0": -1516.2394378187203}, "policy_reward_max": {"policy_0": -20.301753063445638}, "policy_reward_mean": {"policy_0": -723.6888609027525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-938.35708931933, -74.43786875378527, -659.8663862023418, -970.7492733061522, -1171.2935025373163, -618.7866239200087, -116.85296973013821, -372.57158935695315, -1035.854483872848, -990.9468651406708, -21.350260147327123, -159.33930230698394, -1269.7192237146219, -1340.1193488743224, -175.0383243320919, -732.0056708265431, -661.7367878290931, -21.287484272985296, -727.4747210808252, -805.6122237042812, -753.3310416306815, -443.2598484545706, -933.9472851034652, -681.0906155833682, -846.2764337174223, -577.9858918815959, -699.9685898193025, -148.5620805466188, -1437.756764274769, -1024.3103638914986, -713.037912121963, -296.0502765025967, -1192.8939029105582, -940.7920100408796, -762.5141452480343, -961.5056717623982, -111.56908358925604, -890.0165649081111, -929.392693035648, -410.0803071545263, -817.5068419425247, -820.8148274024672, -1182.8126526893848, -662.874913821658, -20.301753063445638, -1169.707664715395, -252.24817205774426, -776.6430497290654, -899.4419787415341, -1180.3333642453372, -402.04976505557124, -375.72942324278546, -636.8748518947114, -357.837406479472, -531.1402178636495, -366.773425914009, -532.1342170644555, -903.2363882750464, -136.6037351047544, -1101.6223639434606, -237.94437330142912, -1377.995144901276, -217.15946054551745, -538.6741291104596, -827.7779204129139, -1516.2394378187203, -678.7955193204696, -778.5842241657651, -1444.3811685462035, -1093.8207527997884, -585.7710017315553, -830.9888240541092, -545.375139210506, -1138.3644362083664, -930.4762903478314, -1108.4138261955425, -1326.4016942916533, -544.1165956462121, -160.94142442189994, -1168.6526491192274, -378.57578054480604, -281.55155273342444, -847.6193599257754, -523.4994454864628, -1152.9239123829293, -645.7467794602384, -771.6462934161464, -30.82323261042081, -722.1577440201697, -1158.3942340237447, -454.11640349017114, -42.76557333574612, -1038.4925850323925, -517.5659555314007, -1209.8503881331403, -1318.4962027926433, -716.2295051758397, -930.4645795984826, -1019.8748539839114, -812.7892017955992], "episode_lengths": [150, 42, 150, 150, 150, 150, 85, 150, 150, 150, 53, 75, 150, 150, 82, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 100, 150, 150, 150, 150, 60, 150, 150, 148, 150, 150, 150, 150, 51, 150, 75, 150, 150, 150, 150, 100, 131, 119, 150, 150, 150, 150, 55, 150, 100, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 147, 150, 150, 150, 150, 150, 150, 42, 150, 150, 141, 65, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-938.35708931933, -74.43786875378527, -659.8663862023418, -970.7492733061522, -1171.2935025373163, -618.7866239200087, -116.85296973013821, -372.57158935695315, -1035.854483872848, -990.9468651406708, -21.350260147327123, -159.33930230698394, -1269.7192237146219, -1340.1193488743224, -175.0383243320919, -732.0056708265431, -661.7367878290931, -21.287484272985296, -727.4747210808252, -805.6122237042812, -753.3310416306815, -443.2598484545706, -933.9472851034652, -681.0906155833682, -846.2764337174223, -577.9858918815959, -699.9685898193025, -148.5620805466188, -1437.756764274769, -1024.3103638914986, -713.037912121963, -296.0502765025967, -1192.8939029105582, -940.7920100408796, -762.5141452480343, -961.5056717623982, -111.56908358925604, -890.0165649081111, -929.392693035648, -410.0803071545263, -817.5068419425247, -820.8148274024672, -1182.8126526893848, -662.874913821658, -20.301753063445638, -1169.707664715395, -252.24817205774426, -776.6430497290654, -899.4419787415341, -1180.3333642453372, -402.04976505557124, -375.72942324278546, -636.8748518947114, -357.837406479472, -531.1402178636495, -366.773425914009, -532.1342170644555, -903.2363882750464, -136.6037351047544, -1101.6223639434606, -237.94437330142912, -1377.995144901276, -217.15946054551745, -538.6741291104596, -827.7779204129139, -1516.2394378187203, -678.7955193204696, -778.5842241657651, -1444.3811685462035, -1093.8207527997884, -585.7710017315553, -830.9888240541092, -545.375139210506, -1138.3644362083664, -930.4762903478314, -1108.4138261955425, -1326.4016942916533, -544.1165956462121, -160.94142442189994, -1168.6526491192274, -378.57578054480604, -281.55155273342444, -847.6193599257754, -523.4994454864628, -1152.9239123829293, -645.7467794602384, -771.6462934161464, -30.82323261042081, -722.1577440201697, -1158.3942340237447, -454.11640349017114, -42.76557333574612, -1038.4925850323925, -517.5659555314007, -1209.8503881331403, -1318.4962027926433, -716.2295051758397, -930.4645795984826, -1019.8748539839114, -812.7892017955992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550808887354384, "mean_inference_ms": 1.6926252951724663, "mean_action_processing_ms": 0.2804020962681994, "mean_env_wait_ms": 3.0506950896043827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012479543685913086, "StateBufferConnector_ms": 0.00811457633972168, "ViewRequirementAgentConnector_ms": 0.19715166091918945}, "num_episodes": 28, "episode_return_max": -20.301753063445638, "episode_return_min": -1516.2394378187203, "episode_return_mean": -723.6888609027525, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.93293788225066, "num_env_steps_trained_throughput_per_sec": 304.93293788225066, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12795.489, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12795.41, "sample_time_ms": 1040.635, "learn_time_ms": 11684.711, "learn_throughput": 342.328, "synch_weights_time_ms": 69.182}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00010", "date": "2024-08-03_11-14-15", "timestamp": 1722663855, "time_this_iter_s": 13.131767272949219, "time_total_s": 225.36559677124023, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245760ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 225.36559677124023, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.533333333333333, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.69312404642503, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.576752619445324, "policy_loss": -0.010925299660205686, "vf_loss": 7.584801861147086, "vf_explained_var": 0.7565456071868539, "kl": 0.016171876747769928, "entropy": 1.9755080498754978, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -20.301753063445638, "episode_reward_min": -1516.2394378187203, "episode_reward_mean": -774.3883225958768, "episode_len_mean": 138.85, "episode_media": {}, "episodes_timesteps_total": 13885, "policy_reward_min": {"policy_0": -1516.2394378187203}, "policy_reward_max": {"policy_0": -20.301753063445638}, "policy_reward_mean": {"policy_0": -774.3883225958768}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-699.9685898193025, -148.5620805466188, -1437.756764274769, -1024.3103638914986, -713.037912121963, -296.0502765025967, -1192.8939029105582, -940.7920100408796, -762.5141452480343, -961.5056717623982, -111.56908358925604, -890.0165649081111, -929.392693035648, -410.0803071545263, -817.5068419425247, -820.8148274024672, -1182.8126526893848, -662.874913821658, -20.301753063445638, -1169.707664715395, -252.24817205774426, -776.6430497290654, -899.4419787415341, -1180.3333642453372, -402.04976505557124, -375.72942324278546, -636.8748518947114, -357.837406479472, -531.1402178636495, -366.773425914009, -532.1342170644555, -903.2363882750464, -136.6037351047544, -1101.6223639434606, -237.94437330142912, -1377.995144901276, -217.15946054551745, -538.6741291104596, -827.7779204129139, -1516.2394378187203, -678.7955193204696, -778.5842241657651, -1444.3811685462035, -1093.8207527997884, -585.7710017315553, -830.9888240541092, -545.375139210506, -1138.3644362083664, -930.4762903478314, -1108.4138261955425, -1326.4016942916533, -544.1165956462121, -160.94142442189994, -1168.6526491192274, -378.57578054480604, -281.55155273342444, -847.6193599257754, -523.4994454864628, -1152.9239123829293, -645.7467794602384, -771.6462934161464, -30.82323261042081, -722.1577440201697, -1158.3942340237447, -454.11640349017114, -42.76557333574612, -1038.4925850323925, -517.5659555314007, -1209.8503881331403, -1318.4962027926433, -716.2295051758397, -930.4645795984826, -1019.8748539839114, -812.7892017955992, -811.4968803938337, -1024.5318796838308, -563.2625638802587, -1086.3087410103894, -1182.568997012253, -1098.3110619624795, -696.6462213097141, -764.6052092987836, -1247.5594512360171, -408.48943406080895, -262.29293543605945, -553.7333707095537, -1237.700785698889, -566.0230040507769, -1091.5456764014941, -1034.1949721110298, -1236.0787601463423, -580.5464458332569, -871.400921496045, -1061.9838834130028, -1306.298218854622, -387.2080593153036, -173.73502769247204, -1158.983768272309, -578.2415103795589, -1185.489505253062], "episode_lengths": [150, 59, 150, 150, 150, 100, 150, 150, 150, 150, 60, 150, 150, 148, 150, 150, 150, 150, 51, 150, 75, 150, 150, 150, 150, 100, 131, 119, 150, 150, 150, 150, 55, 150, 100, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 147, 150, 150, 150, 150, 150, 150, 42, 150, 150, 141, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150], "policy_policy_0_reward": [-699.9685898193025, -148.5620805466188, -1437.756764274769, -1024.3103638914986, -713.037912121963, -296.0502765025967, -1192.8939029105582, -940.7920100408796, -762.5141452480343, -961.5056717623982, -111.56908358925604, -890.0165649081111, -929.392693035648, -410.0803071545263, -817.5068419425247, -820.8148274024672, -1182.8126526893848, -662.874913821658, -20.301753063445638, -1169.707664715395, -252.24817205774426, -776.6430497290654, -899.4419787415341, -1180.3333642453372, -402.04976505557124, -375.72942324278546, -636.8748518947114, -357.837406479472, -531.1402178636495, -366.773425914009, -532.1342170644555, -903.2363882750464, -136.6037351047544, -1101.6223639434606, -237.94437330142912, -1377.995144901276, -217.15946054551745, -538.6741291104596, -827.7779204129139, -1516.2394378187203, -678.7955193204696, -778.5842241657651, -1444.3811685462035, -1093.8207527997884, -585.7710017315553, -830.9888240541092, -545.375139210506, -1138.3644362083664, -930.4762903478314, -1108.4138261955425, -1326.4016942916533, -544.1165956462121, -160.94142442189994, -1168.6526491192274, -378.57578054480604, -281.55155273342444, -847.6193599257754, -523.4994454864628, -1152.9239123829293, -645.7467794602384, -771.6462934161464, -30.82323261042081, -722.1577440201697, -1158.3942340237447, -454.11640349017114, -42.76557333574612, -1038.4925850323925, -517.5659555314007, -1209.8503881331403, -1318.4962027926433, -716.2295051758397, -930.4645795984826, -1019.8748539839114, -812.7892017955992, -811.4968803938337, -1024.5318796838308, -563.2625638802587, -1086.3087410103894, -1182.568997012253, -1098.3110619624795, -696.6462213097141, -764.6052092987836, -1247.5594512360171, -408.48943406080895, -262.29293543605945, -553.7333707095537, -1237.700785698889, -566.0230040507769, -1091.5456764014941, -1034.1949721110298, -1236.0787601463423, -580.5464458332569, -871.400921496045, -1061.9838834130028, -1306.298218854622, -387.2080593153036, -173.73502769247204, -1158.983768272309, -578.2415103795589, -1185.489505253062]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542421765618802, "mean_inference_ms": 1.6909512111054266, "mean_action_processing_ms": 0.2800285368492877, "mean_env_wait_ms": 3.053402790500583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012614250183105469, "StateBufferConnector_ms": 0.007924079895019531, "ViewRequirementAgentConnector_ms": 0.19730854034423828}, "num_episodes": 26, "episode_return_max": -20.301753063445638, "episode_return_min": -1516.2394378187203, "episode_return_mean": -774.3883225958768, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.86394639123654, "num_env_steps_trained_throughput_per_sec": 294.86394639123654, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12976.427, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12976.348, "sample_time_ms": 1044.822, "learn_time_ms": 11862.078, "learn_throughput": 337.209, "synch_weights_time_ms": 68.558}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00010", "date": "2024-08-03_11-14-29", "timestamp": 1722663869, "time_this_iter_s": 13.580245733261108, "time_total_s": 238.94584250450134, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d1990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 238.94584250450134, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.614999999999998, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.00960982441902, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.248228741188844, "policy_loss": -0.009631283673418997, "vf_loss": 7.254489398002624, "vf_explained_var": 0.8589242967466514, "kl": 0.017737015339829063, "entropy": 1.9504699372996888, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -30.82323261042081, "episode_reward_min": -1516.2394378187203, "episode_reward_mean": -779.4535972963079, "episode_len_mean": 139.23, "episode_media": {}, "episodes_timesteps_total": 13923, "policy_reward_min": {"policy_0": -1516.2394378187203}, "policy_reward_max": {"policy_0": -30.82323261042081}, "policy_reward_mean": {"policy_0": -779.4535972963079}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-531.1402178636495, -366.773425914009, -532.1342170644555, -903.2363882750464, -136.6037351047544, -1101.6223639434606, -237.94437330142912, -1377.995144901276, -217.15946054551745, -538.6741291104596, -827.7779204129139, -1516.2394378187203, -678.7955193204696, -778.5842241657651, -1444.3811685462035, -1093.8207527997884, -585.7710017315553, -830.9888240541092, -545.375139210506, -1138.3644362083664, -930.4762903478314, -1108.4138261955425, -1326.4016942916533, -544.1165956462121, -160.94142442189994, -1168.6526491192274, -378.57578054480604, -281.55155273342444, -847.6193599257754, -523.4994454864628, -1152.9239123829293, -645.7467794602384, -771.6462934161464, -30.82323261042081, -722.1577440201697, -1158.3942340237447, -454.11640349017114, -42.76557333574612, -1038.4925850323925, -517.5659555314007, -1209.8503881331403, -1318.4962027926433, -716.2295051758397, -930.4645795984826, -1019.8748539839114, -812.7892017955992, -811.4968803938337, -1024.5318796838308, -563.2625638802587, -1086.3087410103894, -1182.568997012253, -1098.3110619624795, -696.6462213097141, -764.6052092987836, -1247.5594512360171, -408.48943406080895, -262.29293543605945, -553.7333707095537, -1237.700785698889, -566.0230040507769, -1091.5456764014941, -1034.1949721110298, -1236.0787601463423, -580.5464458332569, -871.400921496045, -1061.9838834130028, -1306.298218854622, -387.2080593153036, -173.73502769247204, -1158.983768272309, -578.2415103795589, -1185.489505253062, -464.79788045138866, -912.631294159572, -911.3790333654101, -1015.2278532043168, -977.7967162379584, -395.8886948177998, -959.6030958605475, -954.071281127001, -935.7596788817449, -150.54617769862693, -938.2305964205528, -1108.598471210869, -60.95399020843773, -461.55775919004907, -1045.407995378581, -894.9381675486021, -776.6557584806002, -48.42751941618969, -923.0203820493235, -936.4559347879116, -1199.7531938862098, -1118.449667775612, -238.82346981142908, -139.74393478566225, -709.5186254481004, -549.2494484700728, -302.1355516659831, -1450.5323285918237], "episode_lengths": [150, 150, 150, 150, 55, 150, 100, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 147, 150, 150, 150, 150, 150, 150, 42, 150, 150, 141, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 47, 150, 150, 150, 150, 56, 150, 150, 150, 150, 75, 64, 150, 123, 150, 150], "policy_policy_0_reward": [-531.1402178636495, -366.773425914009, -532.1342170644555, -903.2363882750464, -136.6037351047544, -1101.6223639434606, -237.94437330142912, -1377.995144901276, -217.15946054551745, -538.6741291104596, -827.7779204129139, -1516.2394378187203, -678.7955193204696, -778.5842241657651, -1444.3811685462035, -1093.8207527997884, -585.7710017315553, -830.9888240541092, -545.375139210506, -1138.3644362083664, -930.4762903478314, -1108.4138261955425, -1326.4016942916533, -544.1165956462121, -160.94142442189994, -1168.6526491192274, -378.57578054480604, -281.55155273342444, -847.6193599257754, -523.4994454864628, -1152.9239123829293, -645.7467794602384, -771.6462934161464, -30.82323261042081, -722.1577440201697, -1158.3942340237447, -454.11640349017114, -42.76557333574612, -1038.4925850323925, -517.5659555314007, -1209.8503881331403, -1318.4962027926433, -716.2295051758397, -930.4645795984826, -1019.8748539839114, -812.7892017955992, -811.4968803938337, -1024.5318796838308, -563.2625638802587, -1086.3087410103894, -1182.568997012253, -1098.3110619624795, -696.6462213097141, -764.6052092987836, -1247.5594512360171, -408.48943406080895, -262.29293543605945, -553.7333707095537, -1237.700785698889, -566.0230040507769, -1091.5456764014941, -1034.1949721110298, -1236.0787601463423, -580.5464458332569, -871.400921496045, -1061.9838834130028, -1306.298218854622, -387.2080593153036, -173.73502769247204, -1158.983768272309, -578.2415103795589, -1185.489505253062, -464.79788045138866, -912.631294159572, -911.3790333654101, -1015.2278532043168, -977.7967162379584, -395.8886948177998, -959.6030958605475, -954.071281127001, -935.7596788817449, -150.54617769862693, -938.2305964205528, -1108.598471210869, -60.95399020843773, -461.55775919004907, -1045.407995378581, -894.9381675486021, -776.6557584806002, -48.42751941618969, -923.0203820493235, -936.4559347879116, -1199.7531938862098, -1118.449667775612, -238.82346981142908, -139.74393478566225, -709.5186254481004, -549.2494484700728, -302.1355516659831, -1450.5323285918237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533971923430573, "mean_inference_ms": 1.688648310215349, "mean_action_processing_ms": 0.2797146259176719, "mean_env_wait_ms": 3.0518584162680042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012412309646606445, "StateBufferConnector_ms": 0.007721900939941406, "ViewRequirementAgentConnector_ms": 0.1908283233642578}, "num_episodes": 28, "episode_return_max": -30.82323261042081, "episode_return_min": -1516.2394378187203, "episode_return_mean": -779.4535972963079, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.0208679275699, "num_env_steps_trained_throughput_per_sec": 293.0208679275699, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13004.514, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13004.435, "sample_time_ms": 1052.196, "learn_time_ms": 11882.977, "learn_throughput": 336.616, "synch_weights_time_ms": 68.366}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00010", "date": "2024-08-03_11-14-43", "timestamp": 1722663883, "time_this_iter_s": 13.66556191444397, "time_total_s": 252.6114044189453, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245760f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 252.6114044189453, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.536842105263156, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.8050980458657, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.455313410361608, "policy_loss": -0.012801665290317033, "vf_loss": 7.464714837570985, "vf_explained_var": 0.7889653456707796, "kl": 0.017943259920866716, "entropy": 1.982723700751861, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -30.82323261042081, "episode_reward_min": -1469.2289445758415, "episode_reward_mean": -794.6687231697318, "episode_len_mean": 141.09, "episode_media": {}, "episodes_timesteps_total": 14109, "policy_reward_min": {"policy_0": -1469.2289445758415}, "policy_reward_max": {"policy_0": -30.82323261042081}, "policy_reward_mean": {"policy_0": -794.6687231697318}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-281.55155273342444, -847.6193599257754, -523.4994454864628, -1152.9239123829293, -645.7467794602384, -771.6462934161464, -30.82323261042081, -722.1577440201697, -1158.3942340237447, -454.11640349017114, -42.76557333574612, -1038.4925850323925, -517.5659555314007, -1209.8503881331403, -1318.4962027926433, -716.2295051758397, -930.4645795984826, -1019.8748539839114, -812.7892017955992, -811.4968803938337, -1024.5318796838308, -563.2625638802587, -1086.3087410103894, -1182.568997012253, -1098.3110619624795, -696.6462213097141, -764.6052092987836, -1247.5594512360171, -408.48943406080895, -262.29293543605945, -553.7333707095537, -1237.700785698889, -566.0230040507769, -1091.5456764014941, -1034.1949721110298, -1236.0787601463423, -580.5464458332569, -871.400921496045, -1061.9838834130028, -1306.298218854622, -387.2080593153036, -173.73502769247204, -1158.983768272309, -578.2415103795589, -1185.489505253062, -464.79788045138866, -912.631294159572, -911.3790333654101, -1015.2278532043168, -977.7967162379584, -395.8886948177998, -959.6030958605475, -954.071281127001, -935.7596788817449, -150.54617769862693, -938.2305964205528, -1108.598471210869, -60.95399020843773, -461.55775919004907, -1045.407995378581, -894.9381675486021, -776.6557584806002, -48.42751941618969, -923.0203820493235, -936.4559347879116, -1199.7531938862098, -1118.449667775612, -238.82346981142908, -139.74393478566225, -709.5186254481004, -549.2494484700728, -302.1355516659831, -1450.5323285918237, -391.98516983089326, -1025.8681568071988, -659.5227192453199, -891.8138887523703, -827.4506094581044, -957.0129843424736, -392.81126064954725, -470.05863336240463, -966.2599186611665, -1040.0013441406577, -1145.3292888414057, -1027.400633037328, -103.44833878408477, -720.5742584774359, -596.9759521870359, -1469.2289445758415, -1136.382545474458, -1407.2966546893983, -508.8700638172581, -1122.7304201765176, -820.1065349684736, -436.5190028987772, -698.9401634405696, -1156.3321967476868, -1139.3184847881432, -819.2807149752106, -590.9538450722616], "episode_lengths": [150, 150, 150, 150, 150, 150, 42, 150, 150, 141, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 47, 150, 150, 150, 150, 56, 150, 150, 150, 150, 75, 64, 150, 123, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-281.55155273342444, -847.6193599257754, -523.4994454864628, -1152.9239123829293, -645.7467794602384, -771.6462934161464, -30.82323261042081, -722.1577440201697, -1158.3942340237447, -454.11640349017114, -42.76557333574612, -1038.4925850323925, -517.5659555314007, -1209.8503881331403, -1318.4962027926433, -716.2295051758397, -930.4645795984826, -1019.8748539839114, -812.7892017955992, -811.4968803938337, -1024.5318796838308, -563.2625638802587, -1086.3087410103894, -1182.568997012253, -1098.3110619624795, -696.6462213097141, -764.6052092987836, -1247.5594512360171, -408.48943406080895, -262.29293543605945, -553.7333707095537, -1237.700785698889, -566.0230040507769, -1091.5456764014941, -1034.1949721110298, -1236.0787601463423, -580.5464458332569, -871.400921496045, -1061.9838834130028, -1306.298218854622, -387.2080593153036, -173.73502769247204, -1158.983768272309, -578.2415103795589, -1185.489505253062, -464.79788045138866, -912.631294159572, -911.3790333654101, -1015.2278532043168, -977.7967162379584, -395.8886948177998, -959.6030958605475, -954.071281127001, -935.7596788817449, -150.54617769862693, -938.2305964205528, -1108.598471210869, -60.95399020843773, -461.55775919004907, -1045.407995378581, -894.9381675486021, -776.6557584806002, -48.42751941618969, -923.0203820493235, -936.4559347879116, -1199.7531938862098, -1118.449667775612, -238.82346981142908, -139.74393478566225, -709.5186254481004, -549.2494484700728, -302.1355516659831, -1450.5323285918237, -391.98516983089326, -1025.8681568071988, -659.5227192453199, -891.8138887523703, -827.4506094581044, -957.0129843424736, -392.81126064954725, -470.05863336240463, -966.2599186611665, -1040.0013441406577, -1145.3292888414057, -1027.400633037328, -103.44833878408477, -720.5742584774359, -596.9759521870359, -1469.2289445758415, -1136.382545474458, -1407.2966546893983, -508.8700638172581, -1122.7304201765176, -820.1065349684736, -436.5190028987772, -698.9401634405696, -1156.3321967476868, -1139.3184847881432, -819.2807149752106, -590.9538450722616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5529845196280925, "mean_inference_ms": 1.6882987356814616, "mean_action_processing_ms": 0.27958801513725656, "mean_env_wait_ms": 3.055340743959623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012420892715454102, "StateBufferConnector_ms": 0.007830619812011719, "ViewRequirementAgentConnector_ms": 0.19331765174865723}, "num_episodes": 27, "episode_return_max": -30.82323261042081, "episode_return_min": -1469.2289445758415, "episode_return_mean": -794.6687231697318, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.1752111144594, "num_env_steps_trained_throughput_per_sec": 299.1752111144594, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13046.896, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13046.82, "sample_time_ms": 1055.821, "learn_time_ms": 11921.286, "learn_throughput": 335.534, "synch_weights_time_ms": 68.808}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00010", "date": "2024-08-03_11-14-56", "timestamp": 1722663896, "time_this_iter_s": 13.381957054138184, "time_total_s": 265.9933614730835, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f53f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 265.9933614730835, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.605263157894736, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.10410684744517, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.159381830692292, "policy_loss": -0.011450739246599066, "vf_loss": 7.16705259035031, "vf_explained_var": 0.8318439384301504, "kl": 0.019208487342621115, "entropy": 1.982549509530266, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -45.63553432606309, "episode_reward_min": -1469.2289445758415, "episode_reward_mean": -803.3276568693825, "episode_len_mean": 139.96, "episode_media": {}, "episodes_timesteps_total": 13996, "policy_reward_min": {"policy_0": -1469.2289445758415}, "policy_reward_max": {"policy_0": -45.63553432606309}, "policy_reward_mean": {"policy_0": -803.3276568693825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-553.7333707095537, -1237.700785698889, -566.0230040507769, -1091.5456764014941, -1034.1949721110298, -1236.0787601463423, -580.5464458332569, -871.400921496045, -1061.9838834130028, -1306.298218854622, -387.2080593153036, -173.73502769247204, -1158.983768272309, -578.2415103795589, -1185.489505253062, -464.79788045138866, -912.631294159572, -911.3790333654101, -1015.2278532043168, -977.7967162379584, -395.8886948177998, -959.6030958605475, -954.071281127001, -935.7596788817449, -150.54617769862693, -938.2305964205528, -1108.598471210869, -60.95399020843773, -461.55775919004907, -1045.407995378581, -894.9381675486021, -776.6557584806002, -48.42751941618969, -923.0203820493235, -936.4559347879116, -1199.7531938862098, -1118.449667775612, -238.82346981142908, -139.74393478566225, -709.5186254481004, -549.2494484700728, -302.1355516659831, -1450.5323285918237, -391.98516983089326, -1025.8681568071988, -659.5227192453199, -891.8138887523703, -827.4506094581044, -957.0129843424736, -392.81126064954725, -470.05863336240463, -966.2599186611665, -1040.0013441406577, -1145.3292888414057, -1027.400633037328, -103.44833878408477, -720.5742584774359, -596.9759521870359, -1469.2289445758415, -1136.382545474458, -1407.2966546893983, -508.8700638172581, -1122.7304201765176, -820.1065349684736, -436.5190028987772, -698.9401634405696, -1156.3321967476868, -1139.3184847881432, -819.2807149752106, -590.9538450722616, -472.41349852356154, -1143.3581634705324, -1024.9017895613802, -277.8676470128855, -1151.4276636129644, -1209.8575941104923, -1209.0608401326797, -945.4750556411454, -949.4933805399884, -407.2362047590947, -696.5801799745298, -959.7290024050913, -518.7239096562527, -940.8890431686999, -956.8652977718731, -936.5219525491308, -606.3619695447759, -1066.2535532568593, -583.4464847866805, -1277.7399496201506, -104.28112239431564, -1154.8159936606703, -177.54369425186843, -726.077848452585, -1059.0476756833377, -45.63553432606309, -1237.5505643150418, -600.6290275709515, -844.5902301688369, -922.5996772557053], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 47, 150, 150, 150, 150, 56, 150, 150, 150, 150, 75, 64, 150, 123, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 117, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 75, 150, 91, 150, 150, 53, 150, 150, 150, 150], "policy_policy_0_reward": [-553.7333707095537, -1237.700785698889, -566.0230040507769, -1091.5456764014941, -1034.1949721110298, -1236.0787601463423, -580.5464458332569, -871.400921496045, -1061.9838834130028, -1306.298218854622, -387.2080593153036, -173.73502769247204, -1158.983768272309, -578.2415103795589, -1185.489505253062, -464.79788045138866, -912.631294159572, -911.3790333654101, -1015.2278532043168, -977.7967162379584, -395.8886948177998, -959.6030958605475, -954.071281127001, -935.7596788817449, -150.54617769862693, -938.2305964205528, -1108.598471210869, -60.95399020843773, -461.55775919004907, -1045.407995378581, -894.9381675486021, -776.6557584806002, -48.42751941618969, -923.0203820493235, -936.4559347879116, -1199.7531938862098, -1118.449667775612, -238.82346981142908, -139.74393478566225, -709.5186254481004, -549.2494484700728, -302.1355516659831, -1450.5323285918237, -391.98516983089326, -1025.8681568071988, -659.5227192453199, -891.8138887523703, -827.4506094581044, -957.0129843424736, -392.81126064954725, -470.05863336240463, -966.2599186611665, -1040.0013441406577, -1145.3292888414057, -1027.400633037328, -103.44833878408477, -720.5742584774359, -596.9759521870359, -1469.2289445758415, -1136.382545474458, -1407.2966546893983, -508.8700638172581, -1122.7304201765176, -820.1065349684736, -436.5190028987772, -698.9401634405696, -1156.3321967476868, -1139.3184847881432, -819.2807149752106, -590.9538450722616, -472.41349852356154, -1143.3581634705324, -1024.9017895613802, -277.8676470128855, -1151.4276636129644, -1209.8575941104923, -1209.0608401326797, -945.4750556411454, -949.4933805399884, -407.2362047590947, -696.5801799745298, -959.7290024050913, -518.7239096562527, -940.8890431686999, -956.8652977718731, -936.5219525491308, -606.3619695447759, -1066.2535532568593, -583.4464847866805, -1277.7399496201506, -104.28112239431564, -1154.8159936606703, -177.54369425186843, -726.077848452585, -1059.0476756833377, -45.63553432606309, -1237.5505643150418, -600.6290275709515, -844.5902301688369, -922.5996772557053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523749833472175, "mean_inference_ms": 1.6875466630382272, "mean_action_processing_ms": 0.2793038821009697, "mean_env_wait_ms": 3.062626936806795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012288570404052734, "StateBufferConnector_ms": 0.00798487663269043, "ViewRequirementAgentConnector_ms": 0.19711685180664062}, "num_episodes": 30, "episode_return_max": -45.63553432606309, "episode_return_min": -1469.2289445758415, "episode_return_mean": -803.3276568693825, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.8543088692078, "num_env_steps_trained_throughput_per_sec": 303.8543088692078, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13271.564, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13271.486, "sample_time_ms": 1055.742, "learn_time_ms": 12146.857, "learn_throughput": 329.303, "synch_weights_time_ms": 68.017}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00010", "date": "2024-08-03_11-15-09", "timestamp": 1722663909, "time_this_iter_s": 13.176769018173218, "time_total_s": 279.1701304912567, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245762b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 279.1701304912567, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.652631578947368, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58.7722005084157, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.07480349689722, "policy_loss": -0.01136839176955012, "vf_loss": 7.081534095605215, "vf_explained_var": 0.7926698015381892, "kl": 0.021628884005743507, "entropy": 1.8508692445854347, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -45.63553432606309, "episode_reward_min": -1469.2289445758415, "episode_reward_mean": -801.9437382351564, "episode_len_mean": 138.9, "episode_media": {}, "episodes_timesteps_total": 13890, "policy_reward_min": {"policy_0": -1469.2289445758415}, "policy_reward_max": {"policy_0": -45.63553432606309}, "policy_reward_mean": {"policy_0": -801.9437382351564}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-776.6557584806002, -48.42751941618969, -923.0203820493235, -936.4559347879116, -1199.7531938862098, -1118.449667775612, -238.82346981142908, -139.74393478566225, -709.5186254481004, -549.2494484700728, -302.1355516659831, -1450.5323285918237, -391.98516983089326, -1025.8681568071988, -659.5227192453199, -891.8138887523703, -827.4506094581044, -957.0129843424736, -392.81126064954725, -470.05863336240463, -966.2599186611665, -1040.0013441406577, -1145.3292888414057, -1027.400633037328, -103.44833878408477, -720.5742584774359, -596.9759521870359, -1469.2289445758415, -1136.382545474458, -1407.2966546893983, -508.8700638172581, -1122.7304201765176, -820.1065349684736, -436.5190028987772, -698.9401634405696, -1156.3321967476868, -1139.3184847881432, -819.2807149752106, -590.9538450722616, -472.41349852356154, -1143.3581634705324, -1024.9017895613802, -277.8676470128855, -1151.4276636129644, -1209.8575941104923, -1209.0608401326797, -945.4750556411454, -949.4933805399884, -407.2362047590947, -696.5801799745298, -959.7290024050913, -518.7239096562527, -940.8890431686999, -956.8652977718731, -936.5219525491308, -606.3619695447759, -1066.2535532568593, -583.4464847866805, -1277.7399496201506, -104.28112239431564, -1154.8159936606703, -177.54369425186843, -726.077848452585, -1059.0476756833377, -45.63553432606309, -1237.5505643150418, -600.6290275709515, -844.5902301688369, -922.5996772557053, -845.2015557184438, -285.93605598066927, -1031.9732692041266, -1294.252324777409, -715.8630851969739, -598.9046066910653, -1121.548274738017, -572.6680216811978, -1177.101476248677, -897.8944926842594, -1049.4493334189087, -904.9619880916986, -1005.2930495187798, -402.9266621216289, -807.423175111684, -324.39208056661005, -1306.3301040501121, -1302.019048263876, -101.72898511761055, -264.9021128131607, -1220.414275543061, -933.4437456690728, -763.1334215279036, -1154.337859251962, -625.8779184418024, -387.78501048585775, -839.8259159088999, -759.0937352468919, -1150.1301974535752, -1038.1157847459522, -189.2331656966762], "episode_lengths": [150, 56, 150, 150, 150, 150, 75, 64, 150, 123, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 117, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 75, 150, 91, 150, 150, 53, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 57, 91, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 86], "policy_policy_0_reward": [-776.6557584806002, -48.42751941618969, -923.0203820493235, -936.4559347879116, -1199.7531938862098, -1118.449667775612, -238.82346981142908, -139.74393478566225, -709.5186254481004, -549.2494484700728, -302.1355516659831, -1450.5323285918237, -391.98516983089326, -1025.8681568071988, -659.5227192453199, -891.8138887523703, -827.4506094581044, -957.0129843424736, -392.81126064954725, -470.05863336240463, -966.2599186611665, -1040.0013441406577, -1145.3292888414057, -1027.400633037328, -103.44833878408477, -720.5742584774359, -596.9759521870359, -1469.2289445758415, -1136.382545474458, -1407.2966546893983, -508.8700638172581, -1122.7304201765176, -820.1065349684736, -436.5190028987772, -698.9401634405696, -1156.3321967476868, -1139.3184847881432, -819.2807149752106, -590.9538450722616, -472.41349852356154, -1143.3581634705324, -1024.9017895613802, -277.8676470128855, -1151.4276636129644, -1209.8575941104923, -1209.0608401326797, -945.4750556411454, -949.4933805399884, -407.2362047590947, -696.5801799745298, -959.7290024050913, -518.7239096562527, -940.8890431686999, -956.8652977718731, -936.5219525491308, -606.3619695447759, -1066.2535532568593, -583.4464847866805, -1277.7399496201506, -104.28112239431564, -1154.8159936606703, -177.54369425186843, -726.077848452585, -1059.0476756833377, -45.63553432606309, -1237.5505643150418, -600.6290275709515, -844.5902301688369, -922.5996772557053, -845.2015557184438, -285.93605598066927, -1031.9732692041266, -1294.252324777409, -715.8630851969739, -598.9046066910653, -1121.548274738017, -572.6680216811978, -1177.101476248677, -897.8944926842594, -1049.4493334189087, -904.9619880916986, -1005.2930495187798, -402.9266621216289, -807.423175111684, -324.39208056661005, -1306.3301040501121, -1302.019048263876, -101.72898511761055, -264.9021128131607, -1220.414275543061, -933.4437456690728, -763.1334215279036, -1154.337859251962, -625.8779184418024, -387.78501048585775, -839.8259159088999, -759.0937352468919, -1150.1301974535752, -1038.1157847459522, -189.2331656966762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5524672181309225, "mean_inference_ms": 1.687494849054282, "mean_action_processing_ms": 0.2790487868109311, "mean_env_wait_ms": 3.072082740392404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012660741806030273, "StateBufferConnector_ms": 0.008146286010742188, "ViewRequirementAgentConnector_ms": 0.20192599296569824}, "num_episodes": 31, "episode_return_max": -45.63553432606309, "episode_return_min": -1469.2289445758415, "episode_return_mean": -801.9437382351564, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.40390410716446, "num_env_steps_trained_throughput_per_sec": 304.40390410716446, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13250.677, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13250.601, "sample_time_ms": 1058.779, "learn_time_ms": 12124.83, "learn_throughput": 329.902, "synch_weights_time_ms": 66.111}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00010", "date": "2024-08-03_11-15-23", "timestamp": 1722663923, "time_this_iter_s": 13.152979850769043, "time_total_s": 292.32311034202576, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457630a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 292.32311034202576, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.657894736842104, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 69.95211275319258, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.646567636231581, "policy_loss": -0.014479775632692812, "vf_loss": 6.655424676338831, "vf_explained_var": 0.8783385201046864, "kl": 0.016698144068989982, "entropy": 1.8914290433128675, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -45.63553432606309, "episode_reward_min": -1469.2289445758415, "episode_reward_mean": -824.5210482509133, "episode_len_mean": 141.04, "episode_media": {}, "episodes_timesteps_total": 14104, "policy_reward_min": {"policy_0": -1469.2289445758415}, "policy_reward_max": {"policy_0": -45.63553432606309}, "policy_reward_mean": {"policy_0": -824.5210482509133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1469.2289445758415, -1136.382545474458, -1407.2966546893983, -508.8700638172581, -1122.7304201765176, -820.1065349684736, -436.5190028987772, -698.9401634405696, -1156.3321967476868, -1139.3184847881432, -819.2807149752106, -590.9538450722616, -472.41349852356154, -1143.3581634705324, -1024.9017895613802, -277.8676470128855, -1151.4276636129644, -1209.8575941104923, -1209.0608401326797, -945.4750556411454, -949.4933805399884, -407.2362047590947, -696.5801799745298, -959.7290024050913, -518.7239096562527, -940.8890431686999, -956.8652977718731, -936.5219525491308, -606.3619695447759, -1066.2535532568593, -583.4464847866805, -1277.7399496201506, -104.28112239431564, -1154.8159936606703, -177.54369425186843, -726.077848452585, -1059.0476756833377, -45.63553432606309, -1237.5505643150418, -600.6290275709515, -844.5902301688369, -922.5996772557053, -845.2015557184438, -285.93605598066927, -1031.9732692041266, -1294.252324777409, -715.8630851969739, -598.9046066910653, -1121.548274738017, -572.6680216811978, -1177.101476248677, -897.8944926842594, -1049.4493334189087, -904.9619880916986, -1005.2930495187798, -402.9266621216289, -807.423175111684, -324.39208056661005, -1306.3301040501121, -1302.019048263876, -101.72898511761055, -264.9021128131607, -1220.414275543061, -933.4437456690728, -763.1334215279036, -1154.337859251962, -625.8779184418024, -387.78501048585775, -839.8259159088999, -759.0937352468919, -1150.1301974535752, -1038.1157847459522, -189.2331656966762, -688.7853933146705, -565.5913838661631, -819.8953813517717, -200.0661691275905, -593.8749513398914, -1098.0562108550478, -734.1504162887688, -1066.7134394008683, -1302.3047472331964, -784.4407505902732, -1024.9292584740072, -1011.2690041336162, -794.5654829149606, -1272.5670982013237, -1008.4809989341002, -548.241482442002, -137.38839614344994, -895.810956925534, -1002.7667382777125, -670.3832852822984, -837.2297049235391, -753.3623129482355, -1047.7356296956134, -1045.9368195897619, -385.7409619070642, -940.8480074807158, -635.8749916798587], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 117, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 75, 150, 91, 150, 150, 53, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 57, 91, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 86, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150], "policy_policy_0_reward": [-1469.2289445758415, -1136.382545474458, -1407.2966546893983, -508.8700638172581, -1122.7304201765176, -820.1065349684736, -436.5190028987772, -698.9401634405696, -1156.3321967476868, -1139.3184847881432, -819.2807149752106, -590.9538450722616, -472.41349852356154, -1143.3581634705324, -1024.9017895613802, -277.8676470128855, -1151.4276636129644, -1209.8575941104923, -1209.0608401326797, -945.4750556411454, -949.4933805399884, -407.2362047590947, -696.5801799745298, -959.7290024050913, -518.7239096562527, -940.8890431686999, -956.8652977718731, -936.5219525491308, -606.3619695447759, -1066.2535532568593, -583.4464847866805, -1277.7399496201506, -104.28112239431564, -1154.8159936606703, -177.54369425186843, -726.077848452585, -1059.0476756833377, -45.63553432606309, -1237.5505643150418, -600.6290275709515, -844.5902301688369, -922.5996772557053, -845.2015557184438, -285.93605598066927, -1031.9732692041266, -1294.252324777409, -715.8630851969739, -598.9046066910653, -1121.548274738017, -572.6680216811978, -1177.101476248677, -897.8944926842594, -1049.4493334189087, -904.9619880916986, -1005.2930495187798, -402.9266621216289, -807.423175111684, -324.39208056661005, -1306.3301040501121, -1302.019048263876, -101.72898511761055, -264.9021128131607, -1220.414275543061, -933.4437456690728, -763.1334215279036, -1154.337859251962, -625.8779184418024, -387.78501048585775, -839.8259159088999, -759.0937352468919, -1150.1301974535752, -1038.1157847459522, -189.2331656966762, -688.7853933146705, -565.5913838661631, -819.8953813517717, -200.0661691275905, -593.8749513398914, -1098.0562108550478, -734.1504162887688, -1066.7134394008683, -1302.3047472331964, -784.4407505902732, -1024.9292584740072, -1011.2690041336162, -794.5654829149606, -1272.5670982013237, -1008.4809989341002, -548.241482442002, -137.38839614344994, -895.810956925534, -1002.7667382777125, -670.3832852822984, -837.2297049235391, -753.3623129482355, -1047.7356296956134, -1045.9368195897619, -385.7409619070642, -940.8480074807158, -635.8749916798587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520248272545868, "mean_inference_ms": 1.6861468984912475, "mean_action_processing_ms": 0.27871279246447095, "mean_env_wait_ms": 3.0762121241431952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012408256530761719, "StateBufferConnector_ms": 0.008005857467651367, "ViewRequirementAgentConnector_ms": 0.1987624168395996}, "num_episodes": 27, "episode_return_max": -45.63553432606309, "episode_return_min": -1469.2289445758415, "episode_return_mean": -824.5210482509133, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.4071527191789, "num_env_steps_trained_throughput_per_sec": 307.4071527191789, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13324.835, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13324.757, "sample_time_ms": 1062.332, "learn_time_ms": 12194.014, "learn_throughput": 328.03, "synch_weights_time_ms": 67.542}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00010", "date": "2024-08-03_11-15-36", "timestamp": 1722663936, "time_this_iter_s": 13.024871826171875, "time_total_s": 305.34798216819763, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245747130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 305.34798216819763, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 14.033333333333333, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89.51386710604032, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.375571081538995, "policy_loss": -0.009172512200893834, "vf_loss": 6.379346884290377, "vf_explained_var": 0.9102977046743035, "kl": 0.01582703092099109, "entropy": 1.7254815369844436, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -45.63553432606309, "episode_reward_min": -1306.3301040501121, "episode_reward_mean": -775.5257629470906, "episode_len_mean": 139.2, "episode_media": {}, "episodes_timesteps_total": 13920, "policy_reward_min": {"policy_0": -1306.3301040501121}, "policy_reward_max": {"policy_0": -45.63553432606309}, "policy_reward_mean": {"policy_0": -775.5257629470906}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1277.7399496201506, -104.28112239431564, -1154.8159936606703, -177.54369425186843, -726.077848452585, -1059.0476756833377, -45.63553432606309, -1237.5505643150418, -600.6290275709515, -844.5902301688369, -922.5996772557053, -845.2015557184438, -285.93605598066927, -1031.9732692041266, -1294.252324777409, -715.8630851969739, -598.9046066910653, -1121.548274738017, -572.6680216811978, -1177.101476248677, -897.8944926842594, -1049.4493334189087, -904.9619880916986, -1005.2930495187798, -402.9266621216289, -807.423175111684, -324.39208056661005, -1306.3301040501121, -1302.019048263876, -101.72898511761055, -264.9021128131607, -1220.414275543061, -933.4437456690728, -763.1334215279036, -1154.337859251962, -625.8779184418024, -387.78501048585775, -839.8259159088999, -759.0937352468919, -1150.1301974535752, -1038.1157847459522, -189.2331656966762, -688.7853933146705, -565.5913838661631, -819.8953813517717, -200.0661691275905, -593.8749513398914, -1098.0562108550478, -734.1504162887688, -1066.7134394008683, -1302.3047472331964, -784.4407505902732, -1024.9292584740072, -1011.2690041336162, -794.5654829149606, -1272.5670982013237, -1008.4809989341002, -548.241482442002, -137.38839614344994, -895.810956925534, -1002.7667382777125, -670.3832852822984, -837.2297049235391, -753.3623129482355, -1047.7356296956134, -1045.9368195897619, -385.7409619070642, -940.8480074807158, -635.8749916798587, -352.49743116507113, -982.1587000512113, -997.4334309348664, -1055.157183780385, -662.5860303980598, -683.7116277838287, -1058.1599654304882, -684.7921615585508, -309.54082024189313, -684.4332560747606, -1211.2943668861437, -1121.6940558350423, -961.6420309553141, -802.1127537173428, -157.11106535158734, -476.0280807933487, -985.829571423853, -639.7563475633177, -744.1613439059429, -170.43180203611007, -62.273619973472954, -786.9654315466689, -957.2973048201158, -476.6852751378334, -563.2739650185677, -360.29333033421085, -1000.9724832894, -944.6444780467813, -936.7371699853157, -652.8212037665901, -980.3979839148466], "episode_lengths": [150, 75, 150, 91, 150, 150, 53, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 57, 91, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 86, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 71, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1277.7399496201506, -104.28112239431564, -1154.8159936606703, -177.54369425186843, -726.077848452585, -1059.0476756833377, -45.63553432606309, -1237.5505643150418, -600.6290275709515, -844.5902301688369, -922.5996772557053, -845.2015557184438, -285.93605598066927, -1031.9732692041266, -1294.252324777409, -715.8630851969739, -598.9046066910653, -1121.548274738017, -572.6680216811978, -1177.101476248677, -897.8944926842594, -1049.4493334189087, -904.9619880916986, -1005.2930495187798, -402.9266621216289, -807.423175111684, -324.39208056661005, -1306.3301040501121, -1302.019048263876, -101.72898511761055, -264.9021128131607, -1220.414275543061, -933.4437456690728, -763.1334215279036, -1154.337859251962, -625.8779184418024, -387.78501048585775, -839.8259159088999, -759.0937352468919, -1150.1301974535752, -1038.1157847459522, -189.2331656966762, -688.7853933146705, -565.5913838661631, -819.8953813517717, -200.0661691275905, -593.8749513398914, -1098.0562108550478, -734.1504162887688, -1066.7134394008683, -1302.3047472331964, -784.4407505902732, -1024.9292584740072, -1011.2690041336162, -794.5654829149606, -1272.5670982013237, -1008.4809989341002, -548.241482442002, -137.38839614344994, -895.810956925534, -1002.7667382777125, -670.3832852822984, -837.2297049235391, -753.3623129482355, -1047.7356296956134, -1045.9368195897619, -385.7409619070642, -940.8480074807158, -635.8749916798587, -352.49743116507113, -982.1587000512113, -997.4334309348664, -1055.157183780385, -662.5860303980598, -683.7116277838287, -1058.1599654304882, -684.7921615585508, -309.54082024189313, -684.4332560747606, -1211.2943668861437, -1121.6940558350423, -961.6420309553141, -802.1127537173428, -157.11106535158734, -476.0280807933487, -985.829571423853, -639.7563475633177, -744.1613439059429, -170.43180203611007, -62.273619973472954, -786.9654315466689, -957.2973048201158, -476.6852751378334, -563.2739650185677, -360.29333033421085, -1000.9724832894, -944.6444780467813, -936.7371699853157, -652.8212037665901, -980.3979839148466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519688336936589, "mean_inference_ms": 1.685412975754586, "mean_action_processing_ms": 0.2784961758633445, "mean_env_wait_ms": 3.078012578339539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012343645095825195, "StateBufferConnector_ms": 0.007972955703735352, "ViewRequirementAgentConnector_ms": 0.19903230667114258}, "num_episodes": 31, "episode_return_max": -45.63553432606309, "episode_return_min": -1306.3301040501121, "episode_return_mean": -775.5257629470906, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.6032449108545, "num_env_steps_trained_throughput_per_sec": 300.6032449108545, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13289.673, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13289.595, "sample_time_ms": 1058.865, "learn_time_ms": 12159.781, "learn_throughput": 328.953, "synch_weights_time_ms": 70.054}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00010", "date": "2024-08-03_11-15-49", "timestamp": 1722663949, "time_this_iter_s": 13.318755626678467, "time_total_s": 318.6667377948761, "pid": 522306, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245760b80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 318.6667377948761, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.357894736842105, "ram_util_percent": 27.8}}
