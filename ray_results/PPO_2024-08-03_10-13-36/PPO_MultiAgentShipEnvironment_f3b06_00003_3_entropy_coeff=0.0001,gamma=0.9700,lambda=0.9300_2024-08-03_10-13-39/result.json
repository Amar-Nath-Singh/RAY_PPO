{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0332587979733945, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.556273213028907, "policy_loss": -0.005552806634417114, "vf_loss": 9.560042740901311, "vf_explained_var": -0.013921991859873136, "kl": 0.009628532944172244, "entropy": 1.4241744324564933, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -39.70280484701348, "episode_reward_min": -1291.5958343582902, "episode_reward_mean": -708.3699960398061, "episode_len_mean": 141.08695652173913, "episode_media": {}, "episodes_timesteps_total": 3245, "policy_reward_min": {"policy_0": -1291.5958343582902}, "policy_reward_max": {"policy_0": -39.70280484701348}, "policy_reward_mean": {"policy_0": -708.3699960398061}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.8812369817501, -1291.5958343582902, -922.0557504075576, -445.529094997347, -651.6551445788571, -796.1691758894475, -832.7280174630471, -311.71055491202145, -844.003886222471, -853.8881000014777, -414.5845509602687, -156.90376175296495, -947.5390121391684, -713.5754063529814, -917.9319968158768, -945.0316270165972, -761.3541196125568, -39.70280484701348, -412.25325195644103, -807.6125485682085, -623.0370949310792, -846.2699462418243, -584.4969919082966], "episode_lengths": [150, 150, 150, 101, 150, 150, 150, 120, 150, 150, 150, 104, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1172.8812369817501, -1291.5958343582902, -922.0557504075576, -445.529094997347, -651.6551445788571, -796.1691758894475, -832.7280174630471, -311.71055491202145, -844.003886222471, -853.8881000014777, -414.5845509602687, -156.90376175296495, -947.5390121391684, -713.5754063529814, -917.9319968158768, -945.0316270165972, -761.3541196125568, -39.70280484701348, -412.25325195644103, -807.6125485682085, -623.0370949310792, -846.2699462418243, -584.4969919082966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5595946548547974, "mean_inference_ms": 1.6429415196467583, "mean_action_processing_ms": 0.27678379352422794, "mean_env_wait_ms": 2.924700151668028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011425432951554008, "StateBufferConnector_ms": 0.007843971252441406, "ViewRequirementAgentConnector_ms": 0.17484685649042545}, "num_episodes": 23, "episode_return_max": -39.70280484701348, "episode_return_min": -1291.5958343582902, "episode_return_mean": -708.3699960398061, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.5764218085695, "num_env_steps_trained_throughput_per_sec": 324.5764218085695, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12323.763, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12323.703, "sample_time_ms": 1010.852, "learn_time_ms": 11241.357, "learn_throughput": 355.829, "synch_weights_time_ms": 70.733}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00003", "date": "2024-08-03_10-31-12", "timestamp": 1722661272, "time_this_iter_s": 12.334675788879395, "time_total_s": 12.334675788879395, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00be0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.334675788879395, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 13.11111111111111, "ram_util_percent": 27.494444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2020880366054674, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.5206761409839, "policy_loss": -0.008737721924262587, "vf_loss": 9.527156872550647, "vf_explained_var": 0.036226252714792885, "kl": 0.011964232767907864, "entropy": 1.3587523456662893, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -39.70280484701348, "episode_reward_min": -1291.5958343582902, "episode_reward_mean": -757.7648968732886, "episode_len_mean": 143.45652173913044, "episode_media": {}, "episodes_timesteps_total": 6599, "policy_reward_min": {"policy_0": -1291.5958343582902}, "policy_reward_max": {"policy_0": -39.70280484701348}, "policy_reward_mean": {"policy_0": -757.7648968732886}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.8812369817501, -1291.5958343582902, -922.0557504075576, -445.529094997347, -651.6551445788571, -796.1691758894475, -832.7280174630471, -311.71055491202145, -844.003886222471, -853.8881000014777, -414.5845509602687, -156.90376175296495, -947.5390121391684, -713.5754063529814, -917.9319968158768, -945.0316270165972, -761.3541196125568, -39.70280484701348, -412.25325195644103, -807.6125485682085, -623.0370949310792, -846.2699462418243, -584.4969919082966, -847.177106783557, -749.1892379401027, -515.5009683261609, -779.918133000324, -371.4912707245422, -473.21855465808613, -859.2032950021339, -1086.2708400199526, -442.17137207188165, -1152.7550800751392, -984.0846465381156, -867.0667666063686, -737.1169990067807, -205.19671865473057, -940.0405348003255, -1173.5325664962393, -848.1257887463586, -939.2085431283234, -1197.381691635642, -670.2852210128666, -713.1967597524658, -893.5239190578964, -1119.019333217752], "episode_lengths": [150, 150, 150, 101, 150, 150, 150, 120, 150, 150, 150, 104, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 145, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1172.8812369817501, -1291.5958343582902, -922.0557504075576, -445.529094997347, -651.6551445788571, -796.1691758894475, -832.7280174630471, -311.71055491202145, -844.003886222471, -853.8881000014777, -414.5845509602687, -156.90376175296495, -947.5390121391684, -713.5754063529814, -917.9319968158768, -945.0316270165972, -761.3541196125568, -39.70280484701348, -412.25325195644103, -807.6125485682085, -623.0370949310792, -846.2699462418243, -584.4969919082966, -847.177106783557, -749.1892379401027, -515.5009683261609, -779.918133000324, -371.4912707245422, -473.21855465808613, -859.2032950021339, -1086.2708400199526, -442.17137207188165, -1152.7550800751392, -984.0846465381156, -867.0667666063686, -737.1169990067807, -205.19671865473057, -940.0405348003255, -1173.5325664962393, -848.1257887463586, -939.2085431283234, -1197.381691635642, -670.2852210128666, -713.1967597524658, -893.5239190578964, -1119.019333217752]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5588552235092681, "mean_inference_ms": 1.6559167901029261, "mean_action_processing_ms": 0.2782449330768049, "mean_env_wait_ms": 2.930315519354468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013829314190408459, "StateBufferConnector_ms": 0.008008791052776834, "ViewRequirementAgentConnector_ms": 0.17888338669486667}, "num_episodes": 23, "episode_return_max": -39.70280484701348, "episode_return_min": -1291.5958343582902, "episode_return_mean": -757.7648968732886, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.7222687958705, "num_env_steps_trained_throughput_per_sec": 303.7222687958705, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12746.851, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12746.783, "sample_time_ms": 1014.552, "learn_time_ms": 11665.701, "learn_throughput": 342.886, "synch_weights_time_ms": 65.747}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00003", "date": "2024-08-03_10-31-25", "timestamp": 1722661285, "time_this_iter_s": 13.182151317596436, "time_total_s": 25.51682710647583, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf57520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.51682710647583, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.468421052631578, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2586192155567308, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.667871189117431, "policy_loss": -0.006484925300658991, "vf_loss": 9.671696251630783, "vf_explained_var": 0.08760577005644639, "kl": 0.013981501776834193, "entropy": 1.3642354176690181, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -16.164160212147976, "episode_reward_min": -1291.5958343582902, "episode_reward_mean": -719.2992593771258, "episode_len_mean": 140.56944444444446, "episode_media": {}, "episodes_timesteps_total": 10121, "policy_reward_min": {"policy_0": -1291.5958343582902}, "policy_reward_max": {"policy_0": -16.164160212147976}, "policy_reward_mean": {"policy_0": -719.2992593771258}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.8812369817501, -1291.5958343582902, -922.0557504075576, -445.529094997347, -651.6551445788571, -796.1691758894475, -832.7280174630471, -311.71055491202145, -844.003886222471, -853.8881000014777, -414.5845509602687, -156.90376175296495, -947.5390121391684, -713.5754063529814, -917.9319968158768, -945.0316270165972, -761.3541196125568, -39.70280484701348, -412.25325195644103, -807.6125485682085, -623.0370949310792, -846.2699462418243, -584.4969919082966, -847.177106783557, -749.1892379401027, -515.5009683261609, -779.918133000324, -371.4912707245422, -473.21855465808613, -859.2032950021339, -1086.2708400199526, -442.17137207188165, -1152.7550800751392, -984.0846465381156, -867.0667666063686, -737.1169990067807, -205.19671865473057, -940.0405348003255, -1173.5325664962393, -848.1257887463586, -939.2085431283234, -1197.381691635642, -670.2852210128666, -713.1967597524658, -893.5239190578964, -1119.019333217752, -778.9113518375699, -1174.144033617095, -207.80746609217695, -866.720588204298, -674.4743505913929, -426.9890147411725, -659.231540940846, -817.2492998260515, -984.9062905947779, -494.0976556900023, -25.034541985320796, -1272.4596435183407, -444.95791223490625, -235.43691810961963, -635.916091432434, -16.164160212147976, -150.34076513328117, -462.37663097475655, -715.0612754650152, -441.8800374698506, -881.4285124943642, -1093.6292151060443, -1033.0348553634599, -1067.1886938353455, -321.6281165191007, -1051.2924569924016], "episode_lengths": [150, 150, 150, 101, 150, 150, 150, 120, 150, 150, 150, 104, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 145, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 118, 150, 51, 83, 150, 150, 150, 150, 150, 150, 150, 112, 150], "policy_policy_0_reward": [-1172.8812369817501, -1291.5958343582902, -922.0557504075576, -445.529094997347, -651.6551445788571, -796.1691758894475, -832.7280174630471, -311.71055491202145, -844.003886222471, -853.8881000014777, -414.5845509602687, -156.90376175296495, -947.5390121391684, -713.5754063529814, -917.9319968158768, -945.0316270165972, -761.3541196125568, -39.70280484701348, -412.25325195644103, -807.6125485682085, -623.0370949310792, -846.2699462418243, -584.4969919082966, -847.177106783557, -749.1892379401027, -515.5009683261609, -779.918133000324, -371.4912707245422, -473.21855465808613, -859.2032950021339, -1086.2708400199526, -442.17137207188165, -1152.7550800751392, -984.0846465381156, -867.0667666063686, -737.1169990067807, -205.19671865473057, -940.0405348003255, -1173.5325664962393, -848.1257887463586, -939.2085431283234, -1197.381691635642, -670.2852210128666, -713.1967597524658, -893.5239190578964, -1119.019333217752, -778.9113518375699, -1174.144033617095, -207.80746609217695, -866.720588204298, -674.4743505913929, -426.9890147411725, -659.231540940846, -817.2492998260515, -984.9062905947779, -494.0976556900023, -25.034541985320796, -1272.4596435183407, -444.95791223490625, -235.43691810961963, -635.916091432434, -16.164160212147976, -150.34076513328117, -462.37663097475655, -715.0612754650152, -441.8800374698506, -881.4285124943642, -1093.6292151060443, -1033.0348553634599, -1067.1886938353455, -321.6281165191007, -1051.2924569924016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5615854103984496, "mean_inference_ms": 1.6664446553550418, "mean_action_processing_ms": 0.27969545873063406, "mean_env_wait_ms": 2.9382049965257298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013814700974358452, "StateBufferConnector_ms": 0.008342663447062174, "ViewRequirementAgentConnector_ms": 0.1853429608874851}, "num_episodes": 26, "episode_return_max": -16.164160212147976, "episode_return_min": -1291.5958343582902, "episode_return_mean": -719.2992593771258, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.48919057246167, "num_env_steps_trained_throughput_per_sec": 302.48919057246167, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12905.777, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12905.7, "sample_time_ms": 1016.717, "learn_time_ms": 11821.529, "learn_throughput": 338.366, "synch_weights_time_ms": 66.664}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00003", "date": "2024-08-03_10-31-39", "timestamp": 1722661299, "time_this_iter_s": 13.2357816696167, "time_total_s": 38.75260877609253, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00be050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.75260877609253, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.15263157894737, "ram_util_percent": 27.57894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7080940355857213, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.695911601185799, "policy_loss": -0.013280884952594836, "vf_loss": 9.705914099017779, "vf_explained_var": 0.17463834080845117, "kl": 0.01707076450996586, "entropy": 1.3579190303881963, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -10.27075816236952, "episode_reward_min": -1301.9388627815958, "episode_reward_mean": -742.3258176868286, "episode_len_mean": 140.63636363636363, "episode_media": {}, "episodes_timesteps_total": 13923, "policy_reward_min": {"policy_0": -1301.9388627815958}, "policy_reward_max": {"policy_0": -10.27075816236952}, "policy_reward_mean": {"policy_0": -742.3258176868286}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172.8812369817501, -1291.5958343582902, -922.0557504075576, -445.529094997347, -651.6551445788571, -796.1691758894475, -832.7280174630471, -311.71055491202145, -844.003886222471, -853.8881000014777, -414.5845509602687, -156.90376175296495, -947.5390121391684, -713.5754063529814, -917.9319968158768, -945.0316270165972, -761.3541196125568, -39.70280484701348, -412.25325195644103, -807.6125485682085, -623.0370949310792, -846.2699462418243, -584.4969919082966, -847.177106783557, -749.1892379401027, -515.5009683261609, -779.918133000324, -371.4912707245422, -473.21855465808613, -859.2032950021339, -1086.2708400199526, -442.17137207188165, -1152.7550800751392, -984.0846465381156, -867.0667666063686, -737.1169990067807, -205.19671865473057, -940.0405348003255, -1173.5325664962393, -848.1257887463586, -939.2085431283234, -1197.381691635642, -670.2852210128666, -713.1967597524658, -893.5239190578964, -1119.019333217752, -778.9113518375699, -1174.144033617095, -207.80746609217695, -866.720588204298, -674.4743505913929, -426.9890147411725, -659.231540940846, -817.2492998260515, -984.9062905947779, -494.0976556900023, -25.034541985320796, -1272.4596435183407, -444.95791223490625, -235.43691810961963, -635.916091432434, -16.164160212147976, -150.34076513328117, -462.37663097475655, -715.0612754650152, -441.8800374698506, -881.4285124943642, -1093.6292151060443, -1033.0348553634599, -1067.1886938353455, -321.6281165191007, -1051.2924569924016, -805.9175998947776, -1110.818078993255, -866.2557319980461, -733.0411577207334, -951.0268381596342, -1301.9388627815958, -1063.8582589161213, -1036.3998758808957, -966.3807264041941, -805.995810949482, -960.0699455994352, -627.2193077419836, -702.3954599125926, -797.8419568505884, -267.53376478392124, -1142.547680443091, -1030.4400230924116, -757.5172492751731, -946.6267660639083, -474.99778887921696, -855.6578996615801, -903.7197557240885, -384.93983180562844, -628.3113925890588, -717.4837827134795, -10.27075816236952, -851.5029708457154], "episode_lengths": [150, 150, 150, 101, 150, 150, 150, 120, 150, 150, 150, 104, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 145, 150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 118, 150, 51, 83, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 85, 150, 150, 150, 150, 109, 150, 150, 125, 150, 150, 42, 150], "policy_policy_0_reward": [-1172.8812369817501, -1291.5958343582902, -922.0557504075576, -445.529094997347, -651.6551445788571, -796.1691758894475, -832.7280174630471, -311.71055491202145, -844.003886222471, -853.8881000014777, -414.5845509602687, -156.90376175296495, -947.5390121391684, -713.5754063529814, -917.9319968158768, -945.0316270165972, -761.3541196125568, -39.70280484701348, -412.25325195644103, -807.6125485682085, -623.0370949310792, -846.2699462418243, -584.4969919082966, -847.177106783557, -749.1892379401027, -515.5009683261609, -779.918133000324, -371.4912707245422, -473.21855465808613, -859.2032950021339, -1086.2708400199526, -442.17137207188165, -1152.7550800751392, -984.0846465381156, -867.0667666063686, -737.1169990067807, -205.19671865473057, -940.0405348003255, -1173.5325664962393, -848.1257887463586, -939.2085431283234, -1197.381691635642, -670.2852210128666, -713.1967597524658, -893.5239190578964, -1119.019333217752, -778.9113518375699, -1174.144033617095, -207.80746609217695, -866.720588204298, -674.4743505913929, -426.9890147411725, -659.231540940846, -817.2492998260515, -984.9062905947779, -494.0976556900023, -25.034541985320796, -1272.4596435183407, -444.95791223490625, -235.43691810961963, -635.916091432434, -16.164160212147976, -150.34076513328117, -462.37663097475655, -715.0612754650152, -441.8800374698506, -881.4285124943642, -1093.6292151060443, -1033.0348553634599, -1067.1886938353455, -321.6281165191007, -1051.2924569924016, -805.9175998947776, -1110.818078993255, -866.2557319980461, -733.0411577207334, -951.0268381596342, -1301.9388627815958, -1063.8582589161213, -1036.3998758808957, -966.3807264041941, -805.995810949482, -960.0699455994352, -627.2193077419836, -702.3954599125926, -797.8419568505884, -267.53376478392124, -1142.547680443091, -1030.4400230924116, -757.5172492751731, -946.6267660639083, -474.99778887921696, -855.6578996615801, -903.7197557240885, -384.93983180562844, -628.3113925890588, -717.4837827134795, -10.27075816236952, -851.5029708457154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5614185817302974, "mean_inference_ms": 1.6697278619479206, "mean_action_processing_ms": 0.28022871917176573, "mean_env_wait_ms": 2.941513840420853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014050560768204505, "StateBufferConnector_ms": 0.008520453867286143, "ViewRequirementAgentConnector_ms": 0.18563029742000078}, "num_episodes": 27, "episode_return_max": -10.27075816236952, "episode_return_min": -1301.9388627815958, "episode_return_mean": -742.3258176868286, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.6133219578557, "num_env_steps_trained_throughput_per_sec": 301.6133219578557, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12994.839, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12994.763, "sample_time_ms": 1013.703, "learn_time_ms": 11914.222, "learn_throughput": 335.733, "synch_weights_time_ms": 66.011}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00003", "date": "2024-08-03_10-31-52", "timestamp": 1722661312, "time_this_iter_s": 13.275417566299438, "time_total_s": 52.02802634239197, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0e050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.02802634239197, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.74736842105263, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.987416868967315, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.987838150560856, "policy_loss": -0.01014544659119565, "vf_loss": 8.99434793740511, "vf_explained_var": 0.37516800680508217, "kl": 0.01880873256997499, "entropy": 1.2607273961106935, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -10.27075816236952, "episode_reward_min": -1301.9388627815958, "episode_reward_mean": -747.6007614370101, "episode_len_mean": 141.66, "episode_media": {}, "episodes_timesteps_total": 14166, "policy_reward_min": {"policy_0": -1301.9388627815958}, "policy_reward_max": {"policy_0": -10.27075816236952}, "policy_reward_mean": {"policy_0": -747.6007614370101}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-859.2032950021339, -1086.2708400199526, -442.17137207188165, -1152.7550800751392, -984.0846465381156, -867.0667666063686, -737.1169990067807, -205.19671865473057, -940.0405348003255, -1173.5325664962393, -848.1257887463586, -939.2085431283234, -1197.381691635642, -670.2852210128666, -713.1967597524658, -893.5239190578964, -1119.019333217752, -778.9113518375699, -1174.144033617095, -207.80746609217695, -866.720588204298, -674.4743505913929, -426.9890147411725, -659.231540940846, -817.2492998260515, -984.9062905947779, -494.0976556900023, -25.034541985320796, -1272.4596435183407, -444.95791223490625, -235.43691810961963, -635.916091432434, -16.164160212147976, -150.34076513328117, -462.37663097475655, -715.0612754650152, -441.8800374698506, -881.4285124943642, -1093.6292151060443, -1033.0348553634599, -1067.1886938353455, -321.6281165191007, -1051.2924569924016, -805.9175998947776, -1110.818078993255, -866.2557319980461, -733.0411577207334, -951.0268381596342, -1301.9388627815958, -1063.8582589161213, -1036.3998758808957, -966.3807264041941, -805.995810949482, -960.0699455994352, -627.2193077419836, -702.3954599125926, -797.8419568505884, -267.53376478392124, -1142.547680443091, -1030.4400230924116, -757.5172492751731, -946.6267660639083, -474.99778887921696, -855.6578996615801, -903.7197557240885, -384.93983180562844, -628.3113925890588, -717.4837827134795, -10.27075816236952, -851.5029708457154, -343.4143599750341, -1131.5828968546016, -723.7041019583992, -613.8044050957714, -876.8368174551774, -425.6563642339715, -1043.0623551377473, -295.68881269380756, -817.8295412585284, -1086.0994574056178, -349.77239941578244, -542.0668818464981, -703.3729158170535, -508.13084745834834, -606.7915660418632, -772.482507193758, -692.4102028720623, -963.9041886750058, -275.19614283845925, -836.8772006422649, -506.45334573851324, -1216.459232097348, -392.364322170636, -879.1007824263411, -799.9185407339083, -455.1236085828954, -887.6949568499701, -734.5999366652992, -596.1939418326886, -1222.2327410859302], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 118, 150, 51, 83, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 85, 150, 150, 150, 150, 109, 150, 150, 125, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 107, 150, 146, 150, 150], "policy_policy_0_reward": [-859.2032950021339, -1086.2708400199526, -442.17137207188165, -1152.7550800751392, -984.0846465381156, -867.0667666063686, -737.1169990067807, -205.19671865473057, -940.0405348003255, -1173.5325664962393, -848.1257887463586, -939.2085431283234, -1197.381691635642, -670.2852210128666, -713.1967597524658, -893.5239190578964, -1119.019333217752, -778.9113518375699, -1174.144033617095, -207.80746609217695, -866.720588204298, -674.4743505913929, -426.9890147411725, -659.231540940846, -817.2492998260515, -984.9062905947779, -494.0976556900023, -25.034541985320796, -1272.4596435183407, -444.95791223490625, -235.43691810961963, -635.916091432434, -16.164160212147976, -150.34076513328117, -462.37663097475655, -715.0612754650152, -441.8800374698506, -881.4285124943642, -1093.6292151060443, -1033.0348553634599, -1067.1886938353455, -321.6281165191007, -1051.2924569924016, -805.9175998947776, -1110.818078993255, -866.2557319980461, -733.0411577207334, -951.0268381596342, -1301.9388627815958, -1063.8582589161213, -1036.3998758808957, -966.3807264041941, -805.995810949482, -960.0699455994352, -627.2193077419836, -702.3954599125926, -797.8419568505884, -267.53376478392124, -1142.547680443091, -1030.4400230924116, -757.5172492751731, -946.6267660639083, -474.99778887921696, -855.6578996615801, -903.7197557240885, -384.93983180562844, -628.3113925890588, -717.4837827134795, -10.27075816236952, -851.5029708457154, -343.4143599750341, -1131.5828968546016, -723.7041019583992, -613.8044050957714, -876.8368174551774, -425.6563642339715, -1043.0623551377473, -295.68881269380756, -817.8295412585284, -1086.0994574056178, -349.77239941578244, -542.0668818464981, -703.3729158170535, -508.13084745834834, -606.7915660418632, -772.482507193758, -692.4102028720623, -963.9041886750058, -275.19614283845925, -836.8772006422649, -506.45334573851324, -1216.459232097348, -392.364322170636, -879.1007824263411, -799.9185407339083, -455.1236085828954, -887.6949568499701, -734.5999366652992, -596.1939418326886, -1222.2327410859302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.562149470144426, "mean_inference_ms": 1.6816617238814364, "mean_action_processing_ms": 0.28198974599661386, "mean_env_wait_ms": 2.9509550368017057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014416217803955078, "StateBufferConnector_ms": 0.00889134407043457, "ViewRequirementAgentConnector_ms": 0.19361305236816406}, "num_episodes": 30, "episode_return_max": -10.27075816236952, "episode_return_min": -1301.9388627815958, "episode_return_mean": -747.6007614370101, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.8995460485114, "num_env_steps_trained_throughput_per_sec": 305.8995460485114, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13011.112, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13011.035, "sample_time_ms": 1016.579, "learn_time_ms": 11927.958, "learn_throughput": 335.347, "synch_weights_time_ms": 65.651}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00003", "date": "2024-08-03_10-32-05", "timestamp": 1722661325, "time_this_iter_s": 13.087696552276611, "time_total_s": 65.11572289466858, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0d750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 65.11572289466858, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.338888888888892, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.48941439576447, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.656919616957506, "policy_loss": -0.007187470690890526, "vf_loss": 8.661387724181017, "vf_explained_var": 0.4653141969814897, "kl": 0.014215868544465594, "entropy": 1.2381857812404633, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -10.27075816236952, "episode_reward_min": -1301.9388627815958, "episode_reward_mean": -693.1343202560333, "episode_len_mean": 140.68, "episode_media": {}, "episodes_timesteps_total": 14068, "policy_reward_min": {"policy_0": -1301.9388627815958}, "policy_reward_max": {"policy_0": -10.27075816236952}, "policy_reward_mean": {"policy_0": -693.1343202560333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-494.0976556900023, -25.034541985320796, -1272.4596435183407, -444.95791223490625, -235.43691810961963, -635.916091432434, -16.164160212147976, -150.34076513328117, -462.37663097475655, -715.0612754650152, -441.8800374698506, -881.4285124943642, -1093.6292151060443, -1033.0348553634599, -1067.1886938353455, -321.6281165191007, -1051.2924569924016, -805.9175998947776, -1110.818078993255, -866.2557319980461, -733.0411577207334, -951.0268381596342, -1301.9388627815958, -1063.8582589161213, -1036.3998758808957, -966.3807264041941, -805.995810949482, -960.0699455994352, -627.2193077419836, -702.3954599125926, -797.8419568505884, -267.53376478392124, -1142.547680443091, -1030.4400230924116, -757.5172492751731, -946.6267660639083, -474.99778887921696, -855.6578996615801, -903.7197557240885, -384.93983180562844, -628.3113925890588, -717.4837827134795, -10.27075816236952, -851.5029708457154, -343.4143599750341, -1131.5828968546016, -723.7041019583992, -613.8044050957714, -876.8368174551774, -425.6563642339715, -1043.0623551377473, -295.68881269380756, -817.8295412585284, -1086.0994574056178, -349.77239941578244, -542.0668818464981, -703.3729158170535, -508.13084745834834, -606.7915660418632, -772.482507193758, -692.4102028720623, -963.9041886750058, -275.19614283845925, -836.8772006422649, -506.45334573851324, -1216.459232097348, -392.364322170636, -879.1007824263411, -799.9185407339083, -455.1236085828954, -887.6949568499701, -734.5999366652992, -596.1939418326886, -1222.2327410859302, -321.2990770640449, -1024.4074791228504, -911.2744561282427, -130.0590653041056, -394.8977865575392, -225.39779280200204, -335.9577863884408, -1299.747216016208, -1111.5034861222825, -362.73877812744536, -619.4794602213694, -622.7359022563827, -551.3821817278965, -583.4651932440113, -373.26856020393546, -812.1538044599647, -416.1243389932463, -177.00533265728444, -421.76494574020614, -602.4455260572552, -762.1834805139891, -1074.6563282470745, -664.7898632349585, -852.8492806821756, -537.8600120896783, -782.5227602081048], "episode_lengths": [150, 52, 150, 150, 118, 150, 51, 83, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 85, 150, 150, 150, 150, 109, 150, 150, 125, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 107, 150, 146, 150, 150, 150, 150, 150, 95, 150, 86, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 135, 108, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-494.0976556900023, -25.034541985320796, -1272.4596435183407, -444.95791223490625, -235.43691810961963, -635.916091432434, -16.164160212147976, -150.34076513328117, -462.37663097475655, -715.0612754650152, -441.8800374698506, -881.4285124943642, -1093.6292151060443, -1033.0348553634599, -1067.1886938353455, -321.6281165191007, -1051.2924569924016, -805.9175998947776, -1110.818078993255, -866.2557319980461, -733.0411577207334, -951.0268381596342, -1301.9388627815958, -1063.8582589161213, -1036.3998758808957, -966.3807264041941, -805.995810949482, -960.0699455994352, -627.2193077419836, -702.3954599125926, -797.8419568505884, -267.53376478392124, -1142.547680443091, -1030.4400230924116, -757.5172492751731, -946.6267660639083, -474.99778887921696, -855.6578996615801, -903.7197557240885, -384.93983180562844, -628.3113925890588, -717.4837827134795, -10.27075816236952, -851.5029708457154, -343.4143599750341, -1131.5828968546016, -723.7041019583992, -613.8044050957714, -876.8368174551774, -425.6563642339715, -1043.0623551377473, -295.68881269380756, -817.8295412585284, -1086.0994574056178, -349.77239941578244, -542.0668818464981, -703.3729158170535, -508.13084745834834, -606.7915660418632, -772.482507193758, -692.4102028720623, -963.9041886750058, -275.19614283845925, -836.8772006422649, -506.45334573851324, -1216.459232097348, -392.364322170636, -879.1007824263411, -799.9185407339083, -455.1236085828954, -887.6949568499701, -734.5999366652992, -596.1939418326886, -1222.2327410859302, -321.2990770640449, -1024.4074791228504, -911.2744561282427, -130.0590653041056, -394.8977865575392, -225.39779280200204, -335.9577863884408, -1299.747216016208, -1111.5034861222825, -362.73877812744536, -619.4794602213694, -622.7359022563827, -551.3821817278965, -583.4651932440113, -373.26856020393546, -812.1538044599647, -416.1243389932463, -177.00533265728444, -421.76494574020614, -602.4455260572552, -762.1834805139891, -1074.6563282470745, -664.7898632349585, -852.8492806821756, -537.8600120896783, -782.5227602081048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5623538597658062, "mean_inference_ms": 1.6849578671843861, "mean_action_processing_ms": 0.28263120058084285, "mean_env_wait_ms": 2.9581821558287884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014317035675048828, "StateBufferConnector_ms": 0.009000062942504883, "ViewRequirementAgentConnector_ms": 0.19609642028808594}, "num_episodes": 26, "episode_return_max": -10.27075816236952, "episode_return_min": -1301.9388627815958, "episode_return_mean": -693.1343202560333, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.8880277390248, "num_env_steps_trained_throughput_per_sec": 290.8880277390248, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13134.429, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13134.349, "sample_time_ms": 1018.983, "learn_time_ms": 12047.924, "learn_throughput": 332.007, "synch_weights_time_ms": 66.594}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00003", "date": "2024-08-03_10-32-19", "timestamp": 1722661339, "time_this_iter_s": 13.766022205352783, "time_total_s": 78.88174510002136, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010b370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 78.88174510002136, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.059999999999999, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.305231574053566, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.925251764555773, "policy_loss": -0.01291490566121259, "vf_loss": 8.934746138751507, "vf_explained_var": 0.5138049790014824, "kl": 0.01769398027809075, "entropy": 1.1826322848598163, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -10.27075816236952, "episode_reward_min": -1299.747216016208, "episode_reward_mean": -680.9021110600079, "episode_len_mean": 143.15, "episode_media": {}, "episodes_timesteps_total": 14315, "policy_reward_min": {"policy_0": -1299.747216016208}, "policy_reward_max": {"policy_0": -10.27075816236952}, "policy_reward_mean": {"policy_0": -680.9021110600079}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1030.4400230924116, -757.5172492751731, -946.6267660639083, -474.99778887921696, -855.6578996615801, -903.7197557240885, -384.93983180562844, -628.3113925890588, -717.4837827134795, -10.27075816236952, -851.5029708457154, -343.4143599750341, -1131.5828968546016, -723.7041019583992, -613.8044050957714, -876.8368174551774, -425.6563642339715, -1043.0623551377473, -295.68881269380756, -817.8295412585284, -1086.0994574056178, -349.77239941578244, -542.0668818464981, -703.3729158170535, -508.13084745834834, -606.7915660418632, -772.482507193758, -692.4102028720623, -963.9041886750058, -275.19614283845925, -836.8772006422649, -506.45334573851324, -1216.459232097348, -392.364322170636, -879.1007824263411, -799.9185407339083, -455.1236085828954, -887.6949568499701, -734.5999366652992, -596.1939418326886, -1222.2327410859302, -321.2990770640449, -1024.4074791228504, -911.2744561282427, -130.0590653041056, -394.8977865575392, -225.39779280200204, -335.9577863884408, -1299.747216016208, -1111.5034861222825, -362.73877812744536, -619.4794602213694, -622.7359022563827, -551.3821817278965, -583.4651932440113, -373.26856020393546, -812.1538044599647, -416.1243389932463, -177.00533265728444, -421.76494574020614, -602.4455260572552, -762.1834805139891, -1074.6563282470745, -664.7898632349585, -852.8492806821756, -537.8600120896783, -782.5227602081048, -944.3277224723238, -679.2218714360196, -634.384674149396, -706.1826926313886, -742.5017347050466, -988.9140880203519, -792.1574297369804, -480.49954715607413, -264.0792225964999, -894.7442431560091, -572.257227439443, -912.1127345163026, -874.9982283702851, -619.1531415368484, -711.0184365225508, -535.6798346494998, -908.4122948928137, -573.9439703447115, -979.1319672416114, -392.7213755093425, -835.3178704909024, -819.3538863011057, -751.405555226952, -814.1485391837712, -531.0595709687085, -631.2523307029668, -728.7433810283298, -933.9597431748367, -649.3719477029682, -550.8264824076646, -828.5432141696002, -947.5495393907431, -29.973122132129763], "episode_lengths": [150, 150, 150, 109, 150, 150, 125, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 107, 150, 146, 150, 150, 150, 150, 150, 95, 150, 86, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 135, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 47], "policy_policy_0_reward": [-1030.4400230924116, -757.5172492751731, -946.6267660639083, -474.99778887921696, -855.6578996615801, -903.7197557240885, -384.93983180562844, -628.3113925890588, -717.4837827134795, -10.27075816236952, -851.5029708457154, -343.4143599750341, -1131.5828968546016, -723.7041019583992, -613.8044050957714, -876.8368174551774, -425.6563642339715, -1043.0623551377473, -295.68881269380756, -817.8295412585284, -1086.0994574056178, -349.77239941578244, -542.0668818464981, -703.3729158170535, -508.13084745834834, -606.7915660418632, -772.482507193758, -692.4102028720623, -963.9041886750058, -275.19614283845925, -836.8772006422649, -506.45334573851324, -1216.459232097348, -392.364322170636, -879.1007824263411, -799.9185407339083, -455.1236085828954, -887.6949568499701, -734.5999366652992, -596.1939418326886, -1222.2327410859302, -321.2990770640449, -1024.4074791228504, -911.2744561282427, -130.0590653041056, -394.8977865575392, -225.39779280200204, -335.9577863884408, -1299.747216016208, -1111.5034861222825, -362.73877812744536, -619.4794602213694, -622.7359022563827, -551.3821817278965, -583.4651932440113, -373.26856020393546, -812.1538044599647, -416.1243389932463, -177.00533265728444, -421.76494574020614, -602.4455260572552, -762.1834805139891, -1074.6563282470745, -664.7898632349585, -852.8492806821756, -537.8600120896783, -782.5227602081048, -944.3277224723238, -679.2218714360196, -634.384674149396, -706.1826926313886, -742.5017347050466, -988.9140880203519, -792.1574297369804, -480.49954715607413, -264.0792225964999, -894.7442431560091, -572.257227439443, -912.1127345163026, -874.9982283702851, -619.1531415368484, -711.0184365225508, -535.6798346494998, -908.4122948928137, -573.9439703447115, -979.1319672416114, -392.7213755093425, -835.3178704909024, -819.3538863011057, -751.405555226952, -814.1485391837712, -531.0595709687085, -631.2523307029668, -728.7433810283298, -933.9597431748367, -649.3719477029682, -550.8264824076646, -828.5432141696002, -947.5495393907431, -29.973122132129763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5612884288216425, "mean_inference_ms": 1.6855979220969033, "mean_action_processing_ms": 0.2824302913643184, "mean_env_wait_ms": 2.9600068908805555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014075279235839844, "StateBufferConnector_ms": 0.008937835693359375, "ViewRequirementAgentConnector_ms": 0.1985940933227539}, "num_episodes": 33, "episode_return_max": -10.27075816236952, "episode_return_min": -1299.747216016208, "episode_return_mean": -680.9021110600079, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.1699619584497, "num_env_steps_trained_throughput_per_sec": 302.1699619584497, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13149.167, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13149.089, "sample_time_ms": 1016.318, "learn_time_ms": 12064.298, "learn_throughput": 331.557, "synch_weights_time_ms": 67.619}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00003", "date": "2024-08-03_10-32-32", "timestamp": 1722661352, "time_this_iter_s": 13.250146627426147, "time_total_s": 92.13189172744751, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00bf880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 92.13189172744751, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.847368421052632, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.608486068497102, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.640028423567612, "policy_loss": -0.013887531368042497, "vf_loss": 8.650718453526498, "vf_explained_var": 0.5286449413125713, "kl": 0.01661321221840808, "entropy": 1.251129560545087, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -29.973122132129763, "episode_reward_min": -1299.747216016208, "episode_reward_mean": -681.5309099122718, "episode_len_mean": 143.77, "episode_media": {}, "episodes_timesteps_total": 14377, "policy_reward_min": {"policy_0": -1299.747216016208}, "policy_reward_max": {"policy_0": -29.973122132129763}, "policy_reward_mean": {"policy_0": -681.5309099122718}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-508.13084745834834, -606.7915660418632, -772.482507193758, -692.4102028720623, -963.9041886750058, -275.19614283845925, -836.8772006422649, -506.45334573851324, -1216.459232097348, -392.364322170636, -879.1007824263411, -799.9185407339083, -455.1236085828954, -887.6949568499701, -734.5999366652992, -596.1939418326886, -1222.2327410859302, -321.2990770640449, -1024.4074791228504, -911.2744561282427, -130.0590653041056, -394.8977865575392, -225.39779280200204, -335.9577863884408, -1299.747216016208, -1111.5034861222825, -362.73877812744536, -619.4794602213694, -622.7359022563827, -551.3821817278965, -583.4651932440113, -373.26856020393546, -812.1538044599647, -416.1243389932463, -177.00533265728444, -421.76494574020614, -602.4455260572552, -762.1834805139891, -1074.6563282470745, -664.7898632349585, -852.8492806821756, -537.8600120896783, -782.5227602081048, -944.3277224723238, -679.2218714360196, -634.384674149396, -706.1826926313886, -742.5017347050466, -988.9140880203519, -792.1574297369804, -480.49954715607413, -264.0792225964999, -894.7442431560091, -572.257227439443, -912.1127345163026, -874.9982283702851, -619.1531415368484, -711.0184365225508, -535.6798346494998, -908.4122948928137, -573.9439703447115, -979.1319672416114, -392.7213755093425, -835.3178704909024, -819.3538863011057, -751.405555226952, -814.1485391837712, -531.0595709687085, -631.2523307029668, -728.7433810283298, -933.9597431748367, -649.3719477029682, -550.8264824076646, -828.5432141696002, -947.5495393907431, -29.973122132129763, -781.6840074692032, -535.5644102954901, -482.55432610003874, -1206.4546592520076, -63.812888032499565, -976.331155740778, -476.5966274549841, -672.9222742633925, -847.4221499778852, -1030.7966067285497, -598.3666507032693, -556.4825632403661, -340.67507057147304, -812.1701246712872, -464.24556919036996, -904.9868577388497, -1103.1211788526964, -575.1272420521082, -805.439306867065, -650.9342599798964, -799.0390574102132, -897.9319388067399, -798.5732216333466, -196.0072661545083], "episode_lengths": [118, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 107, 150, 146, 150, 150, 150, 150, 150, 95, 150, 86, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 135, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 47, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 135, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72], "policy_policy_0_reward": [-508.13084745834834, -606.7915660418632, -772.482507193758, -692.4102028720623, -963.9041886750058, -275.19614283845925, -836.8772006422649, -506.45334573851324, -1216.459232097348, -392.364322170636, -879.1007824263411, -799.9185407339083, -455.1236085828954, -887.6949568499701, -734.5999366652992, -596.1939418326886, -1222.2327410859302, -321.2990770640449, -1024.4074791228504, -911.2744561282427, -130.0590653041056, -394.8977865575392, -225.39779280200204, -335.9577863884408, -1299.747216016208, -1111.5034861222825, -362.73877812744536, -619.4794602213694, -622.7359022563827, -551.3821817278965, -583.4651932440113, -373.26856020393546, -812.1538044599647, -416.1243389932463, -177.00533265728444, -421.76494574020614, -602.4455260572552, -762.1834805139891, -1074.6563282470745, -664.7898632349585, -852.8492806821756, -537.8600120896783, -782.5227602081048, -944.3277224723238, -679.2218714360196, -634.384674149396, -706.1826926313886, -742.5017347050466, -988.9140880203519, -792.1574297369804, -480.49954715607413, -264.0792225964999, -894.7442431560091, -572.257227439443, -912.1127345163026, -874.9982283702851, -619.1531415368484, -711.0184365225508, -535.6798346494998, -908.4122948928137, -573.9439703447115, -979.1319672416114, -392.7213755093425, -835.3178704909024, -819.3538863011057, -751.405555226952, -814.1485391837712, -531.0595709687085, -631.2523307029668, -728.7433810283298, -933.9597431748367, -649.3719477029682, -550.8264824076646, -828.5432141696002, -947.5495393907431, -29.973122132129763, -781.6840074692032, -535.5644102954901, -482.55432610003874, -1206.4546592520076, -63.812888032499565, -976.331155740778, -476.5966274549841, -672.9222742633925, -847.4221499778852, -1030.7966067285497, -598.3666507032693, -556.4825632403661, -340.67507057147304, -812.1701246712872, -464.24556919036996, -904.9868577388497, -1103.1211788526964, -575.1272420521082, -805.439306867065, -650.9342599798964, -799.0390574102132, -897.9319388067399, -798.5732216333466, -196.0072661545083]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5609462798521976, "mean_inference_ms": 1.6887105881805515, "mean_action_processing_ms": 0.28238395883818235, "mean_env_wait_ms": 2.9636925892958903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013566255569458008, "StateBufferConnector_ms": 0.008640289306640625, "ViewRequirementAgentConnector_ms": 0.19649624824523926}, "num_episodes": 24, "episode_return_max": -29.973122132129763, "episode_return_min": -1299.747216016208, "episode_return_mean": -681.5309099122718, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.6394271176856, "num_env_steps_trained_throughput_per_sec": 300.6394271176856, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13168.645, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13168.567, "sample_time_ms": 1019.059, "learn_time_ms": 12080.838, "learn_throughput": 331.103, "synch_weights_time_ms": 67.816}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00003", "date": "2024-08-03_10-32-45", "timestamp": 1722661365, "time_this_iter_s": 13.31800627708435, "time_total_s": 105.44989800453186, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0fd90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 105.44989800453186, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.278947368421052, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.361620875572164, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.634668452044329, "policy_loss": -0.012646031770661164, "vf_loss": 8.643437098463377, "vf_explained_var": 0.6622801956410209, "kl": 0.020008805589835296, "entropy": 1.2436191701640686, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -29.973122132129763, "episode_reward_min": -1214.0571615929152, "episode_reward_mean": -662.9829407827476, "episode_len_mean": 139.27, "episode_media": {}, "episodes_timesteps_total": 13927, "policy_reward_min": {"policy_0": -1214.0571615929152}, "policy_reward_max": {"policy_0": -29.973122132129763}, "policy_reward_mean": {"policy_0": -662.9829407827476}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-812.1538044599647, -416.1243389932463, -177.00533265728444, -421.76494574020614, -602.4455260572552, -762.1834805139891, -1074.6563282470745, -664.7898632349585, -852.8492806821756, -537.8600120896783, -782.5227602081048, -944.3277224723238, -679.2218714360196, -634.384674149396, -706.1826926313886, -742.5017347050466, -988.9140880203519, -792.1574297369804, -480.49954715607413, -264.0792225964999, -894.7442431560091, -572.257227439443, -912.1127345163026, -874.9982283702851, -619.1531415368484, -711.0184365225508, -535.6798346494998, -908.4122948928137, -573.9439703447115, -979.1319672416114, -392.7213755093425, -835.3178704909024, -819.3538863011057, -751.405555226952, -814.1485391837712, -531.0595709687085, -631.2523307029668, -728.7433810283298, -933.9597431748367, -649.3719477029682, -550.8264824076646, -828.5432141696002, -947.5495393907431, -29.973122132129763, -781.6840074692032, -535.5644102954901, -482.55432610003874, -1206.4546592520076, -63.812888032499565, -976.331155740778, -476.5966274549841, -672.9222742633925, -847.4221499778852, -1030.7966067285497, -598.3666507032693, -556.4825632403661, -340.67507057147304, -812.1701246712872, -464.24556919036996, -904.9868577388497, -1103.1211788526964, -575.1272420521082, -805.439306867065, -650.9342599798964, -799.0390574102132, -897.9319388067399, -798.5732216333466, -196.0072661545083, -821.6765028687971, -267.71474218043744, -489.07528644885997, -653.2137577492113, -972.6132120523423, -821.1263842804024, -815.382010900797, -937.1412766946058, -574.0054590947658, -116.75442141243813, -147.59406860061122, -1214.0571615929152, -438.4272176798505, -191.1952802955477, -378.6242658676263, -1030.0075144866632, -731.7741861058134, -189.80855757374266, -580.7181493143236, -967.5515416896125, -335.4351711624747, -595.5445601429552, -660.8953173179787, -748.375626488279, -637.2751561160302, -841.8390202436897, -948.5542906941365, -42.148305540760745, -1072.1986807515332, -99.4409619052962, -814.2973501256604, -224.28593486147858], "episode_lengths": [150, 135, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 47, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 135, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 93, 150, 150, 150, 150, 150, 150, 150, 74, 98, 150, 150, 77, 114, 150, 150, 76, 150, 150, 105, 150, 124, 150, 150, 150, 150, 55, 150, 55, 150, 99], "policy_policy_0_reward": [-812.1538044599647, -416.1243389932463, -177.00533265728444, -421.76494574020614, -602.4455260572552, -762.1834805139891, -1074.6563282470745, -664.7898632349585, -852.8492806821756, -537.8600120896783, -782.5227602081048, -944.3277224723238, -679.2218714360196, -634.384674149396, -706.1826926313886, -742.5017347050466, -988.9140880203519, -792.1574297369804, -480.49954715607413, -264.0792225964999, -894.7442431560091, -572.257227439443, -912.1127345163026, -874.9982283702851, -619.1531415368484, -711.0184365225508, -535.6798346494998, -908.4122948928137, -573.9439703447115, -979.1319672416114, -392.7213755093425, -835.3178704909024, -819.3538863011057, -751.405555226952, -814.1485391837712, -531.0595709687085, -631.2523307029668, -728.7433810283298, -933.9597431748367, -649.3719477029682, -550.8264824076646, -828.5432141696002, -947.5495393907431, -29.973122132129763, -781.6840074692032, -535.5644102954901, -482.55432610003874, -1206.4546592520076, -63.812888032499565, -976.331155740778, -476.5966274549841, -672.9222742633925, -847.4221499778852, -1030.7966067285497, -598.3666507032693, -556.4825632403661, -340.67507057147304, -812.1701246712872, -464.24556919036996, -904.9868577388497, -1103.1211788526964, -575.1272420521082, -805.439306867065, -650.9342599798964, -799.0390574102132, -897.9319388067399, -798.5732216333466, -196.0072661545083, -821.6765028687971, -267.71474218043744, -489.07528644885997, -653.2137577492113, -972.6132120523423, -821.1263842804024, -815.382010900797, -937.1412766946058, -574.0054590947658, -116.75442141243813, -147.59406860061122, -1214.0571615929152, -438.4272176798505, -191.1952802955477, -378.6242658676263, -1030.0075144866632, -731.7741861058134, -189.80855757374266, -580.7181493143236, -967.5515416896125, -335.4351711624747, -595.5445601429552, -660.8953173179787, -748.375626488279, -637.2751561160302, -841.8390202436897, -948.5542906941365, -42.148305540760745, -1072.1986807515332, -99.4409619052962, -814.2973501256604, -224.28593486147858]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.560801296073313, "mean_inference_ms": 1.6904728297446152, "mean_action_processing_ms": 0.2818571567491054, "mean_env_wait_ms": 2.967210904359366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013220548629760742, "StateBufferConnector_ms": 0.008379936218261719, "ViewRequirementAgentConnector_ms": 0.19607758522033691}, "num_episodes": 32, "episode_return_max": -29.973122132129763, "episode_return_min": -1214.0571615929152, "episode_return_mean": -662.9829407827476, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.7648182854937, "num_env_steps_trained_throughput_per_sec": 309.7648182854937, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13140.244, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13140.167, "sample_time_ms": 1022.056, "learn_time_ms": 12048.621, "learn_throughput": 331.988, "synch_weights_time_ms": 68.635}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00003", "date": "2024-08-03_10-32-58", "timestamp": 1722661378, "time_this_iter_s": 12.925949096679688, "time_total_s": 118.37584710121155, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf563b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 118.37584710121155, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.727777777777778, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.33997864276171, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.626555279890696, "policy_loss": -0.006848952466195139, "vf_loss": 7.629863346616427, "vf_explained_var": 0.684761832592388, "kl": 0.012235149631123942, "entropy": 1.296198479582866, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -29.973122132129763, "episode_reward_min": -1244.7479871010542, "episode_reward_mean": -662.486278049049, "episode_len_mean": 137.97, "episode_media": {}, "episodes_timesteps_total": 13797, "policy_reward_min": {"policy_0": -1244.7479871010542}, "policy_reward_max": {"policy_0": -29.973122132129763}, "policy_reward_mean": {"policy_0": -662.486278049049}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-392.7213755093425, -835.3178704909024, -819.3538863011057, -751.405555226952, -814.1485391837712, -531.0595709687085, -631.2523307029668, -728.7433810283298, -933.9597431748367, -649.3719477029682, -550.8264824076646, -828.5432141696002, -947.5495393907431, -29.973122132129763, -781.6840074692032, -535.5644102954901, -482.55432610003874, -1206.4546592520076, -63.812888032499565, -976.331155740778, -476.5966274549841, -672.9222742633925, -847.4221499778852, -1030.7966067285497, -598.3666507032693, -556.4825632403661, -340.67507057147304, -812.1701246712872, -464.24556919036996, -904.9868577388497, -1103.1211788526964, -575.1272420521082, -805.439306867065, -650.9342599798964, -799.0390574102132, -897.9319388067399, -798.5732216333466, -196.0072661545083, -821.6765028687971, -267.71474218043744, -489.07528644885997, -653.2137577492113, -972.6132120523423, -821.1263842804024, -815.382010900797, -937.1412766946058, -574.0054590947658, -116.75442141243813, -147.59406860061122, -1214.0571615929152, -438.4272176798505, -191.1952802955477, -378.6242658676263, -1030.0075144866632, -731.7741861058134, -189.80855757374266, -580.7181493143236, -967.5515416896125, -335.4351711624747, -595.5445601429552, -660.8953173179787, -748.375626488279, -637.2751561160302, -841.8390202436897, -948.5542906941365, -42.148305540760745, -1072.1986807515332, -99.4409619052962, -814.2973501256604, -224.28593486147858, -190.55743142036783, -662.7486782626102, -444.1405434482844, -313.9476716988203, -334.88272930449835, -561.5201269417886, -475.9009887758837, -594.0700403971418, -623.0352170827603, -1113.0201559315, -75.61903234099849, -481.8622412280281, -501.4678925251555, -903.6969344293523, -730.1179829133004, -715.0063497254148, -1182.9004932757489, -421.106121246995, -1052.027325364229, -598.7852302690043, -786.8510446524077, -948.0585686379947, -1037.3904275075115, -791.6233739186466, -720.8727924440028, -1027.9924498973105, -502.7233958848405, -1244.7479871010542, -1154.1845889385454, -677.552645524039], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 47, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 135, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 93, 150, 150, 150, 150, 150, 150, 150, 74, 98, 150, 150, 77, 114, 150, 150, 76, 150, 150, 105, 150, 124, 150, 150, 150, 150, 55, 150, 55, 150, 99, 90, 150, 150, 109, 115, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-392.7213755093425, -835.3178704909024, -819.3538863011057, -751.405555226952, -814.1485391837712, -531.0595709687085, -631.2523307029668, -728.7433810283298, -933.9597431748367, -649.3719477029682, -550.8264824076646, -828.5432141696002, -947.5495393907431, -29.973122132129763, -781.6840074692032, -535.5644102954901, -482.55432610003874, -1206.4546592520076, -63.812888032499565, -976.331155740778, -476.5966274549841, -672.9222742633925, -847.4221499778852, -1030.7966067285497, -598.3666507032693, -556.4825632403661, -340.67507057147304, -812.1701246712872, -464.24556919036996, -904.9868577388497, -1103.1211788526964, -575.1272420521082, -805.439306867065, -650.9342599798964, -799.0390574102132, -897.9319388067399, -798.5732216333466, -196.0072661545083, -821.6765028687971, -267.71474218043744, -489.07528644885997, -653.2137577492113, -972.6132120523423, -821.1263842804024, -815.382010900797, -937.1412766946058, -574.0054590947658, -116.75442141243813, -147.59406860061122, -1214.0571615929152, -438.4272176798505, -191.1952802955477, -378.6242658676263, -1030.0075144866632, -731.7741861058134, -189.80855757374266, -580.7181493143236, -967.5515416896125, -335.4351711624747, -595.5445601429552, -660.8953173179787, -748.375626488279, -637.2751561160302, -841.8390202436897, -948.5542906941365, -42.148305540760745, -1072.1986807515332, -99.4409619052962, -814.2973501256604, -224.28593486147858, -190.55743142036783, -662.7486782626102, -444.1405434482844, -313.9476716988203, -334.88272930449835, -561.5201269417886, -475.9009887758837, -594.0700403971418, -623.0352170827603, -1113.0201559315, -75.61903234099849, -481.8622412280281, -501.4678925251555, -903.6969344293523, -730.1179829133004, -715.0063497254148, -1182.9004932757489, -421.106121246995, -1052.027325364229, -598.7852302690043, -786.8510446524077, -948.0585686379947, -1037.3904275075115, -791.6233739186466, -720.8727924440028, -1027.9924498973105, -502.7233958848405, -1244.7479871010542, -1154.1845889385454, -677.552645524039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5612294192476346, "mean_inference_ms": 1.6951082616896258, "mean_action_processing_ms": 0.282020388209758, "mean_env_wait_ms": 2.977635385944083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013155698776245117, "StateBufferConnector_ms": 0.008234977722167969, "ViewRequirementAgentConnector_ms": 0.19290804862976074}, "num_episodes": 30, "episode_return_max": -29.973122132129763, "episode_return_min": -1244.7479871010542, "episode_return_mean": -662.486278049049, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.975770736375, "num_env_steps_trained_throughput_per_sec": 317.975770736375, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13084.178, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13084.102, "sample_time_ms": 1024.422, "learn_time_ms": 11988.556, "learn_throughput": 333.652, "synch_weights_time_ms": 70.229}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00003", "date": "2024-08-03_10-33-11", "timestamp": 1722661391, "time_this_iter_s": 12.59203314781189, "time_total_s": 130.96788024902344, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a0109ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 130.96788024902344, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.661111111111113, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.70965006500482, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.670816544691721, "policy_loss": -0.014307887298734083, "vf_loss": 7.680539713303248, "vf_explained_var": 0.7767523324117065, "kl": 0.01574559403246289, "entropy": 1.3895747903734446, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -16.277808101868935, "episode_reward_min": -1281.5922173794274, "episode_reward_mean": -647.1785350081319, "episode_len_mean": 132.84, "episode_media": {}, "episodes_timesteps_total": 13284, "policy_reward_min": {"policy_0": -1281.5922173794274}, "policy_reward_max": {"policy_0": -16.277808101868935}, "policy_reward_mean": {"policy_0": -647.1785350081319}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1103.1211788526964, -575.1272420521082, -805.439306867065, -650.9342599798964, -799.0390574102132, -897.9319388067399, -798.5732216333466, -196.0072661545083, -821.6765028687971, -267.71474218043744, -489.07528644885997, -653.2137577492113, -972.6132120523423, -821.1263842804024, -815.382010900797, -937.1412766946058, -574.0054590947658, -116.75442141243813, -147.59406860061122, -1214.0571615929152, -438.4272176798505, -191.1952802955477, -378.6242658676263, -1030.0075144866632, -731.7741861058134, -189.80855757374266, -580.7181493143236, -967.5515416896125, -335.4351711624747, -595.5445601429552, -660.8953173179787, -748.375626488279, -637.2751561160302, -841.8390202436897, -948.5542906941365, -42.148305540760745, -1072.1986807515332, -99.4409619052962, -814.2973501256604, -224.28593486147858, -190.55743142036783, -662.7486782626102, -444.1405434482844, -313.9476716988203, -334.88272930449835, -561.5201269417886, -475.9009887758837, -594.0700403971418, -623.0352170827603, -1113.0201559315, -75.61903234099849, -481.8622412280281, -501.4678925251555, -903.6969344293523, -730.1179829133004, -715.0063497254148, -1182.9004932757489, -421.106121246995, -1052.027325364229, -598.7852302690043, -786.8510446524077, -948.0585686379947, -1037.3904275075115, -791.6233739186466, -720.8727924440028, -1027.9924498973105, -502.7233958848405, -1244.7479871010542, -1154.1845889385454, -677.552645524039, -45.13319721858491, -480.19533570687577, -90.12757623401427, -836.3084159464736, -517.1928537598542, -91.14449189635033, -213.86561123822014, -694.5090415902259, -854.381321423572, -726.7932015702744, -339.10656552287975, -911.1031034595868, -430.81265167926523, -947.5735725468024, -1281.5922173794274, -1044.5949722565326, -16.277808101868935, -911.043972803544, -618.1706107667854, -746.5849641255662, -668.3888530413728, -387.67622288604895, -39.963038033027196, -589.8325753438462, -1018.2195190307473, -1203.3492917365277, -314.1197457220099, -880.0671084310695, -1027.5273590710833, -738.8629972063072], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 72, 150, 93, 150, 150, 150, 150, 150, 150, 150, 74, 98, 150, 150, 77, 114, 150, 150, 76, 150, 150, 105, 150, 124, 150, 150, 150, 150, 55, 150, 55, 150, 99, 90, 150, 150, 109, 115, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 118, 55, 150, 150, 47, 72, 150, 150, 150, 130, 150, 112, 150, 150, 150, 33, 150, 150, 150, 150, 150, 64, 150, 150, 150, 86, 150, 150, 150], "policy_policy_0_reward": [-1103.1211788526964, -575.1272420521082, -805.439306867065, -650.9342599798964, -799.0390574102132, -897.9319388067399, -798.5732216333466, -196.0072661545083, -821.6765028687971, -267.71474218043744, -489.07528644885997, -653.2137577492113, -972.6132120523423, -821.1263842804024, -815.382010900797, -937.1412766946058, -574.0054590947658, -116.75442141243813, -147.59406860061122, -1214.0571615929152, -438.4272176798505, -191.1952802955477, -378.6242658676263, -1030.0075144866632, -731.7741861058134, -189.80855757374266, -580.7181493143236, -967.5515416896125, -335.4351711624747, -595.5445601429552, -660.8953173179787, -748.375626488279, -637.2751561160302, -841.8390202436897, -948.5542906941365, -42.148305540760745, -1072.1986807515332, -99.4409619052962, -814.2973501256604, -224.28593486147858, -190.55743142036783, -662.7486782626102, -444.1405434482844, -313.9476716988203, -334.88272930449835, -561.5201269417886, -475.9009887758837, -594.0700403971418, -623.0352170827603, -1113.0201559315, -75.61903234099849, -481.8622412280281, -501.4678925251555, -903.6969344293523, -730.1179829133004, -715.0063497254148, -1182.9004932757489, -421.106121246995, -1052.027325364229, -598.7852302690043, -786.8510446524077, -948.0585686379947, -1037.3904275075115, -791.6233739186466, -720.8727924440028, -1027.9924498973105, -502.7233958848405, -1244.7479871010542, -1154.1845889385454, -677.552645524039, -45.13319721858491, -480.19533570687577, -90.12757623401427, -836.3084159464736, -517.1928537598542, -91.14449189635033, -213.86561123822014, -694.5090415902259, -854.381321423572, -726.7932015702744, -339.10656552287975, -911.1031034595868, -430.81265167926523, -947.5735725468024, -1281.5922173794274, -1044.5949722565326, -16.277808101868935, -911.043972803544, -618.1706107667854, -746.5849641255662, -668.3888530413728, -387.67622288604895, -39.963038033027196, -589.8325753438462, -1018.2195190307473, -1203.3492917365277, -314.1197457220099, -880.0671084310695, -1027.5273590710833, -738.8629972063072]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5615510393508228, "mean_inference_ms": 1.6982152602167946, "mean_action_processing_ms": 0.28219447158931765, "mean_env_wait_ms": 2.985138021696248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013161420822143555, "StateBufferConnector_ms": 0.008047342300415039, "ViewRequirementAgentConnector_ms": 0.19658899307250977}, "num_episodes": 30, "episode_return_max": -16.277808101868935, "episode_return_min": -1281.5922173794274, "episode_return_mean": -647.1785350081319, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.9270213248675, "num_env_steps_trained_throughput_per_sec": 310.9270213248675, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13138.279, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13138.201, "sample_time_ms": 1037.045, "learn_time_ms": 12031.174, "learn_throughput": 332.47, "synch_weights_time_ms": 69.077}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00003", "date": "2024-08-03_10-33-24", "timestamp": 1722661404, "time_this_iter_s": 12.876932859420776, "time_total_s": 143.8448131084442, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907504c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 143.8448131084442, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 14.244444444444447, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.22818718925119, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.302493862311046, "policy_loss": -0.017056816836217573, "vf_loss": 8.313831341763338, "vf_explained_var": 0.813260528879861, "kl": 0.019521361472106945, "entropy": 1.3707109833757083, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -16.277808101868935, "episode_reward_min": -1316.7754536686405, "episode_reward_mean": -642.0938563295203, "episode_len_mean": 132.16, "episode_media": {}, "episodes_timesteps_total": 13216, "policy_reward_min": {"policy_0": -1316.7754536686405}, "policy_reward_max": {"policy_0": -16.277808101868935}, "policy_reward_mean": {"policy_0": -642.0938563295203}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-660.8953173179787, -748.375626488279, -637.2751561160302, -841.8390202436897, -948.5542906941365, -42.148305540760745, -1072.1986807515332, -99.4409619052962, -814.2973501256604, -224.28593486147858, -190.55743142036783, -662.7486782626102, -444.1405434482844, -313.9476716988203, -334.88272930449835, -561.5201269417886, -475.9009887758837, -594.0700403971418, -623.0352170827603, -1113.0201559315, -75.61903234099849, -481.8622412280281, -501.4678925251555, -903.6969344293523, -730.1179829133004, -715.0063497254148, -1182.9004932757489, -421.106121246995, -1052.027325364229, -598.7852302690043, -786.8510446524077, -948.0585686379947, -1037.3904275075115, -791.6233739186466, -720.8727924440028, -1027.9924498973105, -502.7233958848405, -1244.7479871010542, -1154.1845889385454, -677.552645524039, -45.13319721858491, -480.19533570687577, -90.12757623401427, -836.3084159464736, -517.1928537598542, -91.14449189635033, -213.86561123822014, -694.5090415902259, -854.381321423572, -726.7932015702744, -339.10656552287975, -911.1031034595868, -430.81265167926523, -947.5735725468024, -1281.5922173794274, -1044.5949722565326, -16.277808101868935, -911.043972803544, -618.1706107667854, -746.5849641255662, -668.3888530413728, -387.67622288604895, -39.963038033027196, -589.8325753438462, -1018.2195190307473, -1203.3492917365277, -314.1197457220099, -880.0671084310695, -1027.5273590710833, -738.8629972063072, -864.894441538694, -973.282559645835, -955.6072574232782, -592.1970150973082, -586.3247802171512, -88.91230902509169, -1073.6525957985507, -1051.9952751393473, -467.28745464311567, -97.36185263262573, -960.5786675138368, -68.9884366434219, -395.5406934622364, -1316.7754536686405, -690.8976694363103, -111.06580230274943, -885.7533444085756, -872.9271404641459, -656.7022208393686, -54.31057365060309, -924.7350813099131, -741.325216137984, -677.7138593172224, -866.6923161486017, -269.3476401939307, -637.0428869014703, -204.4408901640732, -525.9678492315749, -753.5796745942714, -221.2453745402904], "episode_lengths": [124, 150, 150, 150, 150, 55, 150, 55, 150, 99, 90, 150, 150, 109, 115, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 118, 55, 150, 150, 47, 72, 150, 150, 150, 130, 150, 112, 150, 150, 150, 33, 150, 150, 150, 150, 150, 64, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 61, 150, 55, 150, 150, 150, 73, 150, 150, 150, 64, 150, 150, 142, 150, 118, 150, 91, 150, 150, 109], "policy_policy_0_reward": [-660.8953173179787, -748.375626488279, -637.2751561160302, -841.8390202436897, -948.5542906941365, -42.148305540760745, -1072.1986807515332, -99.4409619052962, -814.2973501256604, -224.28593486147858, -190.55743142036783, -662.7486782626102, -444.1405434482844, -313.9476716988203, -334.88272930449835, -561.5201269417886, -475.9009887758837, -594.0700403971418, -623.0352170827603, -1113.0201559315, -75.61903234099849, -481.8622412280281, -501.4678925251555, -903.6969344293523, -730.1179829133004, -715.0063497254148, -1182.9004932757489, -421.106121246995, -1052.027325364229, -598.7852302690043, -786.8510446524077, -948.0585686379947, -1037.3904275075115, -791.6233739186466, -720.8727924440028, -1027.9924498973105, -502.7233958848405, -1244.7479871010542, -1154.1845889385454, -677.552645524039, -45.13319721858491, -480.19533570687577, -90.12757623401427, -836.3084159464736, -517.1928537598542, -91.14449189635033, -213.86561123822014, -694.5090415902259, -854.381321423572, -726.7932015702744, -339.10656552287975, -911.1031034595868, -430.81265167926523, -947.5735725468024, -1281.5922173794274, -1044.5949722565326, -16.277808101868935, -911.043972803544, -618.1706107667854, -746.5849641255662, -668.3888530413728, -387.67622288604895, -39.963038033027196, -589.8325753438462, -1018.2195190307473, -1203.3492917365277, -314.1197457220099, -880.0671084310695, -1027.5273590710833, -738.8629972063072, -864.894441538694, -973.282559645835, -955.6072574232782, -592.1970150973082, -586.3247802171512, -88.91230902509169, -1073.6525957985507, -1051.9952751393473, -467.28745464311567, -97.36185263262573, -960.5786675138368, -68.9884366434219, -395.5406934622364, -1316.7754536686405, -690.8976694363103, -111.06580230274943, -885.7533444085756, -872.9271404641459, -656.7022208393686, -54.31057365060309, -924.7350813099131, -741.325216137984, -677.7138593172224, -866.6923161486017, -269.3476401939307, -637.0428869014703, -204.4408901640732, -525.9678492315749, -753.5796745942714, -221.2453745402904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5611264551543712, "mean_inference_ms": 1.6989005181314039, "mean_action_processing_ms": 0.2820981452372336, "mean_env_wait_ms": 2.98875796309019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012861251831054688, "StateBufferConnector_ms": 0.008063554763793945, "ViewRequirementAgentConnector_ms": 0.19833087921142578}, "num_episodes": 30, "episode_return_max": -16.277808101868935, "episode_return_min": -1316.7754536686405, "episode_return_mean": -642.0938563295203, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.4593487727547, "num_env_steps_trained_throughput_per_sec": 374.4593487727547, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12889.493, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12889.415, "sample_time_ms": 1036.196, "learn_time_ms": 11782.55, "learn_throughput": 339.485, "synch_weights_time_ms": 69.764}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00003", "date": "2024-08-03_10-33-35", "timestamp": 1722661415, "time_this_iter_s": 10.694896221160889, "time_total_s": 154.5397093296051, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf563b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 154.5397093296051, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 14.55625, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.333939041694, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.254324885706107, "policy_loss": -0.013292885851114988, "vf_loss": 7.262629339098931, "vf_explained_var": 0.8471694602320592, "kl": 0.017133460275181277, "entropy": 1.5160797785967588, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -16.277808101868935, "episode_reward_min": -1316.7754536686405, "episode_reward_mean": -668.4259063667632, "episode_len_mean": 131.31, "episode_media": {}, "episodes_timesteps_total": 13131, "policy_reward_min": {"policy_0": -1316.7754536686405}, "policy_reward_max": {"policy_0": -16.277808101868935}, "policy_reward_mean": {"policy_0": -668.4259063667632}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1037.3904275075115, -791.6233739186466, -720.8727924440028, -1027.9924498973105, -502.7233958848405, -1244.7479871010542, -1154.1845889385454, -677.552645524039, -45.13319721858491, -480.19533570687577, -90.12757623401427, -836.3084159464736, -517.1928537598542, -91.14449189635033, -213.86561123822014, -694.5090415902259, -854.381321423572, -726.7932015702744, -339.10656552287975, -911.1031034595868, -430.81265167926523, -947.5735725468024, -1281.5922173794274, -1044.5949722565326, -16.277808101868935, -911.043972803544, -618.1706107667854, -746.5849641255662, -668.3888530413728, -387.67622288604895, -39.963038033027196, -589.8325753438462, -1018.2195190307473, -1203.3492917365277, -314.1197457220099, -880.0671084310695, -1027.5273590710833, -738.8629972063072, -864.894441538694, -973.282559645835, -955.6072574232782, -592.1970150973082, -586.3247802171512, -88.91230902509169, -1073.6525957985507, -1051.9952751393473, -467.28745464311567, -97.36185263262573, -960.5786675138368, -68.9884366434219, -395.5406934622364, -1316.7754536686405, -690.8976694363103, -111.06580230274943, -885.7533444085756, -872.9271404641459, -656.7022208393686, -54.31057365060309, -924.7350813099131, -741.325216137984, -677.7138593172224, -866.6923161486017, -269.3476401939307, -637.0428869014703, -204.4408901640732, -525.9678492315749, -753.5796745942714, -221.2453745402904, -1215.1691462332792, -1024.71904889707, -976.4444093395259, -896.2792947517326, -930.8757024408828, -746.8338178106966, -75.14024373438261, -1010.2316259356578, -296.6192220194496, -1204.2472068327195, -474.38293506910713, -258.6644405605309, -41.70535107247719, -1254.5651947298986, -536.7113309396141, -817.2802773106112, -563.027166464347, -536.636107752476, -125.6270408815094, -31.18361745825312, -1080.051481839579, -874.3011274533717, -676.4627420138652, -927.6449949489995, -1046.2577459006618, -1132.0600495280762, -22.10321748766149, -660.5521931229648, -802.4241345530484, -927.1442668338652, -677.8858287286706, -590.6074849964194], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 57, 118, 55, 150, 150, 47, 72, 150, 150, 150, 130, 150, 112, 150, 150, 150, 33, 150, 150, 150, 150, 150, 64, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 61, 150, 55, 150, 150, 150, 73, 150, 150, 150, 64, 150, 150, 142, 150, 118, 150, 91, 150, 150, 109, 150, 150, 150, 150, 150, 150, 70, 150, 97, 150, 150, 89, 50, 150, 150, 150, 150, 150, 66, 43, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1037.3904275075115, -791.6233739186466, -720.8727924440028, -1027.9924498973105, -502.7233958848405, -1244.7479871010542, -1154.1845889385454, -677.552645524039, -45.13319721858491, -480.19533570687577, -90.12757623401427, -836.3084159464736, -517.1928537598542, -91.14449189635033, -213.86561123822014, -694.5090415902259, -854.381321423572, -726.7932015702744, -339.10656552287975, -911.1031034595868, -430.81265167926523, -947.5735725468024, -1281.5922173794274, -1044.5949722565326, -16.277808101868935, -911.043972803544, -618.1706107667854, -746.5849641255662, -668.3888530413728, -387.67622288604895, -39.963038033027196, -589.8325753438462, -1018.2195190307473, -1203.3492917365277, -314.1197457220099, -880.0671084310695, -1027.5273590710833, -738.8629972063072, -864.894441538694, -973.282559645835, -955.6072574232782, -592.1970150973082, -586.3247802171512, -88.91230902509169, -1073.6525957985507, -1051.9952751393473, -467.28745464311567, -97.36185263262573, -960.5786675138368, -68.9884366434219, -395.5406934622364, -1316.7754536686405, -690.8976694363103, -111.06580230274943, -885.7533444085756, -872.9271404641459, -656.7022208393686, -54.31057365060309, -924.7350813099131, -741.325216137984, -677.7138593172224, -866.6923161486017, -269.3476401939307, -637.0428869014703, -204.4408901640732, -525.9678492315749, -753.5796745942714, -221.2453745402904, -1215.1691462332792, -1024.71904889707, -976.4444093395259, -896.2792947517326, -930.8757024408828, -746.8338178106966, -75.14024373438261, -1010.2316259356578, -296.6192220194496, -1204.2472068327195, -474.38293506910713, -258.6644405605309, -41.70535107247719, -1254.5651947298986, -536.7113309396141, -817.2802773106112, -563.027166464347, -536.636107752476, -125.6270408815094, -31.18361745825312, -1080.051481839579, -874.3011274533717, -676.4627420138652, -927.6449949489995, -1046.2577459006618, -1132.0600495280762, -22.10321748766149, -660.5521931229648, -802.4241345530484, -927.1442668338652, -677.8858287286706, -590.6074849964194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5609399594235086, "mean_inference_ms": 1.6998477748765768, "mean_action_processing_ms": 0.2821776981738019, "mean_env_wait_ms": 2.994791623415022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01253819465637207, "StateBufferConnector_ms": 0.008188962936401367, "ViewRequirementAgentConnector_ms": 0.20215868949890137}, "num_episodes": 32, "episode_return_max": -16.277808101868935, "episode_return_min": -1316.7754536686405, "episode_return_mean": -668.4259063667632, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.71060800758124, "num_env_steps_trained_throughput_per_sec": 299.71060800758124, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12901.752, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12901.676, "sample_time_ms": 1038.528, "learn_time_ms": 11791.897, "learn_throughput": 339.216, "synch_weights_time_ms": 70.334}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00003", "date": "2024-08-03_10-33-48", "timestamp": 1722661428, "time_this_iter_s": 13.35858964920044, "time_total_s": 167.89829897880554, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010a290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 167.89829897880554, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.626315789473683, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.048207158843674, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.337204419076443, "policy_loss": -0.014838877398869955, "vf_loss": 7.346944688260555, "vf_explained_var": 0.8762349733461936, "kl": 0.017443074123548286, "entropy": 1.3432607028633357, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -7.255212464029504, "episode_reward_min": -1378.9173752715944, "episode_reward_mean": -639.1412619197862, "episode_len_mean": 127.5, "episode_media": {}, "episodes_timesteps_total": 12750, "policy_reward_min": {"policy_0": -1378.9173752715944}, "policy_reward_max": {"policy_0": -7.255212464029504}, "policy_reward_mean": {"policy_0": -639.1412619197862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1203.3492917365277, -314.1197457220099, -880.0671084310695, -1027.5273590710833, -738.8629972063072, -864.894441538694, -973.282559645835, -955.6072574232782, -592.1970150973082, -586.3247802171512, -88.91230902509169, -1073.6525957985507, -1051.9952751393473, -467.28745464311567, -97.36185263262573, -960.5786675138368, -68.9884366434219, -395.5406934622364, -1316.7754536686405, -690.8976694363103, -111.06580230274943, -885.7533444085756, -872.9271404641459, -656.7022208393686, -54.31057365060309, -924.7350813099131, -741.325216137984, -677.7138593172224, -866.6923161486017, -269.3476401939307, -637.0428869014703, -204.4408901640732, -525.9678492315749, -753.5796745942714, -221.2453745402904, -1215.1691462332792, -1024.71904889707, -976.4444093395259, -896.2792947517326, -930.8757024408828, -746.8338178106966, -75.14024373438261, -1010.2316259356578, -296.6192220194496, -1204.2472068327195, -474.38293506910713, -258.6644405605309, -41.70535107247719, -1254.5651947298986, -536.7113309396141, -817.2802773106112, -563.027166464347, -536.636107752476, -125.6270408815094, -31.18361745825312, -1080.051481839579, -874.3011274533717, -676.4627420138652, -927.6449949489995, -1046.2577459006618, -1132.0600495280762, -22.10321748766149, -660.5521931229648, -802.4241345530484, -927.1442668338652, -677.8858287286706, -590.6074849964194, -856.9075957421026, -408.8998880132525, -746.6380612344249, -1348.979108031958, -20.515915733448004, -47.41440688636616, -281.78261047940634, -946.6022735982418, -60.85263665458968, -1075.475834154791, -801.1326342105383, -91.15591201065729, -161.10497714487104, -1229.4342518308692, -184.95480650515253, -886.6150392357571, -479.0322977328787, -8.635051115211356, -871.9853076258987, -1378.9173752715944, -7.255212464029504, -39.56632820455289, -1066.395527693323, -363.74883289970745, -83.72850226847015, -728.6123898611244, -644.0605411992018, -1093.5867431498748, -718.215646630347, -230.72114738259444, -667.7956936907631, -607.8143021532277, -590.6780592707622], "episode_lengths": [150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 61, 150, 55, 150, 150, 150, 73, 150, 150, 150, 64, 150, 150, 142, 150, 118, 150, 91, 150, 150, 109, 150, 150, 150, 150, 150, 150, 70, 150, 97, 150, 150, 89, 50, 150, 150, 150, 150, 150, 66, 43, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 46, 60, 118, 150, 64, 150, 150, 68, 61, 150, 87, 150, 129, 40, 150, 150, 34, 45, 150, 150, 54, 150, 150, 150, 150, 101, 150, 150, 150], "policy_policy_0_reward": [-1203.3492917365277, -314.1197457220099, -880.0671084310695, -1027.5273590710833, -738.8629972063072, -864.894441538694, -973.282559645835, -955.6072574232782, -592.1970150973082, -586.3247802171512, -88.91230902509169, -1073.6525957985507, -1051.9952751393473, -467.28745464311567, -97.36185263262573, -960.5786675138368, -68.9884366434219, -395.5406934622364, -1316.7754536686405, -690.8976694363103, -111.06580230274943, -885.7533444085756, -872.9271404641459, -656.7022208393686, -54.31057365060309, -924.7350813099131, -741.325216137984, -677.7138593172224, -866.6923161486017, -269.3476401939307, -637.0428869014703, -204.4408901640732, -525.9678492315749, -753.5796745942714, -221.2453745402904, -1215.1691462332792, -1024.71904889707, -976.4444093395259, -896.2792947517326, -930.8757024408828, -746.8338178106966, -75.14024373438261, -1010.2316259356578, -296.6192220194496, -1204.2472068327195, -474.38293506910713, -258.6644405605309, -41.70535107247719, -1254.5651947298986, -536.7113309396141, -817.2802773106112, -563.027166464347, -536.636107752476, -125.6270408815094, -31.18361745825312, -1080.051481839579, -874.3011274533717, -676.4627420138652, -927.6449949489995, -1046.2577459006618, -1132.0600495280762, -22.10321748766149, -660.5521931229648, -802.4241345530484, -927.1442668338652, -677.8858287286706, -590.6074849964194, -856.9075957421026, -408.8998880132525, -746.6380612344249, -1348.979108031958, -20.515915733448004, -47.41440688636616, -281.78261047940634, -946.6022735982418, -60.85263665458968, -1075.475834154791, -801.1326342105383, -91.15591201065729, -161.10497714487104, -1229.4342518308692, -184.95480650515253, -886.6150392357571, -479.0322977328787, -8.635051115211356, -871.9853076258987, -1378.9173752715944, -7.255212464029504, -39.56632820455289, -1066.395527693323, -363.74883289970745, -83.72850226847015, -728.6123898611244, -644.0605411992018, -1093.5867431498748, -718.215646630347, -230.72114738259444, -667.7956936907631, -607.8143021532277, -590.6780592707622]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5604207670425662, "mean_inference_ms": 1.69977731703271, "mean_action_processing_ms": 0.28204300851822467, "mean_env_wait_ms": 2.9978813960422044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012309789657592773, "StateBufferConnector_ms": 0.008139848709106445, "ViewRequirementAgentConnector_ms": 0.20232295989990234}, "num_episodes": 33, "episode_return_max": -7.255212464029504, "episode_return_min": -1378.9173752715944, "episode_return_mean": -639.1412619197862, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.6661092731521, "num_env_steps_trained_throughput_per_sec": 307.6661092731521, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12875.661, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12875.584, "sample_time_ms": 1039.734, "learn_time_ms": 11765.317, "learn_throughput": 339.982, "synch_weights_time_ms": 69.635}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00003", "date": "2024-08-03_10-34-01", "timestamp": 1722661441, "time_this_iter_s": 13.014147996902466, "time_total_s": 180.912446975708, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010b370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 180.912446975708, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.827777777777778, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.282650446891786, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.180648275713126, "policy_loss": -0.012070930623303866, "vf_loss": 7.187396677831809, "vf_explained_var": 0.8791246736422181, "kl": 0.0182039131173345, "entropy": 1.3862328855320811, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -7.255212464029504, "episode_reward_min": -1378.9173752715944, "episode_reward_mean": -616.2291151235344, "episode_len_mean": 127.63, "episode_media": {}, "episodes_timesteps_total": 12763, "policy_reward_min": {"policy_0": -1378.9173752715944}, "policy_reward_max": {"policy_0": -7.255212464029504}, "policy_reward_mean": {"policy_0": -616.2291151235344}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-866.6923161486017, -269.3476401939307, -637.0428869014703, -204.4408901640732, -525.9678492315749, -753.5796745942714, -221.2453745402904, -1215.1691462332792, -1024.71904889707, -976.4444093395259, -896.2792947517326, -930.8757024408828, -746.8338178106966, -75.14024373438261, -1010.2316259356578, -296.6192220194496, -1204.2472068327195, -474.38293506910713, -258.6644405605309, -41.70535107247719, -1254.5651947298986, -536.7113309396141, -817.2802773106112, -563.027166464347, -536.636107752476, -125.6270408815094, -31.18361745825312, -1080.051481839579, -874.3011274533717, -676.4627420138652, -927.6449949489995, -1046.2577459006618, -1132.0600495280762, -22.10321748766149, -660.5521931229648, -802.4241345530484, -927.1442668338652, -677.8858287286706, -590.6074849964194, -856.9075957421026, -408.8998880132525, -746.6380612344249, -1348.979108031958, -20.515915733448004, -47.41440688636616, -281.78261047940634, -946.6022735982418, -60.85263665458968, -1075.475834154791, -801.1326342105383, -91.15591201065729, -161.10497714487104, -1229.4342518308692, -184.95480650515253, -886.6150392357571, -479.0322977328787, -8.635051115211356, -871.9853076258987, -1378.9173752715944, -7.255212464029504, -39.56632820455289, -1066.395527693323, -363.74883289970745, -83.72850226847015, -728.6123898611244, -644.0605411992018, -1093.5867431498748, -718.215646630347, -230.72114738259444, -667.7956936907631, -607.8143021532277, -590.6780592707622, -241.80430055527796, -882.612024530055, -701.2149726220041, -44.988601039294956, -191.6067744783933, -762.0604343985038, -846.853441113739, -819.0130836864605, -486.76013344516036, -1140.145646119975, -523.4458110331578, -51.831611995117186, -1008.8607296409309, -955.148463901864, -491.46874710802473, -893.2288869027918, -1180.2734770115753, -370.0781681012948, -546.5439199394464, -626.6410101262697, -852.2898521662366, -580.8181166960604, -378.9417719535346, -628.2129915250412, -45.604354876221514, -375.06798408282395, -728.3066852077076, -627.7195286008628], "episode_lengths": [150, 118, 150, 91, 150, 150, 109, 150, 150, 150, 150, 150, 150, 70, 150, 97, 150, 150, 89, 50, 150, 150, 150, 150, 150, 66, 43, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 46, 60, 118, 150, 64, 150, 150, 68, 61, 150, 87, 150, 129, 40, 150, 150, 34, 45, 150, 150, 54, 150, 150, 150, 150, 101, 150, 150, 150, 98, 150, 150, 70, 70, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 117, 150, 139, 150, 150, 150, 150, 55, 131, 150, 150], "policy_policy_0_reward": [-866.6923161486017, -269.3476401939307, -637.0428869014703, -204.4408901640732, -525.9678492315749, -753.5796745942714, -221.2453745402904, -1215.1691462332792, -1024.71904889707, -976.4444093395259, -896.2792947517326, -930.8757024408828, -746.8338178106966, -75.14024373438261, -1010.2316259356578, -296.6192220194496, -1204.2472068327195, -474.38293506910713, -258.6644405605309, -41.70535107247719, -1254.5651947298986, -536.7113309396141, -817.2802773106112, -563.027166464347, -536.636107752476, -125.6270408815094, -31.18361745825312, -1080.051481839579, -874.3011274533717, -676.4627420138652, -927.6449949489995, -1046.2577459006618, -1132.0600495280762, -22.10321748766149, -660.5521931229648, -802.4241345530484, -927.1442668338652, -677.8858287286706, -590.6074849964194, -856.9075957421026, -408.8998880132525, -746.6380612344249, -1348.979108031958, -20.515915733448004, -47.41440688636616, -281.78261047940634, -946.6022735982418, -60.85263665458968, -1075.475834154791, -801.1326342105383, -91.15591201065729, -161.10497714487104, -1229.4342518308692, -184.95480650515253, -886.6150392357571, -479.0322977328787, -8.635051115211356, -871.9853076258987, -1378.9173752715944, -7.255212464029504, -39.56632820455289, -1066.395527693323, -363.74883289970745, -83.72850226847015, -728.6123898611244, -644.0605411992018, -1093.5867431498748, -718.215646630347, -230.72114738259444, -667.7956936907631, -607.8143021532277, -590.6780592707622, -241.80430055527796, -882.612024530055, -701.2149726220041, -44.988601039294956, -191.6067744783933, -762.0604343985038, -846.853441113739, -819.0130836864605, -486.76013344516036, -1140.145646119975, -523.4458110331578, -51.831611995117186, -1008.8607296409309, -955.148463901864, -491.46874710802473, -893.2288869027918, -1180.2734770115753, -370.0781681012948, -546.5439199394464, -626.6410101262697, -852.2898521662366, -580.8181166960604, -378.9417719535346, -628.2129915250412, -45.604354876221514, -375.06798408282395, -728.3066852077076, -627.7195286008628]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5596589553737397, "mean_inference_ms": 1.6985437522726614, "mean_action_processing_ms": 0.281621125645255, "mean_env_wait_ms": 2.9995605563211045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012000083923339844, "StateBufferConnector_ms": 0.008055925369262695, "ViewRequirementAgentConnector_ms": 0.19978070259094238}, "num_episodes": 28, "episode_return_max": -7.255212464029504, "episode_return_min": -1378.9173752715944, "episode_return_mean": -616.2291151235344, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.31208880575423, "num_env_steps_trained_throughput_per_sec": 299.31208880575423, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12904.44, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12904.363, "sample_time_ms": 1039.932, "learn_time_ms": 11793.199, "learn_throughput": 339.179, "synch_weights_time_ms": 70.343}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00003", "date": "2024-08-03_10-34-15", "timestamp": 1722661455, "time_this_iter_s": 13.376777410507202, "time_total_s": 194.2892243862152, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010a560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 194.2892243862152, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 13.910526315789474, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.00931046406428, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.511921232938766, "policy_loss": -0.005857379383329923, "vf_loss": 6.513256516555945, "vf_explained_var": 0.8406965799008806, "kl": 0.01563840473293872, "entropy": 1.6941886475930612, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -7.255212464029504, "episode_reward_min": -1384.4312276831952, "episode_reward_mean": -648.9391621510487, "episode_len_mean": 130.02, "episode_media": {}, "episodes_timesteps_total": 13002, "policy_reward_min": {"policy_0": -1384.4312276831952}, "policy_reward_max": {"policy_0": -7.255212464029504}, "policy_reward_mean": {"policy_0": -648.9391621510487}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1132.0600495280762, -22.10321748766149, -660.5521931229648, -802.4241345530484, -927.1442668338652, -677.8858287286706, -590.6074849964194, -856.9075957421026, -408.8998880132525, -746.6380612344249, -1348.979108031958, -20.515915733448004, -47.41440688636616, -281.78261047940634, -946.6022735982418, -60.85263665458968, -1075.475834154791, -801.1326342105383, -91.15591201065729, -161.10497714487104, -1229.4342518308692, -184.95480650515253, -886.6150392357571, -479.0322977328787, -8.635051115211356, -871.9853076258987, -1378.9173752715944, -7.255212464029504, -39.56632820455289, -1066.395527693323, -363.74883289970745, -83.72850226847015, -728.6123898611244, -644.0605411992018, -1093.5867431498748, -718.215646630347, -230.72114738259444, -667.7956936907631, -607.8143021532277, -590.6780592707622, -241.80430055527796, -882.612024530055, -701.2149726220041, -44.988601039294956, -191.6067744783933, -762.0604343985038, -846.853441113739, -819.0130836864605, -486.76013344516036, -1140.145646119975, -523.4458110331578, -51.831611995117186, -1008.8607296409309, -955.148463901864, -491.46874710802473, -893.2288869027918, -1180.2734770115753, -370.0781681012948, -546.5439199394464, -626.6410101262697, -852.2898521662366, -580.8181166960604, -378.9417719535346, -628.2129915250412, -45.604354876221514, -375.06798408282395, -728.3066852077076, -627.7195286008628, -1186.8051310354438, -622.7966620058462, -1271.7401218329373, -1015.9843565754105, -790.647786946229, -1384.4312276831952, -720.6495769466311, -69.26066808091944, -628.2702560061704, -908.8891517884304, -177.53210516912, -519.9100092773718, -522.213353553699, -716.3590111326153, -75.7193442725686, -1294.8736817227493, -517.5624846727601, -453.4706718945838, -854.5521860105483, -952.1863095006512, -1199.2530197454018, -1066.368351727748, -1039.2205040385911, -641.4841014322545, -663.0532314782396, -1030.7044105983455, -747.699852882238, -371.89391593417986, -705.6321556835608, -1303.8491009903653, -86.58861231462674, -830.7812539829137], "episode_lengths": [150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 46, 60, 118, 150, 64, 150, 150, 68, 61, 150, 87, 150, 129, 40, 150, 150, 34, 45, 150, 150, 54, 150, 150, 150, 150, 101, 150, 150, 150, 98, 150, 150, 70, 70, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 117, 150, 139, 150, 150, 150, 150, 55, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 70, 128, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 62, 150], "policy_policy_0_reward": [-1132.0600495280762, -22.10321748766149, -660.5521931229648, -802.4241345530484, -927.1442668338652, -677.8858287286706, -590.6074849964194, -856.9075957421026, -408.8998880132525, -746.6380612344249, -1348.979108031958, -20.515915733448004, -47.41440688636616, -281.78261047940634, -946.6022735982418, -60.85263665458968, -1075.475834154791, -801.1326342105383, -91.15591201065729, -161.10497714487104, -1229.4342518308692, -184.95480650515253, -886.6150392357571, -479.0322977328787, -8.635051115211356, -871.9853076258987, -1378.9173752715944, -7.255212464029504, -39.56632820455289, -1066.395527693323, -363.74883289970745, -83.72850226847015, -728.6123898611244, -644.0605411992018, -1093.5867431498748, -718.215646630347, -230.72114738259444, -667.7956936907631, -607.8143021532277, -590.6780592707622, -241.80430055527796, -882.612024530055, -701.2149726220041, -44.988601039294956, -191.6067744783933, -762.0604343985038, -846.853441113739, -819.0130836864605, -486.76013344516036, -1140.145646119975, -523.4458110331578, -51.831611995117186, -1008.8607296409309, -955.148463901864, -491.46874710802473, -893.2288869027918, -1180.2734770115753, -370.0781681012948, -546.5439199394464, -626.6410101262697, -852.2898521662366, -580.8181166960604, -378.9417719535346, -628.2129915250412, -45.604354876221514, -375.06798408282395, -728.3066852077076, -627.7195286008628, -1186.8051310354438, -622.7966620058462, -1271.7401218329373, -1015.9843565754105, -790.647786946229, -1384.4312276831952, -720.6495769466311, -69.26066808091944, -628.2702560061704, -908.8891517884304, -177.53210516912, -519.9100092773718, -522.213353553699, -716.3590111326153, -75.7193442725686, -1294.8736817227493, -517.5624846727601, -453.4706718945838, -854.5521860105483, -952.1863095006512, -1199.2530197454018, -1066.368351727748, -1039.2205040385911, -641.4841014322545, -663.0532314782396, -1030.7044105983455, -747.699852882238, -371.89391593417986, -705.6321556835608, -1303.8491009903653, -86.58861231462674, -830.7812539829137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5585781272056344, "mean_inference_ms": 1.6966971412512177, "mean_action_processing_ms": 0.2811725957480651, "mean_env_wait_ms": 3.0023208149572156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012154817581176758, "StateBufferConnector_ms": 0.008111000061035156, "ViewRequirementAgentConnector_ms": 0.2010953426361084}, "num_episodes": 32, "episode_return_max": -7.255212464029504, "episode_return_min": -1384.4312276831952, "episode_return_mean": -648.9391621510487, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.6450610239218, "num_env_steps_trained_throughput_per_sec": 304.6450610239218, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12842.344, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12842.266, "sample_time_ms": 1040.982, "learn_time_ms": 11731.092, "learn_throughput": 340.974, "synch_weights_time_ms": 69.266}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00003", "date": "2024-08-03_10-34-28", "timestamp": 1722661468, "time_this_iter_s": 13.143369197845459, "time_total_s": 207.43259358406067, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 207.43259358406067, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.394736842105265, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.180131149291995, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.6190113633871075, "policy_loss": -0.011446791331400164, "vf_loss": 7.625970886647702, "vf_explained_var": 0.8347617925455173, "kl": 0.015609427219048181, "entropy": 1.955874627456069, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -39.56632820455289, "episode_reward_min": -1519.1606833418089, "episode_reward_mean": -727.3988944256407, "episode_len_mean": 135.21, "episode_media": {}, "episodes_timesteps_total": 13521, "policy_reward_min": {"policy_0": -1519.1606833418089}, "policy_reward_max": {"policy_0": -39.56632820455289}, "policy_reward_mean": {"policy_0": -727.3988944256407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.56632820455289, -1066.395527693323, -363.74883289970745, -83.72850226847015, -728.6123898611244, -644.0605411992018, -1093.5867431498748, -718.215646630347, -230.72114738259444, -667.7956936907631, -607.8143021532277, -590.6780592707622, -241.80430055527796, -882.612024530055, -701.2149726220041, -44.988601039294956, -191.6067744783933, -762.0604343985038, -846.853441113739, -819.0130836864605, -486.76013344516036, -1140.145646119975, -523.4458110331578, -51.831611995117186, -1008.8607296409309, -955.148463901864, -491.46874710802473, -893.2288869027918, -1180.2734770115753, -370.0781681012948, -546.5439199394464, -626.6410101262697, -852.2898521662366, -580.8181166960604, -378.9417719535346, -628.2129915250412, -45.604354876221514, -375.06798408282395, -728.3066852077076, -627.7195286008628, -1186.8051310354438, -622.7966620058462, -1271.7401218329373, -1015.9843565754105, -790.647786946229, -1384.4312276831952, -720.6495769466311, -69.26066808091944, -628.2702560061704, -908.8891517884304, -177.53210516912, -519.9100092773718, -522.213353553699, -716.3590111326153, -75.7193442725686, -1294.8736817227493, -517.5624846727601, -453.4706718945838, -854.5521860105483, -952.1863095006512, -1199.2530197454018, -1066.368351727748, -1039.2205040385911, -641.4841014322545, -663.0532314782396, -1030.7044105983455, -747.699852882238, -371.89391593417986, -705.6321556835608, -1303.8491009903653, -86.58861231462674, -830.7812539829137, -700.1503058582449, -144.35237252695123, -62.26307550862371, -1228.6937555107731, -826.2349417305321, -920.0109911909091, -42.524264580714856, -809.8957488440554, -1113.4579543381567, -921.2672808656389, -1278.894976146038, -968.9535759923667, -1017.8472402456347, -1519.1606833418089, -471.78551608466, -1184.678666408968, -1116.3588172548773, -1304.1408412765536, -949.1525566319576, -551.065964012196, -1205.5690967358057, -1058.6410098216263, -977.0124384165264, -1158.4757325021471, -857.4919959127939, -191.7695443437293, -749.0530609266586, -1224.1391913770176], "episode_lengths": [45, 150, 150, 54, 150, 150, 150, 150, 101, 150, 150, 150, 98, 150, 150, 70, 70, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 117, 150, 139, 150, 150, 150, 150, 55, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 70, 128, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 62, 150, 150, 68, 47, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150], "policy_policy_0_reward": [-39.56632820455289, -1066.395527693323, -363.74883289970745, -83.72850226847015, -728.6123898611244, -644.0605411992018, -1093.5867431498748, -718.215646630347, -230.72114738259444, -667.7956936907631, -607.8143021532277, -590.6780592707622, -241.80430055527796, -882.612024530055, -701.2149726220041, -44.988601039294956, -191.6067744783933, -762.0604343985038, -846.853441113739, -819.0130836864605, -486.76013344516036, -1140.145646119975, -523.4458110331578, -51.831611995117186, -1008.8607296409309, -955.148463901864, -491.46874710802473, -893.2288869027918, -1180.2734770115753, -370.0781681012948, -546.5439199394464, -626.6410101262697, -852.2898521662366, -580.8181166960604, -378.9417719535346, -628.2129915250412, -45.604354876221514, -375.06798408282395, -728.3066852077076, -627.7195286008628, -1186.8051310354438, -622.7966620058462, -1271.7401218329373, -1015.9843565754105, -790.647786946229, -1384.4312276831952, -720.6495769466311, -69.26066808091944, -628.2702560061704, -908.8891517884304, -177.53210516912, -519.9100092773718, -522.213353553699, -716.3590111326153, -75.7193442725686, -1294.8736817227493, -517.5624846727601, -453.4706718945838, -854.5521860105483, -952.1863095006512, -1199.2530197454018, -1066.368351727748, -1039.2205040385911, -641.4841014322545, -663.0532314782396, -1030.7044105983455, -747.699852882238, -371.89391593417986, -705.6321556835608, -1303.8491009903653, -86.58861231462674, -830.7812539829137, -700.1503058582449, -144.35237252695123, -62.26307550862371, -1228.6937555107731, -826.2349417305321, -920.0109911909091, -42.524264580714856, -809.8957488440554, -1113.4579543381567, -921.2672808656389, -1278.894976146038, -968.9535759923667, -1017.8472402456347, -1519.1606833418089, -471.78551608466, -1184.678666408968, -1116.3588172548773, -1304.1408412765536, -949.1525566319576, -551.065964012196, -1205.5690967358057, -1058.6410098216263, -977.0124384165264, -1158.4757325021471, -857.4919959127939, -191.7695443437293, -749.0530609266586, -1224.1391913770176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5583716403858661, "mean_inference_ms": 1.6961165724479677, "mean_action_processing_ms": 0.280753698981863, "mean_env_wait_ms": 3.0086956845727877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012370109558105469, "StateBufferConnector_ms": 0.008202552795410156, "ViewRequirementAgentConnector_ms": 0.20172858238220215}, "num_episodes": 28, "episode_return_max": -39.56632820455289, "episode_return_min": -1519.1606833418089, "episode_return_mean": -727.3988944256407, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.27873500011697, "num_env_steps_trained_throughput_per_sec": 298.27873500011697, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12859.613, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12859.535, "sample_time_ms": 1050.651, "learn_time_ms": 11739.094, "learn_throughput": 340.742, "synch_weights_time_ms": 68.862}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00003", "date": "2024-08-03_10-34-41", "timestamp": 1722661481, "time_this_iter_s": 13.423628568649292, "time_total_s": 220.85622215270996, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a290751120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 220.85622215270996, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 14.178947368421051, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 71.89911381751298, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.9479864900310835, "policy_loss": -0.005050647336368759, "vf_loss": 6.949178702632586, "vf_explained_var": 0.8573156551768383, "kl": 0.013488427543158347, "entropy": 1.8808825886497895, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -42.524264580714856, "episode_reward_min": -1519.1606833418089, "episode_reward_mean": -823.8040126722938, "episode_len_mean": 140.35, "episode_media": {}, "episodes_timesteps_total": 14035, "policy_reward_min": {"policy_0": -1519.1606833418089}, "policy_reward_max": {"policy_0": -42.524264580714856}, "policy_reward_mean": {"policy_0": -823.8040126722938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-955.148463901864, -491.46874710802473, -893.2288869027918, -1180.2734770115753, -370.0781681012948, -546.5439199394464, -626.6410101262697, -852.2898521662366, -580.8181166960604, -378.9417719535346, -628.2129915250412, -45.604354876221514, -375.06798408282395, -728.3066852077076, -627.7195286008628, -1186.8051310354438, -622.7966620058462, -1271.7401218329373, -1015.9843565754105, -790.647786946229, -1384.4312276831952, -720.6495769466311, -69.26066808091944, -628.2702560061704, -908.8891517884304, -177.53210516912, -519.9100092773718, -522.213353553699, -716.3590111326153, -75.7193442725686, -1294.8736817227493, -517.5624846727601, -453.4706718945838, -854.5521860105483, -952.1863095006512, -1199.2530197454018, -1066.368351727748, -1039.2205040385911, -641.4841014322545, -663.0532314782396, -1030.7044105983455, -747.699852882238, -371.89391593417986, -705.6321556835608, -1303.8491009903653, -86.58861231462674, -830.7812539829137, -700.1503058582449, -144.35237252695123, -62.26307550862371, -1228.6937555107731, -826.2349417305321, -920.0109911909091, -42.524264580714856, -809.8957488440554, -1113.4579543381567, -921.2672808656389, -1278.894976146038, -968.9535759923667, -1017.8472402456347, -1519.1606833418089, -471.78551608466, -1184.678666408968, -1116.3588172548773, -1304.1408412765536, -949.1525566319576, -551.065964012196, -1205.5690967358057, -1058.6410098216263, -977.0124384165264, -1158.4757325021471, -857.4919959127939, -191.7695443437293, -749.0530609266586, -1224.1391913770176, -528.8023924610527, -1220.2399539695332, -761.8371575338954, -835.8592634244068, -1187.4489099878153, -727.5102052121036, -1225.745099020432, -586.092621538088, -1386.4865251103597, -1129.4160845938493, -1188.426626933659, -883.1032696695758, -1097.0637506309524, -847.0207832317865, -1145.903555627714, -1244.524651477269, -942.2543995787919, -853.9236494691115, -939.5607771156381, -1394.8989832496047, -340.0094992416654, -1145.0141501772443, -756.967024315354, -882.2811825945844, -926.2425875628147], "episode_lengths": [150, 150, 150, 150, 117, 150, 139, 150, 150, 150, 150, 55, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 70, 128, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 62, 150, 150, 68, 47, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150], "policy_policy_0_reward": [-955.148463901864, -491.46874710802473, -893.2288869027918, -1180.2734770115753, -370.0781681012948, -546.5439199394464, -626.6410101262697, -852.2898521662366, -580.8181166960604, -378.9417719535346, -628.2129915250412, -45.604354876221514, -375.06798408282395, -728.3066852077076, -627.7195286008628, -1186.8051310354438, -622.7966620058462, -1271.7401218329373, -1015.9843565754105, -790.647786946229, -1384.4312276831952, -720.6495769466311, -69.26066808091944, -628.2702560061704, -908.8891517884304, -177.53210516912, -519.9100092773718, -522.213353553699, -716.3590111326153, -75.7193442725686, -1294.8736817227493, -517.5624846727601, -453.4706718945838, -854.5521860105483, -952.1863095006512, -1199.2530197454018, -1066.368351727748, -1039.2205040385911, -641.4841014322545, -663.0532314782396, -1030.7044105983455, -747.699852882238, -371.89391593417986, -705.6321556835608, -1303.8491009903653, -86.58861231462674, -830.7812539829137, -700.1503058582449, -144.35237252695123, -62.26307550862371, -1228.6937555107731, -826.2349417305321, -920.0109911909091, -42.524264580714856, -809.8957488440554, -1113.4579543381567, -921.2672808656389, -1278.894976146038, -968.9535759923667, -1017.8472402456347, -1519.1606833418089, -471.78551608466, -1184.678666408968, -1116.3588172548773, -1304.1408412765536, -949.1525566319576, -551.065964012196, -1205.5690967358057, -1058.6410098216263, -977.0124384165264, -1158.4757325021471, -857.4919959127939, -191.7695443437293, -749.0530609266586, -1224.1391913770176, -528.8023924610527, -1220.2399539695332, -761.8371575338954, -835.8592634244068, -1187.4489099878153, -727.5102052121036, -1225.745099020432, -586.092621538088, -1386.4865251103597, -1129.4160845938493, -1188.426626933659, -883.1032696695758, -1097.0637506309524, -847.0207832317865, -1145.903555627714, -1244.524651477269, -942.2543995787919, -853.9236494691115, -939.5607771156381, -1394.8989832496047, -340.0094992416654, -1145.0141501772443, -756.967024315354, -882.2811825945844, -926.2425875628147]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5576747876267765, "mean_inference_ms": 1.6954927775164967, "mean_action_processing_ms": 0.2805545662708837, "mean_env_wait_ms": 3.015409011172687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012292861938476562, "StateBufferConnector_ms": 0.008138895034790039, "ViewRequirementAgentConnector_ms": 0.19694948196411133}, "num_episodes": 25, "episode_return_max": -42.524264580714856, "episode_return_min": -1519.1606833418089, "episode_return_mean": -823.8040126722938, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.83596444224116, "num_env_steps_trained_throughput_per_sec": 302.83596444224116, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12849.962, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12849.885, "sample_time_ms": 1053.213, "learn_time_ms": 11726.606, "learn_throughput": 341.105, "synch_weights_time_ms": 69.131}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00003", "date": "2024-08-03_10-34-55", "timestamp": 1722661495, "time_this_iter_s": 13.222092628479004, "time_total_s": 234.07831478118896, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a290751d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 234.07831478118896, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.068421052631582, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89.34634242852529, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.392471191287041, "policy_loss": -0.013574327056024535, "vf_loss": 6.400717480977376, "vf_explained_var": 0.9083373596891761, "kl": 0.018256162492131526, "entropy": 1.488171013817191, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -6.252339362481745, "episode_reward_min": -1519.1606833418089, "episode_reward_mean": -831.8942965871167, "episode_len_mean": 137.21, "episode_media": {}, "episodes_timesteps_total": 13721, "policy_reward_min": {"policy_0": -1519.1606833418089}, "policy_reward_max": {"policy_0": -6.252339362481745}, "policy_reward_mean": {"policy_0": -831.8942965871167}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-952.1863095006512, -1199.2530197454018, -1066.368351727748, -1039.2205040385911, -641.4841014322545, -663.0532314782396, -1030.7044105983455, -747.699852882238, -371.89391593417986, -705.6321556835608, -1303.8491009903653, -86.58861231462674, -830.7812539829137, -700.1503058582449, -144.35237252695123, -62.26307550862371, -1228.6937555107731, -826.2349417305321, -920.0109911909091, -42.524264580714856, -809.8957488440554, -1113.4579543381567, -921.2672808656389, -1278.894976146038, -968.9535759923667, -1017.8472402456347, -1519.1606833418089, -471.78551608466, -1184.678666408968, -1116.3588172548773, -1304.1408412765536, -949.1525566319576, -551.065964012196, -1205.5690967358057, -1058.6410098216263, -977.0124384165264, -1158.4757325021471, -857.4919959127939, -191.7695443437293, -749.0530609266586, -1224.1391913770176, -528.8023924610527, -1220.2399539695332, -761.8371575338954, -835.8592634244068, -1187.4489099878153, -727.5102052121036, -1225.745099020432, -586.092621538088, -1386.4865251103597, -1129.4160845938493, -1188.426626933659, -883.1032696695758, -1097.0637506309524, -847.0207832317865, -1145.903555627714, -1244.524651477269, -942.2543995787919, -853.9236494691115, -939.5607771156381, -1394.8989832496047, -340.0094992416654, -1145.0141501772443, -756.967024315354, -882.2811825945844, -926.2425875628147, -1324.0953256758407, -694.5577071561378, -1036.2349777662068, -673.7712743394372, -1223.208184353681, -6.252339362481745, -449.7208335492529, -850.3675714761189, -21.601563704406022, -696.1049116866659, -1026.6364729397296, -900.5278289873626, -1134.9894477315252, -804.3707184676085, -722.6576934881031, -1010.413645532104, -928.3552199506327, -1240.2775338985575, -1019.9584976101102, -1266.643149070047, -188.2359906908297, -108.9456716971379, -596.3098103897933, -418.5371468178962, -269.5884992545818, -1213.7672903491225, -552.9659465273586, -1061.0698616923119, -378.8703491164405, -912.5955395314832, -78.05213026273879, -200.81872224325085, -742.8186997992166, -67.7195811711252], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 62, 150, 150, 68, 47, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 34, 116, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 64, 150, 140, 88, 150, 150, 150, 111, 150, 49, 111, 150, 62], "policy_policy_0_reward": [-952.1863095006512, -1199.2530197454018, -1066.368351727748, -1039.2205040385911, -641.4841014322545, -663.0532314782396, -1030.7044105983455, -747.699852882238, -371.89391593417986, -705.6321556835608, -1303.8491009903653, -86.58861231462674, -830.7812539829137, -700.1503058582449, -144.35237252695123, -62.26307550862371, -1228.6937555107731, -826.2349417305321, -920.0109911909091, -42.524264580714856, -809.8957488440554, -1113.4579543381567, -921.2672808656389, -1278.894976146038, -968.9535759923667, -1017.8472402456347, -1519.1606833418089, -471.78551608466, -1184.678666408968, -1116.3588172548773, -1304.1408412765536, -949.1525566319576, -551.065964012196, -1205.5690967358057, -1058.6410098216263, -977.0124384165264, -1158.4757325021471, -857.4919959127939, -191.7695443437293, -749.0530609266586, -1224.1391913770176, -528.8023924610527, -1220.2399539695332, -761.8371575338954, -835.8592634244068, -1187.4489099878153, -727.5102052121036, -1225.745099020432, -586.092621538088, -1386.4865251103597, -1129.4160845938493, -1188.426626933659, -883.1032696695758, -1097.0637506309524, -847.0207832317865, -1145.903555627714, -1244.524651477269, -942.2543995787919, -853.9236494691115, -939.5607771156381, -1394.8989832496047, -340.0094992416654, -1145.0141501772443, -756.967024315354, -882.2811825945844, -926.2425875628147, -1324.0953256758407, -694.5577071561378, -1036.2349777662068, -673.7712743394372, -1223.208184353681, -6.252339362481745, -449.7208335492529, -850.3675714761189, -21.601563704406022, -696.1049116866659, -1026.6364729397296, -900.5278289873626, -1134.9894477315252, -804.3707184676085, -722.6576934881031, -1010.413645532104, -928.3552199506327, -1240.2775338985575, -1019.9584976101102, -1266.643149070047, -188.2359906908297, -108.9456716971379, -596.3098103897933, -418.5371468178962, -269.5884992545818, -1213.7672903491225, -552.9659465273586, -1061.0698616923119, -378.8703491164405, -912.5955395314832, -78.05213026273879, -200.81872224325085, -742.8186997992166, -67.7195811711252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5576326616333839, "mean_inference_ms": 1.6953452169317529, "mean_action_processing_ms": 0.2802246475946913, "mean_env_wait_ms": 3.0215844510317162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012394189834594727, "StateBufferConnector_ms": 0.008277416229248047, "ViewRequirementAgentConnector_ms": 0.20021796226501465}, "num_episodes": 34, "episode_return_max": -6.252339362481745, "episode_return_min": -1519.1606833418089, "episode_return_mean": -831.8942965871167, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.9987516633613, "num_env_steps_trained_throughput_per_sec": 301.9987516633613, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12883.169, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12883.088, "sample_time_ms": 1052.695, "learn_time_ms": 11761.415, "learn_throughput": 340.095, "synch_weights_time_ms": 68.045}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00003", "date": "2024-08-03_10-35-08", "timestamp": 1722661508, "time_this_iter_s": 13.257430791854858, "time_total_s": 247.33574557304382, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0ecb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 247.33574557304382, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.521052631578947, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.86215843856334, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.6073810935020445, "policy_loss": -0.01003178261356273, "vf_loss": 6.611965609590213, "vf_explained_var": 0.9236237516005834, "kl": 0.018659182861908145, "entropy": 1.5048636025438706, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -5.593946142172329, "episode_reward_min": -1496.003334685068, "episode_reward_mean": -825.0014956808658, "episode_len_mean": 137.19, "episode_media": {}, "episodes_timesteps_total": 13719, "policy_reward_min": {"policy_0": -1496.003334685068}, "policy_reward_max": {"policy_0": -5.593946142172329}, "policy_reward_mean": {"policy_0": -825.0014956808658}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1304.1408412765536, -949.1525566319576, -551.065964012196, -1205.5690967358057, -1058.6410098216263, -977.0124384165264, -1158.4757325021471, -857.4919959127939, -191.7695443437293, -749.0530609266586, -1224.1391913770176, -528.8023924610527, -1220.2399539695332, -761.8371575338954, -835.8592634244068, -1187.4489099878153, -727.5102052121036, -1225.745099020432, -586.092621538088, -1386.4865251103597, -1129.4160845938493, -1188.426626933659, -883.1032696695758, -1097.0637506309524, -847.0207832317865, -1145.903555627714, -1244.524651477269, -942.2543995787919, -853.9236494691115, -939.5607771156381, -1394.8989832496047, -340.0094992416654, -1145.0141501772443, -756.967024315354, -882.2811825945844, -926.2425875628147, -1324.0953256758407, -694.5577071561378, -1036.2349777662068, -673.7712743394372, -1223.208184353681, -6.252339362481745, -449.7208335492529, -850.3675714761189, -21.601563704406022, -696.1049116866659, -1026.6364729397296, -900.5278289873626, -1134.9894477315252, -804.3707184676085, -722.6576934881031, -1010.413645532104, -928.3552199506327, -1240.2775338985575, -1019.9584976101102, -1266.643149070047, -188.2359906908297, -108.9456716971379, -596.3098103897933, -418.5371468178962, -269.5884992545818, -1213.7672903491225, -552.9659465273586, -1061.0698616923119, -378.8703491164405, -912.5955395314832, -78.05213026273879, -200.81872224325085, -742.8186997992166, -67.7195811711252, -1118.2070560103155, -5.704803897633173, -745.1712518641029, -103.58451855213337, -833.5054571249656, -1286.0952192803943, -882.0399251721846, -474.3991559925727, -1095.2075893999736, -546.8129220251432, -1496.003334685068, -591.6178906303202, -738.1981656497602, -878.4227439168176, -993.2990023753385, -267.57395926871374, -953.8305031762886, -933.2066256291603, -1010.3279394511579, -1244.3468620652682, -832.1769299973424, -1137.1442469274896, -949.579767523038, -151.9303886592682, -1318.208050337386, -543.0235087641623, -5.593946142172329, -984.5934679079243, -1098.6653242966313, -1057.4943393902565], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 34, 116, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 64, 150, 140, 88, 150, 150, 150, 111, 150, 49, 111, 150, 62, 150, 42, 150, 69, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 37, 150, 150, 150], "policy_policy_0_reward": [-1304.1408412765536, -949.1525566319576, -551.065964012196, -1205.5690967358057, -1058.6410098216263, -977.0124384165264, -1158.4757325021471, -857.4919959127939, -191.7695443437293, -749.0530609266586, -1224.1391913770176, -528.8023924610527, -1220.2399539695332, -761.8371575338954, -835.8592634244068, -1187.4489099878153, -727.5102052121036, -1225.745099020432, -586.092621538088, -1386.4865251103597, -1129.4160845938493, -1188.426626933659, -883.1032696695758, -1097.0637506309524, -847.0207832317865, -1145.903555627714, -1244.524651477269, -942.2543995787919, -853.9236494691115, -939.5607771156381, -1394.8989832496047, -340.0094992416654, -1145.0141501772443, -756.967024315354, -882.2811825945844, -926.2425875628147, -1324.0953256758407, -694.5577071561378, -1036.2349777662068, -673.7712743394372, -1223.208184353681, -6.252339362481745, -449.7208335492529, -850.3675714761189, -21.601563704406022, -696.1049116866659, -1026.6364729397296, -900.5278289873626, -1134.9894477315252, -804.3707184676085, -722.6576934881031, -1010.413645532104, -928.3552199506327, -1240.2775338985575, -1019.9584976101102, -1266.643149070047, -188.2359906908297, -108.9456716971379, -596.3098103897933, -418.5371468178962, -269.5884992545818, -1213.7672903491225, -552.9659465273586, -1061.0698616923119, -378.8703491164405, -912.5955395314832, -78.05213026273879, -200.81872224325085, -742.8186997992166, -67.7195811711252, -1118.2070560103155, -5.704803897633173, -745.1712518641029, -103.58451855213337, -833.5054571249656, -1286.0952192803943, -882.0399251721846, -474.3991559925727, -1095.2075893999736, -546.8129220251432, -1496.003334685068, -591.6178906303202, -738.1981656497602, -878.4227439168176, -993.2990023753385, -267.57395926871374, -953.8305031762886, -933.2066256291603, -1010.3279394511579, -1244.3468620652682, -832.1769299973424, -1137.1442469274896, -949.579767523038, -151.9303886592682, -1318.208050337386, -543.0235087641623, -5.593946142172329, -984.5934679079243, -1098.6653242966313, -1057.4943393902565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5573853168697513, "mean_inference_ms": 1.6962159587271457, "mean_action_processing_ms": 0.28030506590682114, "mean_env_wait_ms": 3.0292801205503723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012449026107788086, "StateBufferConnector_ms": 0.00823831558227539, "ViewRequirementAgentConnector_ms": 0.19953227043151855}, "num_episodes": 30, "episode_return_max": -5.593946142172329, "episode_return_min": -1496.003334685068, "episode_return_mean": -825.0014956808658, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.23299255683327, "num_env_steps_trained_throughput_per_sec": 293.23299255683327, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12989.315, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12989.233, "sample_time_ms": 1057.151, "learn_time_ms": 11865.584, "learn_throughput": 337.109, "synch_weights_time_ms": 65.603}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00003", "date": "2024-08-03_10-35-22", "timestamp": 1722661522, "time_this_iter_s": 13.654104471206665, "time_total_s": 260.9898500442505, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010bac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 260.9898500442505, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.589473684210526, "ram_util_percent": 27.657894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.92649461627006, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.100344110280275, "policy_loss": -0.015459486967301928, "vf_loss": 6.110081702470779, "vf_explained_var": 0.9313727110624314, "kl": 0.019599463511144676, "entropy": 1.5796234258140127, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -5.593946142172329, "episode_reward_min": -1496.003334685068, "episode_reward_mean": -751.4293647143729, "episode_len_mean": 133.01, "episode_media": {}, "episodes_timesteps_total": 13301, "policy_reward_min": {"policy_0": -1496.003334685068}, "policy_reward_max": {"policy_0": -5.593946142172329}, "policy_reward_mean": {"policy_0": -751.4293647143729}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-942.2543995787919, -853.9236494691115, -939.5607771156381, -1394.8989832496047, -340.0094992416654, -1145.0141501772443, -756.967024315354, -882.2811825945844, -926.2425875628147, -1324.0953256758407, -694.5577071561378, -1036.2349777662068, -673.7712743394372, -1223.208184353681, -6.252339362481745, -449.7208335492529, -850.3675714761189, -21.601563704406022, -696.1049116866659, -1026.6364729397296, -900.5278289873626, -1134.9894477315252, -804.3707184676085, -722.6576934881031, -1010.413645532104, -928.3552199506327, -1240.2775338985575, -1019.9584976101102, -1266.643149070047, -188.2359906908297, -108.9456716971379, -596.3098103897933, -418.5371468178962, -269.5884992545818, -1213.7672903491225, -552.9659465273586, -1061.0698616923119, -378.8703491164405, -912.5955395314832, -78.05213026273879, -200.81872224325085, -742.8186997992166, -67.7195811711252, -1118.2070560103155, -5.704803897633173, -745.1712518641029, -103.58451855213337, -833.5054571249656, -1286.0952192803943, -882.0399251721846, -474.3991559925727, -1095.2075893999736, -546.8129220251432, -1496.003334685068, -591.6178906303202, -738.1981656497602, -878.4227439168176, -993.2990023753385, -267.57395926871374, -953.8305031762886, -933.2066256291603, -1010.3279394511579, -1244.3468620652682, -832.1769299973424, -1137.1442469274896, -949.579767523038, -151.9303886592682, -1318.208050337386, -543.0235087641623, -5.593946142172329, -984.5934679079243, -1098.6653242966313, -1057.4943393902565, -765.8008273881961, -457.5736821305377, -88.51397328465387, -695.4449095982567, -843.1652094069622, -1110.0296407055027, -773.9038195199465, -915.8941722754009, -378.75039728738454, -730.6807768025436, -559.0076439153269, -69.0407939606073, -1274.548161935415, -220.0409091563239, -982.448874821847, -226.48395576049091, -1100.39028409169, -75.1681772769656, -707.2960125959025, -968.9115981696601, -960.8409301549419, -1152.7915522785013, -1328.3526460869675, -265.30258419278294, -363.6626516239654, -1303.9077613509837, -546.8272399584374], "episode_lengths": [150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 34, 116, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 64, 150, 140, 88, 150, 150, 150, 111, 150, 49, 111, 150, 62, 150, 42, 150, 69, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 37, 150, 150, 150, 150, 111, 86, 150, 150, 150, 150, 150, 128, 150, 150, 65, 150, 112, 150, 67, 150, 55, 150, 150, 150, 150, 150, 150, 102, 150, 150], "policy_policy_0_reward": [-942.2543995787919, -853.9236494691115, -939.5607771156381, -1394.8989832496047, -340.0094992416654, -1145.0141501772443, -756.967024315354, -882.2811825945844, -926.2425875628147, -1324.0953256758407, -694.5577071561378, -1036.2349777662068, -673.7712743394372, -1223.208184353681, -6.252339362481745, -449.7208335492529, -850.3675714761189, -21.601563704406022, -696.1049116866659, -1026.6364729397296, -900.5278289873626, -1134.9894477315252, -804.3707184676085, -722.6576934881031, -1010.413645532104, -928.3552199506327, -1240.2775338985575, -1019.9584976101102, -1266.643149070047, -188.2359906908297, -108.9456716971379, -596.3098103897933, -418.5371468178962, -269.5884992545818, -1213.7672903491225, -552.9659465273586, -1061.0698616923119, -378.8703491164405, -912.5955395314832, -78.05213026273879, -200.81872224325085, -742.8186997992166, -67.7195811711252, -1118.2070560103155, -5.704803897633173, -745.1712518641029, -103.58451855213337, -833.5054571249656, -1286.0952192803943, -882.0399251721846, -474.3991559925727, -1095.2075893999736, -546.8129220251432, -1496.003334685068, -591.6178906303202, -738.1981656497602, -878.4227439168176, -993.2990023753385, -267.57395926871374, -953.8305031762886, -933.2066256291603, -1010.3279394511579, -1244.3468620652682, -832.1769299973424, -1137.1442469274896, -949.579767523038, -151.9303886592682, -1318.208050337386, -543.0235087641623, -5.593946142172329, -984.5934679079243, -1098.6653242966313, -1057.4943393902565, -765.8008273881961, -457.5736821305377, -88.51397328465387, -695.4449095982567, -843.1652094069622, -1110.0296407055027, -773.9038195199465, -915.8941722754009, -378.75039728738454, -730.6807768025436, -559.0076439153269, -69.0407939606073, -1274.548161935415, -220.0409091563239, -982.448874821847, -226.48395576049091, -1100.39028409169, -75.1681772769656, -707.2960125959025, -968.9115981696601, -960.8409301549419, -1152.7915522785013, -1328.3526460869675, -265.30258419278294, -363.6626516239654, -1303.9077613509837, -546.8272399584374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5571293922717788, "mean_inference_ms": 1.6964252499564554, "mean_action_processing_ms": 0.2802770967630072, "mean_env_wait_ms": 3.03353658802701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012398719787597656, "StateBufferConnector_ms": 0.008215188980102539, "ViewRequirementAgentConnector_ms": 0.19955110549926758}, "num_episodes": 27, "episode_return_max": -5.593946142172329, "episode_return_min": -1496.003334685068, "episode_return_mean": -751.4293647143729, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.42961479403704, "num_env_steps_trained_throughput_per_sec": 303.42961479403704, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13021.103, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13021.02, "sample_time_ms": 1046.924, "learn_time_ms": 11906.217, "learn_throughput": 335.959, "synch_weights_time_ms": 66.954}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00003", "date": "2024-08-03_10-35-35", "timestamp": 1722661535, "time_this_iter_s": 13.195482015609741, "time_total_s": 274.18533205986023, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010a9e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 274.18533205986023, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.0, "ram_util_percent": 27.68421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.50321235259374, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.7264954144755995, "policy_loss": -0.011409811271975438, "vf_loss": 6.732089277108511, "vf_explained_var": 0.9536638924231132, "kl": 0.019798453879411683, "entropy": 1.2357804089784623, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -5.593946142172329, "episode_reward_min": -1496.003334685068, "episode_reward_mean": -688.4688256436123, "episode_len_mean": 128.8, "episode_media": {}, "episodes_timesteps_total": 12880, "policy_reward_min": {"policy_0": -1496.003334685068}, "policy_reward_max": {"policy_0": -5.593946142172329}, "policy_reward_mean": {"policy_0": -688.4688256436123}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-378.8703491164405, -912.5955395314832, -78.05213026273879, -200.81872224325085, -742.8186997992166, -67.7195811711252, -1118.2070560103155, -5.704803897633173, -745.1712518641029, -103.58451855213337, -833.5054571249656, -1286.0952192803943, -882.0399251721846, -474.3991559925727, -1095.2075893999736, -546.8129220251432, -1496.003334685068, -591.6178906303202, -738.1981656497602, -878.4227439168176, -993.2990023753385, -267.57395926871374, -953.8305031762886, -933.2066256291603, -1010.3279394511579, -1244.3468620652682, -832.1769299973424, -1137.1442469274896, -949.579767523038, -151.9303886592682, -1318.208050337386, -543.0235087641623, -5.593946142172329, -984.5934679079243, -1098.6653242966313, -1057.4943393902565, -765.8008273881961, -457.5736821305377, -88.51397328465387, -695.4449095982567, -843.1652094069622, -1110.0296407055027, -773.9038195199465, -915.8941722754009, -378.75039728738454, -730.6807768025436, -559.0076439153269, -69.0407939606073, -1274.548161935415, -220.0409091563239, -982.448874821847, -226.48395576049091, -1100.39028409169, -75.1681772769656, -707.2960125959025, -968.9115981696601, -960.8409301549419, -1152.7915522785013, -1328.3526460869675, -265.30258419278294, -363.6626516239654, -1303.9077613509837, -546.8272399584374, -856.5091206188938, -617.7062103062908, -789.1024735357004, -246.44071317205476, -928.6109715240383, -669.5841554812986, -1309.531193564732, -18.80208932904717, -33.02834497099844, -969.3161146103475, -850.9228652709859, -177.70034561144763, -387.66255836267686, -956.426559973835, -1101.9817434257395, -448.95073561975266, -1040.0305207790443, -83.23107842947807, -711.6936974921849, -93.97602339217904, -190.17466333097812, -572.9015942535364, -939.3096376841833, -768.9073144663665, -952.7011419566776, -141.51402841261313, -1069.1597878463822, -845.3203259152979, -1237.517059042358, -1215.5155038966504, -125.00981319097815, -1046.191342470568, -984.0699740090851, -169.98863083499634, -216.8833760265369, -424.4177012602018, -134.4740503256538], "episode_lengths": [111, 150, 49, 111, 150, 62, 150, 42, 150, 69, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 37, 150, 150, 150, 150, 111, 86, 150, 150, 150, 150, 150, 128, 150, 150, 65, 150, 112, 150, 67, 150, 55, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 94, 150, 150, 150, 43, 51, 150, 150, 85, 104, 150, 150, 150, 150, 73, 150, 76, 90, 150, 150, 150, 150, 87, 150, 150, 150, 150, 61, 150, 150, 89, 105, 124, 71], "policy_policy_0_reward": [-378.8703491164405, -912.5955395314832, -78.05213026273879, -200.81872224325085, -742.8186997992166, -67.7195811711252, -1118.2070560103155, -5.704803897633173, -745.1712518641029, -103.58451855213337, -833.5054571249656, -1286.0952192803943, -882.0399251721846, -474.3991559925727, -1095.2075893999736, -546.8129220251432, -1496.003334685068, -591.6178906303202, -738.1981656497602, -878.4227439168176, -993.2990023753385, -267.57395926871374, -953.8305031762886, -933.2066256291603, -1010.3279394511579, -1244.3468620652682, -832.1769299973424, -1137.1442469274896, -949.579767523038, -151.9303886592682, -1318.208050337386, -543.0235087641623, -5.593946142172329, -984.5934679079243, -1098.6653242966313, -1057.4943393902565, -765.8008273881961, -457.5736821305377, -88.51397328465387, -695.4449095982567, -843.1652094069622, -1110.0296407055027, -773.9038195199465, -915.8941722754009, -378.75039728738454, -730.6807768025436, -559.0076439153269, -69.0407939606073, -1274.548161935415, -220.0409091563239, -982.448874821847, -226.48395576049091, -1100.39028409169, -75.1681772769656, -707.2960125959025, -968.9115981696601, -960.8409301549419, -1152.7915522785013, -1328.3526460869675, -265.30258419278294, -363.6626516239654, -1303.9077613509837, -546.8272399584374, -856.5091206188938, -617.7062103062908, -789.1024735357004, -246.44071317205476, -928.6109715240383, -669.5841554812986, -1309.531193564732, -18.80208932904717, -33.02834497099844, -969.3161146103475, -850.9228652709859, -177.70034561144763, -387.66255836267686, -956.426559973835, -1101.9817434257395, -448.95073561975266, -1040.0305207790443, -83.23107842947807, -711.6936974921849, -93.97602339217904, -190.17466333097812, -572.9015942535364, -939.3096376841833, -768.9073144663665, -952.7011419566776, -141.51402841261313, -1069.1597878463822, -845.3203259152979, -1237.517059042358, -1215.5155038966504, -125.00981319097815, -1046.191342470568, -984.0699740090851, -169.98863083499634, -216.8833760265369, -424.4177012602018, -134.4740503256538]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5566442276521986, "mean_inference_ms": 1.6961375007737223, "mean_action_processing_ms": 0.28010924760133404, "mean_env_wait_ms": 3.0393207533316327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012007951736450195, "StateBufferConnector_ms": 0.00798940658569336, "ViewRequirementAgentConnector_ms": 0.19389081001281738}, "num_episodes": 37, "episode_return_max": -5.593946142172329, "episode_return_min": -1496.003334685068, "episode_return_mean": -688.4688256436123, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.13693739181514, "num_env_steps_trained_throughput_per_sec": 300.13693739181514, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13285.621, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13285.539, "sample_time_ms": 1049.248, "learn_time_ms": 12166.419, "learn_throughput": 328.774, "synch_weights_time_ms": 68.916}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00003", "date": "2024-08-03_10-35-48", "timestamp": 1722661548, "time_this_iter_s": 13.341345310211182, "time_total_s": 287.5266773700714, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf57520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 287.5266773700714, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.15263157894737, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 142.61951278448106, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.904995739211639, "policy_loss": -0.005829212106861329, "vf_loss": 5.905595032622417, "vf_explained_var": 0.9629798652604222, "kl": 0.017935907610505362, "entropy": 1.5085358192523322, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -5.593946142172329, "episode_reward_min": -1328.3526460869675, "episode_reward_mean": -676.3829995490203, "episode_len_mean": 126.68, "episode_media": {}, "episodes_timesteps_total": 12668, "policy_reward_min": {"policy_0": -1328.3526460869675}, "policy_reward_max": {"policy_0": -5.593946142172329}, "policy_reward_mean": {"policy_0": -676.3829995490203}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151.9303886592682, -1318.208050337386, -543.0235087641623, -5.593946142172329, -984.5934679079243, -1098.6653242966313, -1057.4943393902565, -765.8008273881961, -457.5736821305377, -88.51397328465387, -695.4449095982567, -843.1652094069622, -1110.0296407055027, -773.9038195199465, -915.8941722754009, -378.75039728738454, -730.6807768025436, -559.0076439153269, -69.0407939606073, -1274.548161935415, -220.0409091563239, -982.448874821847, -226.48395576049091, -1100.39028409169, -75.1681772769656, -707.2960125959025, -968.9115981696601, -960.8409301549419, -1152.7915522785013, -1328.3526460869675, -265.30258419278294, -363.6626516239654, -1303.9077613509837, -546.8272399584374, -856.5091206188938, -617.7062103062908, -789.1024735357004, -246.44071317205476, -928.6109715240383, -669.5841554812986, -1309.531193564732, -18.80208932904717, -33.02834497099844, -969.3161146103475, -850.9228652709859, -177.70034561144763, -387.66255836267686, -956.426559973835, -1101.9817434257395, -448.95073561975266, -1040.0305207790443, -83.23107842947807, -711.6936974921849, -93.97602339217904, -190.17466333097812, -572.9015942535364, -939.3096376841833, -768.9073144663665, -952.7011419566776, -141.51402841261313, -1069.1597878463822, -845.3203259152979, -1237.517059042358, -1215.5155038966504, -125.00981319097815, -1046.191342470568, -984.0699740090851, -169.98863083499634, -216.8833760265369, -424.4177012602018, -134.4740503256538, -742.0641120458109, -1100.368690568698, -925.3380262433386, -1292.8485356683461, -486.17317101194834, -904.0873404315239, -1200.9123504794409, -18.230812459026428, -671.2256550575578, -729.4721874356625, -1171.030263060842, -97.69148598375054, -947.5065462182394, -85.57639989303979, -1049.6421284943428, -1228.6191115475963, -84.13197896300684, -23.491080048278096, -22.828351482184292, -35.45989586858964, -1306.6427982191642, -1035.8927733713294, -747.6264292131626, -96.70432516319885, -809.5037765831668, -1219.1772693208334, -545.6145019675788, -901.3413429279786, -809.5469435526204], "episode_lengths": [69, 150, 150, 37, 150, 150, 150, 150, 111, 86, 150, 150, 150, 150, 150, 128, 150, 150, 65, 150, 112, 150, 67, 150, 55, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 94, 150, 150, 150, 43, 51, 150, 150, 85, 104, 150, 150, 150, 150, 73, 150, 76, 90, 150, 150, 150, 150, 87, 150, 150, 150, 150, 61, 150, 150, 89, 105, 124, 71, 150, 150, 150, 150, 150, 150, 150, 38, 150, 150, 150, 80, 150, 58, 150, 150, 70, 56, 47, 65, 150, 150, 150, 69, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-151.9303886592682, -1318.208050337386, -543.0235087641623, -5.593946142172329, -984.5934679079243, -1098.6653242966313, -1057.4943393902565, -765.8008273881961, -457.5736821305377, -88.51397328465387, -695.4449095982567, -843.1652094069622, -1110.0296407055027, -773.9038195199465, -915.8941722754009, -378.75039728738454, -730.6807768025436, -559.0076439153269, -69.0407939606073, -1274.548161935415, -220.0409091563239, -982.448874821847, -226.48395576049091, -1100.39028409169, -75.1681772769656, -707.2960125959025, -968.9115981696601, -960.8409301549419, -1152.7915522785013, -1328.3526460869675, -265.30258419278294, -363.6626516239654, -1303.9077613509837, -546.8272399584374, -856.5091206188938, -617.7062103062908, -789.1024735357004, -246.44071317205476, -928.6109715240383, -669.5841554812986, -1309.531193564732, -18.80208932904717, -33.02834497099844, -969.3161146103475, -850.9228652709859, -177.70034561144763, -387.66255836267686, -956.426559973835, -1101.9817434257395, -448.95073561975266, -1040.0305207790443, -83.23107842947807, -711.6936974921849, -93.97602339217904, -190.17466333097812, -572.9015942535364, -939.3096376841833, -768.9073144663665, -952.7011419566776, -141.51402841261313, -1069.1597878463822, -845.3203259152979, -1237.517059042358, -1215.5155038966504, -125.00981319097815, -1046.191342470568, -984.0699740090851, -169.98863083499634, -216.8833760265369, -424.4177012602018, -134.4740503256538, -742.0641120458109, -1100.368690568698, -925.3380262433386, -1292.8485356683461, -486.17317101194834, -904.0873404315239, -1200.9123504794409, -18.230812459026428, -671.2256550575578, -729.4721874356625, -1171.030263060842, -97.69148598375054, -947.5065462182394, -85.57639989303979, -1049.6421284943428, -1228.6191115475963, -84.13197896300684, -23.491080048278096, -22.828351482184292, -35.45989586858964, -1306.6427982191642, -1035.8927733713294, -747.6264292131626, -96.70432516319885, -809.5037765831668, -1219.1772693208334, -545.6145019675788, -901.3413429279786, -809.5469435526204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562525648910855, "mean_inference_ms": 1.6948848707170618, "mean_action_processing_ms": 0.27987646484962914, "mean_env_wait_ms": 3.039849640984463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012122392654418945, "StateBufferConnector_ms": 0.008043289184570312, "ViewRequirementAgentConnector_ms": 0.19489145278930664}, "num_episodes": 29, "episode_return_max": -5.593946142172329, "episode_return_min": -1328.3526460869675, "episode_return_mean": -676.3829995490203, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.4450747463975, "num_env_steps_trained_throughput_per_sec": 343.4450747463975, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13115.67, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13115.588, "sample_time_ms": 1051.569, "learn_time_ms": 11995.92, "learn_throughput": 333.447, "synch_weights_time_ms": 67.152}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00003", "date": "2024-08-03_10-36-00", "timestamp": 1722661560, "time_this_iter_s": 11.660703659057617, "time_total_s": 299.187381029129, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a290751f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 299.187381029129, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 14.5, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 175.78837822079657, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.8969103592137495, "policy_loss": -0.014513744544819929, "vf_loss": 5.906234346826872, "vf_explained_var": 0.9452638330558936, "kl": 0.017763913095101693, "entropy": 1.3941731040055554, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -18.230812459026428, "episode_reward_min": -1309.531193564732, "episode_reward_mean": -683.8802468140171, "episode_len_mean": 128.89, "episode_media": {}, "episodes_timesteps_total": 12889, "policy_reward_min": {"policy_0": -1309.531193564732}, "policy_reward_max": {"policy_0": -18.230812459026428}, "policy_reward_mean": {"policy_0": -683.8802468140171}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-363.6626516239654, -1303.9077613509837, -546.8272399584374, -856.5091206188938, -617.7062103062908, -789.1024735357004, -246.44071317205476, -928.6109715240383, -669.5841554812986, -1309.531193564732, -18.80208932904717, -33.02834497099844, -969.3161146103475, -850.9228652709859, -177.70034561144763, -387.66255836267686, -956.426559973835, -1101.9817434257395, -448.95073561975266, -1040.0305207790443, -83.23107842947807, -711.6936974921849, -93.97602339217904, -190.17466333097812, -572.9015942535364, -939.3096376841833, -768.9073144663665, -952.7011419566776, -141.51402841261313, -1069.1597878463822, -845.3203259152979, -1237.517059042358, -1215.5155038966504, -125.00981319097815, -1046.191342470568, -984.0699740090851, -169.98863083499634, -216.8833760265369, -424.4177012602018, -134.4740503256538, -742.0641120458109, -1100.368690568698, -925.3380262433386, -1292.8485356683461, -486.17317101194834, -904.0873404315239, -1200.9123504794409, -18.230812459026428, -671.2256550575578, -729.4721874356625, -1171.030263060842, -97.69148598375054, -947.5065462182394, -85.57639989303979, -1049.6421284943428, -1228.6191115475963, -84.13197896300684, -23.491080048278096, -22.828351482184292, -35.45989586858964, -1306.6427982191642, -1035.8927733713294, -747.6264292131626, -96.70432516319885, -809.5037765831668, -1219.1772693208334, -545.6145019675788, -901.3413429279786, -809.5469435526204, -780.3928972363258, -550.6417234614137, -927.4202923204112, -803.7305483402656, -135.22108937958336, -411.15880716060616, -623.8724354332036, -846.2198472344074, -862.2915233315964, -1168.0591478009649, -733.6863022171657, -931.1225869690543, -793.5437959884108, -167.46201560255827, -87.13422477756671, -891.7457896808384, -1147.4655531495607, -356.8466291394351, -1064.1366416974834, -930.9981388874504, -641.1123006314355, -725.8136284955131, -475.76187096171844, -485.53869325368015, -913.4254716635028, -839.9651245146902, -1113.5628774858958, -1013.6470000889328, -981.312703526526, -806.6140230710298, -349.7116012930696], "episode_lengths": [102, 150, 150, 150, 150, 150, 94, 150, 150, 150, 43, 51, 150, 150, 85, 104, 150, 150, 150, 150, 73, 150, 76, 90, 150, 150, 150, 150, 87, 150, 150, 150, 150, 61, 150, 150, 89, 105, 124, 71, 150, 150, 150, 150, 150, 150, 150, 38, 150, 150, 150, 80, 150, 58, 150, 150, 70, 56, 47, 65, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 138, 150, 150, 150, 150, 150, 150, 150, 87, 46, 150, 150, 96, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 92], "policy_policy_0_reward": [-363.6626516239654, -1303.9077613509837, -546.8272399584374, -856.5091206188938, -617.7062103062908, -789.1024735357004, -246.44071317205476, -928.6109715240383, -669.5841554812986, -1309.531193564732, -18.80208932904717, -33.02834497099844, -969.3161146103475, -850.9228652709859, -177.70034561144763, -387.66255836267686, -956.426559973835, -1101.9817434257395, -448.95073561975266, -1040.0305207790443, -83.23107842947807, -711.6936974921849, -93.97602339217904, -190.17466333097812, -572.9015942535364, -939.3096376841833, -768.9073144663665, -952.7011419566776, -141.51402841261313, -1069.1597878463822, -845.3203259152979, -1237.517059042358, -1215.5155038966504, -125.00981319097815, -1046.191342470568, -984.0699740090851, -169.98863083499634, -216.8833760265369, -424.4177012602018, -134.4740503256538, -742.0641120458109, -1100.368690568698, -925.3380262433386, -1292.8485356683461, -486.17317101194834, -904.0873404315239, -1200.9123504794409, -18.230812459026428, -671.2256550575578, -729.4721874356625, -1171.030263060842, -97.69148598375054, -947.5065462182394, -85.57639989303979, -1049.6421284943428, -1228.6191115475963, -84.13197896300684, -23.491080048278096, -22.828351482184292, -35.45989586858964, -1306.6427982191642, -1035.8927733713294, -747.6264292131626, -96.70432516319885, -809.5037765831668, -1219.1772693208334, -545.6145019675788, -901.3413429279786, -809.5469435526204, -780.3928972363258, -550.6417234614137, -927.4202923204112, -803.7305483402656, -135.22108937958336, -411.15880716060616, -623.8724354332036, -846.2198472344074, -862.2915233315964, -1168.0591478009649, -733.6863022171657, -931.1225869690543, -793.5437959884108, -167.46201560255827, -87.13422477756671, -891.7457896808384, -1147.4655531495607, -356.8466291394351, -1064.1366416974834, -930.9981388874504, -641.1123006314355, -725.8136284955131, -475.76187096171844, -485.53869325368015, -913.4254716635028, -839.9651245146902, -1113.5628774858958, -1013.6470000889328, -981.312703526526, -806.6140230710298, -349.7116012930696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5563482724193385, "mean_inference_ms": 1.6947805199441786, "mean_action_processing_ms": 0.27962990486919087, "mean_env_wait_ms": 3.042136427303088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011958599090576172, "StateBufferConnector_ms": 0.008049249649047852, "ViewRequirementAgentConnector_ms": 0.19458723068237305}, "num_episodes": 31, "episode_return_max": -18.230812459026428, "episode_return_min": -1309.531193564732, "episode_return_mean": -683.8802468140171, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 439.8848820589085, "num_env_steps_trained_throughput_per_sec": 439.8848820589085, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12724.888, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12724.809, "sample_time_ms": 1058.223, "learn_time_ms": 11597.959, "learn_throughput": 344.888, "synch_weights_time_ms": 67.668}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00003", "date": "2024-08-03_10-36-09", "timestamp": 1722661569, "time_this_iter_s": 9.106435060501099, "time_total_s": 308.2938160896301, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0ecb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.2938160896301, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 16.146153846153844, "ram_util_percent": 27.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.8161722322305, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.172286448379357, "policy_loss": -0.009057059296173975, "vf_loss": 6.175321267048518, "vf_explained_var": 0.9556603592510025, "kl": 0.020475352937501155, "entropy": 1.2039764544616143, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": 4.308853116417973, "episode_reward_min": -1306.6427982191642, "episode_reward_mean": -683.3713528380545, "episode_len_mean": 128.85, "episode_media": {}, "episodes_timesteps_total": 12885, "policy_reward_min": {"policy_0": -1306.6427982191642}, "policy_reward_max": {"policy_0": 4.308853116417973}, "policy_reward_mean": {"policy_0": -683.3713528380545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-845.3203259152979, -1237.517059042358, -1215.5155038966504, -125.00981319097815, -1046.191342470568, -984.0699740090851, -169.98863083499634, -216.8833760265369, -424.4177012602018, -134.4740503256538, -742.0641120458109, -1100.368690568698, -925.3380262433386, -1292.8485356683461, -486.17317101194834, -904.0873404315239, -1200.9123504794409, -18.230812459026428, -671.2256550575578, -729.4721874356625, -1171.030263060842, -97.69148598375054, -947.5065462182394, -85.57639989303979, -1049.6421284943428, -1228.6191115475963, -84.13197896300684, -23.491080048278096, -22.828351482184292, -35.45989586858964, -1306.6427982191642, -1035.8927733713294, -747.6264292131626, -96.70432516319885, -809.5037765831668, -1219.1772693208334, -545.6145019675788, -901.3413429279786, -809.5469435526204, -780.3928972363258, -550.6417234614137, -927.4202923204112, -803.7305483402656, -135.22108937958336, -411.15880716060616, -623.8724354332036, -846.2198472344074, -862.2915233315964, -1168.0591478009649, -733.6863022171657, -931.1225869690543, -793.5437959884108, -167.46201560255827, -87.13422477756671, -891.7457896808384, -1147.4655531495607, -356.8466291394351, -1064.1366416974834, -930.9981388874504, -641.1123006314355, -725.8136284955131, -475.76187096171844, -485.53869325368015, -913.4254716635028, -839.9651245146902, -1113.5628774858958, -1013.6470000889328, -981.312703526526, -806.6140230710298, -349.7116012930696, -934.5089816776459, -532.2781097567738, -973.8428280354367, -300.82185899160953, 4.308853116417973, -569.0429450225837, -156.11309605832602, -30.15278149801484, -388.4221211113942, -1088.7733620981735, -968.9321408981987, -846.2016224767979, -854.620644485444, -790.2537933847442, -982.3825274383405, -158.61548389079638, -891.8055365347693, -921.4452982994719, -612.9772357825746, -188.96965083533252, -844.9429268928636, -672.2063659823556, -1107.5592133189152, -624.3749023190546, -1257.4836182665197, -349.87763535648935, -570.2571281621002, -290.2410369823883, -108.79129407053192, -1077.7986522473302], "episode_lengths": [150, 150, 150, 61, 150, 150, 89, 105, 124, 71, 150, 150, 150, 150, 150, 150, 150, 38, 150, 150, 150, 80, 150, 58, 150, 150, 70, 56, 47, 65, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 138, 150, 150, 150, 150, 150, 150, 150, 87, 46, 150, 150, 96, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 90, 38, 150, 76, 38, 102, 150, 150, 150, 150, 150, 150, 88, 150, 150, 149, 70, 150, 150, 150, 150, 150, 107, 150, 123, 70, 150], "policy_policy_0_reward": [-845.3203259152979, -1237.517059042358, -1215.5155038966504, -125.00981319097815, -1046.191342470568, -984.0699740090851, -169.98863083499634, -216.8833760265369, -424.4177012602018, -134.4740503256538, -742.0641120458109, -1100.368690568698, -925.3380262433386, -1292.8485356683461, -486.17317101194834, -904.0873404315239, -1200.9123504794409, -18.230812459026428, -671.2256550575578, -729.4721874356625, -1171.030263060842, -97.69148598375054, -947.5065462182394, -85.57639989303979, -1049.6421284943428, -1228.6191115475963, -84.13197896300684, -23.491080048278096, -22.828351482184292, -35.45989586858964, -1306.6427982191642, -1035.8927733713294, -747.6264292131626, -96.70432516319885, -809.5037765831668, -1219.1772693208334, -545.6145019675788, -901.3413429279786, -809.5469435526204, -780.3928972363258, -550.6417234614137, -927.4202923204112, -803.7305483402656, -135.22108937958336, -411.15880716060616, -623.8724354332036, -846.2198472344074, -862.2915233315964, -1168.0591478009649, -733.6863022171657, -931.1225869690543, -793.5437959884108, -167.46201560255827, -87.13422477756671, -891.7457896808384, -1147.4655531495607, -356.8466291394351, -1064.1366416974834, -930.9981388874504, -641.1123006314355, -725.8136284955131, -475.76187096171844, -485.53869325368015, -913.4254716635028, -839.9651245146902, -1113.5628774858958, -1013.6470000889328, -981.312703526526, -806.6140230710298, -349.7116012930696, -934.5089816776459, -532.2781097567738, -973.8428280354367, -300.82185899160953, 4.308853116417973, -569.0429450225837, -156.11309605832602, -30.15278149801484, -388.4221211113942, -1088.7733620981735, -968.9321408981987, -846.2016224767979, -854.620644485444, -790.2537933847442, -982.3825274383405, -158.61548389079638, -891.8055365347693, -921.4452982994719, -612.9772357825746, -188.96965083533252, -844.9429268928636, -672.2063659823556, -1107.5592133189152, -624.3749023190546, -1257.4836182665197, -349.87763535648935, -570.2571281621002, -290.2410369823883, -108.79129407053192, -1077.7986522473302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5561455298843078, "mean_inference_ms": 1.694290139535025, "mean_action_processing_ms": 0.2794572154118008, "mean_env_wait_ms": 3.04091503165355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01208806037902832, "StateBufferConnector_ms": 0.008088827133178711, "ViewRequirementAgentConnector_ms": 0.19567441940307617}, "num_episodes": 30, "episode_return_max": 4.308853116417973, "episode_return_min": -1306.6427982191642, "episode_return_mean": -683.3713528380545, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.0182600561178, "num_env_steps_trained_throughput_per_sec": 301.0182600561178, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12717.313, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12717.233, "sample_time_ms": 1059.237, "learn_time_ms": 11587.787, "learn_throughput": 345.191, "synch_weights_time_ms": 69.249}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00003", "date": "2024-08-03_10-36-22", "timestamp": 1722661582, "time_this_iter_s": 13.302591800689697, "time_total_s": 321.5964078903198, "pid": 510353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf57520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.5964078903198, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.88421052631579, "ram_util_percent": 27.7}}
