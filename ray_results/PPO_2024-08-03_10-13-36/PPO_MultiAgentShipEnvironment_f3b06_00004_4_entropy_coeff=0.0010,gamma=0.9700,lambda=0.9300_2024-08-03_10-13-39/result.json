{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8827641804081698, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.717847268780073, "policy_loss": -0.006922037574501398, "vf_loss": 9.724654229482015, "vf_explained_var": -0.002101520448923111, "kl": 0.007632394369996594, "entropy": 1.4113812169680993, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -60.186546568358104, "episode_reward_min": -1327.118262960842, "episode_reward_mean": -877.7691340956104, "episode_len_mean": 144.91304347826087, "episode_media": {}, "episodes_timesteps_total": 3333, "policy_reward_min": {"policy_0": -1327.118262960842}, "policy_reward_max": {"policy_0": -60.186546568358104}, "policy_reward_mean": {"policy_0": -877.7691340956104}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.186546568358104, -818.0114816203802, -1104.7123818332975, -854.4412510234025, -799.795746296869, -928.2074707213507, -640.9736290483486, -580.0952324562438, -726.8025039381832, -556.2943457825036, -937.082990478543, -1149.3969252902862, -1327.118262960842, -1015.0592163458967, -1094.3014919190016, -1097.4509616458906, -1029.5918988187968, -1071.1286501162833, -535.1044288738152, -1128.8871077633867, -402.49459933723733, -1182.2271245296345, -1149.3258368304862], "episode_lengths": [68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150], "policy_policy_0_reward": [-60.186546568358104, -818.0114816203802, -1104.7123818332975, -854.4412510234025, -799.795746296869, -928.2074707213507, -640.9736290483486, -580.0952324562438, -726.8025039381832, -556.2943457825036, -937.082990478543, -1149.3969252902862, -1327.118262960842, -1015.0592163458967, -1094.3014919190016, -1097.4509616458906, -1029.5918988187968, -1071.1286501162833, -535.1044288738152, -1128.8871077633867, -402.49459933723733, -1182.2271245296345, -1149.3258368304862]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5671702332046256, "mean_inference_ms": 1.6678566383568252, "mean_action_processing_ms": 0.27883386343000555, "mean_env_wait_ms": 2.9990480386479783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010709140611731487, "StateBufferConnector_ms": 0.007802507151728091, "ViewRequirementAgentConnector_ms": 0.17406940460205078}, "num_episodes": 23, "episode_return_max": -60.186546568358104, "episode_return_min": -1327.118262960842, "episode_return_mean": -877.7691340956104, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.49965492441254, "num_env_steps_trained_throughput_per_sec": 303.49965492441254, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13179.597, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13179.524, "sample_time_ms": 1030.02, "learn_time_ms": 12070.464, "learn_throughput": 331.387, "synch_weights_time_ms": 78.184}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00004", "date": "2024-08-03_10-36-53", "timestamp": 1722661613, "time_this_iter_s": 13.191930055618286, "time_total_s": 13.191930055618286, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010b490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.191930055618286, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.694736842105264, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2776206172071398, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.571765421827633, "policy_loss": -0.003945549735605406, "vf_loss": 9.57508785823981, "vf_explained_var": 0.07506863741825025, "kl": 0.010047515622045469, "entropy": 1.3863400117804607, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -22.374940541697583, "episode_reward_min": -1327.118262960842, "episode_reward_mean": -773.6471748243989, "episode_len_mean": 141.31914893617022, "episode_media": {}, "episodes_timesteps_total": 6642, "policy_reward_min": {"policy_0": -1327.118262960842}, "policy_reward_max": {"policy_0": -22.374940541697583}, "policy_reward_mean": {"policy_0": -773.6471748243989}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.186546568358104, -818.0114816203802, -1104.7123818332975, -854.4412510234025, -799.795746296869, -928.2074707213507, -640.9736290483486, -580.0952324562438, -726.8025039381832, -556.2943457825036, -937.082990478543, -1149.3969252902862, -1327.118262960842, -1015.0592163458967, -1094.3014919190016, -1097.4509616458906, -1029.5918988187968, -1071.1286501162833, -535.1044288738152, -1128.8871077633867, -402.49459933723733, -1182.2271245296345, -1149.3258368304862, -598.3076150652626, -1088.6084406557154, -781.6776481242825, -746.0806259575571, -654.9568158422325, -988.4361204428429, -1020.5551200651936, -624.3326234401864, -304.5917761248794, -356.8418981734093, -80.88647040971846, -628.1048586237049, -982.5158800198379, -577.2089234720701, -1007.2446747764434, -1165.5955971259443, -867.9584738352876, -559.1600971756783, -22.374940541697583, -1081.1399135190727, -755.0645197614225, -288.3732821882544, -473.9037846699652, -518.8070325370567], "episode_lengths": [68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 142, 150, 150, 150, 137, 150, 150, 150, 115, 137, 65, 150, 150, 150, 150, 150, 150, 150, 46, 150, 150, 138, 129, 150], "policy_policy_0_reward": [-60.186546568358104, -818.0114816203802, -1104.7123818332975, -854.4412510234025, -799.795746296869, -928.2074707213507, -640.9736290483486, -580.0952324562438, -726.8025039381832, -556.2943457825036, -937.082990478543, -1149.3969252902862, -1327.118262960842, -1015.0592163458967, -1094.3014919190016, -1097.4509616458906, -1029.5918988187968, -1071.1286501162833, -535.1044288738152, -1128.8871077633867, -402.49459933723733, -1182.2271245296345, -1149.3258368304862, -598.3076150652626, -1088.6084406557154, -781.6776481242825, -746.0806259575571, -654.9568158422325, -988.4361204428429, -1020.5551200651936, -624.3326234401864, -304.5917761248794, -356.8418981734093, -80.88647040971846, -628.1048586237049, -982.5158800198379, -577.2089234720701, -1007.2446747764434, -1165.5955971259443, -867.9584738352876, -559.1600971756783, -22.374940541697583, -1081.1399135190727, -755.0645197614225, -288.3732821882544, -473.9037846699652, -518.8070325370567]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5636181516495002, "mean_inference_ms": 1.6755520173806424, "mean_action_processing_ms": 0.28040074103801915, "mean_env_wait_ms": 2.988182228814253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013374775014025099, "StateBufferConnector_ms": 0.007935280495501578, "ViewRequirementAgentConnector_ms": 0.17652866688180477}, "num_episodes": 24, "episode_return_max": -22.374940541697583, "episode_return_min": -1327.118262960842, "episode_return_mean": -773.6471748243989, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 375.11122451277026, "num_env_steps_trained_throughput_per_sec": 375.11122451277026, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 11921.558, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11921.486, "sample_time_ms": 1026.462, "learn_time_ms": 10832.263, "learn_throughput": 369.267, "synch_weights_time_ms": 61.995}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00004", "date": "2024-08-03_10-37-04", "timestamp": 1722661624, "time_this_iter_s": 10.675161838531494, "time_total_s": 23.86709189414978, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0e950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23.86709189414978, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 14.45625, "ram_util_percent": 27.518749999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.393982530074815, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.609999281167983, "policy_loss": -0.006868276619449413, "vf_loss": 9.615948286652564, "vf_explained_var": 0.11857054810971021, "kl": 0.011783157006357218, "entropy": 1.4373345254609982, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -22.374940541697583, "episode_reward_min": -1327.118262960842, "episode_reward_mean": -739.5700328390134, "episode_len_mean": 138.45945945945945, "episode_media": {}, "episodes_timesteps_total": 10246, "policy_reward_min": {"policy_0": -1327.118262960842}, "policy_reward_max": {"policy_0": -22.374940541697583}, "policy_reward_mean": {"policy_0": -739.5700328390134}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.186546568358104, -818.0114816203802, -1104.7123818332975, -854.4412510234025, -799.795746296869, -928.2074707213507, -640.9736290483486, -580.0952324562438, -726.8025039381832, -556.2943457825036, -937.082990478543, -1149.3969252902862, -1327.118262960842, -1015.0592163458967, -1094.3014919190016, -1097.4509616458906, -1029.5918988187968, -1071.1286501162833, -535.1044288738152, -1128.8871077633867, -402.49459933723733, -1182.2271245296345, -1149.3258368304862, -598.3076150652626, -1088.6084406557154, -781.6776481242825, -746.0806259575571, -654.9568158422325, -988.4361204428429, -1020.5551200651936, -624.3326234401864, -304.5917761248794, -356.8418981734093, -80.88647040971846, -628.1048586237049, -982.5158800198379, -577.2089234720701, -1007.2446747764434, -1165.5955971259443, -867.9584738352876, -559.1600971756783, -22.374940541697583, -1081.1399135190727, -755.0645197614225, -288.3732821882544, -473.9037846699652, -518.8070325370567, -1012.7839496875354, -799.3426509871774, -271.7104564189571, -530.5721620936711, -190.40103408920172, -843.5384924813803, -848.8086872264262, -92.23791230059342, -846.7377105878649, -251.44335589236948, -1083.9158488843239, -188.864131114053, -859.729791940896, -824.4288423352832, -510.21199727636093, -914.1915375878133, -84.68169822611404, -909.5756166431462, -739.3018416615048, -446.9471800247096, -742.6809471065015, -848.5460132858396, -961.0431170705274, -1258.722097481516, -635.4865023957341, -797.1040973674187, -873.7575411733193], "episode_lengths": [68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 142, 150, 150, 150, 137, 150, 150, 150, 115, 137, 65, 150, 150, 150, 150, 150, 150, 150, 46, 150, 150, 138, 129, 150, 150, 150, 100, 150, 104, 150, 150, 51, 150, 77, 150, 87, 150, 150, 150, 150, 61, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-60.186546568358104, -818.0114816203802, -1104.7123818332975, -854.4412510234025, -799.795746296869, -928.2074707213507, -640.9736290483486, -580.0952324562438, -726.8025039381832, -556.2943457825036, -937.082990478543, -1149.3969252902862, -1327.118262960842, -1015.0592163458967, -1094.3014919190016, -1097.4509616458906, -1029.5918988187968, -1071.1286501162833, -535.1044288738152, -1128.8871077633867, -402.49459933723733, -1182.2271245296345, -1149.3258368304862, -598.3076150652626, -1088.6084406557154, -781.6776481242825, -746.0806259575571, -654.9568158422325, -988.4361204428429, -1020.5551200651936, -624.3326234401864, -304.5917761248794, -356.8418981734093, -80.88647040971846, -628.1048586237049, -982.5158800198379, -577.2089234720701, -1007.2446747764434, -1165.5955971259443, -867.9584738352876, -559.1600971756783, -22.374940541697583, -1081.1399135190727, -755.0645197614225, -288.3732821882544, -473.9037846699652, -518.8070325370567, -1012.7839496875354, -799.3426509871774, -271.7104564189571, -530.5721620936711, -190.40103408920172, -843.5384924813803, -848.8086872264262, -92.23791230059342, -846.7377105878649, -251.44335589236948, -1083.9158488843239, -188.864131114053, -859.729791940896, -824.4288423352832, -510.21199727636093, -914.1915375878133, -84.68169822611404, -909.5756166431462, -739.3018416615048, -446.9471800247096, -742.6809471065015, -848.5460132858396, -961.0431170705274, -1258.722097481516, -635.4865023957341, -797.1040973674187, -873.7575411733193]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621167199831089, "mean_inference_ms": 1.677139913505641, "mean_action_processing_ms": 0.2808411309443792, "mean_env_wait_ms": 2.985014430768287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013309233897441142, "StateBufferConnector_ms": 0.008214808799125053, "ViewRequirementAgentConnector_ms": 0.18334420951637062}, "num_episodes": 27, "episode_return_max": -22.374940541697583, "episode_return_min": -1327.118262960842, "episode_return_mean": -739.5700328390134, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 547.6553052204619, "num_env_steps_trained_throughput_per_sec": 547.6553052204619, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 10382.33, "restore_workers_time_ms": 0.027, "training_step_time_ms": 10382.262, "sample_time_ms": 1018.802, "learn_time_ms": 9306.17, "learn_throughput": 429.822, "synch_weights_time_ms": 56.555}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00004", "date": "2024-08-03_10-37-11", "timestamp": 1722661631, "time_this_iter_s": 7.314861059188843, "time_total_s": 31.181952953338623, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010ba30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 31.181952953338623, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.869999999999997, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0988841231601936, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.350346075991789, "policy_loss": -0.009222520498830515, "vf_loss": 9.358569008111953, "vf_explained_var": 0.2706755535056194, "kl": 0.012054035588380429, "entropy": 1.4112347370634477, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -22.374940541697583, "episode_reward_min": -1327.118262960842, "episode_reward_mean": -718.1365960564156, "episode_len_mean": 137.93, "episode_media": {}, "episodes_timesteps_total": 13793, "policy_reward_min": {"policy_0": -1327.118262960842}, "policy_reward_max": {"policy_0": -22.374940541697583}, "policy_reward_mean": {"policy_0": -718.1365960564156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799.795746296869, -928.2074707213507, -640.9736290483486, -580.0952324562438, -726.8025039381832, -556.2943457825036, -937.082990478543, -1149.3969252902862, -1327.118262960842, -1015.0592163458967, -1094.3014919190016, -1097.4509616458906, -1029.5918988187968, -1071.1286501162833, -535.1044288738152, -1128.8871077633867, -402.49459933723733, -1182.2271245296345, -1149.3258368304862, -598.3076150652626, -1088.6084406557154, -781.6776481242825, -746.0806259575571, -654.9568158422325, -988.4361204428429, -1020.5551200651936, -624.3326234401864, -304.5917761248794, -356.8418981734093, -80.88647040971846, -628.1048586237049, -982.5158800198379, -577.2089234720701, -1007.2446747764434, -1165.5955971259443, -867.9584738352876, -559.1600971756783, -22.374940541697583, -1081.1399135190727, -755.0645197614225, -288.3732821882544, -473.9037846699652, -518.8070325370567, -1012.7839496875354, -799.3426509871774, -271.7104564189571, -530.5721620936711, -190.40103408920172, -843.5384924813803, -848.8086872264262, -92.23791230059342, -846.7377105878649, -251.44335589236948, -1083.9158488843239, -188.864131114053, -859.729791940896, -824.4288423352832, -510.21199727636093, -914.1915375878133, -84.68169822611404, -909.5756166431462, -739.3018416615048, -446.9471800247096, -742.6809471065015, -848.5460132858396, -961.0431170705274, -1258.722097481516, -635.4865023957341, -797.1040973674187, -873.7575411733193, -955.801591073689, -636.5186967289104, -1036.8351892939181, -543.112113711886, -307.9264176598434, -198.6767762258087, -482.9749722192554, -790.1460031617355, -874.9140436605715, -955.9283312038951, -564.8422932369436, -1016.9447943786308, -596.0063935201604, -104.87213390467537, -224.813246070012, -833.4552927325261, -91.73057813132851, -573.463153499042, -1013.8354587091668, -833.890001235284, -120.29941878827934, -1216.9560984461868, -856.9778931192089, -772.3252039489951, -321.5458048499791, -741.0758526930102, -653.9010384484139, -616.3698505570053, -883.2784958027622, -1103.411699588893], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 142, 150, 150, 150, 137, 150, 150, 150, 115, 137, 65, 150, 150, 150, 150, 150, 150, 150, 46, 150, 150, 138, 129, 150, 150, 150, 100, 150, 104, 150, 150, 51, 150, 77, 150, 87, 150, 150, 150, 150, 61, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 142, 85, 150, 150, 150, 150, 120, 150, 150, 92, 92, 150, 94, 150, 150, 150, 76, 150, 150, 150, 85, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-799.795746296869, -928.2074707213507, -640.9736290483486, -580.0952324562438, -726.8025039381832, -556.2943457825036, -937.082990478543, -1149.3969252902862, -1327.118262960842, -1015.0592163458967, -1094.3014919190016, -1097.4509616458906, -1029.5918988187968, -1071.1286501162833, -535.1044288738152, -1128.8871077633867, -402.49459933723733, -1182.2271245296345, -1149.3258368304862, -598.3076150652626, -1088.6084406557154, -781.6776481242825, -746.0806259575571, -654.9568158422325, -988.4361204428429, -1020.5551200651936, -624.3326234401864, -304.5917761248794, -356.8418981734093, -80.88647040971846, -628.1048586237049, -982.5158800198379, -577.2089234720701, -1007.2446747764434, -1165.5955971259443, -867.9584738352876, -559.1600971756783, -22.374940541697583, -1081.1399135190727, -755.0645197614225, -288.3732821882544, -473.9037846699652, -518.8070325370567, -1012.7839496875354, -799.3426509871774, -271.7104564189571, -530.5721620936711, -190.40103408920172, -843.5384924813803, -848.8086872264262, -92.23791230059342, -846.7377105878649, -251.44335589236948, -1083.9158488843239, -188.864131114053, -859.729791940896, -824.4288423352832, -510.21199727636093, -914.1915375878133, -84.68169822611404, -909.5756166431462, -739.3018416615048, -446.9471800247096, -742.6809471065015, -848.5460132858396, -961.0431170705274, -1258.722097481516, -635.4865023957341, -797.1040973674187, -873.7575411733193, -955.801591073689, -636.5186967289104, -1036.8351892939181, -543.112113711886, -307.9264176598434, -198.6767762258087, -482.9749722192554, -790.1460031617355, -874.9140436605715, -955.9283312038951, -564.8422932369436, -1016.9447943786308, -596.0063935201604, -104.87213390467537, -224.813246070012, -833.4552927325261, -91.73057813132851, -573.463153499042, -1013.8354587091668, -833.890001235284, -120.29941878827934, -1216.9560984461868, -856.9778931192089, -772.3252039489951, -321.5458048499791, -741.0758526930102, -653.9010384484139, -616.3698505570053, -883.2784958027622, -1103.411699588893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5594350692785334, "mean_inference_ms": 1.674487166966062, "mean_action_processing_ms": 0.28073251044055925, "mean_env_wait_ms": 2.9779477345227594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013579368591308594, "StateBufferConnector_ms": 0.008302927017211914, "ViewRequirementAgentConnector_ms": 0.18465328216552734}, "num_episodes": 30, "episode_return_max": -22.374940541697583, "episode_return_min": -1327.118262960842, "episode_return_mean": -718.1365960564156, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.1339385938334, "num_env_steps_trained_throughput_per_sec": 304.1339385938334, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 11074.776, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11074.71, "sample_time_ms": 1016.477, "learn_time_ms": 9998.588, "learn_throughput": 400.056, "synch_weights_time_ms": 58.903}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00004", "date": "2024-08-03_10-37-24", "timestamp": 1722661644, "time_this_iter_s": 13.163400173187256, "time_total_s": 44.34535312652588, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a290752c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 44.34535312652588, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.478947368421053, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.474486210135122, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.073415009180705, "policy_loss": -0.009560845942178275, "vf_loss": 9.081653455893198, "vf_explained_var": 0.2587238630279899, "kl": 0.013724417303880429, "entropy": 1.4225085128098727, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -1.2459696378432, "episode_reward_min": -1258.722097481516, "episode_reward_mean": -647.2868578530572, "episode_len_mean": 132.88, "episode_media": {}, "episodes_timesteps_total": 13288, "policy_reward_min": {"policy_0": -1258.722097481516}, "policy_reward_max": {"policy_0": -1.2459696378432}, "policy_reward_mean": {"policy_0": -647.2868578530572}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-80.88647040971846, -628.1048586237049, -982.5158800198379, -577.2089234720701, -1007.2446747764434, -1165.5955971259443, -867.9584738352876, -559.1600971756783, -22.374940541697583, -1081.1399135190727, -755.0645197614225, -288.3732821882544, -473.9037846699652, -518.8070325370567, -1012.7839496875354, -799.3426509871774, -271.7104564189571, -530.5721620936711, -190.40103408920172, -843.5384924813803, -848.8086872264262, -92.23791230059342, -846.7377105878649, -251.44335589236948, -1083.9158488843239, -188.864131114053, -859.729791940896, -824.4288423352832, -510.21199727636093, -914.1915375878133, -84.68169822611404, -909.5756166431462, -739.3018416615048, -446.9471800247096, -742.6809471065015, -848.5460132858396, -961.0431170705274, -1258.722097481516, -635.4865023957341, -797.1040973674187, -873.7575411733193, -955.801591073689, -636.5186967289104, -1036.8351892939181, -543.112113711886, -307.9264176598434, -198.6767762258087, -482.9749722192554, -790.1460031617355, -874.9140436605715, -955.9283312038951, -564.8422932369436, -1016.9447943786308, -596.0063935201604, -104.87213390467537, -224.813246070012, -833.4552927325261, -91.73057813132851, -573.463153499042, -1013.8354587091668, -833.890001235284, -120.29941878827934, -1216.9560984461868, -856.9778931192089, -772.3252039489951, -321.5458048499791, -741.0758526930102, -653.9010384484139, -616.3698505570053, -883.2784958027622, -1103.411699588893, -908.7385479226202, -2.9949827565857645, -777.5288375175148, -170.39192736125665, -46.95320447834025, -972.6271466077662, -125.61707086565949, -668.159167253667, -751.8446657723865, -467.0242292627543, -121.35555629008127, -730.4920210789396, -458.39527581244977, -601.1873114408171, -936.8282902765121, -1014.8881185512412, -1.2459696378432, -559.0619643269632, -1113.8510356917743, -879.8858268612578, -1120.2383726807266, -611.4059523058659, -781.4788919597314, -1033.2839741694268, -601.5016241308539, -679.6744407600349, -469.11148807008146, -466.95666968179444, -358.0307231843623], "episode_lengths": [65, 150, 150, 150, 150, 150, 150, 150, 46, 150, 150, 138, 129, 150, 150, 150, 100, 150, 104, 150, 150, 51, 150, 77, 150, 87, 150, 150, 150, 150, 61, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 142, 85, 150, 150, 150, 150, 120, 150, 150, 92, 92, 150, 94, 150, 150, 150, 76, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 42, 150, 92, 64, 150, 70, 150, 145, 150, 74, 150, 150, 150, 150, 150, 47, 122, 150, 150, 150, 150, 150, 150, 150, 150, 123, 125, 137], "policy_policy_0_reward": [-80.88647040971846, -628.1048586237049, -982.5158800198379, -577.2089234720701, -1007.2446747764434, -1165.5955971259443, -867.9584738352876, -559.1600971756783, -22.374940541697583, -1081.1399135190727, -755.0645197614225, -288.3732821882544, -473.9037846699652, -518.8070325370567, -1012.7839496875354, -799.3426509871774, -271.7104564189571, -530.5721620936711, -190.40103408920172, -843.5384924813803, -848.8086872264262, -92.23791230059342, -846.7377105878649, -251.44335589236948, -1083.9158488843239, -188.864131114053, -859.729791940896, -824.4288423352832, -510.21199727636093, -914.1915375878133, -84.68169822611404, -909.5756166431462, -739.3018416615048, -446.9471800247096, -742.6809471065015, -848.5460132858396, -961.0431170705274, -1258.722097481516, -635.4865023957341, -797.1040973674187, -873.7575411733193, -955.801591073689, -636.5186967289104, -1036.8351892939181, -543.112113711886, -307.9264176598434, -198.6767762258087, -482.9749722192554, -790.1460031617355, -874.9140436605715, -955.9283312038951, -564.8422932369436, -1016.9447943786308, -596.0063935201604, -104.87213390467537, -224.813246070012, -833.4552927325261, -91.73057813132851, -573.463153499042, -1013.8354587091668, -833.890001235284, -120.29941878827934, -1216.9560984461868, -856.9778931192089, -772.3252039489951, -321.5458048499791, -741.0758526930102, -653.9010384484139, -616.3698505570053, -883.2784958027622, -1103.411699588893, -908.7385479226202, -2.9949827565857645, -777.5288375175148, -170.39192736125665, -46.95320447834025, -972.6271466077662, -125.61707086565949, -668.159167253667, -751.8446657723865, -467.0242292627543, -121.35555629008127, -730.4920210789396, -458.39527581244977, -601.1873114408171, -936.8282902765121, -1014.8881185512412, -1.2459696378432, -559.0619643269632, -1113.8510356917743, -879.8858268612578, -1120.2383726807266, -611.4059523058659, -781.4788919597314, -1033.2839741694268, -601.5016241308539, -679.6744407600349, -469.11148807008146, -466.95666968179444, -358.0307231843623]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5574213330787596, "mean_inference_ms": 1.6766327275970518, "mean_action_processing_ms": 0.2815963868814236, "mean_env_wait_ms": 2.973214789036598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013703107833862305, "StateBufferConnector_ms": 0.008570432662963867, "ViewRequirementAgentConnector_ms": 0.18933773040771484}, "num_episodes": 29, "episode_return_max": -1.2459696378432, "episode_return_min": -1258.722097481516, "episode_return_mean": -647.2868578530572, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.4649448868082, "num_env_steps_trained_throughput_per_sec": 302.4649448868082, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 11504.758, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11504.692, "sample_time_ms": 1014.753, "learn_time_ms": 10427.997, "learn_throughput": 383.583, "synch_weights_time_ms": 61.162}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00004", "date": "2024-08-03_10-37-37", "timestamp": 1722661657, "time_this_iter_s": 13.237560987472534, "time_total_s": 57.58291411399841, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0e950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 57.58291411399841, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.115789473684208, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.686212282876173, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.091218833128611, "policy_loss": -0.00998431546613574, "vf_loss": 9.099622403581938, "vf_explained_var": 0.3720897293960055, "kl": 0.015627969766167857, "entropy": 1.5448496129363776, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -1.2459696378432, "episode_reward_min": -1258.722097481516, "episode_reward_mean": -673.5977174919849, "episode_len_mean": 135.13, "episode_media": {}, "episodes_timesteps_total": 13513, "policy_reward_min": {"policy_0": -1258.722097481516}, "policy_reward_max": {"policy_0": -1.2459696378432}, "policy_reward_mean": {"policy_0": -673.5977174919849}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-909.5756166431462, -739.3018416615048, -446.9471800247096, -742.6809471065015, -848.5460132858396, -961.0431170705274, -1258.722097481516, -635.4865023957341, -797.1040973674187, -873.7575411733193, -955.801591073689, -636.5186967289104, -1036.8351892939181, -543.112113711886, -307.9264176598434, -198.6767762258087, -482.9749722192554, -790.1460031617355, -874.9140436605715, -955.9283312038951, -564.8422932369436, -1016.9447943786308, -596.0063935201604, -104.87213390467537, -224.813246070012, -833.4552927325261, -91.73057813132851, -573.463153499042, -1013.8354587091668, -833.890001235284, -120.29941878827934, -1216.9560984461868, -856.9778931192089, -772.3252039489951, -321.5458048499791, -741.0758526930102, -653.9010384484139, -616.3698505570053, -883.2784958027622, -1103.411699588893, -908.7385479226202, -2.9949827565857645, -777.5288375175148, -170.39192736125665, -46.95320447834025, -972.6271466077662, -125.61707086565949, -668.159167253667, -751.8446657723865, -467.0242292627543, -121.35555629008127, -730.4920210789396, -458.39527581244977, -601.1873114408171, -936.8282902765121, -1014.8881185512412, -1.2459696378432, -559.0619643269632, -1113.8510356917743, -879.8858268612578, -1120.2383726807266, -611.4059523058659, -781.4788919597314, -1033.2839741694268, -601.5016241308539, -679.6744407600349, -469.11148807008146, -466.95666968179444, -358.0307231843623, -875.2565944307662, -717.3388087460316, -1198.3080835855003, -1083.764678835862, -528.2447378722254, -1045.525624089074, -983.7249076744433, -594.3099815435546, -1112.1524811649124, -840.379133569225, -767.7674977045441, -1025.7713631848292, -52.43761784071941, -1027.637200400408, -462.5877912971755, -867.85165415284, -787.8678843129, -937.4017502733001, -928.645776640499, -489.5231687829193, -970.0504060865433, -818.6480150447551, -492.8686090099568, -86.79002566410847, -186.3396438344266, -95.0328824839872, -380.80598622463083, -314.87438216463954, -1033.246242282626, -80.27292106048527, -1007.5988217210486], "episode_lengths": [150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 142, 85, 150, 150, 150, 150, 120, 150, 150, 92, 92, 150, 94, 150, 150, 150, 76, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 42, 150, 92, 64, 150, 70, 150, 145, 150, 74, 150, 150, 150, 150, 150, 47, 122, 150, 150, 150, 150, 150, 150, 150, 150, 123, 125, 137, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 115, 68, 150, 113, 150, 53, 150], "policy_policy_0_reward": [-909.5756166431462, -739.3018416615048, -446.9471800247096, -742.6809471065015, -848.5460132858396, -961.0431170705274, -1258.722097481516, -635.4865023957341, -797.1040973674187, -873.7575411733193, -955.801591073689, -636.5186967289104, -1036.8351892939181, -543.112113711886, -307.9264176598434, -198.6767762258087, -482.9749722192554, -790.1460031617355, -874.9140436605715, -955.9283312038951, -564.8422932369436, -1016.9447943786308, -596.0063935201604, -104.87213390467537, -224.813246070012, -833.4552927325261, -91.73057813132851, -573.463153499042, -1013.8354587091668, -833.890001235284, -120.29941878827934, -1216.9560984461868, -856.9778931192089, -772.3252039489951, -321.5458048499791, -741.0758526930102, -653.9010384484139, -616.3698505570053, -883.2784958027622, -1103.411699588893, -908.7385479226202, -2.9949827565857645, -777.5288375175148, -170.39192736125665, -46.95320447834025, -972.6271466077662, -125.61707086565949, -668.159167253667, -751.8446657723865, -467.0242292627543, -121.35555629008127, -730.4920210789396, -458.39527581244977, -601.1873114408171, -936.8282902765121, -1014.8881185512412, -1.2459696378432, -559.0619643269632, -1113.8510356917743, -879.8858268612578, -1120.2383726807266, -611.4059523058659, -781.4788919597314, -1033.2839741694268, -601.5016241308539, -679.6744407600349, -469.11148807008146, -466.95666968179444, -358.0307231843623, -875.2565944307662, -717.3388087460316, -1198.3080835855003, -1083.764678835862, -528.2447378722254, -1045.525624089074, -983.7249076744433, -594.3099815435546, -1112.1524811649124, -840.379133569225, -767.7674977045441, -1025.7713631848292, -52.43761784071941, -1027.637200400408, -462.5877912971755, -867.85165415284, -787.8678843129, -937.4017502733001, -928.645776640499, -489.5231687829193, -970.0504060865433, -818.6480150447551, -492.8686090099568, -86.79002566410847, -186.3396438344266, -95.0328824839872, -380.80598622463083, -314.87438216463954, -1033.246242282626, -80.27292106048527, -1007.5988217210486]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556828497297652, "mean_inference_ms": 1.6748755864993212, "mean_action_processing_ms": 0.2816423499476088, "mean_env_wait_ms": 2.971215035579242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01358342170715332, "StateBufferConnector_ms": 0.008599996566772461, "ViewRequirementAgentConnector_ms": 0.19010448455810547}, "num_episodes": 31, "episode_return_max": -1.2459696378432, "episode_return_min": -1258.722097481516, "episode_return_mean": -673.5977174919849, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.08043667704436, "num_env_steps_trained_throughput_per_sec": 290.08043667704436, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 11885.513, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11885.446, "sample_time_ms": 1016.314, "learn_time_ms": 10806.867, "learn_throughput": 370.135, "synch_weights_time_ms": 61.474}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00004", "date": "2024-08-03_10-37-51", "timestamp": 1722661671, "time_this_iter_s": 13.801199913024902, "time_total_s": 71.38411402702332, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a290753d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71.38411402702332, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.547368421052633, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.43836816077431, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.577856649955114, "policy_loss": -0.009707857839142282, "vf_loss": 8.586359324057897, "vf_explained_var": 0.36526785579820475, "kl": 0.013750002907302895, "entropy": 1.5448182422667742, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -1.2459696378432, "episode_reward_min": -1198.3080835855003, "episode_reward_mean": -666.5501304464832, "episode_len_mean": 135.59, "episode_media": {}, "episodes_timesteps_total": 13559, "policy_reward_min": {"policy_0": -1198.3080835855003}, "policy_reward_max": {"policy_0": -1.2459696378432}, "policy_reward_mean": {"policy_0": -666.5501304464832}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-772.3252039489951, -321.5458048499791, -741.0758526930102, -653.9010384484139, -616.3698505570053, -883.2784958027622, -1103.411699588893, -908.7385479226202, -2.9949827565857645, -777.5288375175148, -170.39192736125665, -46.95320447834025, -972.6271466077662, -125.61707086565949, -668.159167253667, -751.8446657723865, -467.0242292627543, -121.35555629008127, -730.4920210789396, -458.39527581244977, -601.1873114408171, -936.8282902765121, -1014.8881185512412, -1.2459696378432, -559.0619643269632, -1113.8510356917743, -879.8858268612578, -1120.2383726807266, -611.4059523058659, -781.4788919597314, -1033.2839741694268, -601.5016241308539, -679.6744407600349, -469.11148807008146, -466.95666968179444, -358.0307231843623, -875.2565944307662, -717.3388087460316, -1198.3080835855003, -1083.764678835862, -528.2447378722254, -1045.525624089074, -983.7249076744433, -594.3099815435546, -1112.1524811649124, -840.379133569225, -767.7674977045441, -1025.7713631848292, -52.43761784071941, -1027.637200400408, -462.5877912971755, -867.85165415284, -787.8678843129, -937.4017502733001, -928.645776640499, -489.5231687829193, -970.0504060865433, -818.6480150447551, -492.8686090099568, -86.79002566410847, -186.3396438344266, -95.0328824839872, -380.80598622463083, -314.87438216463954, -1033.246242282626, -80.27292106048527, -1007.5988217210486, -998.9706760259131, -387.92986479519186, -858.6097326899463, -974.1492885745713, -943.9678853615453, -462.862970062294, -203.83077691489896, -1015.0114598912284, -795.6508461442805, -814.139233937363, -608.5025400475445, -237.94339065477973, -202.14740635264218, -1021.167692734471, -786.487020565668, -400.6124434257175, -1198.3037876378453, -776.8246441263412, -895.5958537151539, -372.0493851212, -1095.6893470539421, -69.8467216063575, -929.2175845064535, -780.188202107835, -623.6039130628501, -582.1198746762215, -498.6510876996219, -629.3526921675476, -206.0316544787378, -997.90363400468, -472.5282284407472, -996.9550310848039, -502.48227070262993], "episode_lengths": [150, 85, 150, 150, 150, 150, 150, 150, 42, 150, 92, 64, 150, 70, 150, 145, 150, 74, 150, 150, 150, 150, 150, 47, 122, 150, 150, 150, 150, 150, 150, 150, 150, 123, 125, 137, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 115, 68, 150, 113, 150, 53, 150, 150, 102, 150, 150, 150, 123, 82, 150, 150, 150, 147, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 146], "policy_policy_0_reward": [-772.3252039489951, -321.5458048499791, -741.0758526930102, -653.9010384484139, -616.3698505570053, -883.2784958027622, -1103.411699588893, -908.7385479226202, -2.9949827565857645, -777.5288375175148, -170.39192736125665, -46.95320447834025, -972.6271466077662, -125.61707086565949, -668.159167253667, -751.8446657723865, -467.0242292627543, -121.35555629008127, -730.4920210789396, -458.39527581244977, -601.1873114408171, -936.8282902765121, -1014.8881185512412, -1.2459696378432, -559.0619643269632, -1113.8510356917743, -879.8858268612578, -1120.2383726807266, -611.4059523058659, -781.4788919597314, -1033.2839741694268, -601.5016241308539, -679.6744407600349, -469.11148807008146, -466.95666968179444, -358.0307231843623, -875.2565944307662, -717.3388087460316, -1198.3080835855003, -1083.764678835862, -528.2447378722254, -1045.525624089074, -983.7249076744433, -594.3099815435546, -1112.1524811649124, -840.379133569225, -767.7674977045441, -1025.7713631848292, -52.43761784071941, -1027.637200400408, -462.5877912971755, -867.85165415284, -787.8678843129, -937.4017502733001, -928.645776640499, -489.5231687829193, -970.0504060865433, -818.6480150447551, -492.8686090099568, -86.79002566410847, -186.3396438344266, -95.0328824839872, -380.80598622463083, -314.87438216463954, -1033.246242282626, -80.27292106048527, -1007.5988217210486, -998.9706760259131, -387.92986479519186, -858.6097326899463, -974.1492885745713, -943.9678853615453, -462.862970062294, -203.83077691489896, -1015.0114598912284, -795.6508461442805, -814.139233937363, -608.5025400475445, -237.94339065477973, -202.14740635264218, -1021.167692734471, -786.487020565668, -400.6124434257175, -1198.3037876378453, -776.8246441263412, -895.5958537151539, -372.0493851212, -1095.6893470539421, -69.8467216063575, -929.2175845064535, -780.188202107835, -623.6039130628501, -582.1198746762215, -498.6510876996219, -629.3526921675476, -206.0316544787378, -997.90363400468, -472.5282284407472, -996.9550310848039, -502.48227070262993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545999125633074, "mean_inference_ms": 1.6753242640029216, "mean_action_processing_ms": 0.2812720804409576, "mean_env_wait_ms": 2.974392109829189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013278722763061523, "StateBufferConnector_ms": 0.008863687515258789, "ViewRequirementAgentConnector_ms": 0.1928853988647461}, "num_episodes": 33, "episode_return_max": -1.2459696378432, "episode_return_min": -1198.3080835855003, "episode_return_mean": -666.5501304464832, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.42214704254434, "num_env_steps_trained_throughput_per_sec": 300.42214704254434, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12089.67, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12089.603, "sample_time_ms": 1017.692, "learn_time_ms": 11005.883, "learn_throughput": 363.442, "synch_weights_time_ms": 65.229}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00004", "date": "2024-08-03_10-38-05", "timestamp": 1722661685, "time_this_iter_s": 13.327605962753296, "time_total_s": 84.71171998977661, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907530a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 84.71171998977661, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.094736842105263, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.401159398133556, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.82337696303924, "policy_loss": -0.019431970364530572, "vf_loss": 8.840007717410723, "vf_explained_var": 0.509432590380311, "kl": 0.02178202300049937, "entropy": 1.555165628095468, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -44.090850003042746, "episode_reward_min": -1198.3080835855003, "episode_reward_mean": -644.0931120395028, "episode_len_mean": 134.07, "episode_media": {}, "episodes_timesteps_total": 13407, "policy_reward_min": {"policy_0": -1198.3080835855003}, "policy_reward_max": {"policy_0": -44.090850003042746}, "policy_reward_mean": {"policy_0": -644.0931120395028}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-611.4059523058659, -781.4788919597314, -1033.2839741694268, -601.5016241308539, -679.6744407600349, -469.11148807008146, -466.95666968179444, -358.0307231843623, -875.2565944307662, -717.3388087460316, -1198.3080835855003, -1083.764678835862, -528.2447378722254, -1045.525624089074, -983.7249076744433, -594.3099815435546, -1112.1524811649124, -840.379133569225, -767.7674977045441, -1025.7713631848292, -52.43761784071941, -1027.637200400408, -462.5877912971755, -867.85165415284, -787.8678843129, -937.4017502733001, -928.645776640499, -489.5231687829193, -970.0504060865433, -818.6480150447551, -492.8686090099568, -86.79002566410847, -186.3396438344266, -95.0328824839872, -380.80598622463083, -314.87438216463954, -1033.246242282626, -80.27292106048527, -1007.5988217210486, -998.9706760259131, -387.92986479519186, -858.6097326899463, -974.1492885745713, -943.9678853615453, -462.862970062294, -203.83077691489896, -1015.0114598912284, -795.6508461442805, -814.139233937363, -608.5025400475445, -237.94339065477973, -202.14740635264218, -1021.167692734471, -786.487020565668, -400.6124434257175, -1198.3037876378453, -776.8246441263412, -895.5958537151539, -372.0493851212, -1095.6893470539421, -69.8467216063575, -929.2175845064535, -780.188202107835, -623.6039130628501, -582.1198746762215, -498.6510876996219, -629.3526921675476, -206.0316544787378, -997.90363400468, -472.5282284407472, -996.9550310848039, -502.48227070262993, -482.8049709534873, -740.8144427059713, -96.05225180432166, -378.0287233597033, -220.37496845248933, -899.9366413531396, -207.78819312399742, -456.1625570014704, -60.89424659372133, -1033.7936852757973, -825.5422427610098, -44.090850003042746, -146.5555077302107, -613.634133289882, -1163.9431251767585, -618.7540776705764, -843.6121768398283, -906.9253523112259, -219.43079890134348, -594.5952279078238, -1109.8003579799488, -780.2964089642774, -859.9412303781285, -536.6961181786505, -612.0778306353938, -163.2150165070402, -203.16224384915324, -456.5922479297718], "episode_lengths": [150, 150, 150, 150, 150, 123, 125, 137, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 115, 68, 150, 113, 150, 53, 150, 150, 102, 150, 150, 150, 123, 82, 150, 150, 150, 147, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 146, 150, 150, 54, 112, 69, 150, 99, 150, 44, 150, 150, 57, 63, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 89, 88, 133], "policy_policy_0_reward": [-611.4059523058659, -781.4788919597314, -1033.2839741694268, -601.5016241308539, -679.6744407600349, -469.11148807008146, -466.95666968179444, -358.0307231843623, -875.2565944307662, -717.3388087460316, -1198.3080835855003, -1083.764678835862, -528.2447378722254, -1045.525624089074, -983.7249076744433, -594.3099815435546, -1112.1524811649124, -840.379133569225, -767.7674977045441, -1025.7713631848292, -52.43761784071941, -1027.637200400408, -462.5877912971755, -867.85165415284, -787.8678843129, -937.4017502733001, -928.645776640499, -489.5231687829193, -970.0504060865433, -818.6480150447551, -492.8686090099568, -86.79002566410847, -186.3396438344266, -95.0328824839872, -380.80598622463083, -314.87438216463954, -1033.246242282626, -80.27292106048527, -1007.5988217210486, -998.9706760259131, -387.92986479519186, -858.6097326899463, -974.1492885745713, -943.9678853615453, -462.862970062294, -203.83077691489896, -1015.0114598912284, -795.6508461442805, -814.139233937363, -608.5025400475445, -237.94339065477973, -202.14740635264218, -1021.167692734471, -786.487020565668, -400.6124434257175, -1198.3037876378453, -776.8246441263412, -895.5958537151539, -372.0493851212, -1095.6893470539421, -69.8467216063575, -929.2175845064535, -780.188202107835, -623.6039130628501, -582.1198746762215, -498.6510876996219, -629.3526921675476, -206.0316544787378, -997.90363400468, -472.5282284407472, -996.9550310848039, -502.48227070262993, -482.8049709534873, -740.8144427059713, -96.05225180432166, -378.0287233597033, -220.37496845248933, -899.9366413531396, -207.78819312399742, -456.1625570014704, -60.89424659372133, -1033.7936852757973, -825.5422427610098, -44.090850003042746, -146.5555077302107, -613.634133289882, -1163.9431251767585, -618.7540776705764, -843.6121768398283, -906.9253523112259, -219.43079890134348, -594.5952279078238, -1109.8003579799488, -780.2964089642774, -859.9412303781285, -536.6961181786505, -612.0778306353938, -163.2150165070402, -203.16224384915324, -456.5922479297718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554956985438333, "mean_inference_ms": 1.677210175702357, "mean_action_processing_ms": 0.2809982522798511, "mean_env_wait_ms": 2.9778528043352823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013393163681030273, "StateBufferConnector_ms": 0.008747577667236328, "ViewRequirementAgentConnector_ms": 0.19499969482421875}, "num_episodes": 28, "episode_return_max": -44.090850003042746, "episode_return_min": -1198.3080835855003, "episode_return_mean": -644.0931120395028, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.3201093837534, "num_env_steps_trained_throughput_per_sec": 297.3201093837534, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12260.153, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12260.084, "sample_time_ms": 1019.979, "learn_time_ms": 11172.918, "learn_throughput": 358.009, "synch_weights_time_ms": 66.393}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00004", "date": "2024-08-03_10-38-18", "timestamp": 1722661698, "time_this_iter_s": 13.465789556503296, "time_total_s": 98.17750954627991, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907531c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 98.17750954627991, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.145000000000001, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.128086064880092, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.563597978651524, "policy_loss": -0.012433123448378562, "vf_loss": 8.571924518545469, "vf_explained_var": 0.5829165273035566, "kl": 0.019316822553234185, "entropy": 1.6884489994496108, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -44.090850003042746, "episode_reward_min": -1249.9683115702007, "episode_reward_mean": -633.9908843585628, "episode_len_mean": 131.93, "episode_media": {}, "episodes_timesteps_total": 13193, "policy_reward_min": {"policy_0": -1249.9683115702007}, "policy_reward_max": {"policy_0": -44.090850003042746}, "policy_reward_mean": {"policy_0": -633.9908843585628}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-818.6480150447551, -492.8686090099568, -86.79002566410847, -186.3396438344266, -95.0328824839872, -380.80598622463083, -314.87438216463954, -1033.246242282626, -80.27292106048527, -1007.5988217210486, -998.9706760259131, -387.92986479519186, -858.6097326899463, -974.1492885745713, -943.9678853615453, -462.862970062294, -203.83077691489896, -1015.0114598912284, -795.6508461442805, -814.139233937363, -608.5025400475445, -237.94339065477973, -202.14740635264218, -1021.167692734471, -786.487020565668, -400.6124434257175, -1198.3037876378453, -776.8246441263412, -895.5958537151539, -372.0493851212, -1095.6893470539421, -69.8467216063575, -929.2175845064535, -780.188202107835, -623.6039130628501, -582.1198746762215, -498.6510876996219, -629.3526921675476, -206.0316544787378, -997.90363400468, -472.5282284407472, -996.9550310848039, -502.48227070262993, -482.8049709534873, -740.8144427059713, -96.05225180432166, -378.0287233597033, -220.37496845248933, -899.9366413531396, -207.78819312399742, -456.1625570014704, -60.89424659372133, -1033.7936852757973, -825.5422427610098, -44.090850003042746, -146.5555077302107, -613.634133289882, -1163.9431251767585, -618.7540776705764, -843.6121768398283, -906.9253523112259, -219.43079890134348, -594.5952279078238, -1109.8003579799488, -780.2964089642774, -859.9412303781285, -536.6961181786505, -612.0778306353938, -163.2150165070402, -203.16224384915324, -456.5922479297718, -881.746136066051, -400.60937654562997, -1000.548292202226, -806.5326795454777, -713.1619324407483, -1025.24444326054, -1249.9683115702007, -500.02663438340153, -416.5735981674263, -188.65791076479894, -425.87200524349515, -929.8105537884921, -963.88923434866, -164.59248165279197, -1068.5119458230367, -1026.0574891200017, -1246.0179410167152, -969.6975625200646, -689.5471697227543, -669.8005412101575, -228.11948598348684, -954.079538623431, -195.78270251338202, -832.5065948174538, -1158.8631836473783, -306.41336854318, -222.8223672963692, -1185.3133171807112, -867.0013403583587], "episode_lengths": [150, 150, 79, 115, 68, 150, 113, 150, 53, 150, 150, 102, 150, 150, 150, 123, 82, 150, 150, 150, 147, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 146, 150, 150, 54, 112, 69, 150, 99, 150, 44, 150, 150, 57, 63, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 89, 88, 133, 150, 126, 150, 150, 150, 150, 150, 150, 150, 97, 117, 150, 150, 122, 150, 150, 150, 150, 150, 150, 78, 150, 114, 150, 150, 95, 77, 150, 150], "policy_policy_0_reward": [-818.6480150447551, -492.8686090099568, -86.79002566410847, -186.3396438344266, -95.0328824839872, -380.80598622463083, -314.87438216463954, -1033.246242282626, -80.27292106048527, -1007.5988217210486, -998.9706760259131, -387.92986479519186, -858.6097326899463, -974.1492885745713, -943.9678853615453, -462.862970062294, -203.83077691489896, -1015.0114598912284, -795.6508461442805, -814.139233937363, -608.5025400475445, -237.94339065477973, -202.14740635264218, -1021.167692734471, -786.487020565668, -400.6124434257175, -1198.3037876378453, -776.8246441263412, -895.5958537151539, -372.0493851212, -1095.6893470539421, -69.8467216063575, -929.2175845064535, -780.188202107835, -623.6039130628501, -582.1198746762215, -498.6510876996219, -629.3526921675476, -206.0316544787378, -997.90363400468, -472.5282284407472, -996.9550310848039, -502.48227070262993, -482.8049709534873, -740.8144427059713, -96.05225180432166, -378.0287233597033, -220.37496845248933, -899.9366413531396, -207.78819312399742, -456.1625570014704, -60.89424659372133, -1033.7936852757973, -825.5422427610098, -44.090850003042746, -146.5555077302107, -613.634133289882, -1163.9431251767585, -618.7540776705764, -843.6121768398283, -906.9253523112259, -219.43079890134348, -594.5952279078238, -1109.8003579799488, -780.2964089642774, -859.9412303781285, -536.6961181786505, -612.0778306353938, -163.2150165070402, -203.16224384915324, -456.5922479297718, -881.746136066051, -400.60937654562997, -1000.548292202226, -806.5326795454777, -713.1619324407483, -1025.24444326054, -1249.9683115702007, -500.02663438340153, -416.5735981674263, -188.65791076479894, -425.87200524349515, -929.8105537884921, -963.88923434866, -164.59248165279197, -1068.5119458230367, -1026.0574891200017, -1246.0179410167152, -969.6975625200646, -689.5471697227543, -669.8005412101575, -228.11948598348684, -954.079538623431, -195.78270251338202, -832.5065948174538, -1158.8631836473783, -306.41336854318, -222.8223672963692, -1185.3133171807112, -867.0013403583587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539932853109936, "mean_inference_ms": 1.6774491435727803, "mean_action_processing_ms": 0.28054964980295577, "mean_env_wait_ms": 2.9822159366973593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01296377182006836, "StateBufferConnector_ms": 0.008544683456420898, "ViewRequirementAgentConnector_ms": 0.19527173042297363}, "num_episodes": 29, "episode_return_max": -44.090850003042746, "episode_return_min": -1249.9683115702007, "episode_return_mean": -633.9908843585628, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.662928401299, "num_env_steps_trained_throughput_per_sec": 300.662928401299, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12376.13, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12376.059, "sample_time_ms": 1019.067, "learn_time_ms": 11290.02, "learn_throughput": 354.295, "synch_weights_time_ms": 66.17}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00004", "date": "2024-08-03_10-38-32", "timestamp": 1722661712, "time_this_iter_s": 13.316035509109497, "time_total_s": 111.4935450553894, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010a560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 111.4935450553894, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.527777777777779, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.435573097566763, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.00824680676063, "policy_loss": -0.013530933694467725, "vf_loss": 8.018439760804176, "vf_explained_var": 0.5941788996880253, "kl": 0.016476209240969788, "entropy": 1.604903216784199, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 1.2151584990189306, "episode_reward_min": -1281.3346969629772, "episode_reward_mean": -669.9469809835964, "episode_len_mean": 133.16, "episode_media": {}, "episodes_timesteps_total": 13316, "policy_reward_min": {"policy_0": -1281.3346969629772}, "policy_reward_max": {"policy_0": 1.2151584990189306}, "policy_reward_mean": {"policy_0": -669.9469809835964}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-895.5958537151539, -372.0493851212, -1095.6893470539421, -69.8467216063575, -929.2175845064535, -780.188202107835, -623.6039130628501, -582.1198746762215, -498.6510876996219, -629.3526921675476, -206.0316544787378, -997.90363400468, -472.5282284407472, -996.9550310848039, -502.48227070262993, -482.8049709534873, -740.8144427059713, -96.05225180432166, -378.0287233597033, -220.37496845248933, -899.9366413531396, -207.78819312399742, -456.1625570014704, -60.89424659372133, -1033.7936852757973, -825.5422427610098, -44.090850003042746, -146.5555077302107, -613.634133289882, -1163.9431251767585, -618.7540776705764, -843.6121768398283, -906.9253523112259, -219.43079890134348, -594.5952279078238, -1109.8003579799488, -780.2964089642774, -859.9412303781285, -536.6961181786505, -612.0778306353938, -163.2150165070402, -203.16224384915324, -456.5922479297718, -881.746136066051, -400.60937654562997, -1000.548292202226, -806.5326795454777, -713.1619324407483, -1025.24444326054, -1249.9683115702007, -500.02663438340153, -416.5735981674263, -188.65791076479894, -425.87200524349515, -929.8105537884921, -963.88923434866, -164.59248165279197, -1068.5119458230367, -1026.0574891200017, -1246.0179410167152, -969.6975625200646, -689.5471697227543, -669.8005412101575, -228.11948598348684, -954.079538623431, -195.78270251338202, -832.5065948174538, -1158.8631836473783, -306.41336854318, -222.8223672963692, -1185.3133171807112, -867.0013403583587, -654.9336669396679, -522.1769220525761, -523.6821598754483, 1.2151584990189306, -8.72778086427941, -483.7821075328848, -1281.3346969629772, -967.0085862171786, -1090.6025246256436, -1164.7621279771383, -706.1765456217232, -398.70411919987515, -943.4116500831775, -811.4965509955756, -340.3927382937192, -1187.6886397688324, -982.0636622171827, -988.2083067853372, -653.7136528650751, -749.2026130524553, -1143.7813807634095, -1049.9494440716628, -458.1383629112994, -886.9067710449428, -1110.1041836089462, -736.5353588946587, -207.8311951780197, -729.0982620316017], "episode_lengths": [150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 146, 150, 150, 54, 112, 69, 150, 99, 150, 44, 150, 150, 57, 63, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 89, 88, 133, 150, 126, 150, 150, 150, 150, 150, 150, 150, 97, 117, 150, 150, 122, 150, 150, 150, 150, 150, 150, 78, 150, 114, 150, 150, 95, 77, 150, 150, 136, 150, 124, 36, 50, 115, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 78, 150], "policy_policy_0_reward": [-895.5958537151539, -372.0493851212, -1095.6893470539421, -69.8467216063575, -929.2175845064535, -780.188202107835, -623.6039130628501, -582.1198746762215, -498.6510876996219, -629.3526921675476, -206.0316544787378, -997.90363400468, -472.5282284407472, -996.9550310848039, -502.48227070262993, -482.8049709534873, -740.8144427059713, -96.05225180432166, -378.0287233597033, -220.37496845248933, -899.9366413531396, -207.78819312399742, -456.1625570014704, -60.89424659372133, -1033.7936852757973, -825.5422427610098, -44.090850003042746, -146.5555077302107, -613.634133289882, -1163.9431251767585, -618.7540776705764, -843.6121768398283, -906.9253523112259, -219.43079890134348, -594.5952279078238, -1109.8003579799488, -780.2964089642774, -859.9412303781285, -536.6961181786505, -612.0778306353938, -163.2150165070402, -203.16224384915324, -456.5922479297718, -881.746136066051, -400.60937654562997, -1000.548292202226, -806.5326795454777, -713.1619324407483, -1025.24444326054, -1249.9683115702007, -500.02663438340153, -416.5735981674263, -188.65791076479894, -425.87200524349515, -929.8105537884921, -963.88923434866, -164.59248165279197, -1068.5119458230367, -1026.0574891200017, -1246.0179410167152, -969.6975625200646, -689.5471697227543, -669.8005412101575, -228.11948598348684, -954.079538623431, -195.78270251338202, -832.5065948174538, -1158.8631836473783, -306.41336854318, -222.8223672963692, -1185.3133171807112, -867.0013403583587, -654.9336669396679, -522.1769220525761, -523.6821598754483, 1.2151584990189306, -8.72778086427941, -483.7821075328848, -1281.3346969629772, -967.0085862171786, -1090.6025246256436, -1164.7621279771383, -706.1765456217232, -398.70411919987515, -943.4116500831775, -811.4965509955756, -340.3927382937192, -1187.6886397688324, -982.0636622171827, -988.2083067853372, -653.7136528650751, -749.2026130524553, -1143.7813807634095, -1049.9494440716628, -458.1383629112994, -886.9067710449428, -1110.1041836089462, -736.5353588946587, -207.8311951780197, -729.0982620316017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534416859970035, "mean_inference_ms": 1.678590719502034, "mean_action_processing_ms": 0.280369198818737, "mean_env_wait_ms": 2.9902326367097847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013137102127075195, "StateBufferConnector_ms": 0.008510351181030273, "ViewRequirementAgentConnector_ms": 0.1966555118560791}, "num_episodes": 28, "episode_return_max": 1.2151584990189306, "episode_return_min": -1281.3346969629772, "episode_return_mean": -669.9469809835964, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.16879885459315, "num_env_steps_trained_throughput_per_sec": 301.16879885459315, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12466.677, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12466.606, "sample_time_ms": 1020.546, "learn_time_ms": 11379.719, "learn_throughput": 351.503, "synch_weights_time_ms": 65.533}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00004", "date": "2024-08-03_10-38-45", "timestamp": 1722661725, "time_this_iter_s": 13.295334100723267, "time_total_s": 124.78887915611267, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0d750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 124.78887915611267, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.326315789473682, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.317673106243213, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.113842033346494, "policy_loss": -0.019371044890431222, "vf_loss": 8.12823464324077, "vf_explained_var": 0.6828795886908968, "kl": 0.02201378651235853, "entropy": 1.6256841888030371, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": 1.2151584990189306, "episode_reward_min": -1281.3346969629772, "episode_reward_mean": -711.8375206912391, "episode_len_mean": 136.46, "episode_media": {}, "episodes_timesteps_total": 13646, "policy_reward_min": {"policy_0": -1281.3346969629772}, "policy_reward_max": {"policy_0": 1.2151584990189306}, "policy_reward_mean": {"policy_0": -711.8375206912391}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-146.5555077302107, -613.634133289882, -1163.9431251767585, -618.7540776705764, -843.6121768398283, -906.9253523112259, -219.43079890134348, -594.5952279078238, -1109.8003579799488, -780.2964089642774, -859.9412303781285, -536.6961181786505, -612.0778306353938, -163.2150165070402, -203.16224384915324, -456.5922479297718, -881.746136066051, -400.60937654562997, -1000.548292202226, -806.5326795454777, -713.1619324407483, -1025.24444326054, -1249.9683115702007, -500.02663438340153, -416.5735981674263, -188.65791076479894, -425.87200524349515, -929.8105537884921, -963.88923434866, -164.59248165279197, -1068.5119458230367, -1026.0574891200017, -1246.0179410167152, -969.6975625200646, -689.5471697227543, -669.8005412101575, -228.11948598348684, -954.079538623431, -195.78270251338202, -832.5065948174538, -1158.8631836473783, -306.41336854318, -222.8223672963692, -1185.3133171807112, -867.0013403583587, -654.9336669396679, -522.1769220525761, -523.6821598754483, 1.2151584990189306, -8.72778086427941, -483.7821075328848, -1281.3346969629772, -967.0085862171786, -1090.6025246256436, -1164.7621279771383, -706.1765456217232, -398.70411919987515, -943.4116500831775, -811.4965509955756, -340.3927382937192, -1187.6886397688324, -982.0636622171827, -988.2083067853372, -653.7136528650751, -749.2026130524553, -1143.7813807634095, -1049.9494440716628, -458.1383629112994, -886.9067710449428, -1110.1041836089462, -736.5353588946587, -207.8311951780197, -729.0982620316017, -812.1882308580784, -122.82939322004084, -582.9089194596025, -677.3109720329519, -839.677588695173, -878.5550421340678, -818.1746241231408, -1133.6912402375428, -591.3000218244157, -877.6201893824119, -1064.208843269052, -1208.5952226577715, -898.3887071845106, -387.1683908520474, -1121.6864973132604, -317.0352532507327, -1228.5129799650151, -696.8071760516466, -1024.9983653972567, -977.8675931684024, -136.54828085193793, -718.2081192014692, -512.3170342015791, -659.3541209224679, -12.882837511558101, -656.3657493241762, -332.3518314909047], "episode_lengths": [63, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 89, 88, 133, 150, 126, 150, 150, 150, 150, 150, 150, 150, 97, 117, 150, 150, 122, 150, 150, 150, 150, 150, 150, 78, 150, 114, 150, 150, 95, 77, 150, 150, 136, 150, 124, 36, 50, 115, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 78, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 45, 150, 111], "policy_policy_0_reward": [-146.5555077302107, -613.634133289882, -1163.9431251767585, -618.7540776705764, -843.6121768398283, -906.9253523112259, -219.43079890134348, -594.5952279078238, -1109.8003579799488, -780.2964089642774, -859.9412303781285, -536.6961181786505, -612.0778306353938, -163.2150165070402, -203.16224384915324, -456.5922479297718, -881.746136066051, -400.60937654562997, -1000.548292202226, -806.5326795454777, -713.1619324407483, -1025.24444326054, -1249.9683115702007, -500.02663438340153, -416.5735981674263, -188.65791076479894, -425.87200524349515, -929.8105537884921, -963.88923434866, -164.59248165279197, -1068.5119458230367, -1026.0574891200017, -1246.0179410167152, -969.6975625200646, -689.5471697227543, -669.8005412101575, -228.11948598348684, -954.079538623431, -195.78270251338202, -832.5065948174538, -1158.8631836473783, -306.41336854318, -222.8223672963692, -1185.3133171807112, -867.0013403583587, -654.9336669396679, -522.1769220525761, -523.6821598754483, 1.2151584990189306, -8.72778086427941, -483.7821075328848, -1281.3346969629772, -967.0085862171786, -1090.6025246256436, -1164.7621279771383, -706.1765456217232, -398.70411919987515, -943.4116500831775, -811.4965509955756, -340.3927382937192, -1187.6886397688324, -982.0636622171827, -988.2083067853372, -653.7136528650751, -749.2026130524553, -1143.7813807634095, -1049.9494440716628, -458.1383629112994, -886.9067710449428, -1110.1041836089462, -736.5353588946587, -207.8311951780197, -729.0982620316017, -812.1882308580784, -122.82939322004084, -582.9089194596025, -677.3109720329519, -839.677588695173, -878.5550421340678, -818.1746241231408, -1133.6912402375428, -591.3000218244157, -877.6201893824119, -1064.208843269052, -1208.5952226577715, -898.3887071845106, -387.1683908520474, -1121.6864973132604, -317.0352532507327, -1228.5129799650151, -696.8071760516466, -1024.9983653972567, -977.8675931684024, -136.54828085193793, -718.2081192014692, -512.3170342015791, -659.3541209224679, -12.882837511558101, -656.3657493241762, -332.3518314909047]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525320602717809, "mean_inference_ms": 1.679974856688567, "mean_action_processing_ms": 0.28010109499398544, "mean_env_wait_ms": 2.994526364113275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013252735137939453, "StateBufferConnector_ms": 0.00819087028503418, "ViewRequirementAgentConnector_ms": 0.19843268394470215}, "num_episodes": 27, "episode_return_max": 1.2151584990189306, "episode_return_min": -1281.3346969629772, "episode_return_mean": -711.8375206912391, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.06315899673416, "num_env_steps_trained_throughput_per_sec": 301.06315899673416, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12477.344, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12477.273, "sample_time_ms": 1026.543, "learn_time_ms": 11385.596, "learn_throughput": 351.321, "synch_weights_time_ms": 64.33}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00004", "date": "2024-08-03_10-38-58", "timestamp": 1722661738, "time_this_iter_s": 13.300001382827759, "time_total_s": 138.08888053894043, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010b1c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 138.08888053894043, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 13.678947368421055, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.436708164960145, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.698150770862897, "policy_loss": -0.0070061203490089, "vf_loss": 8.702251563469568, "vf_explained_var": 0.5683495359495282, "kl": 0.010584009646239203, "entropy": 1.8574659959723552, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 1.2151584990189306, "episode_reward_min": -1284.1351874938357, "episode_reward_mean": -748.7301702154846, "episode_len_mean": 138.13, "episode_media": {}, "episodes_timesteps_total": 13813, "policy_reward_min": {"policy_0": -1284.1351874938357}, "policy_reward_max": {"policy_0": 1.2151584990189306}, "policy_reward_mean": {"policy_0": -748.7301702154846}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1026.0574891200017, -1246.0179410167152, -969.6975625200646, -689.5471697227543, -669.8005412101575, -228.11948598348684, -954.079538623431, -195.78270251338202, -832.5065948174538, -1158.8631836473783, -306.41336854318, -222.8223672963692, -1185.3133171807112, -867.0013403583587, -654.9336669396679, -522.1769220525761, -523.6821598754483, 1.2151584990189306, -8.72778086427941, -483.7821075328848, -1281.3346969629772, -967.0085862171786, -1090.6025246256436, -1164.7621279771383, -706.1765456217232, -398.70411919987515, -943.4116500831775, -811.4965509955756, -340.3927382937192, -1187.6886397688324, -982.0636622171827, -988.2083067853372, -653.7136528650751, -749.2026130524553, -1143.7813807634095, -1049.9494440716628, -458.1383629112994, -886.9067710449428, -1110.1041836089462, -736.5353588946587, -207.8311951780197, -729.0982620316017, -812.1882308580784, -122.82939322004084, -582.9089194596025, -677.3109720329519, -839.677588695173, -878.5550421340678, -818.1746241231408, -1133.6912402375428, -591.3000218244157, -877.6201893824119, -1064.208843269052, -1208.5952226577715, -898.3887071845106, -387.1683908520474, -1121.6864973132604, -317.0352532507327, -1228.5129799650151, -696.8071760516466, -1024.9983653972567, -977.8675931684024, -136.54828085193793, -718.2081192014692, -512.3170342015791, -659.3541209224679, -12.882837511558101, -656.3657493241762, -332.3518314909047, -1176.9647313538094, -106.97949874386323, -1001.9817837773434, -514.3055211095692, -898.2775411037613, -878.4319219953152, -839.8766731594042, -790.6198402452559, -9.684906199065113, -677.9346347168671, -961.2623967538452, -1284.1351874938357, -809.2040454258052, -1019.6982137490191, -723.4609471490363, -1140.7965778293756, -898.0728759720964, -530.9430926051397, -1201.994965450887, -551.5991618225263, -897.9544139259932, -933.8830620922828, -570.9975350296446, -288.95261642972093, -1164.6652128933558, -728.3819726781816, -750.4287696318545, -1198.0133214468174, -489.87829498485536, -535.7757843643974, -679.0868423446142], "episode_lengths": [150, 150, 150, 150, 150, 78, 150, 114, 150, 150, 95, 77, 150, 150, 136, 150, 124, 36, 50, 115, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 78, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 45, 150, 111, 150, 92, 150, 150, 150, 150, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 128], "policy_policy_0_reward": [-1026.0574891200017, -1246.0179410167152, -969.6975625200646, -689.5471697227543, -669.8005412101575, -228.11948598348684, -954.079538623431, -195.78270251338202, -832.5065948174538, -1158.8631836473783, -306.41336854318, -222.8223672963692, -1185.3133171807112, -867.0013403583587, -654.9336669396679, -522.1769220525761, -523.6821598754483, 1.2151584990189306, -8.72778086427941, -483.7821075328848, -1281.3346969629772, -967.0085862171786, -1090.6025246256436, -1164.7621279771383, -706.1765456217232, -398.70411919987515, -943.4116500831775, -811.4965509955756, -340.3927382937192, -1187.6886397688324, -982.0636622171827, -988.2083067853372, -653.7136528650751, -749.2026130524553, -1143.7813807634095, -1049.9494440716628, -458.1383629112994, -886.9067710449428, -1110.1041836089462, -736.5353588946587, -207.8311951780197, -729.0982620316017, -812.1882308580784, -122.82939322004084, -582.9089194596025, -677.3109720329519, -839.677588695173, -878.5550421340678, -818.1746241231408, -1133.6912402375428, -591.3000218244157, -877.6201893824119, -1064.208843269052, -1208.5952226577715, -898.3887071845106, -387.1683908520474, -1121.6864973132604, -317.0352532507327, -1228.5129799650151, -696.8071760516466, -1024.9983653972567, -977.8675931684024, -136.54828085193793, -718.2081192014692, -512.3170342015791, -659.3541209224679, -12.882837511558101, -656.3657493241762, -332.3518314909047, -1176.9647313538094, -106.97949874386323, -1001.9817837773434, -514.3055211095692, -898.2775411037613, -878.4319219953152, -839.8766731594042, -790.6198402452559, -9.684906199065113, -677.9346347168671, -961.2623967538452, -1284.1351874938357, -809.2040454258052, -1019.6982137490191, -723.4609471490363, -1140.7965778293756, -898.0728759720964, -530.9430926051397, -1201.994965450887, -551.5991618225263, -897.9544139259932, -933.8830620922828, -570.9975350296446, -288.95261642972093, -1164.6652128933558, -728.3819726781816, -750.4287696318545, -1198.0133214468174, -489.87829498485536, -535.7757843643974, -679.0868423446142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522412012646645, "mean_inference_ms": 1.682135311224381, "mean_action_processing_ms": 0.27979770073161064, "mean_env_wait_ms": 3.004883971778506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013119697570800781, "StateBufferConnector_ms": 0.008323431015014648, "ViewRequirementAgentConnector_ms": 0.20244598388671875}, "num_episodes": 31, "episode_return_max": 1.2151584990189306, "episode_return_min": -1284.1351874938357, "episode_return_mean": -748.7301702154846, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 536.6620860490766, "num_env_steps_trained_throughput_per_sec": 536.6620860490766, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12156.341, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12156.27, "sample_time_ms": 1027.65, "learn_time_ms": 11062.225, "learn_throughput": 361.591, "synch_weights_time_ms": 65.576}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00004", "date": "2024-08-03_10-39-06", "timestamp": 1722661746, "time_this_iter_s": 7.4664154052734375, "time_total_s": 145.55529594421387, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907b97e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 145.55529594421387, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.154545454545453, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.96304371878505, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.163853800793488, "policy_loss": -0.008843857636869264, "vf_loss": 8.169556084275246, "vf_explained_var": 0.6364451001708706, "kl": 0.011126281030919945, "entropy": 1.8652441973487537, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -9.684906199065113, "episode_reward_min": -1368.5614613736338, "episode_reward_mean": -795.8525740670395, "episode_len_mean": 142.39, "episode_media": {}, "episodes_timesteps_total": 14239, "policy_reward_min": {"policy_0": -1368.5614613736338}, "policy_reward_max": {"policy_0": -9.684906199065113}, "policy_reward_mean": {"policy_0": -795.8525740670395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-982.0636622171827, -988.2083067853372, -653.7136528650751, -749.2026130524553, -1143.7813807634095, -1049.9494440716628, -458.1383629112994, -886.9067710449428, -1110.1041836089462, -736.5353588946587, -207.8311951780197, -729.0982620316017, -812.1882308580784, -122.82939322004084, -582.9089194596025, -677.3109720329519, -839.677588695173, -878.5550421340678, -818.1746241231408, -1133.6912402375428, -591.3000218244157, -877.6201893824119, -1064.208843269052, -1208.5952226577715, -898.3887071845106, -387.1683908520474, -1121.6864973132604, -317.0352532507327, -1228.5129799650151, -696.8071760516466, -1024.9983653972567, -977.8675931684024, -136.54828085193793, -718.2081192014692, -512.3170342015791, -659.3541209224679, -12.882837511558101, -656.3657493241762, -332.3518314909047, -1176.9647313538094, -106.97949874386323, -1001.9817837773434, -514.3055211095692, -898.2775411037613, -878.4319219953152, -839.8766731594042, -790.6198402452559, -9.684906199065113, -677.9346347168671, -961.2623967538452, -1284.1351874938357, -809.2040454258052, -1019.6982137490191, -723.4609471490363, -1140.7965778293756, -898.0728759720964, -530.9430926051397, -1201.994965450887, -551.5991618225263, -897.9544139259932, -933.8830620922828, -570.9975350296446, -288.95261642972093, -1164.6652128933558, -728.3819726781816, -750.4287696318545, -1198.0133214468174, -489.87829498485536, -535.7757843643974, -679.0868423446142, -887.3214881244397, -762.6728471857213, -1024.6337030066425, -1282.478132597306, -1039.6899244192475, -858.2770519135768, -723.9404159229149, -878.7105688896902, -148.96047218104337, -1180.9742388387792, -833.3680932583095, -136.47557360711286, -1066.3102157708374, -974.1142398450929, -740.4720739916419, -1368.5614613736338, -1221.194530671102, -261.1395617544245, -1245.8738023741782, -810.7926100586233, -1336.268878894768, -983.9924135690434, -540.985058475651, -939.7808161641487, -617.6381866315568, -889.7219733245264, -557.1458217298434, -1228.694300515292, -911.6962412485216, -896.0439498829297], "episode_lengths": [150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 78, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 45, 150, 111, 150, 92, 150, 150, 150, 150, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 107, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-982.0636622171827, -988.2083067853372, -653.7136528650751, -749.2026130524553, -1143.7813807634095, -1049.9494440716628, -458.1383629112994, -886.9067710449428, -1110.1041836089462, -736.5353588946587, -207.8311951780197, -729.0982620316017, -812.1882308580784, -122.82939322004084, -582.9089194596025, -677.3109720329519, -839.677588695173, -878.5550421340678, -818.1746241231408, -1133.6912402375428, -591.3000218244157, -877.6201893824119, -1064.208843269052, -1208.5952226577715, -898.3887071845106, -387.1683908520474, -1121.6864973132604, -317.0352532507327, -1228.5129799650151, -696.8071760516466, -1024.9983653972567, -977.8675931684024, -136.54828085193793, -718.2081192014692, -512.3170342015791, -659.3541209224679, -12.882837511558101, -656.3657493241762, -332.3518314909047, -1176.9647313538094, -106.97949874386323, -1001.9817837773434, -514.3055211095692, -898.2775411037613, -878.4319219953152, -839.8766731594042, -790.6198402452559, -9.684906199065113, -677.9346347168671, -961.2623967538452, -1284.1351874938357, -809.2040454258052, -1019.6982137490191, -723.4609471490363, -1140.7965778293756, -898.0728759720964, -530.9430926051397, -1201.994965450887, -551.5991618225263, -897.9544139259932, -933.8830620922828, -570.9975350296446, -288.95261642972093, -1164.6652128933558, -728.3819726781816, -750.4287696318545, -1198.0133214468174, -489.87829498485536, -535.7757843643974, -679.0868423446142, -887.3214881244397, -762.6728471857213, -1024.6337030066425, -1282.478132597306, -1039.6899244192475, -858.2770519135768, -723.9404159229149, -878.7105688896902, -148.96047218104337, -1180.9742388387792, -833.3680932583095, -136.47557360711286, -1066.3102157708374, -974.1142398450929, -740.4720739916419, -1368.5614613736338, -1221.194530671102, -261.1395617544245, -1245.8738023741782, -810.7926100586233, -1336.268878894768, -983.9924135690434, -540.985058475651, -939.7808161641487, -617.6381866315568, -889.7219733245264, -557.1458217298434, -1228.694300515292, -911.6962412485216, -896.0439498829297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5521336772072121, "mean_inference_ms": 1.6840321535247056, "mean_action_processing_ms": 0.27962049615109996, "mean_env_wait_ms": 3.0169323243803587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012734413146972656, "StateBufferConnector_ms": 0.008185863494873047, "ViewRequirementAgentConnector_ms": 0.20016884803771973}, "num_episodes": 30, "episode_return_max": -9.684906199065113, "episode_return_min": -1368.5614613736338, "episode_return_mean": -795.8525740670395, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.31153893940916, "num_env_steps_trained_throughput_per_sec": 496.31153893940916, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12231.901, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12231.828, "sample_time_ms": 1034.025, "learn_time_ms": 11131.53, "learn_throughput": 359.34, "synch_weights_time_ms": 65.453}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00004", "date": "2024-08-03_10-39-14", "timestamp": 1722661754, "time_this_iter_s": 8.072567462921143, "time_total_s": 153.627863407135, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a290753e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 153.627863407135, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.55, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.88216173003117, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.565755921105544, "policy_loss": -0.008678970870581301, "vf_loss": 7.57136414895455, "vf_explained_var": 0.7757023645564913, "kl": 0.010753923211450456, "entropy": 1.768525201578935, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -9.684906199065113, "episode_reward_min": -1429.821300900822, "episode_reward_mean": -769.7569606936776, "episode_len_mean": 139.0, "episode_media": {}, "episodes_timesteps_total": 13900, "policy_reward_min": {"policy_0": -1429.821300900822}, "policy_reward_max": {"policy_0": -9.684906199065113}, "policy_reward_mean": {"policy_0": -769.7569606936776}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-696.8071760516466, -1024.9983653972567, -977.8675931684024, -136.54828085193793, -718.2081192014692, -512.3170342015791, -659.3541209224679, -12.882837511558101, -656.3657493241762, -332.3518314909047, -1176.9647313538094, -106.97949874386323, -1001.9817837773434, -514.3055211095692, -898.2775411037613, -878.4319219953152, -839.8766731594042, -790.6198402452559, -9.684906199065113, -677.9346347168671, -961.2623967538452, -1284.1351874938357, -809.2040454258052, -1019.6982137490191, -723.4609471490363, -1140.7965778293756, -898.0728759720964, -530.9430926051397, -1201.994965450887, -551.5991618225263, -897.9544139259932, -933.8830620922828, -570.9975350296446, -288.95261642972093, -1164.6652128933558, -728.3819726781816, -750.4287696318545, -1198.0133214468174, -489.87829498485536, -535.7757843643974, -679.0868423446142, -887.3214881244397, -762.6728471857213, -1024.6337030066425, -1282.478132597306, -1039.6899244192475, -858.2770519135768, -723.9404159229149, -878.7105688896902, -148.96047218104337, -1180.9742388387792, -833.3680932583095, -136.47557360711286, -1066.3102157708374, -974.1142398450929, -740.4720739916419, -1368.5614613736338, -1221.194530671102, -261.1395617544245, -1245.8738023741782, -810.7926100586233, -1336.268878894768, -983.9924135690434, -540.985058475651, -939.7808161641487, -617.6381866315568, -889.7219733245264, -557.1458217298434, -1228.694300515292, -911.6962412485216, -896.0439498829297, -323.0018239540357, -265.0298261811762, -484.8479725418354, -654.3044108015699, -829.040652182507, -1194.4060229757092, -1006.6827370369698, -1429.821300900822, -1195.7757892762077, -313.07938559225386, -91.23664603115851, -698.2357354400723, -26.097722935792163, -328.2992396924459, -1155.683039914731, -901.4247308936839, -88.70031444219437, -687.9687689706856, -527.4143792657181, -891.0874345428804, -1201.904977273521, -1062.5612723275049, -876.4526252510526, -568.394942416863, -1335.461892731066, -21.544617864772963, -928.346995244946, -548.785881536575, -1010.2328343294706], "episode_lengths": [150, 150, 150, 104, 150, 150, 150, 45, 150, 111, 150, 92, 150, 150, 150, 150, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 107, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 95, 76, 150, 49, 92, 150, 150, 72, 150, 150, 150, 150, 150, 150, 143, 150, 51, 150, 150, 150], "policy_policy_0_reward": [-696.8071760516466, -1024.9983653972567, -977.8675931684024, -136.54828085193793, -718.2081192014692, -512.3170342015791, -659.3541209224679, -12.882837511558101, -656.3657493241762, -332.3518314909047, -1176.9647313538094, -106.97949874386323, -1001.9817837773434, -514.3055211095692, -898.2775411037613, -878.4319219953152, -839.8766731594042, -790.6198402452559, -9.684906199065113, -677.9346347168671, -961.2623967538452, -1284.1351874938357, -809.2040454258052, -1019.6982137490191, -723.4609471490363, -1140.7965778293756, -898.0728759720964, -530.9430926051397, -1201.994965450887, -551.5991618225263, -897.9544139259932, -933.8830620922828, -570.9975350296446, -288.95261642972093, -1164.6652128933558, -728.3819726781816, -750.4287696318545, -1198.0133214468174, -489.87829498485536, -535.7757843643974, -679.0868423446142, -887.3214881244397, -762.6728471857213, -1024.6337030066425, -1282.478132597306, -1039.6899244192475, -858.2770519135768, -723.9404159229149, -878.7105688896902, -148.96047218104337, -1180.9742388387792, -833.3680932583095, -136.47557360711286, -1066.3102157708374, -974.1142398450929, -740.4720739916419, -1368.5614613736338, -1221.194530671102, -261.1395617544245, -1245.8738023741782, -810.7926100586233, -1336.268878894768, -983.9924135690434, -540.985058475651, -939.7808161641487, -617.6381866315568, -889.7219733245264, -557.1458217298434, -1228.694300515292, -911.6962412485216, -896.0439498829297, -323.0018239540357, -265.0298261811762, -484.8479725418354, -654.3044108015699, -829.040652182507, -1194.4060229757092, -1006.6827370369698, -1429.821300900822, -1195.7757892762077, -313.07938559225386, -91.23664603115851, -698.2357354400723, -26.097722935792163, -328.2992396924459, -1155.683039914731, -901.4247308936839, -88.70031444219437, -687.9687689706856, -527.4143792657181, -891.0874345428804, -1201.904977273521, -1062.5612723275049, -876.4526252510526, -568.394942416863, -1335.461892731066, -21.544617864772963, -928.346995244946, -548.785881536575, -1010.2328343294706]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522707846004785, "mean_inference_ms": 1.684500798898045, "mean_action_processing_ms": 0.27939116040475725, "mean_env_wait_ms": 3.0269389623636123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012198686599731445, "StateBufferConnector_ms": 0.007931232452392578, "ViewRequirementAgentConnector_ms": 0.19519948959350586}, "num_episodes": 29, "episode_return_max": -9.684906199065113, "episode_return_min": -1429.821300900822, "episode_return_mean": -769.7569606936776, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.9186105010721, "num_env_steps_trained_throughput_per_sec": 295.9186105010721, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12268.414, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12268.341, "sample_time_ms": 1036.989, "learn_time_ms": 11165.238, "learn_throughput": 358.255, "synch_weights_time_ms": 65.286}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00004", "date": "2024-08-03_10-39-27", "timestamp": 1722661767, "time_this_iter_s": 13.53011155128479, "time_total_s": 167.1579749584198, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00bfeb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 167.1579749584198, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 12.978947368421052, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.89143050809701, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.311574755609035, "policy_loss": -0.014386610577154594, "vf_loss": 7.320800765355428, "vf_explained_var": 0.705733074247837, "kl": 0.015565998639097718, "entropy": 1.8441122281054656, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -21.544617864772963, "episode_reward_min": -1442.831208819964, "episode_reward_mean": -791.6844547437141, "episode_len_mean": 140.82, "episode_media": {}, "episodes_timesteps_total": 14082, "policy_reward_min": {"policy_0": -1442.831208819964}, "policy_reward_max": {"policy_0": -21.544617864772963}, "policy_reward_mean": {"policy_0": -791.6844547437141}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-530.9430926051397, -1201.994965450887, -551.5991618225263, -897.9544139259932, -933.8830620922828, -570.9975350296446, -288.95261642972093, -1164.6652128933558, -728.3819726781816, -750.4287696318545, -1198.0133214468174, -489.87829498485536, -535.7757843643974, -679.0868423446142, -887.3214881244397, -762.6728471857213, -1024.6337030066425, -1282.478132597306, -1039.6899244192475, -858.2770519135768, -723.9404159229149, -878.7105688896902, -148.96047218104337, -1180.9742388387792, -833.3680932583095, -136.47557360711286, -1066.3102157708374, -974.1142398450929, -740.4720739916419, -1368.5614613736338, -1221.194530671102, -261.1395617544245, -1245.8738023741782, -810.7926100586233, -1336.268878894768, -983.9924135690434, -540.985058475651, -939.7808161641487, -617.6381866315568, -889.7219733245264, -557.1458217298434, -1228.694300515292, -911.6962412485216, -896.0439498829297, -323.0018239540357, -265.0298261811762, -484.8479725418354, -654.3044108015699, -829.040652182507, -1194.4060229757092, -1006.6827370369698, -1429.821300900822, -1195.7757892762077, -313.07938559225386, -91.23664603115851, -698.2357354400723, -26.097722935792163, -328.2992396924459, -1155.683039914731, -901.4247308936839, -88.70031444219437, -687.9687689706856, -527.4143792657181, -891.0874345428804, -1201.904977273521, -1062.5612723275049, -876.4526252510526, -568.394942416863, -1335.461892731066, -21.544617864772963, -928.346995244946, -548.785881536575, -1010.2328343294706, -1150.4771106352352, -234.60093066088896, -793.8560811196911, -1103.3710909493443, -882.0895147571307, -486.2449756470592, -92.97350073291918, -1442.831208819964, -806.9220618391174, -768.1653214407374, -1167.7809618317785, -679.2866096881074, -1069.0324368285212, -1155.980467394203, -695.329014718328, -647.4846661774907, -394.750361784748, -932.6218510821491, -1244.8011041009652, -306.4938871633753, -356.51538768379373, -688.4172756665221, -1080.981585863231, -1082.632744898616, -662.0933553677252, -1075.4090770534067, -650.9952259972832], "episode_lengths": [150, 150, 130, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 107, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 95, 76, 150, 49, 92, 150, 150, 72, 150, 150, 150, 150, 150, 150, 143, 150, 51, 150, 150, 150, 150, 83, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 148, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-530.9430926051397, -1201.994965450887, -551.5991618225263, -897.9544139259932, -933.8830620922828, -570.9975350296446, -288.95261642972093, -1164.6652128933558, -728.3819726781816, -750.4287696318545, -1198.0133214468174, -489.87829498485536, -535.7757843643974, -679.0868423446142, -887.3214881244397, -762.6728471857213, -1024.6337030066425, -1282.478132597306, -1039.6899244192475, -858.2770519135768, -723.9404159229149, -878.7105688896902, -148.96047218104337, -1180.9742388387792, -833.3680932583095, -136.47557360711286, -1066.3102157708374, -974.1142398450929, -740.4720739916419, -1368.5614613736338, -1221.194530671102, -261.1395617544245, -1245.8738023741782, -810.7926100586233, -1336.268878894768, -983.9924135690434, -540.985058475651, -939.7808161641487, -617.6381866315568, -889.7219733245264, -557.1458217298434, -1228.694300515292, -911.6962412485216, -896.0439498829297, -323.0018239540357, -265.0298261811762, -484.8479725418354, -654.3044108015699, -829.040652182507, -1194.4060229757092, -1006.6827370369698, -1429.821300900822, -1195.7757892762077, -313.07938559225386, -91.23664603115851, -698.2357354400723, -26.097722935792163, -328.2992396924459, -1155.683039914731, -901.4247308936839, -88.70031444219437, -687.9687689706856, -527.4143792657181, -891.0874345428804, -1201.904977273521, -1062.5612723275049, -876.4526252510526, -568.394942416863, -1335.461892731066, -21.544617864772963, -928.346995244946, -548.785881536575, -1010.2328343294706, -1150.4771106352352, -234.60093066088896, -793.8560811196911, -1103.3710909493443, -882.0895147571307, -486.2449756470592, -92.97350073291918, -1442.831208819964, -806.9220618391174, -768.1653214407374, -1167.7809618317785, -679.2866096881074, -1069.0324368285212, -1155.980467394203, -695.329014718328, -647.4846661774907, -394.750361784748, -932.6218510821491, -1244.8011041009652, -306.4938871633753, -356.51538768379373, -688.4172756665221, -1080.981585863231, -1082.632744898616, -662.0933553677252, -1075.4090770534067, -650.9952259972832]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5516938481456272, "mean_inference_ms": 1.6837189484832813, "mean_action_processing_ms": 0.27901833618508076, "mean_env_wait_ms": 3.032509321706546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012181758880615234, "StateBufferConnector_ms": 0.007861852645874023, "ViewRequirementAgentConnector_ms": 0.1944260597229004}, "num_episodes": 27, "episode_return_max": -21.544617864772963, "episode_return_min": -1442.831208819964, "episode_return_mean": -791.6844547437141, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.23263300414465, "num_env_steps_trained_throughput_per_sec": 300.23263300414465, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12278.247, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12278.172, "sample_time_ms": 1040.712, "learn_time_ms": 11172.229, "learn_throughput": 358.031, "synch_weights_time_ms": 64.42}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00004", "date": "2024-08-03_10-39-41", "timestamp": 1722661781, "time_this_iter_s": 13.336030006408691, "time_total_s": 180.4940049648285, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0ef80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 180.4940049648285, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 13.463157894736842, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.529232002298038, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.7058262492219605, "policy_loss": -0.013078987087161901, "vf_loss": 7.7138545269767445, "vf_explained_var": 0.7913027764608462, "kl": 0.015186781289897543, "entropy": 1.7833412484576305, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -15.148410126256456, "episode_reward_min": -1442.831208819964, "episode_reward_mean": -726.6726492617349, "episode_len_mean": 136.65, "episode_media": {}, "episodes_timesteps_total": 13665, "policy_reward_min": {"policy_0": -1442.831208819964}, "policy_reward_max": {"policy_0": -15.148410126256456}, "policy_reward_mean": {"policy_0": -726.6726492617349}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-261.1395617544245, -1245.8738023741782, -810.7926100586233, -1336.268878894768, -983.9924135690434, -540.985058475651, -939.7808161641487, -617.6381866315568, -889.7219733245264, -557.1458217298434, -1228.694300515292, -911.6962412485216, -896.0439498829297, -323.0018239540357, -265.0298261811762, -484.8479725418354, -654.3044108015699, -829.040652182507, -1194.4060229757092, -1006.6827370369698, -1429.821300900822, -1195.7757892762077, -313.07938559225386, -91.23664603115851, -698.2357354400723, -26.097722935792163, -328.2992396924459, -1155.683039914731, -901.4247308936839, -88.70031444219437, -687.9687689706856, -527.4143792657181, -891.0874345428804, -1201.904977273521, -1062.5612723275049, -876.4526252510526, -568.394942416863, -1335.461892731066, -21.544617864772963, -928.346995244946, -548.785881536575, -1010.2328343294706, -1150.4771106352352, -234.60093066088896, -793.8560811196911, -1103.3710909493443, -882.0895147571307, -486.2449756470592, -92.97350073291918, -1442.831208819964, -806.9220618391174, -768.1653214407374, -1167.7809618317785, -679.2866096881074, -1069.0324368285212, -1155.980467394203, -695.329014718328, -647.4846661774907, -394.750361784748, -932.6218510821491, -1244.8011041009652, -306.4938871633753, -356.51538768379373, -688.4172756665221, -1080.981585863231, -1082.632744898616, -662.0933553677252, -1075.4090770534067, -650.9952259972832, -330.7129437081679, -144.76206176314906, -665.6427298143367, -874.6593222515595, -1082.9421954143554, -887.4485354413381, -627.8983418866, -15.148410126256456, -682.8138112057164, -1437.934568526203, -512.707029373234, -153.92904999592395, -416.12573873345633, -343.3200168281104, -1098.859124602468, -192.23038970628352, -1358.3544812870834, -912.6739388557507, -843.0376474710607, -606.4192113822514, -134.78007449283027, -542.5624275793306, -399.47029708773744, -998.9435790453655, -883.1282638125795, -40.90037979906745, -797.7865006942513, -558.5218441075955, -482.7701660581298, -670.7036184327084, -452.34282961650814], "episode_lengths": [111, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 95, 76, 150, 49, 92, 150, 150, 72, 150, 150, 150, 150, 150, 150, 143, 150, 51, 150, 150, 150, 150, 83, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 148, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 88, 150, 150, 150, 150, 150, 36, 150, 150, 150, 89, 140, 116, 150, 94, 150, 150, 150, 131, 71, 150, 147, 150, 150, 65, 150, 150, 150, 136, 150], "policy_policy_0_reward": [-261.1395617544245, -1245.8738023741782, -810.7926100586233, -1336.268878894768, -983.9924135690434, -540.985058475651, -939.7808161641487, -617.6381866315568, -889.7219733245264, -557.1458217298434, -1228.694300515292, -911.6962412485216, -896.0439498829297, -323.0018239540357, -265.0298261811762, -484.8479725418354, -654.3044108015699, -829.040652182507, -1194.4060229757092, -1006.6827370369698, -1429.821300900822, -1195.7757892762077, -313.07938559225386, -91.23664603115851, -698.2357354400723, -26.097722935792163, -328.2992396924459, -1155.683039914731, -901.4247308936839, -88.70031444219437, -687.9687689706856, -527.4143792657181, -891.0874345428804, -1201.904977273521, -1062.5612723275049, -876.4526252510526, -568.394942416863, -1335.461892731066, -21.544617864772963, -928.346995244946, -548.785881536575, -1010.2328343294706, -1150.4771106352352, -234.60093066088896, -793.8560811196911, -1103.3710909493443, -882.0895147571307, -486.2449756470592, -92.97350073291918, -1442.831208819964, -806.9220618391174, -768.1653214407374, -1167.7809618317785, -679.2866096881074, -1069.0324368285212, -1155.980467394203, -695.329014718328, -647.4846661774907, -394.750361784748, -932.6218510821491, -1244.8011041009652, -306.4938871633753, -356.51538768379373, -688.4172756665221, -1080.981585863231, -1082.632744898616, -662.0933553677252, -1075.4090770534067, -650.9952259972832, -330.7129437081679, -144.76206176314906, -665.6427298143367, -874.6593222515595, -1082.9421954143554, -887.4485354413381, -627.8983418866, -15.148410126256456, -682.8138112057164, -1437.934568526203, -512.707029373234, -153.92904999592395, -416.12573873345633, -343.3200168281104, -1098.859124602468, -192.23038970628352, -1358.3544812870834, -912.6739388557507, -843.0376474710607, -606.4192113822514, -134.78007449283027, -542.5624275793306, -399.47029708773744, -998.9435790453655, -883.1282638125795, -40.90037979906745, -797.7865006942513, -558.5218441075955, -482.7701660581298, -670.7036184327084, -452.34282961650814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5513883733045724, "mean_inference_ms": 1.6835003731792486, "mean_action_processing_ms": 0.278730509292333, "mean_env_wait_ms": 3.0376019181526477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012087345123291016, "StateBufferConnector_ms": 0.00777125358581543, "ViewRequirementAgentConnector_ms": 0.19205594062805176}, "num_episodes": 31, "episode_return_max": -15.148410126256456, "episode_return_min": -1442.831208819964, "episode_return_mean": -726.6726492617349, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.29910852389395, "num_env_steps_trained_throughput_per_sec": 300.29910852389395, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12231.325, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12231.249, "sample_time_ms": 1045.473, "learn_time_ms": 11120.938, "learn_throughput": 359.682, "synch_weights_time_ms": 64.029}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00004", "date": "2024-08-03_10-39-54", "timestamp": 1722661794, "time_this_iter_s": 13.333949565887451, "time_total_s": 193.82795453071594, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a01088b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 193.82795453071594, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.43157894736842, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.36721670081218, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.19500595331192, "policy_loss": -0.007033507270777287, "vf_loss": 7.198037912448247, "vf_explained_var": 0.75252684460332, "kl": 0.013218956924053327, "entropy": 1.946975782389442, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -15.148410126256456, "episode_reward_min": -1442.831208819964, "episode_reward_mean": -748.8321660373235, "episode_len_mean": 137.82, "episode_media": {}, "episodes_timesteps_total": 13782, "policy_reward_min": {"policy_0": -1442.831208819964}, "policy_reward_max": {"policy_0": -15.148410126256456}, "policy_reward_mean": {"policy_0": -748.8321660373235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-328.2992396924459, -1155.683039914731, -901.4247308936839, -88.70031444219437, -687.9687689706856, -527.4143792657181, -891.0874345428804, -1201.904977273521, -1062.5612723275049, -876.4526252510526, -568.394942416863, -1335.461892731066, -21.544617864772963, -928.346995244946, -548.785881536575, -1010.2328343294706, -1150.4771106352352, -234.60093066088896, -793.8560811196911, -1103.3710909493443, -882.0895147571307, -486.2449756470592, -92.97350073291918, -1442.831208819964, -806.9220618391174, -768.1653214407374, -1167.7809618317785, -679.2866096881074, -1069.0324368285212, -1155.980467394203, -695.329014718328, -647.4846661774907, -394.750361784748, -932.6218510821491, -1244.8011041009652, -306.4938871633753, -356.51538768379373, -688.4172756665221, -1080.981585863231, -1082.632744898616, -662.0933553677252, -1075.4090770534067, -650.9952259972832, -330.7129437081679, -144.76206176314906, -665.6427298143367, -874.6593222515595, -1082.9421954143554, -887.4485354413381, -627.8983418866, -15.148410126256456, -682.8138112057164, -1437.934568526203, -512.707029373234, -153.92904999592395, -416.12573873345633, -343.3200168281104, -1098.859124602468, -192.23038970628352, -1358.3544812870834, -912.6739388557507, -843.0376474710607, -606.4192113822514, -134.78007449283027, -542.5624275793306, -399.47029708773744, -998.9435790453655, -883.1282638125795, -40.90037979906745, -797.7865006942513, -558.5218441075955, -482.7701660581298, -670.7036184327084, -452.34282961650814, -1380.773445935213, -1259.696643784881, -1239.1150304026585, -696.1102389968631, -1380.8328728096494, -845.5455335754128, -1092.1688331405617, -1259.9527450285261, -331.3574106166368, -690.9604697658369, -708.1104864904147, -578.1247747282931, -610.0216246896672, -389.0779981485133, -1093.661690421136, -698.3126631284783, -1126.3382056726293, -89.88765078037173, -1175.346470934089, -544.5712190293831, -764.9713090069712, -806.8419003196799, -250.5891758452403, -804.0168074961546, -1184.037312775811, -946.8628045094393], "episode_lengths": [92, 150, 150, 72, 150, 150, 150, 150, 150, 150, 143, 150, 51, 150, 150, 150, 150, 83, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 148, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 88, 150, 150, 150, 150, 150, 36, 150, 150, 150, 89, 140, 116, 150, 94, 150, 150, 150, 131, 71, 150, 147, 150, 150, 65, 150, 150, 150, 136, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 80, 150, 150, 150], "policy_policy_0_reward": [-328.2992396924459, -1155.683039914731, -901.4247308936839, -88.70031444219437, -687.9687689706856, -527.4143792657181, -891.0874345428804, -1201.904977273521, -1062.5612723275049, -876.4526252510526, -568.394942416863, -1335.461892731066, -21.544617864772963, -928.346995244946, -548.785881536575, -1010.2328343294706, -1150.4771106352352, -234.60093066088896, -793.8560811196911, -1103.3710909493443, -882.0895147571307, -486.2449756470592, -92.97350073291918, -1442.831208819964, -806.9220618391174, -768.1653214407374, -1167.7809618317785, -679.2866096881074, -1069.0324368285212, -1155.980467394203, -695.329014718328, -647.4846661774907, -394.750361784748, -932.6218510821491, -1244.8011041009652, -306.4938871633753, -356.51538768379373, -688.4172756665221, -1080.981585863231, -1082.632744898616, -662.0933553677252, -1075.4090770534067, -650.9952259972832, -330.7129437081679, -144.76206176314906, -665.6427298143367, -874.6593222515595, -1082.9421954143554, -887.4485354413381, -627.8983418866, -15.148410126256456, -682.8138112057164, -1437.934568526203, -512.707029373234, -153.92904999592395, -416.12573873345633, -343.3200168281104, -1098.859124602468, -192.23038970628352, -1358.3544812870834, -912.6739388557507, -843.0376474710607, -606.4192113822514, -134.78007449283027, -542.5624275793306, -399.47029708773744, -998.9435790453655, -883.1282638125795, -40.90037979906745, -797.7865006942513, -558.5218441075955, -482.7701660581298, -670.7036184327084, -452.34282961650814, -1380.773445935213, -1259.696643784881, -1239.1150304026585, -696.1102389968631, -1380.8328728096494, -845.5455335754128, -1092.1688331405617, -1259.9527450285261, -331.3574106166368, -690.9604697658369, -708.1104864904147, -578.1247747282931, -610.0216246896672, -389.0779981485133, -1093.661690421136, -698.3126631284783, -1126.3382056726293, -89.88765078037173, -1175.346470934089, -544.5712190293831, -764.9713090069712, -806.8419003196799, -250.5891758452403, -804.0168074961546, -1184.037312775811, -946.8628045094393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5510786565048819, "mean_inference_ms": 1.6830912588079294, "mean_action_processing_ms": 0.27842267701537404, "mean_env_wait_ms": 3.0426209551010546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012179851531982422, "StateBufferConnector_ms": 0.008013248443603516, "ViewRequirementAgentConnector_ms": 0.19690251350402832}, "num_episodes": 26, "episode_return_max": -15.148410126256456, "episode_return_min": -1442.831208819964, "episode_return_mean": -748.8321660373235, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.9534648197403, "num_env_steps_trained_throughput_per_sec": 302.9534648197403, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12220.2, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12220.123, "sample_time_ms": 1050.595, "learn_time_ms": 11107.046, "learn_throughput": 360.132, "synch_weights_time_ms": 61.656}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00004", "date": "2024-08-03_10-40-08", "timestamp": 1722661808, "time_this_iter_s": 13.217006921768188, "time_total_s": 207.04496145248413, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a290752f80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 207.04496145248413, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.594736842105263, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.113436318933964, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.332454158862432, "policy_loss": -0.011590099004873384, "vf_loss": 7.338681477308273, "vf_explained_var": 0.8560393620903294, "kl": 0.01613624077096271, "entropy": 1.898524279644092, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -15.148410126256456, "episode_reward_min": -1437.934568526203, "episode_reward_mean": -765.8781676995991, "episode_len_mean": 138.92, "episode_media": {}, "episodes_timesteps_total": 13892, "policy_reward_min": {"policy_0": -1437.934568526203}, "policy_reward_max": {"policy_0": -15.148410126256456}, "policy_reward_mean": {"policy_0": -765.8781676995991}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-695.329014718328, -647.4846661774907, -394.750361784748, -932.6218510821491, -1244.8011041009652, -306.4938871633753, -356.51538768379373, -688.4172756665221, -1080.981585863231, -1082.632744898616, -662.0933553677252, -1075.4090770534067, -650.9952259972832, -330.7129437081679, -144.76206176314906, -665.6427298143367, -874.6593222515595, -1082.9421954143554, -887.4485354413381, -627.8983418866, -15.148410126256456, -682.8138112057164, -1437.934568526203, -512.707029373234, -153.92904999592395, -416.12573873345633, -343.3200168281104, -1098.859124602468, -192.23038970628352, -1358.3544812870834, -912.6739388557507, -843.0376474710607, -606.4192113822514, -134.78007449283027, -542.5624275793306, -399.47029708773744, -998.9435790453655, -883.1282638125795, -40.90037979906745, -797.7865006942513, -558.5218441075955, -482.7701660581298, -670.7036184327084, -452.34282961650814, -1380.773445935213, -1259.696643784881, -1239.1150304026585, -696.1102389968631, -1380.8328728096494, -845.5455335754128, -1092.1688331405617, -1259.9527450285261, -331.3574106166368, -690.9604697658369, -708.1104864904147, -578.1247747282931, -610.0216246896672, -389.0779981485133, -1093.661690421136, -698.3126631284783, -1126.3382056726293, -89.88765078037173, -1175.346470934089, -544.5712190293831, -764.9713090069712, -806.8419003196799, -250.5891758452403, -804.0168074961546, -1184.037312775811, -946.8628045094393, -884.3130710203036, -1006.1575174037152, -1097.6952231804594, -1270.1293212602232, -968.7641509637916, -244.02932965915105, -357.39703623670687, -912.9787145663161, -739.5867691936024, -961.5875038071237, -836.1029575299118, -1016.9664405092345, -1121.1031790675431, -40.27750847326893, -1042.082879176607, -1258.617836795028, -263.1706483639767, -968.595705374079, -1185.3571668187867, -1321.5019236556393, -421.13910306550787, -758.8664831910341, -1269.4606148652838, -1239.7621232530482, -431.46415983380814, -324.34904883467175, -882.9514423370271, -1011.603552657564, -1414.4049092675023, -422.06006490945936], "episode_lengths": [150, 148, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 88, 150, 150, 150, 150, 150, 36, 150, 150, 150, 89, 140, 116, 150, 94, 150, 150, 150, 131, 71, 150, 147, 150, 150, 65, 150, 150, 150, 136, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 118, 132, 150, 150, 150, 150, 150, 150, 57, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 118], "policy_policy_0_reward": [-695.329014718328, -647.4846661774907, -394.750361784748, -932.6218510821491, -1244.8011041009652, -306.4938871633753, -356.51538768379373, -688.4172756665221, -1080.981585863231, -1082.632744898616, -662.0933553677252, -1075.4090770534067, -650.9952259972832, -330.7129437081679, -144.76206176314906, -665.6427298143367, -874.6593222515595, -1082.9421954143554, -887.4485354413381, -627.8983418866, -15.148410126256456, -682.8138112057164, -1437.934568526203, -512.707029373234, -153.92904999592395, -416.12573873345633, -343.3200168281104, -1098.859124602468, -192.23038970628352, -1358.3544812870834, -912.6739388557507, -843.0376474710607, -606.4192113822514, -134.78007449283027, -542.5624275793306, -399.47029708773744, -998.9435790453655, -883.1282638125795, -40.90037979906745, -797.7865006942513, -558.5218441075955, -482.7701660581298, -670.7036184327084, -452.34282961650814, -1380.773445935213, -1259.696643784881, -1239.1150304026585, -696.1102389968631, -1380.8328728096494, -845.5455335754128, -1092.1688331405617, -1259.9527450285261, -331.3574106166368, -690.9604697658369, -708.1104864904147, -578.1247747282931, -610.0216246896672, -389.0779981485133, -1093.661690421136, -698.3126631284783, -1126.3382056726293, -89.88765078037173, -1175.346470934089, -544.5712190293831, -764.9713090069712, -806.8419003196799, -250.5891758452403, -804.0168074961546, -1184.037312775811, -946.8628045094393, -884.3130710203036, -1006.1575174037152, -1097.6952231804594, -1270.1293212602232, -968.7641509637916, -244.02932965915105, -357.39703623670687, -912.9787145663161, -739.5867691936024, -961.5875038071237, -836.1029575299118, -1016.9664405092345, -1121.1031790675431, -40.27750847326893, -1042.082879176607, -1258.617836795028, -263.1706483639767, -968.595705374079, -1185.3571668187867, -1321.5019236556393, -421.13910306550787, -758.8664831910341, -1269.4606148652838, -1239.7621232530482, -431.46415983380814, -324.34904883467175, -882.9514423370271, -1011.603552657564, -1414.4049092675023, -422.06006490945936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5510086050364351, "mean_inference_ms": 1.682865489986616, "mean_action_processing_ms": 0.2782050376250706, "mean_env_wait_ms": 3.0500139872438536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012505531311035156, "StateBufferConnector_ms": 0.008203268051147461, "ViewRequirementAgentConnector_ms": 0.19664812088012695}, "num_episodes": 30, "episode_return_max": -15.148410126256456, "episode_return_min": -1437.934568526203, "episode_return_mean": -765.8781676995991, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.58848058562563, "num_env_steps_trained_throughput_per_sec": 292.58848058562563, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12241.956, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12241.879, "sample_time_ms": 1055.079, "learn_time_ms": 11123.65, "learn_throughput": 359.594, "synch_weights_time_ms": 62.314}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00004", "date": "2024-08-03_10-40-21", "timestamp": 1722661821, "time_this_iter_s": 13.683836221694946, "time_total_s": 220.72879767417908, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907b9f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 220.72879767417908, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.605263157894736, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.50861653884252, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.7321958581606545, "policy_loss": -0.008314673319303741, "vf_loss": 7.736382732788722, "vf_explained_var": 0.8748044618715842, "kl": 0.013701354567168285, "entropy": 2.037795240804553, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -40.27750847326893, "episode_reward_min": -1414.4049092675023, "episode_reward_mean": -788.8050047987208, "episode_len_mean": 138.41, "episode_media": {}, "episodes_timesteps_total": 13841, "policy_reward_min": {"policy_0": -1414.4049092675023}, "policy_reward_max": {"policy_0": -40.27750847326893}, "policy_reward_mean": {"policy_0": -788.8050047987208}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1358.3544812870834, -912.6739388557507, -843.0376474710607, -606.4192113822514, -134.78007449283027, -542.5624275793306, -399.47029708773744, -998.9435790453655, -883.1282638125795, -40.90037979906745, -797.7865006942513, -558.5218441075955, -482.7701660581298, -670.7036184327084, -452.34282961650814, -1380.773445935213, -1259.696643784881, -1239.1150304026585, -696.1102389968631, -1380.8328728096494, -845.5455335754128, -1092.1688331405617, -1259.9527450285261, -331.3574106166368, -690.9604697658369, -708.1104864904147, -578.1247747282931, -610.0216246896672, -389.0779981485133, -1093.661690421136, -698.3126631284783, -1126.3382056726293, -89.88765078037173, -1175.346470934089, -544.5712190293831, -764.9713090069712, -806.8419003196799, -250.5891758452403, -804.0168074961546, -1184.037312775811, -946.8628045094393, -884.3130710203036, -1006.1575174037152, -1097.6952231804594, -1270.1293212602232, -968.7641509637916, -244.02932965915105, -357.39703623670687, -912.9787145663161, -739.5867691936024, -961.5875038071237, -836.1029575299118, -1016.9664405092345, -1121.1031790675431, -40.27750847326893, -1042.082879176607, -1258.617836795028, -263.1706483639767, -968.595705374079, -1185.3571668187867, -1321.5019236556393, -421.13910306550787, -758.8664831910341, -1269.4606148652838, -1239.7621232530482, -431.46415983380814, -324.34904883467175, -882.9514423370271, -1011.603552657564, -1414.4049092675023, -422.06006490945936, -132.5063669229254, -985.3374075755053, -936.4266568493002, -79.90626444903367, -704.6192158914414, -675.2633957765028, -961.8807297415385, -53.24197766370508, -1363.9533086417714, -826.6939308913793, -66.52035486393886, -165.68587413438124, -926.6807423344453, -758.2429829326735, -922.2666236971428, -1065.0892582897718, -994.3841628857201, -1131.683626755125, -1207.700269660382, -839.0775065775057, -245.75966288003394, -1053.6184739352568, -491.5406533031392, -471.69567098789537, -1260.5152404428682, -1237.6546795126274, -937.3961139894463, -527.3621751295248, -555.6401901319259], "episode_lengths": [150, 150, 150, 131, 71, 150, 147, 150, 150, 65, 150, 150, 150, 136, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 118, 132, 150, 150, 150, 150, 150, 150, 57, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 118, 90, 150, 150, 67, 150, 150, 150, 65, 150, 150, 46, 68, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 144, 141], "policy_policy_0_reward": [-1358.3544812870834, -912.6739388557507, -843.0376474710607, -606.4192113822514, -134.78007449283027, -542.5624275793306, -399.47029708773744, -998.9435790453655, -883.1282638125795, -40.90037979906745, -797.7865006942513, -558.5218441075955, -482.7701660581298, -670.7036184327084, -452.34282961650814, -1380.773445935213, -1259.696643784881, -1239.1150304026585, -696.1102389968631, -1380.8328728096494, -845.5455335754128, -1092.1688331405617, -1259.9527450285261, -331.3574106166368, -690.9604697658369, -708.1104864904147, -578.1247747282931, -610.0216246896672, -389.0779981485133, -1093.661690421136, -698.3126631284783, -1126.3382056726293, -89.88765078037173, -1175.346470934089, -544.5712190293831, -764.9713090069712, -806.8419003196799, -250.5891758452403, -804.0168074961546, -1184.037312775811, -946.8628045094393, -884.3130710203036, -1006.1575174037152, -1097.6952231804594, -1270.1293212602232, -968.7641509637916, -244.02932965915105, -357.39703623670687, -912.9787145663161, -739.5867691936024, -961.5875038071237, -836.1029575299118, -1016.9664405092345, -1121.1031790675431, -40.27750847326893, -1042.082879176607, -1258.617836795028, -263.1706483639767, -968.595705374079, -1185.3571668187867, -1321.5019236556393, -421.13910306550787, -758.8664831910341, -1269.4606148652838, -1239.7621232530482, -431.46415983380814, -324.34904883467175, -882.9514423370271, -1011.603552657564, -1414.4049092675023, -422.06006490945936, -132.5063669229254, -985.3374075755053, -936.4266568493002, -79.90626444903367, -704.6192158914414, -675.2633957765028, -961.8807297415385, -53.24197766370508, -1363.9533086417714, -826.6939308913793, -66.52035486393886, -165.68587413438124, -926.6807423344453, -758.2429829326735, -922.2666236971428, -1065.0892582897718, -994.3841628857201, -1131.683626755125, -1207.700269660382, -839.0775065775057, -245.75966288003394, -1053.6184739352568, -491.5406533031392, -471.69567098789537, -1260.5152404428682, -1237.6546795126274, -937.3961139894463, -527.3621751295248, -555.6401901319259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5507252583351505, "mean_inference_ms": 1.6828281283635151, "mean_action_processing_ms": 0.27813074934126947, "mean_env_wait_ms": 3.056108601796173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012951135635375977, "StateBufferConnector_ms": 0.008201122283935547, "ViewRequirementAgentConnector_ms": 0.19785642623901367}, "num_episodes": 29, "episode_return_max": -40.27750847326893, "episode_return_min": -1414.4049092675023, "episode_return_mean": -788.8050047987208, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 484.30654255161454, "num_env_steps_trained_throughput_per_sec": 484.30654255161454, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 11737.487, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11737.407, "sample_time_ms": 1066.197, "learn_time_ms": 10609.962, "learn_throughput": 377.004, "synch_weights_time_ms": 60.428}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00004", "date": "2024-08-03_10-40-30", "timestamp": 1722661830, "time_this_iter_s": 8.271825075149536, "time_total_s": 229.0006227493286, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0d750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 229.0006227493286, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.34166666666667, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 55.351541848977405, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.999040327966213, "policy_loss": -0.010965253008180298, "vf_loss": 7.005472671737274, "vf_explained_var": 0.8443641743312279, "kl": 0.013847430628978448, "entropy": 1.6984293231119711, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -40.27750847326893, "episode_reward_min": -1493.4815400143796, "episode_reward_mean": -792.9999532756535, "episode_len_mean": 138.46, "episode_media": {}, "episodes_timesteps_total": 13846, "policy_reward_min": {"policy_0": -1493.4815400143796}, "policy_reward_max": {"policy_0": -40.27750847326893}, "policy_reward_mean": {"policy_0": -792.9999532756535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1093.661690421136, -698.3126631284783, -1126.3382056726293, -89.88765078037173, -1175.346470934089, -544.5712190293831, -764.9713090069712, -806.8419003196799, -250.5891758452403, -804.0168074961546, -1184.037312775811, -946.8628045094393, -884.3130710203036, -1006.1575174037152, -1097.6952231804594, -1270.1293212602232, -968.7641509637916, -244.02932965915105, -357.39703623670687, -912.9787145663161, -739.5867691936024, -961.5875038071237, -836.1029575299118, -1016.9664405092345, -1121.1031790675431, -40.27750847326893, -1042.082879176607, -1258.617836795028, -263.1706483639767, -968.595705374079, -1185.3571668187867, -1321.5019236556393, -421.13910306550787, -758.8664831910341, -1269.4606148652838, -1239.7621232530482, -431.46415983380814, -324.34904883467175, -882.9514423370271, -1011.603552657564, -1414.4049092675023, -422.06006490945936, -132.5063669229254, -985.3374075755053, -936.4266568493002, -79.90626444903367, -704.6192158914414, -675.2633957765028, -961.8807297415385, -53.24197766370508, -1363.9533086417714, -826.6939308913793, -66.52035486393886, -165.68587413438124, -926.6807423344453, -758.2429829326735, -922.2666236971428, -1065.0892582897718, -994.3841628857201, -1131.683626755125, -1207.700269660382, -839.0775065775057, -245.75966288003394, -1053.6184739352568, -491.5406533031392, -471.69567098789537, -1260.5152404428682, -1237.6546795126274, -937.3961139894463, -527.3621751295248, -555.6401901319259, -206.5687220406239, -742.5675274205973, -1011.9624232006788, -444.00289395119427, -407.36840330316295, -1345.1905135198815, -390.97342801318155, -489.63638673735875, -865.955305813532, -782.9926236381426, -1167.892989460867, -208.41116263999825, -587.2441066470423, -267.0107218871503, -725.6276862690779, -818.2752048626796, -288.4859742340044, -1220.806587832682, -1403.976270659461, -354.74847075455216, -1458.9436465573333, -1016.847226450056, -1243.8364154059575, -862.883513134452, -621.4000554624529, -756.2894638543987, -1197.3719139511193, -182.9870378126666, -1493.4815400143796], "episode_lengths": [150, 150, 150, 59, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 118, 132, 150, 150, 150, 150, 150, 150, 57, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 118, 90, 150, 150, 67, 150, 150, 150, 65, 150, 150, 46, 68, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 144, 141, 114, 150, 150, 104, 150, 150, 135, 121, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150], "policy_policy_0_reward": [-1093.661690421136, -698.3126631284783, -1126.3382056726293, -89.88765078037173, -1175.346470934089, -544.5712190293831, -764.9713090069712, -806.8419003196799, -250.5891758452403, -804.0168074961546, -1184.037312775811, -946.8628045094393, -884.3130710203036, -1006.1575174037152, -1097.6952231804594, -1270.1293212602232, -968.7641509637916, -244.02932965915105, -357.39703623670687, -912.9787145663161, -739.5867691936024, -961.5875038071237, -836.1029575299118, -1016.9664405092345, -1121.1031790675431, -40.27750847326893, -1042.082879176607, -1258.617836795028, -263.1706483639767, -968.595705374079, -1185.3571668187867, -1321.5019236556393, -421.13910306550787, -758.8664831910341, -1269.4606148652838, -1239.7621232530482, -431.46415983380814, -324.34904883467175, -882.9514423370271, -1011.603552657564, -1414.4049092675023, -422.06006490945936, -132.5063669229254, -985.3374075755053, -936.4266568493002, -79.90626444903367, -704.6192158914414, -675.2633957765028, -961.8807297415385, -53.24197766370508, -1363.9533086417714, -826.6939308913793, -66.52035486393886, -165.68587413438124, -926.6807423344453, -758.2429829326735, -922.2666236971428, -1065.0892582897718, -994.3841628857201, -1131.683626755125, -1207.700269660382, -839.0775065775057, -245.75966288003394, -1053.6184739352568, -491.5406533031392, -471.69567098789537, -1260.5152404428682, -1237.6546795126274, -937.3961139894463, -527.3621751295248, -555.6401901319259, -206.5687220406239, -742.5675274205973, -1011.9624232006788, -444.00289395119427, -407.36840330316295, -1345.1905135198815, -390.97342801318155, -489.63638673735875, -865.955305813532, -782.9926236381426, -1167.892989460867, -208.41116263999825, -587.2441066470423, -267.0107218871503, -725.6276862690779, -818.2752048626796, -288.4859742340044, -1220.806587832682, -1403.976270659461, -354.74847075455216, -1458.9436465573333, -1016.847226450056, -1243.8364154059575, -862.883513134452, -621.4000554624529, -756.2894638543987, -1197.3719139511193, -182.9870378126666, -1493.4815400143796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5498994472586017, "mean_inference_ms": 1.6815748665025305, "mean_action_processing_ms": 0.27779430029160956, "mean_env_wait_ms": 3.0610064069092244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012674331665039062, "StateBufferConnector_ms": 0.008018016815185547, "ViewRequirementAgentConnector_ms": 0.1937119960784912}, "num_episodes": 29, "episode_return_max": -40.27750847326893, "episode_return_min": -1493.4815400143796, "episode_return_mean": -792.9999532756535, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.2207542322988, "num_env_steps_trained_throughput_per_sec": 293.2207542322988, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 11773.487, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11773.409, "sample_time_ms": 1065.16, "learn_time_ms": 10646.502, "learn_throughput": 375.71, "synch_weights_time_ms": 60.927}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00004", "date": "2024-08-03_10-40-43", "timestamp": 1722661843, "time_this_iter_s": 13.65348505973816, "time_total_s": 242.65410780906677, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0fd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 242.65410780906677, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 12.885, "ram_util_percent": 27.669999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.921942693988484, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.056825344761212, "policy_loss": -0.009907487299157462, "vf_loss": 7.061778491238753, "vf_explained_var": 0.8594777459899584, "kl": 0.01474108460336841, "entropy": 1.6791335033873718, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -26.199191025053622, "episode_reward_min": -1493.4815400143796, "episode_reward_mean": -755.8002626232144, "episode_len_mean": 137.36, "episode_media": {}, "episodes_timesteps_total": 13736, "policy_reward_min": {"policy_0": -1493.4815400143796}, "policy_reward_max": {"policy_0": -26.199191025053622}, "policy_reward_mean": {"policy_0": -755.8002626232144}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1185.3571668187867, -1321.5019236556393, -421.13910306550787, -758.8664831910341, -1269.4606148652838, -1239.7621232530482, -431.46415983380814, -324.34904883467175, -882.9514423370271, -1011.603552657564, -1414.4049092675023, -422.06006490945936, -132.5063669229254, -985.3374075755053, -936.4266568493002, -79.90626444903367, -704.6192158914414, -675.2633957765028, -961.8807297415385, -53.24197766370508, -1363.9533086417714, -826.6939308913793, -66.52035486393886, -165.68587413438124, -926.6807423344453, -758.2429829326735, -922.2666236971428, -1065.0892582897718, -994.3841628857201, -1131.683626755125, -1207.700269660382, -839.0775065775057, -245.75966288003394, -1053.6184739352568, -491.5406533031392, -471.69567098789537, -1260.5152404428682, -1237.6546795126274, -937.3961139894463, -527.3621751295248, -555.6401901319259, -206.5687220406239, -742.5675274205973, -1011.9624232006788, -444.00289395119427, -407.36840330316295, -1345.1905135198815, -390.97342801318155, -489.63638673735875, -865.955305813532, -782.9926236381426, -1167.892989460867, -208.41116263999825, -587.2441066470423, -267.0107218871503, -725.6276862690779, -818.2752048626796, -288.4859742340044, -1220.806587832682, -1403.976270659461, -354.74847075455216, -1458.9436465573333, -1016.847226450056, -1243.8364154059575, -862.883513134452, -621.4000554624529, -756.2894638543987, -1197.3719139511193, -182.9870378126666, -1493.4815400143796, -903.9138237168983, -983.7554363178964, -26.199191025053622, -417.6280310948272, -524.4034338862442, -503.91447661383455, -876.6996622322836, -464.5873465956664, -91.21494163336459, -124.24191118038469, -606.4003045825317, -459.2014282502879, -941.4606915315597, -760.3470835807019, -800.374453544231, -543.5736853815298, -455.2415018562231, -1398.725926951967, -1209.6666603419774, -324.219150775422, -315.31276893116006, -275.62343879835765, -1220.3584696824787, -1013.7925750114775, -1326.3681299810996, -1290.7382634117434, -1430.783670120442, -644.8294729812704, -617.6970591814663, -203.75094806413398], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 118, 90, 150, 150, 67, 150, 150, 150, 65, 150, 150, 46, 68, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 144, 141, 114, 150, 150, 104, 150, 150, 135, 121, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 63, 145, 150, 150, 150, 115, 76, 88, 150, 124, 150, 150, 150, 150, 150, 150, 150, 124, 94, 94, 150, 150, 150, 150, 150, 150, 150, 99], "policy_policy_0_reward": [-1185.3571668187867, -1321.5019236556393, -421.13910306550787, -758.8664831910341, -1269.4606148652838, -1239.7621232530482, -431.46415983380814, -324.34904883467175, -882.9514423370271, -1011.603552657564, -1414.4049092675023, -422.06006490945936, -132.5063669229254, -985.3374075755053, -936.4266568493002, -79.90626444903367, -704.6192158914414, -675.2633957765028, -961.8807297415385, -53.24197766370508, -1363.9533086417714, -826.6939308913793, -66.52035486393886, -165.68587413438124, -926.6807423344453, -758.2429829326735, -922.2666236971428, -1065.0892582897718, -994.3841628857201, -1131.683626755125, -1207.700269660382, -839.0775065775057, -245.75966288003394, -1053.6184739352568, -491.5406533031392, -471.69567098789537, -1260.5152404428682, -1237.6546795126274, -937.3961139894463, -527.3621751295248, -555.6401901319259, -206.5687220406239, -742.5675274205973, -1011.9624232006788, -444.00289395119427, -407.36840330316295, -1345.1905135198815, -390.97342801318155, -489.63638673735875, -865.955305813532, -782.9926236381426, -1167.892989460867, -208.41116263999825, -587.2441066470423, -267.0107218871503, -725.6276862690779, -818.2752048626796, -288.4859742340044, -1220.806587832682, -1403.976270659461, -354.74847075455216, -1458.9436465573333, -1016.847226450056, -1243.8364154059575, -862.883513134452, -621.4000554624529, -756.2894638543987, -1197.3719139511193, -182.9870378126666, -1493.4815400143796, -903.9138237168983, -983.7554363178964, -26.199191025053622, -417.6280310948272, -524.4034338862442, -503.91447661383455, -876.6996622322836, -464.5873465956664, -91.21494163336459, -124.24191118038469, -606.4003045825317, -459.2014282502879, -941.4606915315597, -760.3470835807019, -800.374453544231, -543.5736853815298, -455.2415018562231, -1398.725926951967, -1209.6666603419774, -324.219150775422, -315.31276893116006, -275.62343879835765, -1220.3584696824787, -1013.7925750114775, -1326.3681299810996, -1290.7382634117434, -1430.783670120442, -644.8294729812704, -617.6970591814663, -203.75094806413398]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5493431654268814, "mean_inference_ms": 1.6800313631566162, "mean_action_processing_ms": 0.2774645190929375, "mean_env_wait_ms": 3.0630738346184008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012798309326171875, "StateBufferConnector_ms": 0.007824420928955078, "ViewRequirementAgentConnector_ms": 0.19271039962768555}, "num_episodes": 30, "episode_return_max": -26.199191025053622, "episode_return_min": -1493.4815400143796, "episode_return_mean": -755.8002626232144, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.7082931746395, "num_env_steps_trained_throughput_per_sec": 297.7082931746395, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 11788.46, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11788.381, "sample_time_ms": 1059.728, "learn_time_ms": 10665.235, "learn_throughput": 375.05, "synch_weights_time_ms": 62.598}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00004", "date": "2024-08-03_10-40-57", "timestamp": 1722661857, "time_this_iter_s": 13.447930574417114, "time_total_s": 256.1020383834839, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a290753370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 256.1020383834839, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.11578947368421, "ram_util_percent": 27.678947368421056}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 66.81595951318741, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.036850753923257, "policy_loss": -0.012014299773727543, "vf_loss": 7.04415179292361, "vf_explained_var": 0.8334530758981903, "kl": 0.014785179856395821, "entropy": 1.9400635102142891, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -26.199191025053622, "episode_reward_min": -1493.4815400143796, "episode_reward_mean": -763.5538947505298, "episode_len_mean": 139.38, "episode_media": {}, "episodes_timesteps_total": 13938, "policy_reward_min": {"policy_0": -1493.4815400143796}, "policy_reward_max": {"policy_0": -26.199191025053622}, "policy_reward_mean": {"policy_0": -763.5538947505298}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-994.3841628857201, -1131.683626755125, -1207.700269660382, -839.0775065775057, -245.75966288003394, -1053.6184739352568, -491.5406533031392, -471.69567098789537, -1260.5152404428682, -1237.6546795126274, -937.3961139894463, -527.3621751295248, -555.6401901319259, -206.5687220406239, -742.5675274205973, -1011.9624232006788, -444.00289395119427, -407.36840330316295, -1345.1905135198815, -390.97342801318155, -489.63638673735875, -865.955305813532, -782.9926236381426, -1167.892989460867, -208.41116263999825, -587.2441066470423, -267.0107218871503, -725.6276862690779, -818.2752048626796, -288.4859742340044, -1220.806587832682, -1403.976270659461, -354.74847075455216, -1458.9436465573333, -1016.847226450056, -1243.8364154059575, -862.883513134452, -621.4000554624529, -756.2894638543987, -1197.3719139511193, -182.9870378126666, -1493.4815400143796, -903.9138237168983, -983.7554363178964, -26.199191025053622, -417.6280310948272, -524.4034338862442, -503.91447661383455, -876.6996622322836, -464.5873465956664, -91.21494163336459, -124.24191118038469, -606.4003045825317, -459.2014282502879, -941.4606915315597, -760.3470835807019, -800.374453544231, -543.5736853815298, -455.2415018562231, -1398.725926951967, -1209.6666603419774, -324.219150775422, -315.31276893116006, -275.62343879835765, -1220.3584696824787, -1013.7925750114775, -1326.3681299810996, -1290.7382634117434, -1430.783670120442, -644.8294729812704, -617.6970591814663, -203.75094806413398, -587.9771204004792, -159.5888676585545, -1315.4008898908753, -565.9042819003569, -1184.312850696141, -607.4807682154777, -767.4028353624155, -436.8152113912107, -811.615358621756, -858.5966840165512, -1275.0887280174124, -715.5275610991174, -1396.243388639099, -1146.771018174812, -947.9225866577503, -1141.7359347173422, -828.786798357504, -629.4891466090879, -1061.9480757821627, -898.7485545890792, -953.973506545492, -215.0693764973993, -95.32748617728849, -899.3857514627724, -678.7890269751312, -579.6006754299569, -522.2414667882082, -800.854945402891], "episode_lengths": [150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 144, 141, 114, 150, 150, 104, 150, 150, 135, 121, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 63, 145, 150, 150, 150, 115, 76, 88, 150, 124, 150, 150, 150, 150, 150, 150, 150, 124, 94, 94, 150, 150, 150, 150, 150, 150, 150, 99, 129, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 72, 66, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-994.3841628857201, -1131.683626755125, -1207.700269660382, -839.0775065775057, -245.75966288003394, -1053.6184739352568, -491.5406533031392, -471.69567098789537, -1260.5152404428682, -1237.6546795126274, -937.3961139894463, -527.3621751295248, -555.6401901319259, -206.5687220406239, -742.5675274205973, -1011.9624232006788, -444.00289395119427, -407.36840330316295, -1345.1905135198815, -390.97342801318155, -489.63638673735875, -865.955305813532, -782.9926236381426, -1167.892989460867, -208.41116263999825, -587.2441066470423, -267.0107218871503, -725.6276862690779, -818.2752048626796, -288.4859742340044, -1220.806587832682, -1403.976270659461, -354.74847075455216, -1458.9436465573333, -1016.847226450056, -1243.8364154059575, -862.883513134452, -621.4000554624529, -756.2894638543987, -1197.3719139511193, -182.9870378126666, -1493.4815400143796, -903.9138237168983, -983.7554363178964, -26.199191025053622, -417.6280310948272, -524.4034338862442, -503.91447661383455, -876.6996622322836, -464.5873465956664, -91.21494163336459, -124.24191118038469, -606.4003045825317, -459.2014282502879, -941.4606915315597, -760.3470835807019, -800.374453544231, -543.5736853815298, -455.2415018562231, -1398.725926951967, -1209.6666603419774, -324.219150775422, -315.31276893116006, -275.62343879835765, -1220.3584696824787, -1013.7925750114775, -1326.3681299810996, -1290.7382634117434, -1430.783670120442, -644.8294729812704, -617.6970591814663, -203.75094806413398, -587.9771204004792, -159.5888676585545, -1315.4008898908753, -565.9042819003569, -1184.312850696141, -607.4807682154777, -767.4028353624155, -436.8152113912107, -811.615358621756, -858.5966840165512, -1275.0887280174124, -715.5275610991174, -1396.243388639099, -1146.771018174812, -947.9225866577503, -1141.7359347173422, -828.786798357504, -629.4891466090879, -1061.9480757821627, -898.7485545890792, -953.973506545492, -215.0693764973993, -95.32748617728849, -899.3857514627724, -678.7890269751312, -579.6006754299569, -522.2414667882082, -800.854945402891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5489778745799114, "mean_inference_ms": 1.679117816694639, "mean_action_processing_ms": 0.2773052773210596, "mean_env_wait_ms": 3.0673854077205083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012235879898071289, "StateBufferConnector_ms": 0.007810115814208984, "ViewRequirementAgentConnector_ms": 0.19339990615844727}, "num_episodes": 28, "episode_return_max": -26.199191025053622, "episode_return_min": -1493.4815400143796, "episode_return_mean": -763.5538947505298, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.49360827864564, "num_env_steps_trained_throughput_per_sec": 297.49360827864564, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12387.678, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12387.6, "sample_time_ms": 1063.202, "learn_time_ms": 11260.568, "learn_throughput": 355.222, "synch_weights_time_ms": 63.006}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00004", "date": "2024-08-03_10-41-10", "timestamp": 1722661870, "time_this_iter_s": 13.459782600402832, "time_total_s": 269.5618209838867, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907b8550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 269.5618209838867, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.299999999999999, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 76.87707456250986, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.6269526675343515, "policy_loss": -0.008720148569166971, "vf_loss": 6.630666697025299, "vf_explained_var": 0.8857073690742254, "kl": 0.015372082400563158, "entropy": 1.911307770262162, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -26.199191025053622, "episode_reward_min": -1493.4815400143796, "episode_reward_mean": -787.6023937864594, "episode_len_mean": 139.21, "episode_media": {}, "episodes_timesteps_total": 13921, "policy_reward_min": {"policy_0": -1493.4815400143796}, "policy_reward_max": {"policy_0": -26.199191025053622}, "policy_reward_mean": {"policy_0": -787.6023937864594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-818.2752048626796, -288.4859742340044, -1220.806587832682, -1403.976270659461, -354.74847075455216, -1458.9436465573333, -1016.847226450056, -1243.8364154059575, -862.883513134452, -621.4000554624529, -756.2894638543987, -1197.3719139511193, -182.9870378126666, -1493.4815400143796, -903.9138237168983, -983.7554363178964, -26.199191025053622, -417.6280310948272, -524.4034338862442, -503.91447661383455, -876.6996622322836, -464.5873465956664, -91.21494163336459, -124.24191118038469, -606.4003045825317, -459.2014282502879, -941.4606915315597, -760.3470835807019, -800.374453544231, -543.5736853815298, -455.2415018562231, -1398.725926951967, -1209.6666603419774, -324.219150775422, -315.31276893116006, -275.62343879835765, -1220.3584696824787, -1013.7925750114775, -1326.3681299810996, -1290.7382634117434, -1430.783670120442, -644.8294729812704, -617.6970591814663, -203.75094806413398, -587.9771204004792, -159.5888676585545, -1315.4008898908753, -565.9042819003569, -1184.312850696141, -607.4807682154777, -767.4028353624155, -436.8152113912107, -811.615358621756, -858.5966840165512, -1275.0887280174124, -715.5275610991174, -1396.243388639099, -1146.771018174812, -947.9225866577503, -1141.7359347173422, -828.786798357504, -629.4891466090879, -1061.9480757821627, -898.7485545890792, -953.973506545492, -215.0693764973993, -95.32748617728849, -899.3857514627724, -678.7890269751312, -579.6006754299569, -522.2414667882082, -800.854945402891, -1465.0133078451092, -767.2751793278899, -575.7284404238469, -169.27840001777017, -1479.2047316798053, -661.8196196769786, -1161.2507314145194, -684.2233532751665, -1235.5460247760525, -331.1415556649438, -1268.0392542421434, -1054.2194293714824, -798.2936894801132, -307.7939666680034, -670.5429574669461, -683.6837602059497, -1083.3199902609454, -429.98389814503037, -1021.1384249423016, -783.7015256568191, -144.1955844299942, -1288.0790137093802, -1079.616829907637, -1077.713678995379, -1126.448091341791, -90.98247904973495, -625.869484633315, -938.1798217178581], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 63, 145, 150, 150, 150, 115, 76, 88, 150, 124, 150, 150, 150, 150, 150, 150, 150, 124, 94, 94, 150, 150, 150, 150, 150, 150, 150, 99, 129, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 72, 66, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 69, 150, 150], "policy_policy_0_reward": [-818.2752048626796, -288.4859742340044, -1220.806587832682, -1403.976270659461, -354.74847075455216, -1458.9436465573333, -1016.847226450056, -1243.8364154059575, -862.883513134452, -621.4000554624529, -756.2894638543987, -1197.3719139511193, -182.9870378126666, -1493.4815400143796, -903.9138237168983, -983.7554363178964, -26.199191025053622, -417.6280310948272, -524.4034338862442, -503.91447661383455, -876.6996622322836, -464.5873465956664, -91.21494163336459, -124.24191118038469, -606.4003045825317, -459.2014282502879, -941.4606915315597, -760.3470835807019, -800.374453544231, -543.5736853815298, -455.2415018562231, -1398.725926951967, -1209.6666603419774, -324.219150775422, -315.31276893116006, -275.62343879835765, -1220.3584696824787, -1013.7925750114775, -1326.3681299810996, -1290.7382634117434, -1430.783670120442, -644.8294729812704, -617.6970591814663, -203.75094806413398, -587.9771204004792, -159.5888676585545, -1315.4008898908753, -565.9042819003569, -1184.312850696141, -607.4807682154777, -767.4028353624155, -436.8152113912107, -811.615358621756, -858.5966840165512, -1275.0887280174124, -715.5275610991174, -1396.243388639099, -1146.771018174812, -947.9225866577503, -1141.7359347173422, -828.786798357504, -629.4891466090879, -1061.9480757821627, -898.7485545890792, -953.973506545492, -215.0693764973993, -95.32748617728849, -899.3857514627724, -678.7890269751312, -579.6006754299569, -522.2414667882082, -800.854945402891, -1465.0133078451092, -767.2751793278899, -575.7284404238469, -169.27840001777017, -1479.2047316798053, -661.8196196769786, -1161.2507314145194, -684.2233532751665, -1235.5460247760525, -331.1415556649438, -1268.0392542421434, -1054.2194293714824, -798.2936894801132, -307.7939666680034, -670.5429574669461, -683.6837602059497, -1083.3199902609454, -429.98389814503037, -1021.1384249423016, -783.7015256568191, -144.1955844299942, -1288.0790137093802, -1079.616829907637, -1077.713678995379, -1126.448091341791, -90.98247904973495, -625.869484633315, -938.1798217178581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.548228192784858, "mean_inference_ms": 1.677486866491855, "mean_action_processing_ms": 0.27687956706596284, "mean_env_wait_ms": 3.0695522862792086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012122154235839844, "StateBufferConnector_ms": 0.007915019989013672, "ViewRequirementAgentConnector_ms": 0.1943373680114746}, "num_episodes": 28, "episode_return_max": -26.199191025053622, "episode_return_min": -1493.4815400143796, "episode_return_mean": -787.6023937864594, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.529979656603, "num_env_steps_trained_throughput_per_sec": 297.529979656603, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12926.135, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12926.057, "sample_time_ms": 1064.573, "learn_time_ms": 11795.776, "learn_throughput": 339.104, "synch_weights_time_ms": 64.867}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00004", "date": "2024-08-03_10-41-24", "timestamp": 1722661884, "time_this_iter_s": 13.456811904907227, "time_total_s": 283.01863288879395, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907ba680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.01863288879395, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.368421052631577, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 81.63677250345548, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.4137214973568915, "policy_loss": -0.011583265315372652, "vf_loss": 6.420709057152271, "vf_explained_var": 0.9214814620092511, "kl": 0.013854062515226436, "entropy": 1.6386402936031421, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -35.86753274324069, "episode_reward_min": -1479.2047316798053, "episode_reward_mean": -784.5045983187687, "episode_len_mean": 139.48, "episode_media": {}, "episodes_timesteps_total": 13948, "policy_reward_min": {"policy_0": -1479.2047316798053}, "policy_reward_max": {"policy_0": -35.86753274324069}, "policy_reward_mean": {"policy_0": -784.5045983187687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1398.725926951967, -1209.6666603419774, -324.219150775422, -315.31276893116006, -275.62343879835765, -1220.3584696824787, -1013.7925750114775, -1326.3681299810996, -1290.7382634117434, -1430.783670120442, -644.8294729812704, -617.6970591814663, -203.75094806413398, -587.9771204004792, -159.5888676585545, -1315.4008898908753, -565.9042819003569, -1184.312850696141, -607.4807682154777, -767.4028353624155, -436.8152113912107, -811.615358621756, -858.5966840165512, -1275.0887280174124, -715.5275610991174, -1396.243388639099, -1146.771018174812, -947.9225866577503, -1141.7359347173422, -828.786798357504, -629.4891466090879, -1061.9480757821627, -898.7485545890792, -953.973506545492, -215.0693764973993, -95.32748617728849, -899.3857514627724, -678.7890269751312, -579.6006754299569, -522.2414667882082, -800.854945402891, -1465.0133078451092, -767.2751793278899, -575.7284404238469, -169.27840001777017, -1479.2047316798053, -661.8196196769786, -1161.2507314145194, -684.2233532751665, -1235.5460247760525, -331.1415556649438, -1268.0392542421434, -1054.2194293714824, -798.2936894801132, -307.7939666680034, -670.5429574669461, -683.6837602059497, -1083.3199902609454, -429.98389814503037, -1021.1384249423016, -783.7015256568191, -144.1955844299942, -1288.0790137093802, -1079.616829907637, -1077.713678995379, -1126.448091341791, -90.98247904973495, -625.869484633315, -938.1798217178581, -359.86706465058603, -164.06703207302235, -1004.1583116454196, -366.20859994225987, -990.7925188372789, -204.28923216295016, -346.66939066442524, -540.8404987469095, -1257.6166387881328, -1123.3288627550464, -882.0923841764595, -260.1613770695178, -910.0988245487271, -503.97057907540454, -448.4325082122551, -1017.4312097322006, -991.7602677926537, -718.393388383334, -1145.2615516991088, -1257.0637241334823, -826.9359572527783, -877.7029314377785, -625.625993953958, -35.86753274324069, -921.4766706699852, -825.378766727678, -679.4650773072424, -788.879503260616, -904.6378581117568, -589.3277706310304, -525.9091500554014], "episode_lengths": [150, 150, 124, 94, 94, 150, 150, 150, 150, 150, 150, 150, 99, 129, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 72, 66, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 69, 150, 150, 145, 112, 150, 150, 150, 111, 107, 135, 150, 150, 150, 95, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 128, 150], "policy_policy_0_reward": [-1398.725926951967, -1209.6666603419774, -324.219150775422, -315.31276893116006, -275.62343879835765, -1220.3584696824787, -1013.7925750114775, -1326.3681299810996, -1290.7382634117434, -1430.783670120442, -644.8294729812704, -617.6970591814663, -203.75094806413398, -587.9771204004792, -159.5888676585545, -1315.4008898908753, -565.9042819003569, -1184.312850696141, -607.4807682154777, -767.4028353624155, -436.8152113912107, -811.615358621756, -858.5966840165512, -1275.0887280174124, -715.5275610991174, -1396.243388639099, -1146.771018174812, -947.9225866577503, -1141.7359347173422, -828.786798357504, -629.4891466090879, -1061.9480757821627, -898.7485545890792, -953.973506545492, -215.0693764973993, -95.32748617728849, -899.3857514627724, -678.7890269751312, -579.6006754299569, -522.2414667882082, -800.854945402891, -1465.0133078451092, -767.2751793278899, -575.7284404238469, -169.27840001777017, -1479.2047316798053, -661.8196196769786, -1161.2507314145194, -684.2233532751665, -1235.5460247760525, -331.1415556649438, -1268.0392542421434, -1054.2194293714824, -798.2936894801132, -307.7939666680034, -670.5429574669461, -683.6837602059497, -1083.3199902609454, -429.98389814503037, -1021.1384249423016, -783.7015256568191, -144.1955844299942, -1288.0790137093802, -1079.616829907637, -1077.713678995379, -1126.448091341791, -90.98247904973495, -625.869484633315, -938.1798217178581, -359.86706465058603, -164.06703207302235, -1004.1583116454196, -366.20859994225987, -990.7925188372789, -204.28923216295016, -346.66939066442524, -540.8404987469095, -1257.6166387881328, -1123.3288627550464, -882.0923841764595, -260.1613770695178, -910.0988245487271, -503.97057907540454, -448.4325082122551, -1017.4312097322006, -991.7602677926537, -718.393388383334, -1145.2615516991088, -1257.0637241334823, -826.9359572527783, -877.7029314377785, -625.625993953958, -35.86753274324069, -921.4766706699852, -825.378766727678, -679.4650773072424, -788.879503260616, -904.6378581117568, -589.3277706310304, -525.9091500554014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5481596989693635, "mean_inference_ms": 1.677464362307381, "mean_action_processing_ms": 0.2768893699340891, "mean_env_wait_ms": 3.071101032759688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012436389923095703, "StateBufferConnector_ms": 0.00792074203491211, "ViewRequirementAgentConnector_ms": 0.19600749015808105}, "num_episodes": 31, "episode_return_max": -35.86753274324069, "episode_return_min": -1479.2047316798053, "episode_return_mean": -784.5045983187687, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.81009759995675, "num_env_steps_trained_throughput_per_sec": 292.81009759995675, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12940.486, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12940.406, "sample_time_ms": 1072.075, "learn_time_ms": 11802.473, "learn_throughput": 338.912, "synch_weights_time_ms": 65.016}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00004", "date": "2024-08-03_10-41-38", "timestamp": 1722661898, "time_this_iter_s": 13.673606872558594, "time_total_s": 296.69223976135254, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907b8820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 296.69223976135254, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.204999999999998, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 102.55504234631856, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.416541002690792, "policy_loss": -0.00457580932561541, "vf_loss": 6.41805696239074, "vf_explained_var": 0.9206291719650229, "kl": 0.011017595153922869, "entropy": 1.8980801720172167, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -35.86753274324069, "episode_reward_min": -1479.2047316798053, "episode_reward_mean": -751.5020077367352, "episode_len_mean": 138.2, "episode_media": {}, "episodes_timesteps_total": 13820, "policy_reward_min": {"policy_0": -1479.2047316798053}, "policy_reward_max": {"policy_0": -35.86753274324069}, "policy_reward_mean": {"policy_0": -751.5020077367352}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1141.7359347173422, -828.786798357504, -629.4891466090879, -1061.9480757821627, -898.7485545890792, -953.973506545492, -215.0693764973993, -95.32748617728849, -899.3857514627724, -678.7890269751312, -579.6006754299569, -522.2414667882082, -800.854945402891, -1465.0133078451092, -767.2751793278899, -575.7284404238469, -169.27840001777017, -1479.2047316798053, -661.8196196769786, -1161.2507314145194, -684.2233532751665, -1235.5460247760525, -331.1415556649438, -1268.0392542421434, -1054.2194293714824, -798.2936894801132, -307.7939666680034, -670.5429574669461, -683.6837602059497, -1083.3199902609454, -429.98389814503037, -1021.1384249423016, -783.7015256568191, -144.1955844299942, -1288.0790137093802, -1079.616829907637, -1077.713678995379, -1126.448091341791, -90.98247904973495, -625.869484633315, -938.1798217178581, -359.86706465058603, -164.06703207302235, -1004.1583116454196, -366.20859994225987, -990.7925188372789, -204.28923216295016, -346.66939066442524, -540.8404987469095, -1257.6166387881328, -1123.3288627550464, -882.0923841764595, -260.1613770695178, -910.0988245487271, -503.97057907540454, -448.4325082122551, -1017.4312097322006, -991.7602677926537, -718.393388383334, -1145.2615516991088, -1257.0637241334823, -826.9359572527783, -877.7029314377785, -625.625993953958, -35.86753274324069, -921.4766706699852, -825.378766727678, -679.4650773072424, -788.879503260616, -904.6378581117568, -589.3277706310304, -525.9091500554014, -673.8114952064733, -946.8811236150932, -126.55521057084366, -701.1099192542276, -1258.5936047192745, -1249.6876986704463, -620.2076479837085, -709.8211095727643, -226.23022006552532, -757.191147707869, -756.0724435084995, -133.32265450175186, -619.4422308523838, -473.5169985220221, -826.7689226616642, -908.4102138455331, -705.6105481378922, -1324.3826345804525, -60.59470685608408, -1040.8631148096158, -1041.069702944012, -95.01183411416034, -1237.7656488825849, -397.4851874749313, -1002.3571762951094, -942.4430755257828, -1312.7106543140872, -600.3387015788855], "episode_lengths": [150, 150, 142, 150, 150, 150, 72, 66, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 69, 150, 150, 145, 112, 150, 150, 150, 111, 107, 135, 150, 150, 150, 95, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 128, 150, 150, 150, 71, 150, 150, 150, 150, 150, 81, 150, 150, 74, 142, 115, 150, 150, 150, 150, 54, 150, 150, 84, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1141.7359347173422, -828.786798357504, -629.4891466090879, -1061.9480757821627, -898.7485545890792, -953.973506545492, -215.0693764973993, -95.32748617728849, -899.3857514627724, -678.7890269751312, -579.6006754299569, -522.2414667882082, -800.854945402891, -1465.0133078451092, -767.2751793278899, -575.7284404238469, -169.27840001777017, -1479.2047316798053, -661.8196196769786, -1161.2507314145194, -684.2233532751665, -1235.5460247760525, -331.1415556649438, -1268.0392542421434, -1054.2194293714824, -798.2936894801132, -307.7939666680034, -670.5429574669461, -683.6837602059497, -1083.3199902609454, -429.98389814503037, -1021.1384249423016, -783.7015256568191, -144.1955844299942, -1288.0790137093802, -1079.616829907637, -1077.713678995379, -1126.448091341791, -90.98247904973495, -625.869484633315, -938.1798217178581, -359.86706465058603, -164.06703207302235, -1004.1583116454196, -366.20859994225987, -990.7925188372789, -204.28923216295016, -346.66939066442524, -540.8404987469095, -1257.6166387881328, -1123.3288627550464, -882.0923841764595, -260.1613770695178, -910.0988245487271, -503.97057907540454, -448.4325082122551, -1017.4312097322006, -991.7602677926537, -718.393388383334, -1145.2615516991088, -1257.0637241334823, -826.9359572527783, -877.7029314377785, -625.625993953958, -35.86753274324069, -921.4766706699852, -825.378766727678, -679.4650773072424, -788.879503260616, -904.6378581117568, -589.3277706310304, -525.9091500554014, -673.8114952064733, -946.8811236150932, -126.55521057084366, -701.1099192542276, -1258.5936047192745, -1249.6876986704463, -620.2076479837085, -709.8211095727643, -226.23022006552532, -757.191147707869, -756.0724435084995, -133.32265450175186, -619.4422308523838, -473.5169985220221, -826.7689226616642, -908.4102138455331, -705.6105481378922, -1324.3826345804525, -60.59470685608408, -1040.8631148096158, -1041.069702944012, -95.01183411416034, -1237.7656488825849, -397.4851874749313, -1002.3571762951094, -942.4430755257828, -1312.7106543140872, -600.3387015788855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5484117454185714, "mean_inference_ms": 1.6782055828617863, "mean_action_processing_ms": 0.27699169094818626, "mean_env_wait_ms": 3.0751381072719823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012188434600830078, "StateBufferConnector_ms": 0.007932186126708984, "ViewRequirementAgentConnector_ms": 0.1959221363067627}, "num_episodes": 28, "episode_return_max": -35.86753274324069, "episode_return_min": -1479.2047316798053, "episode_return_mean": -751.5020077367352, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.48759578257767, "num_env_steps_trained_throughput_per_sec": 318.48759578257767, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12864.121, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12864.039, "sample_time_ms": 1073.503, "learn_time_ms": 11721.445, "learn_throughput": 341.255, "synch_weights_time_ms": 68.218}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00004", "date": "2024-08-03_10-41-50", "timestamp": 1722661910, "time_this_iter_s": 12.57292628288269, "time_total_s": 309.26516604423523, "pid": 512353, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a290753d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 309.26516604423523, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.505555555555556, "ram_util_percent": 27.7}}
