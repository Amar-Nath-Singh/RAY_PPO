{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8662637688219548, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.701657130320866, "policy_loss": -0.007708173377128939, "vf_loss": 9.708343610167503, "vf_explained_var": 0.017833057232201098, "kl": 0.012152555225710179, "entropy": 1.4088241121421257, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -42.900395435036806, "episode_reward_min": -1025.8801626774093, "episode_reward_mean": -639.5529818762833, "episode_len_mean": 131.08695652173913, "episode_media": {}, "episodes_timesteps_total": 3015, "policy_reward_min": {"policy_0": -1025.8801626774093}, "policy_reward_max": {"policy_0": -42.900395435036806}, "policy_reward_mean": {"policy_0": -639.5529818762833}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-843.0597620888776, -664.2926594744699, -813.6733169448416, -846.3122242769062, -827.2896240580864, -845.9329842489294, -807.7890540601687, -687.3219257562239, -86.28457545618585, -120.21669196450698, -976.4273315721613, -1025.8801626774093, -717.261612864597, -402.1198760698179, -42.900395435036806, -957.6827834564522, -179.2109301943789, -116.22714561066991, -653.4747994969915, -844.2847732251505, -469.09309853670754, -844.7729022376295, -938.2099534483183], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 64, 55, 150, 150, 150, 150, 55, 150, 65, 76, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-843.0597620888776, -664.2926594744699, -813.6733169448416, -846.3122242769062, -827.2896240580864, -845.9329842489294, -807.7890540601687, -687.3219257562239, -86.28457545618585, -120.21669196450698, -976.4273315721613, -1025.8801626774093, -717.261612864597, -402.1198760698179, -42.900395435036806, -957.6827834564522, -179.2109301943789, -116.22714561066991, -653.4747994969915, -844.2847732251505, -469.09309853670754, -844.7729022376295, -938.2099534483183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5682682124639193, "mean_inference_ms": 1.6507038879830283, "mean_action_processing_ms": 0.27739855124317725, "mean_env_wait_ms": 2.974819011910191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010916461115298063, "StateBufferConnector_ms": 0.008189159890879755, "ViewRequirementAgentConnector_ms": 0.18101671467656674}, "num_episodes": 23, "episode_return_max": -42.900395435036806, "episode_return_min": -1025.8801626774093, "episode_return_mean": -639.5529818762833, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.7355225827897, "num_env_steps_trained_throughput_per_sec": 299.7355225827897, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13345.108, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13345.045, "sample_time_ms": 1019.006, "learn_time_ms": 12264.673, "learn_throughput": 326.14, "synch_weights_time_ms": 60.538}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00016", "date": "2024-08-03_11-44-59", "timestamp": 1722665699, "time_this_iter_s": 13.356089115142822, "time_total_s": 13.356089115142822, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b4700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.356089115142822, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 13.110000000000003, "ram_util_percent": 27.695000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8910991128534078, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.809960728883743, "policy_loss": -0.006258296707528643, "vf_loss": 9.815714151660602, "vf_explained_var": 0.024646197694043318, "kl": 0.009816088470074646, "entropy": 1.4583162526289621, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -42.900395435036806, "episode_reward_min": -1276.8324067489737, "episode_reward_mean": -705.804380999564, "episode_len_mean": 136.08510638297872, "episode_media": {}, "episodes_timesteps_total": 6396, "policy_reward_min": {"policy_0": -1276.8324067489737}, "policy_reward_max": {"policy_0": -42.900395435036806}, "policy_reward_mean": {"policy_0": -705.804380999564}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-843.0597620888776, -664.2926594744699, -813.6733169448416, -846.3122242769062, -827.2896240580864, -845.9329842489294, -807.7890540601687, -687.3219257562239, -86.28457545618585, -120.21669196450698, -976.4273315721613, -1025.8801626774093, -717.261612864597, -402.1198760698179, -42.900395435036806, -957.6827834564522, -179.2109301943789, -116.22714561066991, -653.4747994969915, -844.2847732251505, -469.09309853670754, -844.7729022376295, -938.2099534483183, -908.8616427874986, -1060.9575598943309, -191.47482214455192, -565.1221392474704, -498.94249484422306, -1189.6103971753632, -154.94542592077644, -808.435223786541, -1276.8324067489737, -675.1975969487264, -1006.2358782056102, -899.0469461775696, -1164.052260657632, -953.7275378207723, -1041.4234977462877, -319.2846916433762, -651.6221225409404, -604.0052064327634, -250.88695866025733, -1101.113214437024, -856.8774799142891, -889.093262566071, -862.7705546723819, -532.5680028515667], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 64, 55, 150, 150, 150, 150, 55, 150, 65, 76, 150, 150, 150, 150, 150, 150, 150, 98, 150, 143, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 105, 128, 150, 123, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-843.0597620888776, -664.2926594744699, -813.6733169448416, -846.3122242769062, -827.2896240580864, -845.9329842489294, -807.7890540601687, -687.3219257562239, -86.28457545618585, -120.21669196450698, -976.4273315721613, -1025.8801626774093, -717.261612864597, -402.1198760698179, -42.900395435036806, -957.6827834564522, -179.2109301943789, -116.22714561066991, -653.4747994969915, -844.2847732251505, -469.09309853670754, -844.7729022376295, -938.2099534483183, -908.8616427874986, -1060.9575598943309, -191.47482214455192, -565.1221392474704, -498.94249484422306, -1189.6103971753632, -154.94542592077644, -808.435223786541, -1276.8324067489737, -675.1975969487264, -1006.2358782056102, -899.0469461775696, -1164.052260657632, -953.7275378207723, -1041.4234977462877, -319.2846916433762, -651.6221225409404, -604.0052064327634, -250.88695866025733, -1101.113214437024, -856.8774799142891, -889.093262566071, -862.7705546723819, -532.5680028515667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5653844296601024, "mean_inference_ms": 1.6599824047377276, "mean_action_processing_ms": 0.278644130680394, "mean_env_wait_ms": 2.967444232548216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013885599501589511, "StateBufferConnector_ms": 0.008364941211456948, "ViewRequirementAgentConnector_ms": 0.1826225443089262}, "num_episodes": 24, "episode_return_max": -42.900395435036806, "episode_return_min": -1276.8324067489737, "episode_return_mean": -705.804380999564, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.5400700711494, "num_env_steps_trained_throughput_per_sec": 340.5400700711494, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12545.586, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12545.511, "sample_time_ms": 1016.507, "learn_time_ms": 11461.275, "learn_throughput": 349.001, "synch_weights_time_ms": 66.849}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00016", "date": "2024-08-03_11-45-11", "timestamp": 1722665711, "time_this_iter_s": 11.757699012756348, "time_total_s": 25.11378812789917, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ed07c040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.11378812789917, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 14.987499999999999, "ram_util_percent": 27.75625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3825552069271605, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.545718693733216, "policy_loss": -0.009706432779785246, "vf_loss": 9.554625298579534, "vf_explained_var": 0.08917777730772893, "kl": 0.011320591685534965, "entropy": 1.4643014623473087, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -11.686799426096174, "episode_reward_min": -1276.8324067489737, "episode_reward_mean": -677.152621265701, "episode_len_mean": 134.22784810126583, "episode_media": {}, "episodes_timesteps_total": 10604, "policy_reward_min": {"policy_0": -1276.8324067489737}, "policy_reward_max": {"policy_0": -11.686799426096174}, "policy_reward_mean": {"policy_0": -677.152621265701}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-843.0597620888776, -664.2926594744699, -813.6733169448416, -846.3122242769062, -827.2896240580864, -845.9329842489294, -807.7890540601687, -687.3219257562239, -86.28457545618585, -120.21669196450698, -976.4273315721613, -1025.8801626774093, -717.261612864597, -402.1198760698179, -42.900395435036806, -957.6827834564522, -179.2109301943789, -116.22714561066991, -653.4747994969915, -844.2847732251505, -469.09309853670754, -844.7729022376295, -938.2099534483183, -908.8616427874986, -1060.9575598943309, -191.47482214455192, -565.1221392474704, -498.94249484422306, -1189.6103971753632, -154.94542592077644, -808.435223786541, -1276.8324067489737, -675.1975969487264, -1006.2358782056102, -899.0469461775696, -1164.052260657632, -953.7275378207723, -1041.4234977462877, -319.2846916433762, -651.6221225409404, -604.0052064327634, -250.88695866025733, -1101.113214437024, -856.8774799142891, -889.093262566071, -862.7705546723819, -532.5680028515667, -1118.6680375308208, -1102.1505156553199, -857.5000429463569, -494.6835799025923, -180.84137346252027, -983.1204697653786, -1106.3981494558739, -660.4197327451342, -59.4080186650678, -32.299126828064935, -713.8179618898083, -752.697212017824, -733.9735013982764, -326.9573453775303, -931.2631462670436, -512.0201789973723, -577.9813915413955, -869.7630590078265, -217.03829532135734, -99.4711133789673, -11.686799426096174, -687.9461462609826, -665.4240445002632, -766.5559152464297, -838.81079539161, -890.630043448823, -815.2400614663326, -799.2452228447165, -317.9199872350713, -869.116198705317, -826.2110919289829, -502.99261440170477], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 64, 55, 150, 150, 150, 150, 55, 150, 65, 76, 150, 150, 150, 150, 150, 150, 150, 98, 150, 143, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 105, 128, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 87, 71, 150, 150, 149, 150, 150, 110, 150, 150, 87, 46, 51, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150], "policy_policy_0_reward": [-843.0597620888776, -664.2926594744699, -813.6733169448416, -846.3122242769062, -827.2896240580864, -845.9329842489294, -807.7890540601687, -687.3219257562239, -86.28457545618585, -120.21669196450698, -976.4273315721613, -1025.8801626774093, -717.261612864597, -402.1198760698179, -42.900395435036806, -957.6827834564522, -179.2109301943789, -116.22714561066991, -653.4747994969915, -844.2847732251505, -469.09309853670754, -844.7729022376295, -938.2099534483183, -908.8616427874986, -1060.9575598943309, -191.47482214455192, -565.1221392474704, -498.94249484422306, -1189.6103971753632, -154.94542592077644, -808.435223786541, -1276.8324067489737, -675.1975969487264, -1006.2358782056102, -899.0469461775696, -1164.052260657632, -953.7275378207723, -1041.4234977462877, -319.2846916433762, -651.6221225409404, -604.0052064327634, -250.88695866025733, -1101.113214437024, -856.8774799142891, -889.093262566071, -862.7705546723819, -532.5680028515667, -1118.6680375308208, -1102.1505156553199, -857.5000429463569, -494.6835799025923, -180.84137346252027, -983.1204697653786, -1106.3981494558739, -660.4197327451342, -59.4080186650678, -32.299126828064935, -713.8179618898083, -752.697212017824, -733.9735013982764, -326.9573453775303, -931.2631462670436, -512.0201789973723, -577.9813915413955, -869.7630590078265, -217.03829532135734, -99.4711133789673, -11.686799426096174, -687.9461462609826, -665.4240445002632, -766.5559152464297, -838.81079539161, -890.630043448823, -815.2400614663326, -799.2452228447165, -317.9199872350713, -869.116198705317, -826.2110919289829, -502.99261440170477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.565884543642202, "mean_inference_ms": 1.674447537008359, "mean_action_processing_ms": 0.2804789547607553, "mean_env_wait_ms": 2.981828456568181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013511090338984622, "StateBufferConnector_ms": 0.008655801604065714, "ViewRequirementAgentConnector_ms": 0.18995683404463756}, "num_episodes": 32, "episode_return_max": -11.686799426096174, "episode_return_min": -1276.8324067489737, "episode_return_mean": -677.152621265701, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.64155559061084, "num_env_steps_trained_throughput_per_sec": 295.64155559061084, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12873.695, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12873.621, "sample_time_ms": 1024.262, "learn_time_ms": 11779.589, "learn_throughput": 339.57, "synch_weights_time_ms": 68.893}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00016", "date": "2024-08-03_11-45-25", "timestamp": 1722665725, "time_this_iter_s": 13.541640758514404, "time_total_s": 38.655428886413574, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b7490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.655428886413574, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.825000000000003, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5458752792328596, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.336894477903844, "policy_loss": -0.01052285807672888, "vf_loss": 9.346250288685162, "vf_explained_var": 0.17509644677241643, "kl": 0.01297136378986276, "entropy": 1.427239679545164, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -11.686799426096174, "episode_reward_min": -1276.8324067489737, "episode_reward_mean": -672.9721306548613, "episode_len_mean": 133.8, "episode_media": {}, "episodes_timesteps_total": 13380, "policy_reward_min": {"policy_0": -1276.8324067489737}, "policy_reward_max": {"policy_0": -11.686799426096174}, "policy_reward_mean": {"policy_0": -672.9721306548613}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-845.9329842489294, -807.7890540601687, -687.3219257562239, -86.28457545618585, -120.21669196450698, -976.4273315721613, -1025.8801626774093, -717.261612864597, -402.1198760698179, -42.900395435036806, -957.6827834564522, -179.2109301943789, -116.22714561066991, -653.4747994969915, -844.2847732251505, -469.09309853670754, -844.7729022376295, -938.2099534483183, -908.8616427874986, -1060.9575598943309, -191.47482214455192, -565.1221392474704, -498.94249484422306, -1189.6103971753632, -154.94542592077644, -808.435223786541, -1276.8324067489737, -675.1975969487264, -1006.2358782056102, -899.0469461775696, -1164.052260657632, -953.7275378207723, -1041.4234977462877, -319.2846916433762, -651.6221225409404, -604.0052064327634, -250.88695866025733, -1101.113214437024, -856.8774799142891, -889.093262566071, -862.7705546723819, -532.5680028515667, -1118.6680375308208, -1102.1505156553199, -857.5000429463569, -494.6835799025923, -180.84137346252027, -983.1204697653786, -1106.3981494558739, -660.4197327451342, -59.4080186650678, -32.299126828064935, -713.8179618898083, -752.697212017824, -733.9735013982764, -326.9573453775303, -931.2631462670436, -512.0201789973723, -577.9813915413955, -869.7630590078265, -217.03829532135734, -99.4711133789673, -11.686799426096174, -687.9461462609826, -665.4240445002632, -766.5559152464297, -838.81079539161, -890.630043448823, -815.2400614663326, -799.2452228447165, -317.9199872350713, -869.116198705317, -826.2110919289829, -502.99261440170477, -346.08583300622115, -1008.6455979787098, -374.26706515392357, -671.2351943927911, -1132.3977168481474, -777.7246645140714, -94.1311672352618, -500.2611504449293, -857.2367006540125, -1099.0055108276104, -777.7670187453624, -928.1733866807094, -1156.6820845239847, -592.4310758384415, -88.40412831666885, -1219.6802146650787, -662.0293820054897, -179.21998440246884, -335.1313531281484, -551.1909288003727, -1143.234716204139, -425.45922335996335, -804.5471603089688, -1089.0595787859754, -175.17130396852195, -807.6114315489534], "episode_lengths": [150, 150, 150, 64, 55, 150, 150, 150, 150, 55, 150, 65, 76, 150, 150, 150, 150, 150, 150, 150, 98, 150, 143, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 105, 128, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 87, 71, 150, 150, 149, 150, 150, 110, 150, 150, 87, 46, 51, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 138, 150, 150, 150, 150, 150, 63, 124, 150, 150, 150, 150, 150, 150, 66, 150, 150, 89, 105, 150, 150, 150, 150, 150, 91, 150], "policy_policy_0_reward": [-845.9329842489294, -807.7890540601687, -687.3219257562239, -86.28457545618585, -120.21669196450698, -976.4273315721613, -1025.8801626774093, -717.261612864597, -402.1198760698179, -42.900395435036806, -957.6827834564522, -179.2109301943789, -116.22714561066991, -653.4747994969915, -844.2847732251505, -469.09309853670754, -844.7729022376295, -938.2099534483183, -908.8616427874986, -1060.9575598943309, -191.47482214455192, -565.1221392474704, -498.94249484422306, -1189.6103971753632, -154.94542592077644, -808.435223786541, -1276.8324067489737, -675.1975969487264, -1006.2358782056102, -899.0469461775696, -1164.052260657632, -953.7275378207723, -1041.4234977462877, -319.2846916433762, -651.6221225409404, -604.0052064327634, -250.88695866025733, -1101.113214437024, -856.8774799142891, -889.093262566071, -862.7705546723819, -532.5680028515667, -1118.6680375308208, -1102.1505156553199, -857.5000429463569, -494.6835799025923, -180.84137346252027, -983.1204697653786, -1106.3981494558739, -660.4197327451342, -59.4080186650678, -32.299126828064935, -713.8179618898083, -752.697212017824, -733.9735013982764, -326.9573453775303, -931.2631462670436, -512.0201789973723, -577.9813915413955, -869.7630590078265, -217.03829532135734, -99.4711133789673, -11.686799426096174, -687.9461462609826, -665.4240445002632, -766.5559152464297, -838.81079539161, -890.630043448823, -815.2400614663326, -799.2452228447165, -317.9199872350713, -869.116198705317, -826.2110919289829, -502.99261440170477, -346.08583300622115, -1008.6455979787098, -374.26706515392357, -671.2351943927911, -1132.3977168481474, -777.7246645140714, -94.1311672352618, -500.2611504449293, -857.2367006540125, -1099.0055108276104, -777.7670187453624, -928.1733866807094, -1156.6820845239847, -592.4310758384415, -88.40412831666885, -1219.6802146650787, -662.0293820054897, -179.21998440246884, -335.1313531281484, -551.1909288003727, -1143.234716204139, -425.45922335996335, -804.5471603089688, -1089.0595787859754, -175.17130396852195, -807.6114315489534]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5653850026548201, "mean_inference_ms": 1.6827138948226283, "mean_action_processing_ms": 0.28148263976509286, "mean_env_wait_ms": 2.9855358906016916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014214515686035156, "StateBufferConnector_ms": 0.008765935897827148, "ViewRequirementAgentConnector_ms": 0.19146203994750977}, "num_episodes": 26, "episode_return_max": -11.686799426096174, "episode_return_min": -1276.8324067489737, "episode_return_mean": -672.9721306548613, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.572667769082, "num_env_steps_trained_throughput_per_sec": 302.572667769082, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12960.265, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12960.192, "sample_time_ms": 1026.005, "learn_time_ms": 11862.902, "learn_throughput": 337.186, "synch_weights_time_ms": 70.381}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00016", "date": "2024-08-03_11-45-38", "timestamp": 1722665738, "time_this_iter_s": 13.233593702316284, "time_total_s": 51.88902258872986, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244437520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.88902258872986, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 14.33888888888889, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.648207512125373, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.385870260496935, "policy_loss": -0.014127262848584602, "vf_loss": 9.397809228301048, "vf_explained_var": 0.25279778384914003, "kl": 0.01808606234856901, "entropy": 1.4289305885632833, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -11.686799426096174, "episode_reward_min": -1383.9091117000207, "episode_reward_mean": -690.9230581257851, "episode_len_mean": 135.06, "episode_media": {}, "episodes_timesteps_total": 13506, "policy_reward_min": {"policy_0": -1383.9091117000207}, "policy_reward_max": {"policy_0": -11.686799426096174}, "policy_reward_mean": {"policy_0": -690.9230581257851}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1164.052260657632, -953.7275378207723, -1041.4234977462877, -319.2846916433762, -651.6221225409404, -604.0052064327634, -250.88695866025733, -1101.113214437024, -856.8774799142891, -889.093262566071, -862.7705546723819, -532.5680028515667, -1118.6680375308208, -1102.1505156553199, -857.5000429463569, -494.6835799025923, -180.84137346252027, -983.1204697653786, -1106.3981494558739, -660.4197327451342, -59.4080186650678, -32.299126828064935, -713.8179618898083, -752.697212017824, -733.9735013982764, -326.9573453775303, -931.2631462670436, -512.0201789973723, -577.9813915413955, -869.7630590078265, -217.03829532135734, -99.4711133789673, -11.686799426096174, -687.9461462609826, -665.4240445002632, -766.5559152464297, -838.81079539161, -890.630043448823, -815.2400614663326, -799.2452228447165, -317.9199872350713, -869.116198705317, -826.2110919289829, -502.99261440170477, -346.08583300622115, -1008.6455979787098, -374.26706515392357, -671.2351943927911, -1132.3977168481474, -777.7246645140714, -94.1311672352618, -500.2611504449293, -857.2367006540125, -1099.0055108276104, -777.7670187453624, -928.1733866807094, -1156.6820845239847, -592.4310758384415, -88.40412831666885, -1219.6802146650787, -662.0293820054897, -179.21998440246884, -335.1313531281484, -551.1909288003727, -1143.234716204139, -425.45922335996335, -804.5471603089688, -1089.0595787859754, -175.17130396852195, -807.6114315489534, -863.2716623421588, -814.8496597505923, -907.7486318195156, -1287.391572037558, -153.6566390481741, -604.97872650869, -771.740171332679, -937.4005498134931, -1097.5801256023788, -650.7363004155617, -1029.9711758938884, -185.9315064467133, -1163.2025666825218, -821.3526977609937, -632.6675208478297, -977.3929439742144, -1170.373691014676, -304.3904105388232, -130.7262914705798, -220.50041026424333, -704.3566911533059, -1179.6751382731968, -332.39632200434494, -461.5057831505816, -711.4667524459744, -814.6603024498297, -1383.9091117000207, -77.94083130493557, -1252.7681098731691, -101.30398136473303], "episode_lengths": [150, 150, 150, 105, 128, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 87, 71, 150, 150, 149, 150, 150, 110, 150, 150, 87, 46, 51, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 138, 150, 150, 150, 150, 150, 63, 124, 150, 150, 150, 150, 150, 150, 66, 150, 150, 89, 105, 150, 150, 150, 150, 150, 91, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 101, 79, 150, 150, 93, 150, 148, 150, 150, 62, 150, 77], "policy_policy_0_reward": [-1164.052260657632, -953.7275378207723, -1041.4234977462877, -319.2846916433762, -651.6221225409404, -604.0052064327634, -250.88695866025733, -1101.113214437024, -856.8774799142891, -889.093262566071, -862.7705546723819, -532.5680028515667, -1118.6680375308208, -1102.1505156553199, -857.5000429463569, -494.6835799025923, -180.84137346252027, -983.1204697653786, -1106.3981494558739, -660.4197327451342, -59.4080186650678, -32.299126828064935, -713.8179618898083, -752.697212017824, -733.9735013982764, -326.9573453775303, -931.2631462670436, -512.0201789973723, -577.9813915413955, -869.7630590078265, -217.03829532135734, -99.4711133789673, -11.686799426096174, -687.9461462609826, -665.4240445002632, -766.5559152464297, -838.81079539161, -890.630043448823, -815.2400614663326, -799.2452228447165, -317.9199872350713, -869.116198705317, -826.2110919289829, -502.99261440170477, -346.08583300622115, -1008.6455979787098, -374.26706515392357, -671.2351943927911, -1132.3977168481474, -777.7246645140714, -94.1311672352618, -500.2611504449293, -857.2367006540125, -1099.0055108276104, -777.7670187453624, -928.1733866807094, -1156.6820845239847, -592.4310758384415, -88.40412831666885, -1219.6802146650787, -662.0293820054897, -179.21998440246884, -335.1313531281484, -551.1909288003727, -1143.234716204139, -425.45922335996335, -804.5471603089688, -1089.0595787859754, -175.17130396852195, -807.6114315489534, -863.2716623421588, -814.8496597505923, -907.7486318195156, -1287.391572037558, -153.6566390481741, -604.97872650869, -771.740171332679, -937.4005498134931, -1097.5801256023788, -650.7363004155617, -1029.9711758938884, -185.9315064467133, -1163.2025666825218, -821.3526977609937, -632.6675208478297, -977.3929439742144, -1170.373691014676, -304.3904105388232, -130.7262914705798, -220.50041026424333, -704.3566911533059, -1179.6751382731968, -332.39632200434494, -461.5057831505816, -711.4667524459744, -814.6603024498297, -1383.9091117000207, -77.94083130493557, -1252.7681098731691, -101.30398136473303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5640992075499986, "mean_inference_ms": 1.6931903001508144, "mean_action_processing_ms": 0.28312495000671495, "mean_env_wait_ms": 2.9944264922623467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014069557189941406, "StateBufferConnector_ms": 0.008947610855102539, "ViewRequirementAgentConnector_ms": 0.19457435607910156}, "num_episodes": 30, "episode_return_max": -11.686799426096174, "episode_return_min": -1383.9091117000207, "episode_return_mean": -690.9230581257851, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.92831955902625, "num_env_steps_trained_throughput_per_sec": 294.92831955902625, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13080.739, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13080.665, "sample_time_ms": 1023.228, "learn_time_ms": 11987.898, "learn_throughput": 333.67, "synch_weights_time_ms": 68.667}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00016", "date": "2024-08-03_11-45-52", "timestamp": 1722665752, "time_this_iter_s": 13.576812744140625, "time_total_s": 65.46583533287048, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ed07c040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 65.46583533287048, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.650000000000002, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.871925933721165, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.174642738699912, "policy_loss": -0.009567432688587967, "vf_loss": 9.18320421775182, "vf_explained_var": 0.297983193770051, "kl": 0.012520443074724129, "entropy": 1.4981124691665173, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -11.686799426096174, "episode_reward_min": -1383.9091117000207, "episode_reward_mean": -711.0073565898664, "episode_len_mean": 136.82, "episode_media": {}, "episodes_timesteps_total": 13682, "policy_reward_min": {"policy_0": -1383.9091117000207}, "policy_reward_max": {"policy_0": -11.686799426096174}, "policy_reward_mean": {"policy_0": -711.0073565898664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-931.2631462670436, -512.0201789973723, -577.9813915413955, -869.7630590078265, -217.03829532135734, -99.4711133789673, -11.686799426096174, -687.9461462609826, -665.4240445002632, -766.5559152464297, -838.81079539161, -890.630043448823, -815.2400614663326, -799.2452228447165, -317.9199872350713, -869.116198705317, -826.2110919289829, -502.99261440170477, -346.08583300622115, -1008.6455979787098, -374.26706515392357, -671.2351943927911, -1132.3977168481474, -777.7246645140714, -94.1311672352618, -500.2611504449293, -857.2367006540125, -1099.0055108276104, -777.7670187453624, -928.1733866807094, -1156.6820845239847, -592.4310758384415, -88.40412831666885, -1219.6802146650787, -662.0293820054897, -179.21998440246884, -335.1313531281484, -551.1909288003727, -1143.234716204139, -425.45922335996335, -804.5471603089688, -1089.0595787859754, -175.17130396852195, -807.6114315489534, -863.2716623421588, -814.8496597505923, -907.7486318195156, -1287.391572037558, -153.6566390481741, -604.97872650869, -771.740171332679, -937.4005498134931, -1097.5801256023788, -650.7363004155617, -1029.9711758938884, -185.9315064467133, -1163.2025666825218, -821.3526977609937, -632.6675208478297, -977.3929439742144, -1170.373691014676, -304.3904105388232, -130.7262914705798, -220.50041026424333, -704.3566911533059, -1179.6751382731968, -332.39632200434494, -461.5057831505816, -711.4667524459744, -814.6603024498297, -1383.9091117000207, -77.94083130493557, -1252.7681098731691, -101.30398136473303, -973.9345208923366, -1111.8438121418208, -922.8053274320923, -634.7121714324173, -434.0826337744687, -1091.5687097205878, -661.6007498872951, -792.1037510919183, -1003.0250739617036, -617.5740270893335, -749.2656411049113, -976.5640615538798, -1097.4182600906274, -901.8251725491998, -336.368307642395, -724.767315231385, -574.9756801424519, -61.484464987588126, -351.7798007240568, -1145.4655413451474, -506.59846696465, -1160.477646813545, -1050.895435686276, -443.03711217462956, -1098.8858078876938, -935.7302116696169], "episode_lengths": [150, 110, 150, 150, 87, 46, 51, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 138, 150, 150, 150, 150, 150, 63, 124, 150, 150, 150, 150, 150, 150, 66, 150, 150, 89, 105, 150, 150, 150, 150, 150, 91, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 101, 79, 150, 150, 93, 150, 148, 150, 150, 62, 150, 77, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 106, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-931.2631462670436, -512.0201789973723, -577.9813915413955, -869.7630590078265, -217.03829532135734, -99.4711133789673, -11.686799426096174, -687.9461462609826, -665.4240445002632, -766.5559152464297, -838.81079539161, -890.630043448823, -815.2400614663326, -799.2452228447165, -317.9199872350713, -869.116198705317, -826.2110919289829, -502.99261440170477, -346.08583300622115, -1008.6455979787098, -374.26706515392357, -671.2351943927911, -1132.3977168481474, -777.7246645140714, -94.1311672352618, -500.2611504449293, -857.2367006540125, -1099.0055108276104, -777.7670187453624, -928.1733866807094, -1156.6820845239847, -592.4310758384415, -88.40412831666885, -1219.6802146650787, -662.0293820054897, -179.21998440246884, -335.1313531281484, -551.1909288003727, -1143.234716204139, -425.45922335996335, -804.5471603089688, -1089.0595787859754, -175.17130396852195, -807.6114315489534, -863.2716623421588, -814.8496597505923, -907.7486318195156, -1287.391572037558, -153.6566390481741, -604.97872650869, -771.740171332679, -937.4005498134931, -1097.5801256023788, -650.7363004155617, -1029.9711758938884, -185.9315064467133, -1163.2025666825218, -821.3526977609937, -632.6675208478297, -977.3929439742144, -1170.373691014676, -304.3904105388232, -130.7262914705798, -220.50041026424333, -704.3566911533059, -1179.6751382731968, -332.39632200434494, -461.5057831505816, -711.4667524459744, -814.6603024498297, -1383.9091117000207, -77.94083130493557, -1252.7681098731691, -101.30398136473303, -973.9345208923366, -1111.8438121418208, -922.8053274320923, -634.7121714324173, -434.0826337744687, -1091.5687097205878, -661.6007498872951, -792.1037510919183, -1003.0250739617036, -617.5740270893335, -749.2656411049113, -976.5640615538798, -1097.4182600906274, -901.8251725491998, -336.368307642395, -724.767315231385, -574.9756801424519, -61.484464987588126, -351.7798007240568, -1145.4655413451474, -506.59846696465, -1160.477646813545, -1050.895435686276, -443.03711217462956, -1098.8858078876938, -935.7302116696169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5616569715766269, "mean_inference_ms": 1.696343042857337, "mean_action_processing_ms": 0.2837586223112426, "mean_env_wait_ms": 3.0025625384581662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013871431350708008, "StateBufferConnector_ms": 0.008878231048583984, "ViewRequirementAgentConnector_ms": 0.19254732131958008}, "num_episodes": 26, "episode_return_max": -11.686799426096174, "episode_return_min": -1383.9091117000207, "episode_return_mean": -711.0073565898664, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.8225881486008, "num_env_steps_trained_throughput_per_sec": 295.8225881486008, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13154.221, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13154.147, "sample_time_ms": 1024.741, "learn_time_ms": 12060.226, "learn_throughput": 331.669, "synch_weights_time_ms": 68.311}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00016", "date": "2024-08-03_11-46-05", "timestamp": 1722665765, "time_this_iter_s": 13.535609722137451, "time_total_s": 79.00144505500793, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433d630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 79.00144505500793, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.81578947368421, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.844077856341999, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.217511943976085, "policy_loss": -0.015327765538434809, "vf_loss": 9.230802807211877, "vf_explained_var": 0.4282297486439347, "kl": 0.017261631416234498, "entropy": 1.4154207482933998, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -34.03816091795548, "episode_reward_min": -1427.8750963502189, "episode_reward_mean": -717.3068960156196, "episode_len_mean": 137.66, "episode_media": {}, "episodes_timesteps_total": 13766, "policy_reward_min": {"policy_0": -1427.8750963502189}, "policy_reward_max": {"policy_0": -34.03816091795548}, "policy_reward_mean": {"policy_0": -717.3068960156196}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-662.0293820054897, -179.21998440246884, -335.1313531281484, -551.1909288003727, -1143.234716204139, -425.45922335996335, -804.5471603089688, -1089.0595787859754, -175.17130396852195, -807.6114315489534, -863.2716623421588, -814.8496597505923, -907.7486318195156, -1287.391572037558, -153.6566390481741, -604.97872650869, -771.740171332679, -937.4005498134931, -1097.5801256023788, -650.7363004155617, -1029.9711758938884, -185.9315064467133, -1163.2025666825218, -821.3526977609937, -632.6675208478297, -977.3929439742144, -1170.373691014676, -304.3904105388232, -130.7262914705798, -220.50041026424333, -704.3566911533059, -1179.6751382731968, -332.39632200434494, -461.5057831505816, -711.4667524459744, -814.6603024498297, -1383.9091117000207, -77.94083130493557, -1252.7681098731691, -101.30398136473303, -973.9345208923366, -1111.8438121418208, -922.8053274320923, -634.7121714324173, -434.0826337744687, -1091.5687097205878, -661.6007498872951, -792.1037510919183, -1003.0250739617036, -617.5740270893335, -749.2656411049113, -976.5640615538798, -1097.4182600906274, -901.8251725491998, -336.368307642395, -724.767315231385, -574.9756801424519, -61.484464987588126, -351.7798007240568, -1145.4655413451474, -506.59846696465, -1160.477646813545, -1050.895435686276, -443.03711217462956, -1098.8858078876938, -935.7302116696169, -302.80957052342336, -808.9441036153067, -986.7652993937396, -367.1457626284579, -738.6500994927745, -858.4414343885259, -635.6460167172152, -394.79466559162296, -34.03816091795548, -482.7855139638251, -152.78838003128604, -958.7684465547154, -1427.8750963502189, -479.8519357171653, -816.7794685859258, -1069.8605275746431, -93.62668720091135, -118.58508111419687, -823.2778863913029, -830.7384663077019, -1076.3797849664588, -790.0039944093089, -1124.8677700940207, -892.3773104573472, -515.8053705692921, -416.44350871789874, -1246.3841299838093, -897.5758236071772, -209.57832284496627, -1271.6215042653528, -781.6199487609683, -556.378322548907, -797.1277075883802, -495.0624558967603], "episode_lengths": [150, 89, 105, 150, 150, 150, 150, 150, 91, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 101, 79, 150, 150, 93, 150, 148, 150, 150, 62, 150, 77, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 68, 150, 150, 146, 150, 150, 61, 54, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 79, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-662.0293820054897, -179.21998440246884, -335.1313531281484, -551.1909288003727, -1143.234716204139, -425.45922335996335, -804.5471603089688, -1089.0595787859754, -175.17130396852195, -807.6114315489534, -863.2716623421588, -814.8496597505923, -907.7486318195156, -1287.391572037558, -153.6566390481741, -604.97872650869, -771.740171332679, -937.4005498134931, -1097.5801256023788, -650.7363004155617, -1029.9711758938884, -185.9315064467133, -1163.2025666825218, -821.3526977609937, -632.6675208478297, -977.3929439742144, -1170.373691014676, -304.3904105388232, -130.7262914705798, -220.50041026424333, -704.3566911533059, -1179.6751382731968, -332.39632200434494, -461.5057831505816, -711.4667524459744, -814.6603024498297, -1383.9091117000207, -77.94083130493557, -1252.7681098731691, -101.30398136473303, -973.9345208923366, -1111.8438121418208, -922.8053274320923, -634.7121714324173, -434.0826337744687, -1091.5687097205878, -661.6007498872951, -792.1037510919183, -1003.0250739617036, -617.5740270893335, -749.2656411049113, -976.5640615538798, -1097.4182600906274, -901.8251725491998, -336.368307642395, -724.767315231385, -574.9756801424519, -61.484464987588126, -351.7798007240568, -1145.4655413451474, -506.59846696465, -1160.477646813545, -1050.895435686276, -443.03711217462956, -1098.8858078876938, -935.7302116696169, -302.80957052342336, -808.9441036153067, -986.7652993937396, -367.1457626284579, -738.6500994927745, -858.4414343885259, -635.6460167172152, -394.79466559162296, -34.03816091795548, -482.7855139638251, -152.78838003128604, -958.7684465547154, -1427.8750963502189, -479.8519357171653, -816.7794685859258, -1069.8605275746431, -93.62668720091135, -118.58508111419687, -823.2778863913029, -830.7384663077019, -1076.3797849664588, -790.0039944093089, -1124.8677700940207, -892.3773104573472, -515.8053705692921, -416.44350871789874, -1246.3841299838093, -897.5758236071772, -209.57832284496627, -1271.6215042653528, -781.6199487609683, -556.378322548907, -797.1277075883802, -495.0624558967603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5576360970339534, "mean_inference_ms": 1.6911007392802446, "mean_action_processing_ms": 0.2827821774249159, "mean_env_wait_ms": 2.999535126009058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013602018356323242, "StateBufferConnector_ms": 0.008698463439941406, "ViewRequirementAgentConnector_ms": 0.19591355323791504}, "num_episodes": 34, "episode_return_max": -34.03816091795548, "episode_return_min": -1427.8750963502189, "episode_return_mean": -717.3068960156196, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.4381503057886, "num_env_steps_trained_throughput_per_sec": 312.4381503057886, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13103.982, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13103.908, "sample_time_ms": 1023.892, "learn_time_ms": 12011.923, "learn_throughput": 333.002, "synch_weights_time_ms": 67.229}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00016", "date": "2024-08-03_11-46-18", "timestamp": 1722665778, "time_this_iter_s": 12.815398454666138, "time_total_s": 91.81684350967407, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244437520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 91.81684350967407, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 14.261111111111111, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.238642034803828, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.29435696999232, "policy_loss": -0.009672212715668139, "vf_loss": 9.302592349052428, "vf_explained_var": 0.41437489694605273, "kl": 0.014197439893162784, "entropy": 1.4026636851330598, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -34.03816091795548, "episode_reward_min": -1427.8750963502189, "episode_reward_mean": -706.8327284747105, "episode_len_mean": 136.23, "episode_media": {}, "episodes_timesteps_total": 13623, "policy_reward_min": {"policy_0": -1427.8750963502189}, "policy_reward_max": {"policy_0": -34.03816091795548}, "policy_reward_mean": {"policy_0": -706.8327284747105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-220.50041026424333, -704.3566911533059, -1179.6751382731968, -332.39632200434494, -461.5057831505816, -711.4667524459744, -814.6603024498297, -1383.9091117000207, -77.94083130493557, -1252.7681098731691, -101.30398136473303, -973.9345208923366, -1111.8438121418208, -922.8053274320923, -634.7121714324173, -434.0826337744687, -1091.5687097205878, -661.6007498872951, -792.1037510919183, -1003.0250739617036, -617.5740270893335, -749.2656411049113, -976.5640615538798, -1097.4182600906274, -901.8251725491998, -336.368307642395, -724.767315231385, -574.9756801424519, -61.484464987588126, -351.7798007240568, -1145.4655413451474, -506.59846696465, -1160.477646813545, -1050.895435686276, -443.03711217462956, -1098.8858078876938, -935.7302116696169, -302.80957052342336, -808.9441036153067, -986.7652993937396, -367.1457626284579, -738.6500994927745, -858.4414343885259, -635.6460167172152, -394.79466559162296, -34.03816091795548, -482.7855139638251, -152.78838003128604, -958.7684465547154, -1427.8750963502189, -479.8519357171653, -816.7794685859258, -1069.8605275746431, -93.62668720091135, -118.58508111419687, -823.2778863913029, -830.7384663077019, -1076.3797849664588, -790.0039944093089, -1124.8677700940207, -892.3773104573472, -515.8053705692921, -416.44350871789874, -1246.3841299838093, -897.5758236071772, -209.57832284496627, -1271.6215042653528, -781.6199487609683, -556.378322548907, -797.1277075883802, -495.0624558967603, -1190.6430887574747, -965.6390092149579, -928.7826624997424, -1119.406268455442, -526.2089919409779, -758.6654889259302, -993.9875933301873, -71.87341462730753, -69.61621376295527, -611.654050116267, -981.4306346013642, -45.402194301268, -820.4332020599338, -347.5143456081629, -624.3229548495055, -556.0317474933767, -634.1090773927936, -567.4075111543228, -890.3481197083069, -1000.0669541155775, -1038.5419753871315, -861.9075196483872, -712.0482117180052, -939.8121242491543, -59.8259549663237, -685.5600530407515, -826.483230069127, -633.4033857187873, -169.47517400960027], "episode_lengths": [79, 150, 150, 93, 150, 148, 150, 150, 62, 150, 77, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 68, 150, 150, 146, 150, 150, 61, 54, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 58, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 143, 150, 148, 97], "policy_policy_0_reward": [-220.50041026424333, -704.3566911533059, -1179.6751382731968, -332.39632200434494, -461.5057831505816, -711.4667524459744, -814.6603024498297, -1383.9091117000207, -77.94083130493557, -1252.7681098731691, -101.30398136473303, -973.9345208923366, -1111.8438121418208, -922.8053274320923, -634.7121714324173, -434.0826337744687, -1091.5687097205878, -661.6007498872951, -792.1037510919183, -1003.0250739617036, -617.5740270893335, -749.2656411049113, -976.5640615538798, -1097.4182600906274, -901.8251725491998, -336.368307642395, -724.767315231385, -574.9756801424519, -61.484464987588126, -351.7798007240568, -1145.4655413451474, -506.59846696465, -1160.477646813545, -1050.895435686276, -443.03711217462956, -1098.8858078876938, -935.7302116696169, -302.80957052342336, -808.9441036153067, -986.7652993937396, -367.1457626284579, -738.6500994927745, -858.4414343885259, -635.6460167172152, -394.79466559162296, -34.03816091795548, -482.7855139638251, -152.78838003128604, -958.7684465547154, -1427.8750963502189, -479.8519357171653, -816.7794685859258, -1069.8605275746431, -93.62668720091135, -118.58508111419687, -823.2778863913029, -830.7384663077019, -1076.3797849664588, -790.0039944093089, -1124.8677700940207, -892.3773104573472, -515.8053705692921, -416.44350871789874, -1246.3841299838093, -897.5758236071772, -209.57832284496627, -1271.6215042653528, -781.6199487609683, -556.378322548907, -797.1277075883802, -495.0624558967603, -1190.6430887574747, -965.6390092149579, -928.7826624997424, -1119.406268455442, -526.2089919409779, -758.6654889259302, -993.9875933301873, -71.87341462730753, -69.61621376295527, -611.654050116267, -981.4306346013642, -45.402194301268, -820.4332020599338, -347.5143456081629, -624.3229548495055, -556.0317474933767, -634.1090773927936, -567.4075111543228, -890.3481197083069, -1000.0669541155775, -1038.5419753871315, -861.9075196483872, -712.0482117180052, -939.8121242491543, -59.8259549663237, -685.5600530407515, -826.483230069127, -633.4033857187873, -169.47517400960027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564782415598141, "mean_inference_ms": 1.6901566841122613, "mean_action_processing_ms": 0.2820862395794205, "mean_env_wait_ms": 3.001104547446984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013061046600341797, "StateBufferConnector_ms": 0.008529186248779297, "ViewRequirementAgentConnector_ms": 0.19414734840393066}, "num_episodes": 29, "episode_return_max": -34.03816091795548, "episode_return_min": -1427.8750963502189, "episode_return_mean": -706.8327284747105, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.08113731300136, "num_env_steps_trained_throughput_per_sec": 299.08113731300136, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13137.773, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13137.699, "sample_time_ms": 1029.366, "learn_time_ms": 12039.411, "learn_throughput": 332.242, "synch_weights_time_ms": 68.0}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00016", "date": "2024-08-03_11-46-32", "timestamp": 1722665792, "time_this_iter_s": 13.386292934417725, "time_total_s": 105.2031364440918, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b4f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 105.2031364440918, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 14.03684210526316, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.916126941330731, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.236759361624717, "policy_loss": -0.009152056943275966, "vf_loss": 9.24434553484122, "vf_explained_var": 0.4719652710482478, "kl": 0.01501615720759825, "entropy": 1.4373607764641443, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -34.03816091795548, "episode_reward_min": -1427.8750963502189, "episode_reward_mean": -697.9992879419576, "episode_len_mean": 137.65, "episode_media": {}, "episodes_timesteps_total": 13765, "policy_reward_min": {"policy_0": -1427.8750963502189}, "policy_reward_max": {"policy_0": -34.03816091795548}, "policy_reward_mean": {"policy_0": -697.9992879419576}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-574.9756801424519, -61.484464987588126, -351.7798007240568, -1145.4655413451474, -506.59846696465, -1160.477646813545, -1050.895435686276, -443.03711217462956, -1098.8858078876938, -935.7302116696169, -302.80957052342336, -808.9441036153067, -986.7652993937396, -367.1457626284579, -738.6500994927745, -858.4414343885259, -635.6460167172152, -394.79466559162296, -34.03816091795548, -482.7855139638251, -152.78838003128604, -958.7684465547154, -1427.8750963502189, -479.8519357171653, -816.7794685859258, -1069.8605275746431, -93.62668720091135, -118.58508111419687, -823.2778863913029, -830.7384663077019, -1076.3797849664588, -790.0039944093089, -1124.8677700940207, -892.3773104573472, -515.8053705692921, -416.44350871789874, -1246.3841299838093, -897.5758236071772, -209.57832284496627, -1271.6215042653528, -781.6199487609683, -556.378322548907, -797.1277075883802, -495.0624558967603, -1190.6430887574747, -965.6390092149579, -928.7826624997424, -1119.406268455442, -526.2089919409779, -758.6654889259302, -993.9875933301873, -71.87341462730753, -69.61621376295527, -611.654050116267, -981.4306346013642, -45.402194301268, -820.4332020599338, -347.5143456081629, -624.3229548495055, -556.0317474933767, -634.1090773927936, -567.4075111543228, -890.3481197083069, -1000.0669541155775, -1038.5419753871315, -861.9075196483872, -712.0482117180052, -939.8121242491543, -59.8259549663237, -685.5600530407515, -826.483230069127, -633.4033857187873, -169.47517400960027, -586.9221788640649, -578.329615909939, -844.2543404691452, -715.0351893847651, -1109.1739409853333, -969.351218497156, -898.3281293170135, -932.6683818848778, -1094.8739480108873, -221.19126066651367, -364.77928415306155, -753.5576288687854, -449.5244052220462, -689.0733884894883, -589.3070511549819, -475.88758421940355, -702.9594800343233, -1009.9137477700278, -717.3666385654435, -585.3689190094404, -812.4201742457831, -226.45843097138226, -707.2301437201747, -973.755707935219, -1064.5076334718428, -755.1066194573336, -559.2538750269894], "episode_lengths": [150, 59, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 68, 150, 150, 146, 150, 150, 61, 54, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 58, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 143, 150, 148, 97, 150, 122, 150, 150, 150, 150, 150, 150, 150, 112, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-574.9756801424519, -61.484464987588126, -351.7798007240568, -1145.4655413451474, -506.59846696465, -1160.477646813545, -1050.895435686276, -443.03711217462956, -1098.8858078876938, -935.7302116696169, -302.80957052342336, -808.9441036153067, -986.7652993937396, -367.1457626284579, -738.6500994927745, -858.4414343885259, -635.6460167172152, -394.79466559162296, -34.03816091795548, -482.7855139638251, -152.78838003128604, -958.7684465547154, -1427.8750963502189, -479.8519357171653, -816.7794685859258, -1069.8605275746431, -93.62668720091135, -118.58508111419687, -823.2778863913029, -830.7384663077019, -1076.3797849664588, -790.0039944093089, -1124.8677700940207, -892.3773104573472, -515.8053705692921, -416.44350871789874, -1246.3841299838093, -897.5758236071772, -209.57832284496627, -1271.6215042653528, -781.6199487609683, -556.378322548907, -797.1277075883802, -495.0624558967603, -1190.6430887574747, -965.6390092149579, -928.7826624997424, -1119.406268455442, -526.2089919409779, -758.6654889259302, -993.9875933301873, -71.87341462730753, -69.61621376295527, -611.654050116267, -981.4306346013642, -45.402194301268, -820.4332020599338, -347.5143456081629, -624.3229548495055, -556.0317474933767, -634.1090773927936, -567.4075111543228, -890.3481197083069, -1000.0669541155775, -1038.5419753871315, -861.9075196483872, -712.0482117180052, -939.8121242491543, -59.8259549663237, -685.5600530407515, -826.483230069127, -633.4033857187873, -169.47517400960027, -586.9221788640649, -578.329615909939, -844.2543404691452, -715.0351893847651, -1109.1739409853333, -969.351218497156, -898.3281293170135, -932.6683818848778, -1094.8739480108873, -221.19126066651367, -364.77928415306155, -753.5576288687854, -449.5244052220462, -689.0733884894883, -589.3070511549819, -475.88758421940355, -702.9594800343233, -1009.9137477700278, -717.3666385654435, -585.3689190094404, -812.4201742457831, -226.45843097138226, -707.2301437201747, -973.755707935219, -1064.5076334718428, -755.1066194573336, -559.2538750269894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564007785537178, "mean_inference_ms": 1.6921412429929408, "mean_action_processing_ms": 0.28176787578978, "mean_env_wait_ms": 3.002532951477863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012862682342529297, "StateBufferConnector_ms": 0.008320093154907227, "ViewRequirementAgentConnector_ms": 0.19532442092895508}, "num_episodes": 27, "episode_return_max": -34.03816091795548, "episode_return_min": -1427.8750963502189, "episode_return_mean": -697.9992879419576, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.26116616621465, "num_env_steps_trained_throughput_per_sec": 297.26116616621465, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13173.153, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13173.078, "sample_time_ms": 1029.668, "learn_time_ms": 12075.369, "learn_throughput": 331.253, "synch_weights_time_ms": 67.121}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00016", "date": "2024-08-03_11-46-45", "timestamp": 1722665805, "time_this_iter_s": 13.470051527023315, "time_total_s": 118.67318797111511, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433dab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 118.67318797111511, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.600000000000003, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.903413569678865, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.929392824073632, "policy_loss": -0.015921059952233918, "vf_loss": 8.943005102376143, "vf_explained_var": 0.5920184561982751, "kl": 0.018598556382342705, "entropy": 1.4109243392944335, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -27.06975175740652, "episode_reward_min": -1363.0585105913362, "episode_reward_mean": -698.9845117923559, "episode_len_mean": 137.66, "episode_media": {}, "episodes_timesteps_total": 13766, "policy_reward_min": {"policy_0": -1363.0585105913362}, "policy_reward_max": {"policy_0": -27.06975175740652}, "policy_reward_mean": {"policy_0": -698.9845117923559}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-823.2778863913029, -830.7384663077019, -1076.3797849664588, -790.0039944093089, -1124.8677700940207, -892.3773104573472, -515.8053705692921, -416.44350871789874, -1246.3841299838093, -897.5758236071772, -209.57832284496627, -1271.6215042653528, -781.6199487609683, -556.378322548907, -797.1277075883802, -495.0624558967603, -1190.6430887574747, -965.6390092149579, -928.7826624997424, -1119.406268455442, -526.2089919409779, -758.6654889259302, -993.9875933301873, -71.87341462730753, -69.61621376295527, -611.654050116267, -981.4306346013642, -45.402194301268, -820.4332020599338, -347.5143456081629, -624.3229548495055, -556.0317474933767, -634.1090773927936, -567.4075111543228, -890.3481197083069, -1000.0669541155775, -1038.5419753871315, -861.9075196483872, -712.0482117180052, -939.8121242491543, -59.8259549663237, -685.5600530407515, -826.483230069127, -633.4033857187873, -169.47517400960027, -586.9221788640649, -578.329615909939, -844.2543404691452, -715.0351893847651, -1109.1739409853333, -969.351218497156, -898.3281293170135, -932.6683818848778, -1094.8739480108873, -221.19126066651367, -364.77928415306155, -753.5576288687854, -449.5244052220462, -689.0733884894883, -589.3070511549819, -475.88758421940355, -702.9594800343233, -1009.9137477700278, -717.3666385654435, -585.3689190094404, -812.4201742457831, -226.45843097138226, -707.2301437201747, -973.755707935219, -1064.5076334718428, -755.1066194573336, -559.2538750269894, -958.095357902945, -903.0271079010978, -60.4632340045626, -1152.6811796560783, -69.9020351964495, -856.1177369109597, -306.9088761860158, -472.3800217697253, -902.8755651893665, -1255.5515605094338, -661.4968658928361, -733.7752377851846, -1363.0585105913362, -581.2564898044328, -74.40821882771986, -435.58949119613567, -429.1394557899633, -27.06975175740652, -457.09410750242523, -804.3275281698227, -783.2408277034604, -397.1242916283769, -276.9379475202717, -721.0840653669442, -969.8070619150377, -459.86721345422995, -1049.081781449874, -993.6472822153024], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 58, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 143, 150, 148, 97, 150, 122, 150, 150, 150, 150, 150, 150, 150, 112, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 62, 150, 53, 150, 89, 150, 150, 150, 150, 150, 150, 150, 78, 111, 150, 44, 150, 150, 150, 150, 124, 150, 150, 124, 150, 150], "policy_policy_0_reward": [-823.2778863913029, -830.7384663077019, -1076.3797849664588, -790.0039944093089, -1124.8677700940207, -892.3773104573472, -515.8053705692921, -416.44350871789874, -1246.3841299838093, -897.5758236071772, -209.57832284496627, -1271.6215042653528, -781.6199487609683, -556.378322548907, -797.1277075883802, -495.0624558967603, -1190.6430887574747, -965.6390092149579, -928.7826624997424, -1119.406268455442, -526.2089919409779, -758.6654889259302, -993.9875933301873, -71.87341462730753, -69.61621376295527, -611.654050116267, -981.4306346013642, -45.402194301268, -820.4332020599338, -347.5143456081629, -624.3229548495055, -556.0317474933767, -634.1090773927936, -567.4075111543228, -890.3481197083069, -1000.0669541155775, -1038.5419753871315, -861.9075196483872, -712.0482117180052, -939.8121242491543, -59.8259549663237, -685.5600530407515, -826.483230069127, -633.4033857187873, -169.47517400960027, -586.9221788640649, -578.329615909939, -844.2543404691452, -715.0351893847651, -1109.1739409853333, -969.351218497156, -898.3281293170135, -932.6683818848778, -1094.8739480108873, -221.19126066651367, -364.77928415306155, -753.5576288687854, -449.5244052220462, -689.0733884894883, -589.3070511549819, -475.88758421940355, -702.9594800343233, -1009.9137477700278, -717.3666385654435, -585.3689190094404, -812.4201742457831, -226.45843097138226, -707.2301437201747, -973.755707935219, -1064.5076334718428, -755.1066194573336, -559.2538750269894, -958.095357902945, -903.0271079010978, -60.4632340045626, -1152.6811796560783, -69.9020351964495, -856.1177369109597, -306.9088761860158, -472.3800217697253, -902.8755651893665, -1255.5515605094338, -661.4968658928361, -733.7752377851846, -1363.0585105913362, -581.2564898044328, -74.40821882771986, -435.58949119613567, -429.1394557899633, -27.06975175740652, -457.09410750242523, -804.3275281698227, -783.2408277034604, -397.1242916283769, -276.9379475202717, -721.0840653669442, -969.8070619150377, -459.86721345422995, -1049.081781449874, -993.6472822153024]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562664458783679, "mean_inference_ms": 1.693386496741673, "mean_action_processing_ms": 0.2813617750960824, "mean_env_wait_ms": 3.0034325766532435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012875080108642578, "StateBufferConnector_ms": 0.008168458938598633, "ViewRequirementAgentConnector_ms": 0.19459152221679688}, "num_episodes": 28, "episode_return_max": -27.06975175740652, "episode_return_min": -1363.0585105913362, "episode_return_mean": -698.9845117923559, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.5598800491706, "num_env_steps_trained_throughput_per_sec": 290.5598800491706, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13232.492, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13232.416, "sample_time_ms": 1028.295, "learn_time_ms": 12136.27, "learn_throughput": 329.591, "synch_weights_time_ms": 66.942}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00016", "date": "2024-08-03_11-46-59", "timestamp": 1722665819, "time_this_iter_s": 13.780969381332397, "time_total_s": 132.4541573524475, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433e710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 132.4541573524475, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 14.03157894736842, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.651028578231733, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.046113301813602, "policy_loss": -0.015058123947043592, "vf_loss": 9.058986848592758, "vf_explained_var": 0.49124964761237305, "kl": 0.018549266568879837, "entropy": 1.525310454890132, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -27.06975175740652, "episode_reward_min": -1363.0585105913362, "episode_reward_mean": -692.7348798552455, "episode_len_mean": 137.95, "episode_media": {}, "episodes_timesteps_total": 13795, "policy_reward_min": {"policy_0": -1363.0585105913362}, "policy_reward_max": {"policy_0": -27.06975175740652}, "policy_reward_mean": {"policy_0": -692.7348798552455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-556.0317474933767, -634.1090773927936, -567.4075111543228, -890.3481197083069, -1000.0669541155775, -1038.5419753871315, -861.9075196483872, -712.0482117180052, -939.8121242491543, -59.8259549663237, -685.5600530407515, -826.483230069127, -633.4033857187873, -169.47517400960027, -586.9221788640649, -578.329615909939, -844.2543404691452, -715.0351893847651, -1109.1739409853333, -969.351218497156, -898.3281293170135, -932.6683818848778, -1094.8739480108873, -221.19126066651367, -364.77928415306155, -753.5576288687854, -449.5244052220462, -689.0733884894883, -589.3070511549819, -475.88758421940355, -702.9594800343233, -1009.9137477700278, -717.3666385654435, -585.3689190094404, -812.4201742457831, -226.45843097138226, -707.2301437201747, -973.755707935219, -1064.5076334718428, -755.1066194573336, -559.2538750269894, -958.095357902945, -903.0271079010978, -60.4632340045626, -1152.6811796560783, -69.9020351964495, -856.1177369109597, -306.9088761860158, -472.3800217697253, -902.8755651893665, -1255.5515605094338, -661.4968658928361, -733.7752377851846, -1363.0585105913362, -581.2564898044328, -74.40821882771986, -435.58949119613567, -429.1394557899633, -27.06975175740652, -457.09410750242523, -804.3275281698227, -783.2408277034604, -397.1242916283769, -276.9379475202717, -721.0840653669442, -969.8070619150377, -459.86721345422995, -1049.081781449874, -993.6472822153024, -860.8950949886381, -1011.7624128844249, -553.9294797803574, -326.19099517727074, -739.8307005829075, -953.2570349760787, -325.2487003313991, -1182.3537453417316, -767.5173265670866, -205.86659436044923, -536.0770455352358, -506.2869453270374, -1145.3796410320056, -784.3130646655621, -457.04027829282035, -111.48001028486651, -1023.0354480305224, -834.1585150927802, -213.09783242988948, -45.55803003009983, -1151.8876879204897, -948.4824713716388, -916.2996621434755, -1005.8564156701822, -388.52258074637854, -746.3395868527675, -603.4660445212762, -1027.6755254723362, -1008.7220962078572, -1111.9925702569453, -663.335689875574], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 143, 150, 148, 97, 150, 122, 150, 150, 150, 150, 150, 150, 150, 112, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 62, 150, 53, 150, 89, 150, 150, 150, 150, 150, 150, 150, 78, 111, 150, 44, 150, 150, 150, 150, 124, 150, 150, 124, 150, 150, 150, 150, 143, 92, 150, 150, 127, 150, 150, 150, 140, 139, 150, 150, 122, 67, 150, 150, 71, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-556.0317474933767, -634.1090773927936, -567.4075111543228, -890.3481197083069, -1000.0669541155775, -1038.5419753871315, -861.9075196483872, -712.0482117180052, -939.8121242491543, -59.8259549663237, -685.5600530407515, -826.483230069127, -633.4033857187873, -169.47517400960027, -586.9221788640649, -578.329615909939, -844.2543404691452, -715.0351893847651, -1109.1739409853333, -969.351218497156, -898.3281293170135, -932.6683818848778, -1094.8739480108873, -221.19126066651367, -364.77928415306155, -753.5576288687854, -449.5244052220462, -689.0733884894883, -589.3070511549819, -475.88758421940355, -702.9594800343233, -1009.9137477700278, -717.3666385654435, -585.3689190094404, -812.4201742457831, -226.45843097138226, -707.2301437201747, -973.755707935219, -1064.5076334718428, -755.1066194573336, -559.2538750269894, -958.095357902945, -903.0271079010978, -60.4632340045626, -1152.6811796560783, -69.9020351964495, -856.1177369109597, -306.9088761860158, -472.3800217697253, -902.8755651893665, -1255.5515605094338, -661.4968658928361, -733.7752377851846, -1363.0585105913362, -581.2564898044328, -74.40821882771986, -435.58949119613567, -429.1394557899633, -27.06975175740652, -457.09410750242523, -804.3275281698227, -783.2408277034604, -397.1242916283769, -276.9379475202717, -721.0840653669442, -969.8070619150377, -459.86721345422995, -1049.081781449874, -993.6472822153024, -860.8950949886381, -1011.7624128844249, -553.9294797803574, -326.19099517727074, -739.8307005829075, -953.2570349760787, -325.2487003313991, -1182.3537453417316, -767.5173265670866, -205.86659436044923, -536.0770455352358, -506.2869453270374, -1145.3796410320056, -784.3130646655621, -457.04027829282035, -111.48001028486651, -1023.0354480305224, -834.1585150927802, -213.09783242988948, -45.55803003009983, -1151.8876879204897, -948.4824713716388, -916.2996621434755, -1005.8564156701822, -388.52258074637854, -746.3395868527675, -603.4660445212762, -1027.6755254723362, -1008.7220962078572, -1111.9925702569453, -663.335689875574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556160948389531, "mean_inference_ms": 1.6955624004993373, "mean_action_processing_ms": 0.2814446044797302, "mean_env_wait_ms": 3.0065250197466993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012312889099121094, "StateBufferConnector_ms": 0.007909297943115234, "ViewRequirementAgentConnector_ms": 0.19109153747558594}, "num_episodes": 31, "episode_return_max": -27.06975175740652, "episode_return_min": -1363.0585105913362, "episode_return_mean": -692.7348798552455, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.60163522871164, "num_env_steps_trained_throughput_per_sec": 297.60163522871164, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13242.061, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13241.984, "sample_time_ms": 1027.481, "learn_time_ms": 12144.836, "learn_throughput": 329.358, "synch_weights_time_ms": 68.753}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00016", "date": "2024-08-03_11-47-12", "timestamp": 1722665832, "time_this_iter_s": 13.454042196273804, "time_total_s": 145.9081995487213, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b4f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 145.9081995487213, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 13.626315789473686, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.05831436154743, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.967659881214301, "policy_loss": -0.014191852579339562, "vf_loss": 8.979253552854061, "vf_explained_var": 0.5924704050645232, "kl": 0.020838773529734084, "entropy": 1.5696062111606202, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -5.629876564576313, "episode_reward_min": -1455.9772766442736, "episode_reward_mean": -722.0277221611218, "episode_len_mean": 137.09, "episode_media": {}, "episodes_timesteps_total": 13709, "policy_reward_min": {"policy_0": -1455.9772766442736}, "policy_reward_max": {"policy_0": -5.629876564576313}, "policy_reward_mean": {"policy_0": -722.0277221611218}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-702.9594800343233, -1009.9137477700278, -717.3666385654435, -585.3689190094404, -812.4201742457831, -226.45843097138226, -707.2301437201747, -973.755707935219, -1064.5076334718428, -755.1066194573336, -559.2538750269894, -958.095357902945, -903.0271079010978, -60.4632340045626, -1152.6811796560783, -69.9020351964495, -856.1177369109597, -306.9088761860158, -472.3800217697253, -902.8755651893665, -1255.5515605094338, -661.4968658928361, -733.7752377851846, -1363.0585105913362, -581.2564898044328, -74.40821882771986, -435.58949119613567, -429.1394557899633, -27.06975175740652, -457.09410750242523, -804.3275281698227, -783.2408277034604, -397.1242916283769, -276.9379475202717, -721.0840653669442, -969.8070619150377, -459.86721345422995, -1049.081781449874, -993.6472822153024, -860.8950949886381, -1011.7624128844249, -553.9294797803574, -326.19099517727074, -739.8307005829075, -953.2570349760787, -325.2487003313991, -1182.3537453417316, -767.5173265670866, -205.86659436044923, -536.0770455352358, -506.2869453270374, -1145.3796410320056, -784.3130646655621, -457.04027829282035, -111.48001028486651, -1023.0354480305224, -834.1585150927802, -213.09783242988948, -45.55803003009983, -1151.8876879204897, -948.4824713716388, -916.2996621434755, -1005.8564156701822, -388.52258074637854, -746.3395868527675, -603.4660445212762, -1027.6755254723362, -1008.7220962078572, -1111.9925702569453, -663.335689875574, -1342.8792369679968, -150.4695912704948, -693.7451086804001, -418.006259255389, -1063.3461130811995, -887.5630736124958, -1238.5274939114531, -1062.1356282261645, -938.4971729339159, -1184.5117496074772, -813.8474234236851, -1026.1624063309253, -1455.9772766442736, -896.6582920386246, -906.803243604354, -1033.6365699410035, -502.79426622402514, -327.28314628398743, -187.2243344021117, -5.629876564576313, -810.5622338092943, -1040.0975099633704, -887.9887768509784, -828.9675373769653, -1081.725861411976, -626.3899056032656, -204.937206955393, -371.979030863174, -785.3666961049532, -1002.849793412803], "episode_lengths": [150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 62, 150, 53, 150, 89, 150, 150, 150, 150, 150, 150, 150, 78, 111, 150, 44, 150, 150, 150, 150, 124, 150, 150, 124, 150, 150, 150, 150, 143, 92, 150, 150, 127, 150, 150, 150, 140, 139, 150, 150, 122, 67, 150, 150, 71, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 69, 38, 150, 150, 150, 150, 150, 150, 117, 102, 150, 150], "policy_policy_0_reward": [-702.9594800343233, -1009.9137477700278, -717.3666385654435, -585.3689190094404, -812.4201742457831, -226.45843097138226, -707.2301437201747, -973.755707935219, -1064.5076334718428, -755.1066194573336, -559.2538750269894, -958.095357902945, -903.0271079010978, -60.4632340045626, -1152.6811796560783, -69.9020351964495, -856.1177369109597, -306.9088761860158, -472.3800217697253, -902.8755651893665, -1255.5515605094338, -661.4968658928361, -733.7752377851846, -1363.0585105913362, -581.2564898044328, -74.40821882771986, -435.58949119613567, -429.1394557899633, -27.06975175740652, -457.09410750242523, -804.3275281698227, -783.2408277034604, -397.1242916283769, -276.9379475202717, -721.0840653669442, -969.8070619150377, -459.86721345422995, -1049.081781449874, -993.6472822153024, -860.8950949886381, -1011.7624128844249, -553.9294797803574, -326.19099517727074, -739.8307005829075, -953.2570349760787, -325.2487003313991, -1182.3537453417316, -767.5173265670866, -205.86659436044923, -536.0770455352358, -506.2869453270374, -1145.3796410320056, -784.3130646655621, -457.04027829282035, -111.48001028486651, -1023.0354480305224, -834.1585150927802, -213.09783242988948, -45.55803003009983, -1151.8876879204897, -948.4824713716388, -916.2996621434755, -1005.8564156701822, -388.52258074637854, -746.3395868527675, -603.4660445212762, -1027.6755254723362, -1008.7220962078572, -1111.9925702569453, -663.335689875574, -1342.8792369679968, -150.4695912704948, -693.7451086804001, -418.006259255389, -1063.3461130811995, -887.5630736124958, -1238.5274939114531, -1062.1356282261645, -938.4971729339159, -1184.5117496074772, -813.8474234236851, -1026.1624063309253, -1455.9772766442736, -896.6582920386246, -906.803243604354, -1033.6365699410035, -502.79426622402514, -327.28314628398743, -187.2243344021117, -5.629876564576313, -810.5622338092943, -1040.0975099633704, -887.9887768509784, -828.9675373769653, -1081.725861411976, -626.3899056032656, -204.937206955393, -371.979030863174, -785.3666961049532, -1002.849793412803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543452435825666, "mean_inference_ms": 1.6951718784535563, "mean_action_processing_ms": 0.281104675313792, "mean_env_wait_ms": 3.0123893714688217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012115001678466797, "StateBufferConnector_ms": 0.007910966873168945, "ViewRequirementAgentConnector_ms": 0.19150280952453613}, "num_episodes": 30, "episode_return_max": -5.629876564576313, "episode_return_min": -1455.9772766442736, "episode_return_mean": -722.0277221611218, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.0357591511598, "num_env_steps_trained_throughput_per_sec": 330.0357591511598, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13279.446, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13279.37, "sample_time_ms": 1028.161, "learn_time_ms": 12181.848, "learn_throughput": 328.357, "synch_weights_time_ms": 68.407}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00016", "date": "2024-08-03_11-47-25", "timestamp": 1722665845, "time_this_iter_s": 12.13275694847107, "time_total_s": 158.04095649719238, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433ecb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 158.04095649719238, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 14.038888888888888, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.630079852665464, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.115520439048607, "policy_loss": -0.011255537816032302, "vf_loss": 9.12339926858743, "vf_explained_var": 0.5745448038602868, "kl": 0.015846701880703525, "entropy": 1.3772974853714308, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -5.629876564576313, "episode_reward_min": -1455.9772766442736, "episode_reward_mean": -683.0181511581037, "episode_len_mean": 135.47, "episode_media": {}, "episodes_timesteps_total": 13547, "policy_reward_min": {"policy_0": -1455.9772766442736}, "policy_reward_max": {"policy_0": -5.629876564576313}, "policy_reward_mean": {"policy_0": -683.0181511581037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.06975175740652, -457.09410750242523, -804.3275281698227, -783.2408277034604, -397.1242916283769, -276.9379475202717, -721.0840653669442, -969.8070619150377, -459.86721345422995, -1049.081781449874, -993.6472822153024, -860.8950949886381, -1011.7624128844249, -553.9294797803574, -326.19099517727074, -739.8307005829075, -953.2570349760787, -325.2487003313991, -1182.3537453417316, -767.5173265670866, -205.86659436044923, -536.0770455352358, -506.2869453270374, -1145.3796410320056, -784.3130646655621, -457.04027829282035, -111.48001028486651, -1023.0354480305224, -834.1585150927802, -213.09783242988948, -45.55803003009983, -1151.8876879204897, -948.4824713716388, -916.2996621434755, -1005.8564156701822, -388.52258074637854, -746.3395868527675, -603.4660445212762, -1027.6755254723362, -1008.7220962078572, -1111.9925702569453, -663.335689875574, -1342.8792369679968, -150.4695912704948, -693.7451086804001, -418.006259255389, -1063.3461130811995, -887.5630736124958, -1238.5274939114531, -1062.1356282261645, -938.4971729339159, -1184.5117496074772, -813.8474234236851, -1026.1624063309253, -1455.9772766442736, -896.6582920386246, -906.803243604354, -1033.6365699410035, -502.79426622402514, -327.28314628398743, -187.2243344021117, -5.629876564576313, -810.5622338092943, -1040.0975099633704, -887.9887768509784, -828.9675373769653, -1081.725861411976, -626.3899056032656, -204.937206955393, -371.979030863174, -785.3666961049532, -1002.849793412803, -81.80726294371378, -390.7282091894307, -866.964323057437, -454.5321039798644, -773.0727900268905, -600.5583740642351, -1236.262272911466, -34.289195070736575, -213.2488361330197, -497.6241783393393, -469.4610169659317, -1000.7346700983718, -488.5320652619393, -518.008985746431, -765.7801661100583, -621.5633029493097, -451.23744195696713, -442.3161091468752, -1150.9455991329687, -652.5812434524333, -957.6512739667688, -207.22832216286045, -265.6552162147467, -11.72902420802455, -394.08494614807853, -1010.7670593115491, -190.33313336053044, -682.4140931104355], "episode_lengths": [44, 150, 150, 150, 150, 124, 150, 150, 124, 150, 150, 150, 150, 143, 92, 150, 150, 127, 150, 150, 150, 140, 139, 150, 150, 122, 67, 150, 150, 71, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 69, 38, 150, 150, 150, 150, 150, 150, 117, 102, 150, 150, 93, 150, 150, 142, 147, 150, 150, 53, 119, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 76, 109, 43, 98, 150, 96, 150], "policy_policy_0_reward": [-27.06975175740652, -457.09410750242523, -804.3275281698227, -783.2408277034604, -397.1242916283769, -276.9379475202717, -721.0840653669442, -969.8070619150377, -459.86721345422995, -1049.081781449874, -993.6472822153024, -860.8950949886381, -1011.7624128844249, -553.9294797803574, -326.19099517727074, -739.8307005829075, -953.2570349760787, -325.2487003313991, -1182.3537453417316, -767.5173265670866, -205.86659436044923, -536.0770455352358, -506.2869453270374, -1145.3796410320056, -784.3130646655621, -457.04027829282035, -111.48001028486651, -1023.0354480305224, -834.1585150927802, -213.09783242988948, -45.55803003009983, -1151.8876879204897, -948.4824713716388, -916.2996621434755, -1005.8564156701822, -388.52258074637854, -746.3395868527675, -603.4660445212762, -1027.6755254723362, -1008.7220962078572, -1111.9925702569453, -663.335689875574, -1342.8792369679968, -150.4695912704948, -693.7451086804001, -418.006259255389, -1063.3461130811995, -887.5630736124958, -1238.5274939114531, -1062.1356282261645, -938.4971729339159, -1184.5117496074772, -813.8474234236851, -1026.1624063309253, -1455.9772766442736, -896.6582920386246, -906.803243604354, -1033.6365699410035, -502.79426622402514, -327.28314628398743, -187.2243344021117, -5.629876564576313, -810.5622338092943, -1040.0975099633704, -887.9887768509784, -828.9675373769653, -1081.725861411976, -626.3899056032656, -204.937206955393, -371.979030863174, -785.3666961049532, -1002.849793412803, -81.80726294371378, -390.7282091894307, -866.964323057437, -454.5321039798644, -773.0727900268905, -600.5583740642351, -1236.262272911466, -34.289195070736575, -213.2488361330197, -497.6241783393393, -469.4610169659317, -1000.7346700983718, -488.5320652619393, -518.008985746431, -765.7801661100583, -621.5633029493097, -451.23744195696713, -442.3161091468752, -1150.9455991329687, -652.5812434524333, -957.6512739667688, -207.22832216286045, -265.6552162147467, -11.72902420802455, -394.08494614807853, -1010.7670593115491, -190.33313336053044, -682.4140931104355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536888539206156, "mean_inference_ms": 1.6948959118719216, "mean_action_processing_ms": 0.28096249904160187, "mean_env_wait_ms": 3.0153827231563146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011951446533203125, "StateBufferConnector_ms": 0.008010149002075195, "ViewRequirementAgentConnector_ms": 0.19452977180480957}, "num_episodes": 28, "episode_return_max": -5.629876564576313, "episode_return_min": -1455.9772766442736, "episode_return_mean": -683.0181511581037, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.74835182199956, "num_env_steps_trained_throughput_per_sec": 292.74835182199956, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13292.817, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13292.74, "sample_time_ms": 1035.412, "learn_time_ms": 12188.556, "learn_throughput": 328.177, "synch_weights_time_ms": 67.821}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00016", "date": "2024-08-03_11-47-38", "timestamp": 1722665858, "time_this_iter_s": 13.675836086273193, "time_total_s": 171.71679258346558, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b4d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 171.71679258346558, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 14.373684210526314, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.84830308308204, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.399941467742126, "policy_loss": -0.011461475738906301, "vf_loss": 8.407569355765979, "vf_explained_var": 0.5797982699548204, "kl": 0.017637344075198295, "entropy": 1.4576218663404386, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -0.4113039842560311, "episode_reward_min": -1455.9772766442736, "episode_reward_mean": -696.0065085676356, "episode_len_mean": 135.83, "episode_media": {}, "episodes_timesteps_total": 13583, "policy_reward_min": {"policy_0": -1455.9772766442736}, "policy_reward_max": {"policy_0": -0.4113039842560311}, "policy_reward_mean": {"policy_0": -696.0065085676356}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-948.4824713716388, -916.2996621434755, -1005.8564156701822, -388.52258074637854, -746.3395868527675, -603.4660445212762, -1027.6755254723362, -1008.7220962078572, -1111.9925702569453, -663.335689875574, -1342.8792369679968, -150.4695912704948, -693.7451086804001, -418.006259255389, -1063.3461130811995, -887.5630736124958, -1238.5274939114531, -1062.1356282261645, -938.4971729339159, -1184.5117496074772, -813.8474234236851, -1026.1624063309253, -1455.9772766442736, -896.6582920386246, -906.803243604354, -1033.6365699410035, -502.79426622402514, -327.28314628398743, -187.2243344021117, -5.629876564576313, -810.5622338092943, -1040.0975099633704, -887.9887768509784, -828.9675373769653, -1081.725861411976, -626.3899056032656, -204.937206955393, -371.979030863174, -785.3666961049532, -1002.849793412803, -81.80726294371378, -390.7282091894307, -866.964323057437, -454.5321039798644, -773.0727900268905, -600.5583740642351, -1236.262272911466, -34.289195070736575, -213.2488361330197, -497.6241783393393, -469.4610169659317, -1000.7346700983718, -488.5320652619393, -518.008985746431, -765.7801661100583, -621.5633029493097, -451.23744195696713, -442.3161091468752, -1150.9455991329687, -652.5812434524333, -957.6512739667688, -207.22832216286045, -265.6552162147467, -11.72902420802455, -394.08494614807853, -1010.7670593115491, -190.33313336053044, -682.4140931104355, -581.7543228174114, -514.5165475676666, -1174.5893541523685, -1189.4159175356663, -280.8635563333931, -428.85089728002436, -506.4574067451256, -1113.1795965119338, -1085.335531294791, -669.9820635303237, -46.618782758752985, -621.5352000172476, -406.3144643308491, -609.5284078722209, -898.3669843758204, -954.1465747974572, -1191.787884381542, -599.1276030140731, -1066.3581097095348, -1172.9410337459956, -712.4377332442541, -0.4113039842560311, -758.8395723704738, -623.7416773974851, -445.25954314086897, -1062.459704801675, -1103.454679352137, -513.2661577800762, -88.55064019507944, -601.1626776391212, -904.319732988464, -47.710521601910564], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 69, 38, 150, 150, 150, 150, 150, 150, 117, 102, 150, 150, 93, 150, 150, 142, 147, 150, 150, 53, 119, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 76, 109, 43, 98, 150, 96, 150, 150, 132, 150, 150, 83, 131, 148, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 131, 150, 150, 150, 81, 150, 150, 62], "policy_policy_0_reward": [-948.4824713716388, -916.2996621434755, -1005.8564156701822, -388.52258074637854, -746.3395868527675, -603.4660445212762, -1027.6755254723362, -1008.7220962078572, -1111.9925702569453, -663.335689875574, -1342.8792369679968, -150.4695912704948, -693.7451086804001, -418.006259255389, -1063.3461130811995, -887.5630736124958, -1238.5274939114531, -1062.1356282261645, -938.4971729339159, -1184.5117496074772, -813.8474234236851, -1026.1624063309253, -1455.9772766442736, -896.6582920386246, -906.803243604354, -1033.6365699410035, -502.79426622402514, -327.28314628398743, -187.2243344021117, -5.629876564576313, -810.5622338092943, -1040.0975099633704, -887.9887768509784, -828.9675373769653, -1081.725861411976, -626.3899056032656, -204.937206955393, -371.979030863174, -785.3666961049532, -1002.849793412803, -81.80726294371378, -390.7282091894307, -866.964323057437, -454.5321039798644, -773.0727900268905, -600.5583740642351, -1236.262272911466, -34.289195070736575, -213.2488361330197, -497.6241783393393, -469.4610169659317, -1000.7346700983718, -488.5320652619393, -518.008985746431, -765.7801661100583, -621.5633029493097, -451.23744195696713, -442.3161091468752, -1150.9455991329687, -652.5812434524333, -957.6512739667688, -207.22832216286045, -265.6552162147467, -11.72902420802455, -394.08494614807853, -1010.7670593115491, -190.33313336053044, -682.4140931104355, -581.7543228174114, -514.5165475676666, -1174.5893541523685, -1189.4159175356663, -280.8635563333931, -428.85089728002436, -506.4574067451256, -1113.1795965119338, -1085.335531294791, -669.9820635303237, -46.618782758752985, -621.5352000172476, -406.3144643308491, -609.5284078722209, -898.3669843758204, -954.1465747974572, -1191.787884381542, -599.1276030140731, -1066.3581097095348, -1172.9410337459956, -712.4377332442541, -0.4113039842560311, -758.8395723704738, -623.7416773974851, -445.25954314086897, -1062.459704801675, -1103.454679352137, -513.2661577800762, -88.55064019507944, -601.1626776391212, -904.319732988464, -47.710521601910564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534137356928506, "mean_inference_ms": 1.6950971305495381, "mean_action_processing_ms": 0.280738858554894, "mean_env_wait_ms": 3.020465620942645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011915206909179688, "StateBufferConnector_ms": 0.008110523223876953, "ViewRequirementAgentConnector_ms": 0.1980724334716797}, "num_episodes": 32, "episode_return_max": -0.4113039842560311, "episode_return_min": -1455.9772766442736, "episode_return_mean": -696.0065085676356, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.8545237997934, "num_env_steps_trained_throughput_per_sec": 300.8545237997934, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13300.367, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13300.29, "sample_time_ms": 1038.033, "learn_time_ms": 12193.666, "learn_throughput": 328.039, "synch_weights_time_ms": 67.646}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00016", "date": "2024-08-03_11-47-52", "timestamp": 1722665872, "time_this_iter_s": 13.309250116348267, "time_total_s": 185.02604269981384, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244493910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 185.02604269981384, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.957894736842105, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.52796711474657, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.35020517806212, "policy_loss": -0.00991757727751974, "vf_loss": 8.356247301896413, "vf_explained_var": 0.584169874402384, "kl": 0.017500026602101586, "entropy": 1.3745408558597167, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": 0.04768324733990259, "episode_reward_min": -1236.262272911466, "episode_reward_mean": -645.215393974923, "episode_len_mean": 133.48, "episode_media": {}, "episodes_timesteps_total": 13348, "policy_reward_min": {"policy_0": -1236.262272911466}, "policy_reward_max": {"policy_0": 0.04768324733990259}, "policy_reward_mean": {"policy_0": -645.215393974923}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-810.5622338092943, -1040.0975099633704, -887.9887768509784, -828.9675373769653, -1081.725861411976, -626.3899056032656, -204.937206955393, -371.979030863174, -785.3666961049532, -1002.849793412803, -81.80726294371378, -390.7282091894307, -866.964323057437, -454.5321039798644, -773.0727900268905, -600.5583740642351, -1236.262272911466, -34.289195070736575, -213.2488361330197, -497.6241783393393, -469.4610169659317, -1000.7346700983718, -488.5320652619393, -518.008985746431, -765.7801661100583, -621.5633029493097, -451.23744195696713, -442.3161091468752, -1150.9455991329687, -652.5812434524333, -957.6512739667688, -207.22832216286045, -265.6552162147467, -11.72902420802455, -394.08494614807853, -1010.7670593115491, -190.33313336053044, -682.4140931104355, -581.7543228174114, -514.5165475676666, -1174.5893541523685, -1189.4159175356663, -280.8635563333931, -428.85089728002436, -506.4574067451256, -1113.1795965119338, -1085.335531294791, -669.9820635303237, -46.618782758752985, -621.5352000172476, -406.3144643308491, -609.5284078722209, -898.3669843758204, -954.1465747974572, -1191.787884381542, -599.1276030140731, -1066.3581097095348, -1172.9410337459956, -712.4377332442541, -0.4113039842560311, -758.8395723704738, -623.7416773974851, -445.25954314086897, -1062.459704801675, -1103.454679352137, -513.2661577800762, -88.55064019507944, -601.1626776391212, -904.319732988464, -47.710521601910564, -782.5290960837971, -376.12103106706047, -240.3706328732893, -505.1829052186098, -405.5115785249274, -1005.1785100505474, -387.2623201397382, -1093.8805830340418, -369.8400895690922, -983.7022458374341, -984.8969518385446, 0.04768324733990259, -916.5622473457385, -1132.8862842629508, -878.4022971880341, -853.68666850037, -97.98641140334243, -1151.3783563811257, -1133.6886493757845, -897.9118646399622, -1111.1523305545377, -347.359315214947, -207.241898519127, -320.1550122784705, -401.99186388499226, -729.2852833041551, -723.110554718892, -209.35377959150486, -453.48845493945583, -777.2099137585826], "episode_lengths": [150, 150, 150, 150, 150, 150, 117, 102, 150, 150, 93, 150, 150, 142, 147, 150, 150, 53, 119, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 76, 109, 43, 98, 150, 96, 150, 150, 132, 150, 150, 83, 131, 148, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 131, 150, 150, 150, 81, 150, 150, 62, 150, 150, 92, 123, 141, 150, 150, 150, 96, 150, 150, 31, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 109, 96, 150, 150, 150, 79, 150, 150], "policy_policy_0_reward": [-810.5622338092943, -1040.0975099633704, -887.9887768509784, -828.9675373769653, -1081.725861411976, -626.3899056032656, -204.937206955393, -371.979030863174, -785.3666961049532, -1002.849793412803, -81.80726294371378, -390.7282091894307, -866.964323057437, -454.5321039798644, -773.0727900268905, -600.5583740642351, -1236.262272911466, -34.289195070736575, -213.2488361330197, -497.6241783393393, -469.4610169659317, -1000.7346700983718, -488.5320652619393, -518.008985746431, -765.7801661100583, -621.5633029493097, -451.23744195696713, -442.3161091468752, -1150.9455991329687, -652.5812434524333, -957.6512739667688, -207.22832216286045, -265.6552162147467, -11.72902420802455, -394.08494614807853, -1010.7670593115491, -190.33313336053044, -682.4140931104355, -581.7543228174114, -514.5165475676666, -1174.5893541523685, -1189.4159175356663, -280.8635563333931, -428.85089728002436, -506.4574067451256, -1113.1795965119338, -1085.335531294791, -669.9820635303237, -46.618782758752985, -621.5352000172476, -406.3144643308491, -609.5284078722209, -898.3669843758204, -954.1465747974572, -1191.787884381542, -599.1276030140731, -1066.3581097095348, -1172.9410337459956, -712.4377332442541, -0.4113039842560311, -758.8395723704738, -623.7416773974851, -445.25954314086897, -1062.459704801675, -1103.454679352137, -513.2661577800762, -88.55064019507944, -601.1626776391212, -904.319732988464, -47.710521601910564, -782.5290960837971, -376.12103106706047, -240.3706328732893, -505.1829052186098, -405.5115785249274, -1005.1785100505474, -387.2623201397382, -1093.8805830340418, -369.8400895690922, -983.7022458374341, -984.8969518385446, 0.04768324733990259, -916.5622473457385, -1132.8862842629508, -878.4022971880341, -853.68666850037, -97.98641140334243, -1151.3783563811257, -1133.6886493757845, -897.9118646399622, -1111.1523305545377, -347.359315214947, -207.241898519127, -320.1550122784705, -401.99186388499226, -729.2852833041551, -723.110554718892, -209.35377959150486, -453.48845493945583, -777.2099137585826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534108735210556, "mean_inference_ms": 1.6963773289080522, "mean_action_processing_ms": 0.28098130093686785, "mean_env_wait_ms": 3.0253713200636843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012286901473999023, "StateBufferConnector_ms": 0.008083581924438477, "ViewRequirementAgentConnector_ms": 0.1992628574371338}, "num_episodes": 30, "episode_return_max": 0.04768324733990259, "episode_return_min": -1236.262272911466, "episode_return_mean": -645.215393974923, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.10897382388595, "num_env_steps_trained_throughput_per_sec": 301.10897382388595, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13272.528, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13272.451, "sample_time_ms": 1044.592, "learn_time_ms": 12158.942, "learn_throughput": 328.976, "synch_weights_time_ms": 67.969}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00016", "date": "2024-08-03_11-48-05", "timestamp": 1722665885, "time_this_iter_s": 13.298752546310425, "time_total_s": 198.32479524612427, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433f6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 198.32479524612427, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 14.06842105263158, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.673072394231955, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.536483963827292, "policy_loss": -0.008988744699551413, "vf_loss": 8.541523351271946, "vf_explained_var": 0.7110941290234526, "kl": 0.01764770486151974, "entropy": 1.3449708633124828, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 0.04768324733990259, "episode_reward_min": -1393.5228204585026, "episode_reward_mean": -632.4329052149259, "episode_len_mean": 130.55, "episode_media": {}, "episodes_timesteps_total": 13055, "policy_reward_min": {"policy_0": -1393.5228204585026}, "policy_reward_max": {"policy_0": 0.04768324733990259}, "policy_reward_mean": {"policy_0": -632.4329052149259}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207.22832216286045, -265.6552162147467, -11.72902420802455, -394.08494614807853, -1010.7670593115491, -190.33313336053044, -682.4140931104355, -581.7543228174114, -514.5165475676666, -1174.5893541523685, -1189.4159175356663, -280.8635563333931, -428.85089728002436, -506.4574067451256, -1113.1795965119338, -1085.335531294791, -669.9820635303237, -46.618782758752985, -621.5352000172476, -406.3144643308491, -609.5284078722209, -898.3669843758204, -954.1465747974572, -1191.787884381542, -599.1276030140731, -1066.3581097095348, -1172.9410337459956, -712.4377332442541, -0.4113039842560311, -758.8395723704738, -623.7416773974851, -445.25954314086897, -1062.459704801675, -1103.454679352137, -513.2661577800762, -88.55064019507944, -601.1626776391212, -904.319732988464, -47.710521601910564, -782.5290960837971, -376.12103106706047, -240.3706328732893, -505.1829052186098, -405.5115785249274, -1005.1785100505474, -387.2623201397382, -1093.8805830340418, -369.8400895690922, -983.7022458374341, -984.8969518385446, 0.04768324733990259, -916.5622473457385, -1132.8862842629508, -878.4022971880341, -853.68666850037, -97.98641140334243, -1151.3783563811257, -1133.6886493757845, -897.9118646399622, -1111.1523305545377, -347.359315214947, -207.241898519127, -320.1550122784705, -401.99186388499226, -729.2852833041551, -723.110554718892, -209.35377959150486, -453.48845493945583, -777.2099137585826, -774.1199078844392, -954.7101202484846, -598.3179652898932, -960.5102173282313, -333.094353212774, -383.74825593681976, -1056.8016139770054, -290.4053422167205, -614.8254868903805, -322.83439398571136, -192.7631253481593, -1010.0273982257619, -326.8519809000121, -858.5241368045752, -80.62438862314204, -475.6266613765796, -1075.7656200730778, -1393.5228204585026, -35.7251174788906, -396.20361389628306, -179.5034934214954, -876.0214392910376, -675.7199339453405, -1125.9340898498697, -680.3184653773633, -649.0087554445403, -632.5035153374704, -117.78996396970021, -986.6862904446007, -149.43012136857482, -822.5965082512098], "episode_lengths": [76, 109, 43, 98, 150, 96, 150, 150, 132, 150, 150, 83, 131, 148, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 131, 150, 150, 150, 81, 150, 150, 62, 150, 150, 92, 123, 141, 150, 150, 150, 96, 150, 150, 31, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 109, 96, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 107, 145, 150, 88, 150, 112, 86, 150, 111, 150, 74, 150, 150, 150, 49, 149, 75, 150, 150, 150, 150, 150, 150, 96, 150, 91, 150], "policy_policy_0_reward": [-207.22832216286045, -265.6552162147467, -11.72902420802455, -394.08494614807853, -1010.7670593115491, -190.33313336053044, -682.4140931104355, -581.7543228174114, -514.5165475676666, -1174.5893541523685, -1189.4159175356663, -280.8635563333931, -428.85089728002436, -506.4574067451256, -1113.1795965119338, -1085.335531294791, -669.9820635303237, -46.618782758752985, -621.5352000172476, -406.3144643308491, -609.5284078722209, -898.3669843758204, -954.1465747974572, -1191.787884381542, -599.1276030140731, -1066.3581097095348, -1172.9410337459956, -712.4377332442541, -0.4113039842560311, -758.8395723704738, -623.7416773974851, -445.25954314086897, -1062.459704801675, -1103.454679352137, -513.2661577800762, -88.55064019507944, -601.1626776391212, -904.319732988464, -47.710521601910564, -782.5290960837971, -376.12103106706047, -240.3706328732893, -505.1829052186098, -405.5115785249274, -1005.1785100505474, -387.2623201397382, -1093.8805830340418, -369.8400895690922, -983.7022458374341, -984.8969518385446, 0.04768324733990259, -916.5622473457385, -1132.8862842629508, -878.4022971880341, -853.68666850037, -97.98641140334243, -1151.3783563811257, -1133.6886493757845, -897.9118646399622, -1111.1523305545377, -347.359315214947, -207.241898519127, -320.1550122784705, -401.99186388499226, -729.2852833041551, -723.110554718892, -209.35377959150486, -453.48845493945583, -777.2099137585826, -774.1199078844392, -954.7101202484846, -598.3179652898932, -960.5102173282313, -333.094353212774, -383.74825593681976, -1056.8016139770054, -290.4053422167205, -614.8254868903805, -322.83439398571136, -192.7631253481593, -1010.0273982257619, -326.8519809000121, -858.5241368045752, -80.62438862314204, -475.6266613765796, -1075.7656200730778, -1393.5228204585026, -35.7251174788906, -396.20361389628306, -179.5034934214954, -876.0214392910376, -675.7199339453405, -1125.9340898498697, -680.3184653773633, -649.0087554445403, -632.5035153374704, -117.78996396970021, -986.6862904446007, -149.43012136857482, -822.5965082512098]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538042276014061, "mean_inference_ms": 1.6988708447744156, "mean_action_processing_ms": 0.28126843533704127, "mean_env_wait_ms": 3.0332097595901555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012185811996459961, "StateBufferConnector_ms": 0.00803065299987793, "ViewRequirementAgentConnector_ms": 0.1980571746826172}, "num_episodes": 31, "episode_return_max": 0.04768324733990259, "episode_return_min": -1393.5228204585026, "episode_return_mean": -632.4329052149259, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.17158162013953, "num_env_steps_trained_throughput_per_sec": 294.17158162013953, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13280.117, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13280.041, "sample_time_ms": 1045.539, "learn_time_ms": 12164.728, "learn_throughput": 328.82, "synch_weights_time_ms": 68.811}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00016", "date": "2024-08-03_11-48-19", "timestamp": 1722665899, "time_this_iter_s": 13.611729860305786, "time_total_s": 211.93652510643005, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433c670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 211.93652510643005, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.795000000000002, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.197865622490646, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.276784590880077, "policy_loss": -0.009500537529675057, "vf_loss": 8.282238234082858, "vf_explained_var": 0.7256151969234149, "kl": 0.01804175453125938, "entropy": 1.3656279417996606, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": 0.04768324733990259, "episode_reward_min": -1393.5228204585026, "episode_reward_mean": -650.126666174643, "episode_len_mean": 130.99, "episode_media": {}, "episodes_timesteps_total": 13099, "policy_reward_min": {"policy_0": -1393.5228204585026}, "policy_reward_max": {"policy_0": 0.04768324733990259}, "policy_reward_mean": {"policy_0": -650.126666174643}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-623.7416773974851, -445.25954314086897, -1062.459704801675, -1103.454679352137, -513.2661577800762, -88.55064019507944, -601.1626776391212, -904.319732988464, -47.710521601910564, -782.5290960837971, -376.12103106706047, -240.3706328732893, -505.1829052186098, -405.5115785249274, -1005.1785100505474, -387.2623201397382, -1093.8805830340418, -369.8400895690922, -983.7022458374341, -984.8969518385446, 0.04768324733990259, -916.5622473457385, -1132.8862842629508, -878.4022971880341, -853.68666850037, -97.98641140334243, -1151.3783563811257, -1133.6886493757845, -897.9118646399622, -1111.1523305545377, -347.359315214947, -207.241898519127, -320.1550122784705, -401.99186388499226, -729.2852833041551, -723.110554718892, -209.35377959150486, -453.48845493945583, -777.2099137585826, -774.1199078844392, -954.7101202484846, -598.3179652898932, -960.5102173282313, -333.094353212774, -383.74825593681976, -1056.8016139770054, -290.4053422167205, -614.8254868903805, -322.83439398571136, -192.7631253481593, -1010.0273982257619, -326.8519809000121, -858.5241368045752, -80.62438862314204, -475.6266613765796, -1075.7656200730778, -1393.5228204585026, -35.7251174788906, -396.20361389628306, -179.5034934214954, -876.0214392910376, -675.7199339453405, -1125.9340898498697, -680.3184653773633, -649.0087554445403, -632.5035153374704, -117.78996396970021, -986.6862904446007, -149.43012136857482, -822.5965082512098, -990.3576688013997, -243.93264673937992, -1232.107898632862, -611.4507291652632, -1014.6098957793494, -38.22625287128497, -809.9312076704585, -1012.5408007850388, -433.5603763599728, -352.2413448826001, -255.17396997171738, -99.0601012373813, -821.3096313032286, -644.0206854958029, -737.3326840548393, -1161.803843617383, -508.39542858989876, -427.932162016457, -863.5777090086177, -889.8184814944597, -1014.9846829642827, -919.3913491142765, -46.39716846743482, -94.77224432984664, -984.2219111089003, -697.6138499823139, -1367.6936006911174, -885.4357742205149, -952.7790090957907, -1004.273630407243], "episode_lengths": [150, 131, 150, 150, 150, 81, 150, 150, 62, 150, 150, 92, 123, 141, 150, 150, 150, 96, 150, 150, 31, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 109, 96, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 107, 145, 150, 88, 150, 112, 86, 150, 111, 150, 74, 150, 150, 150, 49, 149, 75, 150, 150, 150, 150, 150, 150, 96, 150, 91, 150, 150, 92, 150, 150, 150, 74, 150, 150, 110, 92, 82, 80, 150, 150, 150, 150, 110, 143, 150, 150, 150, 150, 54, 62, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-623.7416773974851, -445.25954314086897, -1062.459704801675, -1103.454679352137, -513.2661577800762, -88.55064019507944, -601.1626776391212, -904.319732988464, -47.710521601910564, -782.5290960837971, -376.12103106706047, -240.3706328732893, -505.1829052186098, -405.5115785249274, -1005.1785100505474, -387.2623201397382, -1093.8805830340418, -369.8400895690922, -983.7022458374341, -984.8969518385446, 0.04768324733990259, -916.5622473457385, -1132.8862842629508, -878.4022971880341, -853.68666850037, -97.98641140334243, -1151.3783563811257, -1133.6886493757845, -897.9118646399622, -1111.1523305545377, -347.359315214947, -207.241898519127, -320.1550122784705, -401.99186388499226, -729.2852833041551, -723.110554718892, -209.35377959150486, -453.48845493945583, -777.2099137585826, -774.1199078844392, -954.7101202484846, -598.3179652898932, -960.5102173282313, -333.094353212774, -383.74825593681976, -1056.8016139770054, -290.4053422167205, -614.8254868903805, -322.83439398571136, -192.7631253481593, -1010.0273982257619, -326.8519809000121, -858.5241368045752, -80.62438862314204, -475.6266613765796, -1075.7656200730778, -1393.5228204585026, -35.7251174788906, -396.20361389628306, -179.5034934214954, -876.0214392910376, -675.7199339453405, -1125.9340898498697, -680.3184653773633, -649.0087554445403, -632.5035153374704, -117.78996396970021, -986.6862904446007, -149.43012136857482, -822.5965082512098, -990.3576688013997, -243.93264673937992, -1232.107898632862, -611.4507291652632, -1014.6098957793494, -38.22625287128497, -809.9312076704585, -1012.5408007850388, -433.5603763599728, -352.2413448826001, -255.17396997171738, -99.0601012373813, -821.3096313032286, -644.0206854958029, -737.3326840548393, -1161.803843617383, -508.39542858989876, -427.932162016457, -863.5777090086177, -889.8184814944597, -1014.9846829642827, -919.3913491142765, -46.39716846743482, -94.77224432984664, -984.2219111089003, -697.6138499823139, -1367.6936006911174, -885.4357742205149, -952.7790090957907, -1004.273630407243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554363552629783, "mean_inference_ms": 1.6994513611030682, "mean_action_processing_ms": 0.2811611140629969, "mean_env_wait_ms": 3.035000997802747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012091398239135742, "StateBufferConnector_ms": 0.008034944534301758, "ViewRequirementAgentConnector_ms": 0.19827723503112793}, "num_episodes": 30, "episode_return_max": 0.04768324733990259, "episode_return_min": -1393.5228204585026, "episode_return_mean": -650.126666174643, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.59614632079985, "num_env_steps_trained_throughput_per_sec": 298.59614632079985, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13339.466, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13339.387, "sample_time_ms": 1047.654, "learn_time_ms": 12220.061, "learn_throughput": 327.331, "synch_weights_time_ms": 70.704}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00016", "date": "2024-08-03_11-48-32", "timestamp": 1722665912, "time_this_iter_s": 13.408199071884155, "time_total_s": 225.3447241783142, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433e0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 225.3447241783142, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 14.221052631578948, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.35889493053158, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.469698638717334, "policy_loss": -0.007246555241484505, "vf_loss": 8.4736585299174, "vf_explained_var": 0.7013082722201943, "kl": 0.01578778584049968, "entropy": 1.4496538143604993, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -35.7251174788906, "episode_reward_min": -1393.5228204585026, "episode_reward_mean": -636.2451606316389, "episode_len_mean": 130.28, "episode_media": {}, "episodes_timesteps_total": 13028, "policy_reward_min": {"policy_0": -1393.5228204585026}, "policy_reward_max": {"policy_0": -35.7251174788906}, "policy_reward_mean": {"policy_0": -636.2451606316389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-347.359315214947, -207.241898519127, -320.1550122784705, -401.99186388499226, -729.2852833041551, -723.110554718892, -209.35377959150486, -453.48845493945583, -777.2099137585826, -774.1199078844392, -954.7101202484846, -598.3179652898932, -960.5102173282313, -333.094353212774, -383.74825593681976, -1056.8016139770054, -290.4053422167205, -614.8254868903805, -322.83439398571136, -192.7631253481593, -1010.0273982257619, -326.8519809000121, -858.5241368045752, -80.62438862314204, -475.6266613765796, -1075.7656200730778, -1393.5228204585026, -35.7251174788906, -396.20361389628306, -179.5034934214954, -876.0214392910376, -675.7199339453405, -1125.9340898498697, -680.3184653773633, -649.0087554445403, -632.5035153374704, -117.78996396970021, -986.6862904446007, -149.43012136857482, -822.5965082512098, -990.3576688013997, -243.93264673937992, -1232.107898632862, -611.4507291652632, -1014.6098957793494, -38.22625287128497, -809.9312076704585, -1012.5408007850388, -433.5603763599728, -352.2413448826001, -255.17396997171738, -99.0601012373813, -821.3096313032286, -644.0206854958029, -737.3326840548393, -1161.803843617383, -508.39542858989876, -427.932162016457, -863.5777090086177, -889.8184814944597, -1014.9846829642827, -919.3913491142765, -46.39716846743482, -94.77224432984664, -984.2219111089003, -697.6138499823139, -1367.6936006911174, -885.4357742205149, -952.7790090957907, -1004.273630407243, -479.765629149247, -384.890001645994, -996.7194947066687, -328.0773690346278, -1275.5286363249807, -84.30425912460503, -1020.5615841948929, -718.9432792481244, -529.6532538180048, -43.69237651594885, -271.42793268149154, -1010.8439747444511, -885.5919372302234, -940.7324507349033, -414.19619488267904, -85.29903587161115, -603.6004287319835, -652.1180420237763, -1071.3319842287874, -65.03428926109335, -369.91957059801024, -1381.286335789996, -792.1184322682725, -692.7030049899305, -859.2980474720794, -721.5524595861178, -962.989963713372, -449.39988930104056, -258.4643249464937, -959.8139684185928], "episode_lengths": [150, 109, 96, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 107, 145, 150, 88, 150, 112, 86, 150, 111, 150, 74, 150, 150, 150, 49, 149, 75, 150, 150, 150, 150, 150, 150, 96, 150, 91, 150, 150, 92, 150, 150, 150, 74, 150, 150, 110, 92, 82, 80, 150, 150, 150, 150, 110, 143, 150, 150, 150, 150, 54, 62, 150, 150, 150, 150, 150, 150, 128, 150, 150, 116, 150, 66, 150, 150, 150, 46, 81, 150, 150, 150, 150, 73, 150, 150, 150, 62, 97, 150, 150, 150, 150, 150, 150, 150, 93, 150], "policy_policy_0_reward": [-347.359315214947, -207.241898519127, -320.1550122784705, -401.99186388499226, -729.2852833041551, -723.110554718892, -209.35377959150486, -453.48845493945583, -777.2099137585826, -774.1199078844392, -954.7101202484846, -598.3179652898932, -960.5102173282313, -333.094353212774, -383.74825593681976, -1056.8016139770054, -290.4053422167205, -614.8254868903805, -322.83439398571136, -192.7631253481593, -1010.0273982257619, -326.8519809000121, -858.5241368045752, -80.62438862314204, -475.6266613765796, -1075.7656200730778, -1393.5228204585026, -35.7251174788906, -396.20361389628306, -179.5034934214954, -876.0214392910376, -675.7199339453405, -1125.9340898498697, -680.3184653773633, -649.0087554445403, -632.5035153374704, -117.78996396970021, -986.6862904446007, -149.43012136857482, -822.5965082512098, -990.3576688013997, -243.93264673937992, -1232.107898632862, -611.4507291652632, -1014.6098957793494, -38.22625287128497, -809.9312076704585, -1012.5408007850388, -433.5603763599728, -352.2413448826001, -255.17396997171738, -99.0601012373813, -821.3096313032286, -644.0206854958029, -737.3326840548393, -1161.803843617383, -508.39542858989876, -427.932162016457, -863.5777090086177, -889.8184814944597, -1014.9846829642827, -919.3913491142765, -46.39716846743482, -94.77224432984664, -984.2219111089003, -697.6138499823139, -1367.6936006911174, -885.4357742205149, -952.7790090957907, -1004.273630407243, -479.765629149247, -384.890001645994, -996.7194947066687, -328.0773690346278, -1275.5286363249807, -84.30425912460503, -1020.5615841948929, -718.9432792481244, -529.6532538180048, -43.69237651594885, -271.42793268149154, -1010.8439747444511, -885.5919372302234, -940.7324507349033, -414.19619488267904, -85.29903587161115, -603.6004287319835, -652.1180420237763, -1071.3319842287874, -65.03428926109335, -369.91957059801024, -1381.286335789996, -792.1184322682725, -692.7030049899305, -859.2980474720794, -721.5524595861178, -962.989963713372, -449.39988930104056, -258.4643249464937, -959.8139684185928]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552022610536553, "mean_inference_ms": 1.701277296536294, "mean_action_processing_ms": 0.28132567809814407, "mean_env_wait_ms": 3.0387720970381777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012247323989868164, "StateBufferConnector_ms": 0.008045196533203125, "ViewRequirementAgentConnector_ms": 0.19821572303771973}, "num_episodes": 30, "episode_return_max": -35.7251174788906, "episode_return_min": -1393.5228204585026, "episode_return_mean": -636.2451606316389, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.1581907165455, "num_env_steps_trained_throughput_per_sec": 302.1581907165455, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13325.846, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13325.766, "sample_time_ms": 1047.341, "learn_time_ms": 12208.147, "learn_throughput": 327.65, "synch_weights_time_ms": 69.357}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00016", "date": "2024-08-03_11-48-46", "timestamp": 1722665926, "time_this_iter_s": 13.25083041191101, "time_total_s": 238.59555459022522, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433ff40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 238.59555459022522, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 14.021052631578947, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.601631049315134, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.511732204755146, "policy_loss": -0.010572051638155245, "vf_loss": 8.518062103788058, "vf_explained_var": 0.7073070678239067, "kl": 0.01944704338483613, "entropy": 1.5919802481929461, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -38.22625287128497, "episode_reward_min": -1477.7169361087049, "episode_reward_mean": -687.6606619191837, "episode_len_mean": 131.96, "episode_media": {}, "episodes_timesteps_total": 13196, "policy_reward_min": {"policy_0": -1477.7169361087049}, "policy_reward_max": {"policy_0": -38.22625287128497}, "policy_reward_mean": {"policy_0": -687.6606619191837}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-680.3184653773633, -649.0087554445403, -632.5035153374704, -117.78996396970021, -986.6862904446007, -149.43012136857482, -822.5965082512098, -990.3576688013997, -243.93264673937992, -1232.107898632862, -611.4507291652632, -1014.6098957793494, -38.22625287128497, -809.9312076704585, -1012.5408007850388, -433.5603763599728, -352.2413448826001, -255.17396997171738, -99.0601012373813, -821.3096313032286, -644.0206854958029, -737.3326840548393, -1161.803843617383, -508.39542858989876, -427.932162016457, -863.5777090086177, -889.8184814944597, -1014.9846829642827, -919.3913491142765, -46.39716846743482, -94.77224432984664, -984.2219111089003, -697.6138499823139, -1367.6936006911174, -885.4357742205149, -952.7790090957907, -1004.273630407243, -479.765629149247, -384.890001645994, -996.7194947066687, -328.0773690346278, -1275.5286363249807, -84.30425912460503, -1020.5615841948929, -718.9432792481244, -529.6532538180048, -43.69237651594885, -271.42793268149154, -1010.8439747444511, -885.5919372302234, -940.7324507349033, -414.19619488267904, -85.29903587161115, -603.6004287319835, -652.1180420237763, -1071.3319842287874, -65.03428926109335, -369.91957059801024, -1381.286335789996, -792.1184322682725, -692.7030049899305, -859.2980474720794, -721.5524595861178, -962.989963713372, -449.39988930104056, -258.4643249464937, -959.8139684185928, -627.5772811176147, -954.7343798272548, -51.439478085104724, -213.82700590049222, -629.7593102914027, -117.71534321121399, -288.6074989636896, -316.5587183093036, -515.1654128686865, -632.4766682517711, -1146.1607785972637, -295.2143227554669, -1006.803422791188, -1007.4186266894216, -750.0607585943997, -949.759696581252, -987.1919445463773, -890.9275807495044, -1143.6250345637538, -437.09590891534697, -1134.1730892326862, -1148.46488508045, -127.44222447922017, -694.5355438485069, -688.500970648526, -148.21579188317233, -923.6423456213773, -1477.7169361087049, -971.5920493146549, -1154.887004028064, -1248.2412854392114, -1236.8482908472479, -386.5480934854453], "episode_lengths": [150, 150, 150, 96, 150, 91, 150, 150, 92, 150, 150, 150, 74, 150, 150, 110, 92, 82, 80, 150, 150, 150, 150, 110, 143, 150, 150, 150, 150, 54, 62, 150, 150, 150, 150, 150, 150, 128, 150, 150, 116, 150, 66, 150, 150, 150, 46, 81, 150, 150, 150, 150, 73, 150, 150, 150, 62, 97, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 76, 80, 150, 86, 84, 150, 142, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-680.3184653773633, -649.0087554445403, -632.5035153374704, -117.78996396970021, -986.6862904446007, -149.43012136857482, -822.5965082512098, -990.3576688013997, -243.93264673937992, -1232.107898632862, -611.4507291652632, -1014.6098957793494, -38.22625287128497, -809.9312076704585, -1012.5408007850388, -433.5603763599728, -352.2413448826001, -255.17396997171738, -99.0601012373813, -821.3096313032286, -644.0206854958029, -737.3326840548393, -1161.803843617383, -508.39542858989876, -427.932162016457, -863.5777090086177, -889.8184814944597, -1014.9846829642827, -919.3913491142765, -46.39716846743482, -94.77224432984664, -984.2219111089003, -697.6138499823139, -1367.6936006911174, -885.4357742205149, -952.7790090957907, -1004.273630407243, -479.765629149247, -384.890001645994, -996.7194947066687, -328.0773690346278, -1275.5286363249807, -84.30425912460503, -1020.5615841948929, -718.9432792481244, -529.6532538180048, -43.69237651594885, -271.42793268149154, -1010.8439747444511, -885.5919372302234, -940.7324507349033, -414.19619488267904, -85.29903587161115, -603.6004287319835, -652.1180420237763, -1071.3319842287874, -65.03428926109335, -369.91957059801024, -1381.286335789996, -792.1184322682725, -692.7030049899305, -859.2980474720794, -721.5524595861178, -962.989963713372, -449.39988930104056, -258.4643249464937, -959.8139684185928, -627.5772811176147, -954.7343798272548, -51.439478085104724, -213.82700590049222, -629.7593102914027, -117.71534321121399, -288.6074989636896, -316.5587183093036, -515.1654128686865, -632.4766682517711, -1146.1607785972637, -295.2143227554669, -1006.803422791188, -1007.4186266894216, -750.0607585943997, -949.759696581252, -987.1919445463773, -890.9275807495044, -1143.6250345637538, -437.09590891534697, -1134.1730892326862, -1148.46488508045, -127.44222447922017, -694.5355438485069, -688.500970648526, -148.21579188317233, -923.6423456213773, -1477.7169361087049, -971.5920493146549, -1154.887004028064, -1248.2412854392114, -1236.8482908472479, -386.5480934854453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559003765907586, "mean_inference_ms": 1.7029102002245582, "mean_action_processing_ms": 0.2815228633654476, "mean_env_wait_ms": 3.0423625323036663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012500286102294922, "StateBufferConnector_ms": 0.008234739303588867, "ViewRequirementAgentConnector_ms": 0.20112204551696777}, "num_episodes": 33, "episode_return_max": -38.22625287128497, "episode_return_min": -1477.7169361087049, "episode_return_mean": -687.6606619191837, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.3286085329642, "num_env_steps_trained_throughput_per_sec": 297.3286085329642, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13325.541, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13325.461, "sample_time_ms": 1050.855, "learn_time_ms": 12203.737, "learn_throughput": 327.768, "synch_weights_time_ms": 69.962}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00016", "date": "2024-08-03_11-48-59", "timestamp": 1722665939, "time_this_iter_s": 13.465835809707642, "time_total_s": 252.06139039993286, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433db40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 252.06139039993286, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 14.194736842105263, "ram_util_percent": 27.831578947368417}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.85943267469605, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.11446735362212, "policy_loss": -0.011022972351444576, "vf_loss": 8.121284863352775, "vf_explained_var": 0.7098800547420978, "kl": 0.01936551888587325, "entropy": 1.604168587550521, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -25.375664597298623, "episode_reward_min": -1477.7169361087049, "episode_reward_mean": -703.2900026557945, "episode_len_mean": 132.22, "episode_media": {}, "episodes_timesteps_total": 13222, "policy_reward_min": {"policy_0": -1477.7169361087049}, "policy_reward_max": {"policy_0": -25.375664597298623}, "policy_reward_mean": {"policy_0": -703.2900026557945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-984.2219111089003, -697.6138499823139, -1367.6936006911174, -885.4357742205149, -952.7790090957907, -1004.273630407243, -479.765629149247, -384.890001645994, -996.7194947066687, -328.0773690346278, -1275.5286363249807, -84.30425912460503, -1020.5615841948929, -718.9432792481244, -529.6532538180048, -43.69237651594885, -271.42793268149154, -1010.8439747444511, -885.5919372302234, -940.7324507349033, -414.19619488267904, -85.29903587161115, -603.6004287319835, -652.1180420237763, -1071.3319842287874, -65.03428926109335, -369.91957059801024, -1381.286335789996, -792.1184322682725, -692.7030049899305, -859.2980474720794, -721.5524595861178, -962.989963713372, -449.39988930104056, -258.4643249464937, -959.8139684185928, -627.5772811176147, -954.7343798272548, -51.439478085104724, -213.82700590049222, -629.7593102914027, -117.71534321121399, -288.6074989636896, -316.5587183093036, -515.1654128686865, -632.4766682517711, -1146.1607785972637, -295.2143227554669, -1006.803422791188, -1007.4186266894216, -750.0607585943997, -949.759696581252, -987.1919445463773, -890.9275807495044, -1143.6250345637538, -437.09590891534697, -1134.1730892326862, -1148.46488508045, -127.44222447922017, -694.5355438485069, -688.500970648526, -148.21579188317233, -923.6423456213773, -1477.7169361087049, -971.5920493146549, -1154.887004028064, -1248.2412854392114, -1236.8482908472479, -386.5480934854453, -108.47058678508479, -682.7645566448552, -25.375664597298623, -1318.5731924778563, -856.3917634248064, -1189.2360377421858, -576.9317471414603, -1146.9905591325755, -804.2405764262799, -142.70129269230603, -180.31191310872165, -365.76479698626036, -857.5170384494992, -584.5990746410511, -755.9265251790553, -896.3162059673198, -1135.6265786464612, -187.58045850100675, -1089.0608484300087, -28.43451050456699, -1412.821102188169, -678.1874388687197, -126.26664281859026, -679.2146388434287, -830.3692894947054, -700.7945105792865, -1368.404887610357, -534.9483461657965, -367.62303859555766, -1121.8299939257647, -70.92284063876599], "episode_lengths": [150, 150, 150, 150, 150, 150, 128, 150, 150, 116, 150, 66, 150, 150, 150, 46, 81, 150, 150, 150, 150, 73, 150, 150, 150, 62, 97, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 76, 80, 150, 86, 84, 150, 142, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 76, 150, 41, 150, 150, 150, 150, 150, 150, 87, 82, 150, 150, 150, 150, 150, 150, 69, 150, 50, 150, 150, 87, 150, 150, 150, 150, 130, 124, 150, 66], "policy_policy_0_reward": [-984.2219111089003, -697.6138499823139, -1367.6936006911174, -885.4357742205149, -952.7790090957907, -1004.273630407243, -479.765629149247, -384.890001645994, -996.7194947066687, -328.0773690346278, -1275.5286363249807, -84.30425912460503, -1020.5615841948929, -718.9432792481244, -529.6532538180048, -43.69237651594885, -271.42793268149154, -1010.8439747444511, -885.5919372302234, -940.7324507349033, -414.19619488267904, -85.29903587161115, -603.6004287319835, -652.1180420237763, -1071.3319842287874, -65.03428926109335, -369.91957059801024, -1381.286335789996, -792.1184322682725, -692.7030049899305, -859.2980474720794, -721.5524595861178, -962.989963713372, -449.39988930104056, -258.4643249464937, -959.8139684185928, -627.5772811176147, -954.7343798272548, -51.439478085104724, -213.82700590049222, -629.7593102914027, -117.71534321121399, -288.6074989636896, -316.5587183093036, -515.1654128686865, -632.4766682517711, -1146.1607785972637, -295.2143227554669, -1006.803422791188, -1007.4186266894216, -750.0607585943997, -949.759696581252, -987.1919445463773, -890.9275807495044, -1143.6250345637538, -437.09590891534697, -1134.1730892326862, -1148.46488508045, -127.44222447922017, -694.5355438485069, -688.500970648526, -148.21579188317233, -923.6423456213773, -1477.7169361087049, -971.5920493146549, -1154.887004028064, -1248.2412854392114, -1236.8482908472479, -386.5480934854453, -108.47058678508479, -682.7645566448552, -25.375664597298623, -1318.5731924778563, -856.3917634248064, -1189.2360377421858, -576.9317471414603, -1146.9905591325755, -804.2405764262799, -142.70129269230603, -180.31191310872165, -365.76479698626036, -857.5170384494992, -584.5990746410511, -755.9265251790553, -896.3162059673198, -1135.6265786464612, -187.58045850100675, -1089.0608484300087, -28.43451050456699, -1412.821102188169, -678.1874388687197, -126.26664281859026, -679.2146388434287, -830.3692894947054, -700.7945105792865, -1368.404887610357, -534.9483461657965, -367.62303859555766, -1121.8299939257647, -70.92284063876599]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5557544791527448, "mean_inference_ms": 1.70298595544812, "mean_action_processing_ms": 0.28140527468113297, "mean_env_wait_ms": 3.046543865245095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01235651969909668, "StateBufferConnector_ms": 0.008025169372558594, "ViewRequirementAgentConnector_ms": 0.19623970985412598}, "num_episodes": 31, "episode_return_max": -25.375664597298623, "episode_return_min": -1477.7169361087049, "episode_return_mean": -703.2900026557945, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.3792654287303, "num_env_steps_trained_throughput_per_sec": 291.3792654287303, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13321.67, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13321.591, "sample_time_ms": 1053.396, "learn_time_ms": 12198.327, "learn_throughput": 327.914, "synch_weights_time_ms": 68.958}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00016", "date": "2024-08-03_11-49-13", "timestamp": 1722665953, "time_this_iter_s": 13.741616249084473, "time_total_s": 265.80300664901733, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244493910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 265.80300664901733, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.88421052631579, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.723445408294598, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.301121581594149, "policy_loss": -0.011950324919113579, "vf_loss": 8.308505828181902, "vf_explained_var": 0.7705902993058165, "kl": 0.019991192742433366, "entropy": 1.4312581016371648, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -2.0238398942993716, "episode_reward_min": -1477.7169361087049, "episode_reward_mean": -695.6618781162302, "episode_len_mean": 129.95, "episode_media": {}, "episodes_timesteps_total": 12995, "policy_reward_min": {"policy_0": -1477.7169361087049}, "policy_reward_max": {"policy_0": -2.0238398942993716}, "policy_reward_mean": {"policy_0": -695.6618781162302}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-721.5524595861178, -962.989963713372, -449.39988930104056, -258.4643249464937, -959.8139684185928, -627.5772811176147, -954.7343798272548, -51.439478085104724, -213.82700590049222, -629.7593102914027, -117.71534321121399, -288.6074989636896, -316.5587183093036, -515.1654128686865, -632.4766682517711, -1146.1607785972637, -295.2143227554669, -1006.803422791188, -1007.4186266894216, -750.0607585943997, -949.759696581252, -987.1919445463773, -890.9275807495044, -1143.6250345637538, -437.09590891534697, -1134.1730892326862, -1148.46488508045, -127.44222447922017, -694.5355438485069, -688.500970648526, -148.21579188317233, -923.6423456213773, -1477.7169361087049, -971.5920493146549, -1154.887004028064, -1248.2412854392114, -1236.8482908472479, -386.5480934854453, -108.47058678508479, -682.7645566448552, -25.375664597298623, -1318.5731924778563, -856.3917634248064, -1189.2360377421858, -576.9317471414603, -1146.9905591325755, -804.2405764262799, -142.70129269230603, -180.31191310872165, -365.76479698626036, -857.5170384494992, -584.5990746410511, -755.9265251790553, -896.3162059673198, -1135.6265786464612, -187.58045850100675, -1089.0608484300087, -28.43451050456699, -1412.821102188169, -678.1874388687197, -126.26664281859026, -679.2146388434287, -830.3692894947054, -700.7945105792865, -1368.404887610357, -534.9483461657965, -367.62303859555766, -1121.8299939257647, -70.92284063876599, -1170.437625494406, -271.3438561012172, -140.1302219284904, -817.0343348843877, -136.7944126758317, -1057.1210246206815, -134.31629398877007, -1029.4930091662527, -983.7781886115882, -742.0176681591817, -360.3184315319653, -143.86578473276518, -874.0920564173283, -344.01891131493164, -2.0238398942993716, -1132.4894052463537, -315.00137124560746, -1226.9649910375276, -184.80412091484277, -728.8673670510268, -956.9443708582916, -987.2738625266794, -1121.6648274762438, -43.606582618543584, -1097.6074227597387, -581.3634248391074, -864.620896733361, -817.3724260241, -910.8537972126333, -688.0561033910116, -1222.5662373646558], "episode_lengths": [150, 150, 150, 93, 150, 150, 150, 76, 80, 150, 86, 84, 150, 142, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 76, 150, 41, 150, 150, 150, 150, 150, 150, 87, 82, 150, 150, 150, 150, 150, 150, 69, 150, 50, 150, 150, 87, 150, 150, 150, 150, 130, 124, 150, 66, 150, 96, 63, 145, 89, 150, 54, 150, 150, 150, 108, 77, 150, 114, 35, 150, 122, 150, 91, 150, 150, 150, 150, 48, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-721.5524595861178, -962.989963713372, -449.39988930104056, -258.4643249464937, -959.8139684185928, -627.5772811176147, -954.7343798272548, -51.439478085104724, -213.82700590049222, -629.7593102914027, -117.71534321121399, -288.6074989636896, -316.5587183093036, -515.1654128686865, -632.4766682517711, -1146.1607785972637, -295.2143227554669, -1006.803422791188, -1007.4186266894216, -750.0607585943997, -949.759696581252, -987.1919445463773, -890.9275807495044, -1143.6250345637538, -437.09590891534697, -1134.1730892326862, -1148.46488508045, -127.44222447922017, -694.5355438485069, -688.500970648526, -148.21579188317233, -923.6423456213773, -1477.7169361087049, -971.5920493146549, -1154.887004028064, -1248.2412854392114, -1236.8482908472479, -386.5480934854453, -108.47058678508479, -682.7645566448552, -25.375664597298623, -1318.5731924778563, -856.3917634248064, -1189.2360377421858, -576.9317471414603, -1146.9905591325755, -804.2405764262799, -142.70129269230603, -180.31191310872165, -365.76479698626036, -857.5170384494992, -584.5990746410511, -755.9265251790553, -896.3162059673198, -1135.6265786464612, -187.58045850100675, -1089.0608484300087, -28.43451050456699, -1412.821102188169, -678.1874388687197, -126.26664281859026, -679.2146388434287, -830.3692894947054, -700.7945105792865, -1368.404887610357, -534.9483461657965, -367.62303859555766, -1121.8299939257647, -70.92284063876599, -1170.437625494406, -271.3438561012172, -140.1302219284904, -817.0343348843877, -136.7944126758317, -1057.1210246206815, -134.31629398877007, -1029.4930091662527, -983.7781886115882, -742.0176681591817, -360.3184315319653, -143.86578473276518, -874.0920564173283, -344.01891131493164, -2.0238398942993716, -1132.4894052463537, -315.00137124560746, -1226.9649910375276, -184.80412091484277, -728.8673670510268, -956.9443708582916, -987.2738625266794, -1121.6648274762438, -43.606582618543584, -1097.6074227597387, -581.3634248391074, -864.620896733361, -817.3724260241, -910.8537972126333, -688.0561033910116, -1222.5662373646558]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558124607330919, "mean_inference_ms": 1.7028037232560655, "mean_action_processing_ms": 0.2813327211588152, "mean_env_wait_ms": 3.050148600125395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011938333511352539, "StateBufferConnector_ms": 0.007900238037109375, "ViewRequirementAgentConnector_ms": 0.19103479385375977}, "num_episodes": 31, "episode_return_max": -2.0238398942993716, "episode_return_min": -1477.7169361087049, "episode_return_mean": -695.6618781162302, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.9424475083625, "num_env_steps_trained_throughput_per_sec": 302.9424475083625, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13297.974, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13297.896, "sample_time_ms": 1053.964, "learn_time_ms": 12175.256, "learn_throughput": 328.535, "synch_weights_time_ms": 67.759}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00016", "date": "2024-08-03_11-49-26", "timestamp": 1722665966, "time_this_iter_s": 13.216376066207886, "time_total_s": 279.0193827152252, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433dd80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 279.0193827152252, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.878947368421056, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.362521565208834, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.398560986916225, "policy_loss": -0.005853952315131513, "vf_loss": 8.40090433359146, "vf_explained_var": 0.7959617186958591, "kl": 0.016773002786036766, "entropy": 1.521274240811666, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -2.0238398942993716, "episode_reward_min": -1491.8530899005086, "episode_reward_mean": -678.32544358412, "episode_len_mean": 125.82, "episode_media": {}, "episodes_timesteps_total": 12582, "policy_reward_min": {"policy_0": -1491.8530899005086}, "policy_reward_max": {"policy_0": -2.0238398942993716}, "policy_reward_mean": {"policy_0": -678.32544358412}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-971.5920493146549, -1154.887004028064, -1248.2412854392114, -1236.8482908472479, -386.5480934854453, -108.47058678508479, -682.7645566448552, -25.375664597298623, -1318.5731924778563, -856.3917634248064, -1189.2360377421858, -576.9317471414603, -1146.9905591325755, -804.2405764262799, -142.70129269230603, -180.31191310872165, -365.76479698626036, -857.5170384494992, -584.5990746410511, -755.9265251790553, -896.3162059673198, -1135.6265786464612, -187.58045850100675, -1089.0608484300087, -28.43451050456699, -1412.821102188169, -678.1874388687197, -126.26664281859026, -679.2146388434287, -830.3692894947054, -700.7945105792865, -1368.404887610357, -534.9483461657965, -367.62303859555766, -1121.8299939257647, -70.92284063876599, -1170.437625494406, -271.3438561012172, -140.1302219284904, -817.0343348843877, -136.7944126758317, -1057.1210246206815, -134.31629398877007, -1029.4930091662527, -983.7781886115882, -742.0176681591817, -360.3184315319653, -143.86578473276518, -874.0920564173283, -344.01891131493164, -2.0238398942993716, -1132.4894052463537, -315.00137124560746, -1226.9649910375276, -184.80412091484277, -728.8673670510268, -956.9443708582916, -987.2738625266794, -1121.6648274762438, -43.606582618543584, -1097.6074227597387, -581.3634248391074, -864.620896733361, -817.3724260241, -910.8537972126333, -688.0561033910116, -1222.5662373646558, -1207.150285954177, -242.8080968286238, -103.15742818781827, -720.8930603771704, -203.29790504221558, -30.205199876445548, -1118.3781882627309, -1192.6182663866173, -719.0605938610777, -16.67293654065104, -410.91243651471586, -179.76650272948189, -1028.4351117125302, -936.5944664675059, -339.016708942303, -404.1263679444077, -1491.8530899005086, -337.3771597993822, -164.61350548856788, -833.0744496321814, -778.4885113452473, -1294.226695643081, -738.59824609952, -36.651900323258985, -544.7403047463445, -17.39663391286872, -906.2273293839779, -22.768108570577258, -1001.2952032332707, -1252.022909946273, -1035.1193272008882, -711.5405776515196, -904.3006027618106], "episode_lengths": [150, 150, 150, 150, 150, 76, 150, 41, 150, 150, 150, 150, 150, 150, 87, 82, 150, 150, 150, 150, 150, 150, 69, 150, 50, 150, 150, 87, 150, 150, 150, 150, 130, 124, 150, 66, 150, 96, 63, 145, 89, 150, 54, 150, 150, 150, 108, 77, 150, 114, 35, 150, 122, 150, 91, 150, 150, 150, 150, 48, 150, 150, 150, 150, 150, 150, 150, 150, 93, 67, 150, 101, 44, 150, 150, 150, 44, 120, 109, 150, 150, 88, 150, 150, 88, 98, 150, 150, 150, 150, 51, 144, 38, 150, 43, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-971.5920493146549, -1154.887004028064, -1248.2412854392114, -1236.8482908472479, -386.5480934854453, -108.47058678508479, -682.7645566448552, -25.375664597298623, -1318.5731924778563, -856.3917634248064, -1189.2360377421858, -576.9317471414603, -1146.9905591325755, -804.2405764262799, -142.70129269230603, -180.31191310872165, -365.76479698626036, -857.5170384494992, -584.5990746410511, -755.9265251790553, -896.3162059673198, -1135.6265786464612, -187.58045850100675, -1089.0608484300087, -28.43451050456699, -1412.821102188169, -678.1874388687197, -126.26664281859026, -679.2146388434287, -830.3692894947054, -700.7945105792865, -1368.404887610357, -534.9483461657965, -367.62303859555766, -1121.8299939257647, -70.92284063876599, -1170.437625494406, -271.3438561012172, -140.1302219284904, -817.0343348843877, -136.7944126758317, -1057.1210246206815, -134.31629398877007, -1029.4930091662527, -983.7781886115882, -742.0176681591817, -360.3184315319653, -143.86578473276518, -874.0920564173283, -344.01891131493164, -2.0238398942993716, -1132.4894052463537, -315.00137124560746, -1226.9649910375276, -184.80412091484277, -728.8673670510268, -956.9443708582916, -987.2738625266794, -1121.6648274762438, -43.606582618543584, -1097.6074227597387, -581.3634248391074, -864.620896733361, -817.3724260241, -910.8537972126333, -688.0561033910116, -1222.5662373646558, -1207.150285954177, -242.8080968286238, -103.15742818781827, -720.8930603771704, -203.29790504221558, -30.205199876445548, -1118.3781882627309, -1192.6182663866173, -719.0605938610777, -16.67293654065104, -410.91243651471586, -179.76650272948189, -1028.4351117125302, -936.5944664675059, -339.016708942303, -404.1263679444077, -1491.8530899005086, -337.3771597993822, -164.61350548856788, -833.0744496321814, -778.4885113452473, -1294.226695643081, -738.59824609952, -36.651900323258985, -544.7403047463445, -17.39663391286872, -906.2273293839779, -22.768108570577258, -1001.2952032332707, -1252.022909946273, -1035.1193272008882, -711.5405776515196, -904.3006027618106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555163663097283, "mean_inference_ms": 1.7014792053805934, "mean_action_processing_ms": 0.2809203525799245, "mean_env_wait_ms": 3.0536711743293887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011559247970581055, "StateBufferConnector_ms": 0.007719516754150391, "ViewRequirementAgentConnector_ms": 0.18987512588500977}, "num_episodes": 33, "episode_return_max": -2.0238398942993716, "episode_return_min": -1491.8530899005086, "episode_return_mean": -678.32544358412, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.4272149397216, "num_env_steps_trained_throughput_per_sec": 309.4272149397216, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13378.695, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13378.616, "sample_time_ms": 1062.331, "learn_time_ms": 12248.04, "learn_throughput": 326.583, "synch_weights_time_ms": 67.369}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00016", "date": "2024-08-03_11-49-39", "timestamp": 1722665979, "time_this_iter_s": 12.93985915184021, "time_total_s": 291.95924186706543, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b5e10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 291.95924186706543, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 14.226315789473682, "ram_util_percent": 27.889473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.69445229123036, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.5259467482566835, "policy_loss": -0.010755814196697126, "vf_loss": 7.533133711914221, "vf_explained_var": 0.8098670906076829, "kl": 0.0167225601129758, "entropy": 1.447919681792458, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -2.0238398942993716, "episode_reward_min": -1491.8530899005086, "episode_reward_mean": -685.3517913638269, "episode_len_mean": 127.53, "episode_media": {}, "episodes_timesteps_total": 12753, "policy_reward_min": {"policy_0": -1491.8530899005086}, "policy_reward_max": {"policy_0": -2.0238398942993716}, "policy_reward_mean": {"policy_0": -685.3517913638269}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-830.3692894947054, -700.7945105792865, -1368.404887610357, -534.9483461657965, -367.62303859555766, -1121.8299939257647, -70.92284063876599, -1170.437625494406, -271.3438561012172, -140.1302219284904, -817.0343348843877, -136.7944126758317, -1057.1210246206815, -134.31629398877007, -1029.4930091662527, -983.7781886115882, -742.0176681591817, -360.3184315319653, -143.86578473276518, -874.0920564173283, -344.01891131493164, -2.0238398942993716, -1132.4894052463537, -315.00137124560746, -1226.9649910375276, -184.80412091484277, -728.8673670510268, -956.9443708582916, -987.2738625266794, -1121.6648274762438, -43.606582618543584, -1097.6074227597387, -581.3634248391074, -864.620896733361, -817.3724260241, -910.8537972126333, -688.0561033910116, -1222.5662373646558, -1207.150285954177, -242.8080968286238, -103.15742818781827, -720.8930603771704, -203.29790504221558, -30.205199876445548, -1118.3781882627309, -1192.6182663866173, -719.0605938610777, -16.67293654065104, -410.91243651471586, -179.76650272948189, -1028.4351117125302, -936.5944664675059, -339.016708942303, -404.1263679444077, -1491.8530899005086, -337.3771597993822, -164.61350548856788, -833.0744496321814, -778.4885113452473, -1294.226695643081, -738.59824609952, -36.651900323258985, -544.7403047463445, -17.39663391286872, -906.2273293839779, -22.768108570577258, -1001.2952032332707, -1252.022909946273, -1035.1193272008882, -711.5405776515196, -904.3006027618106, -1110.7411060073769, -634.2611841751925, -1110.5120086257896, -145.0953479654308, -495.82718809196, -1153.2894759861142, -574.7399851658586, -932.2525087633493, -990.2465066420465, -18.154889859947566, -551.4629987600254, -723.7401808909975, -1171.1916905780754, -817.3329241836694, -1131.9118437848617, -677.5382354487367, -949.7767288532257, -801.7389874489126, -186.28848489198097, -1021.9732454447916, -115.37043450662225, -977.2458781648697, -1147.5855701317337, -196.94520267382183, -1136.2715953046193, -598.1104317955251, -930.5824770527839, -492.92142312045587, -736.9467169641151], "episode_lengths": [150, 150, 150, 130, 124, 150, 66, 150, 96, 63, 145, 89, 150, 54, 150, 150, 150, 108, 77, 150, 114, 35, 150, 122, 150, 91, 150, 150, 150, 150, 48, 150, 150, 150, 150, 150, 150, 150, 150, 93, 67, 150, 101, 44, 150, 150, 150, 44, 120, 109, 150, 150, 88, 150, 150, 88, 98, 150, 150, 150, 150, 51, 144, 38, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 54, 150, 150, 91, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-830.3692894947054, -700.7945105792865, -1368.404887610357, -534.9483461657965, -367.62303859555766, -1121.8299939257647, -70.92284063876599, -1170.437625494406, -271.3438561012172, -140.1302219284904, -817.0343348843877, -136.7944126758317, -1057.1210246206815, -134.31629398877007, -1029.4930091662527, -983.7781886115882, -742.0176681591817, -360.3184315319653, -143.86578473276518, -874.0920564173283, -344.01891131493164, -2.0238398942993716, -1132.4894052463537, -315.00137124560746, -1226.9649910375276, -184.80412091484277, -728.8673670510268, -956.9443708582916, -987.2738625266794, -1121.6648274762438, -43.606582618543584, -1097.6074227597387, -581.3634248391074, -864.620896733361, -817.3724260241, -910.8537972126333, -688.0561033910116, -1222.5662373646558, -1207.150285954177, -242.8080968286238, -103.15742818781827, -720.8930603771704, -203.29790504221558, -30.205199876445548, -1118.3781882627309, -1192.6182663866173, -719.0605938610777, -16.67293654065104, -410.91243651471586, -179.76650272948189, -1028.4351117125302, -936.5944664675059, -339.016708942303, -404.1263679444077, -1491.8530899005086, -337.3771597993822, -164.61350548856788, -833.0744496321814, -778.4885113452473, -1294.226695643081, -738.59824609952, -36.651900323258985, -544.7403047463445, -17.39663391286872, -906.2273293839779, -22.768108570577258, -1001.2952032332707, -1252.022909946273, -1035.1193272008882, -711.5405776515196, -904.3006027618106, -1110.7411060073769, -634.2611841751925, -1110.5120086257896, -145.0953479654308, -495.82718809196, -1153.2894759861142, -574.7399851658586, -932.2525087633493, -990.2465066420465, -18.154889859947566, -551.4629987600254, -723.7401808909975, -1171.1916905780754, -817.3329241836694, -1131.9118437848617, -677.5382354487367, -949.7767288532257, -801.7389874489126, -186.28848489198097, -1021.9732454447916, -115.37043450662225, -977.2458781648697, -1147.5855701317337, -196.94520267382183, -1136.2715953046193, -598.1104317955251, -930.5824770527839, -492.92142312045587, -736.9467169641151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555944010066796, "mean_inference_ms": 1.7006058925401266, "mean_action_processing_ms": 0.2806005620764971, "mean_env_wait_ms": 3.056644161626839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011892080307006836, "StateBufferConnector_ms": 0.007766008377075195, "ViewRequirementAgentConnector_ms": 0.1917736530303955}, "num_episodes": 29, "episode_return_max": -2.0238398942993716, "episode_return_min": -1491.8530899005086, "episode_return_mean": -685.3517913638269, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.65431838034766, "num_env_steps_trained_throughput_per_sec": 300.65431838034766, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13342.765, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13342.689, "sample_time_ms": 1057.032, "learn_time_ms": 12217.956, "learn_throughput": 327.387, "synch_weights_time_ms": 66.825}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00016", "date": "2024-08-03_11-49-52", "timestamp": 1722665992, "time_this_iter_s": 13.317974328994751, "time_total_s": 305.2772161960602, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244493910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 305.2772161960602, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.705263157894736, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 38.49740723868211, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.014470816155274, "policy_loss": -0.007039503036745979, "vf_loss": 8.017995010316373, "vf_explained_var": 0.7701186239719391, "kl": 0.017180476826130598, "entropy": 1.6388245210051537, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -16.67293654065104, "episode_reward_min": -1491.8530899005086, "episode_reward_mean": -679.0796098192858, "episode_len_mean": 127.82, "episode_media": {}, "episodes_timesteps_total": 12782, "policy_reward_min": {"policy_0": -1491.8530899005086}, "policy_reward_max": {"policy_0": -16.67293654065104}, "policy_reward_mean": {"policy_0": -679.0796098192858}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.606582618543584, -1097.6074227597387, -581.3634248391074, -864.620896733361, -817.3724260241, -910.8537972126333, -688.0561033910116, -1222.5662373646558, -1207.150285954177, -242.8080968286238, -103.15742818781827, -720.8930603771704, -203.29790504221558, -30.205199876445548, -1118.3781882627309, -1192.6182663866173, -719.0605938610777, -16.67293654065104, -410.91243651471586, -179.76650272948189, -1028.4351117125302, -936.5944664675059, -339.016708942303, -404.1263679444077, -1491.8530899005086, -337.3771597993822, -164.61350548856788, -833.0744496321814, -778.4885113452473, -1294.226695643081, -738.59824609952, -36.651900323258985, -544.7403047463445, -17.39663391286872, -906.2273293839779, -22.768108570577258, -1001.2952032332707, -1252.022909946273, -1035.1193272008882, -711.5405776515196, -904.3006027618106, -1110.7411060073769, -634.2611841751925, -1110.5120086257896, -145.0953479654308, -495.82718809196, -1153.2894759861142, -574.7399851658586, -932.2525087633493, -990.2465066420465, -18.154889859947566, -551.4629987600254, -723.7401808909975, -1171.1916905780754, -817.3329241836694, -1131.9118437848617, -677.5382354487367, -949.7767288532257, -801.7389874489126, -186.28848489198097, -1021.9732454447916, -115.37043450662225, -977.2458781648697, -1147.5855701317337, -196.94520267382183, -1136.2715953046193, -598.1104317955251, -930.5824770527839, -492.92142312045587, -736.9467169641151, -906.4151625598736, -781.6206924738434, -560.5696733948565, -925.7910312982683, -50.664275040095454, -579.7296126152917, -221.55838230139778, -398.7050835709349, -1432.7537938008138, -823.0800233071745, -425.2276430738715, -1187.2236629268089, -33.71151189291367, -955.0640064875818, -318.842282836783, -133.64931505065334, -228.86999759446059, -256.542450888835, -356.82004783860003, -979.2189501583182, -879.4597780411723, -1402.9094490288392, -432.5009558480511, -1101.8582665448891, -756.5440533305787, -70.72209596117219, -729.446263125263, -857.3357903498433, -462.15187778954987, -979.4845993040499], "episode_lengths": [48, 150, 150, 150, 150, 150, 150, 150, 150, 93, 67, 150, 101, 44, 150, 150, 150, 44, 120, 109, 150, 150, 88, 150, 150, 88, 98, 150, 150, 150, 150, 51, 144, 38, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 54, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 150, 73, 150, 150, 150, 120, 150, 49, 150, 104, 55, 101, 79, 105, 150, 150, 150, 120, 150, 150, 43, 150, 150, 150, 150], "policy_policy_0_reward": [-43.606582618543584, -1097.6074227597387, -581.3634248391074, -864.620896733361, -817.3724260241, -910.8537972126333, -688.0561033910116, -1222.5662373646558, -1207.150285954177, -242.8080968286238, -103.15742818781827, -720.8930603771704, -203.29790504221558, -30.205199876445548, -1118.3781882627309, -1192.6182663866173, -719.0605938610777, -16.67293654065104, -410.91243651471586, -179.76650272948189, -1028.4351117125302, -936.5944664675059, -339.016708942303, -404.1263679444077, -1491.8530899005086, -337.3771597993822, -164.61350548856788, -833.0744496321814, -778.4885113452473, -1294.226695643081, -738.59824609952, -36.651900323258985, -544.7403047463445, -17.39663391286872, -906.2273293839779, -22.768108570577258, -1001.2952032332707, -1252.022909946273, -1035.1193272008882, -711.5405776515196, -904.3006027618106, -1110.7411060073769, -634.2611841751925, -1110.5120086257896, -145.0953479654308, -495.82718809196, -1153.2894759861142, -574.7399851658586, -932.2525087633493, -990.2465066420465, -18.154889859947566, -551.4629987600254, -723.7401808909975, -1171.1916905780754, -817.3329241836694, -1131.9118437848617, -677.5382354487367, -949.7767288532257, -801.7389874489126, -186.28848489198097, -1021.9732454447916, -115.37043450662225, -977.2458781648697, -1147.5855701317337, -196.94520267382183, -1136.2715953046193, -598.1104317955251, -930.5824770527839, -492.92142312045587, -736.9467169641151, -906.4151625598736, -781.6206924738434, -560.5696733948565, -925.7910312982683, -50.664275040095454, -579.7296126152917, -221.55838230139778, -398.7050835709349, -1432.7537938008138, -823.0800233071745, -425.2276430738715, -1187.2236629268089, -33.71151189291367, -955.0640064875818, -318.842282836783, -133.64931505065334, -228.86999759446059, -256.542450888835, -356.82004783860003, -979.2189501583182, -879.4597780411723, -1402.9094490288392, -432.5009558480511, -1101.8582665448891, -756.5440533305787, -70.72209596117219, -729.446263125263, -857.3357903498433, -462.15187778954987, -979.4845993040499]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.555927806810858, "mean_inference_ms": 1.7013945398068062, "mean_action_processing_ms": 0.2803854475297194, "mean_env_wait_ms": 3.0601560268871655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012242555618286133, "StateBufferConnector_ms": 0.007952213287353516, "ViewRequirementAgentConnector_ms": 0.199998140335083}, "num_episodes": 30, "episode_return_max": -16.67293654065104, "episode_return_min": -1491.8530899005086, "episode_return_mean": -679.0796098192858, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.6836402219739, "num_env_steps_trained_throughput_per_sec": 307.6836402219739, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13313.256, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13313.178, "sample_time_ms": 1057.156, "learn_time_ms": 12189.407, "learn_throughput": 328.154, "synch_weights_time_ms": 65.74}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00016", "date": "2024-08-03_11-50-06", "timestamp": 1722666006, "time_this_iter_s": 13.012174367904663, "time_total_s": 318.28939056396484, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2443b8d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 318.28939056396484, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 14.577777777777776, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.07863248040279, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.4702436978618305, "policy_loss": -0.009833631768318203, "vf_loss": 7.474916730821133, "vf_explained_var": 0.8671760953341922, "kl": 0.02258538456862882, "entropy": 1.615023890386025, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -17.39663391286872, "episode_reward_min": -1432.7537938008138, "episode_reward_mean": -697.1533507494236, "episode_len_mean": 128.47, "episode_media": {}, "episodes_timesteps_total": 12847, "policy_reward_min": {"policy_0": -1432.7537938008138}, "policy_reward_max": {"policy_0": -17.39663391286872}, "policy_reward_mean": {"policy_0": -697.1533507494236}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-738.59824609952, -36.651900323258985, -544.7403047463445, -17.39663391286872, -906.2273293839779, -22.768108570577258, -1001.2952032332707, -1252.022909946273, -1035.1193272008882, -711.5405776515196, -904.3006027618106, -1110.7411060073769, -634.2611841751925, -1110.5120086257896, -145.0953479654308, -495.82718809196, -1153.2894759861142, -574.7399851658586, -932.2525087633493, -990.2465066420465, -18.154889859947566, -551.4629987600254, -723.7401808909975, -1171.1916905780754, -817.3329241836694, -1131.9118437848617, -677.5382354487367, -949.7767288532257, -801.7389874489126, -186.28848489198097, -1021.9732454447916, -115.37043450662225, -977.2458781648697, -1147.5855701317337, -196.94520267382183, -1136.2715953046193, -598.1104317955251, -930.5824770527839, -492.92142312045587, -736.9467169641151, -906.4151625598736, -781.6206924738434, -560.5696733948565, -925.7910312982683, -50.664275040095454, -579.7296126152917, -221.55838230139778, -398.7050835709349, -1432.7537938008138, -823.0800233071745, -425.2276430738715, -1187.2236629268089, -33.71151189291367, -955.0640064875818, -318.842282836783, -133.64931505065334, -228.86999759446059, -256.542450888835, -356.82004783860003, -979.2189501583182, -879.4597780411723, -1402.9094490288392, -432.5009558480511, -1101.8582665448891, -756.5440533305787, -70.72209596117219, -729.446263125263, -857.3357903498433, -462.15187778954987, -979.4845993040499, -1154.4972515158763, -769.5367852255262, -848.9820272703375, -1041.9048708384867, -1170.5007062726932, -74.62443204162308, -28.51109269478444, -306.9954625790768, -1103.4485925121332, -1000.8540465602746, -425.86584076425265, -826.6505956706843, -299.16292603127613, -721.6541456097801, -855.1457589556132, -217.13855664918339, -152.69272824496636, -63.27150357031725, -993.6333420954057, -1042.2756566717749, -445.6739276597792, -1104.7550975437052, -361.9822398025871, -1061.0659078076521, -839.9793524258495, -52.851416113894224, -1318.047954798743, -790.256666915731, -1393.109106258309, -1321.07996029405], "episode_lengths": [150, 51, 144, 38, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 54, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 150, 73, 150, 150, 150, 120, 150, 49, 150, 104, 55, 101, 79, 105, 150, 150, 150, 120, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 50, 107, 150, 150, 143, 150, 104, 150, 150, 65, 85, 63, 150, 150, 150, 150, 90, 150, 150, 60, 150, 150, 150, 150], "policy_policy_0_reward": [-738.59824609952, -36.651900323258985, -544.7403047463445, -17.39663391286872, -906.2273293839779, -22.768108570577258, -1001.2952032332707, -1252.022909946273, -1035.1193272008882, -711.5405776515196, -904.3006027618106, -1110.7411060073769, -634.2611841751925, -1110.5120086257896, -145.0953479654308, -495.82718809196, -1153.2894759861142, -574.7399851658586, -932.2525087633493, -990.2465066420465, -18.154889859947566, -551.4629987600254, -723.7401808909975, -1171.1916905780754, -817.3329241836694, -1131.9118437848617, -677.5382354487367, -949.7767288532257, -801.7389874489126, -186.28848489198097, -1021.9732454447916, -115.37043450662225, -977.2458781648697, -1147.5855701317337, -196.94520267382183, -1136.2715953046193, -598.1104317955251, -930.5824770527839, -492.92142312045587, -736.9467169641151, -906.4151625598736, -781.6206924738434, -560.5696733948565, -925.7910312982683, -50.664275040095454, -579.7296126152917, -221.55838230139778, -398.7050835709349, -1432.7537938008138, -823.0800233071745, -425.2276430738715, -1187.2236629268089, -33.71151189291367, -955.0640064875818, -318.842282836783, -133.64931505065334, -228.86999759446059, -256.542450888835, -356.82004783860003, -979.2189501583182, -879.4597780411723, -1402.9094490288392, -432.5009558480511, -1101.8582665448891, -756.5440533305787, -70.72209596117219, -729.446263125263, -857.3357903498433, -462.15187778954987, -979.4845993040499, -1154.4972515158763, -769.5367852255262, -848.9820272703375, -1041.9048708384867, -1170.5007062726932, -74.62443204162308, -28.51109269478444, -306.9954625790768, -1103.4485925121332, -1000.8540465602746, -425.86584076425265, -826.6505956706843, -299.16292603127613, -721.6541456097801, -855.1457589556132, -217.13855664918339, -152.69272824496636, -63.27150357031725, -993.6333420954057, -1042.2756566717749, -445.6739276597792, -1104.7550975437052, -361.9822398025871, -1061.0659078076521, -839.9793524258495, -52.851416113894224, -1318.047954798743, -790.256666915731, -1393.109106258309, -1321.07996029405]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559335199289872, "mean_inference_ms": 1.700932651350576, "mean_action_processing_ms": 0.28019280108232764, "mean_env_wait_ms": 3.0623761566624683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012216329574584961, "StateBufferConnector_ms": 0.007911205291748047, "ViewRequirementAgentConnector_ms": 0.19911694526672363}, "num_episodes": 30, "episode_return_max": -17.39663391286872, "episode_return_min": -1432.7537938008138, "episode_return_mean": -697.1533507494236, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.4479961355874, "num_env_steps_trained_throughput_per_sec": 299.4479961355874, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13320.624, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13320.546, "sample_time_ms": 1053.378, "learn_time_ms": 12198.176, "learn_throughput": 327.918, "synch_weights_time_ms": 68.11}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00016", "date": "2024-08-03_11-50-19", "timestamp": 1722666019, "time_this_iter_s": 13.369878768920898, "time_total_s": 331.65926933288574, "pid": 532113, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433f250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 331.65926933288574, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 14.04736842105263, "ram_util_percent": 27.899999999999995}}
