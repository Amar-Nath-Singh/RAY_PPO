{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0350315758648019, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.573767431577046, "policy_loss": -0.0056821912449474135, "vf_loss": 9.57811289827029, "vf_explained_var": 0.03247801810503006, "kl": 0.007386919304478093, "entropy": 1.4060102897385756, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -17.534656456890634, "episode_reward_min": -1051.1140285894776, "episode_reward_mean": -650.661205819846, "episode_len_mean": 130.75, "episode_media": {}, "episodes_timesteps_total": 3138, "policy_reward_min": {"policy_0": -1051.1140285894776}, "policy_reward_max": {"policy_0": -17.534656456890634}, "policy_reward_mean": {"policy_0": -650.661205819846}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275.2649510051544, -17.534656456890634, -869.1460100519905, -650.6108346061753, -961.9127286160568, -852.4592832658019, -915.8133981610598, -639.8685938860887, -996.956964466454, -46.29916917800297, -1051.1140285894776, -994.001047706935, -1019.1973238984826, -900.9960312174403, -709.1172023234851, -116.80961939775672, -766.588020697916, -948.7801493963854, -528.5308899585007, -121.0335404334473, -212.10241865323727, -913.0924362532073, -118.33630024199726, -990.3033412143623], "episode_lengths": [150, 51, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 94, 150, 150, 150, 91, 77, 150, 76, 150], "policy_policy_0_reward": [-275.2649510051544, -17.534656456890634, -869.1460100519905, -650.6108346061753, -961.9127286160568, -852.4592832658019, -915.8133981610598, -639.8685938860887, -996.956964466454, -46.29916917800297, -1051.1140285894776, -994.001047706935, -1019.1973238984826, -900.9960312174403, -709.1172023234851, -116.80961939775672, -766.588020697916, -948.7801493963854, -528.5308899585007, -121.0335404334473, -212.10241865323727, -913.0924362532073, -118.33630024199726, -990.3033412143623]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5574084731093115, "mean_inference_ms": 1.6317467152517746, "mean_action_processing_ms": 0.27749459372887403, "mean_env_wait_ms": 2.9324383088390094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010626514752705893, "StateBufferConnector_ms": 0.0076522429784138995, "ViewRequirementAgentConnector_ms": 0.17220079898834229}, "num_episodes": 24, "episode_return_max": -17.534656456890634, "episode_return_min": -1051.1140285894776, "episode_return_mean": -650.661205819846, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.6787125839115, "num_env_steps_trained_throughput_per_sec": 297.6787125839115, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13437.315, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13437.255, "sample_time_ms": 1019.016, "learn_time_ms": 12346.308, "learn_throughput": 323.984, "synch_weights_time_ms": 71.084}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00015", "date": "2024-08-03_11-39-14", "timestamp": 1722665354, "time_this_iter_s": 13.449308395385742, "time_total_s": 13.449308395385742, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244493880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.449308395385742, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.854999999999999, "ram_util_percent": 27.645000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3709046928522488, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.575790650645892, "policy_loss": -0.009774355651946584, "vf_loss": 9.583390481273334, "vf_explained_var": 0.024876562195519605, "kl": 0.011573303259547174, "entropy": 1.4008531857281923, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -17.534656456890634, "episode_reward_min": -1200.5965949040235, "episode_reward_mean": -597.2085195547335, "episode_len_mean": 129.9387755102041, "episode_media": {}, "episodes_timesteps_total": 6367, "policy_reward_min": {"policy_0": -1200.5965949040235}, "policy_reward_max": {"policy_0": -17.534656456890634}, "policy_reward_mean": {"policy_0": -597.2085195547335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275.2649510051544, -17.534656456890634, -869.1460100519905, -650.6108346061753, -961.9127286160568, -852.4592832658019, -915.8133981610598, -639.8685938860887, -996.956964466454, -46.29916917800297, -1051.1140285894776, -994.001047706935, -1019.1973238984826, -900.9960312174403, -709.1172023234851, -116.80961939775672, -766.588020697916, -948.7801493963854, -528.5308899585007, -121.0335404334473, -212.10241865323727, -913.0924362532073, -118.33630024199726, -990.3033412143623, -555.0288732544013, -428.02085765010713, -144.24504005833728, -355.6484585930725, -421.9753861379279, -802.4121507338047, -127.8649996007341, -114.05590910700433, -287.00249667764984, -581.5837769830015, -418.38559081820875, -1200.5965949040235, -258.7156272457774, -270.3020334803862, -774.5340991051306, -771.0525737681969, -669.1246126831309, -881.8463298947672, -1054.4354264698363, -690.8880975960498, -526.5625355195954, -588.477162597729, -767.0404856587256, -747.346143144373, -210.20325682366544], "episode_lengths": [150, 51, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 94, 150, 150, 150, 91, 77, 150, 76, 150, 150, 150, 89, 105, 115, 150, 75, 91, 88, 150, 150, 150, 79, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100], "policy_policy_0_reward": [-275.2649510051544, -17.534656456890634, -869.1460100519905, -650.6108346061753, -961.9127286160568, -852.4592832658019, -915.8133981610598, -639.8685938860887, -996.956964466454, -46.29916917800297, -1051.1140285894776, -994.001047706935, -1019.1973238984826, -900.9960312174403, -709.1172023234851, -116.80961939775672, -766.588020697916, -948.7801493963854, -528.5308899585007, -121.0335404334473, -212.10241865323727, -913.0924362532073, -118.33630024199726, -990.3033412143623, -555.0288732544013, -428.02085765010713, -144.24504005833728, -355.6484585930725, -421.9753861379279, -802.4121507338047, -127.8649996007341, -114.05590910700433, -287.00249667764984, -581.5837769830015, -418.38559081820875, -1200.5965949040235, -258.7156272457774, -270.3020334803862, -774.5340991051306, -771.0525737681969, -669.1246126831309, -881.8463298947672, -1054.4354264698363, -690.8880975960498, -526.5625355195954, -588.477162597729, -767.0404856587256, -747.346143144373, -210.20325682366544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5593076956095974, "mean_inference_ms": 1.6542394564287064, "mean_action_processing_ms": 0.2801452746800899, "mean_env_wait_ms": 2.954941245958652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013494978145677216, "StateBufferConnector_ms": 0.008067792775679608, "ViewRequirementAgentConnector_ms": 0.1807159307051678}, "num_episodes": 25, "episode_return_max": -17.534656456890634, "episode_return_min": -1200.5965949040235, "episode_return_mean": -597.2085195547335, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.16996817511586, "num_env_steps_trained_throughput_per_sec": 295.16996817511586, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13494.421, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13494.356, "sample_time_ms": 1031.475, "learn_time_ms": 12390.793, "learn_throughput": 322.82, "synch_weights_time_ms": 71.243}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00015", "date": "2024-08-03_11-39-28", "timestamp": 1722665368, "time_this_iter_s": 13.562776565551758, "time_total_s": 27.0120849609375, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244492b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27.0120849609375, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.947368421052632, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.895919550396502, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.609919222195943, "policy_loss": -0.0069586866641960414, "vf_loss": 9.614744663238525, "vf_explained_var": 0.11685488726943731, "kl": 0.011350371199008199, "entropy": 1.3682577701906362, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -17.534656456890634, "episode_reward_min": -1280.055801324701, "episode_reward_mean": -628.2344504904819, "episode_len_mean": 133.98666666666668, "episode_media": {}, "episodes_timesteps_total": 10049, "policy_reward_min": {"policy_0": -1280.055801324701}, "policy_reward_max": {"policy_0": -17.534656456890634}, "policy_reward_mean": {"policy_0": -628.2344504904819}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275.2649510051544, -17.534656456890634, -869.1460100519905, -650.6108346061753, -961.9127286160568, -852.4592832658019, -915.8133981610598, -639.8685938860887, -996.956964466454, -46.29916917800297, -1051.1140285894776, -994.001047706935, -1019.1973238984826, -900.9960312174403, -709.1172023234851, -116.80961939775672, -766.588020697916, -948.7801493963854, -528.5308899585007, -121.0335404334473, -212.10241865323727, -913.0924362532073, -118.33630024199726, -990.3033412143623, -555.0288732544013, -428.02085765010713, -144.24504005833728, -355.6484585930725, -421.9753861379279, -802.4121507338047, -127.8649996007341, -114.05590910700433, -287.00249667764984, -581.5837769830015, -418.38559081820875, -1200.5965949040235, -258.7156272457774, -270.3020334803862, -774.5340991051306, -771.0525737681969, -669.1246126831309, -881.8463298947672, -1054.4354264698363, -690.8880975960498, -526.5625355195954, -588.477162597729, -767.0404856587256, -747.346143144373, -210.20325682366544, -951.9098116717387, -566.9577114500732, -566.986980548199, -357.15934280317504, -599.5947711745654, -448.2083141905946, -303.1116649568346, -329.5462990024628, -1280.055801324701, -454.9203546216529, -1113.9238757767857, -965.1225474564659, -638.9812130286299, -324.30983415079015, -881.0375904020499, -864.1022869515464, -1212.233530312558, -1101.133819358819, -252.07842369845568, -166.53454469351155, -681.0341932895043, -569.2391180873512, -826.1980643850565, -799.6193879455054, -1022.127630111285, -578.2392172118858], "episode_lengths": [150, 51, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 94, 150, 150, 150, 91, 77, 150, 76, 150, 150, 150, 89, 105, 115, 150, 75, 91, 88, 150, 150, 150, 79, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 109, 150, 150, 150, 124, 150, 150, 150, 106, 150, 150, 150, 150, 117, 76, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-275.2649510051544, -17.534656456890634, -869.1460100519905, -650.6108346061753, -961.9127286160568, -852.4592832658019, -915.8133981610598, -639.8685938860887, -996.956964466454, -46.29916917800297, -1051.1140285894776, -994.001047706935, -1019.1973238984826, -900.9960312174403, -709.1172023234851, -116.80961939775672, -766.588020697916, -948.7801493963854, -528.5308899585007, -121.0335404334473, -212.10241865323727, -913.0924362532073, -118.33630024199726, -990.3033412143623, -555.0288732544013, -428.02085765010713, -144.24504005833728, -355.6484585930725, -421.9753861379279, -802.4121507338047, -127.8649996007341, -114.05590910700433, -287.00249667764984, -581.5837769830015, -418.38559081820875, -1200.5965949040235, -258.7156272457774, -270.3020334803862, -774.5340991051306, -771.0525737681969, -669.1246126831309, -881.8463298947672, -1054.4354264698363, -690.8880975960498, -526.5625355195954, -588.477162597729, -767.0404856587256, -747.346143144373, -210.20325682366544, -951.9098116717387, -566.9577114500732, -566.986980548199, -357.15934280317504, -599.5947711745654, -448.2083141905946, -303.1116649568346, -329.5462990024628, -1280.055801324701, -454.9203546216529, -1113.9238757767857, -965.1225474564659, -638.9812130286299, -324.30983415079015, -881.0375904020499, -864.1022869515464, -1212.233530312558, -1101.133819358819, -252.07842369845568, -166.53454469351155, -681.0341932895043, -569.2391180873512, -826.1980643850565, -799.6193879455054, -1022.127630111285, -578.2392172118858]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5587539702296569, "mean_inference_ms": 1.659065419381171, "mean_action_processing_ms": 0.2807578333613189, "mean_env_wait_ms": 2.9562188151353426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013127644856770834, "StateBufferConnector_ms": 0.00816949208577474, "ViewRequirementAgentConnector_ms": 0.1846481959025065}, "num_episodes": 26, "episode_return_max": -17.534656456890634, "episode_return_min": -1280.055801324701, "episode_return_mean": -628.2344504904819, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.72983954793165, "num_env_steps_trained_throughput_per_sec": 305.72983954793165, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13357.434, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13357.368, "sample_time_ms": 1018.214, "learn_time_ms": 12270.148, "learn_throughput": 325.994, "synch_weights_time_ms": 68.171}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00015", "date": "2024-08-03_11-39-41", "timestamp": 1722665381, "time_this_iter_s": 13.095913171768188, "time_total_s": 40.10799813270569, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444900d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 40.10799813270569, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.715789473684211, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.801788485919436, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.41297896206379, "policy_loss": -0.009250057510022695, "vf_loss": 9.419158233205478, "vf_explained_var": 0.18459551446139813, "kl": 0.01607110889384937, "entropy": 1.434138406937321, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -43.46516730549232, "episode_reward_min": -1280.055801324701, "episode_reward_mean": -643.9575038632992, "episode_len_mean": 135.92, "episode_media": {}, "episodes_timesteps_total": 13592, "policy_reward_min": {"policy_0": -1280.055801324701}, "policy_reward_max": {"policy_0": -43.46516730549232}, "policy_reward_mean": {"policy_0": -643.9575038632992}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-852.4592832658019, -915.8133981610598, -639.8685938860887, -996.956964466454, -46.29916917800297, -1051.1140285894776, -994.001047706935, -1019.1973238984826, -900.9960312174403, -709.1172023234851, -116.80961939775672, -766.588020697916, -948.7801493963854, -528.5308899585007, -121.0335404334473, -212.10241865323727, -913.0924362532073, -118.33630024199726, -990.3033412143623, -555.0288732544013, -428.02085765010713, -144.24504005833728, -355.6484585930725, -421.9753861379279, -802.4121507338047, -127.8649996007341, -114.05590910700433, -287.00249667764984, -581.5837769830015, -418.38559081820875, -1200.5965949040235, -258.7156272457774, -270.3020334803862, -774.5340991051306, -771.0525737681969, -669.1246126831309, -881.8463298947672, -1054.4354264698363, -690.8880975960498, -526.5625355195954, -588.477162597729, -767.0404856587256, -747.346143144373, -210.20325682366544, -951.9098116717387, -566.9577114500732, -566.986980548199, -357.15934280317504, -599.5947711745654, -448.2083141905946, -303.1116649568346, -329.5462990024628, -1280.055801324701, -454.9203546216529, -1113.9238757767857, -965.1225474564659, -638.9812130286299, -324.30983415079015, -881.0375904020499, -864.1022869515464, -1212.233530312558, -1101.133819358819, -252.07842369845568, -166.53454469351155, -681.0341932895043, -569.2391180873512, -826.1980643850565, -799.6193879455054, -1022.127630111285, -578.2392172118858, -1135.3268519518622, -43.46516730549232, -915.0850055284685, -247.418748112702, -235.3098287363903, -890.2621768366142, -1050.249168856029, -472.0310446448044, -684.2694694000994, -1016.7759031763197, -721.6398184127266, -766.0173364678973, -784.1737244493095, -1096.259114479338, -954.9606539321627, -391.7035809558974, -781.6485360395358, -835.0632147037975, -1235.0686184823194, -558.4619878264435, -257.8013191628552, -44.56456513620698, -350.6593700100411, -138.52989006122968, -319.90948036405405, -1218.336581875307, -836.0696969547599, -635.9365576472284, -767.8323856850078, -667.8059830851444], "episode_lengths": [150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 94, 150, 150, 150, 91, 77, 150, 76, 150, 150, 150, 89, 105, 115, 150, 75, 91, 88, 150, 150, 150, 79, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 109, 150, 150, 150, 124, 150, 150, 150, 106, 150, 150, 150, 150, 117, 76, 150, 150, 150, 150, 150, 150, 150, 45, 150, 126, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 132, 95, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-852.4592832658019, -915.8133981610598, -639.8685938860887, -996.956964466454, -46.29916917800297, -1051.1140285894776, -994.001047706935, -1019.1973238984826, -900.9960312174403, -709.1172023234851, -116.80961939775672, -766.588020697916, -948.7801493963854, -528.5308899585007, -121.0335404334473, -212.10241865323727, -913.0924362532073, -118.33630024199726, -990.3033412143623, -555.0288732544013, -428.02085765010713, -144.24504005833728, -355.6484585930725, -421.9753861379279, -802.4121507338047, -127.8649996007341, -114.05590910700433, -287.00249667764984, -581.5837769830015, -418.38559081820875, -1200.5965949040235, -258.7156272457774, -270.3020334803862, -774.5340991051306, -771.0525737681969, -669.1246126831309, -881.8463298947672, -1054.4354264698363, -690.8880975960498, -526.5625355195954, -588.477162597729, -767.0404856587256, -747.346143144373, -210.20325682366544, -951.9098116717387, -566.9577114500732, -566.986980548199, -357.15934280317504, -599.5947711745654, -448.2083141905946, -303.1116649568346, -329.5462990024628, -1280.055801324701, -454.9203546216529, -1113.9238757767857, -965.1225474564659, -638.9812130286299, -324.30983415079015, -881.0375904020499, -864.1022869515464, -1212.233530312558, -1101.133819358819, -252.07842369845568, -166.53454469351155, -681.0341932895043, -569.2391180873512, -826.1980643850565, -799.6193879455054, -1022.127630111285, -578.2392172118858, -1135.3268519518622, -43.46516730549232, -915.0850055284685, -247.418748112702, -235.3098287363903, -890.2621768366142, -1050.249168856029, -472.0310446448044, -684.2694694000994, -1016.7759031763197, -721.6398184127266, -766.0173364678973, -784.1737244493095, -1096.259114479338, -954.9606539321627, -391.7035809558974, -781.6485360395358, -835.0632147037975, -1235.0686184823194, -558.4619878264435, -257.8013191628552, -44.56456513620698, -350.6593700100411, -138.52989006122968, -319.90948036405405, -1218.336581875307, -836.0696969547599, -635.9365576472284, -767.8323856850078, -667.8059830851444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5585205073475445, "mean_inference_ms": 1.6666845478243155, "mean_action_processing_ms": 0.28170350659940235, "mean_env_wait_ms": 2.9601566697742197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013795137405395508, "StateBufferConnector_ms": 0.008474588394165039, "ViewRequirementAgentConnector_ms": 0.19120478630065918}, "num_episodes": 30, "episode_return_max": -43.46516730549232, "episode_return_min": -1280.055801324701, "episode_return_mean": -643.9575038632992, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.2827044288424, "num_env_steps_trained_throughput_per_sec": 304.2827044288424, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13304.496, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13304.427, "sample_time_ms": 1021.014, "learn_time_ms": 12214.702, "learn_throughput": 327.474, "synch_weights_time_ms": 67.851}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00015", "date": "2024-08-03_11-39-54", "timestamp": 1722665394, "time_this_iter_s": 13.15989875793457, "time_total_s": 53.26789689064026, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244493760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 53.26789689064026, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 14.42222222222222, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6071144208932915, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.571458782752355, "policy_loss": -0.007116120277593533, "vf_loss": 9.576687681674958, "vf_explained_var": 0.12089945742239555, "kl": 0.010205734935455745, "entropy": 1.5392785863329967, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -43.46516730549232, "episode_reward_min": -1280.055801324701, "episode_reward_mean": -684.741718113675, "episode_len_mean": 139.17, "episode_media": {}, "episodes_timesteps_total": 13917, "policy_reward_min": {"policy_0": -1280.055801324701}, "policy_reward_max": {"policy_0": -43.46516730549232}, "policy_reward_mean": {"policy_0": -684.741718113675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-418.38559081820875, -1200.5965949040235, -258.7156272457774, -270.3020334803862, -774.5340991051306, -771.0525737681969, -669.1246126831309, -881.8463298947672, -1054.4354264698363, -690.8880975960498, -526.5625355195954, -588.477162597729, -767.0404856587256, -747.346143144373, -210.20325682366544, -951.9098116717387, -566.9577114500732, -566.986980548199, -357.15934280317504, -599.5947711745654, -448.2083141905946, -303.1116649568346, -329.5462990024628, -1280.055801324701, -454.9203546216529, -1113.9238757767857, -965.1225474564659, -638.9812130286299, -324.30983415079015, -881.0375904020499, -864.1022869515464, -1212.233530312558, -1101.133819358819, -252.07842369845568, -166.53454469351155, -681.0341932895043, -569.2391180873512, -826.1980643850565, -799.6193879455054, -1022.127630111285, -578.2392172118858, -1135.3268519518622, -43.46516730549232, -915.0850055284685, -247.418748112702, -235.3098287363903, -890.2621768366142, -1050.249168856029, -472.0310446448044, -684.2694694000994, -1016.7759031763197, -721.6398184127266, -766.0173364678973, -784.1737244493095, -1096.259114479338, -954.9606539321627, -391.7035809558974, -781.6485360395358, -835.0632147037975, -1235.0686184823194, -558.4619878264435, -257.8013191628552, -44.56456513620698, -350.6593700100411, -138.52989006122968, -319.90948036405405, -1218.336581875307, -836.0696969547599, -635.9365576472284, -767.8323856850078, -667.8059830851444, -578.7186572500605, -1180.6720171239224, -1082.8231809775266, -594.898321729041, -437.5669092945594, -671.2049744884878, -78.39301660242675, -856.4909794240325, -829.597999988507, -1157.9548288944623, -687.1174197856564, -908.7759203057619, -309.3422960231724, -236.48743735095678, -881.0998314363046, -107.9971101042688, -398.2902077563119, -183.32102389115744, -1042.2894944217505, -862.5376924617437, -1030.7588024551508, -1067.4839912115438, -777.9136886379739, -1172.8219297532496, -847.5491858567967, -520.0521423584961, -629.5758393625572, -511.3221120088491, -1094.6021218189364], "episode_lengths": [150, 150, 79, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 109, 150, 150, 150, 124, 150, 150, 150, 106, 150, 150, 150, 150, 117, 76, 150, 150, 150, 150, 150, 150, 150, 45, 150, 126, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 132, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 131, 150, 60, 150, 150, 150, 150, 150, 150, 72, 150, 52, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-418.38559081820875, -1200.5965949040235, -258.7156272457774, -270.3020334803862, -774.5340991051306, -771.0525737681969, -669.1246126831309, -881.8463298947672, -1054.4354264698363, -690.8880975960498, -526.5625355195954, -588.477162597729, -767.0404856587256, -747.346143144373, -210.20325682366544, -951.9098116717387, -566.9577114500732, -566.986980548199, -357.15934280317504, -599.5947711745654, -448.2083141905946, -303.1116649568346, -329.5462990024628, -1280.055801324701, -454.9203546216529, -1113.9238757767857, -965.1225474564659, -638.9812130286299, -324.30983415079015, -881.0375904020499, -864.1022869515464, -1212.233530312558, -1101.133819358819, -252.07842369845568, -166.53454469351155, -681.0341932895043, -569.2391180873512, -826.1980643850565, -799.6193879455054, -1022.127630111285, -578.2392172118858, -1135.3268519518622, -43.46516730549232, -915.0850055284685, -247.418748112702, -235.3098287363903, -890.2621768366142, -1050.249168856029, -472.0310446448044, -684.2694694000994, -1016.7759031763197, -721.6398184127266, -766.0173364678973, -784.1737244493095, -1096.259114479338, -954.9606539321627, -391.7035809558974, -781.6485360395358, -835.0632147037975, -1235.0686184823194, -558.4619878264435, -257.8013191628552, -44.56456513620698, -350.6593700100411, -138.52989006122968, -319.90948036405405, -1218.336581875307, -836.0696969547599, -635.9365576472284, -767.8323856850078, -667.8059830851444, -578.7186572500605, -1180.6720171239224, -1082.8231809775266, -594.898321729041, -437.5669092945594, -671.2049744884878, -78.39301660242675, -856.4909794240325, -829.597999988507, -1157.9548288944623, -687.1174197856564, -908.7759203057619, -309.3422960231724, -236.48743735095678, -881.0998314363046, -107.9971101042688, -398.2902077563119, -183.32102389115744, -1042.2894944217505, -862.5376924617437, -1030.7588024551508, -1067.4839912115438, -777.9136886379739, -1172.8219297532496, -847.5491858567967, -520.0521423584961, -629.5758393625572, -511.3221120088491, -1094.6021218189364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5612445805487218, "mean_inference_ms": 1.686434853027491, "mean_action_processing_ms": 0.2843387822605599, "mean_env_wait_ms": 2.978992958391072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014264583587646484, "StateBufferConnector_ms": 0.008841514587402344, "ViewRequirementAgentConnector_ms": 0.19847798347473145}, "num_episodes": 29, "episode_return_max": -43.46516730549232, "episode_return_min": -1280.055801324701, "episode_return_mean": -684.741718113675, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.90749291164406, "num_env_steps_trained_throughput_per_sec": 332.90749291164406, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13046.67, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13046.6, "sample_time_ms": 1028.72, "learn_time_ms": 11949.696, "learn_throughput": 334.737, "synch_weights_time_ms": 67.343}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00015", "date": "2024-08-03_11-40-06", "timestamp": 1722665406, "time_this_iter_s": 12.028697490692139, "time_total_s": 65.2965943813324, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244437520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 65.2965943813324, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 14.688888888888888, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.363621321382622, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.351176412403584, "policy_loss": -0.016519474022788926, "vf_loss": 9.363701352477074, "vf_explained_var": 0.18818062444527944, "kl": 0.020716746533760978, "entropy": 1.4879801196356615, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -43.46516730549232, "episode_reward_min": -1369.9574962766471, "episode_reward_mean": -692.0408109092414, "episode_len_mean": 136.02, "episode_media": {}, "episodes_timesteps_total": 13602, "policy_reward_min": {"policy_0": -1369.9574962766471}, "policy_reward_max": {"policy_0": -43.46516730549232}, "policy_reward_mean": {"policy_0": -692.0408109092414}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1101.133819358819, -252.07842369845568, -166.53454469351155, -681.0341932895043, -569.2391180873512, -826.1980643850565, -799.6193879455054, -1022.127630111285, -578.2392172118858, -1135.3268519518622, -43.46516730549232, -915.0850055284685, -247.418748112702, -235.3098287363903, -890.2621768366142, -1050.249168856029, -472.0310446448044, -684.2694694000994, -1016.7759031763197, -721.6398184127266, -766.0173364678973, -784.1737244493095, -1096.259114479338, -954.9606539321627, -391.7035809558974, -781.6485360395358, -835.0632147037975, -1235.0686184823194, -558.4619878264435, -257.8013191628552, -44.56456513620698, -350.6593700100411, -138.52989006122968, -319.90948036405405, -1218.336581875307, -836.0696969547599, -635.9365576472284, -767.8323856850078, -667.8059830851444, -578.7186572500605, -1180.6720171239224, -1082.8231809775266, -594.898321729041, -437.5669092945594, -671.2049744884878, -78.39301660242675, -856.4909794240325, -829.597999988507, -1157.9548288944623, -687.1174197856564, -908.7759203057619, -309.3422960231724, -236.48743735095678, -881.0998314363046, -107.9971101042688, -398.2902077563119, -183.32102389115744, -1042.2894944217505, -862.5376924617437, -1030.7588024551508, -1067.4839912115438, -777.9136886379739, -1172.8219297532496, -847.5491858567967, -520.0521423584961, -629.5758393625572, -511.3221120088491, -1094.6021218189364, -679.8964745587086, -924.0946803616359, -918.6728578972629, -1245.4210469253667, -513.6074772567457, -102.57817611909154, -997.0387299697552, -898.3469257281376, -1028.9635749579181, -472.45569146079504, -821.8288250430162, -904.2145511434892, -1031.4630324758102, -88.8750333479698, -214.2814670333346, -823.0132994524274, -904.7607530309086, -693.6585472734979, -1103.9136908558448, -255.8461330918787, -474.89944226061044, -1369.9574962766471, -237.60206511495971, -982.4809527496221, -161.16812811409258, -627.8440878958995, -911.8885332594818, -124.15469236419092, -684.8058434993225, -148.36415302606576, -817.974503691778, -1253.51091285279], "episode_lengths": [150, 117, 76, 150, 150, 150, 150, 150, 150, 150, 45, 150, 126, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 132, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 131, 150, 60, 150, 150, 150, 150, 150, 150, 72, 150, 52, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 80, 112, 150, 150, 150, 150, 86, 133, 150, 107, 150, 63, 150, 150, 61, 150, 58, 150, 150], "policy_policy_0_reward": [-1101.133819358819, -252.07842369845568, -166.53454469351155, -681.0341932895043, -569.2391180873512, -826.1980643850565, -799.6193879455054, -1022.127630111285, -578.2392172118858, -1135.3268519518622, -43.46516730549232, -915.0850055284685, -247.418748112702, -235.3098287363903, -890.2621768366142, -1050.249168856029, -472.0310446448044, -684.2694694000994, -1016.7759031763197, -721.6398184127266, -766.0173364678973, -784.1737244493095, -1096.259114479338, -954.9606539321627, -391.7035809558974, -781.6485360395358, -835.0632147037975, -1235.0686184823194, -558.4619878264435, -257.8013191628552, -44.56456513620698, -350.6593700100411, -138.52989006122968, -319.90948036405405, -1218.336581875307, -836.0696969547599, -635.9365576472284, -767.8323856850078, -667.8059830851444, -578.7186572500605, -1180.6720171239224, -1082.8231809775266, -594.898321729041, -437.5669092945594, -671.2049744884878, -78.39301660242675, -856.4909794240325, -829.597999988507, -1157.9548288944623, -687.1174197856564, -908.7759203057619, -309.3422960231724, -236.48743735095678, -881.0998314363046, -107.9971101042688, -398.2902077563119, -183.32102389115744, -1042.2894944217505, -862.5376924617437, -1030.7588024551508, -1067.4839912115438, -777.9136886379739, -1172.8219297532496, -847.5491858567967, -520.0521423584961, -629.5758393625572, -511.3221120088491, -1094.6021218189364, -679.8964745587086, -924.0946803616359, -918.6728578972629, -1245.4210469253667, -513.6074772567457, -102.57817611909154, -997.0387299697552, -898.3469257281376, -1028.9635749579181, -472.45569146079504, -821.8288250430162, -904.2145511434892, -1031.4630324758102, -88.8750333479698, -214.2814670333346, -823.0132994524274, -904.7607530309086, -693.6585472734979, -1103.9136908558448, -255.8461330918787, -474.89944226061044, -1369.9574962766471, -237.60206511495971, -982.4809527496221, -161.16812811409258, -627.8440878958995, -911.8885332594818, -124.15469236419092, -684.8058434993225, -148.36415302606576, -817.974503691778, -1253.51091285279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5614508180366256, "mean_inference_ms": 1.692679631097247, "mean_action_processing_ms": 0.28560510574585835, "mean_env_wait_ms": 2.9836017511049415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01386570930480957, "StateBufferConnector_ms": 0.008728504180908203, "ViewRequirementAgentConnector_ms": 0.19604897499084473}, "num_episodes": 32, "episode_return_max": -43.46516730549232, "episode_return_min": -1369.9574962766471, "episode_return_mean": -692.0408109092414, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.0979735160645, "num_env_steps_trained_throughput_per_sec": 291.0979735160645, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13162.407, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13162.337, "sample_time_ms": 1024.339, "learn_time_ms": 12070.561, "learn_throughput": 331.385, "synch_weights_time_ms": 66.6}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00015", "date": "2024-08-03_11-40-20", "timestamp": 1722665420, "time_this_iter_s": 13.753414154052734, "time_total_s": 79.05000853538513, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b5cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 79.05000853538513, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.631578947368421, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0620613592366377, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.535555080572765, "policy_loss": -0.012014469508721958, "vf_loss": 9.54293616215388, "vf_explained_var": 0.1419316541403532, "kl": 0.015952141280286013, "entropy": 1.5228445989390214, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -44.56456513620698, "episode_reward_min": -1369.9574962766471, "episode_reward_mean": -692.537969043529, "episode_len_mean": 136.31, "episode_media": {}, "episodes_timesteps_total": 13631, "policy_reward_min": {"policy_0": -1369.9574962766471}, "policy_reward_max": {"policy_0": -44.56456513620698}, "policy_reward_mean": {"policy_0": -692.537969043529}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-558.4619878264435, -257.8013191628552, -44.56456513620698, -350.6593700100411, -138.52989006122968, -319.90948036405405, -1218.336581875307, -836.0696969547599, -635.9365576472284, -767.8323856850078, -667.8059830851444, -578.7186572500605, -1180.6720171239224, -1082.8231809775266, -594.898321729041, -437.5669092945594, -671.2049744884878, -78.39301660242675, -856.4909794240325, -829.597999988507, -1157.9548288944623, -687.1174197856564, -908.7759203057619, -309.3422960231724, -236.48743735095678, -881.0998314363046, -107.9971101042688, -398.2902077563119, -183.32102389115744, -1042.2894944217505, -862.5376924617437, -1030.7588024551508, -1067.4839912115438, -777.9136886379739, -1172.8219297532496, -847.5491858567967, -520.0521423584961, -629.5758393625572, -511.3221120088491, -1094.6021218189364, -679.8964745587086, -924.0946803616359, -918.6728578972629, -1245.4210469253667, -513.6074772567457, -102.57817611909154, -997.0387299697552, -898.3469257281376, -1028.9635749579181, -472.45569146079504, -821.8288250430162, -904.2145511434892, -1031.4630324758102, -88.8750333479698, -214.2814670333346, -823.0132994524274, -904.7607530309086, -693.6585472734979, -1103.9136908558448, -255.8461330918787, -474.89944226061044, -1369.9574962766471, -237.60206511495971, -982.4809527496221, -161.16812811409258, -627.8440878958995, -911.8885332594818, -124.15469236419092, -684.8058434993225, -148.36415302606576, -817.974503691778, -1253.51091285279, -678.101298302726, -750.8992705790364, -456.9519073599755, -387.61585608376697, -971.3369602524932, -1175.739403572205, -1109.3965568217066, -716.1252826170193, -964.0295199969769, -1152.9877585837746, -800.6623497438433, -615.1729206078229, -368.9632186016582, -783.6045519619198, -388.36333775358554, -795.3455614533725, -864.8487900314224, -1229.8561685661016, -214.67539686408557, -350.460149796133, -440.61290570515473, -753.3500591445156, -754.8552708052961, -1167.6405016143015, -536.2543245501755, -985.3023329147538, -348.08446105390635, -541.412059344174], "episode_lengths": [150, 150, 76, 132, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 131, 150, 60, 150, 150, 150, 150, 150, 150, 72, 150, 52, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 80, 112, 150, 150, 150, 150, 86, 133, 150, 107, 150, 63, 150, 150, 61, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 145, 150, 150, 150, 90, 90, 118, 150, 150, 150, 150, 150, 150, 122], "policy_policy_0_reward": [-558.4619878264435, -257.8013191628552, -44.56456513620698, -350.6593700100411, -138.52989006122968, -319.90948036405405, -1218.336581875307, -836.0696969547599, -635.9365576472284, -767.8323856850078, -667.8059830851444, -578.7186572500605, -1180.6720171239224, -1082.8231809775266, -594.898321729041, -437.5669092945594, -671.2049744884878, -78.39301660242675, -856.4909794240325, -829.597999988507, -1157.9548288944623, -687.1174197856564, -908.7759203057619, -309.3422960231724, -236.48743735095678, -881.0998314363046, -107.9971101042688, -398.2902077563119, -183.32102389115744, -1042.2894944217505, -862.5376924617437, -1030.7588024551508, -1067.4839912115438, -777.9136886379739, -1172.8219297532496, -847.5491858567967, -520.0521423584961, -629.5758393625572, -511.3221120088491, -1094.6021218189364, -679.8964745587086, -924.0946803616359, -918.6728578972629, -1245.4210469253667, -513.6074772567457, -102.57817611909154, -997.0387299697552, -898.3469257281376, -1028.9635749579181, -472.45569146079504, -821.8288250430162, -904.2145511434892, -1031.4630324758102, -88.8750333479698, -214.2814670333346, -823.0132994524274, -904.7607530309086, -693.6585472734979, -1103.9136908558448, -255.8461330918787, -474.89944226061044, -1369.9574962766471, -237.60206511495971, -982.4809527496221, -161.16812811409258, -627.8440878958995, -911.8885332594818, -124.15469236419092, -684.8058434993225, -148.36415302606576, -817.974503691778, -1253.51091285279, -678.101298302726, -750.8992705790364, -456.9519073599755, -387.61585608376697, -971.3369602524932, -1175.739403572205, -1109.3965568217066, -716.1252826170193, -964.0295199969769, -1152.9877585837746, -800.6623497438433, -615.1729206078229, -368.9632186016582, -783.6045519619198, -388.36333775358554, -795.3455614533725, -864.8487900314224, -1229.8561685661016, -214.67539686408557, -350.460149796133, -440.61290570515473, -753.3500591445156, -754.8552708052961, -1167.6405016143015, -536.2543245501755, -985.3023329147538, -348.08446105390635, -541.412059344174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5618352794504796, "mean_inference_ms": 1.6976336299151429, "mean_action_processing_ms": 0.2861625663418512, "mean_env_wait_ms": 2.9903878408362083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01359415054321289, "StateBufferConnector_ms": 0.008534669876098633, "ViewRequirementAgentConnector_ms": 0.1981971263885498}, "num_episodes": 28, "episode_return_max": -44.56456513620698, "episode_return_min": -1369.9574962766471, "episode_return_mean": -692.537969043529, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.9838418931375, "num_env_steps_trained_throughput_per_sec": 295.9838418931375, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13212.672, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13212.602, "sample_time_ms": 1027.352, "learn_time_ms": 12117.878, "learn_throughput": 330.091, "synch_weights_time_ms": 66.534}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00015", "date": "2024-08-03_11-40-34", "timestamp": 1722665434, "time_this_iter_s": 13.526428699493408, "time_total_s": 92.57643723487854, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c0af0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 92.57643723487854, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.873684210526314, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.044922118013104, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.340662447114786, "policy_loss": -0.010007919396351402, "vf_loss": 9.346569994091988, "vf_explained_var": 0.3342784286166231, "kl": 0.014139818431309929, "entropy": 1.4156650769213834, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -4.918461596459616, "episode_reward_min": -1369.9574962766471, "episode_reward_mean": -716.1425903882654, "episode_len_mean": 134.77, "episode_media": {}, "episodes_timesteps_total": 13477, "policy_reward_min": {"policy_0": -1369.9574962766471}, "policy_reward_max": {"policy_0": -4.918461596459616}, "policy_reward_mean": {"policy_0": -716.1425903882654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-777.9136886379739, -1172.8219297532496, -847.5491858567967, -520.0521423584961, -629.5758393625572, -511.3221120088491, -1094.6021218189364, -679.8964745587086, -924.0946803616359, -918.6728578972629, -1245.4210469253667, -513.6074772567457, -102.57817611909154, -997.0387299697552, -898.3469257281376, -1028.9635749579181, -472.45569146079504, -821.8288250430162, -904.2145511434892, -1031.4630324758102, -88.8750333479698, -214.2814670333346, -823.0132994524274, -904.7607530309086, -693.6585472734979, -1103.9136908558448, -255.8461330918787, -474.89944226061044, -1369.9574962766471, -237.60206511495971, -982.4809527496221, -161.16812811409258, -627.8440878958995, -911.8885332594818, -124.15469236419092, -684.8058434993225, -148.36415302606576, -817.974503691778, -1253.51091285279, -678.101298302726, -750.8992705790364, -456.9519073599755, -387.61585608376697, -971.3369602524932, -1175.739403572205, -1109.3965568217066, -716.1252826170193, -964.0295199969769, -1152.9877585837746, -800.6623497438433, -615.1729206078229, -368.9632186016582, -783.6045519619198, -388.36333775358554, -795.3455614533725, -864.8487900314224, -1229.8561685661016, -214.67539686408557, -350.460149796133, -440.61290570515473, -753.3500591445156, -754.8552708052961, -1167.6405016143015, -536.2543245501755, -985.3023329147538, -348.08446105390635, -541.412059344174, -434.29299032397597, -1236.2607331280185, -642.6316347319741, -847.1851124954703, -1019.9309766171211, -573.621194175092, -1083.488123381439, -1059.9501705049179, -534.9975839968425, -953.0415212210212, -1061.7643221694393, -31.64568084054643, -157.98620212488112, -82.8124740726366, -931.3791566719292, -592.3757877818567, -545.4200583441865, -180.5084290766693, -212.98293197579068, -1101.6275189821101, -10.854849117201463, -990.0154438131442, -591.9454238144743, -919.9796757954981, -592.6786770064673, -1174.1914902710687, -996.347661346771, -166.70121996526916, -1256.4039990719857, -1151.7981327909756, -4.918461596459616, -965.850778211206, -1234.603649842283], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 80, 112, 150, 150, 150, 150, 86, 133, 150, 107, 150, 63, 150, 150, 61, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 145, 150, 150, 150, 90, 90, 118, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 34, 106, 52, 150, 150, 150, 95, 103, 150, 42, 150, 150, 150, 150, 150, 150, 84, 150, 150, 37, 150, 150], "policy_policy_0_reward": [-777.9136886379739, -1172.8219297532496, -847.5491858567967, -520.0521423584961, -629.5758393625572, -511.3221120088491, -1094.6021218189364, -679.8964745587086, -924.0946803616359, -918.6728578972629, -1245.4210469253667, -513.6074772567457, -102.57817611909154, -997.0387299697552, -898.3469257281376, -1028.9635749579181, -472.45569146079504, -821.8288250430162, -904.2145511434892, -1031.4630324758102, -88.8750333479698, -214.2814670333346, -823.0132994524274, -904.7607530309086, -693.6585472734979, -1103.9136908558448, -255.8461330918787, -474.89944226061044, -1369.9574962766471, -237.60206511495971, -982.4809527496221, -161.16812811409258, -627.8440878958995, -911.8885332594818, -124.15469236419092, -684.8058434993225, -148.36415302606576, -817.974503691778, -1253.51091285279, -678.101298302726, -750.8992705790364, -456.9519073599755, -387.61585608376697, -971.3369602524932, -1175.739403572205, -1109.3965568217066, -716.1252826170193, -964.0295199969769, -1152.9877585837746, -800.6623497438433, -615.1729206078229, -368.9632186016582, -783.6045519619198, -388.36333775358554, -795.3455614533725, -864.8487900314224, -1229.8561685661016, -214.67539686408557, -350.460149796133, -440.61290570515473, -753.3500591445156, -754.8552708052961, -1167.6405016143015, -536.2543245501755, -985.3023329147538, -348.08446105390635, -541.412059344174, -434.29299032397597, -1236.2607331280185, -642.6316347319741, -847.1851124954703, -1019.9309766171211, -573.621194175092, -1083.488123381439, -1059.9501705049179, -534.9975839968425, -953.0415212210212, -1061.7643221694393, -31.64568084054643, -157.98620212488112, -82.8124740726366, -931.3791566719292, -592.3757877818567, -545.4200583441865, -180.5084290766693, -212.98293197579068, -1101.6275189821101, -10.854849117201463, -990.0154438131442, -591.9454238144743, -919.9796757954981, -592.6786770064673, -1174.1914902710687, -996.347661346771, -166.70121996526916, -1256.4039990719857, -1151.7981327909756, -4.918461596459616, -965.850778211206, -1234.603649842283]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5597897102631716, "mean_inference_ms": 1.6960734258372434, "mean_action_processing_ms": 0.28557752764031635, "mean_env_wait_ms": 2.993607705090735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012658834457397461, "StateBufferConnector_ms": 0.00792074203491211, "ViewRequirementAgentConnector_ms": 0.18894386291503906}, "num_episodes": 33, "episode_return_max": -4.918461596459616, "episode_return_min": -1369.9574962766471, "episode_return_mean": -716.1425903882654, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.92516859354237, "num_env_steps_trained_throughput_per_sec": 306.92516859354237, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13190.151, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13190.081, "sample_time_ms": 1025.32, "learn_time_ms": 12096.782, "learn_throughput": 330.666, "synch_weights_time_ms": 67.129}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00015", "date": "2024-08-03_11-40-47", "timestamp": 1722665447, "time_this_iter_s": 13.050129890441895, "time_total_s": 105.62656712532043, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a244493b50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 105.62656712532043, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.736842105263158, "ram_util_percent": 27.73157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.802623081331451, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.286742482582728, "policy_loss": -0.01948654444083028, "vf_loss": 9.30054385860761, "vf_explained_var": 0.2372071176767349, "kl": 0.019417205587463595, "entropy": 1.400093966970841, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -4.918461596459616, "episode_reward_min": -1369.9574962766471, "episode_reward_mean": -677.0551566236423, "episode_len_mean": 133.21, "episode_media": {}, "episodes_timesteps_total": 13321, "policy_reward_min": {"policy_0": -1369.9574962766471}, "policy_reward_max": {"policy_0": -4.918461596459616}, "policy_reward_mean": {"policy_0": -677.0551566236423}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-255.8461330918787, -474.89944226061044, -1369.9574962766471, -237.60206511495971, -982.4809527496221, -161.16812811409258, -627.8440878958995, -911.8885332594818, -124.15469236419092, -684.8058434993225, -148.36415302606576, -817.974503691778, -1253.51091285279, -678.101298302726, -750.8992705790364, -456.9519073599755, -387.61585608376697, -971.3369602524932, -1175.739403572205, -1109.3965568217066, -716.1252826170193, -964.0295199969769, -1152.9877585837746, -800.6623497438433, -615.1729206078229, -368.9632186016582, -783.6045519619198, -388.36333775358554, -795.3455614533725, -864.8487900314224, -1229.8561685661016, -214.67539686408557, -350.460149796133, -440.61290570515473, -753.3500591445156, -754.8552708052961, -1167.6405016143015, -536.2543245501755, -985.3023329147538, -348.08446105390635, -541.412059344174, -434.29299032397597, -1236.2607331280185, -642.6316347319741, -847.1851124954703, -1019.9309766171211, -573.621194175092, -1083.488123381439, -1059.9501705049179, -534.9975839968425, -953.0415212210212, -1061.7643221694393, -31.64568084054643, -157.98620212488112, -82.8124740726366, -931.3791566719292, -592.3757877818567, -545.4200583441865, -180.5084290766693, -212.98293197579068, -1101.6275189821101, -10.854849117201463, -990.0154438131442, -591.9454238144743, -919.9796757954981, -592.6786770064673, -1174.1914902710687, -996.347661346771, -166.70121996526916, -1256.4039990719857, -1151.7981327909756, -4.918461596459616, -965.850778211206, -1234.603649842283, -628.4542192707232, -148.4265314343665, -663.0564498893269, -911.5466108476248, -978.6255854552952, -383.3754323405696, -1182.6268606284514, -554.6591564868792, -564.3026787393359, -291.9970272193956, -109.38299578571637, -586.9884193235675, -154.46971797190065, -598.2124853820736, -693.4093446253871, -451.5575007492316, -698.0851586532879, -287.37870647513927, -681.4195638665668, -843.3081727523562, -527.4542393843658, -916.6011728549598, -365.95201865977896, -855.6186971567621, -943.4915043588188, -991.7782279144031], "episode_lengths": [86, 133, 150, 107, 150, 63, 150, 150, 61, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 145, 150, 150, 150, 90, 90, 118, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 34, 106, 52, 150, 150, 150, 95, 103, 150, 42, 150, 150, 150, 150, 150, 150, 84, 150, 150, 37, 150, 150, 150, 98, 150, 150, 150, 120, 150, 150, 150, 85, 74, 150, 97, 150, 150, 150, 150, 83, 150, 150, 119, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-255.8461330918787, -474.89944226061044, -1369.9574962766471, -237.60206511495971, -982.4809527496221, -161.16812811409258, -627.8440878958995, -911.8885332594818, -124.15469236419092, -684.8058434993225, -148.36415302606576, -817.974503691778, -1253.51091285279, -678.101298302726, -750.8992705790364, -456.9519073599755, -387.61585608376697, -971.3369602524932, -1175.739403572205, -1109.3965568217066, -716.1252826170193, -964.0295199969769, -1152.9877585837746, -800.6623497438433, -615.1729206078229, -368.9632186016582, -783.6045519619198, -388.36333775358554, -795.3455614533725, -864.8487900314224, -1229.8561685661016, -214.67539686408557, -350.460149796133, -440.61290570515473, -753.3500591445156, -754.8552708052961, -1167.6405016143015, -536.2543245501755, -985.3023329147538, -348.08446105390635, -541.412059344174, -434.29299032397597, -1236.2607331280185, -642.6316347319741, -847.1851124954703, -1019.9309766171211, -573.621194175092, -1083.488123381439, -1059.9501705049179, -534.9975839968425, -953.0415212210212, -1061.7643221694393, -31.64568084054643, -157.98620212488112, -82.8124740726366, -931.3791566719292, -592.3757877818567, -545.4200583441865, -180.5084290766693, -212.98293197579068, -1101.6275189821101, -10.854849117201463, -990.0154438131442, -591.9454238144743, -919.9796757954981, -592.6786770064673, -1174.1914902710687, -996.347661346771, -166.70121996526916, -1256.4039990719857, -1151.7981327909756, -4.918461596459616, -965.850778211206, -1234.603649842283, -628.4542192707232, -148.4265314343665, -663.0564498893269, -911.5466108476248, -978.6255854552952, -383.3754323405696, -1182.6268606284514, -554.6591564868792, -564.3026787393359, -291.9970272193956, -109.38299578571637, -586.9884193235675, -154.46971797190065, -598.2124853820736, -693.4093446253871, -451.5575007492316, -698.0851586532879, -287.37870647513927, -681.4195638665668, -843.3081727523562, -527.4542393843658, -916.6011728549598, -365.95201865977896, -855.6186971567621, -943.4915043588188, -991.7782279144031]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578870657230837, "mean_inference_ms": 1.6928239384595059, "mean_action_processing_ms": 0.2847237386199292, "mean_env_wait_ms": 2.992389332141999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012325286865234375, "StateBufferConnector_ms": 0.007846355438232422, "ViewRequirementAgentConnector_ms": 0.18854618072509766}, "num_episodes": 26, "episode_return_max": -4.918461596459616, "episode_return_min": -1369.9574962766471, "episode_return_mean": -677.0551566236423, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.26335358710264, "num_env_steps_trained_throughput_per_sec": 295.26335358710264, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13229.828, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13229.758, "sample_time_ms": 1024.23, "learn_time_ms": 12135.879, "learn_throughput": 329.601, "synch_weights_time_ms": 68.802}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00015", "date": "2024-08-03_11-41-00", "timestamp": 1722665460, "time_this_iter_s": 13.559629917144775, "time_total_s": 119.18619704246521, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b52d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 119.18619704246521, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.721052631578948, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.126370183502635, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.93012180775404, "policy_loss": -0.014544322520184021, "vf_loss": 8.93930099060138, "vf_explained_var": 0.4186609794696172, "kl": 0.018347685923436073, "entropy": 1.3920737550904354, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -4.918461596459616, "episode_reward_min": -1293.1201368039701, "episode_reward_mean": -662.9705995066885, "episode_len_mean": 133.39, "episode_media": {}, "episodes_timesteps_total": 13339, "policy_reward_min": {"policy_0": -1293.1201368039701}, "policy_reward_max": {"policy_0": -4.918461596459616}, "policy_reward_mean": {"policy_0": -662.9705995066885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-214.67539686408557, -350.460149796133, -440.61290570515473, -753.3500591445156, -754.8552708052961, -1167.6405016143015, -536.2543245501755, -985.3023329147538, -348.08446105390635, -541.412059344174, -434.29299032397597, -1236.2607331280185, -642.6316347319741, -847.1851124954703, -1019.9309766171211, -573.621194175092, -1083.488123381439, -1059.9501705049179, -534.9975839968425, -953.0415212210212, -1061.7643221694393, -31.64568084054643, -157.98620212488112, -82.8124740726366, -931.3791566719292, -592.3757877818567, -545.4200583441865, -180.5084290766693, -212.98293197579068, -1101.6275189821101, -10.854849117201463, -990.0154438131442, -591.9454238144743, -919.9796757954981, -592.6786770064673, -1174.1914902710687, -996.347661346771, -166.70121996526916, -1256.4039990719857, -1151.7981327909756, -4.918461596459616, -965.850778211206, -1234.603649842283, -628.4542192707232, -148.4265314343665, -663.0564498893269, -911.5466108476248, -978.6255854552952, -383.3754323405696, -1182.6268606284514, -554.6591564868792, -564.3026787393359, -291.9970272193956, -109.38299578571637, -586.9884193235675, -154.46971797190065, -598.2124853820736, -693.4093446253871, -451.5575007492316, -698.0851586532879, -287.37870647513927, -681.4195638665668, -843.3081727523562, -527.4542393843658, -916.6011728549598, -365.95201865977896, -855.6186971567621, -943.4915043588188, -991.7782279144031, -888.7218144842717, -1265.2886560367815, -1018.1567915915687, -861.0866284389771, -239.22157659902143, -504.9849699311824, -1293.1201368039701, -539.114899460474, -921.835484487818, -760.3548953904324, -141.40742882981263, -357.62794895322213, -249.1497859649525, -513.0830971344257, -840.2609245616093, -947.787890356588, -98.49784086266685, -820.1871238213699, -392.0758408250485, -751.2108462538857, -151.7859739701908, -888.9295880188461, -945.9643497487311, -956.6474800850665, -631.3673179978331, -1019.758625215884, -319.07257918482725, -349.94529323742415, -656.5090272672547, -996.5212968955649, -532.3658329816411], "episode_lengths": [90, 90, 118, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 34, 106, 52, 150, 150, 150, 95, 103, 150, 42, 150, 150, 150, 150, 150, 150, 84, 150, 150, 37, 150, 150, 150, 98, 150, 150, 150, 120, 150, 150, 150, 85, 74, 150, 97, 150, 150, 150, 150, 83, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 147, 77, 150, 150, 150, 150, 150, 73, 128, 93, 150, 150, 150, 48, 150, 127, 150, 97, 150, 150, 150, 150, 150, 135, 150, 150, 150, 144], "policy_policy_0_reward": [-214.67539686408557, -350.460149796133, -440.61290570515473, -753.3500591445156, -754.8552708052961, -1167.6405016143015, -536.2543245501755, -985.3023329147538, -348.08446105390635, -541.412059344174, -434.29299032397597, -1236.2607331280185, -642.6316347319741, -847.1851124954703, -1019.9309766171211, -573.621194175092, -1083.488123381439, -1059.9501705049179, -534.9975839968425, -953.0415212210212, -1061.7643221694393, -31.64568084054643, -157.98620212488112, -82.8124740726366, -931.3791566719292, -592.3757877818567, -545.4200583441865, -180.5084290766693, -212.98293197579068, -1101.6275189821101, -10.854849117201463, -990.0154438131442, -591.9454238144743, -919.9796757954981, -592.6786770064673, -1174.1914902710687, -996.347661346771, -166.70121996526916, -1256.4039990719857, -1151.7981327909756, -4.918461596459616, -965.850778211206, -1234.603649842283, -628.4542192707232, -148.4265314343665, -663.0564498893269, -911.5466108476248, -978.6255854552952, -383.3754323405696, -1182.6268606284514, -554.6591564868792, -564.3026787393359, -291.9970272193956, -109.38299578571637, -586.9884193235675, -154.46971797190065, -598.2124853820736, -693.4093446253871, -451.5575007492316, -698.0851586532879, -287.37870647513927, -681.4195638665668, -843.3081727523562, -527.4542393843658, -916.6011728549598, -365.95201865977896, -855.6186971567621, -943.4915043588188, -991.7782279144031, -888.7218144842717, -1265.2886560367815, -1018.1567915915687, -861.0866284389771, -239.22157659902143, -504.9849699311824, -1293.1201368039701, -539.114899460474, -921.835484487818, -760.3548953904324, -141.40742882981263, -357.62794895322213, -249.1497859649525, -513.0830971344257, -840.2609245616093, -947.787890356588, -98.49784086266685, -820.1871238213699, -392.0758408250485, -751.2108462538857, -151.7859739701908, -888.9295880188461, -945.9643497487311, -956.6474800850665, -631.3673179978331, -1019.758625215884, -319.07257918482725, -349.94529323742415, -656.5090272672547, -996.5212968955649, -532.3658329816411]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553708280816648, "mean_inference_ms": 1.6899709458257948, "mean_action_processing_ms": 0.28352486508803443, "mean_env_wait_ms": 2.9923219816827618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011857032775878906, "StateBufferConnector_ms": 0.007813215255737305, "ViewRequirementAgentConnector_ms": 0.18783903121948242}, "num_episodes": 31, "episode_return_max": -4.918461596459616, "episode_return_min": -1293.1201368039701, "episode_return_mean": -662.9705995066885, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.52079364622796, "num_env_steps_trained_throughput_per_sec": 297.52079364622796, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13251.29, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13251.22, "sample_time_ms": 1026.711, "learn_time_ms": 12155.121, "learn_throughput": 329.079, "synch_weights_time_ms": 68.547}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00015", "date": "2024-08-03_11-41-14", "timestamp": 1722665474, "time_this_iter_s": 13.457583904266357, "time_total_s": 132.64378094673157, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c0af0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 132.64378094673157, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.444999999999999, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.0184810645878315, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.050158715248108, "policy_loss": -0.007403354573276981, "vf_loss": 9.053985284268856, "vf_explained_var": 0.27823638208210466, "kl": 0.012441440185345225, "entropy": 1.5567037108043829, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -4.918461596459616, "episode_reward_min": -1357.0280186033724, "episode_reward_mean": -676.3083173345412, "episode_len_mean": 136.32, "episode_media": {}, "episodes_timesteps_total": 13632, "policy_reward_min": {"policy_0": -1357.0280186033724}, "policy_reward_max": {"policy_0": -4.918461596459616}, "policy_reward_mean": {"policy_0": -676.3083173345412}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-592.3757877818567, -545.4200583441865, -180.5084290766693, -212.98293197579068, -1101.6275189821101, -10.854849117201463, -990.0154438131442, -591.9454238144743, -919.9796757954981, -592.6786770064673, -1174.1914902710687, -996.347661346771, -166.70121996526916, -1256.4039990719857, -1151.7981327909756, -4.918461596459616, -965.850778211206, -1234.603649842283, -628.4542192707232, -148.4265314343665, -663.0564498893269, -911.5466108476248, -978.6255854552952, -383.3754323405696, -1182.6268606284514, -554.6591564868792, -564.3026787393359, -291.9970272193956, -109.38299578571637, -586.9884193235675, -154.46971797190065, -598.2124853820736, -693.4093446253871, -451.5575007492316, -698.0851586532879, -287.37870647513927, -681.4195638665668, -843.3081727523562, -527.4542393843658, -916.6011728549598, -365.95201865977896, -855.6186971567621, -943.4915043588188, -991.7782279144031, -888.7218144842717, -1265.2886560367815, -1018.1567915915687, -861.0866284389771, -239.22157659902143, -504.9849699311824, -1293.1201368039701, -539.114899460474, -921.835484487818, -760.3548953904324, -141.40742882981263, -357.62794895322213, -249.1497859649525, -513.0830971344257, -840.2609245616093, -947.787890356588, -98.49784086266685, -820.1871238213699, -392.0758408250485, -751.2108462538857, -151.7859739701908, -888.9295880188461, -945.9643497487311, -956.6474800850665, -631.3673179978331, -1019.758625215884, -319.07257918482725, -349.94529323742415, -656.5090272672547, -996.5212968955649, -532.3658329816411, -689.630014540429, -1089.8872761988143, -300.7829312839769, -1221.7200599457458, -630.4828574969802, -485.45568067434317, -1044.2583684404387, -535.9680317642875, -1152.9083126454404, -681.3371650730599, -447.9714911201302, -530.4960385129665, -350.01269975273436, -660.3374144148939, -1165.1982032462279, -293.45634525307713, -574.6327322501364, -1357.0280186033724, -599.2244164967666, -877.3149710080265, -802.2617015169069, -1219.9057501717107, -439.45967991413215, -286.53908333075344, -641.1378773777346], "episode_lengths": [150, 150, 95, 103, 150, 42, 150, 150, 150, 150, 150, 150, 84, 150, 150, 37, 150, 150, 150, 98, 150, 150, 150, 120, 150, 150, 150, 85, 74, 150, 97, 150, 150, 150, 150, 83, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 147, 77, 150, 150, 150, 150, 150, 73, 128, 93, 150, 150, 150, 48, 150, 127, 150, 97, 150, 150, 150, 150, 150, 135, 150, 150, 150, 144, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 146, 150, 116, 150, 150, 150, 150, 150, 150, 104, 150, 150], "policy_policy_0_reward": [-592.3757877818567, -545.4200583441865, -180.5084290766693, -212.98293197579068, -1101.6275189821101, -10.854849117201463, -990.0154438131442, -591.9454238144743, -919.9796757954981, -592.6786770064673, -1174.1914902710687, -996.347661346771, -166.70121996526916, -1256.4039990719857, -1151.7981327909756, -4.918461596459616, -965.850778211206, -1234.603649842283, -628.4542192707232, -148.4265314343665, -663.0564498893269, -911.5466108476248, -978.6255854552952, -383.3754323405696, -1182.6268606284514, -554.6591564868792, -564.3026787393359, -291.9970272193956, -109.38299578571637, -586.9884193235675, -154.46971797190065, -598.2124853820736, -693.4093446253871, -451.5575007492316, -698.0851586532879, -287.37870647513927, -681.4195638665668, -843.3081727523562, -527.4542393843658, -916.6011728549598, -365.95201865977896, -855.6186971567621, -943.4915043588188, -991.7782279144031, -888.7218144842717, -1265.2886560367815, -1018.1567915915687, -861.0866284389771, -239.22157659902143, -504.9849699311824, -1293.1201368039701, -539.114899460474, -921.835484487818, -760.3548953904324, -141.40742882981263, -357.62794895322213, -249.1497859649525, -513.0830971344257, -840.2609245616093, -947.787890356588, -98.49784086266685, -820.1871238213699, -392.0758408250485, -751.2108462538857, -151.7859739701908, -888.9295880188461, -945.9643497487311, -956.6474800850665, -631.3673179978331, -1019.758625215884, -319.07257918482725, -349.94529323742415, -656.5090272672547, -996.5212968955649, -532.3658329816411, -689.630014540429, -1089.8872761988143, -300.7829312839769, -1221.7200599457458, -630.4828574969802, -485.45568067434317, -1044.2583684404387, -535.9680317642875, -1152.9083126454404, -681.3371650730599, -447.9714911201302, -530.4960385129665, -350.01269975273436, -660.3374144148939, -1165.1982032462279, -293.45634525307713, -574.6327322501364, -1357.0280186033724, -599.2244164967666, -877.3149710080265, -802.2617015169069, -1219.9057501717107, -439.45967991413215, -286.53908333075344, -641.1378773777346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545016060069795, "mean_inference_ms": 1.6886562122525597, "mean_action_processing_ms": 0.2829274115195012, "mean_env_wait_ms": 2.993504510828881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012072086334228516, "StateBufferConnector_ms": 0.007841348648071289, "ViewRequirementAgentConnector_ms": 0.18853473663330078}, "num_episodes": 25, "episode_return_max": -4.918461596459616, "episode_return_min": -1357.0280186033724, "episode_return_mean": -676.3083173345412, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.32743630609326, "num_env_steps_trained_throughput_per_sec": 299.32743630609326, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13243.89, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13243.815, "sample_time_ms": 1029.082, "learn_time_ms": 12145.043, "learn_throughput": 329.352, "synch_weights_time_ms": 68.851}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00015", "date": "2024-08-03_11-41-27", "timestamp": 1722665487, "time_this_iter_s": 13.375532865524292, "time_total_s": 146.01931381225586, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b6320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 146.01931381225586, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 13.594736842105263, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.641081867491206, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.04552821268638, "policy_loss": -0.017959513395423225, "vf_loss": 9.05783783197403, "vf_explained_var": 0.4046263772373398, "kl": 0.019336759437404313, "entropy": 1.5110902599990368, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -76.52624617139203, "episode_reward_min": -1357.0280186033724, "episode_reward_mean": -701.4929561390414, "episode_len_mean": 139.06, "episode_media": {}, "episodes_timesteps_total": 13906, "policy_reward_min": {"policy_0": -1357.0280186033724}, "policy_reward_max": {"policy_0": -76.52624617139203}, "policy_reward_mean": {"policy_0": -701.4929561390414}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-451.5575007492316, -698.0851586532879, -287.37870647513927, -681.4195638665668, -843.3081727523562, -527.4542393843658, -916.6011728549598, -365.95201865977896, -855.6186971567621, -943.4915043588188, -991.7782279144031, -888.7218144842717, -1265.2886560367815, -1018.1567915915687, -861.0866284389771, -239.22157659902143, -504.9849699311824, -1293.1201368039701, -539.114899460474, -921.835484487818, -760.3548953904324, -141.40742882981263, -357.62794895322213, -249.1497859649525, -513.0830971344257, -840.2609245616093, -947.787890356588, -98.49784086266685, -820.1871238213699, -392.0758408250485, -751.2108462538857, -151.7859739701908, -888.9295880188461, -945.9643497487311, -956.6474800850665, -631.3673179978331, -1019.758625215884, -319.07257918482725, -349.94529323742415, -656.5090272672547, -996.5212968955649, -532.3658329816411, -689.630014540429, -1089.8872761988143, -300.7829312839769, -1221.7200599457458, -630.4828574969802, -485.45568067434317, -1044.2583684404387, -535.9680317642875, -1152.9083126454404, -681.3371650730599, -447.9714911201302, -530.4960385129665, -350.01269975273436, -660.3374144148939, -1165.1982032462279, -293.45634525307713, -574.6327322501364, -1357.0280186033724, -599.2244164967666, -877.3149710080265, -802.2617015169069, -1219.9057501717107, -439.45967991413215, -286.53908333075344, -641.1378773777346, -994.2310425516293, -858.9490732481894, -669.3934530443762, -471.4289956430276, -1099.0604162660304, -1225.802637718661, -584.1062348312412, -763.5585964399806, -181.64747208174717, -533.4780042833866, -658.1738617785692, -622.3034060160312, -947.7817351067977, -316.1878921840406, -126.96719729622677, -1174.7428617588776, -76.52624617139203, -980.20806145467, -606.6290374883012, -1146.44717727035, -966.6796265388092, -462.82585030080503, -442.0816270027887, -532.3732191311128, -1099.732954963944, -1104.5261254443394, -812.9222113563186, -285.9130249302552, -147.7396761186688, -900.2408822511907, -973.101128458588, -955.0400881878888, -936.401767335823], "episode_lengths": [150, 150, 83, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 147, 77, 150, 150, 150, 150, 150, 73, 128, 93, 150, 150, 150, 48, 150, 127, 150, 97, 150, 150, 150, 150, 150, 135, 150, 150, 150, 144, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 146, 150, 116, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 66, 150, 81, 150, 150, 150, 150, 125, 109, 150, 150, 150, 150, 94, 91, 150, 150, 150, 150], "policy_policy_0_reward": [-451.5575007492316, -698.0851586532879, -287.37870647513927, -681.4195638665668, -843.3081727523562, -527.4542393843658, -916.6011728549598, -365.95201865977896, -855.6186971567621, -943.4915043588188, -991.7782279144031, -888.7218144842717, -1265.2886560367815, -1018.1567915915687, -861.0866284389771, -239.22157659902143, -504.9849699311824, -1293.1201368039701, -539.114899460474, -921.835484487818, -760.3548953904324, -141.40742882981263, -357.62794895322213, -249.1497859649525, -513.0830971344257, -840.2609245616093, -947.787890356588, -98.49784086266685, -820.1871238213699, -392.0758408250485, -751.2108462538857, -151.7859739701908, -888.9295880188461, -945.9643497487311, -956.6474800850665, -631.3673179978331, -1019.758625215884, -319.07257918482725, -349.94529323742415, -656.5090272672547, -996.5212968955649, -532.3658329816411, -689.630014540429, -1089.8872761988143, -300.7829312839769, -1221.7200599457458, -630.4828574969802, -485.45568067434317, -1044.2583684404387, -535.9680317642875, -1152.9083126454404, -681.3371650730599, -447.9714911201302, -530.4960385129665, -350.01269975273436, -660.3374144148939, -1165.1982032462279, -293.45634525307713, -574.6327322501364, -1357.0280186033724, -599.2244164967666, -877.3149710080265, -802.2617015169069, -1219.9057501717107, -439.45967991413215, -286.53908333075344, -641.1378773777346, -994.2310425516293, -858.9490732481894, -669.3934530443762, -471.4289956430276, -1099.0604162660304, -1225.802637718661, -584.1062348312412, -763.5585964399806, -181.64747208174717, -533.4780042833866, -658.1738617785692, -622.3034060160312, -947.7817351067977, -316.1878921840406, -126.96719729622677, -1174.7428617588776, -76.52624617139203, -980.20806145467, -606.6290374883012, -1146.44717727035, -966.6796265388092, -462.82585030080503, -442.0816270027887, -532.3732191311128, -1099.732954963944, -1104.5261254443394, -812.9222113563186, -285.9130249302552, -147.7396761186688, -900.2408822511907, -973.101128458588, -955.0400881878888, -936.401767335823]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536429770875102, "mean_inference_ms": 1.68832332990517, "mean_action_processing_ms": 0.2825584265508068, "mean_env_wait_ms": 2.9982908145032043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012293815612792969, "StateBufferConnector_ms": 0.008080244064331055, "ViewRequirementAgentConnector_ms": 0.19475460052490234}, "num_episodes": 33, "episode_return_max": -76.52624617139203, "episode_return_min": -1357.0280186033724, "episode_return_mean": -701.4929561390414, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.50067300797724, "num_env_steps_trained_throughput_per_sec": 301.50067300797724, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13215.435, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13215.361, "sample_time_ms": 1027.643, "learn_time_ms": 12118.388, "learn_throughput": 330.077, "synch_weights_time_ms": 68.501}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00015", "date": "2024-08-03_11-41-41", "timestamp": 1722665501, "time_this_iter_s": 13.27936601638794, "time_total_s": 159.2986798286438, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b77f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 159.2986798286438, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 14.07894736842105, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.474282577633858, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.029988401631515, "policy_loss": -0.008251211520594855, "vf_loss": 9.033793561160564, "vf_explained_var": 0.42648315224796535, "kl": 0.015320692714340127, "entropy": 1.5013351591924826, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -76.52624617139203, "episode_reward_min": -1401.6760258775255, "episode_reward_mean": -698.455410165101, "episode_len_mean": 138.65, "episode_media": {}, "episodes_timesteps_total": 13865, "policy_reward_min": {"policy_0": -1401.6760258775255}, "policy_reward_max": {"policy_0": -76.52624617139203}, "policy_reward_mean": {"policy_0": -698.455410165101}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-820.1871238213699, -392.0758408250485, -751.2108462538857, -151.7859739701908, -888.9295880188461, -945.9643497487311, -956.6474800850665, -631.3673179978331, -1019.758625215884, -319.07257918482725, -349.94529323742415, -656.5090272672547, -996.5212968955649, -532.3658329816411, -689.630014540429, -1089.8872761988143, -300.7829312839769, -1221.7200599457458, -630.4828574969802, -485.45568067434317, -1044.2583684404387, -535.9680317642875, -1152.9083126454404, -681.3371650730599, -447.9714911201302, -530.4960385129665, -350.01269975273436, -660.3374144148939, -1165.1982032462279, -293.45634525307713, -574.6327322501364, -1357.0280186033724, -599.2244164967666, -877.3149710080265, -802.2617015169069, -1219.9057501717107, -439.45967991413215, -286.53908333075344, -641.1378773777346, -994.2310425516293, -858.9490732481894, -669.3934530443762, -471.4289956430276, -1099.0604162660304, -1225.802637718661, -584.1062348312412, -763.5585964399806, -181.64747208174717, -533.4780042833866, -658.1738617785692, -622.3034060160312, -947.7817351067977, -316.1878921840406, -126.96719729622677, -1174.7428617588776, -76.52624617139203, -980.20806145467, -606.6290374883012, -1146.44717727035, -966.6796265388092, -462.82585030080503, -442.0816270027887, -532.3732191311128, -1099.732954963944, -1104.5261254443394, -812.9222113563186, -285.9130249302552, -147.7396761186688, -900.2408822511907, -973.101128458588, -955.0400881878888, -936.401767335823, -136.23507440348874, -731.6604722240675, -281.70367513619715, -794.0063307950785, -1338.3693688909593, -181.15801308783804, -703.2163801470359, -408.12332936347406, -1378.0364437861076, -1401.6760258775255, -746.2125253539839, -997.1892452132473, -486.4507241038756, -393.0647780394492, -954.2765708734852, -354.1878825946229, -676.1208288767089, -385.08294191633644, -462.79186259746365, -576.7014631945858, -279.2598141858113, -813.6515697314528, -205.07406404010402, -810.5520703311466, -447.1474492071661, -652.4313308370555, -1291.718441495058, -812.4924590160434], "episode_lengths": [150, 127, 150, 97, 150, 150, 150, 150, 150, 135, 150, 150, 150, 144, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 146, 150, 116, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 66, 150, 81, 150, 150, 150, 150, 125, 109, 150, 150, 150, 150, 94, 91, 150, 150, 150, 150, 62, 150, 150, 150, 150, 101, 150, 105, 150, 150, 150, 150, 106, 150, 150, 93, 150, 112, 150, 150, 79, 150, 99, 150, 122, 148, 150, 150], "policy_policy_0_reward": [-820.1871238213699, -392.0758408250485, -751.2108462538857, -151.7859739701908, -888.9295880188461, -945.9643497487311, -956.6474800850665, -631.3673179978331, -1019.758625215884, -319.07257918482725, -349.94529323742415, -656.5090272672547, -996.5212968955649, -532.3658329816411, -689.630014540429, -1089.8872761988143, -300.7829312839769, -1221.7200599457458, -630.4828574969802, -485.45568067434317, -1044.2583684404387, -535.9680317642875, -1152.9083126454404, -681.3371650730599, -447.9714911201302, -530.4960385129665, -350.01269975273436, -660.3374144148939, -1165.1982032462279, -293.45634525307713, -574.6327322501364, -1357.0280186033724, -599.2244164967666, -877.3149710080265, -802.2617015169069, -1219.9057501717107, -439.45967991413215, -286.53908333075344, -641.1378773777346, -994.2310425516293, -858.9490732481894, -669.3934530443762, -471.4289956430276, -1099.0604162660304, -1225.802637718661, -584.1062348312412, -763.5585964399806, -181.64747208174717, -533.4780042833866, -658.1738617785692, -622.3034060160312, -947.7817351067977, -316.1878921840406, -126.96719729622677, -1174.7428617588776, -76.52624617139203, -980.20806145467, -606.6290374883012, -1146.44717727035, -966.6796265388092, -462.82585030080503, -442.0816270027887, -532.3732191311128, -1099.732954963944, -1104.5261254443394, -812.9222113563186, -285.9130249302552, -147.7396761186688, -900.2408822511907, -973.101128458588, -955.0400881878888, -936.401767335823, -136.23507440348874, -731.6604722240675, -281.70367513619715, -794.0063307950785, -1338.3693688909593, -181.15801308783804, -703.2163801470359, -408.12332936347406, -1378.0364437861076, -1401.6760258775255, -746.2125253539839, -997.1892452132473, -486.4507241038756, -393.0647780394492, -954.2765708734852, -354.1878825946229, -676.1208288767089, -385.08294191633644, -462.79186259746365, -576.7014631945858, -279.2598141858113, -813.6515697314528, -205.07406404010402, -810.5520703311466, -447.1474492071661, -652.4313308370555, -1291.718441495058, -812.4924590160434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530309771467705, "mean_inference_ms": 1.6864993358086011, "mean_action_processing_ms": 0.28206573511594063, "mean_env_wait_ms": 2.9998645473273764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01279902458190918, "StateBufferConnector_ms": 0.007950305938720703, "ViewRequirementAgentConnector_ms": 0.19443607330322266}, "num_episodes": 28, "episode_return_max": -76.52624617139203, "episode_return_min": -1401.6760258775255, "episode_return_mean": -698.455410165101, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.72986579719185, "num_env_steps_trained_throughput_per_sec": 287.72986579719185, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13297.283, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13297.21, "sample_time_ms": 1032.432, "learn_time_ms": 12195.469, "learn_throughput": 327.991, "synch_weights_time_ms": 68.478}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00015", "date": "2024-08-03_11-41-55", "timestamp": 1722665515, "time_this_iter_s": 13.914895057678223, "time_total_s": 173.21357488632202, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444917e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 173.21357488632202, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.621052631578948, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.248306911935408, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.013847159345945, "policy_loss": -0.008783907495671883, "vf_loss": 9.01851117114226, "vf_explained_var": 0.4103276898463567, "kl": 0.014284759166306093, "entropy": 1.6551108993589878, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -76.52624617139203, "episode_reward_min": -1401.6760258775255, "episode_reward_mean": -724.0422978591195, "episode_len_mean": 137.87, "episode_media": {}, "episodes_timesteps_total": 13787, "policy_reward_min": {"policy_0": -1401.6760258775255}, "policy_reward_max": {"policy_0": -76.52624617139203}, "policy_reward_mean": {"policy_0": -724.0422978591195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-293.45634525307713, -574.6327322501364, -1357.0280186033724, -599.2244164967666, -877.3149710080265, -802.2617015169069, -1219.9057501717107, -439.45967991413215, -286.53908333075344, -641.1378773777346, -994.2310425516293, -858.9490732481894, -669.3934530443762, -471.4289956430276, -1099.0604162660304, -1225.802637718661, -584.1062348312412, -763.5585964399806, -181.64747208174717, -533.4780042833866, -658.1738617785692, -622.3034060160312, -947.7817351067977, -316.1878921840406, -126.96719729622677, -1174.7428617588776, -76.52624617139203, -980.20806145467, -606.6290374883012, -1146.44717727035, -966.6796265388092, -462.82585030080503, -442.0816270027887, -532.3732191311128, -1099.732954963944, -1104.5261254443394, -812.9222113563186, -285.9130249302552, -147.7396761186688, -900.2408822511907, -973.101128458588, -955.0400881878888, -936.401767335823, -136.23507440348874, -731.6604722240675, -281.70367513619715, -794.0063307950785, -1338.3693688909593, -181.15801308783804, -703.2163801470359, -408.12332936347406, -1378.0364437861076, -1401.6760258775255, -746.2125253539839, -997.1892452132473, -486.4507241038756, -393.0647780394492, -954.2765708734852, -354.1878825946229, -676.1208288767089, -385.08294191633644, -462.79186259746365, -576.7014631945858, -279.2598141858113, -813.6515697314528, -205.07406404010402, -810.5520703311466, -447.1474492071661, -652.4313308370555, -1291.718441495058, -812.4924590160434, -856.7235217978484, -816.0328252918541, -617.0016876376222, -1171.6570835123798, -303.4633154732457, -1336.6672881165946, -1061.6752274899366, -93.18146579999518, -937.657192341082, -1013.6502754597346, -1197.3208227598793, -177.49738834577124, -611.6392233415004, -1148.5524122158133, -398.9237387351465, -875.498102243799, -1118.6241071045897, -618.501237517827, -940.2137806558188, -1211.3914732536416, -354.7067006876974, -766.8519138690693, -686.3028764194249, -1064.9928141723753, -1051.8225844469694, -630.2212585080923, -194.85025343550754, -611.7962488646151, -1090.0596705180776], "episode_lengths": [116, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 66, 150, 81, 150, 150, 150, 150, 125, 109, 150, 150, 150, 150, 94, 91, 150, 150, 150, 150, 62, 150, 150, 150, 150, 101, 150, 105, 150, 150, 150, 150, 106, 150, 150, 93, 150, 112, 150, 150, 79, 150, 99, 150, 122, 148, 150, 150, 150, 150, 150, 150, 117, 150, 150, 67, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150], "policy_policy_0_reward": [-293.45634525307713, -574.6327322501364, -1357.0280186033724, -599.2244164967666, -877.3149710080265, -802.2617015169069, -1219.9057501717107, -439.45967991413215, -286.53908333075344, -641.1378773777346, -994.2310425516293, -858.9490732481894, -669.3934530443762, -471.4289956430276, -1099.0604162660304, -1225.802637718661, -584.1062348312412, -763.5585964399806, -181.64747208174717, -533.4780042833866, -658.1738617785692, -622.3034060160312, -947.7817351067977, -316.1878921840406, -126.96719729622677, -1174.7428617588776, -76.52624617139203, -980.20806145467, -606.6290374883012, -1146.44717727035, -966.6796265388092, -462.82585030080503, -442.0816270027887, -532.3732191311128, -1099.732954963944, -1104.5261254443394, -812.9222113563186, -285.9130249302552, -147.7396761186688, -900.2408822511907, -973.101128458588, -955.0400881878888, -936.401767335823, -136.23507440348874, -731.6604722240675, -281.70367513619715, -794.0063307950785, -1338.3693688909593, -181.15801308783804, -703.2163801470359, -408.12332936347406, -1378.0364437861076, -1401.6760258775255, -746.2125253539839, -997.1892452132473, -486.4507241038756, -393.0647780394492, -954.2765708734852, -354.1878825946229, -676.1208288767089, -385.08294191633644, -462.79186259746365, -576.7014631945858, -279.2598141858113, -813.6515697314528, -205.07406404010402, -810.5520703311466, -447.1474492071661, -652.4313308370555, -1291.718441495058, -812.4924590160434, -856.7235217978484, -816.0328252918541, -617.0016876376222, -1171.6570835123798, -303.4633154732457, -1336.6672881165946, -1061.6752274899366, -93.18146579999518, -937.657192341082, -1013.6502754597346, -1197.3208227598793, -177.49738834577124, -611.6392233415004, -1148.5524122158133, -398.9237387351465, -875.498102243799, -1118.6241071045897, -618.501237517827, -940.2137806558188, -1211.3914732536416, -354.7067006876974, -766.8519138690693, -686.3028764194249, -1064.9928141723753, -1051.8225844469694, -630.2212585080923, -194.85025343550754, -611.7962488646151, -1090.0596705180776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553329847974032, "mean_inference_ms": 1.6870031042171751, "mean_action_processing_ms": 0.28200246866223416, "mean_env_wait_ms": 3.006589301201479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012699127197265625, "StateBufferConnector_ms": 0.00811147689819336, "ViewRequirementAgentConnector_ms": 0.1953282356262207}, "num_episodes": 29, "episode_return_max": -76.52624617139203, "episode_return_min": -1401.6760258775255, "episode_return_mean": -724.0422978591195, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.4246994248473, "num_env_steps_trained_throughput_per_sec": 361.4246994248473, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13089.447, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13089.375, "sample_time_ms": 1035.225, "learn_time_ms": 11985.434, "learn_throughput": 333.738, "synch_weights_time_ms": 67.895}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00015", "date": "2024-08-03_11-42-06", "timestamp": 1722665526, "time_this_iter_s": 11.079892635345459, "time_total_s": 184.29346752166748, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2445c05e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 184.29346752166748, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 15.025, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.550432107970119, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.270795891682306, "policy_loss": -0.008434455412013146, "vf_loss": 9.275380230446656, "vf_explained_var": 0.4633481208235025, "kl": 0.01341144818070461, "entropy": 1.7332174066454171, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -93.18146579999518, "episode_reward_min": -1401.6760258775255, "episode_reward_mean": -779.9672817255714, "episode_len_mean": 139.84, "episode_media": {}, "episodes_timesteps_total": 13984, "policy_reward_min": {"policy_0": -1401.6760258775255}, "policy_reward_max": {"policy_0": -93.18146579999518}, "policy_reward_mean": {"policy_0": -779.9672817255714}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-980.20806145467, -606.6290374883012, -1146.44717727035, -966.6796265388092, -462.82585030080503, -442.0816270027887, -532.3732191311128, -1099.732954963944, -1104.5261254443394, -812.9222113563186, -285.9130249302552, -147.7396761186688, -900.2408822511907, -973.101128458588, -955.0400881878888, -936.401767335823, -136.23507440348874, -731.6604722240675, -281.70367513619715, -794.0063307950785, -1338.3693688909593, -181.15801308783804, -703.2163801470359, -408.12332936347406, -1378.0364437861076, -1401.6760258775255, -746.2125253539839, -997.1892452132473, -486.4507241038756, -393.0647780394492, -954.2765708734852, -354.1878825946229, -676.1208288767089, -385.08294191633644, -462.79186259746365, -576.7014631945858, -279.2598141858113, -813.6515697314528, -205.07406404010402, -810.5520703311466, -447.1474492071661, -652.4313308370555, -1291.718441495058, -812.4924590160434, -856.7235217978484, -816.0328252918541, -617.0016876376222, -1171.6570835123798, -303.4633154732457, -1336.6672881165946, -1061.6752274899366, -93.18146579999518, -937.657192341082, -1013.6502754597346, -1197.3208227598793, -177.49738834577124, -611.6392233415004, -1148.5524122158133, -398.9237387351465, -875.498102243799, -1118.6241071045897, -618.501237517827, -940.2137806558188, -1211.3914732536416, -354.7067006876974, -766.8519138690693, -686.3028764194249, -1064.9928141723753, -1051.8225844469694, -630.2212585080923, -194.85025343550754, -611.7962488646151, -1090.0596705180776, -1049.4321011967154, -966.8338330423629, -526.1280295416826, -764.645853530281, -1095.3735640822424, -898.017750464197, -751.7108618480331, -1006.2967086947627, -637.8616578610618, -797.7285605161497, -1229.6862858534905, -686.2406303430381, -1167.8535262784146, -654.2977485086365, -511.09342097805285, -1151.944681001239, -1035.1642397196504, -1131.9291493091796, -1269.5080700460612, -137.45349948386473, -1026.5068464292456, -723.4524405581751, -1245.790337176296, -763.4028742100924, -1025.141462053291, -382.5697936179831, -1351.734162643792], "episode_lengths": [150, 150, 150, 150, 125, 109, 150, 150, 150, 150, 94, 91, 150, 150, 150, 150, 62, 150, 150, 150, 150, 101, 150, 105, 150, 150, 150, 150, 106, 150, 150, 93, 150, 112, 150, 150, 79, 150, 99, 150, 122, 148, 150, 150, 150, 150, 150, 150, 117, 150, 150, 67, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 118, 150], "policy_policy_0_reward": [-980.20806145467, -606.6290374883012, -1146.44717727035, -966.6796265388092, -462.82585030080503, -442.0816270027887, -532.3732191311128, -1099.732954963944, -1104.5261254443394, -812.9222113563186, -285.9130249302552, -147.7396761186688, -900.2408822511907, -973.101128458588, -955.0400881878888, -936.401767335823, -136.23507440348874, -731.6604722240675, -281.70367513619715, -794.0063307950785, -1338.3693688909593, -181.15801308783804, -703.2163801470359, -408.12332936347406, -1378.0364437861076, -1401.6760258775255, -746.2125253539839, -997.1892452132473, -486.4507241038756, -393.0647780394492, -954.2765708734852, -354.1878825946229, -676.1208288767089, -385.08294191633644, -462.79186259746365, -576.7014631945858, -279.2598141858113, -813.6515697314528, -205.07406404010402, -810.5520703311466, -447.1474492071661, -652.4313308370555, -1291.718441495058, -812.4924590160434, -856.7235217978484, -816.0328252918541, -617.0016876376222, -1171.6570835123798, -303.4633154732457, -1336.6672881165946, -1061.6752274899366, -93.18146579999518, -937.657192341082, -1013.6502754597346, -1197.3208227598793, -177.49738834577124, -611.6392233415004, -1148.5524122158133, -398.9237387351465, -875.498102243799, -1118.6241071045897, -618.501237517827, -940.2137806558188, -1211.3914732536416, -354.7067006876974, -766.8519138690693, -686.3028764194249, -1064.9928141723753, -1051.8225844469694, -630.2212585080923, -194.85025343550754, -611.7962488646151, -1090.0596705180776, -1049.4321011967154, -966.8338330423629, -526.1280295416826, -764.645853530281, -1095.3735640822424, -898.017750464197, -751.7108618480331, -1006.2967086947627, -637.8616578610618, -797.7285605161497, -1229.6862858534905, -686.2406303430381, -1167.8535262784146, -654.2977485086365, -511.09342097805285, -1151.944681001239, -1035.1642397196504, -1131.9291493091796, -1269.5080700460612, -137.45349948386473, -1026.5068464292456, -723.4524405581751, -1245.790337176296, -763.4028742100924, -1025.141462053291, -382.5697936179831, -1351.734162643792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532727353474072, "mean_inference_ms": 1.6874208218770703, "mean_action_processing_ms": 0.28166135163599054, "mean_env_wait_ms": 3.0119652261948033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012937545776367188, "StateBufferConnector_ms": 0.008241653442382812, "ViewRequirementAgentConnector_ms": 0.1999218463897705}, "num_episodes": 27, "episode_return_max": -93.18146579999518, "episode_return_min": -1401.6760258775255, "episode_return_mean": -779.9672817255714, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.5734535529578, "num_env_steps_trained_throughput_per_sec": 302.5734535529578, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13209.905, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13209.833, "sample_time_ms": 1035.108, "learn_time_ms": 12105.21, "learn_throughput": 330.436, "synch_weights_time_ms": 68.693}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00015", "date": "2024-08-03_11-42-19", "timestamp": 1722665539, "time_this_iter_s": 13.233185529708862, "time_total_s": 197.52665305137634, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b6560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 197.52665305137634, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 14.147368421052635, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.732188825433452, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.960234195490678, "policy_loss": -0.013025952203315682, "vf_loss": 8.968323616186778, "vf_explained_var": 0.6035597870126367, "kl": 0.017033103815371455, "entropy": 1.7340687898298104, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -85.24748793781366, "episode_reward_min": -1353.3832406235251, "episode_reward_mean": -782.0889050061593, "episode_len_mean": 140.58, "episode_media": {}, "episodes_timesteps_total": 14058, "policy_reward_min": {"policy_0": -1353.3832406235251}, "policy_reward_max": {"policy_0": -85.24748793781366}, "policy_reward_mean": {"policy_0": -782.0889050061593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-486.4507241038756, -393.0647780394492, -954.2765708734852, -354.1878825946229, -676.1208288767089, -385.08294191633644, -462.79186259746365, -576.7014631945858, -279.2598141858113, -813.6515697314528, -205.07406404010402, -810.5520703311466, -447.1474492071661, -652.4313308370555, -1291.718441495058, -812.4924590160434, -856.7235217978484, -816.0328252918541, -617.0016876376222, -1171.6570835123798, -303.4633154732457, -1336.6672881165946, -1061.6752274899366, -93.18146579999518, -937.657192341082, -1013.6502754597346, -1197.3208227598793, -177.49738834577124, -611.6392233415004, -1148.5524122158133, -398.9237387351465, -875.498102243799, -1118.6241071045897, -618.501237517827, -940.2137806558188, -1211.3914732536416, -354.7067006876974, -766.8519138690693, -686.3028764194249, -1064.9928141723753, -1051.8225844469694, -630.2212585080923, -194.85025343550754, -611.7962488646151, -1090.0596705180776, -1049.4321011967154, -966.8338330423629, -526.1280295416826, -764.645853530281, -1095.3735640822424, -898.017750464197, -751.7108618480331, -1006.2967086947627, -637.8616578610618, -797.7285605161497, -1229.6862858534905, -686.2406303430381, -1167.8535262784146, -654.2977485086365, -511.09342097805285, -1151.944681001239, -1035.1642397196504, -1131.9291493091796, -1269.5080700460612, -137.45349948386473, -1026.5068464292456, -723.4524405581751, -1245.790337176296, -763.4028742100924, -1025.141462053291, -382.5697936179831, -1351.734162643792, -419.9158445421588, -693.9643965603644, -916.5005218458224, -146.17564531267152, -839.5098881303654, -969.5335247800168, -695.0031840810426, -1277.0452018284407, -932.7086759705871, -1033.444903294205, -437.1477746921709, -519.6397355975557, -198.80090020802066, -719.1973204225847, -974.4915251772532, -767.8583873348144, -1252.4578985058392, -1094.6861254771957, -638.4718720977429, -1016.7269037463388, -85.24748793781366, -1107.684107083164, -549.3839243042981, -1103.966810655197, -178.50758810502515, -978.5665629248119, -1353.3832406235251, -762.5917193326273], "episode_lengths": [106, 150, 150, 93, 150, 112, 150, 150, 79, 150, 99, 150, 122, 148, 150, 150, 150, 150, 150, 150, 117, 150, 150, 67, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 118, 150, 132, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 92, 150, 150, 150], "policy_policy_0_reward": [-486.4507241038756, -393.0647780394492, -954.2765708734852, -354.1878825946229, -676.1208288767089, -385.08294191633644, -462.79186259746365, -576.7014631945858, -279.2598141858113, -813.6515697314528, -205.07406404010402, -810.5520703311466, -447.1474492071661, -652.4313308370555, -1291.718441495058, -812.4924590160434, -856.7235217978484, -816.0328252918541, -617.0016876376222, -1171.6570835123798, -303.4633154732457, -1336.6672881165946, -1061.6752274899366, -93.18146579999518, -937.657192341082, -1013.6502754597346, -1197.3208227598793, -177.49738834577124, -611.6392233415004, -1148.5524122158133, -398.9237387351465, -875.498102243799, -1118.6241071045897, -618.501237517827, -940.2137806558188, -1211.3914732536416, -354.7067006876974, -766.8519138690693, -686.3028764194249, -1064.9928141723753, -1051.8225844469694, -630.2212585080923, -194.85025343550754, -611.7962488646151, -1090.0596705180776, -1049.4321011967154, -966.8338330423629, -526.1280295416826, -764.645853530281, -1095.3735640822424, -898.017750464197, -751.7108618480331, -1006.2967086947627, -637.8616578610618, -797.7285605161497, -1229.6862858534905, -686.2406303430381, -1167.8535262784146, -654.2977485086365, -511.09342097805285, -1151.944681001239, -1035.1642397196504, -1131.9291493091796, -1269.5080700460612, -137.45349948386473, -1026.5068464292456, -723.4524405581751, -1245.790337176296, -763.4028742100924, -1025.141462053291, -382.5697936179831, -1351.734162643792, -419.9158445421588, -693.9643965603644, -916.5005218458224, -146.17564531267152, -839.5098881303654, -969.5335247800168, -695.0031840810426, -1277.0452018284407, -932.7086759705871, -1033.444903294205, -437.1477746921709, -519.6397355975557, -198.80090020802066, -719.1973204225847, -974.4915251772532, -767.8583873348144, -1252.4578985058392, -1094.6861254771957, -638.4718720977429, -1016.7269037463388, -85.24748793781366, -1107.684107083164, -549.3839243042981, -1103.966810655197, -178.50758810502515, -978.5665629248119, -1353.3832406235251, -762.5917193326273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531157848332189, "mean_inference_ms": 1.6882119994927873, "mean_action_processing_ms": 0.28156673868880316, "mean_env_wait_ms": 3.020142059658235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012881755828857422, "StateBufferConnector_ms": 0.00827932357788086, "ViewRequirementAgentConnector_ms": 0.20156574249267578}, "num_episodes": 28, "episode_return_max": -85.24748793781366, "episode_return_min": -1353.3832406235251, "episode_return_mean": -782.0889050061593, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.2263243288989, "num_env_steps_trained_throughput_per_sec": 297.2263243288989, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13181.574, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13181.499, "sample_time_ms": 1040.579, "learn_time_ms": 12071.335, "learn_throughput": 331.364, "synch_weights_time_ms": 68.755}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00015", "date": "2024-08-03_11-42-33", "timestamp": 1722665553, "time_this_iter_s": 13.471389770507812, "time_total_s": 210.99804282188416, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b4dc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 210.99804282188416, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.894736842105264, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.529106068486968, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.525653326511383, "policy_loss": -0.014948218683033095, "vf_loss": 8.53506714105606, "vf_explained_var": 0.5664411448563139, "kl": 0.01894673547036899, "entropy": 1.4961152204622825, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -48.29166900212104, "episode_reward_min": -1381.602880566352, "episode_reward_mean": -799.9183884087731, "episode_len_mean": 141.01, "episode_media": {}, "episodes_timesteps_total": 14101, "policy_reward_min": {"policy_0": -1381.602880566352}, "policy_reward_max": {"policy_0": -48.29166900212104}, "policy_reward_mean": {"policy_0": -799.9183884087731}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-611.6392233415004, -1148.5524122158133, -398.9237387351465, -875.498102243799, -1118.6241071045897, -618.501237517827, -940.2137806558188, -1211.3914732536416, -354.7067006876974, -766.8519138690693, -686.3028764194249, -1064.9928141723753, -1051.8225844469694, -630.2212585080923, -194.85025343550754, -611.7962488646151, -1090.0596705180776, -1049.4321011967154, -966.8338330423629, -526.1280295416826, -764.645853530281, -1095.3735640822424, -898.017750464197, -751.7108618480331, -1006.2967086947627, -637.8616578610618, -797.7285605161497, -1229.6862858534905, -686.2406303430381, -1167.8535262784146, -654.2977485086365, -511.09342097805285, -1151.944681001239, -1035.1642397196504, -1131.9291493091796, -1269.5080700460612, -137.45349948386473, -1026.5068464292456, -723.4524405581751, -1245.790337176296, -763.4028742100924, -1025.141462053291, -382.5697936179831, -1351.734162643792, -419.9158445421588, -693.9643965603644, -916.5005218458224, -146.17564531267152, -839.5098881303654, -969.5335247800168, -695.0031840810426, -1277.0452018284407, -932.7086759705871, -1033.444903294205, -437.1477746921709, -519.6397355975557, -198.80090020802066, -719.1973204225847, -974.4915251772532, -767.8583873348144, -1252.4578985058392, -1094.6861254771957, -638.4718720977429, -1016.7269037463388, -85.24748793781366, -1107.684107083164, -549.3839243042981, -1103.966810655197, -178.50758810502515, -978.5665629248119, -1353.3832406235251, -762.5917193326273, -578.3529191741432, -225.05522827320817, -99.20443285314995, -587.8355510675161, -456.245465474082, -652.8287369682866, -1076.525851097643, -391.3072101491999, -435.4541167497968, -1034.008412149839, -1109.97494391247, -450.5820017252155, -405.99482734993546, -171.69656432587902, -821.4964174628428, -48.29166900212104, -911.6753322908476, -910.1620166385432, -1028.0348453778065, -1310.4191850958575, -1062.1949722216455, -979.6062537252366, -1151.7660124683036, -794.6066427187648, -1381.602880566352, -341.3703381539871, -1360.3476978494366, -1189.8401604855896], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 118, 150, 132, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 92, 150, 150, 150, 150, 74, 86, 150, 150, 140, 150, 115, 110, 150, 150, 113, 150, 62, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-611.6392233415004, -1148.5524122158133, -398.9237387351465, -875.498102243799, -1118.6241071045897, -618.501237517827, -940.2137806558188, -1211.3914732536416, -354.7067006876974, -766.8519138690693, -686.3028764194249, -1064.9928141723753, -1051.8225844469694, -630.2212585080923, -194.85025343550754, -611.7962488646151, -1090.0596705180776, -1049.4321011967154, -966.8338330423629, -526.1280295416826, -764.645853530281, -1095.3735640822424, -898.017750464197, -751.7108618480331, -1006.2967086947627, -637.8616578610618, -797.7285605161497, -1229.6862858534905, -686.2406303430381, -1167.8535262784146, -654.2977485086365, -511.09342097805285, -1151.944681001239, -1035.1642397196504, -1131.9291493091796, -1269.5080700460612, -137.45349948386473, -1026.5068464292456, -723.4524405581751, -1245.790337176296, -763.4028742100924, -1025.141462053291, -382.5697936179831, -1351.734162643792, -419.9158445421588, -693.9643965603644, -916.5005218458224, -146.17564531267152, -839.5098881303654, -969.5335247800168, -695.0031840810426, -1277.0452018284407, -932.7086759705871, -1033.444903294205, -437.1477746921709, -519.6397355975557, -198.80090020802066, -719.1973204225847, -974.4915251772532, -767.8583873348144, -1252.4578985058392, -1094.6861254771957, -638.4718720977429, -1016.7269037463388, -85.24748793781366, -1107.684107083164, -549.3839243042981, -1103.966810655197, -178.50758810502515, -978.5665629248119, -1353.3832406235251, -762.5917193326273, -578.3529191741432, -225.05522827320817, -99.20443285314995, -587.8355510675161, -456.245465474082, -652.8287369682866, -1076.525851097643, -391.3072101491999, -435.4541167497968, -1034.008412149839, -1109.97494391247, -450.5820017252155, -405.99482734993546, -171.69656432587902, -821.4964174628428, -48.29166900212104, -911.6753322908476, -910.1620166385432, -1028.0348453778065, -1310.4191850958575, -1062.1949722216455, -979.6062537252366, -1151.7660124683036, -794.6066427187648, -1381.602880566352, -341.3703381539871, -1360.3476978494366, -1189.8401604855896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526206770987306, "mean_inference_ms": 1.6892567580069948, "mean_action_processing_ms": 0.2815812615954281, "mean_env_wait_ms": 3.0268738409934333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012444496154785156, "StateBufferConnector_ms": 0.008363485336303711, "ViewRequirementAgentConnector_ms": 0.2041170597076416}, "num_episodes": 28, "episode_return_max": -48.29166900212104, "episode_return_min": -1381.602880566352, "episode_return_mean": -799.9183884087731, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.987246513572, "num_env_steps_trained_throughput_per_sec": 295.987246513572, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13181.558, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13181.483, "sample_time_ms": 1041.225, "learn_time_ms": 12071.106, "learn_throughput": 331.37, "synch_weights_time_ms": 68.33}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00015", "date": "2024-08-03_11-42-46", "timestamp": 1722665566, "time_this_iter_s": 13.525456666946411, "time_total_s": 224.52349948883057, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b60e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 224.52349948883057, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.594999999999999, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.611005672564108, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.546410510440667, "policy_loss": -0.006911885045216574, "vf_loss": 8.54822096725305, "vf_explained_var": 0.6876260027910273, "kl": 0.017521639226652064, "entropy": 1.5505549408495427, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 2.2782194787001346, "episode_reward_min": -1381.602880566352, "episode_reward_mean": -749.4854341452484, "episode_len_mean": 136.3, "episode_media": {}, "episodes_timesteps_total": 13630, "policy_reward_min": {"policy_0": -1381.602880566352}, "policy_reward_max": {"policy_0": 2.2782194787001346}, "policy_reward_mean": {"policy_0": -749.4854341452484}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1151.944681001239, -1035.1642397196504, -1131.9291493091796, -1269.5080700460612, -137.45349948386473, -1026.5068464292456, -723.4524405581751, -1245.790337176296, -763.4028742100924, -1025.141462053291, -382.5697936179831, -1351.734162643792, -419.9158445421588, -693.9643965603644, -916.5005218458224, -146.17564531267152, -839.5098881303654, -969.5335247800168, -695.0031840810426, -1277.0452018284407, -932.7086759705871, -1033.444903294205, -437.1477746921709, -519.6397355975557, -198.80090020802066, -719.1973204225847, -974.4915251772532, -767.8583873348144, -1252.4578985058392, -1094.6861254771957, -638.4718720977429, -1016.7269037463388, -85.24748793781366, -1107.684107083164, -549.3839243042981, -1103.966810655197, -178.50758810502515, -978.5665629248119, -1353.3832406235251, -762.5917193326273, -578.3529191741432, -225.05522827320817, -99.20443285314995, -587.8355510675161, -456.245465474082, -652.8287369682866, -1076.525851097643, -391.3072101491999, -435.4541167497968, -1034.008412149839, -1109.97494391247, -450.5820017252155, -405.99482734993546, -171.69656432587902, -821.4964174628428, -48.29166900212104, -911.6753322908476, -910.1620166385432, -1028.0348453778065, -1310.4191850958575, -1062.1949722216455, -979.6062537252366, -1151.7660124683036, -794.6066427187648, -1381.602880566352, -341.3703381539871, -1360.3476978494366, -1189.8401604855896, -938.7900089357935, -816.1411717734105, -671.8927811331498, -629.0549088098369, -930.824744623896, -604.3322157270449, -1176.1929079823765, -507.32552462765835, -17.440270148498318, -143.1759505750556, -883.1239595479083, -1138.5705027321283, -1218.451209094392, -622.0145005501283, -808.0322673406865, -903.1134419490409, -660.6937433437498, -919.587090857025, -18.754261337027227, -354.0012081209178, -607.3473748120011, -931.8512773372155, 2.2782194787001346, -767.5047558877161, -553.0053965161276, -1076.6908178666108, -253.62333704775182, -1020.3788844547546, -166.73840193271636, -576.0235164831051, -439.2386260500451, -723.2166642575528], "episode_lengths": [150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 118, 150, 132, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 92, 150, 150, 150, 150, 74, 86, 150, 150, 140, 150, 115, 110, 150, 150, 113, 150, 62, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 50, 84, 150, 150, 150, 143, 150, 150, 150, 150, 59, 130, 150, 150, 36, 150, 150, 150, 83, 150, 84, 150, 137, 150], "policy_policy_0_reward": [-1151.944681001239, -1035.1642397196504, -1131.9291493091796, -1269.5080700460612, -137.45349948386473, -1026.5068464292456, -723.4524405581751, -1245.790337176296, -763.4028742100924, -1025.141462053291, -382.5697936179831, -1351.734162643792, -419.9158445421588, -693.9643965603644, -916.5005218458224, -146.17564531267152, -839.5098881303654, -969.5335247800168, -695.0031840810426, -1277.0452018284407, -932.7086759705871, -1033.444903294205, -437.1477746921709, -519.6397355975557, -198.80090020802066, -719.1973204225847, -974.4915251772532, -767.8583873348144, -1252.4578985058392, -1094.6861254771957, -638.4718720977429, -1016.7269037463388, -85.24748793781366, -1107.684107083164, -549.3839243042981, -1103.966810655197, -178.50758810502515, -978.5665629248119, -1353.3832406235251, -762.5917193326273, -578.3529191741432, -225.05522827320817, -99.20443285314995, -587.8355510675161, -456.245465474082, -652.8287369682866, -1076.525851097643, -391.3072101491999, -435.4541167497968, -1034.008412149839, -1109.97494391247, -450.5820017252155, -405.99482734993546, -171.69656432587902, -821.4964174628428, -48.29166900212104, -911.6753322908476, -910.1620166385432, -1028.0348453778065, -1310.4191850958575, -1062.1949722216455, -979.6062537252366, -1151.7660124683036, -794.6066427187648, -1381.602880566352, -341.3703381539871, -1360.3476978494366, -1189.8401604855896, -938.7900089357935, -816.1411717734105, -671.8927811331498, -629.0549088098369, -930.824744623896, -604.3322157270449, -1176.1929079823765, -507.32552462765835, -17.440270148498318, -143.1759505750556, -883.1239595479083, -1138.5705027321283, -1218.451209094392, -622.0145005501283, -808.0322673406865, -903.1134419490409, -660.6937433437498, -919.587090857025, -18.754261337027227, -354.0012081209178, -607.3473748120011, -931.8512773372155, 2.2782194787001346, -767.5047558877161, -553.0053965161276, -1076.6908178666108, -253.62333704775182, -1020.3788844547546, -166.73840193271636, -576.0235164831051, -439.2386260500451, -723.2166642575528]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525351506479262, "mean_inference_ms": 1.6900555338237364, "mean_action_processing_ms": 0.28131240840308996, "mean_env_wait_ms": 3.0347950705996594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012717723846435547, "StateBufferConnector_ms": 0.008186578750610352, "ViewRequirementAgentConnector_ms": 0.2045423984527588}, "num_episodes": 32, "episode_return_max": 2.2782194787001346, "episode_return_min": -1381.602880566352, "episode_return_mean": -749.4854341452484, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.7215845287582, "num_env_steps_trained_throughput_per_sec": 294.7215845287582, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13235.523, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13235.444, "sample_time_ms": 1046.793, "learn_time_ms": 12120.303, "learn_throughput": 330.025, "synch_weights_time_ms": 67.526}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00015", "date": "2024-08-03_11-43-00", "timestamp": 1722665580, "time_this_iter_s": 13.58665657043457, "time_total_s": 238.11015605926514, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b7be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 238.11015605926514, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.810526315789476, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.15819862236579, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.296872702240943, "policy_loss": -0.007396534158033319, "vf_loss": 8.300147168338299, "vf_explained_var": 0.600955216648678, "kl": 0.014260909977868648, "entropy": 1.561956742654244, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": 2.2782194787001346, "episode_reward_min": -1381.602880566352, "episode_reward_mean": -759.3040053241947, "episode_len_mean": 137.01, "episode_media": {}, "episodes_timesteps_total": 13701, "policy_reward_min": {"policy_0": -1381.602880566352}, "policy_reward_max": {"policy_0": 2.2782194787001346}, "policy_reward_mean": {"policy_0": -759.3040053241947}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1252.4578985058392, -1094.6861254771957, -638.4718720977429, -1016.7269037463388, -85.24748793781366, -1107.684107083164, -549.3839243042981, -1103.966810655197, -178.50758810502515, -978.5665629248119, -1353.3832406235251, -762.5917193326273, -578.3529191741432, -225.05522827320817, -99.20443285314995, -587.8355510675161, -456.245465474082, -652.8287369682866, -1076.525851097643, -391.3072101491999, -435.4541167497968, -1034.008412149839, -1109.97494391247, -450.5820017252155, -405.99482734993546, -171.69656432587902, -821.4964174628428, -48.29166900212104, -911.6753322908476, -910.1620166385432, -1028.0348453778065, -1310.4191850958575, -1062.1949722216455, -979.6062537252366, -1151.7660124683036, -794.6066427187648, -1381.602880566352, -341.3703381539871, -1360.3476978494366, -1189.8401604855896, -938.7900089357935, -816.1411717734105, -671.8927811331498, -629.0549088098369, -930.824744623896, -604.3322157270449, -1176.1929079823765, -507.32552462765835, -17.440270148498318, -143.1759505750556, -883.1239595479083, -1138.5705027321283, -1218.451209094392, -622.0145005501283, -808.0322673406865, -903.1134419490409, -660.6937433437498, -919.587090857025, -18.754261337027227, -354.0012081209178, -607.3473748120011, -931.8512773372155, 2.2782194787001346, -767.5047558877161, -553.0053965161276, -1076.6908178666108, -253.62333704775182, -1020.3788844547546, -166.73840193271636, -576.0235164831051, -439.2386260500451, -723.2166642575528, -590.3279437810635, -474.3258258489877, -1119.077001705435, -1240.8599616640888, -1013.3202839998271, -175.83547662348172, -1269.2753582596736, -608.4999252933036, -133.13365532546464, -942.0376302983183, -639.4517548120295, -488.93463101055363, -818.9580332390047, -1293.2835379617159, -1372.5866629499963, -1291.0817454412074, -1022.5792419825804, -854.2630014939763, -702.1579541131521, -1291.6538977876432, -1052.4570018074317, -1160.0807882848208, -642.111745080118, -352.0973149984985, -495.3019410646129, -1281.727240666142, -932.2527953916419, -509.7197530368139], "episode_lengths": [150, 150, 150, 150, 63, 150, 150, 150, 92, 150, 150, 150, 150, 74, 86, 150, 150, 140, 150, 115, 110, 150, 150, 113, 150, 62, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 50, 84, 150, 150, 150, 143, 150, 150, 150, 150, 59, 130, 150, 150, 36, 150, 150, 150, 83, 150, 84, 150, 137, 150, 150, 150, 150, 150, 150, 101, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 112, 150, 150, 150, 150], "policy_policy_0_reward": [-1252.4578985058392, -1094.6861254771957, -638.4718720977429, -1016.7269037463388, -85.24748793781366, -1107.684107083164, -549.3839243042981, -1103.966810655197, -178.50758810502515, -978.5665629248119, -1353.3832406235251, -762.5917193326273, -578.3529191741432, -225.05522827320817, -99.20443285314995, -587.8355510675161, -456.245465474082, -652.8287369682866, -1076.525851097643, -391.3072101491999, -435.4541167497968, -1034.008412149839, -1109.97494391247, -450.5820017252155, -405.99482734993546, -171.69656432587902, -821.4964174628428, -48.29166900212104, -911.6753322908476, -910.1620166385432, -1028.0348453778065, -1310.4191850958575, -1062.1949722216455, -979.6062537252366, -1151.7660124683036, -794.6066427187648, -1381.602880566352, -341.3703381539871, -1360.3476978494366, -1189.8401604855896, -938.7900089357935, -816.1411717734105, -671.8927811331498, -629.0549088098369, -930.824744623896, -604.3322157270449, -1176.1929079823765, -507.32552462765835, -17.440270148498318, -143.1759505750556, -883.1239595479083, -1138.5705027321283, -1218.451209094392, -622.0145005501283, -808.0322673406865, -903.1134419490409, -660.6937433437498, -919.587090857025, -18.754261337027227, -354.0012081209178, -607.3473748120011, -931.8512773372155, 2.2782194787001346, -767.5047558877161, -553.0053965161276, -1076.6908178666108, -253.62333704775182, -1020.3788844547546, -166.73840193271636, -576.0235164831051, -439.2386260500451, -723.2166642575528, -590.3279437810635, -474.3258258489877, -1119.077001705435, -1240.8599616640888, -1013.3202839998271, -175.83547662348172, -1269.2753582596736, -608.4999252933036, -133.13365532546464, -942.0376302983183, -639.4517548120295, -488.93463101055363, -818.9580332390047, -1293.2835379617159, -1372.5866629499963, -1291.0817454412074, -1022.5792419825804, -854.2630014939763, -702.1579541131521, -1291.6538977876432, -1052.4570018074317, -1160.0807882848208, -642.111745080118, -352.0973149984985, -495.3019410646129, -1281.727240666142, -932.2527953916419, -509.7197530368139]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520209292358129, "mean_inference_ms": 1.6887445243375248, "mean_action_processing_ms": 0.2809646233748247, "mean_env_wait_ms": 3.038109050899217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012659072875976562, "StateBufferConnector_ms": 0.00811147689819336, "ViewRequirementAgentConnector_ms": 0.20251846313476562}, "num_episodes": 28, "episode_return_max": 2.2782194787001346, "episode_return_min": -1381.602880566352, "episode_return_mean": -759.3040053241947, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.77497058725135, "num_env_steps_trained_throughput_per_sec": 310.77497058725135, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13167.905, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13167.826, "sample_time_ms": 1050.208, "learn_time_ms": 12050.699, "learn_throughput": 331.931, "synch_weights_time_ms": 66.093}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00015", "date": "2024-08-03_11-43-13", "timestamp": 1722665593, "time_this_iter_s": 12.883966445922852, "time_total_s": 250.994122505188, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b53f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 250.994122505188, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 14.15, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.548511547843614, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.812014654775461, "policy_loss": -0.009080994345034317, "vf_loss": 7.81613892018795, "vf_explained_var": 0.70697684250772, "kl": 0.017034943958060468, "entropy": 1.5372496693084636, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 2.2782194787001346, "episode_reward_min": -1381.602880566352, "episode_reward_mean": -760.1110027033375, "episode_len_mean": 139.31, "episode_media": {}, "episodes_timesteps_total": 13931, "policy_reward_min": {"policy_0": -1381.602880566352}, "policy_reward_max": {"policy_0": 2.2782194787001346}, "policy_reward_mean": {"policy_0": -760.1110027033375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1062.1949722216455, -979.6062537252366, -1151.7660124683036, -794.6066427187648, -1381.602880566352, -341.3703381539871, -1360.3476978494366, -1189.8401604855896, -938.7900089357935, -816.1411717734105, -671.8927811331498, -629.0549088098369, -930.824744623896, -604.3322157270449, -1176.1929079823765, -507.32552462765835, -17.440270148498318, -143.1759505750556, -883.1239595479083, -1138.5705027321283, -1218.451209094392, -622.0145005501283, -808.0322673406865, -903.1134419490409, -660.6937433437498, -919.587090857025, -18.754261337027227, -354.0012081209178, -607.3473748120011, -931.8512773372155, 2.2782194787001346, -767.5047558877161, -553.0053965161276, -1076.6908178666108, -253.62333704775182, -1020.3788844547546, -166.73840193271636, -576.0235164831051, -439.2386260500451, -723.2166642575528, -590.3279437810635, -474.3258258489877, -1119.077001705435, -1240.8599616640888, -1013.3202839998271, -175.83547662348172, -1269.2753582596736, -608.4999252933036, -133.13365532546464, -942.0376302983183, -639.4517548120295, -488.93463101055363, -818.9580332390047, -1293.2835379617159, -1372.5866629499963, -1291.0817454412074, -1022.5792419825804, -854.2630014939763, -702.1579541131521, -1291.6538977876432, -1052.4570018074317, -1160.0807882848208, -642.111745080118, -352.0973149984985, -495.3019410646129, -1281.727240666142, -932.2527953916419, -509.7197530368139, -992.3222504657924, -1316.1274730501166, -873.6750991568625, -204.68751893597405, -646.1248091076185, -325.2418917030289, -169.06314075688044, -687.4419607757537, -1205.342805929512, -1134.8046796151887, -817.5307244833639, -835.7548026808039, -100.39346646380135, -1038.5662379434507, -32.88391633873716, -645.7472860433561, -878.6492149330463, -678.0206952047566, -598.0313452419812, -552.8448330457094, -741.7892429606482, -725.6589929824509, -851.3842863087632, -630.4161940976102, -982.654069211197, -486.21888728507486, -1338.446481865364, -283.22888248880315, -763.2204982455941, -847.4809255163285, -591.9222710696012, -931.8448219390626], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 50, 84, 150, 150, 150, 143, 150, 150, 150, 150, 59, 130, 150, 150, 36, 150, 150, 150, 83, 150, 84, 150, 137, 150, 150, 150, 150, 150, 150, 101, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 103, 150, 150, 150, 150, 150, 58, 150, 51, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150], "policy_policy_0_reward": [-1062.1949722216455, -979.6062537252366, -1151.7660124683036, -794.6066427187648, -1381.602880566352, -341.3703381539871, -1360.3476978494366, -1189.8401604855896, -938.7900089357935, -816.1411717734105, -671.8927811331498, -629.0549088098369, -930.824744623896, -604.3322157270449, -1176.1929079823765, -507.32552462765835, -17.440270148498318, -143.1759505750556, -883.1239595479083, -1138.5705027321283, -1218.451209094392, -622.0145005501283, -808.0322673406865, -903.1134419490409, -660.6937433437498, -919.587090857025, -18.754261337027227, -354.0012081209178, -607.3473748120011, -931.8512773372155, 2.2782194787001346, -767.5047558877161, -553.0053965161276, -1076.6908178666108, -253.62333704775182, -1020.3788844547546, -166.73840193271636, -576.0235164831051, -439.2386260500451, -723.2166642575528, -590.3279437810635, -474.3258258489877, -1119.077001705435, -1240.8599616640888, -1013.3202839998271, -175.83547662348172, -1269.2753582596736, -608.4999252933036, -133.13365532546464, -942.0376302983183, -639.4517548120295, -488.93463101055363, -818.9580332390047, -1293.2835379617159, -1372.5866629499963, -1291.0817454412074, -1022.5792419825804, -854.2630014939763, -702.1579541131521, -1291.6538977876432, -1052.4570018074317, -1160.0807882848208, -642.111745080118, -352.0973149984985, -495.3019410646129, -1281.727240666142, -932.2527953916419, -509.7197530368139, -992.3222504657924, -1316.1274730501166, -873.6750991568625, -204.68751893597405, -646.1248091076185, -325.2418917030289, -169.06314075688044, -687.4419607757537, -1205.342805929512, -1134.8046796151887, -817.5307244833639, -835.7548026808039, -100.39346646380135, -1038.5662379434507, -32.88391633873716, -645.7472860433561, -878.6492149330463, -678.0206952047566, -598.0313452419812, -552.8448330457094, -741.7892429606482, -725.6589929824509, -851.3842863087632, -630.4161940976102, -982.654069211197, -486.21888728507486, -1338.446481865364, -283.22888248880315, -763.2204982455941, -847.4809255163285, -591.9222710696012, -931.8448219390626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5521290541473278, "mean_inference_ms": 1.6882449762388096, "mean_action_processing_ms": 0.28082924071435306, "mean_env_wait_ms": 3.042384518930329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012799263000488281, "StateBufferConnector_ms": 0.008039712905883789, "ViewRequirementAgentConnector_ms": 0.2011406421661377}, "num_episodes": 32, "episode_return_max": 2.2782194787001346, "episode_return_min": -1381.602880566352, "episode_return_mean": -760.1110027033375, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.3417766660035, "num_env_steps_trained_throughput_per_sec": 291.3417766660035, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13196.419, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13196.339, "sample_time_ms": 1051.471, "learn_time_ms": 12078.622, "learn_throughput": 331.164, "synch_weights_time_ms": 65.416}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00015", "date": "2024-08-03_11-43-27", "timestamp": 1722665607, "time_this_iter_s": 13.743449687957764, "time_total_s": 264.73757219314575, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b6050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 264.73757219314575, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.585000000000003, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.255311897397043, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.813771076997122, "policy_loss": -0.011031452020203385, "vf_loss": 7.818858920534452, "vf_explained_var": 0.6836111837377151, "kl": 0.02030677549118991, "entropy": 1.4844514160106579, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": 2.2782194787001346, "episode_reward_min": -1372.5866629499963, "episode_reward_mean": -749.8419239333148, "episode_len_mean": 139.83, "episode_media": {}, "episodes_timesteps_total": 13983, "policy_reward_min": {"policy_0": -1372.5866629499963}, "policy_reward_max": {"policy_0": 2.2782194787001346}, "policy_reward_mean": {"policy_0": -749.8419239333148}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-354.0012081209178, -607.3473748120011, -931.8512773372155, 2.2782194787001346, -767.5047558877161, -553.0053965161276, -1076.6908178666108, -253.62333704775182, -1020.3788844547546, -166.73840193271636, -576.0235164831051, -439.2386260500451, -723.2166642575528, -590.3279437810635, -474.3258258489877, -1119.077001705435, -1240.8599616640888, -1013.3202839998271, -175.83547662348172, -1269.2753582596736, -608.4999252933036, -133.13365532546464, -942.0376302983183, -639.4517548120295, -488.93463101055363, -818.9580332390047, -1293.2835379617159, -1372.5866629499963, -1291.0817454412074, -1022.5792419825804, -854.2630014939763, -702.1579541131521, -1291.6538977876432, -1052.4570018074317, -1160.0807882848208, -642.111745080118, -352.0973149984985, -495.3019410646129, -1281.727240666142, -932.2527953916419, -509.7197530368139, -992.3222504657924, -1316.1274730501166, -873.6750991568625, -204.68751893597405, -646.1248091076185, -325.2418917030289, -169.06314075688044, -687.4419607757537, -1205.342805929512, -1134.8046796151887, -817.5307244833639, -835.7548026808039, -100.39346646380135, -1038.5662379434507, -32.88391633873716, -645.7472860433561, -878.6492149330463, -678.0206952047566, -598.0313452419812, -552.8448330457094, -741.7892429606482, -725.6589929824509, -851.3842863087632, -630.4161940976102, -982.654069211197, -486.21888728507486, -1338.446481865364, -283.22888248880315, -763.2204982455941, -847.4809255163285, -591.9222710696012, -931.8448219390626, -258.270555694955, -1091.2709740206026, -628.7797130643088, -715.2572245452552, -477.7919820004091, -537.3780014876274, -672.103888496937, -1260.5801869572874, -680.0062205927677, -1225.0081301343716, -77.59177815647777, -815.3631061587245, -1002.4055119801067, -733.57645889924, -1006.0623359808777, -128.32018066853104, -1139.0388692618628, -562.5571997683157, -1070.8292382286998, -708.1573029104173, -598.8188508404107, -633.0793258212353, -1003.8421910999842, -656.9336088850216, -1066.9010433682117, -1128.9969082464747, -963.0177550067348], "episode_lengths": [130, 150, 150, 36, 150, 150, 150, 83, 150, 84, 150, 137, 150, 150, 150, 150, 150, 150, 101, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 103, 150, 150, 150, 150, 150, 58, 150, 51, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 55, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-354.0012081209178, -607.3473748120011, -931.8512773372155, 2.2782194787001346, -767.5047558877161, -553.0053965161276, -1076.6908178666108, -253.62333704775182, -1020.3788844547546, -166.73840193271636, -576.0235164831051, -439.2386260500451, -723.2166642575528, -590.3279437810635, -474.3258258489877, -1119.077001705435, -1240.8599616640888, -1013.3202839998271, -175.83547662348172, -1269.2753582596736, -608.4999252933036, -133.13365532546464, -942.0376302983183, -639.4517548120295, -488.93463101055363, -818.9580332390047, -1293.2835379617159, -1372.5866629499963, -1291.0817454412074, -1022.5792419825804, -854.2630014939763, -702.1579541131521, -1291.6538977876432, -1052.4570018074317, -1160.0807882848208, -642.111745080118, -352.0973149984985, -495.3019410646129, -1281.727240666142, -932.2527953916419, -509.7197530368139, -992.3222504657924, -1316.1274730501166, -873.6750991568625, -204.68751893597405, -646.1248091076185, -325.2418917030289, -169.06314075688044, -687.4419607757537, -1205.342805929512, -1134.8046796151887, -817.5307244833639, -835.7548026808039, -100.39346646380135, -1038.5662379434507, -32.88391633873716, -645.7472860433561, -878.6492149330463, -678.0206952047566, -598.0313452419812, -552.8448330457094, -741.7892429606482, -725.6589929824509, -851.3842863087632, -630.4161940976102, -982.654069211197, -486.21888728507486, -1338.446481865364, -283.22888248880315, -763.2204982455941, -847.4809255163285, -591.9222710696012, -931.8448219390626, -258.270555694955, -1091.2709740206026, -628.7797130643088, -715.2572245452552, -477.7919820004091, -537.3780014876274, -672.103888496937, -1260.5801869572874, -680.0062205927677, -1225.0081301343716, -77.59177815647777, -815.3631061587245, -1002.4055119801067, -733.57645889924, -1006.0623359808777, -128.32018066853104, -1139.0388692618628, -562.5571997683157, -1070.8292382286998, -708.1573029104173, -598.8188508404107, -633.0793258212353, -1003.8421910999842, -656.9336088850216, -1066.9010433682117, -1128.9969082464747, -963.0177550067348]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5518286854631509, "mean_inference_ms": 1.687324441261528, "mean_action_processing_ms": 0.2805990403819711, "mean_env_wait_ms": 3.0442209007561156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012330770492553711, "StateBufferConnector_ms": 0.007821083068847656, "ViewRequirementAgentConnector_ms": 0.1956641674041748}, "num_episodes": 27, "episode_return_max": 2.2782194787001346, "episode_return_min": -1372.5866629499963, "episode_return_mean": -749.8419239333148, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.1711963890413, "num_env_steps_trained_throughput_per_sec": 293.1711963890413, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13224.481, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13224.403, "sample_time_ms": 1053.872, "learn_time_ms": 12105.489, "learn_throughput": 330.429, "synch_weights_time_ms": 64.208}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00015", "date": "2024-08-03_11-43-40", "timestamp": 1722665620, "time_this_iter_s": 13.658850908279419, "time_total_s": 278.39642310142517, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ed07c160>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 278.39642310142517, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 16.16111111111111, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.56027035464843, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.646126097937425, "policy_loss": -0.011809372445956494, "vf_loss": 7.650655325253805, "vf_explained_var": 0.6919251069426536, "kl": 0.016520791618556057, "entropy": 1.5419796019792558, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -25.872880541357283, "episode_reward_min": -1402.455630314295, "episode_reward_mean": -780.1466660773548, "episode_len_mean": 141.96, "episode_media": {}, "episodes_timesteps_total": 14196, "policy_reward_min": {"policy_0": -1402.455630314295}, "policy_reward_max": {"policy_0": -25.872880541357283}, "policy_reward_mean": {"policy_0": -780.1466660773548}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1372.5866629499963, -1291.0817454412074, -1022.5792419825804, -854.2630014939763, -702.1579541131521, -1291.6538977876432, -1052.4570018074317, -1160.0807882848208, -642.111745080118, -352.0973149984985, -495.3019410646129, -1281.727240666142, -932.2527953916419, -509.7197530368139, -992.3222504657924, -1316.1274730501166, -873.6750991568625, -204.68751893597405, -646.1248091076185, -325.2418917030289, -169.06314075688044, -687.4419607757537, -1205.342805929512, -1134.8046796151887, -817.5307244833639, -835.7548026808039, -100.39346646380135, -1038.5662379434507, -32.88391633873716, -645.7472860433561, -878.6492149330463, -678.0206952047566, -598.0313452419812, -552.8448330457094, -741.7892429606482, -725.6589929824509, -851.3842863087632, -630.4161940976102, -982.654069211197, -486.21888728507486, -1338.446481865364, -283.22888248880315, -763.2204982455941, -847.4809255163285, -591.9222710696012, -931.8448219390626, -258.270555694955, -1091.2709740206026, -628.7797130643088, -715.2572245452552, -477.7919820004091, -537.3780014876274, -672.103888496937, -1260.5801869572874, -680.0062205927677, -1225.0081301343716, -77.59177815647777, -815.3631061587245, -1002.4055119801067, -733.57645889924, -1006.0623359808777, -128.32018066853104, -1139.0388692618628, -562.5571997683157, -1070.8292382286998, -708.1573029104173, -598.8188508404107, -633.0793258212353, -1003.8421910999842, -656.9336088850216, -1066.9010433682117, -1128.9969082464747, -963.0177550067348, -865.0962111393441, -977.5854001028234, -571.9386068007458, -854.8808319941936, -627.6579226475378, -120.01135912308726, -497.17642207203096, -25.872880541357283, -1201.608002470513, -693.0996153961564, -1278.5016690807417, -869.7295318946358, -769.441081248774, -946.6200702049562, -823.6950651529927, -581.3802645139309, -1037.5115949417914, -812.2180792962093, -507.381900224412, -587.8888336822754, -1019.6646682155746, -926.0959746199701, -828.7594747131932, -927.6775997248859, -720.8450594000561, -830.3435259982672, -1402.455630314295], "episode_lengths": [150, 150, 150, 150, 139, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 103, 150, 150, 150, 150, 150, 58, 150, 51, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 55, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150], "policy_policy_0_reward": [-1372.5866629499963, -1291.0817454412074, -1022.5792419825804, -854.2630014939763, -702.1579541131521, -1291.6538977876432, -1052.4570018074317, -1160.0807882848208, -642.111745080118, -352.0973149984985, -495.3019410646129, -1281.727240666142, -932.2527953916419, -509.7197530368139, -992.3222504657924, -1316.1274730501166, -873.6750991568625, -204.68751893597405, -646.1248091076185, -325.2418917030289, -169.06314075688044, -687.4419607757537, -1205.342805929512, -1134.8046796151887, -817.5307244833639, -835.7548026808039, -100.39346646380135, -1038.5662379434507, -32.88391633873716, -645.7472860433561, -878.6492149330463, -678.0206952047566, -598.0313452419812, -552.8448330457094, -741.7892429606482, -725.6589929824509, -851.3842863087632, -630.4161940976102, -982.654069211197, -486.21888728507486, -1338.446481865364, -283.22888248880315, -763.2204982455941, -847.4809255163285, -591.9222710696012, -931.8448219390626, -258.270555694955, -1091.2709740206026, -628.7797130643088, -715.2572245452552, -477.7919820004091, -537.3780014876274, -672.103888496937, -1260.5801869572874, -680.0062205927677, -1225.0081301343716, -77.59177815647777, -815.3631061587245, -1002.4055119801067, -733.57645889924, -1006.0623359808777, -128.32018066853104, -1139.0388692618628, -562.5571997683157, -1070.8292382286998, -708.1573029104173, -598.8188508404107, -633.0793258212353, -1003.8421910999842, -656.9336088850216, -1066.9010433682117, -1128.9969082464747, -963.0177550067348, -865.0962111393441, -977.5854001028234, -571.9386068007458, -854.8808319941936, -627.6579226475378, -120.01135912308726, -497.17642207203096, -25.872880541357283, -1201.608002470513, -693.0996153961564, -1278.5016690807417, -869.7295318946358, -769.441081248774, -946.6200702049562, -823.6950651529927, -581.3802645139309, -1037.5115949417914, -812.2180792962093, -507.381900224412, -587.8888336822754, -1019.6646682155746, -926.0959746199701, -828.7594747131932, -927.6775997248859, -720.8450594000561, -830.3435259982672, -1402.455630314295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5521483678934037, "mean_inference_ms": 1.6879146125281346, "mean_action_processing_ms": 0.2804057695406973, "mean_env_wait_ms": 3.0470963471955685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012220621109008789, "StateBufferConnector_ms": 0.007754087448120117, "ViewRequirementAgentConnector_ms": 0.1937274932861328}, "num_episodes": 27, "episode_return_max": -25.872880541357283, "episode_return_min": -1402.455630314295, "episode_return_mean": -780.1466660773548, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.66044033795924, "num_env_steps_trained_throughput_per_sec": 292.66044033795924, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13264.555, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13264.478, "sample_time_ms": 1057.482, "learn_time_ms": 12141.039, "learn_throughput": 329.461, "synch_weights_time_ms": 65.109}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00015", "date": "2024-08-03_11-43-54", "timestamp": 1722665634, "time_this_iter_s": 13.680890321731567, "time_total_s": 292.07731342315674, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00bda20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 292.07731342315674, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.915000000000001, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.995565669983627, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.256810316940149, "policy_loss": -0.014862631231274766, "vf_loss": 8.263656787574291, "vf_explained_var": 0.7028457540397842, "kl": 0.01817249386100839, "entropy": 1.6145855742196242, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -25.872880541357283, "episode_reward_min": -1402.455630314295, "episode_reward_mean": -771.178639899166, "episode_len_mean": 141.06, "episode_media": {}, "episodes_timesteps_total": 14106, "policy_reward_min": {"policy_0": -1402.455630314295}, "policy_reward_max": {"policy_0": -25.872880541357283}, "policy_reward_mean": {"policy_0": -771.178639899166}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-678.0206952047566, -598.0313452419812, -552.8448330457094, -741.7892429606482, -725.6589929824509, -851.3842863087632, -630.4161940976102, -982.654069211197, -486.21888728507486, -1338.446481865364, -283.22888248880315, -763.2204982455941, -847.4809255163285, -591.9222710696012, -931.8448219390626, -258.270555694955, -1091.2709740206026, -628.7797130643088, -715.2572245452552, -477.7919820004091, -537.3780014876274, -672.103888496937, -1260.5801869572874, -680.0062205927677, -1225.0081301343716, -77.59177815647777, -815.3631061587245, -1002.4055119801067, -733.57645889924, -1006.0623359808777, -128.32018066853104, -1139.0388692618628, -562.5571997683157, -1070.8292382286998, -708.1573029104173, -598.8188508404107, -633.0793258212353, -1003.8421910999842, -656.9336088850216, -1066.9010433682117, -1128.9969082464747, -963.0177550067348, -865.0962111393441, -977.5854001028234, -571.9386068007458, -854.8808319941936, -627.6579226475378, -120.01135912308726, -497.17642207203096, -25.872880541357283, -1201.608002470513, -693.0996153961564, -1278.5016690807417, -869.7295318946358, -769.441081248774, -946.6200702049562, -823.6950651529927, -581.3802645139309, -1037.5115949417914, -812.2180792962093, -507.381900224412, -587.8888336822754, -1019.6646682155746, -926.0959746199701, -828.7594747131932, -927.6775997248859, -720.8450594000561, -830.3435259982672, -1402.455630314295, -424.34485286583975, -1032.06047933444, -256.43381668285315, -978.0227972550113, -902.1671628394008, -830.6202827293866, -1079.7116944202464, -813.4801381820065, -638.4937938795156, -828.0041037171994, -571.0998233017115, -1293.7651714291037, -1069.2046281281248, -1116.244913161729, -608.4963329987579, -768.984221113744, -1378.4958078597938, -154.0228378003991, -1047.7971206054126, -110.91972470256438, -167.40651189862717, -50.49805248777703, -1287.5216796097461, -298.76735514712533, -889.7362702041157, -743.0040479578433, -1159.903849502162, -840.1006007705099, -765.8946049348887, -937.6421279626903, -924.7809411803229], "episode_lengths": [150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 55, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 82, 65, 57, 150, 80, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-678.0206952047566, -598.0313452419812, -552.8448330457094, -741.7892429606482, -725.6589929824509, -851.3842863087632, -630.4161940976102, -982.654069211197, -486.21888728507486, -1338.446481865364, -283.22888248880315, -763.2204982455941, -847.4809255163285, -591.9222710696012, -931.8448219390626, -258.270555694955, -1091.2709740206026, -628.7797130643088, -715.2572245452552, -477.7919820004091, -537.3780014876274, -672.103888496937, -1260.5801869572874, -680.0062205927677, -1225.0081301343716, -77.59177815647777, -815.3631061587245, -1002.4055119801067, -733.57645889924, -1006.0623359808777, -128.32018066853104, -1139.0388692618628, -562.5571997683157, -1070.8292382286998, -708.1573029104173, -598.8188508404107, -633.0793258212353, -1003.8421910999842, -656.9336088850216, -1066.9010433682117, -1128.9969082464747, -963.0177550067348, -865.0962111393441, -977.5854001028234, -571.9386068007458, -854.8808319941936, -627.6579226475378, -120.01135912308726, -497.17642207203096, -25.872880541357283, -1201.608002470513, -693.0996153961564, -1278.5016690807417, -869.7295318946358, -769.441081248774, -946.6200702049562, -823.6950651529927, -581.3802645139309, -1037.5115949417914, -812.2180792962093, -507.381900224412, -587.8888336822754, -1019.6646682155746, -926.0959746199701, -828.7594747131932, -927.6775997248859, -720.8450594000561, -830.3435259982672, -1402.455630314295, -424.34485286583975, -1032.06047933444, -256.43381668285315, -978.0227972550113, -902.1671628394008, -830.6202827293866, -1079.7116944202464, -813.4801381820065, -638.4937938795156, -828.0041037171994, -571.0998233017115, -1293.7651714291037, -1069.2046281281248, -1116.244913161729, -608.4963329987579, -768.984221113744, -1378.4958078597938, -154.0228378003991, -1047.7971206054126, -110.91972470256438, -167.40651189862717, -50.49805248777703, -1287.5216796097461, -298.76735514712533, -889.7362702041157, -743.0040479578433, -1159.903849502162, -840.1006007705099, -765.8946049348887, -937.6421279626903, -924.7809411803229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5518292384875051, "mean_inference_ms": 1.6883290552240517, "mean_action_processing_ms": 0.28029803867936254, "mean_env_wait_ms": 3.052771649885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01228952407836914, "StateBufferConnector_ms": 0.008039712905883789, "ViewRequirementAgentConnector_ms": 0.19701409339904785}, "num_episodes": 31, "episode_return_max": -25.872880541357283, "episode_return_min": -1402.455630314295, "episode_return_mean": -771.178639899166, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.181113112717, "num_env_steps_trained_throughput_per_sec": 317.181113112717, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13135.472, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13135.392, "sample_time_ms": 1058.196, "learn_time_ms": 12010.447, "learn_throughput": 333.043, "synch_weights_time_ms": 65.852}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00015", "date": "2024-08-03_11-44-07", "timestamp": 1722665647, "time_this_iter_s": 12.623613119125366, "time_total_s": 304.7009265422821, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c577910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 304.7009265422821, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 14.25, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.60195286820332, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.701675090690454, "policy_loss": -0.02019554834308413, "vf_loss": 7.71327880670627, "vf_explained_var": 0.802399431169033, "kl": 0.01937830086963004, "entropy": 1.2842997674519816, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -25.872880541357283, "episode_reward_min": -1402.455630314295, "episode_reward_mean": -748.2571144304815, "episode_len_mean": 136.2, "episode_media": {}, "episodes_timesteps_total": 13620, "policy_reward_min": {"policy_0": -1402.455630314295}, "policy_reward_max": {"policy_0": -25.872880541357283}, "policy_reward_mean": {"policy_0": -748.2571144304815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-128.32018066853104, -1139.0388692618628, -562.5571997683157, -1070.8292382286998, -708.1573029104173, -598.8188508404107, -633.0793258212353, -1003.8421910999842, -656.9336088850216, -1066.9010433682117, -1128.9969082464747, -963.0177550067348, -865.0962111393441, -977.5854001028234, -571.9386068007458, -854.8808319941936, -627.6579226475378, -120.01135912308726, -497.17642207203096, -25.872880541357283, -1201.608002470513, -693.0996153961564, -1278.5016690807417, -869.7295318946358, -769.441081248774, -946.6200702049562, -823.6950651529927, -581.3802645139309, -1037.5115949417914, -812.2180792962093, -507.381900224412, -587.8888336822754, -1019.6646682155746, -926.0959746199701, -828.7594747131932, -927.6775997248859, -720.8450594000561, -830.3435259982672, -1402.455630314295, -424.34485286583975, -1032.06047933444, -256.43381668285315, -978.0227972550113, -902.1671628394008, -830.6202827293866, -1079.7116944202464, -813.4801381820065, -638.4937938795156, -828.0041037171994, -571.0998233017115, -1293.7651714291037, -1069.2046281281248, -1116.244913161729, -608.4963329987579, -768.984221113744, -1378.4958078597938, -154.0228378003991, -1047.7971206054126, -110.91972470256438, -167.40651189862717, -50.49805248777703, -1287.5216796097461, -298.76735514712533, -889.7362702041157, -743.0040479578433, -1159.903849502162, -840.1006007705099, -765.8946049348887, -937.6421279626903, -924.7809411803229, -722.3604902964274, -720.7761950039627, -932.7867949707028, -284.9218173812837, -841.4502765536505, -527.498959042297, -988.1674111645874, -1337.012671103075, -125.06315705068026, -101.53064618276143, -504.3746046777666, -491.7950108861913, -827.9060968538906, -115.93875483764992, -815.1481045483902, -54.8765026796469, -1146.0044979290456, -840.8258622439371, -1230.8130610022095, -53.247438599074066, -997.3006010794429, -861.6647123549133, -719.1073932445216, -1055.1148085796751, -703.3050525960637, -61.80901489524944, -571.2685695652895, -800.5267509043522, -528.0545379414332, -931.8061545962632], "episode_lengths": [55, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 82, 65, 57, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 60, 69, 150, 150, 150, 51, 150, 49, 150, 150, 150, 56, 150, 150, 150, 150, 150, 60, 150, 150, 136, 150], "policy_policy_0_reward": [-128.32018066853104, -1139.0388692618628, -562.5571997683157, -1070.8292382286998, -708.1573029104173, -598.8188508404107, -633.0793258212353, -1003.8421910999842, -656.9336088850216, -1066.9010433682117, -1128.9969082464747, -963.0177550067348, -865.0962111393441, -977.5854001028234, -571.9386068007458, -854.8808319941936, -627.6579226475378, -120.01135912308726, -497.17642207203096, -25.872880541357283, -1201.608002470513, -693.0996153961564, -1278.5016690807417, -869.7295318946358, -769.441081248774, -946.6200702049562, -823.6950651529927, -581.3802645139309, -1037.5115949417914, -812.2180792962093, -507.381900224412, -587.8888336822754, -1019.6646682155746, -926.0959746199701, -828.7594747131932, -927.6775997248859, -720.8450594000561, -830.3435259982672, -1402.455630314295, -424.34485286583975, -1032.06047933444, -256.43381668285315, -978.0227972550113, -902.1671628394008, -830.6202827293866, -1079.7116944202464, -813.4801381820065, -638.4937938795156, -828.0041037171994, -571.0998233017115, -1293.7651714291037, -1069.2046281281248, -1116.244913161729, -608.4963329987579, -768.984221113744, -1378.4958078597938, -154.0228378003991, -1047.7971206054126, -110.91972470256438, -167.40651189862717, -50.49805248777703, -1287.5216796097461, -298.76735514712533, -889.7362702041157, -743.0040479578433, -1159.903849502162, -840.1006007705099, -765.8946049348887, -937.6421279626903, -924.7809411803229, -722.3604902964274, -720.7761950039627, -932.7867949707028, -284.9218173812837, -841.4502765536505, -527.498959042297, -988.1674111645874, -1337.012671103075, -125.06315705068026, -101.53064618276143, -504.3746046777666, -491.7950108861913, -827.9060968538906, -115.93875483764992, -815.1481045483902, -54.8765026796469, -1146.0044979290456, -840.8258622439371, -1230.8130610022095, -53.247438599074066, -997.3006010794429, -861.6647123549133, -719.1073932445216, -1055.1148085796751, -703.3050525960637, -61.80901489524944, -571.2685695652895, -800.5267509043522, -528.0545379414332, -931.8061545962632]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526004613091715, "mean_inference_ms": 1.6894117647805187, "mean_action_processing_ms": 0.28043360655282723, "mean_env_wait_ms": 3.056137189398997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012280941009521484, "StateBufferConnector_ms": 0.008125543594360352, "ViewRequirementAgentConnector_ms": 0.19869399070739746}, "num_episodes": 30, "episode_return_max": -25.872880541357283, "episode_return_min": -1402.455630314295, "episode_return_mean": -748.2571144304815, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.44160061186767, "num_env_steps_trained_throughput_per_sec": 298.44160061186767, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13369.036, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13368.957, "sample_time_ms": 1056.256, "learn_time_ms": 12244.023, "learn_throughput": 326.69, "synch_weights_time_ms": 67.781}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00015", "date": "2024-08-03_11-44-20", "timestamp": 1722665660, "time_this_iter_s": 13.415522336959839, "time_total_s": 318.11644887924194, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c574790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 318.11644887924194, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.978947368421053, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.58465231160323, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.448410724600156, "policy_loss": -0.008285385413425198, "vf_loss": 7.449064840376377, "vf_explained_var": 0.6665854509299, "kl": 0.017312452096302913, "entropy": 1.5935469194004932, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -31.692495096618465, "episode_reward_min": -1402.455630314295, "episode_reward_mean": -754.6758941887042, "episode_len_mean": 135.87, "episode_media": {}, "episodes_timesteps_total": 13587, "policy_reward_min": {"policy_0": -1402.455630314295}, "policy_reward_max": {"policy_0": -31.692495096618465}, "policy_reward_mean": {"policy_0": -754.6758941887042}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-507.381900224412, -587.8888336822754, -1019.6646682155746, -926.0959746199701, -828.7594747131932, -927.6775997248859, -720.8450594000561, -830.3435259982672, -1402.455630314295, -424.34485286583975, -1032.06047933444, -256.43381668285315, -978.0227972550113, -902.1671628394008, -830.6202827293866, -1079.7116944202464, -813.4801381820065, -638.4937938795156, -828.0041037171994, -571.0998233017115, -1293.7651714291037, -1069.2046281281248, -1116.244913161729, -608.4963329987579, -768.984221113744, -1378.4958078597938, -154.0228378003991, -1047.7971206054126, -110.91972470256438, -167.40651189862717, -50.49805248777703, -1287.5216796097461, -298.76735514712533, -889.7362702041157, -743.0040479578433, -1159.903849502162, -840.1006007705099, -765.8946049348887, -937.6421279626903, -924.7809411803229, -722.3604902964274, -720.7761950039627, -932.7867949707028, -284.9218173812837, -841.4502765536505, -527.498959042297, -988.1674111645874, -1337.012671103075, -125.06315705068026, -101.53064618276143, -504.3746046777666, -491.7950108861913, -827.9060968538906, -115.93875483764992, -815.1481045483902, -54.8765026796469, -1146.0044979290456, -840.8258622439371, -1230.8130610022095, -53.247438599074066, -997.3006010794429, -861.6647123549133, -719.1073932445216, -1055.1148085796751, -703.3050525960637, -61.80901489524944, -571.2685695652895, -800.5267509043522, -528.0545379414332, -931.8061545962632, -628.9450585673932, -1169.6106391583512, -798.6681431812905, -814.7344428583212, -1231.83055823129, -1275.2467593969584, -1030.4199032438385, -1189.0182601608708, -399.4374672560929, -440.4065103920155, -461.33198928596346, -937.0116044817948, -192.6395610398637, -444.75666286725897, -929.9240506278034, -1198.66488915819, -1133.1075504764005, -632.6775054541355, -428.97044082061274, -688.3863985842614, -826.9191495809448, -1199.9991464893674, -31.692495096618465, -696.2174982402361, -1138.5526512468498, -600.4936887529901, -553.6945816078164, -1170.6583039062941, -893.6466240301082, -718.7325243560775], "episode_lengths": [150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 82, 65, 57, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 60, 69, 150, 150, 150, 51, 150, 49, 150, 150, 150, 56, 150, 150, 150, 150, 150, 60, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 118, 150, 92, 112, 150, 150, 150, 150, 112, 150, 150, 150, 39, 150, 150, 150, 132, 150, 150, 150], "policy_policy_0_reward": [-507.381900224412, -587.8888336822754, -1019.6646682155746, -926.0959746199701, -828.7594747131932, -927.6775997248859, -720.8450594000561, -830.3435259982672, -1402.455630314295, -424.34485286583975, -1032.06047933444, -256.43381668285315, -978.0227972550113, -902.1671628394008, -830.6202827293866, -1079.7116944202464, -813.4801381820065, -638.4937938795156, -828.0041037171994, -571.0998233017115, -1293.7651714291037, -1069.2046281281248, -1116.244913161729, -608.4963329987579, -768.984221113744, -1378.4958078597938, -154.0228378003991, -1047.7971206054126, -110.91972470256438, -167.40651189862717, -50.49805248777703, -1287.5216796097461, -298.76735514712533, -889.7362702041157, -743.0040479578433, -1159.903849502162, -840.1006007705099, -765.8946049348887, -937.6421279626903, -924.7809411803229, -722.3604902964274, -720.7761950039627, -932.7867949707028, -284.9218173812837, -841.4502765536505, -527.498959042297, -988.1674111645874, -1337.012671103075, -125.06315705068026, -101.53064618276143, -504.3746046777666, -491.7950108861913, -827.9060968538906, -115.93875483764992, -815.1481045483902, -54.8765026796469, -1146.0044979290456, -840.8258622439371, -1230.8130610022095, -53.247438599074066, -997.3006010794429, -861.6647123549133, -719.1073932445216, -1055.1148085796751, -703.3050525960637, -61.80901489524944, -571.2685695652895, -800.5267509043522, -528.0545379414332, -931.8061545962632, -628.9450585673932, -1169.6106391583512, -798.6681431812905, -814.7344428583212, -1231.83055823129, -1275.2467593969584, -1030.4199032438385, -1189.0182601608708, -399.4374672560929, -440.4065103920155, -461.33198928596346, -937.0116044817948, -192.6395610398637, -444.75666286725897, -929.9240506278034, -1198.66488915819, -1133.1075504764005, -632.6775054541355, -428.97044082061274, -688.3863985842614, -826.9191495809448, -1199.9991464893674, -31.692495096618465, -696.2174982402361, -1138.5526512468498, -600.4936887529901, -553.6945816078164, -1170.6583039062941, -893.6466240301082, -718.7325243560775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527641882136297, "mean_inference_ms": 1.689663387850404, "mean_action_processing_ms": 0.28055972718888444, "mean_env_wait_ms": 3.0567761164019185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01253962516784668, "StateBufferConnector_ms": 0.008269071578979492, "ViewRequirementAgentConnector_ms": 0.20313715934753418}, "num_episodes": 30, "episode_return_max": -31.692495096618465, "episode_return_min": -1402.455630314295, "episode_return_mean": -754.6758941887042, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.9559890067668, "num_env_steps_trained_throughput_per_sec": 485.9559890067668, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12870.163, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12870.084, "sample_time_ms": 1057.09, "learn_time_ms": 11745.341, "learn_throughput": 340.561, "synch_weights_time_ms": 66.75}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00015", "date": "2024-08-03_11-44-28", "timestamp": 1722665668, "time_this_iter_s": 8.244476079940796, "time_total_s": 326.36092495918274, "pid": 530509, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00bda20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 326.36092495918274, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.616666666666667, "ram_util_percent": 27.8}}
