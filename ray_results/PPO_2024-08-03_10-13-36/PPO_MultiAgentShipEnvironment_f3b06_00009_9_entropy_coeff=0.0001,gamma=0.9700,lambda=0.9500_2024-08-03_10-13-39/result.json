{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3400733405103287, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.427878812948864, "policy_loss": -0.006169772407156415, "vf_loss": 9.432358667254448, "vf_explained_var": 0.05942982118576765, "kl": 0.009157332919736897, "entropy": 1.4154116842895745, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -32.373071468759726, "episode_reward_min": -1080.3516607650702, "episode_reward_mean": -531.7081376505337, "episode_len_mean": 122.16666666666667, "episode_media": {}, "episodes_timesteps_total": 2932, "policy_reward_min": {"policy_0": -1080.3516607650702}, "policy_reward_max": {"policy_0": -32.373071468759726}, "policy_reward_mean": {"policy_0": -531.7081376505337}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.39447471290936, -242.7020450881289, -651.1677038051348, -902.19960297645, -979.1016029985044, -616.9906075462344, -47.160013813517565, -1080.3516607650702, -912.4858967067861, -796.7044791488012, -873.0328280787538, -891.1005828938862, -895.8098811410913, -242.6783074711865, -329.19418852763624, -139.52631866427626, -264.4331093309062, -662.0054114795101, -599.666567734243, -113.42790842100733, -200.95004475753214, -297.3127947120743, -925.2262013704083, -32.373071468759726], "episode_lengths": [62, 103, 150, 150, 150, 145, 42, 150, 150, 150, 150, 150, 150, 82, 99, 99, 120, 150, 150, 103, 103, 116, 150, 58], "policy_policy_0_reward": [-65.39447471290936, -242.7020450881289, -651.1677038051348, -902.19960297645, -979.1016029985044, -616.9906075462344, -47.160013813517565, -1080.3516607650702, -912.4858967067861, -796.7044791488012, -873.0328280787538, -891.1005828938862, -895.8098811410913, -242.6783074711865, -329.19418852763624, -139.52631866427626, -264.4331093309062, -662.0054114795101, -599.666567734243, -113.42790842100733, -200.95004475753214, -297.3127947120743, -925.2262013704083, -32.373071468759726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5699955301331769, "mean_inference_ms": 1.6843367751726506, "mean_action_processing_ms": 0.28336179471759765, "mean_env_wait_ms": 2.982730394383239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011842449506123861, "StateBufferConnector_ms": 0.008080403010050455, "ViewRequirementAgentConnector_ms": 0.18167595068613687}, "num_episodes": 24, "episode_return_max": -32.373071468759726, "episode_return_min": -1080.3516607650702, "episode_return_mean": -531.7081376505337, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.9786831207859, "num_env_steps_trained_throughput_per_sec": 341.9786831207859, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 11696.644, "restore_workers_time_ms": 0.022, "training_step_time_ms": 11696.582, "sample_time_ms": 1072.53, "learn_time_ms": 10552.809, "learn_throughput": 379.046, "synch_weights_time_ms": 70.339}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00009", "date": "2024-08-03_11-05-04", "timestamp": 1722663304, "time_this_iter_s": 11.709469318389893, "time_total_s": 11.709469318389893, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d3370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11.709469318389893, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 13.958823529411763, "ram_util_percent": 27.588235294117652}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1204880316431325, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.2312969793876, "policy_loss": -0.010050244512967765, "vf_loss": 9.23811479906241, "vf_explained_var": 0.19170091152191163, "kl": 0.016894684158296515, "entropy": 1.4652270060032606, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -32.373071468759726, "episode_reward_min": -1228.7655434595345, "episode_reward_mean": -585.3778389065025, "episode_len_mean": 125.41176470588235, "episode_media": {}, "episodes_timesteps_total": 6396, "policy_reward_min": {"policy_0": -1228.7655434595345}, "policy_reward_max": {"policy_0": -32.373071468759726}, "policy_reward_mean": {"policy_0": -585.3778389065025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.39447471290936, -242.7020450881289, -651.1677038051348, -902.19960297645, -979.1016029985044, -616.9906075462344, -47.160013813517565, -1080.3516607650702, -912.4858967067861, -796.7044791488012, -873.0328280787538, -891.1005828938862, -895.8098811410913, -242.6783074711865, -329.19418852763624, -139.52631866427626, -264.4331093309062, -662.0054114795101, -599.666567734243, -113.42790842100733, -200.95004475753214, -297.3127947120743, -925.2262013704083, -32.373071468759726, -340.5655875242427, -129.81034211775108, -982.1423612315161, -90.31761559774274, -86.88403662479324, -937.7451971846164, -637.7666855539865, -818.3398077698948, -818.5306378679974, -261.031171170934, -216.98378635889216, -133.3547899384659, -836.9068468001738, -846.6714679362658, -495.11663519206667, -227.95214599723104, -867.8247269050715, -1228.7655434595345, -1177.007877515089, -63.16274288898765, -738.4384966152221, -1206.3871847246337, -821.2188985880879, -858.5648000315106, -1062.9702051545985, -82.42946545962427, -1126.3854244098904], "episode_lengths": [62, 103, 150, 150, 150, 145, 42, 150, 150, 150, 150, 150, 150, 82, 99, 99, 120, 150, 150, 103, 103, 116, 150, 58, 150, 93, 150, 80, 97, 150, 150, 150, 150, 111, 86, 81, 150, 150, 150, 86, 150, 150, 150, 76, 150, 150, 150, 150, 150, 54, 150], "policy_policy_0_reward": [-65.39447471290936, -242.7020450881289, -651.1677038051348, -902.19960297645, -979.1016029985044, -616.9906075462344, -47.160013813517565, -1080.3516607650702, -912.4858967067861, -796.7044791488012, -873.0328280787538, -891.1005828938862, -895.8098811410913, -242.6783074711865, -329.19418852763624, -139.52631866427626, -264.4331093309062, -662.0054114795101, -599.666567734243, -113.42790842100733, -200.95004475753214, -297.3127947120743, -925.2262013704083, -32.373071468759726, -340.5655875242427, -129.81034211775108, -982.1423612315161, -90.31761559774274, -86.88403662479324, -937.7451971846164, -637.7666855539865, -818.3398077698948, -818.5306378679974, -261.031171170934, -216.98378635889216, -133.3547899384659, -836.9068468001738, -846.6714679362658, -495.11663519206667, -227.95214599723104, -867.8247269050715, -1228.7655434595345, -1177.007877515089, -63.16274288898765, -738.4384966152221, -1206.3871847246337, -821.2188985880879, -858.5648000315106, -1062.9702051545985, -82.42946545962427, -1126.3854244098904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5653441828894782, "mean_inference_ms": 1.686146671604946, "mean_action_processing_ms": 0.2835690885233861, "mean_env_wait_ms": 2.9832672470200823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012928364323634728, "StateBufferConnector_ms": 0.008167005052753524, "ViewRequirementAgentConnector_ms": 0.18195731967103249}, "num_episodes": 27, "episode_return_max": -32.373071468759726, "episode_return_min": -1228.7655434595345, "episode_return_mean": -585.3778389065025, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.64850419137525, "num_env_steps_trained_throughput_per_sec": 297.64850419137525, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12567.663, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12567.591, "sample_time_ms": 1051.344, "learn_time_ms": 11446.536, "learn_throughput": 349.451, "synch_weights_time_ms": 68.783}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00009", "date": "2024-08-03_11-05-17", "timestamp": 1722663317, "time_this_iter_s": 13.450762033462524, "time_total_s": 25.160231351852417, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c576a70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.160231351852417, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.678947368421055, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7964652869229516, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.230317425231139, "policy_loss": -0.012615680358430836, "vf_loss": 9.23977345128854, "vf_explained_var": 0.30173098829885325, "kl": 0.01650704718464719, "entropy": 1.4180122486005227, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -32.373071468759726, "episode_reward_min": -1228.7655434595345, "episode_reward_mean": -601.0455033439927, "episode_len_mean": 127.92307692307692, "episode_media": {}, "episodes_timesteps_total": 9978, "policy_reward_min": {"policy_0": -1228.7655434595345}, "policy_reward_max": {"policy_0": -32.373071468759726}, "policy_reward_mean": {"policy_0": -601.0455033439927}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-65.39447471290936, -242.7020450881289, -651.1677038051348, -902.19960297645, -979.1016029985044, -616.9906075462344, -47.160013813517565, -1080.3516607650702, -912.4858967067861, -796.7044791488012, -873.0328280787538, -891.1005828938862, -895.8098811410913, -242.6783074711865, -329.19418852763624, -139.52631866427626, -264.4331093309062, -662.0054114795101, -599.666567734243, -113.42790842100733, -200.95004475753214, -297.3127947120743, -925.2262013704083, -32.373071468759726, -340.5655875242427, -129.81034211775108, -982.1423612315161, -90.31761559774274, -86.88403662479324, -937.7451971846164, -637.7666855539865, -818.3398077698948, -818.5306378679974, -261.031171170934, -216.98378635889216, -133.3547899384659, -836.9068468001738, -846.6714679362658, -495.11663519206667, -227.95214599723104, -867.8247269050715, -1228.7655434595345, -1177.007877515089, -63.16274288898765, -738.4384966152221, -1206.3871847246337, -821.2188985880879, -858.5648000315106, -1062.9702051545985, -82.42946545962427, -1126.3854244098904, -83.45185237528014, -512.0609905272318, -207.44270566277106, -253.00993014933604, -329.90547380436703, -98.24166597925678, -431.8022549060226, -1102.8038210166599, -1037.045415676134, -672.8030709526156, -71.86359215547304, -1094.9587263696835, -767.9908013576913, -348.11533911455894, -953.7889445706514, -622.2834198281394, -585.3220499121891, -54.195093224233695, -713.4679585938785, -1010.6411602796904, -999.8350267571805, -734.0853616847953, -882.5429804296784, -935.3575197189489, -1032.937579226168, -1133.32378871238, -358.00295361477185], "episode_lengths": [62, 103, 150, 150, 150, 145, 42, 150, 150, 150, 150, 150, 150, 82, 99, 99, 120, 150, 150, 103, 103, 116, 150, 58, 150, 93, 150, 80, 97, 150, 150, 150, 150, 111, 86, 81, 150, 150, 150, 86, 150, 150, 150, 76, 150, 150, 150, 150, 150, 54, 150, 65, 150, 109, 94, 150, 83, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 100], "policy_policy_0_reward": [-65.39447471290936, -242.7020450881289, -651.1677038051348, -902.19960297645, -979.1016029985044, -616.9906075462344, -47.160013813517565, -1080.3516607650702, -912.4858967067861, -796.7044791488012, -873.0328280787538, -891.1005828938862, -895.8098811410913, -242.6783074711865, -329.19418852763624, -139.52631866427626, -264.4331093309062, -662.0054114795101, -599.666567734243, -113.42790842100733, -200.95004475753214, -297.3127947120743, -925.2262013704083, -32.373071468759726, -340.5655875242427, -129.81034211775108, -982.1423612315161, -90.31761559774274, -86.88403662479324, -937.7451971846164, -637.7666855539865, -818.3398077698948, -818.5306378679974, -261.031171170934, -216.98378635889216, -133.3547899384659, -836.9068468001738, -846.6714679362658, -495.11663519206667, -227.95214599723104, -867.8247269050715, -1228.7655434595345, -1177.007877515089, -63.16274288898765, -738.4384966152221, -1206.3871847246337, -821.2188985880879, -858.5648000315106, -1062.9702051545985, -82.42946545962427, -1126.3854244098904, -83.45185237528014, -512.0609905272318, -207.44270566277106, -253.00993014933604, -329.90547380436703, -98.24166597925678, -431.8022549060226, -1102.8038210166599, -1037.045415676134, -672.8030709526156, -71.86359215547304, -1094.9587263696835, -767.9908013576913, -348.11533911455894, -953.7889445706514, -622.2834198281394, -585.3220499121891, -54.195093224233695, -713.4679585938785, -1010.6411602796904, -999.8350267571805, -734.0853616847953, -882.5429804296784, -935.3575197189489, -1032.937579226168, -1133.32378871238, -358.00295361477185]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5646722284868232, "mean_inference_ms": 1.6912691909394617, "mean_action_processing_ms": 0.28433780546522475, "mean_env_wait_ms": 2.985622155864014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013962464454846505, "StateBufferConnector_ms": 0.008677824949606871, "ViewRequirementAgentConnector_ms": 0.18950975858248198}, "num_episodes": 27, "episode_return_max": -32.373071468759726, "episode_return_min": -1228.7655434595345, "episode_return_mean": -601.0455033439927, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.1129567360975, "num_env_steps_trained_throughput_per_sec": 301.1129567360975, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12806.464, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12806.391, "sample_time_ms": 1044.562, "learn_time_ms": 11693.781, "learn_throughput": 342.062, "synch_weights_time_ms": 67.114}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00009", "date": "2024-08-03_11-05-31", "timestamp": 1722663331, "time_this_iter_s": 13.296279907226562, "time_total_s": 38.45651125907898, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c574d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.45651125907898, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.584210526315792, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.369774281233549, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.115501206119855, "policy_loss": -0.007981352691422217, "vf_loss": 9.120961026350658, "vf_explained_var": 0.3543631359934807, "kl": 0.013318467395417125, "entropy": 1.4212124057114124, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -28.127137396993366, "episode_reward_min": -1228.7655434595345, "episode_reward_mean": -629.0035602263943, "episode_len_mean": 131.49, "episode_media": {}, "episodes_timesteps_total": 13149, "policy_reward_min": {"policy_0": -1228.7655434595345}, "policy_reward_max": {"policy_0": -28.127137396993366}, "policy_reward_mean": {"policy_0": -629.0035602263943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-796.7044791488012, -873.0328280787538, -891.1005828938862, -895.8098811410913, -242.6783074711865, -329.19418852763624, -139.52631866427626, -264.4331093309062, -662.0054114795101, -599.666567734243, -113.42790842100733, -200.95004475753214, -297.3127947120743, -925.2262013704083, -32.373071468759726, -340.5655875242427, -129.81034211775108, -982.1423612315161, -90.31761559774274, -86.88403662479324, -937.7451971846164, -637.7666855539865, -818.3398077698948, -818.5306378679974, -261.031171170934, -216.98378635889216, -133.3547899384659, -836.9068468001738, -846.6714679362658, -495.11663519206667, -227.95214599723104, -867.8247269050715, -1228.7655434595345, -1177.007877515089, -63.16274288898765, -738.4384966152221, -1206.3871847246337, -821.2188985880879, -858.5648000315106, -1062.9702051545985, -82.42946545962427, -1126.3854244098904, -83.45185237528014, -512.0609905272318, -207.44270566277106, -253.00993014933604, -329.90547380436703, -98.24166597925678, -431.8022549060226, -1102.8038210166599, -1037.045415676134, -672.8030709526156, -71.86359215547304, -1094.9587263696835, -767.9908013576913, -348.11533911455894, -953.7889445706514, -622.2834198281394, -585.3220499121891, -54.195093224233695, -713.4679585938785, -1010.6411602796904, -999.8350267571805, -734.0853616847953, -882.5429804296784, -935.3575197189489, -1032.937579226168, -1133.32378871238, -358.00295361477185, -858.7687733549769, -487.99607841528666, -795.3451151147535, -1114.5521468537652, -729.5201777090747, -968.8837167242023, -1129.2392927124727, -913.1810981910346, -1003.9174779500665, -828.9503720728972, -526.9499692422088, -1066.5356692412033, -473.9286974525264, -842.7586094955927, -849.2022829612291, -1049.3182192473814, -731.2357227447044, -758.8245432590862, -59.44342188230775, -945.8822657894302, -189.62853101221933, -922.7190242895055, -488.44803843023703, -28.127137396993366, -231.07530399669818, -1148.3642132938132, -283.35383991589464, -120.635498856346, -937.2087607051494, -336.3273443622653, -696.0390275474141], "episode_lengths": [150, 150, 150, 150, 82, 99, 99, 120, 150, 150, 103, 103, 116, 150, 58, 150, 93, 150, 80, 97, 150, 150, 150, 150, 111, 86, 81, 150, 150, 150, 86, 150, 150, 150, 76, 150, 150, 150, 150, 150, 54, 150, 65, 150, 109, 94, 150, 83, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 79, 150, 139, 53, 114, 150, 150, 78, 150, 150, 150], "policy_policy_0_reward": [-796.7044791488012, -873.0328280787538, -891.1005828938862, -895.8098811410913, -242.6783074711865, -329.19418852763624, -139.52631866427626, -264.4331093309062, -662.0054114795101, -599.666567734243, -113.42790842100733, -200.95004475753214, -297.3127947120743, -925.2262013704083, -32.373071468759726, -340.5655875242427, -129.81034211775108, -982.1423612315161, -90.31761559774274, -86.88403662479324, -937.7451971846164, -637.7666855539865, -818.3398077698948, -818.5306378679974, -261.031171170934, -216.98378635889216, -133.3547899384659, -836.9068468001738, -846.6714679362658, -495.11663519206667, -227.95214599723104, -867.8247269050715, -1228.7655434595345, -1177.007877515089, -63.16274288898765, -738.4384966152221, -1206.3871847246337, -821.2188985880879, -858.5648000315106, -1062.9702051545985, -82.42946545962427, -1126.3854244098904, -83.45185237528014, -512.0609905272318, -207.44270566277106, -253.00993014933604, -329.90547380436703, -98.24166597925678, -431.8022549060226, -1102.8038210166599, -1037.045415676134, -672.8030709526156, -71.86359215547304, -1094.9587263696835, -767.9908013576913, -348.11533911455894, -953.7889445706514, -622.2834198281394, -585.3220499121891, -54.195093224233695, -713.4679585938785, -1010.6411602796904, -999.8350267571805, -734.0853616847953, -882.5429804296784, -935.3575197189489, -1032.937579226168, -1133.32378871238, -358.00295361477185, -858.7687733549769, -487.99607841528666, -795.3451151147535, -1114.5521468537652, -729.5201777090747, -968.8837167242023, -1129.2392927124727, -913.1810981910346, -1003.9174779500665, -828.9503720728972, -526.9499692422088, -1066.5356692412033, -473.9286974525264, -842.7586094955927, -849.2022829612291, -1049.3182192473814, -731.2357227447044, -758.8245432590862, -59.44342188230775, -945.8822657894302, -189.62853101221933, -922.7190242895055, -488.44803843023703, -28.127137396993366, -231.07530399669818, -1148.3642132938132, -283.35383991589464, -120.635498856346, -937.2087607051494, -336.3273443622653, -696.0390275474141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5641697381789136, "mean_inference_ms": 1.6963968110492698, "mean_action_processing_ms": 0.28548798840494954, "mean_env_wait_ms": 2.99273355326357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013935327529907227, "StateBufferConnector_ms": 0.008938789367675781, "ViewRequirementAgentConnector_ms": 0.19174408912658691}, "num_episodes": 31, "episode_return_max": -28.127137396993366, "episode_return_min": -1228.7655434595345, "episode_return_mean": -629.0035602263943, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.1901285053811, "num_env_steps_trained_throughput_per_sec": 308.1901285053811, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12849.601, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12849.53, "sample_time_ms": 1053.37, "learn_time_ms": 11728.116, "learn_throughput": 341.061, "synch_weights_time_ms": 67.151}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00009", "date": "2024-08-03_11-05-44", "timestamp": 1722663344, "time_this_iter_s": 12.99148178100586, "time_total_s": 51.44799304008484, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246faed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.44799304008484, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.894736842105264, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.632050564698875, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.113517832756042, "policy_loss": -0.010501564426037172, "vf_loss": 9.120815598964692, "vf_explained_var": 0.3949319357673327, "kl": 0.01674881304085526, "entropy": 1.4593521161625782, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -28.127137396993366, "episode_reward_min": -1228.7655434595345, "episode_reward_mean": -673.157060731996, "episode_len_mean": 135.4, "episode_media": {}, "episodes_timesteps_total": 13540, "policy_reward_min": {"policy_0": -1228.7655434595345}, "policy_reward_max": {"policy_0": -28.127137396993366}, "policy_reward_mean": {"policy_0": -673.157060731996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-227.95214599723104, -867.8247269050715, -1228.7655434595345, -1177.007877515089, -63.16274288898765, -738.4384966152221, -1206.3871847246337, -821.2188985880879, -858.5648000315106, -1062.9702051545985, -82.42946545962427, -1126.3854244098904, -83.45185237528014, -512.0609905272318, -207.44270566277106, -253.00993014933604, -329.90547380436703, -98.24166597925678, -431.8022549060226, -1102.8038210166599, -1037.045415676134, -672.8030709526156, -71.86359215547304, -1094.9587263696835, -767.9908013576913, -348.11533911455894, -953.7889445706514, -622.2834198281394, -585.3220499121891, -54.195093224233695, -713.4679585938785, -1010.6411602796904, -999.8350267571805, -734.0853616847953, -882.5429804296784, -935.3575197189489, -1032.937579226168, -1133.32378871238, -358.00295361477185, -858.7687733549769, -487.99607841528666, -795.3451151147535, -1114.5521468537652, -729.5201777090747, -968.8837167242023, -1129.2392927124727, -913.1810981910346, -1003.9174779500665, -828.9503720728972, -526.9499692422088, -1066.5356692412033, -473.9286974525264, -842.7586094955927, -849.2022829612291, -1049.3182192473814, -731.2357227447044, -758.8245432590862, -59.44342188230775, -945.8822657894302, -189.62853101221933, -922.7190242895055, -488.44803843023703, -28.127137396993366, -231.07530399669818, -1148.3642132938132, -283.35383991589464, -120.635498856346, -937.2087607051494, -336.3273443622653, -696.0390275474141, -38.49476941656852, -934.221085740747, -113.4319577373232, -780.7869724776114, -148.2224120009927, -611.5094732506399, -520.8848861741902, -991.3000775979579, -272.76386689567784, -675.6942677600919, -818.5722587890325, -1006.6636422296615, -386.487995467793, -1142.8039523505615, -826.0378852836529, -126.94005637026919, -882.7506692481066, -1169.7156026630853, -1171.0455800127181, -837.5927183784975, -243.44273008964973, -921.8484255717688, -906.0549518928973, -875.0090072166009, -1022.0738542848367, -206.1231360272543, -582.9799045132814, -223.87163667286572, -540.8872711502645, -332.74766736500857], "episode_lengths": [86, 150, 150, 150, 76, 150, 150, 150, 150, 150, 54, 150, 65, 150, 109, 94, 150, 83, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 79, 150, 139, 53, 114, 150, 150, 78, 150, 150, 150, 59, 150, 102, 150, 74, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 88, 150, 150], "policy_policy_0_reward": [-227.95214599723104, -867.8247269050715, -1228.7655434595345, -1177.007877515089, -63.16274288898765, -738.4384966152221, -1206.3871847246337, -821.2188985880879, -858.5648000315106, -1062.9702051545985, -82.42946545962427, -1126.3854244098904, -83.45185237528014, -512.0609905272318, -207.44270566277106, -253.00993014933604, -329.90547380436703, -98.24166597925678, -431.8022549060226, -1102.8038210166599, -1037.045415676134, -672.8030709526156, -71.86359215547304, -1094.9587263696835, -767.9908013576913, -348.11533911455894, -953.7889445706514, -622.2834198281394, -585.3220499121891, -54.195093224233695, -713.4679585938785, -1010.6411602796904, -999.8350267571805, -734.0853616847953, -882.5429804296784, -935.3575197189489, -1032.937579226168, -1133.32378871238, -358.00295361477185, -858.7687733549769, -487.99607841528666, -795.3451151147535, -1114.5521468537652, -729.5201777090747, -968.8837167242023, -1129.2392927124727, -913.1810981910346, -1003.9174779500665, -828.9503720728972, -526.9499692422088, -1066.5356692412033, -473.9286974525264, -842.7586094955927, -849.2022829612291, -1049.3182192473814, -731.2357227447044, -758.8245432590862, -59.44342188230775, -945.8822657894302, -189.62853101221933, -922.7190242895055, -488.44803843023703, -28.127137396993366, -231.07530399669818, -1148.3642132938132, -283.35383991589464, -120.635498856346, -937.2087607051494, -336.3273443622653, -696.0390275474141, -38.49476941656852, -934.221085740747, -113.4319577373232, -780.7869724776114, -148.2224120009927, -611.5094732506399, -520.8848861741902, -991.3000775979579, -272.76386689567784, -675.6942677600919, -818.5722587890325, -1006.6636422296615, -386.487995467793, -1142.8039523505615, -826.0378852836529, -126.94005637026919, -882.7506692481066, -1169.7156026630853, -1171.0455800127181, -837.5927183784975, -243.44273008964973, -921.8484255717688, -906.0549518928973, -875.0090072166009, -1022.0738542848367, -206.1231360272543, -582.9799045132814, -223.87163667286572, -540.8872711502645, -332.74766736500857]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5634177550132868, "mean_inference_ms": 1.70111710879607, "mean_action_processing_ms": 0.28638748672184117, "mean_env_wait_ms": 2.9954171150875357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013915061950683594, "StateBufferConnector_ms": 0.009240388870239258, "ViewRequirementAgentConnector_ms": 0.19672536849975586}, "num_episodes": 30, "episode_return_max": -28.127137396993366, "episode_return_min": -1228.7655434595345, "episode_return_mean": -673.157060731996, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.7956381992817, "num_env_steps_trained_throughput_per_sec": 311.7956381992817, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12845.466, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12845.396, "sample_time_ms": 1047.605, "learn_time_ms": 11728.092, "learn_throughput": 341.061, "synch_weights_time_ms": 68.725}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00009", "date": "2024-08-03_11-05-57", "timestamp": 1722663357, "time_this_iter_s": 12.841850996017456, "time_total_s": 64.2898440361023, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246fae560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 64.2898440361023, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 14.11111111111111, "ram_util_percent": 27.649999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.097115574963391, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.282937344412009, "policy_loss": -0.017791677865413174, "vf_loss": 9.296574353178341, "vf_explained_var": 0.3645453415811062, "kl": 0.02155356907035942, "entropy": 1.5610141923030219, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -28.127137396993366, "episode_reward_min": -1306.927156475662, "episode_reward_mean": -704.86940690655, "episode_len_mean": 137.98, "episode_media": {}, "episodes_timesteps_total": 13798, "policy_reward_min": {"policy_0": -1306.927156475662}, "policy_reward_max": {"policy_0": -28.127137396993366}, "policy_reward_mean": {"policy_0": -704.86940690655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-622.2834198281394, -585.3220499121891, -54.195093224233695, -713.4679585938785, -1010.6411602796904, -999.8350267571805, -734.0853616847953, -882.5429804296784, -935.3575197189489, -1032.937579226168, -1133.32378871238, -358.00295361477185, -858.7687733549769, -487.99607841528666, -795.3451151147535, -1114.5521468537652, -729.5201777090747, -968.8837167242023, -1129.2392927124727, -913.1810981910346, -1003.9174779500665, -828.9503720728972, -526.9499692422088, -1066.5356692412033, -473.9286974525264, -842.7586094955927, -849.2022829612291, -1049.3182192473814, -731.2357227447044, -758.8245432590862, -59.44342188230775, -945.8822657894302, -189.62853101221933, -922.7190242895055, -488.44803843023703, -28.127137396993366, -231.07530399669818, -1148.3642132938132, -283.35383991589464, -120.635498856346, -937.2087607051494, -336.3273443622653, -696.0390275474141, -38.49476941656852, -934.221085740747, -113.4319577373232, -780.7869724776114, -148.2224120009927, -611.5094732506399, -520.8848861741902, -991.3000775979579, -272.76386689567784, -675.6942677600919, -818.5722587890325, -1006.6636422296615, -386.487995467793, -1142.8039523505615, -826.0378852836529, -126.94005637026919, -882.7506692481066, -1169.7156026630853, -1171.0455800127181, -837.5927183784975, -243.44273008964973, -921.8484255717688, -906.0549518928973, -875.0090072166009, -1022.0738542848367, -206.1231360272543, -582.9799045132814, -223.87163667286572, -540.8872711502645, -332.74766736500857, -894.3551827495415, -339.2496727001169, -1180.9114561440686, -1306.927156475662, -379.6417855354092, -911.0984073016106, -987.6162765558576, -1244.673592144343, -485.5033588917206, -841.0346018734654, -817.1387045948915, -1139.3955663026031, -833.605111063256, -70.59919071523856, -1166.3096968313864, -870.5136937958487, -850.1645447926186, -524.700063481695, -174.67510143363867, -60.917466565942895, -1187.9158349445781, -868.1424471911755, -436.90354343592594, -594.5503577066524, -707.0965242040187, -761.2000305981944, -962.7873457931278], "episode_lengths": [150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 79, 150, 139, 53, 114, 150, 150, 78, 150, 150, 150, 59, 150, 102, 150, 74, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 88, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 73, 150, 150, 150, 150, 73, 58, 150, 150, 124, 150, 150, 150, 150], "policy_policy_0_reward": [-622.2834198281394, -585.3220499121891, -54.195093224233695, -713.4679585938785, -1010.6411602796904, -999.8350267571805, -734.0853616847953, -882.5429804296784, -935.3575197189489, -1032.937579226168, -1133.32378871238, -358.00295361477185, -858.7687733549769, -487.99607841528666, -795.3451151147535, -1114.5521468537652, -729.5201777090747, -968.8837167242023, -1129.2392927124727, -913.1810981910346, -1003.9174779500665, -828.9503720728972, -526.9499692422088, -1066.5356692412033, -473.9286974525264, -842.7586094955927, -849.2022829612291, -1049.3182192473814, -731.2357227447044, -758.8245432590862, -59.44342188230775, -945.8822657894302, -189.62853101221933, -922.7190242895055, -488.44803843023703, -28.127137396993366, -231.07530399669818, -1148.3642132938132, -283.35383991589464, -120.635498856346, -937.2087607051494, -336.3273443622653, -696.0390275474141, -38.49476941656852, -934.221085740747, -113.4319577373232, -780.7869724776114, -148.2224120009927, -611.5094732506399, -520.8848861741902, -991.3000775979579, -272.76386689567784, -675.6942677600919, -818.5722587890325, -1006.6636422296615, -386.487995467793, -1142.8039523505615, -826.0378852836529, -126.94005637026919, -882.7506692481066, -1169.7156026630853, -1171.0455800127181, -837.5927183784975, -243.44273008964973, -921.8484255717688, -906.0549518928973, -875.0090072166009, -1022.0738542848367, -206.1231360272543, -582.9799045132814, -223.87163667286572, -540.8872711502645, -332.74766736500857, -894.3551827495415, -339.2496727001169, -1180.9114561440686, -1306.927156475662, -379.6417855354092, -911.0984073016106, -987.6162765558576, -1244.673592144343, -485.5033588917206, -841.0346018734654, -817.1387045948915, -1139.3955663026031, -833.605111063256, -70.59919071523856, -1166.3096968313864, -870.5136937958487, -850.1645447926186, -524.700063481695, -174.67510143363867, -60.917466565942895, -1187.9158349445781, -868.1424471911755, -436.90354343592594, -594.5503577066524, -707.0965242040187, -761.2000305981944, -962.7873457931278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5634865157411038, "mean_inference_ms": 1.705254939099288, "mean_action_processing_ms": 0.2868995571598824, "mean_env_wait_ms": 3.001644760287328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014014005661010742, "StateBufferConnector_ms": 0.00930023193359375, "ViewRequirementAgentConnector_ms": 0.1990678310394287}, "num_episodes": 27, "episode_return_max": -28.127137396993366, "episode_return_min": -1306.927156475662, "episode_return_mean": -704.86940690655, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.4639691119049, "num_env_steps_trained_throughput_per_sec": 311.4639691119049, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12844.987, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12844.915, "sample_time_ms": 1044.743, "learn_time_ms": 11731.332, "learn_throughput": 340.967, "synch_weights_time_ms": 67.887}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00009", "date": "2024-08-03_11-06-10", "timestamp": 1722663370, "time_this_iter_s": 12.856004476547241, "time_total_s": 77.14584851264954, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245744940>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.14584851264954, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 14.883333333333333, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.928438960636655, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.301238719125589, "policy_loss": -0.011602619386394508, "vf_loss": 9.308911659320195, "vf_explained_var": 0.3533141499385238, "kl": 0.013609786011784315, "entropy": 1.532775085667769, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -28.127137396993366, "episode_reward_min": -1306.927156475662, "episode_reward_mean": -698.4453727242304, "episode_len_mean": 137.09, "episode_media": {}, "episodes_timesteps_total": 13709, "policy_reward_min": {"policy_0": -1306.927156475662}, "policy_reward_max": {"policy_0": -28.127137396993366}, "policy_reward_mean": {"policy_0": -698.4453727242304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-945.8822657894302, -189.62853101221933, -922.7190242895055, -488.44803843023703, -28.127137396993366, -231.07530399669818, -1148.3642132938132, -283.35383991589464, -120.635498856346, -937.2087607051494, -336.3273443622653, -696.0390275474141, -38.49476941656852, -934.221085740747, -113.4319577373232, -780.7869724776114, -148.2224120009927, -611.5094732506399, -520.8848861741902, -991.3000775979579, -272.76386689567784, -675.6942677600919, -818.5722587890325, -1006.6636422296615, -386.487995467793, -1142.8039523505615, -826.0378852836529, -126.94005637026919, -882.7506692481066, -1169.7156026630853, -1171.0455800127181, -837.5927183784975, -243.44273008964973, -921.8484255717688, -906.0549518928973, -875.0090072166009, -1022.0738542848367, -206.1231360272543, -582.9799045132814, -223.87163667286572, -540.8872711502645, -332.74766736500857, -894.3551827495415, -339.2496727001169, -1180.9114561440686, -1306.927156475662, -379.6417855354092, -911.0984073016106, -987.6162765558576, -1244.673592144343, -485.5033588917206, -841.0346018734654, -817.1387045948915, -1139.3955663026031, -833.605111063256, -70.59919071523856, -1166.3096968313864, -870.5136937958487, -850.1645447926186, -524.700063481695, -174.67510143363867, -60.917466565942895, -1187.9158349445781, -868.1424471911755, -436.90354343592594, -594.5503577066524, -707.0965242040187, -761.2000305981944, -962.7873457931278, -115.05129661528734, -914.1122846408733, -1144.5847558639, -581.560154264355, -853.9016835215314, -915.2090615958571, -450.5298531958333, -778.6577038109377, -754.3085196209046, -760.2578254286237, -723.2833455009742, -668.3001642918271, -321.5448778117465, -874.7780836314079, -1292.6107766894402, -799.314093110262, -993.9446599885292, -980.5966824286298, -129.56850929864115, -495.0504504738353, -701.7961580292433, -904.7721298143526, -965.5704869773502, -1082.4325267121185, -280.3902304224242, -1204.2703127265022, -1045.2661545143171, -1284.9857912114276, -949.1828510284206, -411.82575288345987, -230.48568227185666], "episode_lengths": [150, 79, 150, 139, 53, 114, 150, 150, 78, 150, 150, 150, 59, 150, 102, 150, 74, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 88, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 73, 150, 150, 150, 150, 73, 58, 150, 150, 124, 150, 150, 150, 150, 77, 150, 150, 144, 150, 150, 126, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 98], "policy_policy_0_reward": [-945.8822657894302, -189.62853101221933, -922.7190242895055, -488.44803843023703, -28.127137396993366, -231.07530399669818, -1148.3642132938132, -283.35383991589464, -120.635498856346, -937.2087607051494, -336.3273443622653, -696.0390275474141, -38.49476941656852, -934.221085740747, -113.4319577373232, -780.7869724776114, -148.2224120009927, -611.5094732506399, -520.8848861741902, -991.3000775979579, -272.76386689567784, -675.6942677600919, -818.5722587890325, -1006.6636422296615, -386.487995467793, -1142.8039523505615, -826.0378852836529, -126.94005637026919, -882.7506692481066, -1169.7156026630853, -1171.0455800127181, -837.5927183784975, -243.44273008964973, -921.8484255717688, -906.0549518928973, -875.0090072166009, -1022.0738542848367, -206.1231360272543, -582.9799045132814, -223.87163667286572, -540.8872711502645, -332.74766736500857, -894.3551827495415, -339.2496727001169, -1180.9114561440686, -1306.927156475662, -379.6417855354092, -911.0984073016106, -987.6162765558576, -1244.673592144343, -485.5033588917206, -841.0346018734654, -817.1387045948915, -1139.3955663026031, -833.605111063256, -70.59919071523856, -1166.3096968313864, -870.5136937958487, -850.1645447926186, -524.700063481695, -174.67510143363867, -60.917466565942895, -1187.9158349445781, -868.1424471911755, -436.90354343592594, -594.5503577066524, -707.0965242040187, -761.2000305981944, -962.7873457931278, -115.05129661528734, -914.1122846408733, -1144.5847558639, -581.560154264355, -853.9016835215314, -915.2090615958571, -450.5298531958333, -778.6577038109377, -754.3085196209046, -760.2578254286237, -723.2833455009742, -668.3001642918271, -321.5448778117465, -874.7780836314079, -1292.6107766894402, -799.314093110262, -993.9446599885292, -980.5966824286298, -129.56850929864115, -495.0504504738353, -701.7961580292433, -904.7721298143526, -965.5704869773502, -1082.4325267121185, -280.3902304224242, -1204.2703127265022, -1045.2661545143171, -1284.9857912114276, -949.1828510284206, -411.82575288345987, -230.48568227185666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5624788178654885, "mean_inference_ms": 1.7086925204343737, "mean_action_processing_ms": 0.28697529215024103, "mean_env_wait_ms": 3.007027334313848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013012409210205078, "StateBufferConnector_ms": 0.008870124816894531, "ViewRequirementAgentConnector_ms": 0.1961658000946045}, "num_episodes": 31, "episode_return_max": -28.127137396993366, "episode_return_min": -1306.927156475662, "episode_return_mean": -698.4453727242304, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.7161849559525, "num_env_steps_trained_throughput_per_sec": 301.7161849559525, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12903.919, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12903.846, "sample_time_ms": 1053.093, "learn_time_ms": 11780.625, "learn_throughput": 339.541, "synch_weights_time_ms": 69.173}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00009", "date": "2024-08-03_11-06-23", "timestamp": 1722663383, "time_this_iter_s": 13.270080089569092, "time_total_s": 90.41592860221863, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246fae0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 90.41592860221863, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.826315789473684, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.491251827900609, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.530183377861977, "policy_loss": -0.013089988169182713, "vf_loss": 9.538564238945643, "vf_explained_var": 0.3002091639364759, "kl": 0.016231020927443753, "entropy": 1.6017700822403034, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -60.917466565942895, "episode_reward_min": -1306.927156475662, "episode_reward_mean": -772.2966671621581, "episode_len_mean": 141.57, "episode_media": {}, "episodes_timesteps_total": 14157, "policy_reward_min": {"policy_0": -1306.927156475662}, "policy_reward_max": {"policy_0": -60.917466565942895}, "policy_reward_mean": {"policy_0": -772.2966671621581}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-826.0378852836529, -126.94005637026919, -882.7506692481066, -1169.7156026630853, -1171.0455800127181, -837.5927183784975, -243.44273008964973, -921.8484255717688, -906.0549518928973, -875.0090072166009, -1022.0738542848367, -206.1231360272543, -582.9799045132814, -223.87163667286572, -540.8872711502645, -332.74766736500857, -894.3551827495415, -339.2496727001169, -1180.9114561440686, -1306.927156475662, -379.6417855354092, -911.0984073016106, -987.6162765558576, -1244.673592144343, -485.5033588917206, -841.0346018734654, -817.1387045948915, -1139.3955663026031, -833.605111063256, -70.59919071523856, -1166.3096968313864, -870.5136937958487, -850.1645447926186, -524.700063481695, -174.67510143363867, -60.917466565942895, -1187.9158349445781, -868.1424471911755, -436.90354343592594, -594.5503577066524, -707.0965242040187, -761.2000305981944, -962.7873457931278, -115.05129661528734, -914.1122846408733, -1144.5847558639, -581.560154264355, -853.9016835215314, -915.2090615958571, -450.5298531958333, -778.6577038109377, -754.3085196209046, -760.2578254286237, -723.2833455009742, -668.3001642918271, -321.5448778117465, -874.7780836314079, -1292.6107766894402, -799.314093110262, -993.9446599885292, -980.5966824286298, -129.56850929864115, -495.0504504738353, -701.7961580292433, -904.7721298143526, -965.5704869773502, -1082.4325267121185, -280.3902304224242, -1204.2703127265022, -1045.2661545143171, -1284.9857912114276, -949.1828510284206, -411.82575288345987, -230.48568227185666, -536.05256145539, -738.5927298392352, -859.6847011697062, -937.1276279630359, -275.6084745576088, -1009.4012970562943, -860.0193694893803, -526.096153818716, -470.95792203433865, -1203.8863318258748, -644.520624143958, -809.1987025466091, -869.1695592255458, -1121.2328056946592, -864.1590068867824, -712.1631672599723, -1181.593729874347, -1184.3101696766926, -1220.3697739780603, -598.0539528324074, -1057.1649742225727, -968.2411911229808, -684.5910063051928, -831.0890243434113, -980.960053122817, -1010.5311368320012], "episode_lengths": [150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 88, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 73, 150, 150, 150, 150, 73, 58, 150, 150, 124, 150, 150, 150, 150, 77, 150, 150, 144, 150, 150, 126, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-826.0378852836529, -126.94005637026919, -882.7506692481066, -1169.7156026630853, -1171.0455800127181, -837.5927183784975, -243.44273008964973, -921.8484255717688, -906.0549518928973, -875.0090072166009, -1022.0738542848367, -206.1231360272543, -582.9799045132814, -223.87163667286572, -540.8872711502645, -332.74766736500857, -894.3551827495415, -339.2496727001169, -1180.9114561440686, -1306.927156475662, -379.6417855354092, -911.0984073016106, -987.6162765558576, -1244.673592144343, -485.5033588917206, -841.0346018734654, -817.1387045948915, -1139.3955663026031, -833.605111063256, -70.59919071523856, -1166.3096968313864, -870.5136937958487, -850.1645447926186, -524.700063481695, -174.67510143363867, -60.917466565942895, -1187.9158349445781, -868.1424471911755, -436.90354343592594, -594.5503577066524, -707.0965242040187, -761.2000305981944, -962.7873457931278, -115.05129661528734, -914.1122846408733, -1144.5847558639, -581.560154264355, -853.9016835215314, -915.2090615958571, -450.5298531958333, -778.6577038109377, -754.3085196209046, -760.2578254286237, -723.2833455009742, -668.3001642918271, -321.5448778117465, -874.7780836314079, -1292.6107766894402, -799.314093110262, -993.9446599885292, -980.5966824286298, -129.56850929864115, -495.0504504738353, -701.7961580292433, -904.7721298143526, -965.5704869773502, -1082.4325267121185, -280.3902304224242, -1204.2703127265022, -1045.2661545143171, -1284.9857912114276, -949.1828510284206, -411.82575288345987, -230.48568227185666, -536.05256145539, -738.5927298392352, -859.6847011697062, -937.1276279630359, -275.6084745576088, -1009.4012970562943, -860.0193694893803, -526.096153818716, -470.95792203433865, -1203.8863318258748, -644.520624143958, -809.1987025466091, -869.1695592255458, -1121.2328056946592, -864.1590068867824, -712.1631672599723, -1181.593729874347, -1184.3101696766926, -1220.3697739780603, -598.0539528324074, -1057.1649742225727, -968.2411911229808, -684.5910063051928, -831.0890243434113, -980.960053122817, -1010.5311368320012]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621674811709323, "mean_inference_ms": 1.7108212069269684, "mean_action_processing_ms": 0.2867201199864833, "mean_env_wait_ms": 3.0108407605210674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013213872909545898, "StateBufferConnector_ms": 0.00863790512084961, "ViewRequirementAgentConnector_ms": 0.1996781826019287}, "num_episodes": 26, "episode_return_max": -60.917466565942895, "episode_return_min": -1306.927156475662, "episode_return_mean": -772.2966671621581, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.48821703364393, "num_env_steps_trained_throughput_per_sec": 301.48821703364393, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12949.372, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12949.293, "sample_time_ms": 1051.036, "learn_time_ms": 11827.742, "learn_throughput": 338.188, "synch_weights_time_ms": 69.56}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00009", "date": "2024-08-03_11-06-36", "timestamp": 1722663396, "time_this_iter_s": 13.280510902404785, "time_total_s": 103.69643950462341, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246faf910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 103.69643950462341, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.821052631578949, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.993723374605178, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.826865590115387, "policy_loss": -0.01563822980194042, "vf_loss": 8.83692423949639, "vf_explained_var": 0.47879018119225897, "kl": 0.01911113436544839, "entropy": 1.5373660313586395, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -60.917466565942895, "episode_reward_min": -1335.5947625657154, "episode_reward_mean": -765.123959083556, "episode_len_mean": 140.78, "episode_media": {}, "episodes_timesteps_total": 14078, "policy_reward_min": {"policy_0": -1335.5947625657154}, "policy_reward_max": {"policy_0": -60.917466565942895}, "policy_reward_mean": {"policy_0": -765.123959083556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1166.3096968313864, -870.5136937958487, -850.1645447926186, -524.700063481695, -174.67510143363867, -60.917466565942895, -1187.9158349445781, -868.1424471911755, -436.90354343592594, -594.5503577066524, -707.0965242040187, -761.2000305981944, -962.7873457931278, -115.05129661528734, -914.1122846408733, -1144.5847558639, -581.560154264355, -853.9016835215314, -915.2090615958571, -450.5298531958333, -778.6577038109377, -754.3085196209046, -760.2578254286237, -723.2833455009742, -668.3001642918271, -321.5448778117465, -874.7780836314079, -1292.6107766894402, -799.314093110262, -993.9446599885292, -980.5966824286298, -129.56850929864115, -495.0504504738353, -701.7961580292433, -904.7721298143526, -965.5704869773502, -1082.4325267121185, -280.3902304224242, -1204.2703127265022, -1045.2661545143171, -1284.9857912114276, -949.1828510284206, -411.82575288345987, -230.48568227185666, -536.05256145539, -738.5927298392352, -859.6847011697062, -937.1276279630359, -275.6084745576088, -1009.4012970562943, -860.0193694893803, -526.096153818716, -470.95792203433865, -1203.8863318258748, -644.520624143958, -809.1987025466091, -869.1695592255458, -1121.2328056946592, -864.1590068867824, -712.1631672599723, -1181.593729874347, -1184.3101696766926, -1220.3697739780603, -598.0539528324074, -1057.1649742225727, -968.2411911229808, -684.5910063051928, -831.0890243434113, -980.960053122817, -1010.5311368320012, -1067.550178909211, -503.908269545451, -925.7290694379953, -524.30895703947, -1090.899285254079, -390.3970422055129, -640.341583791108, -1112.462269770383, -562.1992550145326, -775.0869020415156, -717.9153814865862, -878.2786239084844, -1276.6880987554434, -826.9572951826385, -756.1750179134466, -1335.5947625657154, -735.598605133972, -981.9767552530112, -559.3363105374261, -811.7469282144897, -80.06087482310375, -771.1005539533129, -207.82271610688184, -949.1981629921544, -501.34336793552035, -410.39960118948613, -916.9388873852791, -545.7763955801133, -601.38838699595, -126.42081300605899], "episode_lengths": [150, 150, 150, 150, 73, 58, 150, 150, 124, 150, 150, 150, 150, 77, 150, 150, 144, 150, 150, 126, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 47, 150, 70, 150, 150, 150, 150, 150, 150, 59], "policy_policy_0_reward": [-1166.3096968313864, -870.5136937958487, -850.1645447926186, -524.700063481695, -174.67510143363867, -60.917466565942895, -1187.9158349445781, -868.1424471911755, -436.90354343592594, -594.5503577066524, -707.0965242040187, -761.2000305981944, -962.7873457931278, -115.05129661528734, -914.1122846408733, -1144.5847558639, -581.560154264355, -853.9016835215314, -915.2090615958571, -450.5298531958333, -778.6577038109377, -754.3085196209046, -760.2578254286237, -723.2833455009742, -668.3001642918271, -321.5448778117465, -874.7780836314079, -1292.6107766894402, -799.314093110262, -993.9446599885292, -980.5966824286298, -129.56850929864115, -495.0504504738353, -701.7961580292433, -904.7721298143526, -965.5704869773502, -1082.4325267121185, -280.3902304224242, -1204.2703127265022, -1045.2661545143171, -1284.9857912114276, -949.1828510284206, -411.82575288345987, -230.48568227185666, -536.05256145539, -738.5927298392352, -859.6847011697062, -937.1276279630359, -275.6084745576088, -1009.4012970562943, -860.0193694893803, -526.096153818716, -470.95792203433865, -1203.8863318258748, -644.520624143958, -809.1987025466091, -869.1695592255458, -1121.2328056946592, -864.1590068867824, -712.1631672599723, -1181.593729874347, -1184.3101696766926, -1220.3697739780603, -598.0539528324074, -1057.1649742225727, -968.2411911229808, -684.5910063051928, -831.0890243434113, -980.960053122817, -1010.5311368320012, -1067.550178909211, -503.908269545451, -925.7290694379953, -524.30895703947, -1090.899285254079, -390.3970422055129, -640.341583791108, -1112.462269770383, -562.1992550145326, -775.0869020415156, -717.9153814865862, -878.2786239084844, -1276.6880987554434, -826.9572951826385, -756.1750179134466, -1335.5947625657154, -735.598605133972, -981.9767552530112, -559.3363105374261, -811.7469282144897, -80.06087482310375, -771.1005539533129, -207.82271610688184, -949.1981629921544, -501.34336793552035, -410.39960118948613, -916.9388873852791, -545.7763955801133, -601.38838699595, -126.42081300605899]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5614039724237476, "mean_inference_ms": 1.7116186640799043, "mean_action_processing_ms": 0.28617766420238433, "mean_env_wait_ms": 3.016326086022545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012700319290161133, "StateBufferConnector_ms": 0.008340835571289062, "ViewRequirementAgentConnector_ms": 0.19693279266357422}, "num_episodes": 30, "episode_return_max": -60.917466565942895, "episode_return_min": -1335.5947625657154, "episode_return_mean": -765.123959083556, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.0113037439151, "num_env_steps_trained_throughput_per_sec": 305.0113037439151, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12967.695, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12967.617, "sample_time_ms": 1047.954, "learn_time_ms": 11847.268, "learn_throughput": 337.631, "synch_weights_time_ms": 71.451}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00009", "date": "2024-08-03_11-06-49", "timestamp": 1722663409, "time_this_iter_s": 13.127200603485107, "time_total_s": 116.82364010810852, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d3520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 116.82364010810852, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.721052631578948, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.125361250589291, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.212231417497, "policy_loss": -0.010426483081634312, "vf_loss": 9.218375685811043, "vf_explained_var": 0.4131313846757015, "kl": 0.014815362874044998, "entropy": 1.62400739826262, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -19.902153083326134, "episode_reward_min": -1371.841124087131, "episode_reward_mean": -796.9218669451938, "episode_len_mean": 141.94, "episode_media": {}, "episodes_timesteps_total": 14194, "policy_reward_min": {"policy_0": -1371.841124087131}, "policy_reward_max": {"policy_0": -19.902153083326134}, "policy_reward_mean": {"policy_0": -796.9218669451938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-993.9446599885292, -980.5966824286298, -129.56850929864115, -495.0504504738353, -701.7961580292433, -904.7721298143526, -965.5704869773502, -1082.4325267121185, -280.3902304224242, -1204.2703127265022, -1045.2661545143171, -1284.9857912114276, -949.1828510284206, -411.82575288345987, -230.48568227185666, -536.05256145539, -738.5927298392352, -859.6847011697062, -937.1276279630359, -275.6084745576088, -1009.4012970562943, -860.0193694893803, -526.096153818716, -470.95792203433865, -1203.8863318258748, -644.520624143958, -809.1987025466091, -869.1695592255458, -1121.2328056946592, -864.1590068867824, -712.1631672599723, -1181.593729874347, -1184.3101696766926, -1220.3697739780603, -598.0539528324074, -1057.1649742225727, -968.2411911229808, -684.5910063051928, -831.0890243434113, -980.960053122817, -1010.5311368320012, -1067.550178909211, -503.908269545451, -925.7290694379953, -524.30895703947, -1090.899285254079, -390.3970422055129, -640.341583791108, -1112.462269770383, -562.1992550145326, -775.0869020415156, -717.9153814865862, -878.2786239084844, -1276.6880987554434, -826.9572951826385, -756.1750179134466, -1335.5947625657154, -735.598605133972, -981.9767552530112, -559.3363105374261, -811.7469282144897, -80.06087482310375, -771.1005539533129, -207.82271610688184, -949.1981629921544, -501.34336793552035, -410.39960118948613, -916.9388873852791, -545.7763955801133, -601.38838699595, -126.42081300605899, -19.902153083326134, -394.6751327787992, -631.0888310238348, -854.7735618460321, -795.5833503463335, -115.03757059209981, -905.827663323392, -1236.8217148806498, -510.62298724498896, -707.3315044816391, -1163.322319795785, -1173.1772327025121, -1033.8339301326341, -1252.812010421636, -1041.4935909609856, -1165.4435830537648, -1207.6491374383645, -430.369304526538, -1193.1577886335865, -1371.841124087131, -342.83147652056317, -1223.396183001675, -1317.567382066417, -592.4474645240041, -557.4519251853593, -748.339468426321, -587.1552447884849, -982.3960569756832, -737.3222236898072], "episode_lengths": [150, 150, 79, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 47, 150, 70, 150, 150, 150, 150, 150, 150, 59, 49, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-993.9446599885292, -980.5966824286298, -129.56850929864115, -495.0504504738353, -701.7961580292433, -904.7721298143526, -965.5704869773502, -1082.4325267121185, -280.3902304224242, -1204.2703127265022, -1045.2661545143171, -1284.9857912114276, -949.1828510284206, -411.82575288345987, -230.48568227185666, -536.05256145539, -738.5927298392352, -859.6847011697062, -937.1276279630359, -275.6084745576088, -1009.4012970562943, -860.0193694893803, -526.096153818716, -470.95792203433865, -1203.8863318258748, -644.520624143958, -809.1987025466091, -869.1695592255458, -1121.2328056946592, -864.1590068867824, -712.1631672599723, -1181.593729874347, -1184.3101696766926, -1220.3697739780603, -598.0539528324074, -1057.1649742225727, -968.2411911229808, -684.5910063051928, -831.0890243434113, -980.960053122817, -1010.5311368320012, -1067.550178909211, -503.908269545451, -925.7290694379953, -524.30895703947, -1090.899285254079, -390.3970422055129, -640.341583791108, -1112.462269770383, -562.1992550145326, -775.0869020415156, -717.9153814865862, -878.2786239084844, -1276.6880987554434, -826.9572951826385, -756.1750179134466, -1335.5947625657154, -735.598605133972, -981.9767552530112, -559.3363105374261, -811.7469282144897, -80.06087482310375, -771.1005539533129, -207.82271610688184, -949.1981629921544, -501.34336793552035, -410.39960118948613, -916.9388873852791, -545.7763955801133, -601.38838699595, -126.42081300605899, -19.902153083326134, -394.6751327787992, -631.0888310238348, -854.7735618460321, -795.5833503463335, -115.03757059209981, -905.827663323392, -1236.8217148806498, -510.62298724498896, -707.3315044816391, -1163.322319795785, -1173.1772327025121, -1033.8339301326341, -1252.812010421636, -1041.4935909609856, -1165.4435830537648, -1207.6491374383645, -430.369304526538, -1193.1577886335865, -1371.841124087131, -342.83147652056317, -1223.396183001675, -1317.567382066417, -592.4474645240041, -557.4519251853593, -748.339468426321, -587.1552447884849, -982.3960569756832, -737.3222236898072]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5599861741304558, "mean_inference_ms": 1.7093303840556515, "mean_action_processing_ms": 0.28526000962454884, "mean_env_wait_ms": 3.019224936479375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011884927749633789, "StateBufferConnector_ms": 0.007949352264404297, "ViewRequirementAgentConnector_ms": 0.19199395179748535}, "num_episodes": 29, "episode_return_max": -19.902153083326134, "episode_return_min": -1371.841124087131, "episode_return_mean": -796.9218669451938, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.48970105476866, "num_env_steps_trained_throughput_per_sec": 298.48970105476866, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13011.006, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13010.928, "sample_time_ms": 1044.672, "learn_time_ms": 11893.343, "learn_throughput": 336.323, "synch_weights_time_ms": 71.987}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00009", "date": "2024-08-03_11-07-03", "timestamp": 1722663423, "time_this_iter_s": 13.412414073944092, "time_total_s": 130.2360541820526, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d1120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 130.2360541820526, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.478947368421053, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.970946503678958, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.461037586132685, "policy_loss": -0.017568255452594408, "vf_loss": 8.472668976585071, "vf_explained_var": 0.5823844576875369, "kl": 0.020272088750213395, "entropy": 1.447431922952334, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -19.902153083326134, "episode_reward_min": -1371.841124087131, "episode_reward_mean": -766.3122403919925, "episode_len_mean": 139.63, "episode_media": {}, "episodes_timesteps_total": 13963, "policy_reward_min": {"policy_0": -1371.841124087131}, "policy_reward_max": {"policy_0": -19.902153083326134}, "policy_reward_mean": {"policy_0": -766.3122403919925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-864.1590068867824, -712.1631672599723, -1181.593729874347, -1184.3101696766926, -1220.3697739780603, -598.0539528324074, -1057.1649742225727, -968.2411911229808, -684.5910063051928, -831.0890243434113, -980.960053122817, -1010.5311368320012, -1067.550178909211, -503.908269545451, -925.7290694379953, -524.30895703947, -1090.899285254079, -390.3970422055129, -640.341583791108, -1112.462269770383, -562.1992550145326, -775.0869020415156, -717.9153814865862, -878.2786239084844, -1276.6880987554434, -826.9572951826385, -756.1750179134466, -1335.5947625657154, -735.598605133972, -981.9767552530112, -559.3363105374261, -811.7469282144897, -80.06087482310375, -771.1005539533129, -207.82271610688184, -949.1981629921544, -501.34336793552035, -410.39960118948613, -916.9388873852791, -545.7763955801133, -601.38838699595, -126.42081300605899, -19.902153083326134, -394.6751327787992, -631.0888310238348, -854.7735618460321, -795.5833503463335, -115.03757059209981, -905.827663323392, -1236.8217148806498, -510.62298724498896, -707.3315044816391, -1163.322319795785, -1173.1772327025121, -1033.8339301326341, -1252.812010421636, -1041.4935909609856, -1165.4435830537648, -1207.6491374383645, -430.369304526538, -1193.1577886335865, -1371.841124087131, -342.83147652056317, -1223.396183001675, -1317.567382066417, -592.4474645240041, -557.4519251853593, -748.339468426321, -587.1552447884849, -982.3960569756832, -737.3222236898072, -580.0067454078041, -1240.4415068645367, -925.7413655012479, -823.2173539882267, -109.6133510777532, -90.18987900986846, -38.183698525009504, -464.7274078329324, -308.8711970010282, -738.0288129832862, -780.8921434890098, -1036.146291321301, -242.20862393218846, -676.4943715769036, -416.9907081436989, -817.0661170109177, -651.5518167524018, -62.352412253971316, -468.02333582532583, -1054.8997778656612, -978.456370633243, -576.2388933302817, -729.3380619160556, -1338.6770167477034, -553.2155067540883, -820.593896400418, -1311.572624277415, -695.059891897961, -931.925405961108], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 47, 150, 70, 150, 150, 150, 150, 150, 150, 59, 49, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 81, 49, 109, 101, 150, 150, 150, 85, 150, 150, 150, 141, 69, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-864.1590068867824, -712.1631672599723, -1181.593729874347, -1184.3101696766926, -1220.3697739780603, -598.0539528324074, -1057.1649742225727, -968.2411911229808, -684.5910063051928, -831.0890243434113, -980.960053122817, -1010.5311368320012, -1067.550178909211, -503.908269545451, -925.7290694379953, -524.30895703947, -1090.899285254079, -390.3970422055129, -640.341583791108, -1112.462269770383, -562.1992550145326, -775.0869020415156, -717.9153814865862, -878.2786239084844, -1276.6880987554434, -826.9572951826385, -756.1750179134466, -1335.5947625657154, -735.598605133972, -981.9767552530112, -559.3363105374261, -811.7469282144897, -80.06087482310375, -771.1005539533129, -207.82271610688184, -949.1981629921544, -501.34336793552035, -410.39960118948613, -916.9388873852791, -545.7763955801133, -601.38838699595, -126.42081300605899, -19.902153083326134, -394.6751327787992, -631.0888310238348, -854.7735618460321, -795.5833503463335, -115.03757059209981, -905.827663323392, -1236.8217148806498, -510.62298724498896, -707.3315044816391, -1163.322319795785, -1173.1772327025121, -1033.8339301326341, -1252.812010421636, -1041.4935909609856, -1165.4435830537648, -1207.6491374383645, -430.369304526538, -1193.1577886335865, -1371.841124087131, -342.83147652056317, -1223.396183001675, -1317.567382066417, -592.4474645240041, -557.4519251853593, -748.339468426321, -587.1552447884849, -982.3960569756832, -737.3222236898072, -580.0067454078041, -1240.4415068645367, -925.7413655012479, -823.2173539882267, -109.6133510777532, -90.18987900986846, -38.183698525009504, -464.7274078329324, -308.8711970010282, -738.0288129832862, -780.8921434890098, -1036.146291321301, -242.20862393218846, -676.4943715769036, -416.9907081436989, -817.0661170109177, -651.5518167524018, -62.352412253971316, -468.02333582532583, -1054.8997778656612, -978.456370633243, -576.2388933302817, -729.3380619160556, -1338.6770167477034, -553.2155067540883, -820.593896400418, -1311.572624277415, -695.059891897961, -931.925405961108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578258502330358, "mean_inference_ms": 1.7041654488913005, "mean_action_processing_ms": 0.28402702840326827, "mean_env_wait_ms": 3.0202510728497463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01192021369934082, "StateBufferConnector_ms": 0.007809638977050781, "ViewRequirementAgentConnector_ms": 0.18831682205200195}, "num_episodes": 29, "episode_return_max": -19.902153083326134, "episode_return_min": -1371.841124087131, "episode_return_mean": -766.3122403919925, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.8433241516662, "num_env_steps_trained_throughput_per_sec": 300.8433241516662, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13170.94, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13170.859, "sample_time_ms": 1044.046, "learn_time_ms": 12053.394, "learn_throughput": 331.857, "synch_weights_time_ms": 72.494}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00009", "date": "2024-08-03_11-07-16", "timestamp": 1722663436, "time_this_iter_s": 13.310508728027344, "time_total_s": 143.54656291007996, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245744c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 143.54656291007996, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 13.457894736842105, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.131435017411906, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.448230137427649, "policy_loss": -0.015265600360968771, "vf_loss": 8.456019956370195, "vf_explained_var": 0.6492999724422892, "kl": 0.016951334030454745, "entropy": 1.523557882135113, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -8.889829295357524, "episode_reward_min": -1371.841124087131, "episode_reward_mean": -706.4810564372896, "episode_len_mean": 135.64, "episode_media": {}, "episodes_timesteps_total": 13564, "policy_reward_min": {"policy_0": -1371.841124087131}, "policy_reward_max": {"policy_0": -8.889829295357524}, "policy_reward_mean": {"policy_0": -706.4810564372896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-735.598605133972, -981.9767552530112, -559.3363105374261, -811.7469282144897, -80.06087482310375, -771.1005539533129, -207.82271610688184, -949.1981629921544, -501.34336793552035, -410.39960118948613, -916.9388873852791, -545.7763955801133, -601.38838699595, -126.42081300605899, -19.902153083326134, -394.6751327787992, -631.0888310238348, -854.7735618460321, -795.5833503463335, -115.03757059209981, -905.827663323392, -1236.8217148806498, -510.62298724498896, -707.3315044816391, -1163.322319795785, -1173.1772327025121, -1033.8339301326341, -1252.812010421636, -1041.4935909609856, -1165.4435830537648, -1207.6491374383645, -430.369304526538, -1193.1577886335865, -1371.841124087131, -342.83147652056317, -1223.396183001675, -1317.567382066417, -592.4474645240041, -557.4519251853593, -748.339468426321, -587.1552447884849, -982.3960569756832, -737.3222236898072, -580.0067454078041, -1240.4415068645367, -925.7413655012479, -823.2173539882267, -109.6133510777532, -90.18987900986846, -38.183698525009504, -464.7274078329324, -308.8711970010282, -738.0288129832862, -780.8921434890098, -1036.146291321301, -242.20862393218846, -676.4943715769036, -416.9907081436989, -817.0661170109177, -651.5518167524018, -62.352412253971316, -468.02333582532583, -1054.8997778656612, -978.456370633243, -576.2388933302817, -729.3380619160556, -1338.6770167477034, -553.2155067540883, -820.593896400418, -1311.572624277415, -695.059891897961, -931.925405961108, -8.889829295357524, -955.7396028644192, -502.3583776532747, -465.40450111722373, -739.5312464871367, -395.82739569182576, -546.9802643421349, -776.4615886842964, -1174.5455832235682, -131.39979339169918, -675.4550834361444, -879.9042498157384, -778.2917062150791, -669.5674972417729, -1137.9190761043392, -918.4210114497533, -1020.6487205587798, -25.522890170573596, -920.362841478909, -134.75556507868112, -926.3555874164963, -665.5066256656861, -143.6905068802501, -920.5403579885707, -497.62994011628916, -1106.3531329658408, -879.2967451494544, -697.2410633252119], "episode_lengths": [150, 150, 144, 150, 47, 150, 70, 150, 150, 150, 150, 150, 150, 59, 49, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 81, 49, 109, 101, 150, 150, 150, 85, 150, 150, 150, 141, 69, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 150, 150, 103, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 45, 150, 77, 150, 150, 72, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-735.598605133972, -981.9767552530112, -559.3363105374261, -811.7469282144897, -80.06087482310375, -771.1005539533129, -207.82271610688184, -949.1981629921544, -501.34336793552035, -410.39960118948613, -916.9388873852791, -545.7763955801133, -601.38838699595, -126.42081300605899, -19.902153083326134, -394.6751327787992, -631.0888310238348, -854.7735618460321, -795.5833503463335, -115.03757059209981, -905.827663323392, -1236.8217148806498, -510.62298724498896, -707.3315044816391, -1163.322319795785, -1173.1772327025121, -1033.8339301326341, -1252.812010421636, -1041.4935909609856, -1165.4435830537648, -1207.6491374383645, -430.369304526538, -1193.1577886335865, -1371.841124087131, -342.83147652056317, -1223.396183001675, -1317.567382066417, -592.4474645240041, -557.4519251853593, -748.339468426321, -587.1552447884849, -982.3960569756832, -737.3222236898072, -580.0067454078041, -1240.4415068645367, -925.7413655012479, -823.2173539882267, -109.6133510777532, -90.18987900986846, -38.183698525009504, -464.7274078329324, -308.8711970010282, -738.0288129832862, -780.8921434890098, -1036.146291321301, -242.20862393218846, -676.4943715769036, -416.9907081436989, -817.0661170109177, -651.5518167524018, -62.352412253971316, -468.02333582532583, -1054.8997778656612, -978.456370633243, -576.2388933302817, -729.3380619160556, -1338.6770167477034, -553.2155067540883, -820.593896400418, -1311.572624277415, -695.059891897961, -931.925405961108, -8.889829295357524, -955.7396028644192, -502.3583776532747, -465.40450111722373, -739.5312464871367, -395.82739569182576, -546.9802643421349, -776.4615886842964, -1174.5455832235682, -131.39979339169918, -675.4550834361444, -879.9042498157384, -778.2917062150791, -669.5674972417729, -1137.9190761043392, -918.4210114497533, -1020.6487205587798, -25.522890170573596, -920.362841478909, -134.75556507868112, -926.3555874164963, -665.5066256656861, -143.6905068802501, -920.5403579885707, -497.62994011628916, -1106.3531329658408, -879.2967451494544, -697.2410633252119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5566261169807494, "mean_inference_ms": 1.69982780342278, "mean_action_processing_ms": 0.2832409133113488, "mean_env_wait_ms": 3.0217919705606264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011653900146484375, "StateBufferConnector_ms": 0.00777435302734375, "ViewRequirementAgentConnector_ms": 0.18775486946105957}, "num_episodes": 28, "episode_return_max": -8.889829295357524, "episode_return_min": -1371.841124087131, "episode_return_mean": -706.4810564372896, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.80321696182256, "num_env_steps_trained_throughput_per_sec": 295.80321696182256, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13179.324, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13179.243, "sample_time_ms": 1041.403, "learn_time_ms": 12064.591, "learn_throughput": 331.549, "synch_weights_time_ms": 72.333}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00009", "date": "2024-08-03_11-07-30", "timestamp": 1722663450, "time_this_iter_s": 13.534534454345703, "time_total_s": 157.08109736442566, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457463b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 157.08109736442566, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.325, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.885782511532305, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.23895521958669, "policy_loss": -0.014764342820853926, "vf_loss": 8.24687052120765, "vf_explained_var": 0.6491207003593444, "kl": 0.015578080003372954, "entropy": 1.611009182408452, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -8.889829295357524, "episode_reward_min": -1387.8975047748174, "episode_reward_mean": -724.5771850008962, "episode_len_mean": 137.4, "episode_media": {}, "episodes_timesteps_total": 13740, "policy_reward_min": {"policy_0": -1387.8975047748174}, "policy_reward_max": {"policy_0": -8.889829295357524}, "policy_reward_mean": {"policy_0": -724.5771850008962}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1165.4435830537648, -1207.6491374383645, -430.369304526538, -1193.1577886335865, -1371.841124087131, -342.83147652056317, -1223.396183001675, -1317.567382066417, -592.4474645240041, -557.4519251853593, -748.339468426321, -587.1552447884849, -982.3960569756832, -737.3222236898072, -580.0067454078041, -1240.4415068645367, -925.7413655012479, -823.2173539882267, -109.6133510777532, -90.18987900986846, -38.183698525009504, -464.7274078329324, -308.8711970010282, -738.0288129832862, -780.8921434890098, -1036.146291321301, -242.20862393218846, -676.4943715769036, -416.9907081436989, -817.0661170109177, -651.5518167524018, -62.352412253971316, -468.02333582532583, -1054.8997778656612, -978.456370633243, -576.2388933302817, -729.3380619160556, -1338.6770167477034, -553.2155067540883, -820.593896400418, -1311.572624277415, -695.059891897961, -931.925405961108, -8.889829295357524, -955.7396028644192, -502.3583776532747, -465.40450111722373, -739.5312464871367, -395.82739569182576, -546.9802643421349, -776.4615886842964, -1174.5455832235682, -131.39979339169918, -675.4550834361444, -879.9042498157384, -778.2917062150791, -669.5674972417729, -1137.9190761043392, -918.4210114497533, -1020.6487205587798, -25.522890170573596, -920.362841478909, -134.75556507868112, -926.3555874164963, -665.5066256656861, -143.6905068802501, -920.5403579885707, -497.62994011628916, -1106.3531329658408, -879.2967451494544, -697.2410633252119, -903.0109748759368, -831.0956459634903, -1365.284619232927, -195.55878893135198, -273.58127927566534, -838.9252034517974, -416.8667976232915, -1110.588656223248, -587.2103800014298, -620.8285173412489, -934.2366487087762, -939.4310492901977, -1011.0874413406804, -504.8126423118381, -842.3086551582286, -330.7738107218224, -1387.8975047748174, -144.3361668907923, -180.09541455053392, -1233.473889338507, -924.2717641292221, -1258.6296075247078, -955.7338913522074, -852.0127646075523, -429.4254807399613, -703.264148498452, -1083.5987112245298, -468.39542272191864, -518.2888922769159], "episode_lengths": [150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 81, 49, 109, 101, 150, 150, 150, 85, 150, 150, 150, 141, 69, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 150, 150, 103, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 45, 150, 77, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 102, 140, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 73, 75, 150, 150, 150, 150, 150, 105, 150, 150, 112, 150], "policy_policy_0_reward": [-1165.4435830537648, -1207.6491374383645, -430.369304526538, -1193.1577886335865, -1371.841124087131, -342.83147652056317, -1223.396183001675, -1317.567382066417, -592.4474645240041, -557.4519251853593, -748.339468426321, -587.1552447884849, -982.3960569756832, -737.3222236898072, -580.0067454078041, -1240.4415068645367, -925.7413655012479, -823.2173539882267, -109.6133510777532, -90.18987900986846, -38.183698525009504, -464.7274078329324, -308.8711970010282, -738.0288129832862, -780.8921434890098, -1036.146291321301, -242.20862393218846, -676.4943715769036, -416.9907081436989, -817.0661170109177, -651.5518167524018, -62.352412253971316, -468.02333582532583, -1054.8997778656612, -978.456370633243, -576.2388933302817, -729.3380619160556, -1338.6770167477034, -553.2155067540883, -820.593896400418, -1311.572624277415, -695.059891897961, -931.925405961108, -8.889829295357524, -955.7396028644192, -502.3583776532747, -465.40450111722373, -739.5312464871367, -395.82739569182576, -546.9802643421349, -776.4615886842964, -1174.5455832235682, -131.39979339169918, -675.4550834361444, -879.9042498157384, -778.2917062150791, -669.5674972417729, -1137.9190761043392, -918.4210114497533, -1020.6487205587798, -25.522890170573596, -920.362841478909, -134.75556507868112, -926.3555874164963, -665.5066256656861, -143.6905068802501, -920.5403579885707, -497.62994011628916, -1106.3531329658408, -879.2967451494544, -697.2410633252119, -903.0109748759368, -831.0956459634903, -1365.284619232927, -195.55878893135198, -273.58127927566534, -838.9252034517974, -416.8667976232915, -1110.588656223248, -587.2103800014298, -620.8285173412489, -934.2366487087762, -939.4310492901977, -1011.0874413406804, -504.8126423118381, -842.3086551582286, -330.7738107218224, -1387.8975047748174, -144.3361668907923, -180.09541455053392, -1233.473889338507, -924.2717641292221, -1258.6296075247078, -955.7338913522074, -852.0127646075523, -429.4254807399613, -703.264148498452, -1083.5987112245298, -468.39542272191864, -518.2888922769159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554242129950848, "mean_inference_ms": 1.6969062678439117, "mean_action_processing_ms": 0.2824563729039592, "mean_env_wait_ms": 3.023205515711227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011847972869873047, "StateBufferConnector_ms": 0.008002042770385742, "ViewRequirementAgentConnector_ms": 0.19224786758422852}, "num_episodes": 29, "episode_return_max": -8.889829295357524, "episode_return_min": -1387.8975047748174, "episode_return_mean": -724.5771850008962, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.6144808240568, "num_env_steps_trained_throughput_per_sec": 292.6144808240568, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13217.906, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13217.82, "sample_time_ms": 1044.484, "learn_time_ms": 12098.31, "learn_throughput": 330.625, "synch_weights_time_ms": 74.115}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00009", "date": "2024-08-03_11-07-44", "timestamp": 1722663464, "time_this_iter_s": 13.683425664901733, "time_total_s": 170.7645230293274, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c575120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 170.7645230293274, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.747368421052634, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.669858407974242, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.503380092978478, "policy_loss": -0.010147899117631217, "vf_loss": 8.50756063212951, "vf_explained_var": 0.6837721686189373, "kl": 0.013651342452430982, "entropy": 1.757401612152656, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -8.889829295357524, "episode_reward_min": -1444.90787744056, "episode_reward_mean": -728.7282164051271, "episode_len_mean": 137.13, "episode_media": {}, "episodes_timesteps_total": 13713, "policy_reward_min": {"policy_0": -1444.90787744056}, "policy_reward_max": {"policy_0": -8.889829295357524}, "policy_reward_mean": {"policy_0": -728.7282164051271}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-817.0661170109177, -651.5518167524018, -62.352412253971316, -468.02333582532583, -1054.8997778656612, -978.456370633243, -576.2388933302817, -729.3380619160556, -1338.6770167477034, -553.2155067540883, -820.593896400418, -1311.572624277415, -695.059891897961, -931.925405961108, -8.889829295357524, -955.7396028644192, -502.3583776532747, -465.40450111722373, -739.5312464871367, -395.82739569182576, -546.9802643421349, -776.4615886842964, -1174.5455832235682, -131.39979339169918, -675.4550834361444, -879.9042498157384, -778.2917062150791, -669.5674972417729, -1137.9190761043392, -918.4210114497533, -1020.6487205587798, -25.522890170573596, -920.362841478909, -134.75556507868112, -926.3555874164963, -665.5066256656861, -143.6905068802501, -920.5403579885707, -497.62994011628916, -1106.3531329658408, -879.2967451494544, -697.2410633252119, -903.0109748759368, -831.0956459634903, -1365.284619232927, -195.55878893135198, -273.58127927566534, -838.9252034517974, -416.8667976232915, -1110.588656223248, -587.2103800014298, -620.8285173412489, -934.2366487087762, -939.4310492901977, -1011.0874413406804, -504.8126423118381, -842.3086551582286, -330.7738107218224, -1387.8975047748174, -144.3361668907923, -180.09541455053392, -1233.473889338507, -924.2717641292221, -1258.6296075247078, -955.7338913522074, -852.0127646075523, -429.4254807399613, -703.264148498452, -1083.5987112245298, -468.39542272191864, -518.2888922769159, -1063.898152392424, -754.9005967677955, -931.6072312893124, -954.8768469602809, -683.8567167866479, -1020.9989248985099, -263.9175538151975, -727.3241290717685, -799.5954106601037, -447.24794244608347, -1197.8034839844454, -985.6778902644978, -734.1560364194526, -921.7988822013757, -1444.90787744056, -976.857267466963, -800.3514454791566, -657.5020572555148, -1002.0869706751212, -735.0844271199793, -72.36799509405152, -30.446328238673857, -919.1939756957446, -876.9611529421355, -48.71339964388846, -367.00997430919523, -562.8787773807792, -1076.4597461040887, -285.74376719185636], "episode_lengths": [150, 141, 69, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 150, 150, 103, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 45, 150, 77, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 102, 140, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 73, 75, 150, 150, 150, 150, 150, 105, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 57, 150, 150, 61, 120, 150, 150, 92], "policy_policy_0_reward": [-817.0661170109177, -651.5518167524018, -62.352412253971316, -468.02333582532583, -1054.8997778656612, -978.456370633243, -576.2388933302817, -729.3380619160556, -1338.6770167477034, -553.2155067540883, -820.593896400418, -1311.572624277415, -695.059891897961, -931.925405961108, -8.889829295357524, -955.7396028644192, -502.3583776532747, -465.40450111722373, -739.5312464871367, -395.82739569182576, -546.9802643421349, -776.4615886842964, -1174.5455832235682, -131.39979339169918, -675.4550834361444, -879.9042498157384, -778.2917062150791, -669.5674972417729, -1137.9190761043392, -918.4210114497533, -1020.6487205587798, -25.522890170573596, -920.362841478909, -134.75556507868112, -926.3555874164963, -665.5066256656861, -143.6905068802501, -920.5403579885707, -497.62994011628916, -1106.3531329658408, -879.2967451494544, -697.2410633252119, -903.0109748759368, -831.0956459634903, -1365.284619232927, -195.55878893135198, -273.58127927566534, -838.9252034517974, -416.8667976232915, -1110.588656223248, -587.2103800014298, -620.8285173412489, -934.2366487087762, -939.4310492901977, -1011.0874413406804, -504.8126423118381, -842.3086551582286, -330.7738107218224, -1387.8975047748174, -144.3361668907923, -180.09541455053392, -1233.473889338507, -924.2717641292221, -1258.6296075247078, -955.7338913522074, -852.0127646075523, -429.4254807399613, -703.264148498452, -1083.5987112245298, -468.39542272191864, -518.2888922769159, -1063.898152392424, -754.9005967677955, -931.6072312893124, -954.8768469602809, -683.8567167866479, -1020.9989248985099, -263.9175538151975, -727.3241290717685, -799.5954106601037, -447.24794244608347, -1197.8034839844454, -985.6778902644978, -734.1560364194526, -921.7988822013757, -1444.90787744056, -976.857267466963, -800.3514454791566, -657.5020572555148, -1002.0869706751212, -735.0844271199793, -72.36799509405152, -30.446328238673857, -919.1939756957446, -876.9611529421355, -48.71339964388846, -367.00997430919523, -562.8787773807792, -1076.4597461040887, -285.74376719185636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545017369048699, "mean_inference_ms": 1.6939002574023032, "mean_action_processing_ms": 0.28189955241158987, "mean_env_wait_ms": 3.0279259765001036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012103557586669922, "StateBufferConnector_ms": 0.00818324089050293, "ViewRequirementAgentConnector_ms": 0.1971423625946045}, "num_episodes": 29, "episode_return_max": -8.889829295357524, "episode_return_min": -1444.90787744056, "episode_return_mean": -728.7282164051271, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.13672282461334, "num_env_steps_trained_throughput_per_sec": 304.13672282461334, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13235.204, "restore_workers_time_ms": 0.036, "training_step_time_ms": 13235.116, "sample_time_ms": 1040.745, "learn_time_ms": 12119.3, "learn_throughput": 330.052, "synch_weights_time_ms": 74.152}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00009", "date": "2024-08-03_11-07-57", "timestamp": 1722663477, "time_this_iter_s": 13.164438486099243, "time_total_s": 183.92896151542664, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c574ee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 183.92896151542664, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.077777777777778, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.162855139126382, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.304162153104942, "policy_loss": -0.008728549239458516, "vf_loss": 8.306836507717769, "vf_explained_var": 0.642967538535595, "kl": 0.013797460225411366, "entropy": 1.5466142937541008, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -25.522890170573596, "episode_reward_min": -1444.90787744056, "episode_reward_mean": -742.573395214921, "episode_len_mean": 137.13, "episode_media": {}, "episodes_timesteps_total": 13713, "policy_reward_min": {"policy_0": -1444.90787744056}, "policy_reward_max": {"policy_0": -25.522890170573596}, "policy_reward_mean": {"policy_0": -742.573395214921}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-918.4210114497533, -1020.6487205587798, -25.522890170573596, -920.362841478909, -134.75556507868112, -926.3555874164963, -665.5066256656861, -143.6905068802501, -920.5403579885707, -497.62994011628916, -1106.3531329658408, -879.2967451494544, -697.2410633252119, -903.0109748759368, -831.0956459634903, -1365.284619232927, -195.55878893135198, -273.58127927566534, -838.9252034517974, -416.8667976232915, -1110.588656223248, -587.2103800014298, -620.8285173412489, -934.2366487087762, -939.4310492901977, -1011.0874413406804, -504.8126423118381, -842.3086551582286, -330.7738107218224, -1387.8975047748174, -144.3361668907923, -180.09541455053392, -1233.473889338507, -924.2717641292221, -1258.6296075247078, -955.7338913522074, -852.0127646075523, -429.4254807399613, -703.264148498452, -1083.5987112245298, -468.39542272191864, -518.2888922769159, -1063.898152392424, -754.9005967677955, -931.6072312893124, -954.8768469602809, -683.8567167866479, -1020.9989248985099, -263.9175538151975, -727.3241290717685, -799.5954106601037, -447.24794244608347, -1197.8034839844454, -985.6778902644978, -734.1560364194526, -921.7988822013757, -1444.90787744056, -976.857267466963, -800.3514454791566, -657.5020572555148, -1002.0869706751212, -735.0844271199793, -72.36799509405152, -30.446328238673857, -919.1939756957446, -876.9611529421355, -48.71339964388846, -367.00997430919523, -562.8787773807792, -1076.4597461040887, -285.74376719185636, -970.8231208676079, -873.9910923449228, -364.49638446175794, -1276.3192789681593, -1137.2169610084509, -304.08374941411563, -978.0740068088112, -1105.4820282047858, -1085.9519518539714, -55.48700840495201, -391.599005941067, -590.5028300269503, -1360.4049675690756, -662.0016558297531, -733.2608511207555, -772.9128104474238, -566.1948845793752, -980.1261867164658, -645.0373560782219, -380.7675509403172, -527.705595002533, -604.306256170686, -835.6433629715713, -901.2845724492536, -835.5760045680695, -1045.3998166170718, -774.090977044539, -1105.8066155154092, -347.21792224387843], "episode_lengths": [150, 150, 45, 150, 77, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 102, 140, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 73, 75, 150, 150, 150, 150, 150, 105, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 57, 150, 150, 61, 120, 150, 150, 92, 150, 150, 104, 150, 150, 90, 150, 150, 150, 53, 115, 150, 150, 150, 150, 150, 150, 150, 138, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-918.4210114497533, -1020.6487205587798, -25.522890170573596, -920.362841478909, -134.75556507868112, -926.3555874164963, -665.5066256656861, -143.6905068802501, -920.5403579885707, -497.62994011628916, -1106.3531329658408, -879.2967451494544, -697.2410633252119, -903.0109748759368, -831.0956459634903, -1365.284619232927, -195.55878893135198, -273.58127927566534, -838.9252034517974, -416.8667976232915, -1110.588656223248, -587.2103800014298, -620.8285173412489, -934.2366487087762, -939.4310492901977, -1011.0874413406804, -504.8126423118381, -842.3086551582286, -330.7738107218224, -1387.8975047748174, -144.3361668907923, -180.09541455053392, -1233.473889338507, -924.2717641292221, -1258.6296075247078, -955.7338913522074, -852.0127646075523, -429.4254807399613, -703.264148498452, -1083.5987112245298, -468.39542272191864, -518.2888922769159, -1063.898152392424, -754.9005967677955, -931.6072312893124, -954.8768469602809, -683.8567167866479, -1020.9989248985099, -263.9175538151975, -727.3241290717685, -799.5954106601037, -447.24794244608347, -1197.8034839844454, -985.6778902644978, -734.1560364194526, -921.7988822013757, -1444.90787744056, -976.857267466963, -800.3514454791566, -657.5020572555148, -1002.0869706751212, -735.0844271199793, -72.36799509405152, -30.446328238673857, -919.1939756957446, -876.9611529421355, -48.71339964388846, -367.00997430919523, -562.8787773807792, -1076.4597461040887, -285.74376719185636, -970.8231208676079, -873.9910923449228, -364.49638446175794, -1276.3192789681593, -1137.2169610084509, -304.08374941411563, -978.0740068088112, -1105.4820282047858, -1085.9519518539714, -55.48700840495201, -391.599005941067, -590.5028300269503, -1360.4049675690756, -662.0016558297531, -733.2608511207555, -772.9128104474238, -566.1948845793752, -980.1261867164658, -645.0373560782219, -380.7675509403172, -527.705595002533, -604.306256170686, -835.6433629715713, -901.2845724492536, -835.5760045680695, -1045.3998166170718, -774.090977044539, -1105.8066155154092, -347.21792224387843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543474706785732, "mean_inference_ms": 1.6934772702933523, "mean_action_processing_ms": 0.2815294571874739, "mean_env_wait_ms": 3.03316068731501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01221323013305664, "StateBufferConnector_ms": 0.008173704147338867, "ViewRequirementAgentConnector_ms": 0.20012617111206055}, "num_episodes": 29, "episode_return_max": -25.522890170573596, "episode_return_min": -1444.90787744056, "episode_return_mean": -742.573395214921, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.9543057274523, "num_env_steps_trained_throughput_per_sec": 307.9543057274523, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13251.206, "restore_workers_time_ms": 0.037, "training_step_time_ms": 13251.117, "sample_time_ms": 1044.122, "learn_time_ms": 12132.919, "learn_throughput": 329.682, "synch_weights_time_ms": 73.192}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00009", "date": "2024-08-03_11-08-10", "timestamp": 1722663490, "time_this_iter_s": 13.002051591873169, "time_total_s": 196.9310131072998, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246fac160>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 196.9310131072998, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 13.631578947368421, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.6147523013254, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.254293848077456, "policy_loss": -0.0099585282431993, "vf_loss": 8.259047082066536, "vf_explained_var": 0.702717819561561, "kl": 0.011957010607557095, "entropy": 1.7538330061982075, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -30.446328238673857, "episode_reward_min": -1444.90787744056, "episode_reward_mean": -761.6779192500723, "episode_len_mean": 137.79, "episode_media": {}, "episodes_timesteps_total": 13779, "policy_reward_min": {"policy_0": -1444.90787744056}, "policy_reward_max": {"policy_0": -30.446328238673857}, "policy_reward_mean": {"policy_0": -761.6779192500723}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1233.473889338507, -924.2717641292221, -1258.6296075247078, -955.7338913522074, -852.0127646075523, -429.4254807399613, -703.264148498452, -1083.5987112245298, -468.39542272191864, -518.2888922769159, -1063.898152392424, -754.9005967677955, -931.6072312893124, -954.8768469602809, -683.8567167866479, -1020.9989248985099, -263.9175538151975, -727.3241290717685, -799.5954106601037, -447.24794244608347, -1197.8034839844454, -985.6778902644978, -734.1560364194526, -921.7988822013757, -1444.90787744056, -976.857267466963, -800.3514454791566, -657.5020572555148, -1002.0869706751212, -735.0844271199793, -72.36799509405152, -30.446328238673857, -919.1939756957446, -876.9611529421355, -48.71339964388846, -367.00997430919523, -562.8787773807792, -1076.4597461040887, -285.74376719185636, -970.8231208676079, -873.9910923449228, -364.49638446175794, -1276.3192789681593, -1137.2169610084509, -304.08374941411563, -978.0740068088112, -1105.4820282047858, -1085.9519518539714, -55.48700840495201, -391.599005941067, -590.5028300269503, -1360.4049675690756, -662.0016558297531, -733.2608511207555, -772.9128104474238, -566.1948845793752, -980.1261867164658, -645.0373560782219, -380.7675509403172, -527.705595002533, -604.306256170686, -835.6433629715713, -901.2845724492536, -835.5760045680695, -1045.3998166170718, -774.090977044539, -1105.8066155154092, -347.21792224387843, -170.81457136129166, -956.5221997369343, -1320.842805124123, -742.4664992584073, -570.5640713293973, -1102.7293344085906, -947.8055423463835, -776.0976633299605, -948.5686636202958, -718.3229496164347, -52.56644042407702, -923.9723272940043, -905.7249011064487, -977.2429969607286, -970.0179861926933, -1055.2835438256702, -384.534953708746, -89.3297875783848, -782.498788212016, -813.2329817313691, -939.8843497226511, -1046.8134751611315, -587.0210521402494, -1242.1852816309902, -571.3308224203797, -888.8095837642713, -201.20557111394203, -762.5634204253353, -1044.7610265273331, -646.8675469032066, -248.7356268313654, -795.3908246209099], "episode_lengths": [150, 150, 150, 150, 150, 105, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 57, 150, 150, 61, 120, 150, 150, 92, 150, 150, 104, 150, 150, 90, 150, 150, 150, 53, 115, 150, 150, 150, 150, 150, 150, 150, 138, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 132, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 146, 150, 88, 150, 150, 150, 81, 150], "policy_policy_0_reward": [-1233.473889338507, -924.2717641292221, -1258.6296075247078, -955.7338913522074, -852.0127646075523, -429.4254807399613, -703.264148498452, -1083.5987112245298, -468.39542272191864, -518.2888922769159, -1063.898152392424, -754.9005967677955, -931.6072312893124, -954.8768469602809, -683.8567167866479, -1020.9989248985099, -263.9175538151975, -727.3241290717685, -799.5954106601037, -447.24794244608347, -1197.8034839844454, -985.6778902644978, -734.1560364194526, -921.7988822013757, -1444.90787744056, -976.857267466963, -800.3514454791566, -657.5020572555148, -1002.0869706751212, -735.0844271199793, -72.36799509405152, -30.446328238673857, -919.1939756957446, -876.9611529421355, -48.71339964388846, -367.00997430919523, -562.8787773807792, -1076.4597461040887, -285.74376719185636, -970.8231208676079, -873.9910923449228, -364.49638446175794, -1276.3192789681593, -1137.2169610084509, -304.08374941411563, -978.0740068088112, -1105.4820282047858, -1085.9519518539714, -55.48700840495201, -391.599005941067, -590.5028300269503, -1360.4049675690756, -662.0016558297531, -733.2608511207555, -772.9128104474238, -566.1948845793752, -980.1261867164658, -645.0373560782219, -380.7675509403172, -527.705595002533, -604.306256170686, -835.6433629715713, -901.2845724492536, -835.5760045680695, -1045.3998166170718, -774.090977044539, -1105.8066155154092, -347.21792224387843, -170.81457136129166, -956.5221997369343, -1320.842805124123, -742.4664992584073, -570.5640713293973, -1102.7293344085906, -947.8055423463835, -776.0976633299605, -948.5686636202958, -718.3229496164347, -52.56644042407702, -923.9723272940043, -905.7249011064487, -977.2429969607286, -970.0179861926933, -1055.2835438256702, -384.534953708746, -89.3297875783848, -782.498788212016, -813.2329817313691, -939.8843497226511, -1046.8134751611315, -587.0210521402494, -1242.1852816309902, -571.3308224203797, -888.8095837642713, -201.20557111394203, -762.5634204253353, -1044.7610265273331, -646.8675469032066, -248.7356268313654, -795.3908246209099]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536648286660876, "mean_inference_ms": 1.6941278762681617, "mean_action_processing_ms": 0.2811868738234813, "mean_env_wait_ms": 3.039676764289388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01247096061706543, "StateBufferConnector_ms": 0.008105278015136719, "ViewRequirementAgentConnector_ms": 0.20010662078857422}, "num_episodes": 32, "episode_return_max": -30.446328238673857, "episode_return_min": -1444.90787744056, "episode_return_mean": -761.6779192500723, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.6449551366244, "num_env_steps_trained_throughput_per_sec": 302.6449551366244, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13288.63, "restore_workers_time_ms": 0.039, "training_step_time_ms": 13288.538, "sample_time_ms": 1049.285, "learn_time_ms": 12165.421, "learn_throughput": 328.801, "synch_weights_time_ms": 72.95}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00009", "date": "2024-08-03_11-08-23", "timestamp": 1722663503, "time_this_iter_s": 13.22922968864441, "time_total_s": 210.1602427959442, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246faf640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 210.1602427959442, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.857894736842105, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.69911542435487, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.705838195482889, "policy_loss": -0.018590659200951147, "vf_loss": 7.717242960135142, "vf_explained_var": 0.8087036828200023, "kl": 0.016298290961700938, "entropy": 1.4832705620676279, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -15.62979363193092, "episode_reward_min": -1369.0180744643324, "episode_reward_mean": -693.2795097148572, "episode_len_mean": 133.38, "episode_media": {}, "episodes_timesteps_total": 13338, "policy_reward_min": {"policy_0": -1369.0180744643324}, "policy_reward_max": {"policy_0": -15.62979363193092}, "policy_reward_mean": {"policy_0": -693.2795097148572}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72.36799509405152, -30.446328238673857, -919.1939756957446, -876.9611529421355, -48.71339964388846, -367.00997430919523, -562.8787773807792, -1076.4597461040887, -285.74376719185636, -970.8231208676079, -873.9910923449228, -364.49638446175794, -1276.3192789681593, -1137.2169610084509, -304.08374941411563, -978.0740068088112, -1105.4820282047858, -1085.9519518539714, -55.48700840495201, -391.599005941067, -590.5028300269503, -1360.4049675690756, -662.0016558297531, -733.2608511207555, -772.9128104474238, -566.1948845793752, -980.1261867164658, -645.0373560782219, -380.7675509403172, -527.705595002533, -604.306256170686, -835.6433629715713, -901.2845724492536, -835.5760045680695, -1045.3998166170718, -774.090977044539, -1105.8066155154092, -347.21792224387843, -170.81457136129166, -956.5221997369343, -1320.842805124123, -742.4664992584073, -570.5640713293973, -1102.7293344085906, -947.8055423463835, -776.0976633299605, -948.5686636202958, -718.3229496164347, -52.56644042407702, -923.9723272940043, -905.7249011064487, -977.2429969607286, -970.0179861926933, -1055.2835438256702, -384.534953708746, -89.3297875783848, -782.498788212016, -813.2329817313691, -939.8843497226511, -1046.8134751611315, -587.0210521402494, -1242.1852816309902, -571.3308224203797, -888.8095837642713, -201.20557111394203, -762.5634204253353, -1044.7610265273331, -646.8675469032066, -248.7356268313654, -795.3908246209099, -356.6072514256075, -427.24433488545606, -127.88169140016937, -754.1488925911042, -15.62979363193092, -27.59693935619175, -837.8413813885313, -542.4985263910588, -1369.0180744643324, -327.1336463332169, -238.97515630957318, -63.26937694108601, -911.3423029109822, -764.3672584173655, -606.6571116272683, -414.7292069045176, -540.3965933086199, -1109.0963077656024, -954.8338992194695, -1204.5411377928865, -384.4128868281308, -1241.2459517990117, -829.1828042158817, -68.0036084310543, -851.7519199624865, -701.7911238646542, -998.6271703147529, -514.5635074839865, -489.1979394707134, -1019.1176668520064], "episode_lengths": [51, 57, 150, 150, 61, 120, 150, 150, 92, 150, 150, 104, 150, 150, 90, 150, 150, 150, 53, 115, 150, 150, 150, 150, 150, 150, 150, 138, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 132, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 146, 150, 88, 150, 150, 150, 81, 150, 150, 150, 52, 150, 43, 55, 150, 150, 150, 111, 124, 69, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 148, 58, 150, 150, 150, 118, 150, 150], "policy_policy_0_reward": [-72.36799509405152, -30.446328238673857, -919.1939756957446, -876.9611529421355, -48.71339964388846, -367.00997430919523, -562.8787773807792, -1076.4597461040887, -285.74376719185636, -970.8231208676079, -873.9910923449228, -364.49638446175794, -1276.3192789681593, -1137.2169610084509, -304.08374941411563, -978.0740068088112, -1105.4820282047858, -1085.9519518539714, -55.48700840495201, -391.599005941067, -590.5028300269503, -1360.4049675690756, -662.0016558297531, -733.2608511207555, -772.9128104474238, -566.1948845793752, -980.1261867164658, -645.0373560782219, -380.7675509403172, -527.705595002533, -604.306256170686, -835.6433629715713, -901.2845724492536, -835.5760045680695, -1045.3998166170718, -774.090977044539, -1105.8066155154092, -347.21792224387843, -170.81457136129166, -956.5221997369343, -1320.842805124123, -742.4664992584073, -570.5640713293973, -1102.7293344085906, -947.8055423463835, -776.0976633299605, -948.5686636202958, -718.3229496164347, -52.56644042407702, -923.9723272940043, -905.7249011064487, -977.2429969607286, -970.0179861926933, -1055.2835438256702, -384.534953708746, -89.3297875783848, -782.498788212016, -813.2329817313691, -939.8843497226511, -1046.8134751611315, -587.0210521402494, -1242.1852816309902, -571.3308224203797, -888.8095837642713, -201.20557111394203, -762.5634204253353, -1044.7610265273331, -646.8675469032066, -248.7356268313654, -795.3908246209099, -356.6072514256075, -427.24433488545606, -127.88169140016937, -754.1488925911042, -15.62979363193092, -27.59693935619175, -837.8413813885313, -542.4985263910588, -1369.0180744643324, -327.1336463332169, -238.97515630957318, -63.26937694108601, -911.3423029109822, -764.3672584173655, -606.6571116272683, -414.7292069045176, -540.3965933086199, -1109.0963077656024, -954.8338992194695, -1204.5411377928865, -384.4128868281308, -1241.2459517990117, -829.1828042158817, -68.0036084310543, -851.7519199624865, -701.7911238646542, -998.6271703147529, -514.5635074839865, -489.1979394707134, -1019.1176668520064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545586466877352, "mean_inference_ms": 1.6952384259857154, "mean_action_processing_ms": 0.2812473079847444, "mean_env_wait_ms": 3.0456624856684624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01210474967956543, "StateBufferConnector_ms": 0.00805354118347168, "ViewRequirementAgentConnector_ms": 0.1979374885559082}, "num_episodes": 30, "episode_return_max": -15.62979363193092, "episode_return_min": -1369.0180744643324, "episode_return_mean": -693.2795097148572, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.45067640639326, "num_env_steps_trained_throughput_per_sec": 295.45067640639326, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13316.744, "restore_workers_time_ms": 0.038, "training_step_time_ms": 13316.653, "sample_time_ms": 1045.743, "learn_time_ms": 12198.292, "learn_throughput": 327.915, "synch_weights_time_ms": 71.737}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00009", "date": "2024-08-03_11-08-37", "timestamp": 1722663517, "time_this_iter_s": 13.550735473632812, "time_total_s": 223.71097826957703, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457456c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 223.71097826957703, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.894736842105264, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.976717206835747, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.364722025394439, "policy_loss": -0.01374022550880909, "vf_loss": 8.371688603858153, "vf_explained_var": 0.7827091727405786, "kl": 0.015468355581166786, "entropy": 1.8709532448401054, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -15.62979363193092, "episode_reward_min": -1369.0180744643324, "episode_reward_mean": -697.7846260342226, "episode_len_mean": 136.0, "episode_media": {}, "episodes_timesteps_total": 13600, "policy_reward_min": {"policy_0": -1369.0180744643324}, "policy_reward_max": {"policy_0": -15.62979363193092}, "policy_reward_mean": {"policy_0": -697.7846260342226}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-645.0373560782219, -380.7675509403172, -527.705595002533, -604.306256170686, -835.6433629715713, -901.2845724492536, -835.5760045680695, -1045.3998166170718, -774.090977044539, -1105.8066155154092, -347.21792224387843, -170.81457136129166, -956.5221997369343, -1320.842805124123, -742.4664992584073, -570.5640713293973, -1102.7293344085906, -947.8055423463835, -776.0976633299605, -948.5686636202958, -718.3229496164347, -52.56644042407702, -923.9723272940043, -905.7249011064487, -977.2429969607286, -970.0179861926933, -1055.2835438256702, -384.534953708746, -89.3297875783848, -782.498788212016, -813.2329817313691, -939.8843497226511, -1046.8134751611315, -587.0210521402494, -1242.1852816309902, -571.3308224203797, -888.8095837642713, -201.20557111394203, -762.5634204253353, -1044.7610265273331, -646.8675469032066, -248.7356268313654, -795.3908246209099, -356.6072514256075, -427.24433488545606, -127.88169140016937, -754.1488925911042, -15.62979363193092, -27.59693935619175, -837.8413813885313, -542.4985263910588, -1369.0180744643324, -327.1336463332169, -238.97515630957318, -63.26937694108601, -911.3423029109822, -764.3672584173655, -606.6571116272683, -414.7292069045176, -540.3965933086199, -1109.0963077656024, -954.8338992194695, -1204.5411377928865, -384.4128868281308, -1241.2459517990117, -829.1828042158817, -68.0036084310543, -851.7519199624865, -701.7911238646542, -998.6271703147529, -514.5635074839865, -489.1979394707134, -1019.1176668520064, -1026.5003656338038, -861.5292053920822, -553.2598163420244, -1220.7151993751804, -71.81640392587079, -663.446740600042, -230.11510225466714, -656.0080472306926, -867.5302434354892, -877.4449370180544, -356.47050718546734, -675.617288978389, -1088.5849671882304, -1035.4265677063825, -145.97145113202254, -1004.6548969892672, -731.9471390830155, -794.6840655736727, -666.1184657111788, -904.1049606716749, -632.9415679757761, -873.2703493682042, -580.8196420026811, -945.5931016614177, -907.1847590700496, -344.8182376609703, -182.64149393901775], "episode_lengths": [138, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 132, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 146, 150, 88, 150, 150, 150, 81, 150, 150, 150, 52, 150, 43, 55, 150, 150, 150, 111, 124, 69, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 148, 58, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 54, 150, 105, 150, 150, 150, 136, 143, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 88], "policy_policy_0_reward": [-645.0373560782219, -380.7675509403172, -527.705595002533, -604.306256170686, -835.6433629715713, -901.2845724492536, -835.5760045680695, -1045.3998166170718, -774.090977044539, -1105.8066155154092, -347.21792224387843, -170.81457136129166, -956.5221997369343, -1320.842805124123, -742.4664992584073, -570.5640713293973, -1102.7293344085906, -947.8055423463835, -776.0976633299605, -948.5686636202958, -718.3229496164347, -52.56644042407702, -923.9723272940043, -905.7249011064487, -977.2429969607286, -970.0179861926933, -1055.2835438256702, -384.534953708746, -89.3297875783848, -782.498788212016, -813.2329817313691, -939.8843497226511, -1046.8134751611315, -587.0210521402494, -1242.1852816309902, -571.3308224203797, -888.8095837642713, -201.20557111394203, -762.5634204253353, -1044.7610265273331, -646.8675469032066, -248.7356268313654, -795.3908246209099, -356.6072514256075, -427.24433488545606, -127.88169140016937, -754.1488925911042, -15.62979363193092, -27.59693935619175, -837.8413813885313, -542.4985263910588, -1369.0180744643324, -327.1336463332169, -238.97515630957318, -63.26937694108601, -911.3423029109822, -764.3672584173655, -606.6571116272683, -414.7292069045176, -540.3965933086199, -1109.0963077656024, -954.8338992194695, -1204.5411377928865, -384.4128868281308, -1241.2459517990117, -829.1828042158817, -68.0036084310543, -851.7519199624865, -701.7911238646542, -998.6271703147529, -514.5635074839865, -489.1979394707134, -1019.1176668520064, -1026.5003656338038, -861.5292053920822, -553.2598163420244, -1220.7151993751804, -71.81640392587079, -663.446740600042, -230.11510225466714, -656.0080472306926, -867.5302434354892, -877.4449370180544, -356.47050718546734, -675.617288978389, -1088.5849671882304, -1035.4265677063825, -145.97145113202254, -1004.6548969892672, -731.9471390830155, -794.6840655736727, -666.1184657111788, -904.1049606716749, -632.9415679757761, -873.2703493682042, -580.8196420026811, -945.5931016614177, -907.1847590700496, -344.8182376609703, -182.64149393901775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554574653309894, "mean_inference_ms": 1.696692104464296, "mean_action_processing_ms": 0.2812725343089108, "mean_env_wait_ms": 3.0516496396131148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012458086013793945, "StateBufferConnector_ms": 0.008179187774658203, "ViewRequirementAgentConnector_ms": 0.19820141792297363}, "num_episodes": 27, "episode_return_max": -15.62979363193092, "episode_return_min": -1369.0180744643324, "episode_return_mean": -697.7846260342226, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.2680912284133, "num_env_steps_trained_throughput_per_sec": 301.2680912284133, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13317.712, "restore_workers_time_ms": 0.036, "training_step_time_ms": 13317.626, "sample_time_ms": 1048.803, "learn_time_ms": 12197.858, "learn_throughput": 327.926, "synch_weights_time_ms": 70.099}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00009", "date": "2024-08-03_11-08-50", "timestamp": 1722663530, "time_this_iter_s": 13.28913140296936, "time_total_s": 237.0001096725464, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245747370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 237.0001096725464, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.9, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.266857012112936, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.738041528562705, "policy_loss": -0.012642678143068527, "vf_loss": 7.743365472058455, "vf_explained_var": 0.7860429481292764, "kl": 0.016670896211629368, "entropy": 1.831404938797156, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -15.62979363193092, "episode_reward_min": -1423.2450849373877, "episode_reward_mean": -737.9700493272238, "episode_len_mean": 136.97, "episode_media": {}, "episodes_timesteps_total": 13697, "policy_reward_min": {"policy_0": -1423.2450849373877}, "policy_reward_max": {"policy_0": -15.62979363193092}, "policy_reward_mean": {"policy_0": -737.9700493272238}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-939.8843497226511, -1046.8134751611315, -587.0210521402494, -1242.1852816309902, -571.3308224203797, -888.8095837642713, -201.20557111394203, -762.5634204253353, -1044.7610265273331, -646.8675469032066, -248.7356268313654, -795.3908246209099, -356.6072514256075, -427.24433488545606, -127.88169140016937, -754.1488925911042, -15.62979363193092, -27.59693935619175, -837.8413813885313, -542.4985263910588, -1369.0180744643324, -327.1336463332169, -238.97515630957318, -63.26937694108601, -911.3423029109822, -764.3672584173655, -606.6571116272683, -414.7292069045176, -540.3965933086199, -1109.0963077656024, -954.8338992194695, -1204.5411377928865, -384.4128868281308, -1241.2459517990117, -829.1828042158817, -68.0036084310543, -851.7519199624865, -701.7911238646542, -998.6271703147529, -514.5635074839865, -489.1979394707134, -1019.1176668520064, -1026.5003656338038, -861.5292053920822, -553.2598163420244, -1220.7151993751804, -71.81640392587079, -663.446740600042, -230.11510225466714, -656.0080472306926, -867.5302434354892, -877.4449370180544, -356.47050718546734, -675.617288978389, -1088.5849671882304, -1035.4265677063825, -145.97145113202254, -1004.6548969892672, -731.9471390830155, -794.6840655736727, -666.1184657111788, -904.1049606716749, -632.9415679757761, -873.2703493682042, -580.8196420026811, -945.5931016614177, -907.1847590700496, -344.8182376609703, -182.64149393901775, -771.9203427007058, -293.6707271551002, -858.1940269393438, -1375.1440894569878, -933.697269322116, -276.4811087041132, -897.369891828478, -998.9506314377785, -976.0411135080698, -353.96230288265104, -1022.8508274410068, -310.647407639876, -1178.614239271435, -1214.262555840767, -793.7100013110194, -814.5290337259736, -1268.334926438805, -314.7917570218132, -1074.413209950218, -727.9541319208499, -1368.3989938398101, -943.8361540290401, -679.3743095699505, -290.22074031115926, -1343.6751065106002, -1137.052064586616, -1022.248672733849, -1423.2450849373877, -1166.971260560412, -1049.1824416819238, -350.77294280977793], "episode_lengths": [150, 150, 150, 150, 146, 150, 88, 150, 150, 150, 81, 150, 150, 150, 52, 150, 43, 55, 150, 150, 150, 111, 124, 69, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 148, 58, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 54, 150, 105, 150, 150, 150, 136, 143, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 88, 150, 108, 150, 150, 150, 146, 150, 150, 150, 135, 150, 92, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 117], "policy_policy_0_reward": [-939.8843497226511, -1046.8134751611315, -587.0210521402494, -1242.1852816309902, -571.3308224203797, -888.8095837642713, -201.20557111394203, -762.5634204253353, -1044.7610265273331, -646.8675469032066, -248.7356268313654, -795.3908246209099, -356.6072514256075, -427.24433488545606, -127.88169140016937, -754.1488925911042, -15.62979363193092, -27.59693935619175, -837.8413813885313, -542.4985263910588, -1369.0180744643324, -327.1336463332169, -238.97515630957318, -63.26937694108601, -911.3423029109822, -764.3672584173655, -606.6571116272683, -414.7292069045176, -540.3965933086199, -1109.0963077656024, -954.8338992194695, -1204.5411377928865, -384.4128868281308, -1241.2459517990117, -829.1828042158817, -68.0036084310543, -851.7519199624865, -701.7911238646542, -998.6271703147529, -514.5635074839865, -489.1979394707134, -1019.1176668520064, -1026.5003656338038, -861.5292053920822, -553.2598163420244, -1220.7151993751804, -71.81640392587079, -663.446740600042, -230.11510225466714, -656.0080472306926, -867.5302434354892, -877.4449370180544, -356.47050718546734, -675.617288978389, -1088.5849671882304, -1035.4265677063825, -145.97145113202254, -1004.6548969892672, -731.9471390830155, -794.6840655736727, -666.1184657111788, -904.1049606716749, -632.9415679757761, -873.2703493682042, -580.8196420026811, -945.5931016614177, -907.1847590700496, -344.8182376609703, -182.64149393901775, -771.9203427007058, -293.6707271551002, -858.1940269393438, -1375.1440894569878, -933.697269322116, -276.4811087041132, -897.369891828478, -998.9506314377785, -976.0411135080698, -353.96230288265104, -1022.8508274410068, -310.647407639876, -1178.614239271435, -1214.262555840767, -793.7100013110194, -814.5290337259736, -1268.334926438805, -314.7917570218132, -1074.413209950218, -727.9541319208499, -1368.3989938398101, -943.8361540290401, -679.3743095699505, -290.22074031115926, -1343.6751065106002, -1137.052064586616, -1022.248672733849, -1423.2450849373877, -1166.971260560412, -1049.1824416819238, -350.77294280977793]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543414652069214, "mean_inference_ms": 1.6963141434919917, "mean_action_processing_ms": 0.28110355006658955, "mean_env_wait_ms": 3.0567748878933996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012188434600830078, "StateBufferConnector_ms": 0.00807952880859375, "ViewRequirementAgentConnector_ms": 0.19549179077148438}, "num_episodes": 31, "episode_return_max": -15.62979363193092, "episode_return_min": -1423.2450849373877, "episode_return_mean": -737.9700493272238, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.99474428070266, "num_env_steps_trained_throughput_per_sec": 330.99474428070266, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13214.764, "restore_workers_time_ms": 0.036, "training_step_time_ms": 13214.678, "sample_time_ms": 1053.255, "learn_time_ms": 12093.729, "learn_throughput": 330.75, "synch_weights_time_ms": 66.841}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00009", "date": "2024-08-03_11-09-02", "timestamp": 1722663542, "time_this_iter_s": 12.095365047454834, "time_total_s": 249.09547472000122, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c576a70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 249.09547472000122, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 14.441176470588236, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.7969545374314, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.195955674846967, "policy_loss": -0.008603525395543935, "vf_loss": 7.19893519928058, "vf_explained_var": 0.7777830769618352, "kl": 0.012904681248801352, "entropy": 1.8308171878258388, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -25.363088006582167, "episode_reward_min": -1423.2450849373877, "episode_reward_mean": -795.3861224234004, "episode_len_mean": 140.01, "episode_media": {}, "episodes_timesteps_total": 14001, "policy_reward_min": {"policy_0": -1423.2450849373877}, "policy_reward_max": {"policy_0": -25.363088006582167}, "policy_reward_mean": {"policy_0": -795.3861224234004}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-414.7292069045176, -540.3965933086199, -1109.0963077656024, -954.8338992194695, -1204.5411377928865, -384.4128868281308, -1241.2459517990117, -829.1828042158817, -68.0036084310543, -851.7519199624865, -701.7911238646542, -998.6271703147529, -514.5635074839865, -489.1979394707134, -1019.1176668520064, -1026.5003656338038, -861.5292053920822, -553.2598163420244, -1220.7151993751804, -71.81640392587079, -663.446740600042, -230.11510225466714, -656.0080472306926, -867.5302434354892, -877.4449370180544, -356.47050718546734, -675.617288978389, -1088.5849671882304, -1035.4265677063825, -145.97145113202254, -1004.6548969892672, -731.9471390830155, -794.6840655736727, -666.1184657111788, -904.1049606716749, -632.9415679757761, -873.2703493682042, -580.8196420026811, -945.5931016614177, -907.1847590700496, -344.8182376609703, -182.64149393901775, -771.9203427007058, -293.6707271551002, -858.1940269393438, -1375.1440894569878, -933.697269322116, -276.4811087041132, -897.369891828478, -998.9506314377785, -976.0411135080698, -353.96230288265104, -1022.8508274410068, -310.647407639876, -1178.614239271435, -1214.262555840767, -793.7100013110194, -814.5290337259736, -1268.334926438805, -314.7917570218132, -1074.413209950218, -727.9541319208499, -1368.3989938398101, -943.8361540290401, -679.3743095699505, -290.22074031115926, -1343.6751065106002, -1137.052064586616, -1022.248672733849, -1423.2450849373877, -1166.971260560412, -1049.1824416819238, -350.77294280977793, -1305.1751434861203, -764.5124974589912, -793.4970772342416, -25.363088006582167, -786.514741612258, -982.3873255988253, -725.0231008143571, -392.4352041707305, -588.2209436094142, -1064.9515084952916, -823.0992491575932, -1029.2260520097766, -908.4146355095945, -772.0267305780533, -1280.3841903044286, -1279.854539262613, -787.3269658532894, -692.2458849382989, -816.0885320976246, -643.8573746930954, -183.8231279587137, -70.07320294345871, -1138.5124690417917, -779.2919188424094, -830.1426162292722, -1410.8211557526308, -1214.1183532938355], "episode_lengths": [150, 150, 150, 150, 150, 139, 150, 148, 58, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 54, 150, 105, 150, 150, 150, 136, 143, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 88, 150, 108, 150, 150, 150, 146, 150, 150, 150, 135, 150, 92, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 43, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 63, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-414.7292069045176, -540.3965933086199, -1109.0963077656024, -954.8338992194695, -1204.5411377928865, -384.4128868281308, -1241.2459517990117, -829.1828042158817, -68.0036084310543, -851.7519199624865, -701.7911238646542, -998.6271703147529, -514.5635074839865, -489.1979394707134, -1019.1176668520064, -1026.5003656338038, -861.5292053920822, -553.2598163420244, -1220.7151993751804, -71.81640392587079, -663.446740600042, -230.11510225466714, -656.0080472306926, -867.5302434354892, -877.4449370180544, -356.47050718546734, -675.617288978389, -1088.5849671882304, -1035.4265677063825, -145.97145113202254, -1004.6548969892672, -731.9471390830155, -794.6840655736727, -666.1184657111788, -904.1049606716749, -632.9415679757761, -873.2703493682042, -580.8196420026811, -945.5931016614177, -907.1847590700496, -344.8182376609703, -182.64149393901775, -771.9203427007058, -293.6707271551002, -858.1940269393438, -1375.1440894569878, -933.697269322116, -276.4811087041132, -897.369891828478, -998.9506314377785, -976.0411135080698, -353.96230288265104, -1022.8508274410068, -310.647407639876, -1178.614239271435, -1214.262555840767, -793.7100013110194, -814.5290337259736, -1268.334926438805, -314.7917570218132, -1074.413209950218, -727.9541319208499, -1368.3989938398101, -943.8361540290401, -679.3743095699505, -290.22074031115926, -1343.6751065106002, -1137.052064586616, -1022.248672733849, -1423.2450849373877, -1166.971260560412, -1049.1824416819238, -350.77294280977793, -1305.1751434861203, -764.5124974589912, -793.4970772342416, -25.363088006582167, -786.514741612258, -982.3873255988253, -725.0231008143571, -392.4352041707305, -588.2209436094142, -1064.9515084952916, -823.0992491575932, -1029.2260520097766, -908.4146355095945, -772.0267305780533, -1280.3841903044286, -1279.854539262613, -787.3269658532894, -692.2458849382989, -816.0885320976246, -643.8573746930954, -183.8231279587137, -70.07320294345871, -1138.5124690417917, -779.2919188424094, -830.1426162292722, -1410.8211557526308, -1214.1183532938355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541356405243836, "mean_inference_ms": 1.696124263048703, "mean_action_processing_ms": 0.2810414016761935, "mean_env_wait_ms": 3.0612063340773625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012029170989990234, "StateBufferConnector_ms": 0.007932901382446289, "ViewRequirementAgentConnector_ms": 0.19246554374694824}, "num_episodes": 27, "episode_return_max": -25.363088006582167, "episode_return_min": -1423.2450849373877, "episode_return_mean": -795.3861224234004, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.10075655694595, "num_env_steps_trained_throughput_per_sec": 308.10075655694595, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13172.961, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13172.875, "sample_time_ms": 1056.007, "learn_time_ms": 12050.692, "learn_throughput": 331.931, "synch_weights_time_ms": 65.316}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00009", "date": "2024-08-03_11-09-15", "timestamp": 1722663555, "time_this_iter_s": 12.994534015655518, "time_total_s": 262.09000873565674, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246faf370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 262.09000873565674, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.457894736842107, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.44083415766557, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.233467398087184, "policy_loss": -0.017510869497588524, "vf_loss": 7.24315306643645, "vf_explained_var": 0.8367072054495414, "kl": 0.017770186451889484, "entropy": 1.7137411241730054, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -15.719562180274611, "episode_reward_min": -1423.2450849373877, "episode_reward_mean": -815.1500267217082, "episode_len_mean": 140.32, "episode_media": {}, "episodes_timesteps_total": 14032, "policy_reward_min": {"policy_0": -1423.2450849373877}, "policy_reward_max": {"policy_0": -15.719562180274611}, "policy_reward_mean": {"policy_0": -815.1500267217082}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1035.4265677063825, -145.97145113202254, -1004.6548969892672, -731.9471390830155, -794.6840655736727, -666.1184657111788, -904.1049606716749, -632.9415679757761, -873.2703493682042, -580.8196420026811, -945.5931016614177, -907.1847590700496, -344.8182376609703, -182.64149393901775, -771.9203427007058, -293.6707271551002, -858.1940269393438, -1375.1440894569878, -933.697269322116, -276.4811087041132, -897.369891828478, -998.9506314377785, -976.0411135080698, -353.96230288265104, -1022.8508274410068, -310.647407639876, -1178.614239271435, -1214.262555840767, -793.7100013110194, -814.5290337259736, -1268.334926438805, -314.7917570218132, -1074.413209950218, -727.9541319208499, -1368.3989938398101, -943.8361540290401, -679.3743095699505, -290.22074031115926, -1343.6751065106002, -1137.052064586616, -1022.248672733849, -1423.2450849373877, -1166.971260560412, -1049.1824416819238, -350.77294280977793, -1305.1751434861203, -764.5124974589912, -793.4970772342416, -25.363088006582167, -786.514741612258, -982.3873255988253, -725.0231008143571, -392.4352041707305, -588.2209436094142, -1064.9515084952916, -823.0992491575932, -1029.2260520097766, -908.4146355095945, -772.0267305780533, -1280.3841903044286, -1279.854539262613, -787.3269658532894, -692.2458849382989, -816.0885320976246, -643.8573746930954, -183.8231279587137, -70.07320294345871, -1138.5124690417917, -779.2919188424094, -830.1426162292722, -1410.8211557526308, -1214.1183532938355, -1122.3459030505835, -1164.6439373019994, -946.7992632504993, -763.6114501632178, -578.2703252536022, -991.6692426900134, -15.719562180274611, -1238.6257789541817, -1195.2468566932926, -70.17194150306321, -1137.1021280468108, -1175.6920028974575, -679.88012742366, -941.3114674127755, -379.8382952763364, -1013.655684620487, -564.9830496766265, -871.5377568166782, -964.4791419795463, -126.50985320577834, -605.753731264424, -941.324961128674, -663.1746642364129, -794.5822904556996, -919.8519049447599, -711.0223342052534, -972.5881943704967, -896.5291296019606], "episode_lengths": [150, 55, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 88, 150, 108, 150, 150, 150, 146, 150, 150, 150, 135, 150, 92, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 43, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1035.4265677063825, -145.97145113202254, -1004.6548969892672, -731.9471390830155, -794.6840655736727, -666.1184657111788, -904.1049606716749, -632.9415679757761, -873.2703493682042, -580.8196420026811, -945.5931016614177, -907.1847590700496, -344.8182376609703, -182.64149393901775, -771.9203427007058, -293.6707271551002, -858.1940269393438, -1375.1440894569878, -933.697269322116, -276.4811087041132, -897.369891828478, -998.9506314377785, -976.0411135080698, -353.96230288265104, -1022.8508274410068, -310.647407639876, -1178.614239271435, -1214.262555840767, -793.7100013110194, -814.5290337259736, -1268.334926438805, -314.7917570218132, -1074.413209950218, -727.9541319208499, -1368.3989938398101, -943.8361540290401, -679.3743095699505, -290.22074031115926, -1343.6751065106002, -1137.052064586616, -1022.248672733849, -1423.2450849373877, -1166.971260560412, -1049.1824416819238, -350.77294280977793, -1305.1751434861203, -764.5124974589912, -793.4970772342416, -25.363088006582167, -786.514741612258, -982.3873255988253, -725.0231008143571, -392.4352041707305, -588.2209436094142, -1064.9515084952916, -823.0992491575932, -1029.2260520097766, -908.4146355095945, -772.0267305780533, -1280.3841903044286, -1279.854539262613, -787.3269658532894, -692.2458849382989, -816.0885320976246, -643.8573746930954, -183.8231279587137, -70.07320294345871, -1138.5124690417917, -779.2919188424094, -830.1426162292722, -1410.8211557526308, -1214.1183532938355, -1122.3459030505835, -1164.6439373019994, -946.7992632504993, -763.6114501632178, -578.2703252536022, -991.6692426900134, -15.719562180274611, -1238.6257789541817, -1195.2468566932926, -70.17194150306321, -1137.1021280468108, -1175.6920028974575, -679.88012742366, -941.3114674127755, -379.8382952763364, -1013.655684620487, -564.9830496766265, -871.5377568166782, -964.4791419795463, -126.50985320577834, -605.753731264424, -941.324961128674, -663.1746642364129, -794.5822904556996, -919.8519049447599, -711.0223342052534, -972.5881943704967, -896.5291296019606]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553790758658864, "mean_inference_ms": 1.6954687623342377, "mean_action_processing_ms": 0.2807937688857868, "mean_env_wait_ms": 3.0648950939373623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012033939361572266, "StateBufferConnector_ms": 0.007973194122314453, "ViewRequirementAgentConnector_ms": 0.19259405136108398}, "num_episodes": 28, "episode_return_max": -15.719562180274611, "episode_return_min": -1423.2450849373877, "episode_return_mean": -815.1500267217082, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.3305610632045, "num_env_steps_trained_throughput_per_sec": 301.3305610632045, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13170.81, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13170.723, "sample_time_ms": 1055.996, "learn_time_ms": 12050.13, "learn_throughput": 331.947, "synch_weights_time_ms": 63.745}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00009", "date": "2024-08-03_11-09-29", "timestamp": 1722663569, "time_this_iter_s": 13.286729574203491, "time_total_s": 275.37673830986023, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d1f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 275.37673830986023, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.65263157894737, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.21178744335969, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.393695686260859, "policy_loss": -0.01174094796879217, "vf_loss": 7.398424621919791, "vf_explained_var": 0.873289009121557, "kl": 0.015953712968090863, "entropy": 1.6716580517590045, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -15.719562180274611, "episode_reward_min": -1423.2450849373877, "episode_reward_mean": -793.7936123392725, "episode_len_mean": 139.16, "episode_media": {}, "episodes_timesteps_total": 13916, "policy_reward_min": {"policy_0": -1423.2450849373877}, "policy_reward_max": {"policy_0": -15.719562180274611}, "policy_reward_mean": {"policy_0": -793.7936123392725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-314.7917570218132, -1074.413209950218, -727.9541319208499, -1368.3989938398101, -943.8361540290401, -679.3743095699505, -290.22074031115926, -1343.6751065106002, -1137.052064586616, -1022.248672733849, -1423.2450849373877, -1166.971260560412, -1049.1824416819238, -350.77294280977793, -1305.1751434861203, -764.5124974589912, -793.4970772342416, -25.363088006582167, -786.514741612258, -982.3873255988253, -725.0231008143571, -392.4352041707305, -588.2209436094142, -1064.9515084952916, -823.0992491575932, -1029.2260520097766, -908.4146355095945, -772.0267305780533, -1280.3841903044286, -1279.854539262613, -787.3269658532894, -692.2458849382989, -816.0885320976246, -643.8573746930954, -183.8231279587137, -70.07320294345871, -1138.5124690417917, -779.2919188424094, -830.1426162292722, -1410.8211557526308, -1214.1183532938355, -1122.3459030505835, -1164.6439373019994, -946.7992632504993, -763.6114501632178, -578.2703252536022, -991.6692426900134, -15.719562180274611, -1238.6257789541817, -1195.2468566932926, -70.17194150306321, -1137.1021280468108, -1175.6920028974575, -679.88012742366, -941.3114674127755, -379.8382952763364, -1013.655684620487, -564.9830496766265, -871.5377568166782, -964.4791419795463, -126.50985320577834, -605.753731264424, -941.324961128674, -663.1746642364129, -794.5822904556996, -919.8519049447599, -711.0223342052534, -972.5881943704967, -896.5291296019606, -936.8118649523827, -1014.3490495002972, -223.50716209128544, -210.96764816097962, -746.2144688332667, -237.92425175144083, -127.5899610237547, -990.0661055493969, -953.1590690510159, -485.6918361102104, -981.3347688317241, -259.2161532429986, -1173.0581957364843, -665.4056688940847, -801.5950041610257, -650.3442210079312, -749.4328982084197, -825.137414438658, -727.6944142779888, -284.884746758167, -1082.6668640320886, -990.6274672744721, -644.8045946099305, -1052.7448357786218, -744.2216743355389, -66.31149877360164, -1130.3230493896867, -845.5143447053663, -1007.7457071563792, -656.9482895533081, -686.6225277154622], "episode_lengths": [108, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 43, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 68, 150, 92, 75, 150, 150, 150, 150, 103, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-314.7917570218132, -1074.413209950218, -727.9541319208499, -1368.3989938398101, -943.8361540290401, -679.3743095699505, -290.22074031115926, -1343.6751065106002, -1137.052064586616, -1022.248672733849, -1423.2450849373877, -1166.971260560412, -1049.1824416819238, -350.77294280977793, -1305.1751434861203, -764.5124974589912, -793.4970772342416, -25.363088006582167, -786.514741612258, -982.3873255988253, -725.0231008143571, -392.4352041707305, -588.2209436094142, -1064.9515084952916, -823.0992491575932, -1029.2260520097766, -908.4146355095945, -772.0267305780533, -1280.3841903044286, -1279.854539262613, -787.3269658532894, -692.2458849382989, -816.0885320976246, -643.8573746930954, -183.8231279587137, -70.07320294345871, -1138.5124690417917, -779.2919188424094, -830.1426162292722, -1410.8211557526308, -1214.1183532938355, -1122.3459030505835, -1164.6439373019994, -946.7992632504993, -763.6114501632178, -578.2703252536022, -991.6692426900134, -15.719562180274611, -1238.6257789541817, -1195.2468566932926, -70.17194150306321, -1137.1021280468108, -1175.6920028974575, -679.88012742366, -941.3114674127755, -379.8382952763364, -1013.655684620487, -564.9830496766265, -871.5377568166782, -964.4791419795463, -126.50985320577834, -605.753731264424, -941.324961128674, -663.1746642364129, -794.5822904556996, -919.8519049447599, -711.0223342052534, -972.5881943704967, -896.5291296019606, -936.8118649523827, -1014.3490495002972, -223.50716209128544, -210.96764816097962, -746.2144688332667, -237.92425175144083, -127.5899610237547, -990.0661055493969, -953.1590690510159, -485.6918361102104, -981.3347688317241, -259.2161532429986, -1173.0581957364843, -665.4056688940847, -801.5950041610257, -650.3442210079312, -749.4328982084197, -825.137414438658, -727.6944142779888, -284.884746758167, -1082.6668640320886, -990.6274672744721, -644.8045946099305, -1052.7448357786218, -744.2216743355389, -66.31149877360164, -1130.3230493896867, -845.5143447053663, -1007.7457071563792, -656.9482895533081, -686.6225277154622]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533928968040869, "mean_inference_ms": 1.6946499216351694, "mean_action_processing_ms": 0.28051274462488524, "mean_env_wait_ms": 3.0680156104907916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011876106262207031, "StateBufferConnector_ms": 0.007921934127807617, "ViewRequirementAgentConnector_ms": 0.19356131553649902}, "num_episodes": 31, "episode_return_max": -15.719562180274611, "episode_return_min": -1423.2450849373877, "episode_return_mean": -793.7936123392725, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.9239052372706, "num_env_steps_trained_throughput_per_sec": 306.9239052372706, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13121.814, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13121.727, "sample_time_ms": 1060.608, "learn_time_ms": 11995.976, "learn_throughput": 333.445, "synch_weights_time_ms": 64.255}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00009", "date": "2024-08-03_11-09-42", "timestamp": 1722663582, "time_this_iter_s": 13.045730352401733, "time_total_s": 288.42246866226196, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245745510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 288.42246866226196, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 14.066666666666665, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.856460498770076, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.084045921266079, "policy_loss": -0.01331347500430032, "vf_loss": 7.089972777664661, "vf_explained_var": 0.8818422506252924, "kl": 0.016722659814058717, "entropy": 1.385838925962647, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -15.719562180274611, "episode_reward_min": -1410.8211557526308, "episode_reward_mean": -750.6290941876582, "episode_len_mean": 136.45, "episode_media": {}, "episodes_timesteps_total": 13645, "policy_reward_min": {"policy_0": -1410.8211557526308}, "policy_reward_max": {"policy_0": -15.719562180274611}, "policy_reward_mean": {"policy_0": -750.6290941876582}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.3269658532894, -692.2458849382989, -816.0885320976246, -643.8573746930954, -183.8231279587137, -70.07320294345871, -1138.5124690417917, -779.2919188424094, -830.1426162292722, -1410.8211557526308, -1214.1183532938355, -1122.3459030505835, -1164.6439373019994, -946.7992632504993, -763.6114501632178, -578.2703252536022, -991.6692426900134, -15.719562180274611, -1238.6257789541817, -1195.2468566932926, -70.17194150306321, -1137.1021280468108, -1175.6920028974575, -679.88012742366, -941.3114674127755, -379.8382952763364, -1013.655684620487, -564.9830496766265, -871.5377568166782, -964.4791419795463, -126.50985320577834, -605.753731264424, -941.324961128674, -663.1746642364129, -794.5822904556996, -919.8519049447599, -711.0223342052534, -972.5881943704967, -896.5291296019606, -936.8118649523827, -1014.3490495002972, -223.50716209128544, -210.96764816097962, -746.2144688332667, -237.92425175144083, -127.5899610237547, -990.0661055493969, -953.1590690510159, -485.6918361102104, -981.3347688317241, -259.2161532429986, -1173.0581957364843, -665.4056688940847, -801.5950041610257, -650.3442210079312, -749.4328982084197, -825.137414438658, -727.6944142779888, -284.884746758167, -1082.6668640320886, -990.6274672744721, -644.8045946099305, -1052.7448357786218, -744.2216743355389, -66.31149877360164, -1130.3230493896867, -845.5143447053663, -1007.7457071563792, -656.9482895533081, -686.6225277154622, -1057.5129004563623, -497.37957560751556, -487.5107052040819, -1141.991498081918, -1108.4074239920947, -508.6885869361542, -391.6420240282324, -685.6236885856326, -1110.2678431294182, -52.072523789530656, -329.72995971759707, -1268.0991950625637, -651.5249546378118, -908.1974641649358, -1057.0778273671292, -1113.27914060252, -1246.380783519434, -816.32470607311, -241.12306311105579, -377.4627416088199, -106.71885252441946, -771.2717804492461, -1101.1755798319505, -1202.857469573873, -50.20719859995293, -1185.2825887209199, -443.3244341242684, -901.4565450268112, -1103.619540792568, -180.560487290951], "episode_lengths": [150, 150, 150, 150, 86, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 68, 150, 92, 75, 150, 150, 150, 150, 103, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 65, 90, 150, 150, 150, 150, 150, 150, 150, 95, 124, 66, 150, 150, 150, 59, 150, 150, 150, 150, 66], "policy_policy_0_reward": [-787.3269658532894, -692.2458849382989, -816.0885320976246, -643.8573746930954, -183.8231279587137, -70.07320294345871, -1138.5124690417917, -779.2919188424094, -830.1426162292722, -1410.8211557526308, -1214.1183532938355, -1122.3459030505835, -1164.6439373019994, -946.7992632504993, -763.6114501632178, -578.2703252536022, -991.6692426900134, -15.719562180274611, -1238.6257789541817, -1195.2468566932926, -70.17194150306321, -1137.1021280468108, -1175.6920028974575, -679.88012742366, -941.3114674127755, -379.8382952763364, -1013.655684620487, -564.9830496766265, -871.5377568166782, -964.4791419795463, -126.50985320577834, -605.753731264424, -941.324961128674, -663.1746642364129, -794.5822904556996, -919.8519049447599, -711.0223342052534, -972.5881943704967, -896.5291296019606, -936.8118649523827, -1014.3490495002972, -223.50716209128544, -210.96764816097962, -746.2144688332667, -237.92425175144083, -127.5899610237547, -990.0661055493969, -953.1590690510159, -485.6918361102104, -981.3347688317241, -259.2161532429986, -1173.0581957364843, -665.4056688940847, -801.5950041610257, -650.3442210079312, -749.4328982084197, -825.137414438658, -727.6944142779888, -284.884746758167, -1082.6668640320886, -990.6274672744721, -644.8045946099305, -1052.7448357786218, -744.2216743355389, -66.31149877360164, -1130.3230493896867, -845.5143447053663, -1007.7457071563792, -656.9482895533081, -686.6225277154622, -1057.5129004563623, -497.37957560751556, -487.5107052040819, -1141.991498081918, -1108.4074239920947, -508.6885869361542, -391.6420240282324, -685.6236885856326, -1110.2678431294182, -52.072523789530656, -329.72995971759707, -1268.0991950625637, -651.5249546378118, -908.1974641649358, -1057.0778273671292, -1113.27914060252, -1246.380783519434, -816.32470607311, -241.12306311105579, -377.4627416088199, -106.71885252441946, -771.2717804492461, -1101.1755798319505, -1202.857469573873, -50.20719859995293, -1185.2825887209199, -443.3244341242684, -901.4565450268112, -1103.619540792568, -180.560487290951]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533038045244373, "mean_inference_ms": 1.6938697343129487, "mean_action_processing_ms": 0.28016204173564463, "mean_env_wait_ms": 3.070181350505152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012206077575683594, "StateBufferConnector_ms": 0.007985115051269531, "ViewRequirementAgentConnector_ms": 0.1949138641357422}, "num_episodes": 30, "episode_return_max": -15.719562180274611, "episode_return_min": -1410.8211557526308, "episode_return_mean": -750.6290941876582, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 495.1969729294232, "num_env_steps_trained_throughput_per_sec": 495.1969729294232, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12562.587, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12562.504, "sample_time_ms": 1062.183, "learn_time_ms": 11438.79, "learn_throughput": 349.687, "synch_weights_time_ms": 60.656}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00009", "date": "2024-08-03_11-09-50", "timestamp": 1722663590, "time_this_iter_s": 8.090365886688232, "time_total_s": 296.5128345489502, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246faf370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 296.5128345489502, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.049999999999997, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.24402799506982, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.93579038977623, "policy_loss": -0.005992592678618773, "vf_loss": 6.936068188150724, "vf_explained_var": 0.8806054626901945, "kl": 0.013083999525163903, "entropy": 1.730039793252945, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -47.51041352606839, "episode_reward_min": -1499.2938434516136, "episode_reward_mean": -739.0986657954033, "episode_len_mean": 135.4, "episode_media": {}, "episodes_timesteps_total": 13540, "policy_reward_min": {"policy_0": -1499.2938434516136}, "policy_reward_max": {"policy_0": -47.51041352606839}, "policy_reward_mean": {"policy_0": -739.0986657954033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-871.5377568166782, -964.4791419795463, -126.50985320577834, -605.753731264424, -941.324961128674, -663.1746642364129, -794.5822904556996, -919.8519049447599, -711.0223342052534, -972.5881943704967, -896.5291296019606, -936.8118649523827, -1014.3490495002972, -223.50716209128544, -210.96764816097962, -746.2144688332667, -237.92425175144083, -127.5899610237547, -990.0661055493969, -953.1590690510159, -485.6918361102104, -981.3347688317241, -259.2161532429986, -1173.0581957364843, -665.4056688940847, -801.5950041610257, -650.3442210079312, -749.4328982084197, -825.137414438658, -727.6944142779888, -284.884746758167, -1082.6668640320886, -990.6274672744721, -644.8045946099305, -1052.7448357786218, -744.2216743355389, -66.31149877360164, -1130.3230493896867, -845.5143447053663, -1007.7457071563792, -656.9482895533081, -686.6225277154622, -1057.5129004563623, -497.37957560751556, -487.5107052040819, -1141.991498081918, -1108.4074239920947, -508.6885869361542, -391.6420240282324, -685.6236885856326, -1110.2678431294182, -52.072523789530656, -329.72995971759707, -1268.0991950625637, -651.5249546378118, -908.1974641649358, -1057.0778273671292, -1113.27914060252, -1246.380783519434, -816.32470607311, -241.12306311105579, -377.4627416088199, -106.71885252441946, -771.2717804492461, -1101.1755798319505, -1202.857469573873, -50.20719859995293, -1185.2825887209199, -443.3244341242684, -901.4565450268112, -1103.619540792568, -180.560487290951, -761.0615437625768, -939.2543895455984, -665.2628522028599, -511.0224153595813, -986.4944973440282, -475.48448724141764, -1499.2938434516136, -86.64279542563082, -829.420396466665, -120.41246879920884, -812.2898021230001, -432.89184461166474, -793.0161360911028, -47.51041352606839, -916.2271192427264, -830.4590063073158, -125.38839044289847, -1150.6368743693, -1254.8921366433356, -1096.079795854503, -1322.5114761339903, -643.173246691357, -920.0032010843008, -1098.0461417048132, -640.9755983008789, -751.4457208891213, -313.65773698746455, -1369.2714482107817], "episode_lengths": [150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 68, 150, 92, 75, 150, 150, 150, 150, 103, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 65, 90, 150, 150, 150, 150, 150, 150, 150, 95, 124, 66, 150, 150, 150, 59, 150, 150, 150, 150, 66, 150, 150, 126, 150, 150, 131, 150, 73, 150, 80, 150, 133, 150, 59, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150], "policy_policy_0_reward": [-871.5377568166782, -964.4791419795463, -126.50985320577834, -605.753731264424, -941.324961128674, -663.1746642364129, -794.5822904556996, -919.8519049447599, -711.0223342052534, -972.5881943704967, -896.5291296019606, -936.8118649523827, -1014.3490495002972, -223.50716209128544, -210.96764816097962, -746.2144688332667, -237.92425175144083, -127.5899610237547, -990.0661055493969, -953.1590690510159, -485.6918361102104, -981.3347688317241, -259.2161532429986, -1173.0581957364843, -665.4056688940847, -801.5950041610257, -650.3442210079312, -749.4328982084197, -825.137414438658, -727.6944142779888, -284.884746758167, -1082.6668640320886, -990.6274672744721, -644.8045946099305, -1052.7448357786218, -744.2216743355389, -66.31149877360164, -1130.3230493896867, -845.5143447053663, -1007.7457071563792, -656.9482895533081, -686.6225277154622, -1057.5129004563623, -497.37957560751556, -487.5107052040819, -1141.991498081918, -1108.4074239920947, -508.6885869361542, -391.6420240282324, -685.6236885856326, -1110.2678431294182, -52.072523789530656, -329.72995971759707, -1268.0991950625637, -651.5249546378118, -908.1974641649358, -1057.0778273671292, -1113.27914060252, -1246.380783519434, -816.32470607311, -241.12306311105579, -377.4627416088199, -106.71885252441946, -771.2717804492461, -1101.1755798319505, -1202.857469573873, -50.20719859995293, -1185.2825887209199, -443.3244341242684, -901.4565450268112, -1103.619540792568, -180.560487290951, -761.0615437625768, -939.2543895455984, -665.2628522028599, -511.0224153595813, -986.4944973440282, -475.48448724141764, -1499.2938434516136, -86.64279542563082, -829.420396466665, -120.41246879920884, -812.2898021230001, -432.89184461166474, -793.0161360911028, -47.51041352606839, -916.2271192427264, -830.4590063073158, -125.38839044289847, -1150.6368743693, -1254.8921366433356, -1096.079795854503, -1322.5114761339903, -643.173246691357, -920.0032010843008, -1098.0461417048132, -640.9755983008789, -751.4457208891213, -313.65773698746455, -1369.2714482107817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5528757807659672, "mean_inference_ms": 1.6922846972037513, "mean_action_processing_ms": 0.2798172904118945, "mean_env_wait_ms": 3.0704945629618545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012113332748413086, "StateBufferConnector_ms": 0.007880687713623047, "ViewRequirementAgentConnector_ms": 0.19164490699768066}, "num_episodes": 28, "episode_return_max": -47.51041352606839, "episode_return_min": -1499.2938434516136, "episode_return_mean": -739.0986657954033, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 454.20284096063654, "num_env_steps_trained_throughput_per_sec": 454.20284096063654, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12128.052, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12127.972, "sample_time_ms": 1059.654, "learn_time_ms": 11009.039, "learn_throughput": 363.338, "synch_weights_time_ms": 58.419}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00009", "date": "2024-08-03_11-09-59", "timestamp": 1722663599, "time_this_iter_s": 8.818693399429321, "time_total_s": 305.3315279483795, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a245745750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 305.3315279483795, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.091666666666665, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 72.10069897969564, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.097650572657585, "policy_loss": -0.012366407655160097, "vf_loss": 7.103084313372771, "vf_explained_var": 0.8474428042769432, "kl": 0.015800062773545686, "entropy": 1.7735906255741913, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -47.51041352606839, "episode_reward_min": -1499.2938434516136, "episode_reward_mean": -776.0302945410797, "episode_len_mean": 135.27, "episode_media": {}, "episodes_timesteps_total": 13527, "policy_reward_min": {"policy_0": -1499.2938434516136}, "policy_reward_max": {"policy_0": -47.51041352606839}, "policy_reward_mean": {"policy_0": -776.0302945410797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1082.6668640320886, -990.6274672744721, -644.8045946099305, -1052.7448357786218, -744.2216743355389, -66.31149877360164, -1130.3230493896867, -845.5143447053663, -1007.7457071563792, -656.9482895533081, -686.6225277154622, -1057.5129004563623, -497.37957560751556, -487.5107052040819, -1141.991498081918, -1108.4074239920947, -508.6885869361542, -391.6420240282324, -685.6236885856326, -1110.2678431294182, -52.072523789530656, -329.72995971759707, -1268.0991950625637, -651.5249546378118, -908.1974641649358, -1057.0778273671292, -1113.27914060252, -1246.380783519434, -816.32470607311, -241.12306311105579, -377.4627416088199, -106.71885252441946, -771.2717804492461, -1101.1755798319505, -1202.857469573873, -50.20719859995293, -1185.2825887209199, -443.3244341242684, -901.4565450268112, -1103.619540792568, -180.560487290951, -761.0615437625768, -939.2543895455984, -665.2628522028599, -511.0224153595813, -986.4944973440282, -475.48448724141764, -1499.2938434516136, -86.64279542563082, -829.420396466665, -120.41246879920884, -812.2898021230001, -432.89184461166474, -793.0161360911028, -47.51041352606839, -916.2271192427264, -830.4590063073158, -125.38839044289847, -1150.6368743693, -1254.8921366433356, -1096.079795854503, -1322.5114761339903, -643.173246691357, -920.0032010843008, -1098.0461417048132, -640.9755983008789, -751.4457208891213, -313.65773698746455, -1369.2714482107817, -788.3774104922597, -795.2850537086307, -869.8473201364211, -1424.2597991943587, -1212.402983133767, -907.4834092372861, -559.4063198567097, -915.2365600485585, -82.96463055461524, -1076.3549054513264, -190.46569753667902, -1040.8481143815811, -1421.883722660757, -1134.215970749387, -823.9834560236288, -935.7844631341595, -717.256193161131, -699.3080005150535, -639.8610651215457, -996.4805192362084, -82.38745609837062, -899.016348336689, -350.3371626403188, -52.10193613496098, -1354.1612229179182, -734.4913759168868, -837.8907075941208, -1194.7742555692832, -457.4091879584866, -1175.0525260418642, -835.5739658158609], "episode_lengths": [150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 65, 90, 150, 150, 150, 150, 150, 150, 150, 95, 124, 66, 150, 150, 150, 59, 150, 150, 150, 150, 66, 150, 150, 126, 150, 150, 131, 150, 73, 150, 80, 150, 133, 150, 59, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 116, 150, 58, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 105, 57, 150, 150, 150, 150, 119, 150, 150], "policy_policy_0_reward": [-1082.6668640320886, -990.6274672744721, -644.8045946099305, -1052.7448357786218, -744.2216743355389, -66.31149877360164, -1130.3230493896867, -845.5143447053663, -1007.7457071563792, -656.9482895533081, -686.6225277154622, -1057.5129004563623, -497.37957560751556, -487.5107052040819, -1141.991498081918, -1108.4074239920947, -508.6885869361542, -391.6420240282324, -685.6236885856326, -1110.2678431294182, -52.072523789530656, -329.72995971759707, -1268.0991950625637, -651.5249546378118, -908.1974641649358, -1057.0778273671292, -1113.27914060252, -1246.380783519434, -816.32470607311, -241.12306311105579, -377.4627416088199, -106.71885252441946, -771.2717804492461, -1101.1755798319505, -1202.857469573873, -50.20719859995293, -1185.2825887209199, -443.3244341242684, -901.4565450268112, -1103.619540792568, -180.560487290951, -761.0615437625768, -939.2543895455984, -665.2628522028599, -511.0224153595813, -986.4944973440282, -475.48448724141764, -1499.2938434516136, -86.64279542563082, -829.420396466665, -120.41246879920884, -812.2898021230001, -432.89184461166474, -793.0161360911028, -47.51041352606839, -916.2271192427264, -830.4590063073158, -125.38839044289847, -1150.6368743693, -1254.8921366433356, -1096.079795854503, -1322.5114761339903, -643.173246691357, -920.0032010843008, -1098.0461417048132, -640.9755983008789, -751.4457208891213, -313.65773698746455, -1369.2714482107817, -788.3774104922597, -795.2850537086307, -869.8473201364211, -1424.2597991943587, -1212.402983133767, -907.4834092372861, -559.4063198567097, -915.2365600485585, -82.96463055461524, -1076.3549054513264, -190.46569753667902, -1040.8481143815811, -1421.883722660757, -1134.215970749387, -823.9834560236288, -935.7844631341595, -717.256193161131, -699.3080005150535, -639.8610651215457, -996.4805192362084, -82.38745609837062, -899.016348336689, -350.3371626403188, -52.10193613496098, -1354.1612229179182, -734.4913759168868, -837.8907075941208, -1194.7742555692832, -457.4091879584866, -1175.0525260418642, -835.5739658158609]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552438460433571, "mean_inference_ms": 1.6909449956455018, "mean_action_processing_ms": 0.27943934384633823, "mean_env_wait_ms": 3.0726789141823234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011801004409790039, "StateBufferConnector_ms": 0.00775599479675293, "ViewRequirementAgentConnector_ms": 0.1876997947692871}, "num_episodes": 31, "episode_return_max": -47.51041352606839, "episode_return_min": -1499.2938434516136, "episode_return_mean": -776.0302945410797, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.26179058347986, "num_env_steps_trained_throughput_per_sec": 299.26179058347986, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12165.78, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12165.7, "sample_time_ms": 1055.928, "learn_time_ms": 11050.736, "learn_throughput": 361.967, "synch_weights_time_ms": 58.181}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00009", "date": "2024-08-03_11-10-12", "timestamp": 1722663612, "time_this_iter_s": 13.378839492797852, "time_total_s": 318.71036744117737, "pid": 520553, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2457475b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 318.71036744117737, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.78421052631579, "ram_util_percent": 27.7}}
