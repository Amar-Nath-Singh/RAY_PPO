{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2441198207437991, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.392255195975304, "policy_loss": -0.0024372697186966735, "vf_loss": 9.393700417876243, "vf_explained_var": -0.02751043432702621, "kl": 0.0056668850184299424, "entropy": 1.4129382065186897, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -49.47847488057629, "episode_reward_min": -1307.2427198191313, "episode_reward_mean": -710.4500130152725, "episode_len_mean": 132.875, "episode_media": {}, "episodes_timesteps_total": 3189, "policy_reward_min": {"policy_0": -1307.2427198191313}, "policy_reward_max": {"policy_0": -49.47847488057629}, "policy_reward_mean": {"policy_0": -710.4500130152725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1067.169049752396, -130.25345823683205, -171.21178292547916, -908.5309201565428, -454.6506646075044, -910.1493737108849, -782.2806589003565, -49.47847488057629, -1025.464253316449, -958.1844834056616, -566.7977115542573, -867.5219367658439, -135.06981615534679, -798.987092278168, -443.6361397833854, -534.3253578793295, -957.671563504616, -1307.2427198191313, -607.481801042367, -1293.6930203386462, -1086.289050863892, -843.1028443674288, -524.3265704505288, -627.2815676709167], "episode_lengths": [150, 71, 76, 150, 129, 150, 150, 40, 150, 150, 150, 150, 78, 150, 119, 126, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1067.169049752396, -130.25345823683205, -171.21178292547916, -908.5309201565428, -454.6506646075044, -910.1493737108849, -782.2806589003565, -49.47847488057629, -1025.464253316449, -958.1844834056616, -566.7977115542573, -867.5219367658439, -135.06981615534679, -798.987092278168, -443.6361397833854, -534.3253578793295, -957.671563504616, -1307.2427198191313, -607.481801042367, -1293.6930203386462, -1086.289050863892, -843.1028443674288, -524.3265704505288, -627.2815676709167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5475893836890536, "mean_inference_ms": 1.6530510611917781, "mean_action_processing_ms": 0.2791703054013641, "mean_env_wait_ms": 2.9680113999257665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010855992635091146, "StateBufferConnector_ms": 0.00977019468943278, "ViewRequirementAgentConnector_ms": 0.17429391543070474}, "num_episodes": 24, "episode_return_max": -49.47847488057629, "episode_return_min": -1307.2427198191313, "episode_return_mean": -710.4500130152725, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.4675385389585, "num_env_steps_trained_throughput_per_sec": 296.4675385389585, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13492.212, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13492.149, "sample_time_ms": 1017.557, "learn_time_ms": 12403.148, "learn_throughput": 322.499, "synch_weights_time_ms": 70.621}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00000", "date": "2024-08-03_10-14-08", "timestamp": 1722660248, "time_this_iter_s": 13.504883289337158, "time_total_s": 13.504883289337158, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ed0f9480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.504883289337158, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.364999999999998, "ram_util_percent": 27.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.545478589398166, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.677275792757671, "policy_loss": -0.008679675106638267, "vf_loss": 8.683491741120815, "vf_explained_var": 0.1646661068002383, "kl": 0.013061904741728842, "entropy": 1.4864511835078398, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -30.162195538055776, "episode_reward_min": -1307.2427198191313, "episode_reward_mean": -670.6946723438679, "episode_len_mean": 130.50980392156862, "episode_media": {}, "episodes_timesteps_total": 6656, "policy_reward_min": {"policy_0": -1307.2427198191313}, "policy_reward_max": {"policy_0": -30.162195538055776}, "policy_reward_mean": {"policy_0": -670.6946723438679}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1067.169049752396, -130.25345823683205, -171.21178292547916, -908.5309201565428, -454.6506646075044, -910.1493737108849, -782.2806589003565, -49.47847488057629, -1025.464253316449, -958.1844834056616, -566.7977115542573, -867.5219367658439, -135.06981615534679, -798.987092278168, -443.6361397833854, -534.3253578793295, -957.671563504616, -1307.2427198191313, -607.481801042367, -1293.6930203386462, -1086.289050863892, -843.1028443674288, -524.3265704505288, -627.2815676709167, -700.5233279908881, -870.1490877802041, -44.50638456268318, -577.2072891171383, -375.1827924877125, -1111.0373300379129, -1009.7904692185009, -884.4464479414227, -1102.5578130488261, -316.34650252662306, -125.64166802267258, -30.162195538055776, -614.2943837230724, -796.2212071228505, -753.7008607853467, -863.7613544431235, -213.2067931692607, -1280.1915100502827, -964.7449547419566, -741.3070249373259, -115.37913922741963, -959.4737909875531, -1069.7003538623576, -36.26429193132772, -974.5463869178043, -480.3823264422858, -143.90229055611624], "episode_lengths": [150, 71, 76, 150, 129, 150, 150, 40, 150, 150, 150, 150, 78, 150, 119, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 140, 150, 150, 150, 150, 124, 72, 47, 150, 150, 150, 150, 127, 150, 150, 150, 74, 150, 150, 40, 150, 150, 93], "policy_policy_0_reward": [-1067.169049752396, -130.25345823683205, -171.21178292547916, -908.5309201565428, -454.6506646075044, -910.1493737108849, -782.2806589003565, -49.47847488057629, -1025.464253316449, -958.1844834056616, -566.7977115542573, -867.5219367658439, -135.06981615534679, -798.987092278168, -443.6361397833854, -534.3253578793295, -957.671563504616, -1307.2427198191313, -607.481801042367, -1293.6930203386462, -1086.289050863892, -843.1028443674288, -524.3265704505288, -627.2815676709167, -700.5233279908881, -870.1490877802041, -44.50638456268318, -577.2072891171383, -375.1827924877125, -1111.0373300379129, -1009.7904692185009, -884.4464479414227, -1102.5578130488261, -316.34650252662306, -125.64166802267258, -30.162195538055776, -614.2943837230724, -796.2212071228505, -753.7008607853467, -863.7613544431235, -213.2067931692607, -1280.1915100502827, -964.7449547419566, -741.3070249373259, -115.37913922741963, -959.4737909875531, -1069.7003538623576, -36.26429193132772, -974.5463869178043, -480.3823264422858, -143.90229055611624]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534492279552248, "mean_inference_ms": 1.6738497713806357, "mean_action_processing_ms": 0.28245332001676915, "mean_env_wait_ms": 2.9849627210060623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013113021850585938, "StateBufferConnector_ms": 0.009103849822399663, "ViewRequirementAgentConnector_ms": 0.18079701591940486}, "num_episodes": 27, "episode_return_max": -30.162195538055776, "episode_return_min": -1307.2427198191313, "episode_return_mean": -670.6946723438679, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.16683561957194, "num_env_steps_trained_throughput_per_sec": 303.16683561957194, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13343.142, "restore_workers_time_ms": 0.038, "training_step_time_ms": 13343.059, "sample_time_ms": 1022.942, "learn_time_ms": 12250.717, "learn_throughput": 326.512, "synch_weights_time_ms": 68.561}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00000", "date": "2024-08-03_10-14-21", "timestamp": 1722660261, "time_this_iter_s": 13.205744981765747, "time_total_s": 26.710628271102905, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ed07c790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.710628271102905, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.989473684210527, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.81808060469727, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.273593812187513, "policy_loss": -0.009663348904966066, "vf_loss": 6.280380622049173, "vf_explained_var": 0.7188610212256511, "kl": 0.015149407809803965, "entropy": 1.5332432057708503, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -30.162195538055776, "episode_reward_min": -1307.2427198191313, "episode_reward_mean": -698.0536847641351, "episode_len_mean": 133.53947368421052, "episode_media": {}, "episodes_timesteps_total": 10149, "policy_reward_min": {"policy_0": -1307.2427198191313}, "policy_reward_max": {"policy_0": -30.162195538055776}, "policy_reward_mean": {"policy_0": -698.0536847641351}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1067.169049752396, -130.25345823683205, -171.21178292547916, -908.5309201565428, -454.6506646075044, -910.1493737108849, -782.2806589003565, -49.47847488057629, -1025.464253316449, -958.1844834056616, -566.7977115542573, -867.5219367658439, -135.06981615534679, -798.987092278168, -443.6361397833854, -534.3253578793295, -957.671563504616, -1307.2427198191313, -607.481801042367, -1293.6930203386462, -1086.289050863892, -843.1028443674288, -524.3265704505288, -627.2815676709167, -700.5233279908881, -870.1490877802041, -44.50638456268318, -577.2072891171383, -375.1827924877125, -1111.0373300379129, -1009.7904692185009, -884.4464479414227, -1102.5578130488261, -316.34650252662306, -125.64166802267258, -30.162195538055776, -614.2943837230724, -796.2212071228505, -753.7008607853467, -863.7613544431235, -213.2067931692607, -1280.1915100502827, -964.7449547419566, -741.3070249373259, -115.37913922741963, -959.4737909875531, -1069.7003538623576, -36.26429193132772, -974.5463869178043, -480.3823264422858, -143.90229055611624, -864.1224185564315, -381.04504170637824, -844.2382238197727, -852.4317949684894, -835.9629757429993, -866.1696935278569, -875.3326763199535, -530.8588821720305, -927.2319121686148, -1080.1632396166392, -304.24742621887464, -491.8482949650697, -937.0357455261278, -922.8610984811381, -592.69390138447, -82.87711289712342, -1098.9323752558037, -1071.9254447998176, -716.9572757967642, -1278.754379790072, -263.57884043544664, -1115.6380278826098, -250.9182231302729, -818.2609906417835, -842.5657567324645], "episode_lengths": [150, 71, 76, 150, 129, 150, 150, 40, 150, 150, 150, 150, 78, 150, 119, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 140, 150, 150, 150, 150, 124, 72, 47, 150, 150, 150, 150, 127, 150, 150, 150, 74, 150, 150, 40, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 57, 150, 150, 150, 150, 109, 150, 74, 150, 150], "policy_policy_0_reward": [-1067.169049752396, -130.25345823683205, -171.21178292547916, -908.5309201565428, -454.6506646075044, -910.1493737108849, -782.2806589003565, -49.47847488057629, -1025.464253316449, -958.1844834056616, -566.7977115542573, -867.5219367658439, -135.06981615534679, -798.987092278168, -443.6361397833854, -534.3253578793295, -957.671563504616, -1307.2427198191313, -607.481801042367, -1293.6930203386462, -1086.289050863892, -843.1028443674288, -524.3265704505288, -627.2815676709167, -700.5233279908881, -870.1490877802041, -44.50638456268318, -577.2072891171383, -375.1827924877125, -1111.0373300379129, -1009.7904692185009, -884.4464479414227, -1102.5578130488261, -316.34650252662306, -125.64166802267258, -30.162195538055776, -614.2943837230724, -796.2212071228505, -753.7008607853467, -863.7613544431235, -213.2067931692607, -1280.1915100502827, -964.7449547419566, -741.3070249373259, -115.37913922741963, -959.4737909875531, -1069.7003538623576, -36.26429193132772, -974.5463869178043, -480.3823264422858, -143.90229055611624, -864.1224185564315, -381.04504170637824, -844.2382238197727, -852.4317949684894, -835.9629757429993, -866.1696935278569, -875.3326763199535, -530.8588821720305, -927.2319121686148, -1080.1632396166392, -304.24742621887464, -491.8482949650697, -937.0357455261278, -922.8610984811381, -592.69390138447, -82.87711289712342, -1098.9323752558037, -1071.9254447998176, -716.9572757967642, -1278.754379790072, -263.57884043544664, -1115.6380278826098, -250.9182231302729, -818.2609906417835, -842.5657567324645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564957167884358, "mean_inference_ms": 1.6852017449488552, "mean_action_processing_ms": 0.2836702147256505, "mean_env_wait_ms": 2.994997295160439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012921032152677836, "StateBufferConnector_ms": 0.008887052536010742, "ViewRequirementAgentConnector_ms": 0.18514928064848246}, "num_episodes": 25, "episode_return_max": -30.162195538055776, "episode_return_min": -1307.2427198191313, "episode_return_mean": -698.0536847641351, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.42350390752415, "num_env_steps_trained_throughput_per_sec": 298.42350390752415, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13363.357, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13363.277, "sample_time_ms": 1033.809, "learn_time_ms": 12259.295, "learn_throughput": 326.283, "synch_weights_time_ms": 69.347}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00000", "date": "2024-08-03_10-14-35", "timestamp": 1722660275, "time_this_iter_s": 13.41585922241211, "time_total_s": 40.126487493515015, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecfbf400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 40.126487493515015, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.031578947368422, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 78.698510308067, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.3343532251815, "policy_loss": -0.012234694319098101, "vf_loss": 4.342767788718144, "vf_explained_var": 0.9301434775193532, "kl": 0.019880358726504715, "entropy": 1.5594764878352483, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -30.162195538055776, "episode_reward_min": -1307.2427198191313, "episode_reward_mean": -694.0884382562523, "episode_len_mean": 133.78, "episode_media": {}, "episodes_timesteps_total": 13378, "policy_reward_min": {"policy_0": -1307.2427198191313}, "policy_reward_max": {"policy_0": -30.162195538055776}, "policy_reward_mean": {"policy_0": -694.0884382562523}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.47847488057629, -1025.464253316449, -958.1844834056616, -566.7977115542573, -867.5219367658439, -135.06981615534679, -798.987092278168, -443.6361397833854, -534.3253578793295, -957.671563504616, -1307.2427198191313, -607.481801042367, -1293.6930203386462, -1086.289050863892, -843.1028443674288, -524.3265704505288, -627.2815676709167, -700.5233279908881, -870.1490877802041, -44.50638456268318, -577.2072891171383, -375.1827924877125, -1111.0373300379129, -1009.7904692185009, -884.4464479414227, -1102.5578130488261, -316.34650252662306, -125.64166802267258, -30.162195538055776, -614.2943837230724, -796.2212071228505, -753.7008607853467, -863.7613544431235, -213.2067931692607, -1280.1915100502827, -964.7449547419566, -741.3070249373259, -115.37913922741963, -959.4737909875531, -1069.7003538623576, -36.26429193132772, -974.5463869178043, -480.3823264422858, -143.90229055611624, -864.1224185564315, -381.04504170637824, -844.2382238197727, -852.4317949684894, -835.9629757429993, -866.1696935278569, -875.3326763199535, -530.8588821720305, -927.2319121686148, -1080.1632396166392, -304.24742621887464, -491.8482949650697, -937.0357455261278, -922.8610984811381, -592.69390138447, -82.87711289712342, -1098.9323752558037, -1071.9254447998176, -716.9572757967642, -1278.754379790072, -263.57884043544664, -1115.6380278826098, -250.9182231302729, -818.2609906417835, -842.5657567324645, -928.1875690338882, -844.9203526332611, -813.3056950455515, -694.4540279546295, -693.5328574036924, -966.806572207086, -845.3368947341517, -183.09106927315378, -140.2898749147248, -957.4275024118119, -123.99872199343811, -441.43381775524557, -341.78462083078483, -166.06571781441832, -1130.1837960005587, -754.7648105818832, -117.48752788988116, -878.5891641046936, -1026.4607940018338, -1063.2882724648898, -818.1071428318188, -228.01069535783822, -86.77972550104994, -842.8476980278344, -1008.8788755186587, -869.9036998811251, -800.2429497165926, -829.6587326737778, -832.8878153810048, -895.6214760813432, -456.6612218203171], "episode_lengths": [40, 150, 150, 150, 150, 78, 150, 119, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 140, 150, 150, 150, 150, 124, 72, 47, 150, 150, 150, 150, 127, 150, 150, 150, 74, 150, 150, 40, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 57, 150, 150, 150, 150, 109, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 80, 150, 81, 115, 92, 87, 150, 150, 86, 150, 150, 150, 150, 120, 70, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-49.47847488057629, -1025.464253316449, -958.1844834056616, -566.7977115542573, -867.5219367658439, -135.06981615534679, -798.987092278168, -443.6361397833854, -534.3253578793295, -957.671563504616, -1307.2427198191313, -607.481801042367, -1293.6930203386462, -1086.289050863892, -843.1028443674288, -524.3265704505288, -627.2815676709167, -700.5233279908881, -870.1490877802041, -44.50638456268318, -577.2072891171383, -375.1827924877125, -1111.0373300379129, -1009.7904692185009, -884.4464479414227, -1102.5578130488261, -316.34650252662306, -125.64166802267258, -30.162195538055776, -614.2943837230724, -796.2212071228505, -753.7008607853467, -863.7613544431235, -213.2067931692607, -1280.1915100502827, -964.7449547419566, -741.3070249373259, -115.37913922741963, -959.4737909875531, -1069.7003538623576, -36.26429193132772, -974.5463869178043, -480.3823264422858, -143.90229055611624, -864.1224185564315, -381.04504170637824, -844.2382238197727, -852.4317949684894, -835.9629757429993, -866.1696935278569, -875.3326763199535, -530.8588821720305, -927.2319121686148, -1080.1632396166392, -304.24742621887464, -491.8482949650697, -937.0357455261278, -922.8610984811381, -592.69390138447, -82.87711289712342, -1098.9323752558037, -1071.9254447998176, -716.9572757967642, -1278.754379790072, -263.57884043544664, -1115.6380278826098, -250.9182231302729, -818.2609906417835, -842.5657567324645, -928.1875690338882, -844.9203526332611, -813.3056950455515, -694.4540279546295, -693.5328574036924, -966.806572207086, -845.3368947341517, -183.09106927315378, -140.2898749147248, -957.4275024118119, -123.99872199343811, -441.43381775524557, -341.78462083078483, -166.06571781441832, -1130.1837960005587, -754.7648105818832, -117.48752788988116, -878.5891641046936, -1026.4607940018338, -1063.2882724648898, -818.1071428318188, -228.01069535783822, -86.77972550104994, -842.8476980278344, -1008.8788755186587, -869.9036998811251, -800.2429497165926, -829.6587326737778, -832.8878153810048, -895.6214760813432, -456.6612218203171]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5590062375443593, "mean_inference_ms": 1.6940906353203795, "mean_action_processing_ms": 0.2844475130385408, "mean_env_wait_ms": 3.001372799156471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013411760330200195, "StateBufferConnector_ms": 0.008942842483520508, "ViewRequirementAgentConnector_ms": 0.18929266929626465}, "num_episodes": 31, "episode_return_max": -30.162195538055776, "episode_return_min": -1307.2427198191313, "episode_return_mean": -694.0884382562523, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.84697439117826, "num_env_steps_trained_throughput_per_sec": 296.84697439117826, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13391.263, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13391.182, "sample_time_ms": 1031.679, "learn_time_ms": 12287.86, "learn_throughput": 325.525, "synch_weights_time_ms": 70.785}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00000", "date": "2024-08-03_10-14-48", "timestamp": 1722660288, "time_this_iter_s": 13.490689516067505, "time_total_s": 53.61717700958252, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ed07e290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 53.61717700958252, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.878947368421054, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 111.82432903647423, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.957286751891176, "policy_loss": -0.00774620352506948, "vf_loss": 3.9621920714775722, "vf_explained_var": 0.9506444682056705, "kl": 0.014972991555653918, "entropy": 1.5372224961717924, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -36.26429193132772, "episode_reward_min": -1280.1915100502827, "episode_reward_mean": -689.473389768405, "episode_len_mean": 134.09, "episode_media": {}, "episodes_timesteps_total": 13409, "policy_reward_min": {"policy_0": -1280.1915100502827}, "policy_reward_max": {"policy_0": -36.26429193132772}, "policy_reward_mean": {"policy_0": -689.473389768405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-796.2212071228505, -753.7008607853467, -863.7613544431235, -213.2067931692607, -1280.1915100502827, -964.7449547419566, -741.3070249373259, -115.37913922741963, -959.4737909875531, -1069.7003538623576, -36.26429193132772, -974.5463869178043, -480.3823264422858, -143.90229055611624, -864.1224185564315, -381.04504170637824, -844.2382238197727, -852.4317949684894, -835.9629757429993, -866.1696935278569, -875.3326763199535, -530.8588821720305, -927.2319121686148, -1080.1632396166392, -304.24742621887464, -491.8482949650697, -937.0357455261278, -922.8610984811381, -592.69390138447, -82.87711289712342, -1098.9323752558037, -1071.9254447998176, -716.9572757967642, -1278.754379790072, -263.57884043544664, -1115.6380278826098, -250.9182231302729, -818.2609906417835, -842.5657567324645, -928.1875690338882, -844.9203526332611, -813.3056950455515, -694.4540279546295, -693.5328574036924, -966.806572207086, -845.3368947341517, -183.09106927315378, -140.2898749147248, -957.4275024118119, -123.99872199343811, -441.43381775524557, -341.78462083078483, -166.06571781441832, -1130.1837960005587, -754.7648105818832, -117.48752788988116, -878.5891641046936, -1026.4607940018338, -1063.2882724648898, -818.1071428318188, -228.01069535783822, -86.77972550104994, -842.8476980278344, -1008.8788755186587, -869.9036998811251, -800.2429497165926, -829.6587326737778, -832.8878153810048, -895.6214760813432, -456.6612218203171, -942.2203087481123, -681.8499023737215, -154.56265058956913, -1135.895281021758, -643.7153512216624, -1006.6975418691756, -90.99352185373586, -509.36261397408606, -393.8012722486483, -801.6034691552109, -316.79464724267103, -213.9534096268637, -912.6666480732539, -82.57169177327351, -812.5051808485156, -1006.5751188506187, -362.5436200223047, -1033.9233340161588, -995.3527898254735, -672.2809942145515, -939.8334710559668, -1136.431649966814, -682.3603510835632, -219.2632634578243, -148.49965257694694, -376.45107266537667, -1240.55499627789, -573.5712952978606, -986.6624811359064, -853.3976662200226], "episode_lengths": [150, 150, 150, 127, 150, 150, 150, 74, 150, 150, 40, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 57, 150, 150, 150, 150, 109, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 80, 150, 81, 115, 92, 87, 150, 150, 86, 150, 150, 150, 150, 120, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 142, 150, 74, 150, 134, 150, 104, 97, 150, 61, 150, 150, 100, 150, 150, 150, 150, 150, 150, 127, 85, 113, 150, 150, 150, 150], "policy_policy_0_reward": [-796.2212071228505, -753.7008607853467, -863.7613544431235, -213.2067931692607, -1280.1915100502827, -964.7449547419566, -741.3070249373259, -115.37913922741963, -959.4737909875531, -1069.7003538623576, -36.26429193132772, -974.5463869178043, -480.3823264422858, -143.90229055611624, -864.1224185564315, -381.04504170637824, -844.2382238197727, -852.4317949684894, -835.9629757429993, -866.1696935278569, -875.3326763199535, -530.8588821720305, -927.2319121686148, -1080.1632396166392, -304.24742621887464, -491.8482949650697, -937.0357455261278, -922.8610984811381, -592.69390138447, -82.87711289712342, -1098.9323752558037, -1071.9254447998176, -716.9572757967642, -1278.754379790072, -263.57884043544664, -1115.6380278826098, -250.9182231302729, -818.2609906417835, -842.5657567324645, -928.1875690338882, -844.9203526332611, -813.3056950455515, -694.4540279546295, -693.5328574036924, -966.806572207086, -845.3368947341517, -183.09106927315378, -140.2898749147248, -957.4275024118119, -123.99872199343811, -441.43381775524557, -341.78462083078483, -166.06571781441832, -1130.1837960005587, -754.7648105818832, -117.48752788988116, -878.5891641046936, -1026.4607940018338, -1063.2882724648898, -818.1071428318188, -228.01069535783822, -86.77972550104994, -842.8476980278344, -1008.8788755186587, -869.9036998811251, -800.2429497165926, -829.6587326737778, -832.8878153810048, -895.6214760813432, -456.6612218203171, -942.2203087481123, -681.8499023737215, -154.56265058956913, -1135.895281021758, -643.7153512216624, -1006.6975418691756, -90.99352185373586, -509.36261397408606, -393.8012722486483, -801.6034691552109, -316.79464724267103, -213.9534096268637, -912.6666480732539, -82.57169177327351, -812.5051808485156, -1006.5751188506187, -362.5436200223047, -1033.9233340161588, -995.3527898254735, -672.2809942145515, -939.8334710559668, -1136.431649966814, -682.3603510835632, -219.2632634578243, -148.49965257694694, -376.45107266537667, -1240.55499627789, -573.5712952978606, -986.6624811359064, -853.3976662200226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5626865292353517, "mean_inference_ms": 1.7098408019282276, "mean_action_processing_ms": 0.28619079236566525, "mean_env_wait_ms": 3.015976961319664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0136566162109375, "StateBufferConnector_ms": 0.008694648742675781, "ViewRequirementAgentConnector_ms": 0.19411921501159668}, "num_episodes": 30, "episode_return_max": -36.26429193132772, "episode_return_min": -1280.1915100502827, "episode_return_mean": -689.473389768405, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.79079501517054, "num_env_steps_trained_throughput_per_sec": 361.79079501517054, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12924.236, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12924.156, "sample_time_ms": 1033.845, "learn_time_ms": 11816.073, "learn_throughput": 338.522, "synch_weights_time_ms": 73.326}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00000", "date": "2024-08-03_10-14-59", "timestamp": 1722660299, "time_this_iter_s": 11.068944931030273, "time_total_s": 64.6861219406128, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ed0f9480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 64.6861219406128, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 14.274999999999999, "ram_util_percent": 27.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 121.64797625144323, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.6997400359561046, "policy_loss": -0.015138044553168584, "vf_loss": 3.710699543853601, "vf_explained_var": 0.9717888676871856, "kl": 0.021641601545100767, "entropy": 1.4979118040452402, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -49.748441668771, "episode_reward_min": -1278.754379790072, "episode_reward_mean": -680.4253593146029, "episode_len_mean": 134.16, "episode_media": {}, "episodes_timesteps_total": 13416, "policy_reward_min": {"policy_0": -1278.754379790072}, "policy_reward_max": {"policy_0": -49.748441668771}, "policy_reward_mean": {"policy_0": -680.4253593146029}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-82.87711289712342, -1098.9323752558037, -1071.9254447998176, -716.9572757967642, -1278.754379790072, -263.57884043544664, -1115.6380278826098, -250.9182231302729, -818.2609906417835, -842.5657567324645, -928.1875690338882, -844.9203526332611, -813.3056950455515, -694.4540279546295, -693.5328574036924, -966.806572207086, -845.3368947341517, -183.09106927315378, -140.2898749147248, -957.4275024118119, -123.99872199343811, -441.43381775524557, -341.78462083078483, -166.06571781441832, -1130.1837960005587, -754.7648105818832, -117.48752788988116, -878.5891641046936, -1026.4607940018338, -1063.2882724648898, -818.1071428318188, -228.01069535783822, -86.77972550104994, -842.8476980278344, -1008.8788755186587, -869.9036998811251, -800.2429497165926, -829.6587326737778, -832.8878153810048, -895.6214760813432, -456.6612218203171, -942.2203087481123, -681.8499023737215, -154.56265058956913, -1135.895281021758, -643.7153512216624, -1006.6975418691756, -90.99352185373586, -509.36261397408606, -393.8012722486483, -801.6034691552109, -316.79464724267103, -213.9534096268637, -912.6666480732539, -82.57169177327351, -812.5051808485156, -1006.5751188506187, -362.5436200223047, -1033.9233340161588, -995.3527898254735, -672.2809942145515, -939.8334710559668, -1136.431649966814, -682.3603510835632, -219.2632634578243, -148.49965257694694, -376.45107266537667, -1240.55499627789, -573.5712952978606, -986.6624811359064, -853.3976662200226, -1152.31480591497, -49.748441668771, -506.9572902075831, -772.5023988151773, -641.7954534936621, -420.8845194662349, -540.2872113984571, -129.5083380678526, -1039.9268815909159, -215.07464320730085, -764.6673444079736, -990.6467332293769, -251.16404889864324, -626.8751921218189, -998.1963125280872, -948.5442267259866, -933.7429988486074, -803.6102560108775, -943.6459547761077, -485.1120131320955, -597.2083885724606, -221.91055113239648, -715.8024810441844, -582.110654899344, -537.7063033441112, -1021.83445053461, -1223.4039956501845, -845.7811869798433, -833.2594883020226], "episode_lengths": [57, 150, 150, 150, 150, 109, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 80, 150, 81, 115, 92, 87, 150, 150, 86, 150, 150, 150, 150, 120, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 142, 150, 74, 150, 134, 150, 104, 97, 150, 61, 150, 150, 100, 150, 150, 150, 150, 150, 150, 127, 85, 113, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 133, 89, 150, 87, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 139, 150, 150, 150, 150], "policy_policy_0_reward": [-82.87711289712342, -1098.9323752558037, -1071.9254447998176, -716.9572757967642, -1278.754379790072, -263.57884043544664, -1115.6380278826098, -250.9182231302729, -818.2609906417835, -842.5657567324645, -928.1875690338882, -844.9203526332611, -813.3056950455515, -694.4540279546295, -693.5328574036924, -966.806572207086, -845.3368947341517, -183.09106927315378, -140.2898749147248, -957.4275024118119, -123.99872199343811, -441.43381775524557, -341.78462083078483, -166.06571781441832, -1130.1837960005587, -754.7648105818832, -117.48752788988116, -878.5891641046936, -1026.4607940018338, -1063.2882724648898, -818.1071428318188, -228.01069535783822, -86.77972550104994, -842.8476980278344, -1008.8788755186587, -869.9036998811251, -800.2429497165926, -829.6587326737778, -832.8878153810048, -895.6214760813432, -456.6612218203171, -942.2203087481123, -681.8499023737215, -154.56265058956913, -1135.895281021758, -643.7153512216624, -1006.6975418691756, -90.99352185373586, -509.36261397408606, -393.8012722486483, -801.6034691552109, -316.79464724267103, -213.9534096268637, -912.6666480732539, -82.57169177327351, -812.5051808485156, -1006.5751188506187, -362.5436200223047, -1033.9233340161588, -995.3527898254735, -672.2809942145515, -939.8334710559668, -1136.431649966814, -682.3603510835632, -219.2632634578243, -148.49965257694694, -376.45107266537667, -1240.55499627789, -573.5712952978606, -986.6624811359064, -853.3976662200226, -1152.31480591497, -49.748441668771, -506.9572902075831, -772.5023988151773, -641.7954534936621, -420.8845194662349, -540.2872113984571, -129.5083380678526, -1039.9268815909159, -215.07464320730085, -764.6673444079736, -990.6467332293769, -251.16404889864324, -626.8751921218189, -998.1963125280872, -948.5442267259866, -933.7429988486074, -803.6102560108775, -943.6459547761077, -485.1120131320955, -597.2083885724606, -221.91055113239648, -715.8024810441844, -582.110654899344, -537.7063033441112, -1021.83445053461, -1223.4039956501845, -845.7811869798433, -833.2594883020226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5627345939166691, "mean_inference_ms": 1.7147450345608624, "mean_action_processing_ms": 0.28656814535423875, "mean_env_wait_ms": 3.0230240849492076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013662099838256836, "StateBufferConnector_ms": 0.008709907531738281, "ViewRequirementAgentConnector_ms": 0.19539856910705566}, "num_episodes": 29, "episode_return_max": -49.748441668771, "episode_return_min": -1278.754379790072, "episode_return_mean": -680.4253593146029, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.72369150814507, "num_env_steps_trained_throughput_per_sec": 337.72369150814507, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12744.2, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12744.117, "sample_time_ms": 1038.118, "learn_time_ms": 11633.698, "learn_throughput": 343.829, "synch_weights_time_ms": 71.319}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00000", "date": "2024-08-03_10-15-11", "timestamp": 1722660311, "time_this_iter_s": 11.856489181518555, "time_total_s": 76.54261112213135, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ed07ea70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76.54261112213135, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.711764705882354, "ram_util_percent": 27.31176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 134.42374765078227, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.025435204183062, "policy_loss": -0.00986716495147751, "vf_loss": 3.0310224567850432, "vf_explained_var": 0.9759121962512532, "kl": 0.014768293185807125, "entropy": 1.505824658026298, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -49.748441668771, "episode_reward_min": -1297.1014828031718, "episode_reward_mean": -694.693590851205, "episode_len_mean": 137.77, "episode_media": {}, "episodes_timesteps_total": 13777, "policy_reward_min": {"policy_0": -1297.1014828031718}, "policy_reward_max": {"policy_0": -49.748441668771}, "policy_reward_mean": {"policy_0": -694.693590851205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1026.4607940018338, -1063.2882724648898, -818.1071428318188, -228.01069535783822, -86.77972550104994, -842.8476980278344, -1008.8788755186587, -869.9036998811251, -800.2429497165926, -829.6587326737778, -832.8878153810048, -895.6214760813432, -456.6612218203171, -942.2203087481123, -681.8499023737215, -154.56265058956913, -1135.895281021758, -643.7153512216624, -1006.6975418691756, -90.99352185373586, -509.36261397408606, -393.8012722486483, -801.6034691552109, -316.79464724267103, -213.9534096268637, -912.6666480732539, -82.57169177327351, -812.5051808485156, -1006.5751188506187, -362.5436200223047, -1033.9233340161588, -995.3527898254735, -672.2809942145515, -939.8334710559668, -1136.431649966814, -682.3603510835632, -219.2632634578243, -148.49965257694694, -376.45107266537667, -1240.55499627789, -573.5712952978606, -986.6624811359064, -853.3976662200226, -1152.31480591497, -49.748441668771, -506.9572902075831, -772.5023988151773, -641.7954534936621, -420.8845194662349, -540.2872113984571, -129.5083380678526, -1039.9268815909159, -215.07464320730085, -764.6673444079736, -990.6467332293769, -251.16404889864324, -626.8751921218189, -998.1963125280872, -948.5442267259866, -933.7429988486074, -803.6102560108775, -943.6459547761077, -485.1120131320955, -597.2083885724606, -221.91055113239648, -715.8024810441844, -582.110654899344, -537.7063033441112, -1021.83445053461, -1223.4039956501845, -845.7811869798433, -833.2594883020226, -170.81988861514844, -1098.5660084108167, -751.1571081046206, -849.1249440765383, -52.11781472771637, -1170.735281565742, -991.8869561456319, -1297.1014828031718, -436.29184234016424, -840.8892546573179, -640.9656131307321, -254.35216460114657, -649.9058163170255, -947.4867173094189, -687.4515097224707, -575.8355967176557, -378.6901359814018, -288.1101892605513, -174.62485529678173, -730.4660761170604, -1106.5950441818543, -1168.9216690675541, -757.2293172295073, -546.1598910587774, -559.3983192291068, -1116.5434781273398, -1043.4561801097066, -704.0090187002843], "episode_lengths": [150, 150, 150, 120, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 142, 150, 74, 150, 134, 150, 104, 97, 150, 61, 150, 150, 100, 150, 150, 150, 150, 150, 150, 127, 85, 113, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 133, 89, 150, 87, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 140, 88, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1026.4607940018338, -1063.2882724648898, -818.1071428318188, -228.01069535783822, -86.77972550104994, -842.8476980278344, -1008.8788755186587, -869.9036998811251, -800.2429497165926, -829.6587326737778, -832.8878153810048, -895.6214760813432, -456.6612218203171, -942.2203087481123, -681.8499023737215, -154.56265058956913, -1135.895281021758, -643.7153512216624, -1006.6975418691756, -90.99352185373586, -509.36261397408606, -393.8012722486483, -801.6034691552109, -316.79464724267103, -213.9534096268637, -912.6666480732539, -82.57169177327351, -812.5051808485156, -1006.5751188506187, -362.5436200223047, -1033.9233340161588, -995.3527898254735, -672.2809942145515, -939.8334710559668, -1136.431649966814, -682.3603510835632, -219.2632634578243, -148.49965257694694, -376.45107266537667, -1240.55499627789, -573.5712952978606, -986.6624811359064, -853.3976662200226, -1152.31480591497, -49.748441668771, -506.9572902075831, -772.5023988151773, -641.7954534936621, -420.8845194662349, -540.2872113984571, -129.5083380678526, -1039.9268815909159, -215.07464320730085, -764.6673444079736, -990.6467332293769, -251.16404889864324, -626.8751921218189, -998.1963125280872, -948.5442267259866, -933.7429988486074, -803.6102560108775, -943.6459547761077, -485.1120131320955, -597.2083885724606, -221.91055113239648, -715.8024810441844, -582.110654899344, -537.7063033441112, -1021.83445053461, -1223.4039956501845, -845.7811869798433, -833.2594883020226, -170.81988861514844, -1098.5660084108167, -751.1571081046206, -849.1249440765383, -52.11781472771637, -1170.735281565742, -991.8869561456319, -1297.1014828031718, -436.29184234016424, -840.8892546573179, -640.9656131307321, -254.35216460114657, -649.9058163170255, -947.4867173094189, -687.4515097224707, -575.8355967176557, -378.6901359814018, -288.1101892605513, -174.62485529678173, -730.4660761170604, -1106.5950441818543, -1168.9216690675541, -757.2293172295073, -546.1598910587774, -559.3983192291068, -1116.5434781273398, -1043.4561801097066, -704.0090187002843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5618045481086793, "mean_inference_ms": 1.7156043797487217, "mean_action_processing_ms": 0.2863148754518669, "mean_env_wait_ms": 3.0266264722347715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013556241989135742, "StateBufferConnector_ms": 0.00855565071105957, "ViewRequirementAgentConnector_ms": 0.19609403610229492}, "num_episodes": 28, "episode_return_max": -49.748441668771, "episode_return_min": -1297.1014828031718, "episode_return_mean": -694.693590851205, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.7991217359628, "num_env_steps_trained_throughput_per_sec": 300.7991217359628, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12823.304, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12823.217, "sample_time_ms": 1036.554, "learn_time_ms": 11713.649, "learn_throughput": 341.482, "synch_weights_time_ms": 72.044}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00000", "date": "2024-08-03_10-15-25", "timestamp": 1722660325, "time_this_iter_s": 13.310483455657959, "time_total_s": 89.8530945777893, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecfbf400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.8530945777893, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.178947368421053, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 152.93748567501703, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.861984443788727, "policy_loss": -0.013033943036862183, "vf_loss": 2.870783256118496, "vf_explained_var": 0.9768101258824269, "kl": 0.01463223130128124, "entropy": 1.5453210840622584, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -17.37558248721791, "episode_reward_min": -1330.0670842573602, "episode_reward_mean": -713.0962806524128, "episode_len_mean": 138.12, "episode_media": {}, "episodes_timesteps_total": 13812, "policy_reward_min": {"policy_0": -1330.0670842573602}, "policy_reward_max": {"policy_0": -17.37558248721791}, "policy_reward_mean": {"policy_0": -713.0962806524128}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1033.9233340161588, -995.3527898254735, -672.2809942145515, -939.8334710559668, -1136.431649966814, -682.3603510835632, -219.2632634578243, -148.49965257694694, -376.45107266537667, -1240.55499627789, -573.5712952978606, -986.6624811359064, -853.3976662200226, -1152.31480591497, -49.748441668771, -506.9572902075831, -772.5023988151773, -641.7954534936621, -420.8845194662349, -540.2872113984571, -129.5083380678526, -1039.9268815909159, -215.07464320730085, -764.6673444079736, -990.6467332293769, -251.16404889864324, -626.8751921218189, -998.1963125280872, -948.5442267259866, -933.7429988486074, -803.6102560108775, -943.6459547761077, -485.1120131320955, -597.2083885724606, -221.91055113239648, -715.8024810441844, -582.110654899344, -537.7063033441112, -1021.83445053461, -1223.4039956501845, -845.7811869798433, -833.2594883020226, -170.81988861514844, -1098.5660084108167, -751.1571081046206, -849.1249440765383, -52.11781472771637, -1170.735281565742, -991.8869561456319, -1297.1014828031718, -436.29184234016424, -840.8892546573179, -640.9656131307321, -254.35216460114657, -649.9058163170255, -947.4867173094189, -687.4515097224707, -575.8355967176557, -378.6901359814018, -288.1101892605513, -174.62485529678173, -730.4660761170604, -1106.5950441818543, -1168.9216690675541, -757.2293172295073, -546.1598910587774, -559.3983192291068, -1116.5434781273398, -1043.4561801097066, -704.0090187002843, -278.299209135399, -1043.9275784177623, -1035.124898467805, -751.0277256389754, -242.85257457690562, -189.8235062253341, -538.1902100338831, -17.37558248721791, -868.4690211034072, -594.8478562478089, -811.3533465927003, -463.92431821826125, -844.8168355070727, -947.0810703146284, -42.60970596801638, -53.025447685838174, -726.2081278146063, -877.2469726727372, -1056.307159605909, -905.1986725021292, -485.8527530122355, -606.4254755229739, -541.1367084651567, -1002.1697870407887, -1278.0214607447215, -1330.0670842573602, -1220.0443991168609, -1031.479092809134, -1004.107431573438, -880.9162971129493], "episode_lengths": [150, 150, 150, 150, 150, 150, 127, 85, 113, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 133, 89, 150, 87, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 140, 88, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 149, 95, 80, 150, 48, 150, 150, 150, 150, 150, 150, 64, 61, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1033.9233340161588, -995.3527898254735, -672.2809942145515, -939.8334710559668, -1136.431649966814, -682.3603510835632, -219.2632634578243, -148.49965257694694, -376.45107266537667, -1240.55499627789, -573.5712952978606, -986.6624811359064, -853.3976662200226, -1152.31480591497, -49.748441668771, -506.9572902075831, -772.5023988151773, -641.7954534936621, -420.8845194662349, -540.2872113984571, -129.5083380678526, -1039.9268815909159, -215.07464320730085, -764.6673444079736, -990.6467332293769, -251.16404889864324, -626.8751921218189, -998.1963125280872, -948.5442267259866, -933.7429988486074, -803.6102560108775, -943.6459547761077, -485.1120131320955, -597.2083885724606, -221.91055113239648, -715.8024810441844, -582.110654899344, -537.7063033441112, -1021.83445053461, -1223.4039956501845, -845.7811869798433, -833.2594883020226, -170.81988861514844, -1098.5660084108167, -751.1571081046206, -849.1249440765383, -52.11781472771637, -1170.735281565742, -991.8869561456319, -1297.1014828031718, -436.29184234016424, -840.8892546573179, -640.9656131307321, -254.35216460114657, -649.9058163170255, -947.4867173094189, -687.4515097224707, -575.8355967176557, -378.6901359814018, -288.1101892605513, -174.62485529678173, -730.4660761170604, -1106.5950441818543, -1168.9216690675541, -757.2293172295073, -546.1598910587774, -559.3983192291068, -1116.5434781273398, -1043.4561801097066, -704.0090187002843, -278.299209135399, -1043.9275784177623, -1035.124898467805, -751.0277256389754, -242.85257457690562, -189.8235062253341, -538.1902100338831, -17.37558248721791, -868.4690211034072, -594.8478562478089, -811.3533465927003, -463.92431821826125, -844.8168355070727, -947.0810703146284, -42.60970596801638, -53.025447685838174, -726.2081278146063, -877.2469726727372, -1056.307159605909, -905.1986725021292, -485.8527530122355, -606.4254755229739, -541.1367084651567, -1002.1697870407887, -1278.0214607447215, -1330.0670842573602, -1220.0443991168609, -1031.479092809134, -1004.107431573438, -880.9162971129493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.560936959057659, "mean_inference_ms": 1.715522946007628, "mean_action_processing_ms": 0.285986530046275, "mean_env_wait_ms": 3.02642628158163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013144969940185547, "StateBufferConnector_ms": 0.008417844772338867, "ViewRequirementAgentConnector_ms": 0.19747614860534668}, "num_episodes": 30, "episode_return_max": -17.37558248721791, "episode_return_min": -1330.0670842573602, "episode_return_mean": -713.0962806524128, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.4518880051845, "num_env_steps_trained_throughput_per_sec": 300.4518880051845, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12884.553, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12884.468, "sample_time_ms": 1036.662, "learn_time_ms": 11775.016, "learn_throughput": 339.702, "synch_weights_time_ms": 71.825}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00000", "date": "2024-08-03_10-15-38", "timestamp": 1722660338, "time_this_iter_s": 13.325395107269287, "time_total_s": 103.1784896850586, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ed07f640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 103.1784896850586, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.547368421052633, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 174.68357243339221, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.491150284931064, "policy_loss": -0.007267833468843795, "vf_loss": 2.4946014190713566, "vf_explained_var": 0.9855322930340965, "kl": 0.013168755526203323, "entropy": 1.3391835940380892, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -11.681013766892566, "episode_reward_min": -1330.0670842573602, "episode_reward_mean": -687.7670761093976, "episode_len_mean": 136.88, "episode_media": {}, "episodes_timesteps_total": 13688, "policy_reward_min": {"policy_0": -1330.0670842573602}, "policy_reward_max": {"policy_0": -11.681013766892566}, "policy_reward_mean": {"policy_0": -687.7670761093976}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-933.7429988486074, -803.6102560108775, -943.6459547761077, -485.1120131320955, -597.2083885724606, -221.91055113239648, -715.8024810441844, -582.110654899344, -537.7063033441112, -1021.83445053461, -1223.4039956501845, -845.7811869798433, -833.2594883020226, -170.81988861514844, -1098.5660084108167, -751.1571081046206, -849.1249440765383, -52.11781472771637, -1170.735281565742, -991.8869561456319, -1297.1014828031718, -436.29184234016424, -840.8892546573179, -640.9656131307321, -254.35216460114657, -649.9058163170255, -947.4867173094189, -687.4515097224707, -575.8355967176557, -378.6901359814018, -288.1101892605513, -174.62485529678173, -730.4660761170604, -1106.5950441818543, -1168.9216690675541, -757.2293172295073, -546.1598910587774, -559.3983192291068, -1116.5434781273398, -1043.4561801097066, -704.0090187002843, -278.299209135399, -1043.9275784177623, -1035.124898467805, -751.0277256389754, -242.85257457690562, -189.8235062253341, -538.1902100338831, -17.37558248721791, -868.4690211034072, -594.8478562478089, -811.3533465927003, -463.92431821826125, -844.8168355070727, -947.0810703146284, -42.60970596801638, -53.025447685838174, -726.2081278146063, -877.2469726727372, -1056.307159605909, -905.1986725021292, -485.8527530122355, -606.4254755229739, -541.1367084651567, -1002.1697870407887, -1278.0214607447215, -1330.0670842573602, -1220.0443991168609, -1031.479092809134, -1004.107431573438, -880.9162971129493, -530.8129367749598, -720.5688870647948, -58.79777347945801, -588.4418354625686, -150.44380374584526, -75.8287837441618, -850.8106481986979, -294.08148732905187, -686.7415186273461, -528.4455623843295, -941.8705261627335, -652.2356016930564, -11.681013766892566, -803.792460233745, -759.4120010761051, -702.8123686805461, -986.8528528374048, -556.0668768512508, -1012.0395224666458, -1017.8036460172997, -450.5128731643104, -22.11899978217824, -488.7882843679773, -648.8987613048209, -615.1338802918133, -401.6377485884203, -1057.6300898134361, -984.4617277487662, -776.0339335770412], "episode_lengths": [150, 150, 150, 150, 150, 96, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 140, 88, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 149, 95, 80, 150, 48, 150, 150, 150, 150, 150, 150, 64, 61, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 70, 80, 150, 128, 150, 150, 150, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 133, 150, 150, 150], "policy_policy_0_reward": [-933.7429988486074, -803.6102560108775, -943.6459547761077, -485.1120131320955, -597.2083885724606, -221.91055113239648, -715.8024810441844, -582.110654899344, -537.7063033441112, -1021.83445053461, -1223.4039956501845, -845.7811869798433, -833.2594883020226, -170.81988861514844, -1098.5660084108167, -751.1571081046206, -849.1249440765383, -52.11781472771637, -1170.735281565742, -991.8869561456319, -1297.1014828031718, -436.29184234016424, -840.8892546573179, -640.9656131307321, -254.35216460114657, -649.9058163170255, -947.4867173094189, -687.4515097224707, -575.8355967176557, -378.6901359814018, -288.1101892605513, -174.62485529678173, -730.4660761170604, -1106.5950441818543, -1168.9216690675541, -757.2293172295073, -546.1598910587774, -559.3983192291068, -1116.5434781273398, -1043.4561801097066, -704.0090187002843, -278.299209135399, -1043.9275784177623, -1035.124898467805, -751.0277256389754, -242.85257457690562, -189.8235062253341, -538.1902100338831, -17.37558248721791, -868.4690211034072, -594.8478562478089, -811.3533465927003, -463.92431821826125, -844.8168355070727, -947.0810703146284, -42.60970596801638, -53.025447685838174, -726.2081278146063, -877.2469726727372, -1056.307159605909, -905.1986725021292, -485.8527530122355, -606.4254755229739, -541.1367084651567, -1002.1697870407887, -1278.0214607447215, -1330.0670842573602, -1220.0443991168609, -1031.479092809134, -1004.107431573438, -880.9162971129493, -530.8129367749598, -720.5688870647948, -58.79777347945801, -588.4418354625686, -150.44380374584526, -75.8287837441618, -850.8106481986979, -294.08148732905187, -686.7415186273461, -528.4455623843295, -941.8705261627335, -652.2356016930564, -11.681013766892566, -803.792460233745, -759.4120010761051, -702.8123686805461, -986.8528528374048, -556.0668768512508, -1012.0395224666458, -1017.8036460172997, -450.5128731643104, -22.11899978217824, -488.7882843679773, -648.8987613048209, -615.1338802918133, -401.6377485884203, -1057.6300898134361, -984.4617277487662, -776.0339335770412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.559425779008304, "mean_inference_ms": 1.7123358666659017, "mean_action_processing_ms": 0.284968651870271, "mean_env_wait_ms": 3.02704247582965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012843132019042969, "StateBufferConnector_ms": 0.008196115493774414, "ViewRequirementAgentConnector_ms": 0.19725823402404785}, "num_episodes": 29, "episode_return_max": -11.681013766892566, "episode_return_min": -1330.0670842573602, "episode_return_mean": -687.7670761093976, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.2521336783589, "num_env_steps_trained_throughput_per_sec": 297.2521336783589, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12948.114, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12948.03, "sample_time_ms": 1034.106, "learn_time_ms": 11842.112, "learn_throughput": 337.778, "synch_weights_time_ms": 70.855}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00000", "date": "2024-08-03_10-15-51", "timestamp": 1722660351, "time_this_iter_s": 13.46926999092102, "time_total_s": 116.64775967597961, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0c310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 116.64775967597961, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.215789473684211, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 155.04212224980196, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.2487532245616118, "policy_loss": -0.01245240702216203, "vf_loss": 2.256721854458253, "vf_explained_var": 0.9874234845861792, "kl": 0.015402634841332958, "entropy": 1.3701745195935169, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -11.681013766892566, "episode_reward_min": -1330.0670842573602, "episode_reward_mean": -682.7675996085021, "episode_len_mean": 136.48, "episode_media": {}, "episodes_timesteps_total": 13648, "policy_reward_min": {"policy_0": -1330.0670842573602}, "policy_reward_max": {"policy_0": -11.681013766892566}, "policy_reward_mean": {"policy_0": -682.7675996085021}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1168.9216690675541, -757.2293172295073, -546.1598910587774, -559.3983192291068, -1116.5434781273398, -1043.4561801097066, -704.0090187002843, -278.299209135399, -1043.9275784177623, -1035.124898467805, -751.0277256389754, -242.85257457690562, -189.8235062253341, -538.1902100338831, -17.37558248721791, -868.4690211034072, -594.8478562478089, -811.3533465927003, -463.92431821826125, -844.8168355070727, -947.0810703146284, -42.60970596801638, -53.025447685838174, -726.2081278146063, -877.2469726727372, -1056.307159605909, -905.1986725021292, -485.8527530122355, -606.4254755229739, -541.1367084651567, -1002.1697870407887, -1278.0214607447215, -1330.0670842573602, -1220.0443991168609, -1031.479092809134, -1004.107431573438, -880.9162971129493, -530.8129367749598, -720.5688870647948, -58.79777347945801, -588.4418354625686, -150.44380374584526, -75.8287837441618, -850.8106481986979, -294.08148732905187, -686.7415186273461, -528.4455623843295, -941.8705261627335, -652.2356016930564, -11.681013766892566, -803.792460233745, -759.4120010761051, -702.8123686805461, -986.8528528374048, -556.0668768512508, -1012.0395224666458, -1017.8036460172997, -450.5128731643104, -22.11899978217824, -488.7882843679773, -648.8987613048209, -615.1338802918133, -401.6377485884203, -1057.6300898134361, -984.4617277487662, -776.0339335770412, -468.56664648542136, -19.034565322859656, -851.4691094733829, -348.1078179940442, -857.7839464730325, -1065.178295400701, -784.2630915517982, -802.1687132842178, -895.1623903811703, -954.6843486699347, -1297.5114051950598, -194.1666310354402, -766.9237891962429, -764.5758965834403, -708.5124439746004, -574.962864880147, -1019.4212055594016, -563.92951910016, -469.7339004573331, -1194.6901491662545, -1004.9121580034242, -819.2947300975719, -877.5809149545547, -1122.0126423753807, -478.14413425111474, -593.5620788121698, -484.240161815038, -499.5950687030735, -220.44002430551944, -778.2861155959044, -312.0522817251694, -660.9037548217469, -674.6942342350501, -211.79034333989733], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 149, 95, 80, 150, 48, 150, 150, 150, 150, 150, 150, 64, 61, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 70, 80, 150, 128, 150, 150, 150, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 133, 150, 150, 150, 150, 59, 150, 98, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 148, 73], "policy_policy_0_reward": [-1168.9216690675541, -757.2293172295073, -546.1598910587774, -559.3983192291068, -1116.5434781273398, -1043.4561801097066, -704.0090187002843, -278.299209135399, -1043.9275784177623, -1035.124898467805, -751.0277256389754, -242.85257457690562, -189.8235062253341, -538.1902100338831, -17.37558248721791, -868.4690211034072, -594.8478562478089, -811.3533465927003, -463.92431821826125, -844.8168355070727, -947.0810703146284, -42.60970596801638, -53.025447685838174, -726.2081278146063, -877.2469726727372, -1056.307159605909, -905.1986725021292, -485.8527530122355, -606.4254755229739, -541.1367084651567, -1002.1697870407887, -1278.0214607447215, -1330.0670842573602, -1220.0443991168609, -1031.479092809134, -1004.107431573438, -880.9162971129493, -530.8129367749598, -720.5688870647948, -58.79777347945801, -588.4418354625686, -150.44380374584526, -75.8287837441618, -850.8106481986979, -294.08148732905187, -686.7415186273461, -528.4455623843295, -941.8705261627335, -652.2356016930564, -11.681013766892566, -803.792460233745, -759.4120010761051, -702.8123686805461, -986.8528528374048, -556.0668768512508, -1012.0395224666458, -1017.8036460172997, -450.5128731643104, -22.11899978217824, -488.7882843679773, -648.8987613048209, -615.1338802918133, -401.6377485884203, -1057.6300898134361, -984.4617277487662, -776.0339335770412, -468.56664648542136, -19.034565322859656, -851.4691094733829, -348.1078179940442, -857.7839464730325, -1065.178295400701, -784.2630915517982, -802.1687132842178, -895.1623903811703, -954.6843486699347, -1297.5114051950598, -194.1666310354402, -766.9237891962429, -764.5758965834403, -708.5124439746004, -574.962864880147, -1019.4212055594016, -563.92951910016, -469.7339004573331, -1194.6901491662545, -1004.9121580034242, -819.2947300975719, -877.5809149545547, -1122.0126423753807, -478.14413425111474, -593.5620788121698, -484.240161815038, -499.5950687030735, -220.44002430551944, -778.2861155959044, -312.0522817251694, -660.9037548217469, -674.6942342350501, -211.79034333989733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5582527244742862, "mean_inference_ms": 1.7114675595679933, "mean_action_processing_ms": 0.28437188673557473, "mean_env_wait_ms": 3.028024376433775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012447118759155273, "StateBufferConnector_ms": 0.008154153823852539, "ViewRequirementAgentConnector_ms": 0.19981002807617188}, "num_episodes": 34, "episode_return_max": -11.681013766892566, "episode_return_min": -1330.0670842573602, "episode_return_mean": -682.7675996085021, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.5945638386184, "num_env_steps_trained_throughput_per_sec": 304.5945638386184, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12966.526, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12966.44, "sample_time_ms": 1033.082, "learn_time_ms": 11861.906, "learn_throughput": 337.214, "synch_weights_time_ms": 70.508}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00000", "date": "2024-08-03_10-16-05", "timestamp": 1722660365, "time_this_iter_s": 13.14639925956726, "time_total_s": 129.79415893554688, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0c5e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 129.79415893554688, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 14.011111111111113, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.07741531729698, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.3862871954838436, "policy_loss": -0.006132957375181529, "vf_loss": 2.388454612220327, "vf_explained_var": 0.9913053802525004, "kl": 0.013678299875452164, "entropy": 1.379459282880028, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -8.073128681887658, "episode_reward_min": -1369.3417465646667, "episode_reward_mean": -663.5243330345382, "episode_len_mean": 136.98, "episode_media": {}, "episodes_timesteps_total": 13698, "policy_reward_min": {"policy_0": -1369.3417465646667}, "policy_reward_max": {"policy_0": -8.073128681887658}, "policy_reward_mean": {"policy_0": -663.5243330345382}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-606.4254755229739, -541.1367084651567, -1002.1697870407887, -1278.0214607447215, -1330.0670842573602, -1220.0443991168609, -1031.479092809134, -1004.107431573438, -880.9162971129493, -530.8129367749598, -720.5688870647948, -58.79777347945801, -588.4418354625686, -150.44380374584526, -75.8287837441618, -850.8106481986979, -294.08148732905187, -686.7415186273461, -528.4455623843295, -941.8705261627335, -652.2356016930564, -11.681013766892566, -803.792460233745, -759.4120010761051, -702.8123686805461, -986.8528528374048, -556.0668768512508, -1012.0395224666458, -1017.8036460172997, -450.5128731643104, -22.11899978217824, -488.7882843679773, -648.8987613048209, -615.1338802918133, -401.6377485884203, -1057.6300898134361, -984.4617277487662, -776.0339335770412, -468.56664648542136, -19.034565322859656, -851.4691094733829, -348.1078179940442, -857.7839464730325, -1065.178295400701, -784.2630915517982, -802.1687132842178, -895.1623903811703, -954.6843486699347, -1297.5114051950598, -194.1666310354402, -766.9237891962429, -764.5758965834403, -708.5124439746004, -574.962864880147, -1019.4212055594016, -563.92951910016, -469.7339004573331, -1194.6901491662545, -1004.9121580034242, -819.2947300975719, -877.5809149545547, -1122.0126423753807, -478.14413425111474, -593.5620788121698, -484.240161815038, -499.5950687030735, -220.44002430551944, -778.2861155959044, -312.0522817251694, -660.9037548217469, -674.6942342350501, -211.79034333989733, -156.787453480324, -243.49089257008035, -848.0510416005601, -1247.8405290636288, -704.7901375769205, -514.1429994828353, -8.073128681887658, -693.0789250248207, -1369.3417465646667, -798.4188537953357, -973.8765863999114, -585.787423624295, -447.07753685942924, -1014.4991148663323, -1029.2750790951368, -695.2304749860333, -726.8826090701741, -856.3870556954489, -127.4400774693682, -367.96990381635766, -398.16278874295455, -40.55410398984057, -240.8598487237266, -603.2414115218514, -331.38996782428876, -662.6934260312306, -122.36733867151631, -937.2433331255604], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 70, 80, 150, 128, 150, 150, 150, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 133, 150, 150, 150, 150, 59, 150, 98, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 148, 73, 124, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 149, 59, 129, 150, 119, 150, 96, 150], "policy_policy_0_reward": [-606.4254755229739, -541.1367084651567, -1002.1697870407887, -1278.0214607447215, -1330.0670842573602, -1220.0443991168609, -1031.479092809134, -1004.107431573438, -880.9162971129493, -530.8129367749598, -720.5688870647948, -58.79777347945801, -588.4418354625686, -150.44380374584526, -75.8287837441618, -850.8106481986979, -294.08148732905187, -686.7415186273461, -528.4455623843295, -941.8705261627335, -652.2356016930564, -11.681013766892566, -803.792460233745, -759.4120010761051, -702.8123686805461, -986.8528528374048, -556.0668768512508, -1012.0395224666458, -1017.8036460172997, -450.5128731643104, -22.11899978217824, -488.7882843679773, -648.8987613048209, -615.1338802918133, -401.6377485884203, -1057.6300898134361, -984.4617277487662, -776.0339335770412, -468.56664648542136, -19.034565322859656, -851.4691094733829, -348.1078179940442, -857.7839464730325, -1065.178295400701, -784.2630915517982, -802.1687132842178, -895.1623903811703, -954.6843486699347, -1297.5114051950598, -194.1666310354402, -766.9237891962429, -764.5758965834403, -708.5124439746004, -574.962864880147, -1019.4212055594016, -563.92951910016, -469.7339004573331, -1194.6901491662545, -1004.9121580034242, -819.2947300975719, -877.5809149545547, -1122.0126423753807, -478.14413425111474, -593.5620788121698, -484.240161815038, -499.5950687030735, -220.44002430551944, -778.2861155959044, -312.0522817251694, -660.9037548217469, -674.6942342350501, -211.79034333989733, -156.787453480324, -243.49089257008035, -848.0510416005601, -1247.8405290636288, -704.7901375769205, -514.1429994828353, -8.073128681887658, -693.0789250248207, -1369.3417465646667, -798.4188537953357, -973.8765863999114, -585.787423624295, -447.07753685942924, -1014.4991148663323, -1029.2750790951368, -695.2304749860333, -726.8826090701741, -856.3870556954489, -127.4400774693682, -367.96990381635766, -398.16278874295455, -40.55410398984057, -240.8598487237266, -603.2414115218514, -331.38996782428876, -662.6934260312306, -122.36733867151631, -937.2433331255604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578157422346416, "mean_inference_ms": 1.7089569575409131, "mean_action_processing_ms": 0.2836375832183445, "mean_env_wait_ms": 3.0259006929197287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012252092361450195, "StateBufferConnector_ms": 0.007950782775878906, "ViewRequirementAgentConnector_ms": 0.19500064849853516}, "num_episodes": 28, "episode_return_max": -8.073128681887658, "episode_return_min": -1369.3417465646667, "episode_return_mean": -663.5243330345382, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.72477555589325, "num_env_steps_trained_throughput_per_sec": 299.72477555589325, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12951.863, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12951.777, "sample_time_ms": 1031.65, "learn_time_ms": 11847.314, "learn_throughput": 337.629, "synch_weights_time_ms": 71.862}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00000", "date": "2024-08-03_10-16-18", "timestamp": 1722660378, "time_this_iter_s": 13.357865571975708, "time_total_s": 143.15202450752258, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0d750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 143.15202450752258, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 12.58, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 172.3491825471322, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.0150497899080317, "policy_loss": -0.004670766277680135, "vf_loss": 2.0161051881189147, "vf_explained_var": 0.9861904403815667, "kl": 0.01253310156777541, "entropy": 1.4456152981768051, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -8.073128681887658, "episode_reward_min": -1369.3417465646667, "episode_reward_mean": -683.1598154384353, "episode_len_mean": 138.96, "episode_media": {}, "episodes_timesteps_total": 13896, "policy_reward_min": {"policy_0": -1369.3417465646667}, "policy_reward_max": {"policy_0": -8.073128681887658}, "policy_reward_mean": {"policy_0": -683.1598154384353}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-556.0668768512508, -1012.0395224666458, -1017.8036460172997, -450.5128731643104, -22.11899978217824, -488.7882843679773, -648.8987613048209, -615.1338802918133, -401.6377485884203, -1057.6300898134361, -984.4617277487662, -776.0339335770412, -468.56664648542136, -19.034565322859656, -851.4691094733829, -348.1078179940442, -857.7839464730325, -1065.178295400701, -784.2630915517982, -802.1687132842178, -895.1623903811703, -954.6843486699347, -1297.5114051950598, -194.1666310354402, -766.9237891962429, -764.5758965834403, -708.5124439746004, -574.962864880147, -1019.4212055594016, -563.92951910016, -469.7339004573331, -1194.6901491662545, -1004.9121580034242, -819.2947300975719, -877.5809149545547, -1122.0126423753807, -478.14413425111474, -593.5620788121698, -484.240161815038, -499.5950687030735, -220.44002430551944, -778.2861155959044, -312.0522817251694, -660.9037548217469, -674.6942342350501, -211.79034333989733, -156.787453480324, -243.49089257008035, -848.0510416005601, -1247.8405290636288, -704.7901375769205, -514.1429994828353, -8.073128681887658, -693.0789250248207, -1369.3417465646667, -798.4188537953357, -973.8765863999114, -585.787423624295, -447.07753685942924, -1014.4991148663323, -1029.2750790951368, -695.2304749860333, -726.8826090701741, -856.3870556954489, -127.4400774693682, -367.96990381635766, -398.16278874295455, -40.55410398984057, -240.8598487237266, -603.2414115218514, -331.38996782428876, -662.6934260312306, -122.36733867151631, -937.2433331255604, -932.3457121453015, -767.0138752421025, -852.949390443318, -974.4571739181521, -1232.7922557625236, -796.033807820812, -368.93419694664595, -345.06856910863047, -680.6520754663686, -16.77487909534685, -684.7234732524656, -234.3529736029551, -731.0849353418416, -903.1907105200904, -1245.5212212471797, -701.9467444395309, -742.2299794509478, -1129.805863417757, -951.541665235679, -586.0538999050206, -827.4881273406074, -567.4096204150583, -1072.1171687075828, -731.2435370030878, -1069.0876975509696, -1056.7264849148182], "episode_lengths": [150, 150, 150, 150, 45, 150, 150, 150, 133, 150, 150, 150, 150, 59, 150, 98, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 148, 73, 124, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 149, 59, 129, 150, 119, 150, 96, 150, 150, 150, 150, 150, 150, 150, 138, 128, 150, 46, 150, 124, 146, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-556.0668768512508, -1012.0395224666458, -1017.8036460172997, -450.5128731643104, -22.11899978217824, -488.7882843679773, -648.8987613048209, -615.1338802918133, -401.6377485884203, -1057.6300898134361, -984.4617277487662, -776.0339335770412, -468.56664648542136, -19.034565322859656, -851.4691094733829, -348.1078179940442, -857.7839464730325, -1065.178295400701, -784.2630915517982, -802.1687132842178, -895.1623903811703, -954.6843486699347, -1297.5114051950598, -194.1666310354402, -766.9237891962429, -764.5758965834403, -708.5124439746004, -574.962864880147, -1019.4212055594016, -563.92951910016, -469.7339004573331, -1194.6901491662545, -1004.9121580034242, -819.2947300975719, -877.5809149545547, -1122.0126423753807, -478.14413425111474, -593.5620788121698, -484.240161815038, -499.5950687030735, -220.44002430551944, -778.2861155959044, -312.0522817251694, -660.9037548217469, -674.6942342350501, -211.79034333989733, -156.787453480324, -243.49089257008035, -848.0510416005601, -1247.8405290636288, -704.7901375769205, -514.1429994828353, -8.073128681887658, -693.0789250248207, -1369.3417465646667, -798.4188537953357, -973.8765863999114, -585.787423624295, -447.07753685942924, -1014.4991148663323, -1029.2750790951368, -695.2304749860333, -726.8826090701741, -856.3870556954489, -127.4400774693682, -367.96990381635766, -398.16278874295455, -40.55410398984057, -240.8598487237266, -603.2414115218514, -331.38996782428876, -662.6934260312306, -122.36733867151631, -937.2433331255604, -932.3457121453015, -767.0138752421025, -852.949390443318, -974.4571739181521, -1232.7922557625236, -796.033807820812, -368.93419694664595, -345.06856910863047, -680.6520754663686, -16.77487909534685, -684.7234732524656, -234.3529736029551, -731.0849353418416, -903.1907105200904, -1245.5212212471797, -701.9467444395309, -742.2299794509478, -1129.805863417757, -951.541665235679, -586.0538999050206, -827.4881273406074, -567.4096204150583, -1072.1171687075828, -731.2435370030878, -1069.0876975509696, -1056.7264849148182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5563709844852471, "mean_inference_ms": 1.708275512292606, "mean_action_processing_ms": 0.2833309214243679, "mean_env_wait_ms": 3.024573923604921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012186288833618164, "StateBufferConnector_ms": 0.007976055145263672, "ViewRequirementAgentConnector_ms": 0.19609928131103516}, "num_episodes": 26, "episode_return_max": -8.073128681887658, "episode_return_min": -1369.3417465646667, "episode_return_mean": -683.1598154384353, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.3656730579591, "num_env_steps_trained_throughput_per_sec": 299.3656730579591, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12968.616, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12968.531, "sample_time_ms": 1033.164, "learn_time_ms": 11861.299, "learn_throughput": 337.231, "synch_weights_time_ms": 73.06}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00000", "date": "2024-08-03_10-16-31", "timestamp": 1722660391, "time_this_iter_s": 13.373214483261108, "time_total_s": 156.5252389907837, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0e290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 156.5252389907837, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.457894736842107, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 210.57608861525853, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.488641121610999, "policy_loss": -0.009071582510174873, "vf_loss": 2.4930073210348684, "vf_explained_var": 0.9917507984365026, "kl": 0.016182994394451575, "entropy": 1.4951555186261734, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -8.073128681887658, "episode_reward_min": -1369.3417465646667, "episode_reward_mean": -696.3811217239239, "episode_len_mean": 139.77, "episode_media": {}, "episodes_timesteps_total": 13977, "policy_reward_min": {"policy_0": -1369.3417465646667}, "policy_reward_max": {"policy_0": -8.073128681887658}, "policy_reward_mean": {"policy_0": -696.3811217239239}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-563.92951910016, -469.7339004573331, -1194.6901491662545, -1004.9121580034242, -819.2947300975719, -877.5809149545547, -1122.0126423753807, -478.14413425111474, -593.5620788121698, -484.240161815038, -499.5950687030735, -220.44002430551944, -778.2861155959044, -312.0522817251694, -660.9037548217469, -674.6942342350501, -211.79034333989733, -156.787453480324, -243.49089257008035, -848.0510416005601, -1247.8405290636288, -704.7901375769205, -514.1429994828353, -8.073128681887658, -693.0789250248207, -1369.3417465646667, -798.4188537953357, -973.8765863999114, -585.787423624295, -447.07753685942924, -1014.4991148663323, -1029.2750790951368, -695.2304749860333, -726.8826090701741, -856.3870556954489, -127.4400774693682, -367.96990381635766, -398.16278874295455, -40.55410398984057, -240.8598487237266, -603.2414115218514, -331.38996782428876, -662.6934260312306, -122.36733867151631, -937.2433331255604, -932.3457121453015, -767.0138752421025, -852.949390443318, -974.4571739181521, -1232.7922557625236, -796.033807820812, -368.93419694664595, -345.06856910863047, -680.6520754663686, -16.77487909534685, -684.7234732524656, -234.3529736029551, -731.0849353418416, -903.1907105200904, -1245.5212212471797, -701.9467444395309, -742.2299794509478, -1129.805863417757, -951.541665235679, -586.0538999050206, -827.4881273406074, -567.4096204150583, -1072.1171687075828, -731.2435370030878, -1069.0876975509696, -1056.7264849148182, -1221.5340657992654, -554.5563854660712, -420.47777317804827, -780.8226412816745, -878.1969396166977, -658.5015751635437, -756.9576354057915, -1170.0947569695709, -1001.9876767148212, -277.2767372483795, -803.7735250561898, -1000.5555592257759, -815.6554508194237, -307.7280800148371, -1314.980808043378, -276.85676569485713, -391.8960249765416, -1214.3405928625707, -287.05369559451634, -752.0195196802554, -1262.829389521812, -465.22015589236076, -710.8072264045211, -711.9757174926655, -554.1074041167079, -84.79564863688097, -781.9093171636381, -1296.177518350486, -972.6615475924425], "episode_lengths": [150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 148, 73, 124, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 149, 59, 129, 150, 119, 150, 96, 150, 150, 150, 150, 150, 150, 150, 138, 128, 150, 46, 150, 124, 146, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 83, 150, 150, 125, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150], "policy_policy_0_reward": [-563.92951910016, -469.7339004573331, -1194.6901491662545, -1004.9121580034242, -819.2947300975719, -877.5809149545547, -1122.0126423753807, -478.14413425111474, -593.5620788121698, -484.240161815038, -499.5950687030735, -220.44002430551944, -778.2861155959044, -312.0522817251694, -660.9037548217469, -674.6942342350501, -211.79034333989733, -156.787453480324, -243.49089257008035, -848.0510416005601, -1247.8405290636288, -704.7901375769205, -514.1429994828353, -8.073128681887658, -693.0789250248207, -1369.3417465646667, -798.4188537953357, -973.8765863999114, -585.787423624295, -447.07753685942924, -1014.4991148663323, -1029.2750790951368, -695.2304749860333, -726.8826090701741, -856.3870556954489, -127.4400774693682, -367.96990381635766, -398.16278874295455, -40.55410398984057, -240.8598487237266, -603.2414115218514, -331.38996782428876, -662.6934260312306, -122.36733867151631, -937.2433331255604, -932.3457121453015, -767.0138752421025, -852.949390443318, -974.4571739181521, -1232.7922557625236, -796.033807820812, -368.93419694664595, -345.06856910863047, -680.6520754663686, -16.77487909534685, -684.7234732524656, -234.3529736029551, -731.0849353418416, -903.1907105200904, -1245.5212212471797, -701.9467444395309, -742.2299794509478, -1129.805863417757, -951.541665235679, -586.0538999050206, -827.4881273406074, -567.4096204150583, -1072.1171687075828, -731.2435370030878, -1069.0876975509696, -1056.7264849148182, -1221.5340657992654, -554.5563854660712, -420.47777317804827, -780.8226412816745, -878.1969396166977, -658.5015751635437, -756.9576354057915, -1170.0947569695709, -1001.9876767148212, -277.2767372483795, -803.7735250561898, -1000.5555592257759, -815.6554508194237, -307.7280800148371, -1314.980808043378, -276.85676569485713, -391.8960249765416, -1214.3405928625707, -287.05369559451634, -752.0195196802554, -1262.829389521812, -465.22015589236076, -710.8072264045211, -711.9757174926655, -554.1074041167079, -84.79564863688097, -781.9093171636381, -1296.177518350486, -972.6615475924425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564526687771345, "mean_inference_ms": 1.7084466121894912, "mean_action_processing_ms": 0.2832096754628499, "mean_env_wait_ms": 3.0281907379705872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012228965759277344, "StateBufferConnector_ms": 0.007985591888427734, "ViewRequirementAgentConnector_ms": 0.19738316535949707}, "num_episodes": 29, "episode_return_max": -8.073128681887658, "episode_return_min": -1369.3417465646667, "episode_return_mean": -696.3811217239239, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.2792901337586, "num_env_steps_trained_throughput_per_sec": 293.2792901337586, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12992.128, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12992.041, "sample_time_ms": 1033.834, "learn_time_ms": 11884.818, "learn_throughput": 336.564, "synch_weights_time_ms": 72.387}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00000", "date": "2024-08-03_10-16-45", "timestamp": 1722660405, "time_this_iter_s": 13.651912927627563, "time_total_s": 170.17715191841125, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ed07f370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 170.17715191841125, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.78421052631579, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.1087915480137, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.2193556543439628, "policy_loss": -0.014286913919689444, "vf_loss": 2.2295613697419565, "vf_explained_var": 0.9935844021538893, "kl": 0.014083858858430175, "entropy": 1.4396727729588747, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -16.77487909534685, "episode_reward_min": -1314.980808043378, "episode_reward_mean": -696.2764029963145, "episode_len_mean": 137.23, "episode_media": {}, "episodes_timesteps_total": 13723, "policy_reward_min": {"policy_0": -1314.980808043378}, "policy_reward_max": {"policy_0": -16.77487909534685}, "policy_reward_mean": {"policy_0": -696.2764029963145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-585.787423624295, -447.07753685942924, -1014.4991148663323, -1029.2750790951368, -695.2304749860333, -726.8826090701741, -856.3870556954489, -127.4400774693682, -367.96990381635766, -398.16278874295455, -40.55410398984057, -240.8598487237266, -603.2414115218514, -331.38996782428876, -662.6934260312306, -122.36733867151631, -937.2433331255604, -932.3457121453015, -767.0138752421025, -852.949390443318, -974.4571739181521, -1232.7922557625236, -796.033807820812, -368.93419694664595, -345.06856910863047, -680.6520754663686, -16.77487909534685, -684.7234732524656, -234.3529736029551, -731.0849353418416, -903.1907105200904, -1245.5212212471797, -701.9467444395309, -742.2299794509478, -1129.805863417757, -951.541665235679, -586.0538999050206, -827.4881273406074, -567.4096204150583, -1072.1171687075828, -731.2435370030878, -1069.0876975509696, -1056.7264849148182, -1221.5340657992654, -554.5563854660712, -420.47777317804827, -780.8226412816745, -878.1969396166977, -658.5015751635437, -756.9576354057915, -1170.0947569695709, -1001.9876767148212, -277.2767372483795, -803.7735250561898, -1000.5555592257759, -815.6554508194237, -307.7280800148371, -1314.980808043378, -276.85676569485713, -391.8960249765416, -1214.3405928625707, -287.05369559451634, -752.0195196802554, -1262.829389521812, -465.22015589236076, -710.8072264045211, -711.9757174926655, -554.1074041167079, -84.79564863688097, -781.9093171636381, -1296.177518350486, -972.6615475924425, -1146.1038837471758, -1179.0887354318465, -1019.7065662850118, -191.19410781882112, -476.55592782933513, -711.1236462220417, -86.90074985755525, -508.7583496003673, -759.1163888168317, -1232.823238609094, -923.3558921389186, -697.3856199186882, -690.0921671337201, -35.38837815649222, -807.8330689630677, -876.1651030238249, -118.7444939125564, -449.51868157286293, -1139.1300506609327, -331.9566924622206, -939.1639196676093, -1251.7481622368944, -973.4228058706699, -905.301947629615, -61.24372474943809, -175.55159691317525, -657.2449852151241, -168.66374879548454], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 59, 150, 149, 59, 129, 150, 119, 150, 96, 150, 150, 150, 150, 150, 150, 150, 138, 128, 150, 46, 150, 124, 146, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 83, 150, 150, 125, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 90, 150, 150, 81, 150, 150, 150, 150, 150, 150, 42, 150, 150, 97, 115, 150, 140, 150, 150, 150, 150, 54, 114, 150, 67], "policy_policy_0_reward": [-585.787423624295, -447.07753685942924, -1014.4991148663323, -1029.2750790951368, -695.2304749860333, -726.8826090701741, -856.3870556954489, -127.4400774693682, -367.96990381635766, -398.16278874295455, -40.55410398984057, -240.8598487237266, -603.2414115218514, -331.38996782428876, -662.6934260312306, -122.36733867151631, -937.2433331255604, -932.3457121453015, -767.0138752421025, -852.949390443318, -974.4571739181521, -1232.7922557625236, -796.033807820812, -368.93419694664595, -345.06856910863047, -680.6520754663686, -16.77487909534685, -684.7234732524656, -234.3529736029551, -731.0849353418416, -903.1907105200904, -1245.5212212471797, -701.9467444395309, -742.2299794509478, -1129.805863417757, -951.541665235679, -586.0538999050206, -827.4881273406074, -567.4096204150583, -1072.1171687075828, -731.2435370030878, -1069.0876975509696, -1056.7264849148182, -1221.5340657992654, -554.5563854660712, -420.47777317804827, -780.8226412816745, -878.1969396166977, -658.5015751635437, -756.9576354057915, -1170.0947569695709, -1001.9876767148212, -277.2767372483795, -803.7735250561898, -1000.5555592257759, -815.6554508194237, -307.7280800148371, -1314.980808043378, -276.85676569485713, -391.8960249765416, -1214.3405928625707, -287.05369559451634, -752.0195196802554, -1262.829389521812, -465.22015589236076, -710.8072264045211, -711.9757174926655, -554.1074041167079, -84.79564863688097, -781.9093171636381, -1296.177518350486, -972.6615475924425, -1146.1038837471758, -1179.0887354318465, -1019.7065662850118, -191.19410781882112, -476.55592782933513, -711.1236462220417, -86.90074985755525, -508.7583496003673, -759.1163888168317, -1232.823238609094, -923.3558921389186, -697.3856199186882, -690.0921671337201, -35.38837815649222, -807.8330689630677, -876.1651030238249, -118.7444939125564, -449.51868157286293, -1139.1300506609327, -331.9566924622206, -939.1639196676093, -1251.7481622368944, -973.4228058706699, -905.301947629615, -61.24372474943809, -175.55159691317525, -657.2449852151241, -168.66374879548454]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.555961259235228, "mean_inference_ms": 1.7058579902774338, "mean_action_processing_ms": 0.282875790500724, "mean_env_wait_ms": 3.02694333644437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012154102325439453, "StateBufferConnector_ms": 0.007910728454589844, "ViewRequirementAgentConnector_ms": 0.1953575611114502}, "num_episodes": 28, "episode_return_max": -16.77487909534685, "episode_return_min": -1314.980808043378, "episode_return_mean": -696.2764029963145, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.75538069630414, "num_env_steps_trained_throughput_per_sec": 297.75538069630414, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12988.016, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12987.931, "sample_time_ms": 1036.017, "learn_time_ms": 11879.743, "learn_throughput": 336.708, "synch_weights_time_ms": 71.177}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00000", "date": "2024-08-03_10-16-59", "timestamp": 1722660419, "time_this_iter_s": 13.446895122528076, "time_total_s": 183.62404704093933, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecfbc940>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 183.62404704093933, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.36315789473684, "ram_util_percent": 27.463157894736838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 226.1379701157411, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.8101929027587176, "policy_loss": -0.018964167717300976, "vf_loss": 1.8244989446674784, "vf_explained_var": 0.9946018341307838, "kl": 0.016008709705965886, "entropy": 1.4448348047832649, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -35.38837815649222, "episode_reward_min": -1508.2513312660544, "episode_reward_mean": -759.6147233294528, "episode_len_mean": 140.06, "episode_media": {}, "episodes_timesteps_total": 14006, "policy_reward_min": {"policy_0": -1508.2513312660544}, "policy_reward_max": {"policy_0": -35.38837815649222}, "policy_reward_mean": {"policy_0": -759.6147233294528}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1245.5212212471797, -701.9467444395309, -742.2299794509478, -1129.805863417757, -951.541665235679, -586.0538999050206, -827.4881273406074, -567.4096204150583, -1072.1171687075828, -731.2435370030878, -1069.0876975509696, -1056.7264849148182, -1221.5340657992654, -554.5563854660712, -420.47777317804827, -780.8226412816745, -878.1969396166977, -658.5015751635437, -756.9576354057915, -1170.0947569695709, -1001.9876767148212, -277.2767372483795, -803.7735250561898, -1000.5555592257759, -815.6554508194237, -307.7280800148371, -1314.980808043378, -276.85676569485713, -391.8960249765416, -1214.3405928625707, -287.05369559451634, -752.0195196802554, -1262.829389521812, -465.22015589236076, -710.8072264045211, -711.9757174926655, -554.1074041167079, -84.79564863688097, -781.9093171636381, -1296.177518350486, -972.6615475924425, -1146.1038837471758, -1179.0887354318465, -1019.7065662850118, -191.19410781882112, -476.55592782933513, -711.1236462220417, -86.90074985755525, -508.7583496003673, -759.1163888168317, -1232.823238609094, -923.3558921389186, -697.3856199186882, -690.0921671337201, -35.38837815649222, -807.8330689630677, -876.1651030238249, -118.7444939125564, -449.51868157286293, -1139.1300506609327, -331.9566924622206, -939.1639196676093, -1251.7481622368944, -973.4228058706699, -905.301947629615, -61.24372474943809, -175.55159691317525, -657.2449852151241, -168.66374879548454, -924.3598218595603, -818.2720224598634, -1508.2513312660544, -1124.324201901332, -1067.2615269425592, -1104.9471841728391, -864.7283486297443, -696.3303117852565, -1008.1336297889003, -1337.2379163948003, -405.87406672769424, -835.5324998969561, -518.4502423722031, -1051.9396571463944, -957.2092640098714, -158.90054539814764, -767.9887790756976, -675.3929478203157, -659.5166952814028, -926.9179968020143, -739.3174677723463, -590.9127012409205, -791.4093365787368, -779.4976278892636, -1128.0777218782468, -1052.2128745565242, -871.821667034869, -76.14264684033057, -944.7063443846575, -176.89297857636242, -478.7071996100691], "episode_lengths": [150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 83, 150, 150, 125, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 90, 150, 150, 81, 150, 150, 150, 150, 150, 150, 42, 150, 150, 97, 115, 150, 140, 150, 150, 150, 150, 54, 114, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 97, 150], "policy_policy_0_reward": [-1245.5212212471797, -701.9467444395309, -742.2299794509478, -1129.805863417757, -951.541665235679, -586.0538999050206, -827.4881273406074, -567.4096204150583, -1072.1171687075828, -731.2435370030878, -1069.0876975509696, -1056.7264849148182, -1221.5340657992654, -554.5563854660712, -420.47777317804827, -780.8226412816745, -878.1969396166977, -658.5015751635437, -756.9576354057915, -1170.0947569695709, -1001.9876767148212, -277.2767372483795, -803.7735250561898, -1000.5555592257759, -815.6554508194237, -307.7280800148371, -1314.980808043378, -276.85676569485713, -391.8960249765416, -1214.3405928625707, -287.05369559451634, -752.0195196802554, -1262.829389521812, -465.22015589236076, -710.8072264045211, -711.9757174926655, -554.1074041167079, -84.79564863688097, -781.9093171636381, -1296.177518350486, -972.6615475924425, -1146.1038837471758, -1179.0887354318465, -1019.7065662850118, -191.19410781882112, -476.55592782933513, -711.1236462220417, -86.90074985755525, -508.7583496003673, -759.1163888168317, -1232.823238609094, -923.3558921389186, -697.3856199186882, -690.0921671337201, -35.38837815649222, -807.8330689630677, -876.1651030238249, -118.7444939125564, -449.51868157286293, -1139.1300506609327, -331.9566924622206, -939.1639196676093, -1251.7481622368944, -973.4228058706699, -905.301947629615, -61.24372474943809, -175.55159691317525, -657.2449852151241, -168.66374879548454, -924.3598218595603, -818.2720224598634, -1508.2513312660544, -1124.324201901332, -1067.2615269425592, -1104.9471841728391, -864.7283486297443, -696.3303117852565, -1008.1336297889003, -1337.2379163948003, -405.87406672769424, -835.5324998969561, -518.4502423722031, -1051.9396571463944, -957.2092640098714, -158.90054539814764, -767.9887790756976, -675.3929478203157, -659.5166952814028, -926.9179968020143, -739.3174677723463, -590.9127012409205, -791.4093365787368, -779.4976278892636, -1128.0777218782468, -1052.2128745565242, -871.821667034869, -76.14264684033057, -944.7063443846575, -176.89297857636242, -478.7071996100691]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554223476588462, "mean_inference_ms": 1.704385063298006, "mean_action_processing_ms": 0.2824588407329432, "mean_env_wait_ms": 3.0292425418242557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012359619140625, "StateBufferConnector_ms": 0.007982969284057617, "ViewRequirementAgentConnector_ms": 0.19811773300170898}, "num_episodes": 31, "episode_return_max": -35.38837815649222, "episode_return_min": -1508.2513312660544, "episode_return_mean": -759.6147233294528, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.70652148716874, "num_env_steps_trained_throughput_per_sec": 306.70652148716874, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13186.583, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13186.497, "sample_time_ms": 1036.018, "learn_time_ms": 12079.156, "learn_throughput": 331.149, "synch_weights_time_ms": 70.351}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00000", "date": "2024-08-03_10-17-12", "timestamp": 1722660432, "time_this_iter_s": 13.05483603477478, "time_total_s": 196.6788830757141, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0e320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 196.6788830757141, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 13.26315789473684, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 196.06782812476158, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.213464757055044, "policy_loss": -0.010090756560869826, "vf_loss": 2.2197093553841114, "vf_explained_var": 0.9847828689341743, "kl": 0.013273787292746435, "entropy": 1.3597661188493173, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -19.04939556452223, "episode_reward_min": -1508.2513312660544, "episode_reward_mean": -712.2744336837276, "episode_len_mean": 137.31, "episode_media": {}, "episodes_timesteps_total": 13731, "policy_reward_min": {"policy_0": -1508.2513312660544}, "policy_reward_max": {"policy_0": -19.04939556452223}, "policy_reward_mean": {"policy_0": -712.2744336837276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-276.85676569485713, -391.8960249765416, -1214.3405928625707, -287.05369559451634, -752.0195196802554, -1262.829389521812, -465.22015589236076, -710.8072264045211, -711.9757174926655, -554.1074041167079, -84.79564863688097, -781.9093171636381, -1296.177518350486, -972.6615475924425, -1146.1038837471758, -1179.0887354318465, -1019.7065662850118, -191.19410781882112, -476.55592782933513, -711.1236462220417, -86.90074985755525, -508.7583496003673, -759.1163888168317, -1232.823238609094, -923.3558921389186, -697.3856199186882, -690.0921671337201, -35.38837815649222, -807.8330689630677, -876.1651030238249, -118.7444939125564, -449.51868157286293, -1139.1300506609327, -331.9566924622206, -939.1639196676093, -1251.7481622368944, -973.4228058706699, -905.301947629615, -61.24372474943809, -175.55159691317525, -657.2449852151241, -168.66374879548454, -924.3598218595603, -818.2720224598634, -1508.2513312660544, -1124.324201901332, -1067.2615269425592, -1104.9471841728391, -864.7283486297443, -696.3303117852565, -1008.1336297889003, -1337.2379163948003, -405.87406672769424, -835.5324998969561, -518.4502423722031, -1051.9396571463944, -957.2092640098714, -158.90054539814764, -767.9887790756976, -675.3929478203157, -659.5166952814028, -926.9179968020143, -739.3174677723463, -590.9127012409205, -791.4093365787368, -779.4976278892636, -1128.0777218782468, -1052.2128745565242, -871.821667034869, -76.14264684033057, -944.7063443846575, -176.89297857636242, -478.7071996100691, -934.2930035730127, -1007.2667005530938, -480.9404856777251, -708.5335148225117, -989.5504837341236, -889.4950566664021, -419.993957612466, -710.9904982651942, -19.04939556452223, -379.9878807849616, -796.4225490329031, -472.6238264562546, -91.66333261174611, -871.7661715323246, -746.4804544755286, -1308.2883821990577, -591.5989221123463, -242.42739168114474, -946.4775349076189, -670.9438806809383, -695.748595721893, -756.9574509080442, -199.19772590469302, -416.66598051820665, -958.2449181429373, -597.9915505534793, -1006.6430103660517], "episode_lengths": [83, 150, 150, 125, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 90, 150, 150, 81, 150, 150, 150, 150, 150, 150, 42, 150, 150, 97, 115, 150, 140, 150, 150, 150, 150, 54, 114, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 99, 150, 150, 79, 150, 150, 150, 129, 80, 150, 150, 150, 150, 106, 150, 150, 150, 150], "policy_policy_0_reward": [-276.85676569485713, -391.8960249765416, -1214.3405928625707, -287.05369559451634, -752.0195196802554, -1262.829389521812, -465.22015589236076, -710.8072264045211, -711.9757174926655, -554.1074041167079, -84.79564863688097, -781.9093171636381, -1296.177518350486, -972.6615475924425, -1146.1038837471758, -1179.0887354318465, -1019.7065662850118, -191.19410781882112, -476.55592782933513, -711.1236462220417, -86.90074985755525, -508.7583496003673, -759.1163888168317, -1232.823238609094, -923.3558921389186, -697.3856199186882, -690.0921671337201, -35.38837815649222, -807.8330689630677, -876.1651030238249, -118.7444939125564, -449.51868157286293, -1139.1300506609327, -331.9566924622206, -939.1639196676093, -1251.7481622368944, -973.4228058706699, -905.301947629615, -61.24372474943809, -175.55159691317525, -657.2449852151241, -168.66374879548454, -924.3598218595603, -818.2720224598634, -1508.2513312660544, -1124.324201901332, -1067.2615269425592, -1104.9471841728391, -864.7283486297443, -696.3303117852565, -1008.1336297889003, -1337.2379163948003, -405.87406672769424, -835.5324998969561, -518.4502423722031, -1051.9396571463944, -957.2092640098714, -158.90054539814764, -767.9887790756976, -675.3929478203157, -659.5166952814028, -926.9179968020143, -739.3174677723463, -590.9127012409205, -791.4093365787368, -779.4976278892636, -1128.0777218782468, -1052.2128745565242, -871.821667034869, -76.14264684033057, -944.7063443846575, -176.89297857636242, -478.7071996100691, -934.2930035730127, -1007.2667005530938, -480.9404856777251, -708.5335148225117, -989.5504837341236, -889.4950566664021, -419.993957612466, -710.9904982651942, -19.04939556452223, -379.9878807849616, -796.4225490329031, -472.6238264562546, -91.66333261174611, -871.7661715323246, -746.4804544755286, -1308.2883821990577, -591.5989221123463, -242.42739168114474, -946.4775349076189, -670.9438806809383, -695.748595721893, -756.9574509080442, -199.19772590469302, -416.66598051820665, -958.2449181429373, -597.9915505534793, -1006.6430103660517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559114680200551, "mean_inference_ms": 1.7034173398604475, "mean_action_processing_ms": 0.2822707690513028, "mean_env_wait_ms": 3.029545760853627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012325286865234375, "StateBufferConnector_ms": 0.008114337921142578, "ViewRequirementAgentConnector_ms": 0.19966840744018555}, "num_episodes": 27, "episode_return_max": -19.04939556452223, "episode_return_min": -1508.2513312660544, "episode_return_mean": -712.2744336837276, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.81479592870596, "num_env_steps_trained_throughput_per_sec": 303.81479592870596, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13318.774, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13318.689, "sample_time_ms": 1031.941, "learn_time_ms": 12215.333, "learn_throughput": 327.457, "synch_weights_time_ms": 70.494}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00000", "date": "2024-08-03_10-17-25", "timestamp": 1722660445, "time_this_iter_s": 13.178268671035767, "time_total_s": 209.85715174674988, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0cd30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 209.85715174674988, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.057894736842107, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 188.48045663634937, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.9476138953740398, "policy_loss": -0.008190835994416073, "vf_loss": 1.9518501161287227, "vf_explained_var": 0.9883217335989077, "kl": 0.013647792256172882, "entropy": 1.3972001196195682, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -19.04939556452223, "episode_reward_min": -1508.2513312660544, "episode_reward_mean": -709.3093689548131, "episode_len_mean": 137.48, "episode_media": {}, "episodes_timesteps_total": 13748, "policy_reward_min": {"policy_0": -1508.2513312660544}, "policy_reward_max": {"policy_0": -19.04939556452223}, "policy_reward_mean": {"policy_0": -709.3093689548131}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-118.7444939125564, -449.51868157286293, -1139.1300506609327, -331.9566924622206, -939.1639196676093, -1251.7481622368944, -973.4228058706699, -905.301947629615, -61.24372474943809, -175.55159691317525, -657.2449852151241, -168.66374879548454, -924.3598218595603, -818.2720224598634, -1508.2513312660544, -1124.324201901332, -1067.2615269425592, -1104.9471841728391, -864.7283486297443, -696.3303117852565, -1008.1336297889003, -1337.2379163948003, -405.87406672769424, -835.5324998969561, -518.4502423722031, -1051.9396571463944, -957.2092640098714, -158.90054539814764, -767.9887790756976, -675.3929478203157, -659.5166952814028, -926.9179968020143, -739.3174677723463, -590.9127012409205, -791.4093365787368, -779.4976278892636, -1128.0777218782468, -1052.2128745565242, -871.821667034869, -76.14264684033057, -944.7063443846575, -176.89297857636242, -478.7071996100691, -934.2930035730127, -1007.2667005530938, -480.9404856777251, -708.5335148225117, -989.5504837341236, -889.4950566664021, -419.993957612466, -710.9904982651942, -19.04939556452223, -379.9878807849616, -796.4225490329031, -472.6238264562546, -91.66333261174611, -871.7661715323246, -746.4804544755286, -1308.2883821990577, -591.5989221123463, -242.42739168114474, -946.4775349076189, -670.9438806809383, -695.748595721893, -756.9574509080442, -199.19772590469302, -416.66598051820665, -958.2449181429373, -597.9915505534793, -1006.6430103660517, -869.8279795356971, -610.6308898304057, -1047.3130502471133, -679.8403383589565, -940.9629205379305, -1283.58400074763, -183.2113694367375, -523.8662631853662, -439.89620380035973, -364.4866284983074, -814.4478477353994, -713.9365463149849, -432.23333576056183, -798.3676361290021, -1152.538739741413, -757.4145321474982, -1144.026372861826, -711.955595500157, -799.5468891118586, -43.14814071897967, -788.3302040905209, -618.9005271074953, -110.3120881478185, -166.6675851938701, -666.9939451777552, -1180.4757540844453, -689.3486024819781, -872.8116283148775, -1024.4665760057087, -378.19368383695655], "episode_lengths": [97, 115, 150, 140, 150, 150, 150, 150, 54, 114, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 99, 150, 150, 79, 150, 150, 150, 129, 80, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 110, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 63, 124, 150, 150, 150, 150, 150, 98], "policy_policy_0_reward": [-118.7444939125564, -449.51868157286293, -1139.1300506609327, -331.9566924622206, -939.1639196676093, -1251.7481622368944, -973.4228058706699, -905.301947629615, -61.24372474943809, -175.55159691317525, -657.2449852151241, -168.66374879548454, -924.3598218595603, -818.2720224598634, -1508.2513312660544, -1124.324201901332, -1067.2615269425592, -1104.9471841728391, -864.7283486297443, -696.3303117852565, -1008.1336297889003, -1337.2379163948003, -405.87406672769424, -835.5324998969561, -518.4502423722031, -1051.9396571463944, -957.2092640098714, -158.90054539814764, -767.9887790756976, -675.3929478203157, -659.5166952814028, -926.9179968020143, -739.3174677723463, -590.9127012409205, -791.4093365787368, -779.4976278892636, -1128.0777218782468, -1052.2128745565242, -871.821667034869, -76.14264684033057, -944.7063443846575, -176.89297857636242, -478.7071996100691, -934.2930035730127, -1007.2667005530938, -480.9404856777251, -708.5335148225117, -989.5504837341236, -889.4950566664021, -419.993957612466, -710.9904982651942, -19.04939556452223, -379.9878807849616, -796.4225490329031, -472.6238264562546, -91.66333261174611, -871.7661715323246, -746.4804544755286, -1308.2883821990577, -591.5989221123463, -242.42739168114474, -946.4775349076189, -670.9438806809383, -695.748595721893, -756.9574509080442, -199.19772590469302, -416.66598051820665, -958.2449181429373, -597.9915505534793, -1006.6430103660517, -869.8279795356971, -610.6308898304057, -1047.3130502471133, -679.8403383589565, -940.9629205379305, -1283.58400074763, -183.2113694367375, -523.8662631853662, -439.89620380035973, -364.4866284983074, -814.4478477353994, -713.9365463149849, -432.23333576056183, -798.3676361290021, -1152.538739741413, -757.4145321474982, -1144.026372861826, -711.955595500157, -799.5468891118586, -43.14814071897967, -788.3302040905209, -618.9005271074953, -110.3120881478185, -166.6675851938701, -666.9939451777552, -1180.4757540844453, -689.3486024819781, -872.8116283148775, -1024.4665760057087, -378.19368383695655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.55525530570195, "mean_inference_ms": 1.700886199879979, "mean_action_processing_ms": 0.2817679911574399, "mean_env_wait_ms": 3.0266292209198786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012003421783447266, "StateBufferConnector_ms": 0.007935047149658203, "ViewRequirementAgentConnector_ms": 0.19618844985961914}, "num_episodes": 30, "episode_return_max": -19.04939556452223, "episode_return_min": -1508.2513312660544, "episode_return_mean": -709.3093689548131, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.6063906548462, "num_env_steps_trained_throughput_per_sec": 296.6063906548462, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13337.571, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13337.488, "sample_time_ms": 1030.454, "learn_time_ms": 12236.938, "learn_throughput": 326.879, "synch_weights_time_ms": 69.179}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00000", "date": "2024-08-03_10-17-38", "timestamp": 1722660458, "time_this_iter_s": 13.497704982757568, "time_total_s": 223.35485672950745, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0cdc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 223.35485672950745, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 12.647368421052633, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 211.58326886693638, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.074490847873191, "policy_loss": -0.008882642871079345, "vf_loss": 2.078713762263457, "vf_explained_var": 0.9828861995289723, "kl": 0.01598400681656738, "entropy": 1.3546827467779319, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -19.04939556452223, "episode_reward_min": -1308.2883821990577, "episode_reward_mean": -697.1439773591791, "episode_len_mean": 138.21, "episode_media": {}, "episodes_timesteps_total": 13821, "policy_reward_min": {"policy_0": -1308.2883821990577}, "policy_reward_max": {"policy_0": -19.04939556452223}, "policy_reward_mean": {"policy_0": -697.1439773591791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-926.9179968020143, -739.3174677723463, -590.9127012409205, -791.4093365787368, -779.4976278892636, -1128.0777218782468, -1052.2128745565242, -871.821667034869, -76.14264684033057, -944.7063443846575, -176.89297857636242, -478.7071996100691, -934.2930035730127, -1007.2667005530938, -480.9404856777251, -708.5335148225117, -989.5504837341236, -889.4950566664021, -419.993957612466, -710.9904982651942, -19.04939556452223, -379.9878807849616, -796.4225490329031, -472.6238264562546, -91.66333261174611, -871.7661715323246, -746.4804544755286, -1308.2883821990577, -591.5989221123463, -242.42739168114474, -946.4775349076189, -670.9438806809383, -695.748595721893, -756.9574509080442, -199.19772590469302, -416.66598051820665, -958.2449181429373, -597.9915505534793, -1006.6430103660517, -869.8279795356971, -610.6308898304057, -1047.3130502471133, -679.8403383589565, -940.9629205379305, -1283.58400074763, -183.2113694367375, -523.8662631853662, -439.89620380035973, -364.4866284983074, -814.4478477353994, -713.9365463149849, -432.23333576056183, -798.3676361290021, -1152.538739741413, -757.4145321474982, -1144.026372861826, -711.955595500157, -799.5468891118586, -43.14814071897967, -788.3302040905209, -618.9005271074953, -110.3120881478185, -166.6675851938701, -666.9939451777552, -1180.4757540844453, -689.3486024819781, -872.8116283148775, -1024.4665760057087, -378.19368383695655, -906.5385636958575, -1216.1327182461255, -540.6640250081134, -973.4746580955829, -283.85737473741807, -967.5441609949668, -843.869266024155, -922.1864885927557, -1072.7415834938038, -675.2603747797665, -743.4702879777373, -328.2675860200021, -932.1851720663877, -747.0652446942997, -236.63967038107657, -851.2506473517275, -328.10465373159366, -876.6025168152001, -973.7347571515652, -1293.318294520633, -262.193004780277, -593.2361501800359, -658.9361353706113, -725.3090571095706, -581.0839732663295, -811.0669978503291, -658.3294766956091, -91.38294571406557, -887.4624886257634, -814.4000298360473, -643.4943392453685], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 99, 150, 150, 79, 150, 150, 150, 129, 80, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 110, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 63, 124, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 116, 150, 150, 150, 150, 147, 150, 147, 150, 150, 75, 150, 115, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 74, 150, 150, 148], "policy_policy_0_reward": [-926.9179968020143, -739.3174677723463, -590.9127012409205, -791.4093365787368, -779.4976278892636, -1128.0777218782468, -1052.2128745565242, -871.821667034869, -76.14264684033057, -944.7063443846575, -176.89297857636242, -478.7071996100691, -934.2930035730127, -1007.2667005530938, -480.9404856777251, -708.5335148225117, -989.5504837341236, -889.4950566664021, -419.993957612466, -710.9904982651942, -19.04939556452223, -379.9878807849616, -796.4225490329031, -472.6238264562546, -91.66333261174611, -871.7661715323246, -746.4804544755286, -1308.2883821990577, -591.5989221123463, -242.42739168114474, -946.4775349076189, -670.9438806809383, -695.748595721893, -756.9574509080442, -199.19772590469302, -416.66598051820665, -958.2449181429373, -597.9915505534793, -1006.6430103660517, -869.8279795356971, -610.6308898304057, -1047.3130502471133, -679.8403383589565, -940.9629205379305, -1283.58400074763, -183.2113694367375, -523.8662631853662, -439.89620380035973, -364.4866284983074, -814.4478477353994, -713.9365463149849, -432.23333576056183, -798.3676361290021, -1152.538739741413, -757.4145321474982, -1144.026372861826, -711.955595500157, -799.5468891118586, -43.14814071897967, -788.3302040905209, -618.9005271074953, -110.3120881478185, -166.6675851938701, -666.9939451777552, -1180.4757540844453, -689.3486024819781, -872.8116283148775, -1024.4665760057087, -378.19368383695655, -906.5385636958575, -1216.1327182461255, -540.6640250081134, -973.4746580955829, -283.85737473741807, -967.5441609949668, -843.869266024155, -922.1864885927557, -1072.7415834938038, -675.2603747797665, -743.4702879777373, -328.2675860200021, -932.1851720663877, -747.0652446942997, -236.63967038107657, -851.2506473517275, -328.10465373159366, -876.6025168152001, -973.7347571515652, -1293.318294520633, -262.193004780277, -593.2361501800359, -658.9361353706113, -725.3090571095706, -581.0839732663295, -811.0669978503291, -658.3294766956091, -91.38294571406557, -887.4624886257634, -814.4000298360473, -643.4943392453685]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555809583058573, "mean_inference_ms": 1.6995777575904993, "mean_action_processing_ms": 0.28153126362950137, "mean_env_wait_ms": 3.0251763285941746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01188349723815918, "StateBufferConnector_ms": 0.007936716079711914, "ViewRequirementAgentConnector_ms": 0.19659900665283203}, "num_episodes": 31, "episode_return_max": -19.04939556452223, "episode_return_min": -1308.2883821990577, "episode_return_mean": -697.1439773591791, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.79000067087526, "num_env_steps_trained_throughput_per_sec": 298.79000067087526, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13344.976, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13344.893, "sample_time_ms": 1031.03, "learn_time_ms": 12243.985, "learn_throughput": 326.691, "synch_weights_time_ms": 68.958}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00000", "date": "2024-08-03_10-17-52", "timestamp": 1722660472, "time_this_iter_s": 13.398955345153809, "time_total_s": 236.75381207466125, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0f130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 236.75381207466125, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.063157894736843, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 233.1123617510001, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.7211603428547582, "policy_loss": -0.012185387035424355, "vf_loss": 1.7285926684116324, "vf_explained_var": 0.9929292168468237, "kl": 0.016305581478385043, "entropy": 1.3861538216471672, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -43.14814071897967, "episode_reward_min": -1308.2883821990577, "episode_reward_mean": -724.7055555504284, "episode_len_mean": 140.38, "episode_media": {}, "episodes_timesteps_total": 14038, "policy_reward_min": {"policy_0": -1308.2883821990577}, "policy_reward_max": {"policy_0": -43.14814071897967}, "policy_reward_mean": {"policy_0": -724.7055555504284}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1308.2883821990577, -591.5989221123463, -242.42739168114474, -946.4775349076189, -670.9438806809383, -695.748595721893, -756.9574509080442, -199.19772590469302, -416.66598051820665, -958.2449181429373, -597.9915505534793, -1006.6430103660517, -869.8279795356971, -610.6308898304057, -1047.3130502471133, -679.8403383589565, -940.9629205379305, -1283.58400074763, -183.2113694367375, -523.8662631853662, -439.89620380035973, -364.4866284983074, -814.4478477353994, -713.9365463149849, -432.23333576056183, -798.3676361290021, -1152.538739741413, -757.4145321474982, -1144.026372861826, -711.955595500157, -799.5468891118586, -43.14814071897967, -788.3302040905209, -618.9005271074953, -110.3120881478185, -166.6675851938701, -666.9939451777552, -1180.4757540844453, -689.3486024819781, -872.8116283148775, -1024.4665760057087, -378.19368383695655, -906.5385636958575, -1216.1327182461255, -540.6640250081134, -973.4746580955829, -283.85737473741807, -967.5441609949668, -843.869266024155, -922.1864885927557, -1072.7415834938038, -675.2603747797665, -743.4702879777373, -328.2675860200021, -932.1851720663877, -747.0652446942997, -236.63967038107657, -851.2506473517275, -328.10465373159366, -876.6025168152001, -973.7347571515652, -1293.318294520633, -262.193004780277, -593.2361501800359, -658.9361353706113, -725.3090571095706, -581.0839732663295, -811.0669978503291, -658.3294766956091, -91.38294571406557, -887.4624886257634, -814.4000298360473, -643.4943392453685, -742.5175648880312, -613.6090926293543, -1016.436516180928, -797.9208848134629, -864.466067158401, -698.8331846051921, -1024.7428708319376, -304.51305266274704, -942.3795683340219, -794.1505366399696, -542.5044010259508, -786.1588289593585, -815.1094657316096, -785.0684832247838, -762.5829698201854, -824.8495264365994, -1052.332948147357, -956.1733008486251, -826.9117878152706, -1104.238081525818, -865.0207989280302, -780.4909235010985, -285.3859833085128, -805.0305146203157, -611.9335024817847, -1082.7461489055493, -145.72468962715618], "episode_lengths": [150, 129, 80, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 110, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 63, 124, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 116, 150, 150, 150, 150, 147, 150, 147, 150, 150, 75, 150, 115, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 74, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 100], "policy_policy_0_reward": [-1308.2883821990577, -591.5989221123463, -242.42739168114474, -946.4775349076189, -670.9438806809383, -695.748595721893, -756.9574509080442, -199.19772590469302, -416.66598051820665, -958.2449181429373, -597.9915505534793, -1006.6430103660517, -869.8279795356971, -610.6308898304057, -1047.3130502471133, -679.8403383589565, -940.9629205379305, -1283.58400074763, -183.2113694367375, -523.8662631853662, -439.89620380035973, -364.4866284983074, -814.4478477353994, -713.9365463149849, -432.23333576056183, -798.3676361290021, -1152.538739741413, -757.4145321474982, -1144.026372861826, -711.955595500157, -799.5468891118586, -43.14814071897967, -788.3302040905209, -618.9005271074953, -110.3120881478185, -166.6675851938701, -666.9939451777552, -1180.4757540844453, -689.3486024819781, -872.8116283148775, -1024.4665760057087, -378.19368383695655, -906.5385636958575, -1216.1327182461255, -540.6640250081134, -973.4746580955829, -283.85737473741807, -967.5441609949668, -843.869266024155, -922.1864885927557, -1072.7415834938038, -675.2603747797665, -743.4702879777373, -328.2675860200021, -932.1851720663877, -747.0652446942997, -236.63967038107657, -851.2506473517275, -328.10465373159366, -876.6025168152001, -973.7347571515652, -1293.318294520633, -262.193004780277, -593.2361501800359, -658.9361353706113, -725.3090571095706, -581.0839732663295, -811.0669978503291, -658.3294766956091, -91.38294571406557, -887.4624886257634, -814.4000298360473, -643.4943392453685, -742.5175648880312, -613.6090926293543, -1016.436516180928, -797.9208848134629, -864.466067158401, -698.8331846051921, -1024.7428708319376, -304.51305266274704, -942.3795683340219, -794.1505366399696, -542.5044010259508, -786.1588289593585, -815.1094657316096, -785.0684832247838, -762.5829698201854, -824.8495264365994, -1052.332948147357, -956.1733008486251, -826.9117878152706, -1104.238081525818, -865.0207989280302, -780.4909235010985, -285.3859833085128, -805.0305146203157, -611.9335024817847, -1082.7461489055493, -145.72468962715618]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552169739650615, "mean_inference_ms": 1.70115577773341, "mean_action_processing_ms": 0.28156655555340526, "mean_env_wait_ms": 3.0281397460439394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011625051498413086, "StateBufferConnector_ms": 0.007706642150878906, "ViewRequirementAgentConnector_ms": 0.192274808883667}, "num_episodes": 27, "episode_return_max": -43.14814071897967, "episode_return_min": -1308.2883821990577, "episode_return_mean": -724.7055555504284, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.0492444988923, "num_env_steps_trained_throughput_per_sec": 300.0492444988923, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13332.431, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13332.348, "sample_time_ms": 1034.694, "learn_time_ms": 12228.376, "learn_throughput": 327.108, "synch_weights_time_ms": 68.365}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00000", "date": "2024-08-03_10-18-05", "timestamp": 1722660485, "time_this_iter_s": 13.344033479690552, "time_total_s": 250.0978455543518, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ed07edd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 250.0978455543518, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 12.810526315789474, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 180.29405535459517, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.774383863310019, "policy_loss": -0.009744342716294341, "vf_loss": 1.780102520249784, "vf_explained_var": 0.9906543343017499, "kl": 0.013905220809848136, "entropy": 1.4588021914164224, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -43.14814071897967, "episode_reward_min": -1293.318294520633, "episode_reward_mean": -745.2189658039056, "episode_len_mean": 140.37, "episode_media": {}, "episodes_timesteps_total": 14037, "policy_reward_min": {"policy_0": -1293.318294520633}, "policy_reward_max": {"policy_0": -43.14814071897967}, "policy_reward_mean": {"policy_0": -745.2189658039056}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1144.026372861826, -711.955595500157, -799.5468891118586, -43.14814071897967, -788.3302040905209, -618.9005271074953, -110.3120881478185, -166.6675851938701, -666.9939451777552, -1180.4757540844453, -689.3486024819781, -872.8116283148775, -1024.4665760057087, -378.19368383695655, -906.5385636958575, -1216.1327182461255, -540.6640250081134, -973.4746580955829, -283.85737473741807, -967.5441609949668, -843.869266024155, -922.1864885927557, -1072.7415834938038, -675.2603747797665, -743.4702879777373, -328.2675860200021, -932.1851720663877, -747.0652446942997, -236.63967038107657, -851.2506473517275, -328.10465373159366, -876.6025168152001, -973.7347571515652, -1293.318294520633, -262.193004780277, -593.2361501800359, -658.9361353706113, -725.3090571095706, -581.0839732663295, -811.0669978503291, -658.3294766956091, -91.38294571406557, -887.4624886257634, -814.4000298360473, -643.4943392453685, -742.5175648880312, -613.6090926293543, -1016.436516180928, -797.9208848134629, -864.466067158401, -698.8331846051921, -1024.7428708319376, -304.51305266274704, -942.3795683340219, -794.1505366399696, -542.5044010259508, -786.1588289593585, -815.1094657316096, -785.0684832247838, -762.5829698201854, -824.8495264365994, -1052.332948147357, -956.1733008486251, -826.9117878152706, -1104.238081525818, -865.0207989280302, -780.4909235010985, -285.3859833085128, -805.0305146203157, -611.9335024817847, -1082.7461489055493, -145.72468962715618, -1075.1068446182624, -434.9951048143823, -1009.0370333300846, -785.5904798878164, -932.4975527482403, -818.0949590478067, -921.0775869879665, -629.0770871388087, -1066.9079691863592, -572.9294154132076, -71.62196868610992, -665.3123464303576, -803.6365448151784, -353.52173399085956, -1168.2841930607735, -1215.2789076104816, -928.8531951110887, -1171.4065715931943, -523.7489130727206, -1145.8851034669228, -1153.5592447281394, -816.5546980343021, -383.82488183573236, -902.3095577505932, -185.82032198334312, -1071.7143248941234, -1062.1227941853099, -186.31531662932912], "episode_lengths": [150, 150, 150, 61, 150, 150, 63, 124, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 116, 150, 150, 150, 150, 147, 150, 147, 150, 150, 75, 150, 115, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 74, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 100, 150, 114, 150, 150, 150, 150, 150, 135, 150, 150, 48, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 85, 150, 150, 120], "policy_policy_0_reward": [-1144.026372861826, -711.955595500157, -799.5468891118586, -43.14814071897967, -788.3302040905209, -618.9005271074953, -110.3120881478185, -166.6675851938701, -666.9939451777552, -1180.4757540844453, -689.3486024819781, -872.8116283148775, -1024.4665760057087, -378.19368383695655, -906.5385636958575, -1216.1327182461255, -540.6640250081134, -973.4746580955829, -283.85737473741807, -967.5441609949668, -843.869266024155, -922.1864885927557, -1072.7415834938038, -675.2603747797665, -743.4702879777373, -328.2675860200021, -932.1851720663877, -747.0652446942997, -236.63967038107657, -851.2506473517275, -328.10465373159366, -876.6025168152001, -973.7347571515652, -1293.318294520633, -262.193004780277, -593.2361501800359, -658.9361353706113, -725.3090571095706, -581.0839732663295, -811.0669978503291, -658.3294766956091, -91.38294571406557, -887.4624886257634, -814.4000298360473, -643.4943392453685, -742.5175648880312, -613.6090926293543, -1016.436516180928, -797.9208848134629, -864.466067158401, -698.8331846051921, -1024.7428708319376, -304.51305266274704, -942.3795683340219, -794.1505366399696, -542.5044010259508, -786.1588289593585, -815.1094657316096, -785.0684832247838, -762.5829698201854, -824.8495264365994, -1052.332948147357, -956.1733008486251, -826.9117878152706, -1104.238081525818, -865.0207989280302, -780.4909235010985, -285.3859833085128, -805.0305146203157, -611.9335024817847, -1082.7461489055493, -145.72468962715618, -1075.1068446182624, -434.9951048143823, -1009.0370333300846, -785.5904798878164, -932.4975527482403, -818.0949590478067, -921.0775869879665, -629.0770871388087, -1066.9079691863592, -572.9294154132076, -71.62196868610992, -665.3123464303576, -803.6365448151784, -353.52173399085956, -1168.2841930607735, -1215.2789076104816, -928.8531951110887, -1171.4065715931943, -523.7489130727206, -1145.8851034669228, -1153.5592447281394, -816.5546980343021, -383.82488183573236, -902.3095577505932, -185.82032198334312, -1071.7143248941234, -1062.1227941853099, -186.31531662932912]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549345474905255, "mean_inference_ms": 1.699617604737001, "mean_action_processing_ms": 0.28128608749566647, "mean_env_wait_ms": 3.0262537873668363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011397123336791992, "StateBufferConnector_ms": 0.00770878791809082, "ViewRequirementAgentConnector_ms": 0.19245457649230957}, "num_episodes": 28, "episode_return_max": -43.14814071897967, "episode_return_min": -1293.318294520633, "episode_return_mean": -745.2189658039056, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.2004252192909, "num_env_steps_trained_throughput_per_sec": 309.2004252192909, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13312.869, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13312.789, "sample_time_ms": 1034.406, "learn_time_ms": 12209.7, "learn_throughput": 327.608, "synch_weights_time_ms": 67.775}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00000", "date": "2024-08-03_10-18-18", "timestamp": 1722660498, "time_this_iter_s": 12.94871211051941, "time_total_s": 263.0465576648712, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecfbc940>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 263.0465576648712, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.205555555555556, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 198.41764011383057, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.9352276207258303, "policy_loss": -0.01071161286381539, "vf_loss": 1.9417219740649065, "vf_explained_var": 0.993269925378263, "kl": 0.014519165280792853, "entropy": 1.3849616782118876, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -71.62196868610992, "episode_reward_min": -1293.318294520633, "episode_reward_mean": -729.3885359481471, "episode_len_mean": 138.99, "episode_media": {}, "episodes_timesteps_total": 13899, "policy_reward_min": {"policy_0": -1293.318294520633}, "policy_reward_max": {"policy_0": -71.62196868610992}, "policy_reward_mean": {"policy_0": -729.3885359481471}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-851.2506473517275, -328.10465373159366, -876.6025168152001, -973.7347571515652, -1293.318294520633, -262.193004780277, -593.2361501800359, -658.9361353706113, -725.3090571095706, -581.0839732663295, -811.0669978503291, -658.3294766956091, -91.38294571406557, -887.4624886257634, -814.4000298360473, -643.4943392453685, -742.5175648880312, -613.6090926293543, -1016.436516180928, -797.9208848134629, -864.466067158401, -698.8331846051921, -1024.7428708319376, -304.51305266274704, -942.3795683340219, -794.1505366399696, -542.5044010259508, -786.1588289593585, -815.1094657316096, -785.0684832247838, -762.5829698201854, -824.8495264365994, -1052.332948147357, -956.1733008486251, -826.9117878152706, -1104.238081525818, -865.0207989280302, -780.4909235010985, -285.3859833085128, -805.0305146203157, -611.9335024817847, -1082.7461489055493, -145.72468962715618, -1075.1068446182624, -434.9951048143823, -1009.0370333300846, -785.5904798878164, -932.4975527482403, -818.0949590478067, -921.0775869879665, -629.0770871388087, -1066.9079691863592, -572.9294154132076, -71.62196868610992, -665.3123464303576, -803.6365448151784, -353.52173399085956, -1168.2841930607735, -1215.2789076104816, -928.8531951110887, -1171.4065715931943, -523.7489130727206, -1145.8851034669228, -1153.5592447281394, -816.5546980343021, -383.82488183573236, -902.3095577505932, -185.82032198334312, -1071.7143248941234, -1062.1227941853099, -186.31531662932912, -839.2876727435975, -253.14519853890494, -126.9210820166543, -1145.2156465273158, -269.68932281239074, -1116.8289481778304, -1183.768837206436, -239.07394043824868, -700.8046571980593, -593.6448189337068, -955.1550177339622, -231.1486718253332, -726.8272097865789, -474.3186326693975, -869.3533225614361, -943.578785959153, -1086.6398568121397, -139.4608034635992, -600.2681144758023, -783.2823972905682, -852.735324703086, -1006.39773549701, -227.25727085604277, -101.24306299003003, -370.5844435322673, -517.2962769262052, -1011.8722162495297, -733.4935855973093, -902.7389283438347], "episode_lengths": [150, 115, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 74, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 100, 150, 114, 150, 150, 150, 150, 150, 135, 150, 150, 48, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 85, 150, 150, 120, 150, 82, 69, 150, 138, 150, 150, 94, 150, 150, 150, 95, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 99, 77, 106, 150, 150, 150, 150], "policy_policy_0_reward": [-851.2506473517275, -328.10465373159366, -876.6025168152001, -973.7347571515652, -1293.318294520633, -262.193004780277, -593.2361501800359, -658.9361353706113, -725.3090571095706, -581.0839732663295, -811.0669978503291, -658.3294766956091, -91.38294571406557, -887.4624886257634, -814.4000298360473, -643.4943392453685, -742.5175648880312, -613.6090926293543, -1016.436516180928, -797.9208848134629, -864.466067158401, -698.8331846051921, -1024.7428708319376, -304.51305266274704, -942.3795683340219, -794.1505366399696, -542.5044010259508, -786.1588289593585, -815.1094657316096, -785.0684832247838, -762.5829698201854, -824.8495264365994, -1052.332948147357, -956.1733008486251, -826.9117878152706, -1104.238081525818, -865.0207989280302, -780.4909235010985, -285.3859833085128, -805.0305146203157, -611.9335024817847, -1082.7461489055493, -145.72468962715618, -1075.1068446182624, -434.9951048143823, -1009.0370333300846, -785.5904798878164, -932.4975527482403, -818.0949590478067, -921.0775869879665, -629.0770871388087, -1066.9079691863592, -572.9294154132076, -71.62196868610992, -665.3123464303576, -803.6365448151784, -353.52173399085956, -1168.2841930607735, -1215.2789076104816, -928.8531951110887, -1171.4065715931943, -523.7489130727206, -1145.8851034669228, -1153.5592447281394, -816.5546980343021, -383.82488183573236, -902.3095577505932, -185.82032198334312, -1071.7143248941234, -1062.1227941853099, -186.31531662932912, -839.2876727435975, -253.14519853890494, -126.9210820166543, -1145.2156465273158, -269.68932281239074, -1116.8289481778304, -1183.768837206436, -239.07394043824868, -700.8046571980593, -593.6448189337068, -955.1550177339622, -231.1486718253332, -726.8272097865789, -474.3186326693975, -869.3533225614361, -943.578785959153, -1086.6398568121397, -139.4608034635992, -600.2681144758023, -783.2823972905682, -852.735324703086, -1006.39773549701, -227.25727085604277, -101.24306299003003, -370.5844435322673, -517.2962769262052, -1011.8722162495297, -733.4935855973093, -902.7389283438347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542878480488871, "mean_inference_ms": 1.6992430837139032, "mean_action_processing_ms": 0.28116452377800705, "mean_env_wait_ms": 3.028091098980184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011217594146728516, "StateBufferConnector_ms": 0.007728099822998047, "ViewRequirementAgentConnector_ms": 0.19201040267944336}, "num_episodes": 29, "episode_return_max": -71.62196868610992, "episode_return_min": -1293.318294520633, "episode_return_mean": -729.3885359481471, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.31630989415925, "num_env_steps_trained_throughput_per_sec": 300.31630989415925, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13310.241, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13310.159, "sample_time_ms": 1035.462, "learn_time_ms": 12208.327, "learn_throughput": 327.645, "synch_weights_time_ms": 65.465}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00000", "date": "2024-08-03_10-18-32", "timestamp": 1722660512, "time_this_iter_s": 13.33221697807312, "time_total_s": 276.37877464294434, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0c040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 276.37877464294434, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.968421052631578, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 185.61516166726747, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.7148550000041722, "policy_loss": -0.009365178761072457, "vf_loss": 1.7200440514211854, "vf_explained_var": 0.9912198814253013, "kl": 0.014400634308306811, "entropy": 1.4406283602118493, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -51.962124453833006, "episode_reward_min": -1349.5891970488426, "episode_reward_mean": -697.8168041163694, "episode_len_mean": 136.02, "episode_media": {}, "episodes_timesteps_total": 13602, "policy_reward_min": {"policy_0": -1349.5891970488426}, "policy_reward_max": {"policy_0": -51.962124453833006}, "policy_reward_mean": {"policy_0": -697.8168041163694}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-762.5829698201854, -824.8495264365994, -1052.332948147357, -956.1733008486251, -826.9117878152706, -1104.238081525818, -865.0207989280302, -780.4909235010985, -285.3859833085128, -805.0305146203157, -611.9335024817847, -1082.7461489055493, -145.72468962715618, -1075.1068446182624, -434.9951048143823, -1009.0370333300846, -785.5904798878164, -932.4975527482403, -818.0949590478067, -921.0775869879665, -629.0770871388087, -1066.9079691863592, -572.9294154132076, -71.62196868610992, -665.3123464303576, -803.6365448151784, -353.52173399085956, -1168.2841930607735, -1215.2789076104816, -928.8531951110887, -1171.4065715931943, -523.7489130727206, -1145.8851034669228, -1153.5592447281394, -816.5546980343021, -383.82488183573236, -902.3095577505932, -185.82032198334312, -1071.7143248941234, -1062.1227941853099, -186.31531662932912, -839.2876727435975, -253.14519853890494, -126.9210820166543, -1145.2156465273158, -269.68932281239074, -1116.8289481778304, -1183.768837206436, -239.07394043824868, -700.8046571980593, -593.6448189337068, -955.1550177339622, -231.1486718253332, -726.8272097865789, -474.3186326693975, -869.3533225614361, -943.578785959153, -1086.6398568121397, -139.4608034635992, -600.2681144758023, -783.2823972905682, -852.735324703086, -1006.39773549701, -227.25727085604277, -101.24306299003003, -370.5844435322673, -517.2962769262052, -1011.8722162495297, -733.4935855973093, -902.7389283438347, -518.310149660721, -51.962124453833006, -1004.0302263224606, -852.7842868313764, -1349.5891970488426, -812.8118830215301, -161.33389609653392, -1110.5293756365963, -527.6622445211427, -285.1788007675986, -993.7386105634534, -930.5577173137682, -183.39585828860928, -854.8879368234794, -676.9428479899225, -136.32706610652502, -593.5110582146297, -477.4600233160595, -260.6275152531395, -1007.1473370313316, -695.3482912444691, -148.6260109721661, -206.63077453580502, -678.3403002878337, -766.3163065642033, -734.2466106704035, -754.7579336469553, -953.6533072481769, -635.2957667358313, -259.1393455853233], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 100, 150, 114, 150, 150, 150, 150, 150, 135, 150, 150, 48, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 85, 150, 150, 120, 150, 82, 69, 150, 138, 150, 150, 94, 150, 150, 150, 95, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 99, 77, 106, 150, 150, 150, 150, 150, 46, 150, 150, 150, 150, 115, 150, 150, 96, 150, 150, 77, 150, 150, 96, 150, 150, 107, 150, 135, 77, 83, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-762.5829698201854, -824.8495264365994, -1052.332948147357, -956.1733008486251, -826.9117878152706, -1104.238081525818, -865.0207989280302, -780.4909235010985, -285.3859833085128, -805.0305146203157, -611.9335024817847, -1082.7461489055493, -145.72468962715618, -1075.1068446182624, -434.9951048143823, -1009.0370333300846, -785.5904798878164, -932.4975527482403, -818.0949590478067, -921.0775869879665, -629.0770871388087, -1066.9079691863592, -572.9294154132076, -71.62196868610992, -665.3123464303576, -803.6365448151784, -353.52173399085956, -1168.2841930607735, -1215.2789076104816, -928.8531951110887, -1171.4065715931943, -523.7489130727206, -1145.8851034669228, -1153.5592447281394, -816.5546980343021, -383.82488183573236, -902.3095577505932, -185.82032198334312, -1071.7143248941234, -1062.1227941853099, -186.31531662932912, -839.2876727435975, -253.14519853890494, -126.9210820166543, -1145.2156465273158, -269.68932281239074, -1116.8289481778304, -1183.768837206436, -239.07394043824868, -700.8046571980593, -593.6448189337068, -955.1550177339622, -231.1486718253332, -726.8272097865789, -474.3186326693975, -869.3533225614361, -943.578785959153, -1086.6398568121397, -139.4608034635992, -600.2681144758023, -783.2823972905682, -852.735324703086, -1006.39773549701, -227.25727085604277, -101.24306299003003, -370.5844435322673, -517.2962769262052, -1011.8722162495297, -733.4935855973093, -902.7389283438347, -518.310149660721, -51.962124453833006, -1004.0302263224606, -852.7842868313764, -1349.5891970488426, -812.8118830215301, -161.33389609653392, -1110.5293756365963, -527.6622445211427, -285.1788007675986, -993.7386105634534, -930.5577173137682, -183.39585828860928, -854.8879368234794, -676.9428479899225, -136.32706610652502, -593.5110582146297, -477.4600233160595, -260.6275152531395, -1007.1473370313316, -695.3482912444691, -148.6260109721661, -206.63077453580502, -678.3403002878337, -766.3163065642033, -734.2466106704035, -754.7579336469553, -953.6533072481769, -635.2957667358313, -259.1393455853233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553846027643559, "mean_inference_ms": 1.696690397927992, "mean_action_processing_ms": 0.2807583123298561, "mean_env_wait_ms": 3.0258003837758043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011431217193603516, "StateBufferConnector_ms": 0.007811069488525391, "ViewRequirementAgentConnector_ms": 0.19354557991027832}, "num_episodes": 30, "episode_return_max": -51.962124453833006, "episode_return_min": -1349.5891970488426, "episode_return_mean": -697.8168041163694, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.18270168324875, "num_env_steps_trained_throughput_per_sec": 300.18270168324875, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13306.604, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13306.524, "sample_time_ms": 1033.354, "learn_time_ms": 12206.523, "learn_throughput": 327.694, "synch_weights_time_ms": 65.773}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00000", "date": "2024-08-03_10-18-45", "timestamp": 1722660525, "time_this_iter_s": 13.337680101394653, "time_total_s": 289.716454744339, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0e560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 289.716454744339, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 12.736842105263156, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 246.33796857595445, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.7004766253133614, "policy_loss": -0.014023313568031881, "vf_loss": 1.709514381363988, "vf_explained_var": 0.9934869773685933, "kl": 0.017079858662583547, "entropy": 1.3840139858424663, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -51.962124453833006, "episode_reward_min": -1349.5891970488426, "episode_reward_mean": -723.9909342236159, "episode_len_mean": 137.8, "episode_media": {}, "episodes_timesteps_total": 13780, "policy_reward_min": {"policy_0": -1349.5891970488426}, "policy_reward_max": {"policy_0": -51.962124453833006}, "policy_reward_mean": {"policy_0": -723.9909342236159}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1215.2789076104816, -928.8531951110887, -1171.4065715931943, -523.7489130727206, -1145.8851034669228, -1153.5592447281394, -816.5546980343021, -383.82488183573236, -902.3095577505932, -185.82032198334312, -1071.7143248941234, -1062.1227941853099, -186.31531662932912, -839.2876727435975, -253.14519853890494, -126.9210820166543, -1145.2156465273158, -269.68932281239074, -1116.8289481778304, -1183.768837206436, -239.07394043824868, -700.8046571980593, -593.6448189337068, -955.1550177339622, -231.1486718253332, -726.8272097865789, -474.3186326693975, -869.3533225614361, -943.578785959153, -1086.6398568121397, -139.4608034635992, -600.2681144758023, -783.2823972905682, -852.735324703086, -1006.39773549701, -227.25727085604277, -101.24306299003003, -370.5844435322673, -517.2962769262052, -1011.8722162495297, -733.4935855973093, -902.7389283438347, -518.310149660721, -51.962124453833006, -1004.0302263224606, -852.7842868313764, -1349.5891970488426, -812.8118830215301, -161.33389609653392, -1110.5293756365963, -527.6622445211427, -285.1788007675986, -993.7386105634534, -930.5577173137682, -183.39585828860928, -854.8879368234794, -676.9428479899225, -136.32706610652502, -593.5110582146297, -477.4600233160595, -260.6275152531395, -1007.1473370313316, -695.3482912444691, -148.6260109721661, -206.63077453580502, -678.3403002878337, -766.3163065642033, -734.2466106704035, -754.7579336469553, -953.6533072481769, -635.2957667358313, -259.1393455853233, -625.292285993278, -947.1780480741564, -853.5564019882596, -1112.9777465511008, -913.069798996972, -939.2881052213235, -655.2137558049025, -971.4570764124028, -877.7497689174911, -389.33628676612636, -928.769004742785, -934.3827949410842, -1083.574027118121, -760.3257042104701, -425.5405339821266, -529.4212064133397, -1093.7996684780594, -1121.964806629384, -850.972796425334, -1132.9355965719583, -668.1095949447275, -691.7704734515753, -1066.6896497557223, -1082.2755352381125, -690.0414258683636, -1013.961276243415, -727.6904223799521, -941.1812147266253], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 107, 150, 85, 150, 150, 120, 150, 82, 69, 150, 138, 150, 150, 94, 150, 150, 150, 95, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 99, 77, 106, 150, 150, 150, 150, 150, 46, 150, 150, 150, 150, 115, 150, 150, 96, 150, 150, 77, 150, 150, 96, 150, 150, 107, 150, 135, 77, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1215.2789076104816, -928.8531951110887, -1171.4065715931943, -523.7489130727206, -1145.8851034669228, -1153.5592447281394, -816.5546980343021, -383.82488183573236, -902.3095577505932, -185.82032198334312, -1071.7143248941234, -1062.1227941853099, -186.31531662932912, -839.2876727435975, -253.14519853890494, -126.9210820166543, -1145.2156465273158, -269.68932281239074, -1116.8289481778304, -1183.768837206436, -239.07394043824868, -700.8046571980593, -593.6448189337068, -955.1550177339622, -231.1486718253332, -726.8272097865789, -474.3186326693975, -869.3533225614361, -943.578785959153, -1086.6398568121397, -139.4608034635992, -600.2681144758023, -783.2823972905682, -852.735324703086, -1006.39773549701, -227.25727085604277, -101.24306299003003, -370.5844435322673, -517.2962769262052, -1011.8722162495297, -733.4935855973093, -902.7389283438347, -518.310149660721, -51.962124453833006, -1004.0302263224606, -852.7842868313764, -1349.5891970488426, -812.8118830215301, -161.33389609653392, -1110.5293756365963, -527.6622445211427, -285.1788007675986, -993.7386105634534, -930.5577173137682, -183.39585828860928, -854.8879368234794, -676.9428479899225, -136.32706610652502, -593.5110582146297, -477.4600233160595, -260.6275152531395, -1007.1473370313316, -695.3482912444691, -148.6260109721661, -206.63077453580502, -678.3403002878337, -766.3163065642033, -734.2466106704035, -754.7579336469553, -953.6533072481769, -635.2957667358313, -259.1393455853233, -625.292285993278, -947.1780480741564, -853.5564019882596, -1112.9777465511008, -913.069798996972, -939.2881052213235, -655.2137558049025, -971.4570764124028, -877.7497689174911, -389.33628676612636, -928.769004742785, -934.3827949410842, -1083.574027118121, -760.3257042104701, -425.5405339821266, -529.4212064133397, -1093.7996684780594, -1121.964806629384, -850.972796425334, -1132.9355965719583, -668.1095949447275, -691.7704734515753, -1066.6896497557223, -1082.2755352381125, -690.0414258683636, -1013.961276243415, -727.6904223799521, -941.1812147266253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553501102133993, "mean_inference_ms": 1.694985549606793, "mean_action_processing_ms": 0.28035421385965775, "mean_env_wait_ms": 3.0244183457011258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01140451431274414, "StateBufferConnector_ms": 0.00792074203491211, "ViewRequirementAgentConnector_ms": 0.1955099105834961}, "num_episodes": 28, "episode_return_max": -51.962124453833006, "episode_return_min": -1349.5891970488426, "episode_return_mean": -723.9909342236159, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.36094412515, "num_env_steps_trained_throughput_per_sec": 298.36094412515, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13283.373, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13283.293, "sample_time_ms": 1032.032, "learn_time_ms": 12184.728, "learn_throughput": 328.28, "synch_weights_time_ms": 65.647}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00000", "date": "2024-08-03_10-18-59", "timestamp": 1722660539, "time_this_iter_s": 13.42098069190979, "time_total_s": 303.1374354362488, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0dd80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 303.1374354362488, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 12.834999999999999, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 210.60315633614857, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.969796209720274, "policy_loss": -0.006847546092467382, "vf_loss": 1.972154074596862, "vf_explained_var": 0.988698577384154, "kl": 0.015456597110763444, "entropy": 1.4729963675141335, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -51.962124453833006, "episode_reward_min": -1349.5891970488426, "episode_reward_mean": -729.1838482806156, "episode_len_mean": 139.94, "episode_media": {}, "episodes_timesteps_total": 13994, "policy_reward_min": {"policy_0": -1349.5891970488426}, "policy_reward_max": {"policy_0": -51.962124453833006}, "policy_reward_mean": {"policy_0": -729.1838482806156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-600.2681144758023, -783.2823972905682, -852.735324703086, -1006.39773549701, -227.25727085604277, -101.24306299003003, -370.5844435322673, -517.2962769262052, -1011.8722162495297, -733.4935855973093, -902.7389283438347, -518.310149660721, -51.962124453833006, -1004.0302263224606, -852.7842868313764, -1349.5891970488426, -812.8118830215301, -161.33389609653392, -1110.5293756365963, -527.6622445211427, -285.1788007675986, -993.7386105634534, -930.5577173137682, -183.39585828860928, -854.8879368234794, -676.9428479899225, -136.32706610652502, -593.5110582146297, -477.4600233160595, -260.6275152531395, -1007.1473370313316, -695.3482912444691, -148.6260109721661, -206.63077453580502, -678.3403002878337, -766.3163065642033, -734.2466106704035, -754.7579336469553, -953.6533072481769, -635.2957667358313, -259.1393455853233, -625.292285993278, -947.1780480741564, -853.5564019882596, -1112.9777465511008, -913.069798996972, -939.2881052213235, -655.2137558049025, -971.4570764124028, -877.7497689174911, -389.33628676612636, -928.769004742785, -934.3827949410842, -1083.574027118121, -760.3257042104701, -425.5405339821266, -529.4212064133397, -1093.7996684780594, -1121.964806629384, -850.972796425334, -1132.9355965719583, -668.1095949447275, -691.7704734515753, -1066.6896497557223, -1082.2755352381125, -690.0414258683636, -1013.961276243415, -727.6904223799521, -941.1812147266253, -1099.9535523120794, -1098.3320637943175, -337.9640745703337, -949.4847537502886, -213.7169066980034, -397.8167844857761, -447.16588862499077, -808.7960384090584, -603.9491947606839, -805.8597429987303, -984.795572814467, -921.3152674425636, -233.11554015425276, -833.3077956376524, -1024.8666641227728, -767.7059997864814, -832.0130430844076, -713.4444448940299, -819.393975423803, -638.2845700023563, -948.1305098908948, -118.03370370319742, -802.1999002635031, -745.8697925442602, -1046.538420312885, -921.4888582076666, -904.8243428955876, -233.49160171181208, -987.2753362168986, -780.6507680692831, -1141.762554416952], "episode_lengths": [150, 150, 150, 150, 99, 77, 106, 150, 150, 150, 150, 150, 46, 150, 150, 150, 150, 115, 150, 150, 96, 150, 150, 77, 150, 150, 96, 150, 150, 107, 150, 135, 77, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 96, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 88, 150, 150, 150], "policy_policy_0_reward": [-600.2681144758023, -783.2823972905682, -852.735324703086, -1006.39773549701, -227.25727085604277, -101.24306299003003, -370.5844435322673, -517.2962769262052, -1011.8722162495297, -733.4935855973093, -902.7389283438347, -518.310149660721, -51.962124453833006, -1004.0302263224606, -852.7842868313764, -1349.5891970488426, -812.8118830215301, -161.33389609653392, -1110.5293756365963, -527.6622445211427, -285.1788007675986, -993.7386105634534, -930.5577173137682, -183.39585828860928, -854.8879368234794, -676.9428479899225, -136.32706610652502, -593.5110582146297, -477.4600233160595, -260.6275152531395, -1007.1473370313316, -695.3482912444691, -148.6260109721661, -206.63077453580502, -678.3403002878337, -766.3163065642033, -734.2466106704035, -754.7579336469553, -953.6533072481769, -635.2957667358313, -259.1393455853233, -625.292285993278, -947.1780480741564, -853.5564019882596, -1112.9777465511008, -913.069798996972, -939.2881052213235, -655.2137558049025, -971.4570764124028, -877.7497689174911, -389.33628676612636, -928.769004742785, -934.3827949410842, -1083.574027118121, -760.3257042104701, -425.5405339821266, -529.4212064133397, -1093.7996684780594, -1121.964806629384, -850.972796425334, -1132.9355965719583, -668.1095949447275, -691.7704734515753, -1066.6896497557223, -1082.2755352381125, -690.0414258683636, -1013.961276243415, -727.6904223799521, -941.1812147266253, -1099.9535523120794, -1098.3320637943175, -337.9640745703337, -949.4847537502886, -213.7169066980034, -397.8167844857761, -447.16588862499077, -808.7960384090584, -603.9491947606839, -805.8597429987303, -984.795572814467, -921.3152674425636, -233.11554015425276, -833.3077956376524, -1024.8666641227728, -767.7059997864814, -832.0130430844076, -713.4444448940299, -819.393975423803, -638.2845700023563, -948.1305098908948, -118.03370370319742, -802.1999002635031, -745.8697925442602, -1046.538420312885, -921.4888582076666, -904.8243428955876, -233.49160171181208, -987.2753362168986, -780.6507680692831, -1141.762554416952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532594627477975, "mean_inference_ms": 1.6940561138118972, "mean_action_processing_ms": 0.2802558260607056, "mean_env_wait_ms": 3.023510315650234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011468172073364258, "StateBufferConnector_ms": 0.007967472076416016, "ViewRequirementAgentConnector_ms": 0.19886326789855957}, "num_episodes": 31, "episode_return_max": -51.962124453833006, "episode_return_min": -1349.5891970488426, "episode_return_mean": -729.1838482806156, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.86699372071837, "num_env_steps_trained_throughput_per_sec": 301.86699372071837, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13265.075, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13264.994, "sample_time_ms": 1029.744, "learn_time_ms": 12168.654, "learn_throughput": 328.713, "synch_weights_time_ms": 65.711}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00000", "date": "2024-08-03_10-19-12", "timestamp": 1722660552, "time_this_iter_s": 13.26386570930481, "time_total_s": 316.4013011455536, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0fb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 316.4013011455536, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.005555555555558, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 211.67356499433518, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.1947112594420712, "policy_loss": -0.010942562127214235, "vf_loss": 2.201424191147089, "vf_explained_var": 0.9921210177242756, "kl": 0.01461857845806664, "entropy": 1.5594440391908089, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -39.052011978589306, "episode_reward_min": -1141.762554416952, "episode_reward_mean": -735.0841208753263, "episode_len_mean": 139.4, "episode_media": {}, "episodes_timesteps_total": 13940, "policy_reward_min": {"policy_0": -1141.762554416952}, "policy_reward_max": {"policy_0": -39.052011978589306}, "policy_reward_mean": {"policy_0": -735.0841208753263}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-477.4600233160595, -260.6275152531395, -1007.1473370313316, -695.3482912444691, -148.6260109721661, -206.63077453580502, -678.3403002878337, -766.3163065642033, -734.2466106704035, -754.7579336469553, -953.6533072481769, -635.2957667358313, -259.1393455853233, -625.292285993278, -947.1780480741564, -853.5564019882596, -1112.9777465511008, -913.069798996972, -939.2881052213235, -655.2137558049025, -971.4570764124028, -877.7497689174911, -389.33628676612636, -928.769004742785, -934.3827949410842, -1083.574027118121, -760.3257042104701, -425.5405339821266, -529.4212064133397, -1093.7996684780594, -1121.964806629384, -850.972796425334, -1132.9355965719583, -668.1095949447275, -691.7704734515753, -1066.6896497557223, -1082.2755352381125, -690.0414258683636, -1013.961276243415, -727.6904223799521, -941.1812147266253, -1099.9535523120794, -1098.3320637943175, -337.9640745703337, -949.4847537502886, -213.7169066980034, -397.8167844857761, -447.16588862499077, -808.7960384090584, -603.9491947606839, -805.8597429987303, -984.795572814467, -921.3152674425636, -233.11554015425276, -833.3077956376524, -1024.8666641227728, -767.7059997864814, -832.0130430844076, -713.4444448940299, -819.393975423803, -638.2845700023563, -948.1305098908948, -118.03370370319742, -802.1999002635031, -745.8697925442602, -1046.538420312885, -921.4888582076666, -904.8243428955876, -233.49160171181208, -987.2753362168986, -780.6507680692831, -1141.762554416952, -837.7537870314362, -400.0126616430198, -645.615634347771, -693.0135808267113, -948.0118309278254, -172.72396634341774, -612.3496260003328, -537.6313942660156, -1002.0879259770121, -1056.9510009990329, -565.5737877944074, -39.052011978589306, -1096.4618825665432, -1131.683643798385, -76.1834381380819, -158.94537047963013, -474.54361270260085, -760.4768941548225, -92.09809815882971, -882.1882974500926, -1108.4060542619231, -260.9258209416657, -1127.6470210725136, -871.6325703007833, -773.748268629544, -937.964910347021, -1114.765887494979, -362.3009169607846], "episode_lengths": [150, 107, 150, 135, 77, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 96, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 41, 150, 150, 64, 83, 119, 150, 81, 150, 150, 78, 150, 150, 150, 150, 150, 106], "policy_policy_0_reward": [-477.4600233160595, -260.6275152531395, -1007.1473370313316, -695.3482912444691, -148.6260109721661, -206.63077453580502, -678.3403002878337, -766.3163065642033, -734.2466106704035, -754.7579336469553, -953.6533072481769, -635.2957667358313, -259.1393455853233, -625.292285993278, -947.1780480741564, -853.5564019882596, -1112.9777465511008, -913.069798996972, -939.2881052213235, -655.2137558049025, -971.4570764124028, -877.7497689174911, -389.33628676612636, -928.769004742785, -934.3827949410842, -1083.574027118121, -760.3257042104701, -425.5405339821266, -529.4212064133397, -1093.7996684780594, -1121.964806629384, -850.972796425334, -1132.9355965719583, -668.1095949447275, -691.7704734515753, -1066.6896497557223, -1082.2755352381125, -690.0414258683636, -1013.961276243415, -727.6904223799521, -941.1812147266253, -1099.9535523120794, -1098.3320637943175, -337.9640745703337, -949.4847537502886, -213.7169066980034, -397.8167844857761, -447.16588862499077, -808.7960384090584, -603.9491947606839, -805.8597429987303, -984.795572814467, -921.3152674425636, -233.11554015425276, -833.3077956376524, -1024.8666641227728, -767.7059997864814, -832.0130430844076, -713.4444448940299, -819.393975423803, -638.2845700023563, -948.1305098908948, -118.03370370319742, -802.1999002635031, -745.8697925442602, -1046.538420312885, -921.4888582076666, -904.8243428955876, -233.49160171181208, -987.2753362168986, -780.6507680692831, -1141.762554416952, -837.7537870314362, -400.0126616430198, -645.615634347771, -693.0135808267113, -948.0118309278254, -172.72396634341774, -612.3496260003328, -537.6313942660156, -1002.0879259770121, -1056.9510009990329, -565.5737877944074, -39.052011978589306, -1096.4618825665432, -1131.683643798385, -76.1834381380819, -158.94537047963013, -474.54361270260085, -760.4768941548225, -92.09809815882971, -882.1882974500926, -1108.4060542619231, -260.9258209416657, -1127.6470210725136, -871.6325703007833, -773.748268629544, -937.964910347021, -1114.765887494979, -362.3009169607846]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534656301173818, "mean_inference_ms": 1.6943701417959993, "mean_action_processing_ms": 0.2802504959754361, "mean_env_wait_ms": 3.0252385751544786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011333465576171875, "StateBufferConnector_ms": 0.007835865020751953, "ViewRequirementAgentConnector_ms": 0.1948552131652832}, "num_episodes": 28, "episode_return_max": -39.052011978589306, "episode_return_min": -1141.762554416952, "episode_return_mean": -735.0841208753263, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.28585069213227, "num_env_steps_trained_throughput_per_sec": 312.28585069213227, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13241.775, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13241.694, "sample_time_ms": 1028.67, "learn_time_ms": 12147.787, "learn_throughput": 329.278, "synch_weights_time_ms": 64.367}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00000", "date": "2024-08-03_10-19-25", "timestamp": 1722660565, "time_this_iter_s": 12.820057153701782, "time_total_s": 329.22135829925537, "pid": 504959, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0c5e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 329.22135829925537, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 12.91578947368421, "ram_util_percent": 27.5}}
