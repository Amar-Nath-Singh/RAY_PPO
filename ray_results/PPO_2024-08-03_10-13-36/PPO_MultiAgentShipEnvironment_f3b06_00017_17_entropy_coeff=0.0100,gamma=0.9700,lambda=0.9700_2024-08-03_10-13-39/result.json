{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8345306299316386, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.75156602859497, "policy_loss": -0.007452959217092333, "vf_loss": 9.771178290247917, "vf_explained_var": 0.005210191942751408, "kl": 0.010699574197193822, "entropy": 1.4299200087785722, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -74.08311847491004, "episode_reward_min": -1264.8669227614273, "episode_reward_mean": -740.2019337965642, "episode_len_mean": 137.17391304347825, "episode_media": {}, "episodes_timesteps_total": 3155, "policy_reward_min": {"policy_0": -1264.8669227614273}, "policy_reward_max": {"policy_0": -74.08311847491004}, "policy_reward_mean": {"policy_0": -740.2019337965642}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-454.5644365299602, -967.5305766616611, -511.74391365038747, -899.0790619191202, -1004.8931192888169, -785.1192135559611, -498.85853753892786, -1025.405505488924, -672.4995353212731, -848.1497128147888, -598.2523003629748, -1027.3139668410904, -539.1554980800541, -1264.8669227614273, -890.2344754475145, -1145.0801751322388, -74.59035990327394, -1008.4165672191905, -194.3311095405688, -821.3352853044522, -683.3023812836587, -1035.8387041997998, -74.08311847491004], "episode_lengths": [150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 143, 150, 150, 150, 56, 150, 63, 150, 150, 150, 67], "policy_policy_0_reward": [-454.5644365299602, -967.5305766616611, -511.74391365038747, -899.0790619191202, -1004.8931192888169, -785.1192135559611, -498.85853753892786, -1025.405505488924, -672.4995353212731, -848.1497128147888, -598.2523003629748, -1027.3139668410904, -539.1554980800541, -1264.8669227614273, -890.2344754475145, -1145.0801751322388, -74.59035990327394, -1008.4165672191905, -194.3311095405688, -821.3352853044522, -683.3023812836587, -1035.8387041997998, -74.08311847491004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556954790797437, "mean_inference_ms": 1.6455634479273513, "mean_action_processing_ms": 0.2776250449784045, "mean_env_wait_ms": 2.9423450274701337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010769263557765795, "StateBufferConnector_ms": 0.007742384205693784, "ViewRequirementAgentConnector_ms": 0.17425081004267154}, "num_episodes": 23, "episode_return_max": -74.08311847491004, "episode_return_min": -1264.8669227614273, "episode_return_mean": -740.2019337965642, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.82300509046775, "num_env_steps_trained_throughput_per_sec": 306.82300509046775, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13036.843, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13036.766, "sample_time_ms": 1012.54, "learn_time_ms": 11964.664, "learn_throughput": 334.318, "synch_weights_time_ms": 58.84}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00017", "date": "2024-08-03_11-50-49", "timestamp": 1722666049, "time_this_iter_s": 13.048149824142456, "time_total_s": 13.048149824142456, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433dd80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.048149824142456, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 13.336842105263157, "ram_util_percent": 27.694736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.428742751510193, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.460314036409061, "policy_loss": -0.005135071303811856, "vf_loss": 9.477911932269732, "vf_explained_var": 0.0908859172835946, "kl": 0.009668135866832017, "entropy": 1.439648625254631, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -3.507804302741524, "episode_reward_min": -1264.8669227614273, "episode_reward_mean": -641.42921077586, "episode_len_mean": 128.0625, "episode_media": {}, "episodes_timesteps_total": 6147, "policy_reward_min": {"policy_0": -1264.8669227614273}, "policy_reward_max": {"policy_0": -3.507804302741524}, "policy_reward_mean": {"policy_0": -641.42921077586}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-454.5644365299602, -967.5305766616611, -511.74391365038747, -899.0790619191202, -1004.8931192888169, -785.1192135559611, -498.85853753892786, -1025.405505488924, -672.4995353212731, -848.1497128147888, -598.2523003629748, -1027.3139668410904, -539.1554980800541, -1264.8669227614273, -890.2344754475145, -1145.0801751322388, -74.59035990327394, -1008.4165672191905, -194.3311095405688, -821.3352853044522, -683.3023812836587, -1035.8387041997998, -74.08311847491004, -307.4705060230339, -1056.5443364621083, -151.4916042764702, -333.0235147890073, -980.4714140823619, -776.2453646853008, -940.1567749606081, -188.88899668972346, -970.5904841561778, -141.86957277490953, -1160.758202413166, -108.4090274793799, -244.5327361998514, -833.4756707986952, -514.0154909783104, -3.507804302741524, -1044.0758782755047, -412.59288123787036, -655.255376177792, -908.2186606720938, -180.60237105818865, -84.00372644685582, -374.0344658272624, -731.2249968325096, -662.4977823203826], "episode_lengths": [150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 143, 150, 150, 150, 56, 150, 63, 150, 150, 150, 67, 91, 150, 57, 122, 150, 150, 150, 95, 150, 73, 150, 81, 97, 150, 150, 53, 150, 150, 132, 150, 93, 59, 96, 150, 143], "policy_policy_0_reward": [-454.5644365299602, -967.5305766616611, -511.74391365038747, -899.0790619191202, -1004.8931192888169, -785.1192135559611, -498.85853753892786, -1025.405505488924, -672.4995353212731, -848.1497128147888, -598.2523003629748, -1027.3139668410904, -539.1554980800541, -1264.8669227614273, -890.2344754475145, -1145.0801751322388, -74.59035990327394, -1008.4165672191905, -194.3311095405688, -821.3352853044522, -683.3023812836587, -1035.8387041997998, -74.08311847491004, -307.4705060230339, -1056.5443364621083, -151.4916042764702, -333.0235147890073, -980.4714140823619, -776.2453646853008, -940.1567749606081, -188.88899668972346, -970.5904841561778, -141.86957277490953, -1160.758202413166, -108.4090274793799, -244.5327361998514, -833.4756707986952, -514.0154909783104, -3.507804302741524, -1044.0758782755047, -412.59288123787036, -655.255376177792, -908.2186606720938, -180.60237105818865, -84.00372644685582, -374.0344658272624, -731.2249968325096, -662.4977823203826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555794989335422, "mean_inference_ms": 1.654525093714998, "mean_action_processing_ms": 0.27884027139439144, "mean_env_wait_ms": 2.944396009494619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013466676076253256, "StateBufferConnector_ms": 0.008248289426167807, "ViewRequirementAgentConnector_ms": 0.18451611200968424}, "num_episodes": 25, "episode_return_max": -3.507804302741524, "episode_return_min": -1264.8669227614273, "episode_return_mean": -641.42921077586, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.55582066105103, "num_env_steps_trained_throughput_per_sec": 297.55582066105103, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13239.855, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13239.786, "sample_time_ms": 1011.515, "learn_time_ms": 12165.947, "learn_throughput": 328.787, "synch_weights_time_ms": 61.602}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00017", "date": "2024-08-03_11-51-03", "timestamp": 1722666063, "time_this_iter_s": 13.456537008285522, "time_total_s": 26.50468683242798, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b7490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.50468683242798, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.684210526315786, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8876945368324718, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.45426263064146, "policy_loss": -0.007239225952556202, "vf_loss": 9.473943708340327, "vf_explained_var": 0.14170194522788127, "kl": 0.00852649849257432, "entropy": 1.4147164842734734, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -3.507804302741524, "episode_reward_min": -1264.8669227614273, "episode_reward_mean": -673.3876148281711, "episode_len_mean": 130.87179487179486, "episode_media": {}, "episodes_timesteps_total": 10208, "policy_reward_min": {"policy_0": -1264.8669227614273}, "policy_reward_max": {"policy_0": -3.507804302741524}, "policy_reward_mean": {"policy_0": -673.3876148281711}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-454.5644365299602, -967.5305766616611, -511.74391365038747, -899.0790619191202, -1004.8931192888169, -785.1192135559611, -498.85853753892786, -1025.405505488924, -672.4995353212731, -848.1497128147888, -598.2523003629748, -1027.3139668410904, -539.1554980800541, -1264.8669227614273, -890.2344754475145, -1145.0801751322388, -74.59035990327394, -1008.4165672191905, -194.3311095405688, -821.3352853044522, -683.3023812836587, -1035.8387041997998, -74.08311847491004, -307.4705060230339, -1056.5443364621083, -151.4916042764702, -333.0235147890073, -980.4714140823619, -776.2453646853008, -940.1567749606081, -188.88899668972346, -970.5904841561778, -141.86957277490953, -1160.758202413166, -108.4090274793799, -244.5327361998514, -833.4756707986952, -514.0154909783104, -3.507804302741524, -1044.0758782755047, -412.59288123787036, -655.255376177792, -908.2186606720938, -180.60237105818865, -84.00372644685582, -374.0344658272624, -731.2249968325096, -662.4977823203826, -1101.011143139181, -1136.9613078638265, -794.1510576841954, -602.7734724051345, -874.5387871112264, -781.6314461594008, -775.7390111691119, -867.9868264012393, -307.55518086126665, -385.2312716822106, -17.902338831407356, -629.2061948309745, -1049.8035077054653, -800.2049631828763, -1080.4255051255523, -375.08353298034103, -955.4058610186278, -941.7657377273175, -664.1610779964742, -773.5379851109017, -980.5991239961327, -91.07944727231933, -151.26145313167987, -915.4109593637116, -18.669177396788303, -832.5901068158474, -870.6781117793922, -1130.536869760663, -1033.1047545497645, -796.6256263030301], "episode_lengths": [150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 143, 150, 150, 150, 56, 150, 63, 150, 150, 150, 67, 91, 150, 57, 122, 150, 150, 150, 95, 150, 73, 150, 81, 97, 150, 150, 53, 150, 150, 132, 150, 93, 59, 96, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 49, 134, 150, 150, 150, 94, 150, 150, 150, 150, 150, 76, 99, 150, 60, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-454.5644365299602, -967.5305766616611, -511.74391365038747, -899.0790619191202, -1004.8931192888169, -785.1192135559611, -498.85853753892786, -1025.405505488924, -672.4995353212731, -848.1497128147888, -598.2523003629748, -1027.3139668410904, -539.1554980800541, -1264.8669227614273, -890.2344754475145, -1145.0801751322388, -74.59035990327394, -1008.4165672191905, -194.3311095405688, -821.3352853044522, -683.3023812836587, -1035.8387041997998, -74.08311847491004, -307.4705060230339, -1056.5443364621083, -151.4916042764702, -333.0235147890073, -980.4714140823619, -776.2453646853008, -940.1567749606081, -188.88899668972346, -970.5904841561778, -141.86957277490953, -1160.758202413166, -108.4090274793799, -244.5327361998514, -833.4756707986952, -514.0154909783104, -3.507804302741524, -1044.0758782755047, -412.59288123787036, -655.255376177792, -908.2186606720938, -180.60237105818865, -84.00372644685582, -374.0344658272624, -731.2249968325096, -662.4977823203826, -1101.011143139181, -1136.9613078638265, -794.1510576841954, -602.7734724051345, -874.5387871112264, -781.6314461594008, -775.7390111691119, -867.9868264012393, -307.55518086126665, -385.2312716822106, -17.902338831407356, -629.2061948309745, -1049.8035077054653, -800.2049631828763, -1080.4255051255523, -375.08353298034103, -955.4058610186278, -941.7657377273175, -664.1610779964742, -773.5379851109017, -980.5991239961327, -91.07944727231933, -151.26145313167987, -915.4109593637116, -18.669177396788303, -832.5901068158474, -870.6781117793922, -1130.536869760663, -1033.1047545497645, -796.6256263030301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550111398163521, "mean_inference_ms": 1.6559080125024979, "mean_action_processing_ms": 0.2791620058095921, "mean_env_wait_ms": 2.94252981897779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013120357806865986, "StateBufferConnector_ms": 0.008381941379644932, "ViewRequirementAgentConnector_ms": 0.18948836204333183}, "num_episodes": 30, "episode_return_max": -3.507804302741524, "episode_return_min": -1264.8669227614273, "episode_return_mean": -673.3876148281711, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.221717037468, "num_env_steps_trained_throughput_per_sec": 298.221717037468, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13297.52, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13297.454, "sample_time_ms": 1007.538, "learn_time_ms": 12228.657, "learn_throughput": 327.101, "synch_weights_time_ms": 60.54}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00017", "date": "2024-08-03_11-51-16", "timestamp": 1722666076, "time_this_iter_s": 13.425299644470215, "time_total_s": 39.92998647689819, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b4d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.92998647689819, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.468421052631578, "ram_util_percent": 27.789473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6115685988528035, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.55241834918658, "policy_loss": -0.009461109837866388, "vf_loss": 9.573853572209677, "vf_explained_var": 0.2095814121887088, "kl": 0.011844594377998875, "entropy": 1.4343014135956764, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -3.507804302741524, "episode_reward_min": -1264.8669227614273, "episode_reward_mean": -678.8586320283198, "episode_len_mean": 133.99, "episode_media": {}, "episodes_timesteps_total": 13399, "policy_reward_min": {"policy_0": -1264.8669227614273}, "policy_reward_max": {"policy_0": -3.507804302741524}, "policy_reward_mean": {"policy_0": -678.8586320283198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-498.85853753892786, -1025.405505488924, -672.4995353212731, -848.1497128147888, -598.2523003629748, -1027.3139668410904, -539.1554980800541, -1264.8669227614273, -890.2344754475145, -1145.0801751322388, -74.59035990327394, -1008.4165672191905, -194.3311095405688, -821.3352853044522, -683.3023812836587, -1035.8387041997998, -74.08311847491004, -307.4705060230339, -1056.5443364621083, -151.4916042764702, -333.0235147890073, -980.4714140823619, -776.2453646853008, -940.1567749606081, -188.88899668972346, -970.5904841561778, -141.86957277490953, -1160.758202413166, -108.4090274793799, -244.5327361998514, -833.4756707986952, -514.0154909783104, -3.507804302741524, -1044.0758782755047, -412.59288123787036, -655.255376177792, -908.2186606720938, -180.60237105818865, -84.00372644685582, -374.0344658272624, -731.2249968325096, -662.4977823203826, -1101.011143139181, -1136.9613078638265, -794.1510576841954, -602.7734724051345, -874.5387871112264, -781.6314461594008, -775.7390111691119, -867.9868264012393, -307.55518086126665, -385.2312716822106, -17.902338831407356, -629.2061948309745, -1049.8035077054653, -800.2049631828763, -1080.4255051255523, -375.08353298034103, -955.4058610186278, -941.7657377273175, -664.1610779964742, -773.5379851109017, -980.5991239961327, -91.07944727231933, -151.26145313167987, -915.4109593637116, -18.669177396788303, -832.5901068158474, -870.6781117793922, -1130.536869760663, -1033.1047545497645, -796.6256263030301, -410.70377221721907, -804.118201853655, -984.494388082437, -409.5092176843382, -884.5293553172562, -232.81131263799102, -554.9891203998976, -234.7037276081055, -642.6880054955681, -957.3385941575843, -953.936433127015, -797.0234921380601, -1014.8278664773081, -537.3932263027616, -929.8231423811881, -803.8014407421715, -682.0234479935086, -470.4632719801162, -742.313341587979, -1124.7310578723411, -603.7494525079629, -604.2887249213456, -865.8629384833482, -999.6479596054766, -515.8128296600711, -465.3251340446193, -1152.133019747378, -605.5170928138535], "episode_lengths": [126, 150, 150, 150, 150, 150, 143, 150, 150, 150, 56, 150, 63, 150, 150, 150, 67, 91, 150, 57, 122, 150, 150, 150, 95, 150, 73, 150, 81, 97, 150, 150, 53, 150, 150, 132, 150, 93, 59, 96, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 49, 134, 150, 150, 150, 94, 150, 150, 150, 150, 150, 76, 99, 150, 60, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 79, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-498.85853753892786, -1025.405505488924, -672.4995353212731, -848.1497128147888, -598.2523003629748, -1027.3139668410904, -539.1554980800541, -1264.8669227614273, -890.2344754475145, -1145.0801751322388, -74.59035990327394, -1008.4165672191905, -194.3311095405688, -821.3352853044522, -683.3023812836587, -1035.8387041997998, -74.08311847491004, -307.4705060230339, -1056.5443364621083, -151.4916042764702, -333.0235147890073, -980.4714140823619, -776.2453646853008, -940.1567749606081, -188.88899668972346, -970.5904841561778, -141.86957277490953, -1160.758202413166, -108.4090274793799, -244.5327361998514, -833.4756707986952, -514.0154909783104, -3.507804302741524, -1044.0758782755047, -412.59288123787036, -655.255376177792, -908.2186606720938, -180.60237105818865, -84.00372644685582, -374.0344658272624, -731.2249968325096, -662.4977823203826, -1101.011143139181, -1136.9613078638265, -794.1510576841954, -602.7734724051345, -874.5387871112264, -781.6314461594008, -775.7390111691119, -867.9868264012393, -307.55518086126665, -385.2312716822106, -17.902338831407356, -629.2061948309745, -1049.8035077054653, -800.2049631828763, -1080.4255051255523, -375.08353298034103, -955.4058610186278, -941.7657377273175, -664.1610779964742, -773.5379851109017, -980.5991239961327, -91.07944727231933, -151.26145313167987, -915.4109593637116, -18.669177396788303, -832.5901068158474, -870.6781117793922, -1130.536869760663, -1033.1047545497645, -796.6256263030301, -410.70377221721907, -804.118201853655, -984.494388082437, -409.5092176843382, -884.5293553172562, -232.81131263799102, -554.9891203998976, -234.7037276081055, -642.6880054955681, -957.3385941575843, -953.936433127015, -797.0234921380601, -1014.8278664773081, -537.3932263027616, -929.8231423811881, -803.8014407421715, -682.0234479935086, -470.4632719801162, -742.313341587979, -1124.7310578723411, -603.7494525079629, -604.2887249213456, -865.8629384833482, -999.6479596054766, -515.8128296600711, -465.3251340446193, -1152.133019747378, -605.5170928138535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5535452388794253, "mean_inference_ms": 1.657168141808856, "mean_action_processing_ms": 0.27937864368072185, "mean_env_wait_ms": 2.9410870130566233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01335287094116211, "StateBufferConnector_ms": 0.008458137512207031, "ViewRequirementAgentConnector_ms": 0.192030668258667}, "num_episodes": 28, "episode_return_max": -3.507804302741524, "episode_return_min": -1264.8669227614273, "episode_return_mean": -678.8586320283198, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.87715413879175, "num_env_steps_trained_throughput_per_sec": 303.87715413879175, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13263.947, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13263.88, "sample_time_ms": 1006.893, "learn_time_ms": 12195.848, "learn_throughput": 327.98, "synch_weights_time_ms": 60.373}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00017", "date": "2024-08-03_11-51-29", "timestamp": 1722666089, "time_this_iter_s": 13.176996946334839, "time_total_s": 53.10698342323303, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2443b8550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 53.10698342323303, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.81578947368421, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.739402376146366, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.292859772841135, "policy_loss": -0.010608341259649023, "vf_loss": 9.315598017970721, "vf_explained_var": 0.18421974536031485, "kl": 0.015712859282363448, "entropy": 1.5272491895904143, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -3.507804302741524, "episode_reward_min": -1152.133019747378, "episode_reward_mean": -674.4628355530854, "episode_len_mean": 136.91, "episode_media": {}, "episodes_timesteps_total": 13691, "policy_reward_min": {"policy_0": -1152.133019747378}, "policy_reward_max": {"policy_0": -3.507804302741524}, "policy_reward_mean": {"policy_0": -674.4628355530854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-833.4756707986952, -514.0154909783104, -3.507804302741524, -1044.0758782755047, -412.59288123787036, -655.255376177792, -908.2186606720938, -180.60237105818865, -84.00372644685582, -374.0344658272624, -731.2249968325096, -662.4977823203826, -1101.011143139181, -1136.9613078638265, -794.1510576841954, -602.7734724051345, -874.5387871112264, -781.6314461594008, -775.7390111691119, -867.9868264012393, -307.55518086126665, -385.2312716822106, -17.902338831407356, -629.2061948309745, -1049.8035077054653, -800.2049631828763, -1080.4255051255523, -375.08353298034103, -955.4058610186278, -941.7657377273175, -664.1610779964742, -773.5379851109017, -980.5991239961327, -91.07944727231933, -151.26145313167987, -915.4109593637116, -18.669177396788303, -832.5901068158474, -870.6781117793922, -1130.536869760663, -1033.1047545497645, -796.6256263030301, -410.70377221721907, -804.118201853655, -984.494388082437, -409.5092176843382, -884.5293553172562, -232.81131263799102, -554.9891203998976, -234.7037276081055, -642.6880054955681, -957.3385941575843, -953.936433127015, -797.0234921380601, -1014.8278664773081, -537.3932263027616, -929.8231423811881, -803.8014407421715, -682.0234479935086, -470.4632719801162, -742.313341587979, -1124.7310578723411, -603.7494525079629, -604.2887249213456, -865.8629384833482, -999.6479596054766, -515.8128296600711, -465.3251340446193, -1152.133019747378, -605.5170928138535, -42.749006407931745, -698.9938378938247, -174.5407357426774, -838.0889116915083, -522.8116748407645, -305.03858728344727, -394.12235841661175, -478.1199801048314, -353.47249895088476, -993.1812345388613, -167.75124878069892, -1130.7961658320662, -636.7282804768021, -203.49002378947756, -1113.9735145706295, -733.3509546684941, -833.9531172059548, -666.09030974258, -589.4711644018057, -683.1397971313316, -1139.364548109192, -673.2427317566687, -964.9332608651579, -158.82283275102628, -1038.8609144791026, -432.10145143185264, -763.8196414378762, -717.1184393877313, -1008.0655555455762, -866.3942649483294], "episode_lengths": [150, 150, 53, 150, 150, 132, 150, 93, 59, 96, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 49, 134, 150, 150, 150, 94, 150, 150, 150, 150, 150, 76, 99, 150, 60, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 79, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 67, 150, 150, 150, 150, 150, 93, 150, 110, 150, 150, 99, 150, 150, 150, 150, 132, 150, 150, 150, 150, 66, 150, 143, 150, 150, 150, 150], "policy_policy_0_reward": [-833.4756707986952, -514.0154909783104, -3.507804302741524, -1044.0758782755047, -412.59288123787036, -655.255376177792, -908.2186606720938, -180.60237105818865, -84.00372644685582, -374.0344658272624, -731.2249968325096, -662.4977823203826, -1101.011143139181, -1136.9613078638265, -794.1510576841954, -602.7734724051345, -874.5387871112264, -781.6314461594008, -775.7390111691119, -867.9868264012393, -307.55518086126665, -385.2312716822106, -17.902338831407356, -629.2061948309745, -1049.8035077054653, -800.2049631828763, -1080.4255051255523, -375.08353298034103, -955.4058610186278, -941.7657377273175, -664.1610779964742, -773.5379851109017, -980.5991239961327, -91.07944727231933, -151.26145313167987, -915.4109593637116, -18.669177396788303, -832.5901068158474, -870.6781117793922, -1130.536869760663, -1033.1047545497645, -796.6256263030301, -410.70377221721907, -804.118201853655, -984.494388082437, -409.5092176843382, -884.5293553172562, -232.81131263799102, -554.9891203998976, -234.7037276081055, -642.6880054955681, -957.3385941575843, -953.936433127015, -797.0234921380601, -1014.8278664773081, -537.3932263027616, -929.8231423811881, -803.8014407421715, -682.0234479935086, -470.4632719801162, -742.313341587979, -1124.7310578723411, -603.7494525079629, -604.2887249213456, -865.8629384833482, -999.6479596054766, -515.8128296600711, -465.3251340446193, -1152.133019747378, -605.5170928138535, -42.749006407931745, -698.9938378938247, -174.5407357426774, -838.0889116915083, -522.8116748407645, -305.03858728344727, -394.12235841661175, -478.1199801048314, -353.47249895088476, -993.1812345388613, -167.75124878069892, -1130.7961658320662, -636.7282804768021, -203.49002378947756, -1113.9735145706295, -733.3509546684941, -833.9531172059548, -666.09030974258, -589.4711644018057, -683.1397971313316, -1139.364548109192, -673.2427317566687, -964.9332608651579, -158.82283275102628, -1038.8609144791026, -432.10145143185264, -763.8196414378762, -717.1184393877313, -1008.0655555455762, -866.3942649483294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5512508333729906, "mean_inference_ms": 1.6610103037512145, "mean_action_processing_ms": 0.2799985286264667, "mean_env_wait_ms": 2.940957023070661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013222217559814453, "StateBufferConnector_ms": 0.008622169494628906, "ViewRequirementAgentConnector_ms": 0.19419193267822266}, "num_episodes": 30, "episode_return_max": -3.507804302741524, "episode_return_min": -1152.133019747378, "episode_return_mean": -674.4628355530854, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.3740261375215, "num_env_steps_trained_throughput_per_sec": 292.3740261375215, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13347.381, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13347.313, "sample_time_ms": 1009.458, "learn_time_ms": 12274.366, "learn_throughput": 325.882, "synch_weights_time_ms": 62.716}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00017", "date": "2024-08-03_11-51-43", "timestamp": 1722666103, "time_this_iter_s": 13.696171522140503, "time_total_s": 66.80315494537354, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433e0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 66.80315494537354, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.500000000000004, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.078606790614625, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.479052313168843, "policy_loss": -0.014684551619090295, "vf_loss": 9.505920971433321, "vf_explained_var": 0.2624084906031688, "kl": 0.017030865592096232, "entropy": 1.5590304791927339, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -18.669177396788303, "episode_reward_min": -1239.9902655941237, "episode_reward_mean": -688.9583460730548, "episode_len_mean": 139.05, "episode_media": {}, "episodes_timesteps_total": 13905, "policy_reward_min": {"policy_0": -1239.9902655941237}, "policy_reward_max": {"policy_0": -18.669177396788303}, "policy_reward_mean": {"policy_0": -688.9583460730548}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-941.7657377273175, -664.1610779964742, -773.5379851109017, -980.5991239961327, -91.07944727231933, -151.26145313167987, -915.4109593637116, -18.669177396788303, -832.5901068158474, -870.6781117793922, -1130.536869760663, -1033.1047545497645, -796.6256263030301, -410.70377221721907, -804.118201853655, -984.494388082437, -409.5092176843382, -884.5293553172562, -232.81131263799102, -554.9891203998976, -234.7037276081055, -642.6880054955681, -957.3385941575843, -953.936433127015, -797.0234921380601, -1014.8278664773081, -537.3932263027616, -929.8231423811881, -803.8014407421715, -682.0234479935086, -470.4632719801162, -742.313341587979, -1124.7310578723411, -603.7494525079629, -604.2887249213456, -865.8629384833482, -999.6479596054766, -515.8128296600711, -465.3251340446193, -1152.133019747378, -605.5170928138535, -42.749006407931745, -698.9938378938247, -174.5407357426774, -838.0889116915083, -522.8116748407645, -305.03858728344727, -394.12235841661175, -478.1199801048314, -353.47249895088476, -993.1812345388613, -167.75124878069892, -1130.7961658320662, -636.7282804768021, -203.49002378947756, -1113.9735145706295, -733.3509546684941, -833.9531172059548, -666.09030974258, -589.4711644018057, -683.1397971313316, -1139.364548109192, -673.2427317566687, -964.9332608651579, -158.82283275102628, -1038.8609144791026, -432.10145143185264, -763.8196414378762, -717.1184393877313, -1008.0655555455762, -866.3942649483294, -1156.8345417793512, -484.19109881522866, -56.209908678045565, -179.38961736358107, -696.6267961209492, -33.5546991612875, -861.5693291213211, -953.2326478678003, -757.0631851334841, -788.5036389566478, -617.8827474136828, -698.4696566034486, -997.0523023560111, -967.4946927667627, -818.0268182862327, -828.7957221424974, -606.5810465993717, -362.8852265620387, -439.12090981807523, -834.6915434831913, -536.8111251580702, -1048.4390354928992, -989.6184480819347, -908.8702800089679, -466.51269191768546, -622.9952021190609, -448.3259930750413, -988.9283946004298, -1239.9902655941237], "episode_lengths": [150, 150, 150, 150, 76, 99, 150, 60, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 79, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 67, 150, 150, 150, 150, 150, 93, 150, 110, 150, 150, 99, 150, 150, 150, 150, 132, 150, 150, 150, 150, 66, 150, 143, 150, 150, 150, 150, 150, 150, 72, 72, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150], "policy_policy_0_reward": [-941.7657377273175, -664.1610779964742, -773.5379851109017, -980.5991239961327, -91.07944727231933, -151.26145313167987, -915.4109593637116, -18.669177396788303, -832.5901068158474, -870.6781117793922, -1130.536869760663, -1033.1047545497645, -796.6256263030301, -410.70377221721907, -804.118201853655, -984.494388082437, -409.5092176843382, -884.5293553172562, -232.81131263799102, -554.9891203998976, -234.7037276081055, -642.6880054955681, -957.3385941575843, -953.936433127015, -797.0234921380601, -1014.8278664773081, -537.3932263027616, -929.8231423811881, -803.8014407421715, -682.0234479935086, -470.4632719801162, -742.313341587979, -1124.7310578723411, -603.7494525079629, -604.2887249213456, -865.8629384833482, -999.6479596054766, -515.8128296600711, -465.3251340446193, -1152.133019747378, -605.5170928138535, -42.749006407931745, -698.9938378938247, -174.5407357426774, -838.0889116915083, -522.8116748407645, -305.03858728344727, -394.12235841661175, -478.1199801048314, -353.47249895088476, -993.1812345388613, -167.75124878069892, -1130.7961658320662, -636.7282804768021, -203.49002378947756, -1113.9735145706295, -733.3509546684941, -833.9531172059548, -666.09030974258, -589.4711644018057, -683.1397971313316, -1139.364548109192, -673.2427317566687, -964.9332608651579, -158.82283275102628, -1038.8609144791026, -432.10145143185264, -763.8196414378762, -717.1184393877313, -1008.0655555455762, -866.3942649483294, -1156.8345417793512, -484.19109881522866, -56.209908678045565, -179.38961736358107, -696.6267961209492, -33.5546991612875, -861.5693291213211, -953.2326478678003, -757.0631851334841, -788.5036389566478, -617.8827474136828, -698.4696566034486, -997.0523023560111, -967.4946927667627, -818.0268182862327, -828.7957221424974, -606.5810465993717, -362.8852265620387, -439.12090981807523, -834.6915434831913, -536.8111251580702, -1048.4390354928992, -989.6184480819347, -908.8702800089679, -466.51269191768546, -622.9952021190609, -448.3259930750413, -988.9283946004298, -1239.9902655941237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.55134727285101, "mean_inference_ms": 1.6681306192672256, "mean_action_processing_ms": 0.28115882570098344, "mean_env_wait_ms": 2.951399826527681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013108253479003906, "StateBufferConnector_ms": 0.008622407913208008, "ViewRequirementAgentConnector_ms": 0.194504976272583}, "num_episodes": 29, "episode_return_max": -18.669177396788303, "episode_return_min": -1239.9902655941237, "episode_return_mean": -688.9583460730548, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.809738425426, "num_env_steps_trained_throughput_per_sec": 298.809738425426, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13353.895, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13353.824, "sample_time_ms": 1028.336, "learn_time_ms": 12262.44, "learn_throughput": 326.199, "synch_weights_time_ms": 62.283}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00017", "date": "2024-08-03_11-51-56", "timestamp": 1722666116, "time_this_iter_s": 13.398757457733154, "time_total_s": 80.20191240310669, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2443bae60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 80.20191240310669, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 14.026315789473685, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.827295103917519, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.312629994750022, "policy_loss": -0.012351535347988829, "vf_loss": 9.336698414882024, "vf_explained_var": 0.42260600831359624, "kl": 0.016031978769539514, "entropy": 1.4923282033453384, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -33.5546991612875, "episode_reward_min": -1239.9902655941237, "episode_reward_mean": -684.0892032726163, "episode_len_mean": 138.49, "episode_media": {}, "episodes_timesteps_total": 13849, "policy_reward_min": {"policy_0": -1239.9902655941237}, "policy_reward_max": {"policy_0": -33.5546991612875}, "policy_reward_mean": {"policy_0": -684.0892032726163}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-682.0234479935086, -470.4632719801162, -742.313341587979, -1124.7310578723411, -603.7494525079629, -604.2887249213456, -865.8629384833482, -999.6479596054766, -515.8128296600711, -465.3251340446193, -1152.133019747378, -605.5170928138535, -42.749006407931745, -698.9938378938247, -174.5407357426774, -838.0889116915083, -522.8116748407645, -305.03858728344727, -394.12235841661175, -478.1199801048314, -353.47249895088476, -993.1812345388613, -167.75124878069892, -1130.7961658320662, -636.7282804768021, -203.49002378947756, -1113.9735145706295, -733.3509546684941, -833.9531172059548, -666.09030974258, -589.4711644018057, -683.1397971313316, -1139.364548109192, -673.2427317566687, -964.9332608651579, -158.82283275102628, -1038.8609144791026, -432.10145143185264, -763.8196414378762, -717.1184393877313, -1008.0655555455762, -866.3942649483294, -1156.8345417793512, -484.19109881522866, -56.209908678045565, -179.38961736358107, -696.6267961209492, -33.5546991612875, -861.5693291213211, -953.2326478678003, -757.0631851334841, -788.5036389566478, -617.8827474136828, -698.4696566034486, -997.0523023560111, -967.4946927667627, -818.0268182862327, -828.7957221424974, -606.5810465993717, -362.8852265620387, -439.12090981807523, -834.6915434831913, -536.8111251580702, -1048.4390354928992, -989.6184480819347, -908.8702800089679, -466.51269191768546, -622.9952021190609, -448.3259930750413, -988.9283946004298, -1239.9902655941237, -881.1263569437637, -573.1997204565795, -192.48902435225963, -260.92488877093547, -1073.195942891512, -443.0407711850032, -349.6377237891256, -685.66224163179, -620.5149354460484, -852.0141946327827, -389.284584569449, -154.39761470723738, -213.02369327555834, -921.6293045956049, -944.8979043682481, -721.2377378541564, -773.9086461206474, -671.3827121423241, -1206.0569307923472, -845.8387873781079, -634.039485861075, -1095.8356159664468, -37.81427806705137, -826.5055124286419, -879.5921765473324, -860.0653062497206, -851.0067865897906, -757.0174826373635, -1150.4570875318002], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 67, 150, 150, 150, 150, 150, 93, 150, 110, 150, 150, 99, 150, 150, 150, 150, 132, 150, 150, 150, 150, 66, 150, 143, 150, 150, 150, 150, 150, 150, 72, 72, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 138, 103, 111, 150, 106, 150, 150, 135, 150, 150, 89, 90, 150, 150, 150, 145, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-682.0234479935086, -470.4632719801162, -742.313341587979, -1124.7310578723411, -603.7494525079629, -604.2887249213456, -865.8629384833482, -999.6479596054766, -515.8128296600711, -465.3251340446193, -1152.133019747378, -605.5170928138535, -42.749006407931745, -698.9938378938247, -174.5407357426774, -838.0889116915083, -522.8116748407645, -305.03858728344727, -394.12235841661175, -478.1199801048314, -353.47249895088476, -993.1812345388613, -167.75124878069892, -1130.7961658320662, -636.7282804768021, -203.49002378947756, -1113.9735145706295, -733.3509546684941, -833.9531172059548, -666.09030974258, -589.4711644018057, -683.1397971313316, -1139.364548109192, -673.2427317566687, -964.9332608651579, -158.82283275102628, -1038.8609144791026, -432.10145143185264, -763.8196414378762, -717.1184393877313, -1008.0655555455762, -866.3942649483294, -1156.8345417793512, -484.19109881522866, -56.209908678045565, -179.38961736358107, -696.6267961209492, -33.5546991612875, -861.5693291213211, -953.2326478678003, -757.0631851334841, -788.5036389566478, -617.8827474136828, -698.4696566034486, -997.0523023560111, -967.4946927667627, -818.0268182862327, -828.7957221424974, -606.5810465993717, -362.8852265620387, -439.12090981807523, -834.6915434831913, -536.8111251580702, -1048.4390354928992, -989.6184480819347, -908.8702800089679, -466.51269191768546, -622.9952021190609, -448.3259930750413, -988.9283946004298, -1239.9902655941237, -881.1263569437637, -573.1997204565795, -192.48902435225963, -260.92488877093547, -1073.195942891512, -443.0407711850032, -349.6377237891256, -685.66224163179, -620.5149354460484, -852.0141946327827, -389.284584569449, -154.39761470723738, -213.02369327555834, -921.6293045956049, -944.8979043682481, -721.2377378541564, -773.9086461206474, -671.3827121423241, -1206.0569307923472, -845.8387873781079, -634.039485861075, -1095.8356159664468, -37.81427806705137, -826.5055124286419, -879.5921765473324, -860.0653062497206, -851.0067865897906, -757.0174826373635, -1150.4570875318002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5517111145512273, "mean_inference_ms": 1.6762068837920603, "mean_action_processing_ms": 0.28221313232312917, "mean_env_wait_ms": 2.9669646908865035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01279759407043457, "StateBufferConnector_ms": 0.008389472961425781, "ViewRequirementAgentConnector_ms": 0.19114279747009277}, "num_episodes": 29, "episode_return_max": -33.5546991612875, "episode_return_min": -1239.9902655941237, "episode_return_mean": -684.0892032726163, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.37474703245346, "num_env_steps_trained_throughput_per_sec": 319.37474703245346, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13235.407, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13235.337, "sample_time_ms": 1030.513, "learn_time_ms": 12140.549, "learn_throughput": 329.474, "synch_weights_time_ms": 63.504}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00017", "date": "2024-08-03_11-52-09", "timestamp": 1722666129, "time_this_iter_s": 12.537317514419556, "time_total_s": 92.73922991752625, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433e680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 92.73922991752625, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 14.211111111111112, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.323799590145549, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.204146435360114, "policy_loss": -0.013648706134214686, "vf_loss": 9.230091601610184, "vf_explained_var": 0.36481786202639344, "kl": 0.018535268773848663, "entropy": 1.600354868421952, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -33.5546991612875, "episode_reward_min": -1246.9141003489444, "episode_reward_mean": -709.8842219237376, "episode_len_mean": 139.48, "episode_media": {}, "episodes_timesteps_total": 13948, "policy_reward_min": {"policy_0": -1246.9141003489444}, "policy_reward_max": {"policy_0": -33.5546991612875}, "policy_reward_mean": {"policy_0": -709.8842219237376}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1113.9735145706295, -733.3509546684941, -833.9531172059548, -666.09030974258, -589.4711644018057, -683.1397971313316, -1139.364548109192, -673.2427317566687, -964.9332608651579, -158.82283275102628, -1038.8609144791026, -432.10145143185264, -763.8196414378762, -717.1184393877313, -1008.0655555455762, -866.3942649483294, -1156.8345417793512, -484.19109881522866, -56.209908678045565, -179.38961736358107, -696.6267961209492, -33.5546991612875, -861.5693291213211, -953.2326478678003, -757.0631851334841, -788.5036389566478, -617.8827474136828, -698.4696566034486, -997.0523023560111, -967.4946927667627, -818.0268182862327, -828.7957221424974, -606.5810465993717, -362.8852265620387, -439.12090981807523, -834.6915434831913, -536.8111251580702, -1048.4390354928992, -989.6184480819347, -908.8702800089679, -466.51269191768546, -622.9952021190609, -448.3259930750413, -988.9283946004298, -1239.9902655941237, -881.1263569437637, -573.1997204565795, -192.48902435225963, -260.92488877093547, -1073.195942891512, -443.0407711850032, -349.6377237891256, -685.66224163179, -620.5149354460484, -852.0141946327827, -389.284584569449, -154.39761470723738, -213.02369327555834, -921.6293045956049, -944.8979043682481, -721.2377378541564, -773.9086461206474, -671.3827121423241, -1206.0569307923472, -845.8387873781079, -634.039485861075, -1095.8356159664468, -37.81427806705137, -826.5055124286419, -879.5921765473324, -860.0653062497206, -851.0067865897906, -757.0174826373635, -1150.4570875318002, -1063.1784524674492, -1131.5510378102283, -970.2199704159914, -903.613922391331, -942.9124169150784, -389.11132812498704, -860.1883174617292, -293.7916485189634, -1088.2157400548635, -635.9486586299403, -349.295663464261, -201.5241095775756, -458.1671737050963, -277.62237664253934, -491.54115206257575, -916.6130113861833, -960.9693532969833, -878.9195929979669, -977.3280888105063, -976.2649414177309, -327.77735179368807, -91.36195030207662, -1246.9141003489444, -333.17063209289375, -734.7271474687345, -850.3265429222088], "episode_lengths": [150, 150, 150, 150, 132, 150, 150, 150, 150, 66, 150, 143, 150, 150, 150, 150, 150, 150, 72, 72, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 138, 103, 111, 150, 106, 150, 150, 135, 150, 150, 89, 90, 150, 150, 150, 145, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 122, 79, 150, 150, 150, 150], "policy_policy_0_reward": [-1113.9735145706295, -733.3509546684941, -833.9531172059548, -666.09030974258, -589.4711644018057, -683.1397971313316, -1139.364548109192, -673.2427317566687, -964.9332608651579, -158.82283275102628, -1038.8609144791026, -432.10145143185264, -763.8196414378762, -717.1184393877313, -1008.0655555455762, -866.3942649483294, -1156.8345417793512, -484.19109881522866, -56.209908678045565, -179.38961736358107, -696.6267961209492, -33.5546991612875, -861.5693291213211, -953.2326478678003, -757.0631851334841, -788.5036389566478, -617.8827474136828, -698.4696566034486, -997.0523023560111, -967.4946927667627, -818.0268182862327, -828.7957221424974, -606.5810465993717, -362.8852265620387, -439.12090981807523, -834.6915434831913, -536.8111251580702, -1048.4390354928992, -989.6184480819347, -908.8702800089679, -466.51269191768546, -622.9952021190609, -448.3259930750413, -988.9283946004298, -1239.9902655941237, -881.1263569437637, -573.1997204565795, -192.48902435225963, -260.92488877093547, -1073.195942891512, -443.0407711850032, -349.6377237891256, -685.66224163179, -620.5149354460484, -852.0141946327827, -389.284584569449, -154.39761470723738, -213.02369327555834, -921.6293045956049, -944.8979043682481, -721.2377378541564, -773.9086461206474, -671.3827121423241, -1206.0569307923472, -845.8387873781079, -634.039485861075, -1095.8356159664468, -37.81427806705137, -826.5055124286419, -879.5921765473324, -860.0653062497206, -851.0067865897906, -757.0174826373635, -1150.4570875318002, -1063.1784524674492, -1131.5510378102283, -970.2199704159914, -903.613922391331, -942.9124169150784, -389.11132812498704, -860.1883174617292, -293.7916485189634, -1088.2157400548635, -635.9486586299403, -349.295663464261, -201.5241095775756, -458.1671737050963, -277.62237664253934, -491.54115206257575, -916.6130113861833, -960.9693532969833, -878.9195929979669, -977.3280888105063, -976.2649414177309, -327.77735179368807, -91.36195030207662, -1246.9141003489444, -333.17063209289375, -734.7271474687345, -850.3265429222088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531369200796448, "mean_inference_ms": 1.682306719317805, "mean_action_processing_ms": 0.2827392756032843, "mean_env_wait_ms": 2.980002187141273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012628316879272461, "StateBufferConnector_ms": 0.008229970932006836, "ViewRequirementAgentConnector_ms": 0.19211769104003906}, "num_episodes": 26, "episode_return_max": -33.5546991612875, "episode_return_min": -1246.9141003489444, "episode_return_mean": -709.8842219237376, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.98705493340094, "num_env_steps_trained_throughput_per_sec": 296.98705493340094, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13264.559, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13264.485, "sample_time_ms": 1029.365, "learn_time_ms": 12170.378, "learn_throughput": 328.667, "synch_weights_time_ms": 63.978}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00017", "date": "2024-08-03_11-52-23", "timestamp": 1722666143, "time_this_iter_s": 13.481043100357056, "time_total_s": 106.2202730178833, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2444b4d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 106.2202730178833, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.957894736842105, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.04011528454721, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.211002306143444, "policy_loss": -0.009484453534726829, "vf_loss": 9.233054451147716, "vf_explained_var": 0.2954978127032518, "kl": 0.01746789802738629, "entropy": 1.6061216628799835, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -37.81427806705137, "episode_reward_min": -1273.2675139400937, "episode_reward_mean": -746.8595233541909, "episode_len_mean": 141.09, "episode_media": {}, "episodes_timesteps_total": 14109, "policy_reward_min": {"policy_0": -1273.2675139400937}, "policy_reward_max": {"policy_0": -37.81427806705137}, "policy_reward_mean": {"policy_0": -746.8595233541909}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-828.7957221424974, -606.5810465993717, -362.8852265620387, -439.12090981807523, -834.6915434831913, -536.8111251580702, -1048.4390354928992, -989.6184480819347, -908.8702800089679, -466.51269191768546, -622.9952021190609, -448.3259930750413, -988.9283946004298, -1239.9902655941237, -881.1263569437637, -573.1997204565795, -192.48902435225963, -260.92488877093547, -1073.195942891512, -443.0407711850032, -349.6377237891256, -685.66224163179, -620.5149354460484, -852.0141946327827, -389.284584569449, -154.39761470723738, -213.02369327555834, -921.6293045956049, -944.8979043682481, -721.2377378541564, -773.9086461206474, -671.3827121423241, -1206.0569307923472, -845.8387873781079, -634.039485861075, -1095.8356159664468, -37.81427806705137, -826.5055124286419, -879.5921765473324, -860.0653062497206, -851.0067865897906, -757.0174826373635, -1150.4570875318002, -1063.1784524674492, -1131.5510378102283, -970.2199704159914, -903.613922391331, -942.9124169150784, -389.11132812498704, -860.1883174617292, -293.7916485189634, -1088.2157400548635, -635.9486586299403, -349.295663464261, -201.5241095775756, -458.1671737050963, -277.62237664253934, -491.54115206257575, -916.6130113861833, -960.9693532969833, -878.9195929979669, -977.3280888105063, -976.2649414177309, -327.77735179368807, -91.36195030207662, -1246.9141003489444, -333.17063209289375, -734.7271474687345, -850.3265429222088, -972.4898911132441, -1022.9921358284208, -908.731306548283, -1103.3527452087094, -313.6759074552934, -815.810379627198, -901.0909263647097, -718.6994116793901, -353.36292990610445, -922.1630005589217, -182.9900504867609, -1148.6673296647878, -1163.220490186578, -977.0187185997222, -975.9302992569221, -250.9672302247556, -1087.8524590463953, -951.2389095103314, -575.4642030093045, -309.92339324289594, -1273.2675139400937, -944.7643245517048, -871.6031424083344, -668.0350033277292, -1114.505029449986, -1061.551227753333, -980.0476221162595, -413.54436719969164, -1015.323175648655, -1138.1577097950938, -1009.8934881928722], "episode_lengths": [150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 138, 103, 111, 150, 106, 150, 150, 135, 150, 150, 89, 90, 150, 150, 150, 145, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 122, 79, 150, 150, 150, 150, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 78, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-828.7957221424974, -606.5810465993717, -362.8852265620387, -439.12090981807523, -834.6915434831913, -536.8111251580702, -1048.4390354928992, -989.6184480819347, -908.8702800089679, -466.51269191768546, -622.9952021190609, -448.3259930750413, -988.9283946004298, -1239.9902655941237, -881.1263569437637, -573.1997204565795, -192.48902435225963, -260.92488877093547, -1073.195942891512, -443.0407711850032, -349.6377237891256, -685.66224163179, -620.5149354460484, -852.0141946327827, -389.284584569449, -154.39761470723738, -213.02369327555834, -921.6293045956049, -944.8979043682481, -721.2377378541564, -773.9086461206474, -671.3827121423241, -1206.0569307923472, -845.8387873781079, -634.039485861075, -1095.8356159664468, -37.81427806705137, -826.5055124286419, -879.5921765473324, -860.0653062497206, -851.0067865897906, -757.0174826373635, -1150.4570875318002, -1063.1784524674492, -1131.5510378102283, -970.2199704159914, -903.613922391331, -942.9124169150784, -389.11132812498704, -860.1883174617292, -293.7916485189634, -1088.2157400548635, -635.9486586299403, -349.295663464261, -201.5241095775756, -458.1671737050963, -277.62237664253934, -491.54115206257575, -916.6130113861833, -960.9693532969833, -878.9195929979669, -977.3280888105063, -976.2649414177309, -327.77735179368807, -91.36195030207662, -1246.9141003489444, -333.17063209289375, -734.7271474687345, -850.3265429222088, -972.4898911132441, -1022.9921358284208, -908.731306548283, -1103.3527452087094, -313.6759074552934, -815.810379627198, -901.0909263647097, -718.6994116793901, -353.36292990610445, -922.1630005589217, -182.9900504867609, -1148.6673296647878, -1163.220490186578, -977.0187185997222, -975.9302992569221, -250.9672302247556, -1087.8524590463953, -951.2389095103314, -575.4642030093045, -309.92339324289594, -1273.2675139400937, -944.7643245517048, -871.6031424083344, -668.0350033277292, -1114.505029449986, -1061.551227753333, -980.0476221162595, -413.54436719969164, -1015.323175648655, -1138.1577097950938, -1009.8934881928722]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5527080108857823, "mean_inference_ms": 1.6856452600461653, "mean_action_processing_ms": 0.2826901480586084, "mean_env_wait_ms": 2.992380791156036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012535810470581055, "StateBufferConnector_ms": 0.008168458938598633, "ViewRequirementAgentConnector_ms": 0.1953904628753662}, "num_episodes": 31, "episode_return_max": -37.81427806705137, "episode_return_min": -1273.2675139400937, "episode_return_mean": -746.8595233541909, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.86153526775803, "num_env_steps_trained_throughput_per_sec": 301.86153526775803, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13263.066, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13262.992, "sample_time_ms": 1031.648, "learn_time_ms": 12165.712, "learn_throughput": 328.793, "synch_weights_time_ms": 64.861}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00017", "date": "2024-08-03_11-52-36", "timestamp": 1722666156, "time_this_iter_s": 13.262784481048584, "time_total_s": 119.48305749893188, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2443b8280>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 119.48305749893188, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.642105263157895, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.029198851622641, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.601117099324862, "policy_loss": -0.012828973367383393, "vf_loss": 9.625949036081632, "vf_explained_var": 0.23297830075025558, "kl": 0.02071016247058046, "entropy": 1.6145008916656176, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -37.81427806705137, "episode_reward_min": -1315.7848106410283, "episode_reward_mean": -791.4970252968704, "episode_len_mean": 142.22, "episode_media": {}, "episodes_timesteps_total": 14222, "policy_reward_min": {"policy_0": -1315.7848106410283}, "policy_reward_max": {"policy_0": -37.81427806705137}, "policy_reward_mean": {"policy_0": -791.4970252968704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-213.02369327555834, -921.6293045956049, -944.8979043682481, -721.2377378541564, -773.9086461206474, -671.3827121423241, -1206.0569307923472, -845.8387873781079, -634.039485861075, -1095.8356159664468, -37.81427806705137, -826.5055124286419, -879.5921765473324, -860.0653062497206, -851.0067865897906, -757.0174826373635, -1150.4570875318002, -1063.1784524674492, -1131.5510378102283, -970.2199704159914, -903.613922391331, -942.9124169150784, -389.11132812498704, -860.1883174617292, -293.7916485189634, -1088.2157400548635, -635.9486586299403, -349.295663464261, -201.5241095775756, -458.1671737050963, -277.62237664253934, -491.54115206257575, -916.6130113861833, -960.9693532969833, -878.9195929979669, -977.3280888105063, -976.2649414177309, -327.77735179368807, -91.36195030207662, -1246.9141003489444, -333.17063209289375, -734.7271474687345, -850.3265429222088, -972.4898911132441, -1022.9921358284208, -908.731306548283, -1103.3527452087094, -313.6759074552934, -815.810379627198, -901.0909263647097, -718.6994116793901, -353.36292990610445, -922.1630005589217, -182.9900504867609, -1148.6673296647878, -1163.220490186578, -977.0187185997222, -975.9302992569221, -250.9672302247556, -1087.8524590463953, -951.2389095103314, -575.4642030093045, -309.92339324289594, -1273.2675139400937, -944.7643245517048, -871.6031424083344, -668.0350033277292, -1114.505029449986, -1061.551227753333, -980.0476221162595, -413.54436719969164, -1015.323175648655, -1138.1577097950938, -1009.8934881928722, -1074.2625752102858, -533.0406560228287, -961.0635423733424, -1029.1500157240835, -537.3059273998833, -70.60740240679763, -772.2768756906038, -1030.8333779661941, -989.0977202607467, -1001.9524616110641, -971.3028748432262, -485.49909048570134, -1218.7249168854044, -1315.7848106410283, -423.24334553611106, -927.3577786604503, -949.7103611506996, -331.1353603775169, -623.4617550796385, -720.7706748161265, -622.1521524038787, -651.1476182728012, -1041.6767279377423, -974.2528804577096, -1110.0820704952782, -895.9111055886815], "episode_lengths": [90, 150, 150, 150, 145, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 122, 79, 150, 150, 150, 150, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 78, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 64, 150, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 93, 150, 150, 141, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-213.02369327555834, -921.6293045956049, -944.8979043682481, -721.2377378541564, -773.9086461206474, -671.3827121423241, -1206.0569307923472, -845.8387873781079, -634.039485861075, -1095.8356159664468, -37.81427806705137, -826.5055124286419, -879.5921765473324, -860.0653062497206, -851.0067865897906, -757.0174826373635, -1150.4570875318002, -1063.1784524674492, -1131.5510378102283, -970.2199704159914, -903.613922391331, -942.9124169150784, -389.11132812498704, -860.1883174617292, -293.7916485189634, -1088.2157400548635, -635.9486586299403, -349.295663464261, -201.5241095775756, -458.1671737050963, -277.62237664253934, -491.54115206257575, -916.6130113861833, -960.9693532969833, -878.9195929979669, -977.3280888105063, -976.2649414177309, -327.77735179368807, -91.36195030207662, -1246.9141003489444, -333.17063209289375, -734.7271474687345, -850.3265429222088, -972.4898911132441, -1022.9921358284208, -908.731306548283, -1103.3527452087094, -313.6759074552934, -815.810379627198, -901.0909263647097, -718.6994116793901, -353.36292990610445, -922.1630005589217, -182.9900504867609, -1148.6673296647878, -1163.220490186578, -977.0187185997222, -975.9302992569221, -250.9672302247556, -1087.8524590463953, -951.2389095103314, -575.4642030093045, -309.92339324289594, -1273.2675139400937, -944.7643245517048, -871.6031424083344, -668.0350033277292, -1114.505029449986, -1061.551227753333, -980.0476221162595, -413.54436719969164, -1015.323175648655, -1138.1577097950938, -1009.8934881928722, -1074.2625752102858, -533.0406560228287, -961.0635423733424, -1029.1500157240835, -537.3059273998833, -70.60740240679763, -772.2768756906038, -1030.8333779661941, -989.0977202607467, -1001.9524616110641, -971.3028748432262, -485.49909048570134, -1218.7249168854044, -1315.7848106410283, -423.24334553611106, -927.3577786604503, -949.7103611506996, -331.1353603775169, -623.4617550796385, -720.7706748161265, -622.1521524038787, -651.1476182728012, -1041.6767279377423, -974.2528804577096, -1110.0820704952782, -895.9111055886815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523895928174722, "mean_inference_ms": 1.6866530097502668, "mean_action_processing_ms": 0.2824546412793822, "mean_env_wait_ms": 2.9995096188834367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012166023254394531, "StateBufferConnector_ms": 0.008254528045654297, "ViewRequirementAgentConnector_ms": 0.1974172592163086}, "num_episodes": 26, "episode_return_max": -37.81427806705137, "episode_return_min": -1315.7848106410283, "episode_return_mean": -791.4970252968704, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.9103941530979, "num_env_steps_trained_throughput_per_sec": 298.9103941530979, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13274.956, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13274.88, "sample_time_ms": 1033.634, "learn_time_ms": 12174.396, "learn_throughput": 328.558, "synch_weights_time_ms": 66.071}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00017", "date": "2024-08-03_11-52-49", "timestamp": 1722666169, "time_this_iter_s": 13.39550256729126, "time_total_s": 132.87856006622314, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2443b8310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 132.87856006622314, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.773684210526316, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.119336492940784, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.2879854063193, "policy_loss": -0.011361245160029891, "vf_loss": 9.307972645759582, "vf_explained_var": 0.3146335663894812, "kl": 0.021740259631284686, "entropy": 1.5148117132484913, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -70.60740240679763, "episode_reward_min": -1315.7848106410283, "episode_reward_mean": -802.8127200380874, "episode_len_mean": 143.27, "episode_media": {}, "episodes_timesteps_total": 14327, "policy_reward_min": {"policy_0": -1315.7848106410283}, "policy_reward_max": {"policy_0": -70.60740240679763}, "policy_reward_mean": {"policy_0": -802.8127200380874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-349.295663464261, -201.5241095775756, -458.1671737050963, -277.62237664253934, -491.54115206257575, -916.6130113861833, -960.9693532969833, -878.9195929979669, -977.3280888105063, -976.2649414177309, -327.77735179368807, -91.36195030207662, -1246.9141003489444, -333.17063209289375, -734.7271474687345, -850.3265429222088, -972.4898911132441, -1022.9921358284208, -908.731306548283, -1103.3527452087094, -313.6759074552934, -815.810379627198, -901.0909263647097, -718.6994116793901, -353.36292990610445, -922.1630005589217, -182.9900504867609, -1148.6673296647878, -1163.220490186578, -977.0187185997222, -975.9302992569221, -250.9672302247556, -1087.8524590463953, -951.2389095103314, -575.4642030093045, -309.92339324289594, -1273.2675139400937, -944.7643245517048, -871.6031424083344, -668.0350033277292, -1114.505029449986, -1061.551227753333, -980.0476221162595, -413.54436719969164, -1015.323175648655, -1138.1577097950938, -1009.8934881928722, -1074.2625752102858, -533.0406560228287, -961.0635423733424, -1029.1500157240835, -537.3059273998833, -70.60740240679763, -772.2768756906038, -1030.8333779661941, -989.0977202607467, -1001.9524616110641, -971.3028748432262, -485.49909048570134, -1218.7249168854044, -1315.7848106410283, -423.24334553611106, -927.3577786604503, -949.7103611506996, -331.1353603775169, -623.4617550796385, -720.7706748161265, -622.1521524038787, -651.1476182728012, -1041.6767279377423, -974.2528804577096, -1110.0820704952782, -895.9111055886815, -1211.8710332373332, -1105.626974026426, -1003.5397587546003, -650.3254522586957, -791.4187401230249, -891.8348445849521, -1095.007189069032, -432.6665773738908, -680.6066697669327, -885.2536832997941, -1068.1686092845505, -817.3951018118795, -993.7419657399655, -1091.2859030973768, -936.985254334657, -846.5992178285281, -149.9671686465907, -510.38000120104715, -1045.0943716750257, -718.8255240574333, -715.6675037762315, -185.82530214294795, -969.1764569073032, -1106.9697517238085, -907.8811541231507, -909.8755492915432, -1078.6206571817463], "episode_lengths": [150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 122, 79, 150, 150, 150, 150, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 78, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 64, 150, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 93, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-349.295663464261, -201.5241095775756, -458.1671737050963, -277.62237664253934, -491.54115206257575, -916.6130113861833, -960.9693532969833, -878.9195929979669, -977.3280888105063, -976.2649414177309, -327.77735179368807, -91.36195030207662, -1246.9141003489444, -333.17063209289375, -734.7271474687345, -850.3265429222088, -972.4898911132441, -1022.9921358284208, -908.731306548283, -1103.3527452087094, -313.6759074552934, -815.810379627198, -901.0909263647097, -718.6994116793901, -353.36292990610445, -922.1630005589217, -182.9900504867609, -1148.6673296647878, -1163.220490186578, -977.0187185997222, -975.9302992569221, -250.9672302247556, -1087.8524590463953, -951.2389095103314, -575.4642030093045, -309.92339324289594, -1273.2675139400937, -944.7643245517048, -871.6031424083344, -668.0350033277292, -1114.505029449986, -1061.551227753333, -980.0476221162595, -413.54436719969164, -1015.323175648655, -1138.1577097950938, -1009.8934881928722, -1074.2625752102858, -533.0406560228287, -961.0635423733424, -1029.1500157240835, -537.3059273998833, -70.60740240679763, -772.2768756906038, -1030.8333779661941, -989.0977202607467, -1001.9524616110641, -971.3028748432262, -485.49909048570134, -1218.7249168854044, -1315.7848106410283, -423.24334553611106, -927.3577786604503, -949.7103611506996, -331.1353603775169, -623.4617550796385, -720.7706748161265, -622.1521524038787, -651.1476182728012, -1041.6767279377423, -974.2528804577096, -1110.0820704952782, -895.9111055886815, -1211.8710332373332, -1105.626974026426, -1003.5397587546003, -650.3254522586957, -791.4187401230249, -891.8348445849521, -1095.007189069032, -432.6665773738908, -680.6066697669327, -885.2536832997941, -1068.1686092845505, -817.3951018118795, -993.7419657399655, -1091.2859030973768, -936.985254334657, -846.5992178285281, -149.9671686465907, -510.38000120104715, -1045.0943716750257, -718.8255240574333, -715.6675037762315, -185.82530214294795, -969.1764569073032, -1106.9697517238085, -907.8811541231507, -909.8755492915432, -1078.6206571817463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520644077838428, "mean_inference_ms": 1.6889009048307109, "mean_action_processing_ms": 0.28223391895820776, "mean_env_wait_ms": 3.0078137517134014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01216435432434082, "StateBufferConnector_ms": 0.00833439826965332, "ViewRequirementAgentConnector_ms": 0.19938945770263672}, "num_episodes": 27, "episode_return_max": -70.60740240679763, "episode_return_min": -1315.7848106410283, "episode_return_mean": -802.8127200380874, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.71872701746423, "num_env_steps_trained_throughput_per_sec": 297.71872701746423, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13314.823, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13314.748, "sample_time_ms": 1036.545, "learn_time_ms": 12210.712, "learn_throughput": 327.581, "synch_weights_time_ms": 66.711}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00017", "date": "2024-08-03_11-53-03", "timestamp": 1722666183, "time_this_iter_s": 13.448845863342285, "time_total_s": 146.32740592956543, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2443bbc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 146.32740592956543, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 14.047368421052633, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.03195253337423, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 9.121968081096808, "policy_loss": -0.009394124810448072, "vf_loss": 9.141494404276212, "vf_explained_var": 0.37384701122840247, "kl": 0.012251382190515869, "entropy": 1.564531386643648, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -70.60740240679763, "episode_reward_min": -1358.9753495663751, "episode_reward_mean": -794.0799286869457, "episode_len_mean": 142.85, "episode_media": {}, "episodes_timesteps_total": 14285, "policy_reward_min": {"policy_0": -1358.9753495663751}, "policy_reward_max": {"policy_0": -70.60740240679763}, "policy_reward_mean": {"policy_0": -794.0799286869457}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-975.9302992569221, -250.9672302247556, -1087.8524590463953, -951.2389095103314, -575.4642030093045, -309.92339324289594, -1273.2675139400937, -944.7643245517048, -871.6031424083344, -668.0350033277292, -1114.505029449986, -1061.551227753333, -980.0476221162595, -413.54436719969164, -1015.323175648655, -1138.1577097950938, -1009.8934881928722, -1074.2625752102858, -533.0406560228287, -961.0635423733424, -1029.1500157240835, -537.3059273998833, -70.60740240679763, -772.2768756906038, -1030.8333779661941, -989.0977202607467, -1001.9524616110641, -971.3028748432262, -485.49909048570134, -1218.7249168854044, -1315.7848106410283, -423.24334553611106, -927.3577786604503, -949.7103611506996, -331.1353603775169, -623.4617550796385, -720.7706748161265, -622.1521524038787, -651.1476182728012, -1041.6767279377423, -974.2528804577096, -1110.0820704952782, -895.9111055886815, -1211.8710332373332, -1105.626974026426, -1003.5397587546003, -650.3254522586957, -791.4187401230249, -891.8348445849521, -1095.007189069032, -432.6665773738908, -680.6066697669327, -885.2536832997941, -1068.1686092845505, -817.3951018118795, -993.7419657399655, -1091.2859030973768, -936.985254334657, -846.5992178285281, -149.9671686465907, -510.38000120104715, -1045.0943716750257, -718.8255240574333, -715.6675037762315, -185.82530214294795, -969.1764569073032, -1106.9697517238085, -907.8811541231507, -909.8755492915432, -1078.6206571817463, -696.5272212584584, -732.7593142023087, -150.34252134689746, -719.5085390361918, -225.84051758489545, -569.0617992219503, -768.1291411586333, -525.2328141189556, -1135.086117594981, -922.9109359327675, -439.87290431974844, -726.6337479283197, -636.9439472726401, -1052.3985648626262, -886.1320491796671, -1097.8959031007237, -534.6995930501895, -1020.23355911763, -421.4106207654129, -1358.9753495663751, -711.3743469210985, -942.0144412488563, -416.67842490986806, -467.427834824962, -604.4974147470667, -104.67527502387892, -552.698524323622, -982.7988065206757, -484.8768380762322, -815.872209188267], "episode_lengths": [150, 78, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 64, 150, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 93, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 102, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 138, 143, 150, 66, 150, 150, 141, 150], "policy_policy_0_reward": [-975.9302992569221, -250.9672302247556, -1087.8524590463953, -951.2389095103314, -575.4642030093045, -309.92339324289594, -1273.2675139400937, -944.7643245517048, -871.6031424083344, -668.0350033277292, -1114.505029449986, -1061.551227753333, -980.0476221162595, -413.54436719969164, -1015.323175648655, -1138.1577097950938, -1009.8934881928722, -1074.2625752102858, -533.0406560228287, -961.0635423733424, -1029.1500157240835, -537.3059273998833, -70.60740240679763, -772.2768756906038, -1030.8333779661941, -989.0977202607467, -1001.9524616110641, -971.3028748432262, -485.49909048570134, -1218.7249168854044, -1315.7848106410283, -423.24334553611106, -927.3577786604503, -949.7103611506996, -331.1353603775169, -623.4617550796385, -720.7706748161265, -622.1521524038787, -651.1476182728012, -1041.6767279377423, -974.2528804577096, -1110.0820704952782, -895.9111055886815, -1211.8710332373332, -1105.626974026426, -1003.5397587546003, -650.3254522586957, -791.4187401230249, -891.8348445849521, -1095.007189069032, -432.6665773738908, -680.6066697669327, -885.2536832997941, -1068.1686092845505, -817.3951018118795, -993.7419657399655, -1091.2859030973768, -936.985254334657, -846.5992178285281, -149.9671686465907, -510.38000120104715, -1045.0943716750257, -718.8255240574333, -715.6675037762315, -185.82530214294795, -969.1764569073032, -1106.9697517238085, -907.8811541231507, -909.8755492915432, -1078.6206571817463, -696.5272212584584, -732.7593142023087, -150.34252134689746, -719.5085390361918, -225.84051758489545, -569.0617992219503, -768.1291411586333, -525.2328141189556, -1135.086117594981, -922.9109359327675, -439.87290431974844, -726.6337479283197, -636.9439472726401, -1052.3985648626262, -886.1320491796671, -1097.8959031007237, -534.6995930501895, -1020.23355911763, -421.4106207654129, -1358.9753495663751, -711.3743469210985, -942.0144412488563, -416.67842490986806, -467.427834824962, -604.4974147470667, -104.67527502387892, -552.698524323622, -982.7988065206757, -484.8768380762322, -815.872209188267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5514753456641739, "mean_inference_ms": 1.6899458153211437, "mean_action_processing_ms": 0.2818627902498386, "mean_env_wait_ms": 3.014928100446174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011587381362915039, "StateBufferConnector_ms": 0.008124828338623047, "ViewRequirementAgentConnector_ms": 0.19501805305480957}, "num_episodes": 30, "episode_return_max": -70.60740240679763, "episode_return_min": -1358.9753495663751, "episode_return_mean": -794.0799286869457, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.02786855616984, "num_env_steps_trained_throughput_per_sec": 301.02786855616984, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13299.318, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13299.241, "sample_time_ms": 1037.491, "learn_time_ms": 12193.958, "learn_throughput": 328.031, "synch_weights_time_ms": 66.999}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00017", "date": "2024-08-03_11-53-16", "timestamp": 1722666196, "time_this_iter_s": 13.302121877670288, "time_total_s": 159.62952780723572, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2443bb370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 159.62952780723572, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.605263157894736, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.298696266114712, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 9.319474435846011, "policy_loss": -0.008856748580971423, "vf_loss": 9.338657743732135, "vf_explained_var": 0.3194656576961279, "kl": 0.013431936995160276, "entropy": 1.6370901027073463, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -104.67527502387892, "episode_reward_min": -1358.9753495663751, "episode_reward_mean": -792.6341165611755, "episode_len_mean": 144.27, "episode_media": {}, "episodes_timesteps_total": 14427, "policy_reward_min": {"policy_0": -1358.9753495663751}, "policy_reward_max": {"policy_0": -104.67527502387892}, "policy_reward_mean": {"policy_0": -792.6341165611755}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1218.7249168854044, -1315.7848106410283, -423.24334553611106, -927.3577786604503, -949.7103611506996, -331.1353603775169, -623.4617550796385, -720.7706748161265, -622.1521524038787, -651.1476182728012, -1041.6767279377423, -974.2528804577096, -1110.0820704952782, -895.9111055886815, -1211.8710332373332, -1105.626974026426, -1003.5397587546003, -650.3254522586957, -791.4187401230249, -891.8348445849521, -1095.007189069032, -432.6665773738908, -680.6066697669327, -885.2536832997941, -1068.1686092845505, -817.3951018118795, -993.7419657399655, -1091.2859030973768, -936.985254334657, -846.5992178285281, -149.9671686465907, -510.38000120104715, -1045.0943716750257, -718.8255240574333, -715.6675037762315, -185.82530214294795, -969.1764569073032, -1106.9697517238085, -907.8811541231507, -909.8755492915432, -1078.6206571817463, -696.5272212584584, -732.7593142023087, -150.34252134689746, -719.5085390361918, -225.84051758489545, -569.0617992219503, -768.1291411586333, -525.2328141189556, -1135.086117594981, -922.9109359327675, -439.87290431974844, -726.6337479283197, -636.9439472726401, -1052.3985648626262, -886.1320491796671, -1097.8959031007237, -534.6995930501895, -1020.23355911763, -421.4106207654129, -1358.9753495663751, -711.3743469210985, -942.0144412488563, -416.67842490986806, -467.427834824962, -604.4974147470667, -104.67527502387892, -552.698524323622, -982.7988065206757, -484.8768380762322, -815.872209188267, -1163.75841812444, -1048.6290650218093, -876.2090734046158, -1098.87046193256, -833.1587463303338, -632.0939781608072, -948.7261828062784, -411.29698889650416, -530.6927024821208, -1214.7243714157037, -1074.139067879033, -528.9899227067851, -988.9020960670508, -719.6433395843279, -388.9322299096477, -820.8327534197936, -400.7058468534149, -634.1283830730185, -906.2414890880318, -789.2222494116701, -1194.2489210829724, -905.0221517999314, -884.0228955539504, -1264.1646550271707, -685.5106426325054, -731.0913720763233, -793.0830871313884, -721.9467646867286, -764.8925495331805], "episode_lengths": [150, 150, 150, 150, 150, 93, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 102, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 138, 143, 150, 66, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 105, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1218.7249168854044, -1315.7848106410283, -423.24334553611106, -927.3577786604503, -949.7103611506996, -331.1353603775169, -623.4617550796385, -720.7706748161265, -622.1521524038787, -651.1476182728012, -1041.6767279377423, -974.2528804577096, -1110.0820704952782, -895.9111055886815, -1211.8710332373332, -1105.626974026426, -1003.5397587546003, -650.3254522586957, -791.4187401230249, -891.8348445849521, -1095.007189069032, -432.6665773738908, -680.6066697669327, -885.2536832997941, -1068.1686092845505, -817.3951018118795, -993.7419657399655, -1091.2859030973768, -936.985254334657, -846.5992178285281, -149.9671686465907, -510.38000120104715, -1045.0943716750257, -718.8255240574333, -715.6675037762315, -185.82530214294795, -969.1764569073032, -1106.9697517238085, -907.8811541231507, -909.8755492915432, -1078.6206571817463, -696.5272212584584, -732.7593142023087, -150.34252134689746, -719.5085390361918, -225.84051758489545, -569.0617992219503, -768.1291411586333, -525.2328141189556, -1135.086117594981, -922.9109359327675, -439.87290431974844, -726.6337479283197, -636.9439472726401, -1052.3985648626262, -886.1320491796671, -1097.8959031007237, -534.6995930501895, -1020.23355911763, -421.4106207654129, -1358.9753495663751, -711.3743469210985, -942.0144412488563, -416.67842490986806, -467.427834824962, -604.4974147470667, -104.67527502387892, -552.698524323622, -982.7988065206757, -484.8768380762322, -815.872209188267, -1163.75841812444, -1048.6290650218093, -876.2090734046158, -1098.87046193256, -833.1587463303338, -632.0939781608072, -948.7261828062784, -411.29698889650416, -530.6927024821208, -1214.7243714157037, -1074.139067879033, -528.9899227067851, -988.9020960670508, -719.6433395843279, -388.9322299096477, -820.8327534197936, -400.7058468534149, -634.1283830730185, -906.2414890880318, -789.2222494116701, -1194.2489210829724, -905.0221517999314, -884.0228955539504, -1264.1646550271707, -685.5106426325054, -731.0913720763233, -793.0830871313884, -721.9467646867286, -764.8925495331805]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5510616411282397, "mean_inference_ms": 1.6912430307007025, "mean_action_processing_ms": 0.2814907778069637, "mean_env_wait_ms": 3.0215472618439048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011744976043701172, "StateBufferConnector_ms": 0.007976531982421875, "ViewRequirementAgentConnector_ms": 0.19673967361450195}, "num_episodes": 29, "episode_return_max": -104.67527502387892, "episode_return_min": -1358.9753495663751, "episode_return_mean": -792.6341165611755, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.4129583303217, "num_env_steps_trained_throughput_per_sec": 292.4129583303217, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13325.963, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13325.884, "sample_time_ms": 1044.908, "learn_time_ms": 12211.917, "learn_throughput": 327.549, "synch_weights_time_ms": 68.252}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00017", "date": "2024-08-03_11-53-30", "timestamp": 1722666210, "time_this_iter_s": 13.693273544311523, "time_total_s": 173.32280135154724, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2443bb010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 173.32280135154724, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 14.563157894736845, "ram_util_percent": 27.836842105263155}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.251507712900638, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 9.089360090593496, "policy_loss": -0.0079295644206771, "vf_loss": 9.107942866782347, "vf_explained_var": 0.45724643431603906, "kl": 0.01255262091563054, "entropy": 1.6301888398826123, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -68.22421579045766, "episode_reward_min": -1444.2384407393668, "episode_reward_mean": -733.2004127400902, "episode_len_mean": 138.62, "episode_media": {}, "episodes_timesteps_total": 13862, "policy_reward_min": {"policy_0": -1444.2384407393668}, "policy_reward_max": {"policy_0": -68.22421579045766}, "policy_reward_mean": {"policy_0": -733.2004127400902}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149.9671686465907, -510.38000120104715, -1045.0943716750257, -718.8255240574333, -715.6675037762315, -185.82530214294795, -969.1764569073032, -1106.9697517238085, -907.8811541231507, -909.8755492915432, -1078.6206571817463, -696.5272212584584, -732.7593142023087, -150.34252134689746, -719.5085390361918, -225.84051758489545, -569.0617992219503, -768.1291411586333, -525.2328141189556, -1135.086117594981, -922.9109359327675, -439.87290431974844, -726.6337479283197, -636.9439472726401, -1052.3985648626262, -886.1320491796671, -1097.8959031007237, -534.6995930501895, -1020.23355911763, -421.4106207654129, -1358.9753495663751, -711.3743469210985, -942.0144412488563, -416.67842490986806, -467.427834824962, -604.4974147470667, -104.67527502387892, -552.698524323622, -982.7988065206757, -484.8768380762322, -815.872209188267, -1163.75841812444, -1048.6290650218093, -876.2090734046158, -1098.87046193256, -833.1587463303338, -632.0939781608072, -948.7261828062784, -411.29698889650416, -530.6927024821208, -1214.7243714157037, -1074.139067879033, -528.9899227067851, -988.9020960670508, -719.6433395843279, -388.9322299096477, -820.8327534197936, -400.7058468534149, -634.1283830730185, -906.2414890880318, -789.2222494116701, -1194.2489210829724, -905.0221517999314, -884.0228955539504, -1264.1646550271707, -685.5106426325054, -731.0913720763233, -793.0830871313884, -721.9467646867286, -764.8925495331805, -1444.2384407393668, -1154.4296443994092, -977.5402259998923, -68.22421579045766, -1300.5139553658514, -661.5363788764688, -282.2568284553019, -124.28855075593466, -103.64540248621614, -164.35381241281902, -1096.1848157288296, -643.232170313699, -438.57839564358113, -252.04218781190437, -816.6481575646808, -931.4248153614263, -664.5065032582709, -339.556271707474, -807.7520027707249, -1065.7306504561027, -725.1126990972872, -702.241269851432, -225.21513008282935, -170.75902548749013, -833.9464074686279, -763.0802330960025, -1057.1170212269742, -1052.4741015727773, -945.3805056574565, -552.3583313469021], "episode_lengths": [94, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 102, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 138, 143, 150, 66, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 105, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 82, 82, 52, 65, 150, 150, 150, 116, 150, 150, 150, 94, 150, 150, 150, 150, 78, 84, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-149.9671686465907, -510.38000120104715, -1045.0943716750257, -718.8255240574333, -715.6675037762315, -185.82530214294795, -969.1764569073032, -1106.9697517238085, -907.8811541231507, -909.8755492915432, -1078.6206571817463, -696.5272212584584, -732.7593142023087, -150.34252134689746, -719.5085390361918, -225.84051758489545, -569.0617992219503, -768.1291411586333, -525.2328141189556, -1135.086117594981, -922.9109359327675, -439.87290431974844, -726.6337479283197, -636.9439472726401, -1052.3985648626262, -886.1320491796671, -1097.8959031007237, -534.6995930501895, -1020.23355911763, -421.4106207654129, -1358.9753495663751, -711.3743469210985, -942.0144412488563, -416.67842490986806, -467.427834824962, -604.4974147470667, -104.67527502387892, -552.698524323622, -982.7988065206757, -484.8768380762322, -815.872209188267, -1163.75841812444, -1048.6290650218093, -876.2090734046158, -1098.87046193256, -833.1587463303338, -632.0939781608072, -948.7261828062784, -411.29698889650416, -530.6927024821208, -1214.7243714157037, -1074.139067879033, -528.9899227067851, -988.9020960670508, -719.6433395843279, -388.9322299096477, -820.8327534197936, -400.7058468534149, -634.1283830730185, -906.2414890880318, -789.2222494116701, -1194.2489210829724, -905.0221517999314, -884.0228955539504, -1264.1646550271707, -685.5106426325054, -731.0913720763233, -793.0830871313884, -721.9467646867286, -764.8925495331805, -1444.2384407393668, -1154.4296443994092, -977.5402259998923, -68.22421579045766, -1300.5139553658514, -661.5363788764688, -282.2568284553019, -124.28855075593466, -103.64540248621614, -164.35381241281902, -1096.1848157288296, -643.232170313699, -438.57839564358113, -252.04218781190437, -816.6481575646808, -931.4248153614263, -664.5065032582709, -339.556271707474, -807.7520027707249, -1065.7306504561027, -725.1126990972872, -702.241269851432, -225.21513008282935, -170.75902548749013, -833.9464074686279, -763.0802330960025, -1057.1170212269742, -1052.4741015727773, -945.3805056574565, -552.3583313469021]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5515887945873789, "mean_inference_ms": 1.6922772103346737, "mean_action_processing_ms": 0.28137043708387643, "mean_env_wait_ms": 3.0270784203584293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011987447738647461, "StateBufferConnector_ms": 0.008046388626098633, "ViewRequirementAgentConnector_ms": 0.20065546035766602}, "num_episodes": 30, "episode_return_max": -68.22421579045766, "episode_return_min": -1444.2384407393668, "episode_return_mean": -733.2004127400902, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.9615843044582, "num_env_steps_trained_throughput_per_sec": 293.9615843044582, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13370.365, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13370.281, "sample_time_ms": 1051.358, "learn_time_ms": 12248.008, "learn_throughput": 326.584, "synch_weights_time_ms": 70.11}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00017", "date": "2024-08-03_11-53-44", "timestamp": 1722666224, "time_this_iter_s": 13.619632244110107, "time_total_s": 186.94243359565735, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2443b9fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 186.94243359565735, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.839999999999998, "ram_util_percent": 27.879999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.709217110524575, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.527010555565358, "policy_loss": -0.01745933980225042, "vf_loss": 8.552957092225551, "vf_explained_var": 0.4481195848435163, "kl": 0.016880728089957605, "entropy": 1.6083510302007198, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -68.22421579045766, "episode_reward_min": -1444.2384407393668, "episode_reward_mean": -752.3175358920521, "episode_len_mean": 139.81, "episode_media": {}, "episodes_timesteps_total": 13981, "policy_reward_min": {"policy_0": -1444.2384407393668}, "policy_reward_max": {"policy_0": -68.22421579045766}, "policy_reward_mean": {"policy_0": -752.3175358920521}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1097.8959031007237, -534.6995930501895, -1020.23355911763, -421.4106207654129, -1358.9753495663751, -711.3743469210985, -942.0144412488563, -416.67842490986806, -467.427834824962, -604.4974147470667, -104.67527502387892, -552.698524323622, -982.7988065206757, -484.8768380762322, -815.872209188267, -1163.75841812444, -1048.6290650218093, -876.2090734046158, -1098.87046193256, -833.1587463303338, -632.0939781608072, -948.7261828062784, -411.29698889650416, -530.6927024821208, -1214.7243714157037, -1074.139067879033, -528.9899227067851, -988.9020960670508, -719.6433395843279, -388.9322299096477, -820.8327534197936, -400.7058468534149, -634.1283830730185, -906.2414890880318, -789.2222494116701, -1194.2489210829724, -905.0221517999314, -884.0228955539504, -1264.1646550271707, -685.5106426325054, -731.0913720763233, -793.0830871313884, -721.9467646867286, -764.8925495331805, -1444.2384407393668, -1154.4296443994092, -977.5402259998923, -68.22421579045766, -1300.5139553658514, -661.5363788764688, -282.2568284553019, -124.28855075593466, -103.64540248621614, -164.35381241281902, -1096.1848157288296, -643.232170313699, -438.57839564358113, -252.04218781190437, -816.6481575646808, -931.4248153614263, -664.5065032582709, -339.556271707474, -807.7520027707249, -1065.7306504561027, -725.1126990972872, -702.241269851432, -225.21513008282935, -170.75902548749013, -833.9464074686279, -763.0802330960025, -1057.1170212269742, -1052.4741015727773, -945.3805056574565, -552.3583313469021, -908.6932398449517, -174.73889741623157, -463.29077913355866, -604.2188824693834, -705.8920905562256, -747.0880977115745, -437.2444128387247, -540.785270625706, -1008.6458350143657, -493.07264065054073, -908.0293181767954, -769.5336684386095, -1434.9489479521317, -395.88911219832613, -931.3679984424572, -828.7360411130359, -635.4495241508271, -1171.1672480763307, -1349.9684259136216, -971.73426708869, -1114.4229946024623, -1282.881790985618, -727.628739640611, -564.4436228122304, -720.839146709791, -506.66489837925974], "episode_lengths": [150, 150, 150, 103, 150, 150, 150, 138, 143, 150, 66, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 105, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 82, 82, 52, 65, 150, 150, 150, 116, 150, 150, 150, 94, 150, 150, 150, 150, 78, 84, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1097.8959031007237, -534.6995930501895, -1020.23355911763, -421.4106207654129, -1358.9753495663751, -711.3743469210985, -942.0144412488563, -416.67842490986806, -467.427834824962, -604.4974147470667, -104.67527502387892, -552.698524323622, -982.7988065206757, -484.8768380762322, -815.872209188267, -1163.75841812444, -1048.6290650218093, -876.2090734046158, -1098.87046193256, -833.1587463303338, -632.0939781608072, -948.7261828062784, -411.29698889650416, -530.6927024821208, -1214.7243714157037, -1074.139067879033, -528.9899227067851, -988.9020960670508, -719.6433395843279, -388.9322299096477, -820.8327534197936, -400.7058468534149, -634.1283830730185, -906.2414890880318, -789.2222494116701, -1194.2489210829724, -905.0221517999314, -884.0228955539504, -1264.1646550271707, -685.5106426325054, -731.0913720763233, -793.0830871313884, -721.9467646867286, -764.8925495331805, -1444.2384407393668, -1154.4296443994092, -977.5402259998923, -68.22421579045766, -1300.5139553658514, -661.5363788764688, -282.2568284553019, -124.28855075593466, -103.64540248621614, -164.35381241281902, -1096.1848157288296, -643.232170313699, -438.57839564358113, -252.04218781190437, -816.6481575646808, -931.4248153614263, -664.5065032582709, -339.556271707474, -807.7520027707249, -1065.7306504561027, -725.1126990972872, -702.241269851432, -225.21513008282935, -170.75902548749013, -833.9464074686279, -763.0802330960025, -1057.1170212269742, -1052.4741015727773, -945.3805056574565, -552.3583313469021, -908.6932398449517, -174.73889741623157, -463.29077913355866, -604.2188824693834, -705.8920905562256, -747.0880977115745, -437.2444128387247, -540.785270625706, -1008.6458350143657, -493.07264065054073, -908.0293181767954, -769.5336684386095, -1434.9489479521317, -395.88911219832613, -931.3679984424572, -828.7360411130359, -635.4495241508271, -1171.1672480763307, -1349.9684259136216, -971.73426708869, -1114.4229946024623, -1282.881790985618, -727.628739640611, -564.4436228122304, -720.839146709791, -506.66489837925974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5521361813752607, "mean_inference_ms": 1.6940817706959583, "mean_action_processing_ms": 0.28132662339052616, "mean_env_wait_ms": 3.0341093264559196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012398958206176758, "StateBufferConnector_ms": 0.008024930953979492, "ViewRequirementAgentConnector_ms": 0.2006549835205078}, "num_episodes": 26, "episode_return_max": -68.22421579045766, "episode_return_min": -1444.2384407393668, "episode_return_mean": -752.3175358920521, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.39880700244726, "num_env_steps_trained_throughput_per_sec": 297.39880700244726, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13347.25, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13347.165, "sample_time_ms": 1059.217, "learn_time_ms": 12218.083, "learn_throughput": 327.384, "synch_weights_time_ms": 69.058}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00017", "date": "2024-08-03_11-53-57", "timestamp": 1722666237, "time_this_iter_s": 13.46247148513794, "time_total_s": 200.4049050807953, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2443ba440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 200.4049050807953, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 14.036842105263156, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.7309680412213, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.662202254931133, "policy_loss": -0.017227869766550916, "vf_loss": 8.686065029104551, "vf_explained_var": 0.561854237318039, "kl": 0.01626000924646481, "entropy": 1.3951916522035996, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -68.22421579045766, "episode_reward_min": -1457.3650618516328, "episode_reward_mean": -724.18450655749, "episode_len_mean": 138.02, "episode_media": {}, "episodes_timesteps_total": 13802, "policy_reward_min": {"policy_0": -1457.3650618516328}, "policy_reward_max": {"policy_0": -68.22421579045766}, "policy_reward_mean": {"policy_0": -724.18450655749}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-400.7058468534149, -634.1283830730185, -906.2414890880318, -789.2222494116701, -1194.2489210829724, -905.0221517999314, -884.0228955539504, -1264.1646550271707, -685.5106426325054, -731.0913720763233, -793.0830871313884, -721.9467646867286, -764.8925495331805, -1444.2384407393668, -1154.4296443994092, -977.5402259998923, -68.22421579045766, -1300.5139553658514, -661.5363788764688, -282.2568284553019, -124.28855075593466, -103.64540248621614, -164.35381241281902, -1096.1848157288296, -643.232170313699, -438.57839564358113, -252.04218781190437, -816.6481575646808, -931.4248153614263, -664.5065032582709, -339.556271707474, -807.7520027707249, -1065.7306504561027, -725.1126990972872, -702.241269851432, -225.21513008282935, -170.75902548749013, -833.9464074686279, -763.0802330960025, -1057.1170212269742, -1052.4741015727773, -945.3805056574565, -552.3583313469021, -908.6932398449517, -174.73889741623157, -463.29077913355866, -604.2188824693834, -705.8920905562256, -747.0880977115745, -437.2444128387247, -540.785270625706, -1008.6458350143657, -493.07264065054073, -908.0293181767954, -769.5336684386095, -1434.9489479521317, -395.88911219832613, -931.3679984424572, -828.7360411130359, -635.4495241508271, -1171.1672480763307, -1349.9684259136216, -971.73426708869, -1114.4229946024623, -1282.881790985618, -727.628739640611, -564.4436228122304, -720.839146709791, -506.66489837925974, -703.14174766692, -809.0178392734877, -357.1190609507022, -748.8669209487134, -1088.6416631276898, -1335.6690441518986, -588.7025888804706, -626.8561408102465, -778.9404566795687, -692.3272330603526, -1377.60516331635, -537.442112325121, -331.08797019051383, -164.8747673988121, -622.5746564002319, -655.3082196983833, -365.3068429364251, -166.0717489039655, -730.847806301367, -851.176848892437, -1114.1395766537662, -415.5826251125499, -675.3754138871566, -1457.3650618516328, -599.0817877988485, -949.60866641203, -675.5905131858598, -96.39789075248827, -98.60803938984519, -909.4007188936381, -459.69648021899155], "episode_lengths": [105, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 82, 82, 52, 65, 150, 150, 150, 116, 150, 150, 150, 94, 150, 150, 150, 150, 78, 84, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 100, 150, 150, 150, 64, 150, 150, 150, 140, 138, 150, 150, 150, 150, 92, 71, 150, 102], "policy_policy_0_reward": [-400.7058468534149, -634.1283830730185, -906.2414890880318, -789.2222494116701, -1194.2489210829724, -905.0221517999314, -884.0228955539504, -1264.1646550271707, -685.5106426325054, -731.0913720763233, -793.0830871313884, -721.9467646867286, -764.8925495331805, -1444.2384407393668, -1154.4296443994092, -977.5402259998923, -68.22421579045766, -1300.5139553658514, -661.5363788764688, -282.2568284553019, -124.28855075593466, -103.64540248621614, -164.35381241281902, -1096.1848157288296, -643.232170313699, -438.57839564358113, -252.04218781190437, -816.6481575646808, -931.4248153614263, -664.5065032582709, -339.556271707474, -807.7520027707249, -1065.7306504561027, -725.1126990972872, -702.241269851432, -225.21513008282935, -170.75902548749013, -833.9464074686279, -763.0802330960025, -1057.1170212269742, -1052.4741015727773, -945.3805056574565, -552.3583313469021, -908.6932398449517, -174.73889741623157, -463.29077913355866, -604.2188824693834, -705.8920905562256, -747.0880977115745, -437.2444128387247, -540.785270625706, -1008.6458350143657, -493.07264065054073, -908.0293181767954, -769.5336684386095, -1434.9489479521317, -395.88911219832613, -931.3679984424572, -828.7360411130359, -635.4495241508271, -1171.1672480763307, -1349.9684259136216, -971.73426708869, -1114.4229946024623, -1282.881790985618, -727.628739640611, -564.4436228122304, -720.839146709791, -506.66489837925974, -703.14174766692, -809.0178392734877, -357.1190609507022, -748.8669209487134, -1088.6416631276898, -1335.6690441518986, -588.7025888804706, -626.8561408102465, -778.9404566795687, -692.3272330603526, -1377.60516331635, -537.442112325121, -331.08797019051383, -164.8747673988121, -622.5746564002319, -655.3082196983833, -365.3068429364251, -166.0717489039655, -730.847806301367, -851.176848892437, -1114.1395766537662, -415.5826251125499, -675.3754138871566, -1457.3650618516328, -599.0817877988485, -949.60866641203, -675.5905131858598, -96.39789075248827, -98.60803938984519, -909.4007188936381, -459.69648021899155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523753383887275, "mean_inference_ms": 1.694791040763437, "mean_action_processing_ms": 0.2812732264027463, "mean_env_wait_ms": 3.0403447286077796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012622594833374023, "StateBufferConnector_ms": 0.008131265640258789, "ViewRequirementAgentConnector_ms": 0.20363140106201172}, "num_episodes": 31, "episode_return_max": -68.22421579045766, "episode_return_min": -1457.3650618516328, "episode_return_mean": -724.18450655749, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.309396161948, "num_env_steps_trained_throughput_per_sec": 305.309396161948, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13318.751, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13318.668, "sample_time_ms": 1052.935, "learn_time_ms": 12195.018, "learn_throughput": 328.003, "synch_weights_time_ms": 69.889}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00017", "date": "2024-08-03_11-54-10", "timestamp": 1722666250, "time_this_iter_s": 13.11417531967163, "time_total_s": 213.51908040046692, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433cb80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 213.51908040046692, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.81578947368421, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.921714296440282, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.089584912359715, "policy_loss": -0.013333574266774425, "vf_loss": 8.107528225084145, "vf_explained_var": 0.6640196179350217, "kl": 0.01592143281050086, "entropy": 1.1774389192461967, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -16.491076197171864, "episode_reward_min": -1457.3650618516328, "episode_reward_mean": -668.123345197209, "episode_len_mean": 134.54, "episode_media": {}, "episodes_timesteps_total": 13454, "policy_reward_min": {"policy_0": -1457.3650618516328}, "policy_reward_max": {"policy_0": -16.491076197171864}, "policy_reward_mean": {"policy_0": -668.123345197209}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1065.7306504561027, -725.1126990972872, -702.241269851432, -225.21513008282935, -170.75902548749013, -833.9464074686279, -763.0802330960025, -1057.1170212269742, -1052.4741015727773, -945.3805056574565, -552.3583313469021, -908.6932398449517, -174.73889741623157, -463.29077913355866, -604.2188824693834, -705.8920905562256, -747.0880977115745, -437.2444128387247, -540.785270625706, -1008.6458350143657, -493.07264065054073, -908.0293181767954, -769.5336684386095, -1434.9489479521317, -395.88911219832613, -931.3679984424572, -828.7360411130359, -635.4495241508271, -1171.1672480763307, -1349.9684259136216, -971.73426708869, -1114.4229946024623, -1282.881790985618, -727.628739640611, -564.4436228122304, -720.839146709791, -506.66489837925974, -703.14174766692, -809.0178392734877, -357.1190609507022, -748.8669209487134, -1088.6416631276898, -1335.6690441518986, -588.7025888804706, -626.8561408102465, -778.9404566795687, -692.3272330603526, -1377.60516331635, -537.442112325121, -331.08797019051383, -164.8747673988121, -622.5746564002319, -655.3082196983833, -365.3068429364251, -166.0717489039655, -730.847806301367, -851.176848892437, -1114.1395766537662, -415.5826251125499, -675.3754138871566, -1457.3650618516328, -599.0817877988485, -949.60866641203, -675.5905131858598, -96.39789075248827, -98.60803938984519, -909.4007188936381, -459.69648021899155, -880.5336930217169, -1160.7031678828432, -1359.0306175957676, -614.4342291893124, -25.665601597608845, -739.7061021547809, -178.36952439369534, -467.5448020036221, -1297.431759992517, -530.0153779399483, -889.9999303606475, -26.027443451305718, -35.44990149002707, -509.5390174853371, -134.14998624806054, -402.63418084770325, -426.877265939608, -404.77808200989415, -939.0614459467253, -718.6829916338022, -863.9082648841668, -786.4861510828327, -16.491076197171864, -94.57447442778079, -49.87759201212039, -582.9153875047398, -44.65030786299836, -1393.8046381169909, -192.19296463198168, -643.6677691002992, -376.8546806517721, -553.0592197067207], "episode_lengths": [150, 150, 150, 78, 84, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 100, 150, 150, 150, 64, 150, 150, 150, 140, 138, 150, 150, 150, 150, 92, 71, 150, 102, 150, 150, 150, 150, 52, 150, 76, 150, 150, 148, 150, 49, 61, 113, 68, 138, 150, 150, 150, 150, 150, 150, 52, 81, 58, 135, 72, 150, 90, 150, 150, 150], "policy_policy_0_reward": [-1065.7306504561027, -725.1126990972872, -702.241269851432, -225.21513008282935, -170.75902548749013, -833.9464074686279, -763.0802330960025, -1057.1170212269742, -1052.4741015727773, -945.3805056574565, -552.3583313469021, -908.6932398449517, -174.73889741623157, -463.29077913355866, -604.2188824693834, -705.8920905562256, -747.0880977115745, -437.2444128387247, -540.785270625706, -1008.6458350143657, -493.07264065054073, -908.0293181767954, -769.5336684386095, -1434.9489479521317, -395.88911219832613, -931.3679984424572, -828.7360411130359, -635.4495241508271, -1171.1672480763307, -1349.9684259136216, -971.73426708869, -1114.4229946024623, -1282.881790985618, -727.628739640611, -564.4436228122304, -720.839146709791, -506.66489837925974, -703.14174766692, -809.0178392734877, -357.1190609507022, -748.8669209487134, -1088.6416631276898, -1335.6690441518986, -588.7025888804706, -626.8561408102465, -778.9404566795687, -692.3272330603526, -1377.60516331635, -537.442112325121, -331.08797019051383, -164.8747673988121, -622.5746564002319, -655.3082196983833, -365.3068429364251, -166.0717489039655, -730.847806301367, -851.176848892437, -1114.1395766537662, -415.5826251125499, -675.3754138871566, -1457.3650618516328, -599.0817877988485, -949.60866641203, -675.5905131858598, -96.39789075248827, -98.60803938984519, -909.4007188936381, -459.69648021899155, -880.5336930217169, -1160.7031678828432, -1359.0306175957676, -614.4342291893124, -25.665601597608845, -739.7061021547809, -178.36952439369534, -467.5448020036221, -1297.431759992517, -530.0153779399483, -889.9999303606475, -26.027443451305718, -35.44990149002707, -509.5390174853371, -134.14998624806054, -402.63418084770325, -426.877265939608, -404.77808200989415, -939.0614459467253, -718.6829916338022, -863.9082648841668, -786.4861510828327, -16.491076197171864, -94.57447442778079, -49.87759201212039, -582.9153875047398, -44.65030786299836, -1393.8046381169909, -192.19296463198168, -643.6677691002992, -376.8546806517721, -553.0592197067207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525652549890168, "mean_inference_ms": 1.69571933912843, "mean_action_processing_ms": 0.2812539180710441, "mean_env_wait_ms": 3.0433112429683664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012303352355957031, "StateBufferConnector_ms": 0.008028507232666016, "ViewRequirementAgentConnector_ms": 0.19949984550476074}, "num_episodes": 32, "episode_return_max": -16.491076197171864, "episode_return_min": -1457.3650618516328, "episode_return_mean": -668.123345197209, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.4323891510636, "num_env_steps_trained_throughput_per_sec": 295.4323891510636, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13420.252, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13420.168, "sample_time_ms": 1053.883, "learn_time_ms": 12296.126, "learn_throughput": 325.306, "synch_weights_time_ms": 69.336}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00017", "date": "2024-08-03_11-54-24", "timestamp": 1722666264, "time_this_iter_s": 13.552968978881836, "time_total_s": 227.07204937934875, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a7ab11ce50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 227.07204937934875, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.910526315789474, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.710484265039366, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.522476277748744, "policy_loss": -0.006220821382400269, "vf_loss": 8.5396740163366, "vf_explained_var": 0.5589646389087041, "kl": 0.013193111552148694, "entropy": 1.6913821147133907, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -16.491076197171864, "episode_reward_min": -1457.3650618516328, "episode_reward_mean": -653.6917699904551, "episode_len_mean": 132.96, "episode_media": {}, "episodes_timesteps_total": 13296, "policy_reward_min": {"policy_0": -1457.3650618516328}, "policy_reward_max": {"policy_0": -16.491076197171864}, "policy_reward_mean": {"policy_0": -653.6917699904551}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1349.9684259136216, -971.73426708869, -1114.4229946024623, -1282.881790985618, -727.628739640611, -564.4436228122304, -720.839146709791, -506.66489837925974, -703.14174766692, -809.0178392734877, -357.1190609507022, -748.8669209487134, -1088.6416631276898, -1335.6690441518986, -588.7025888804706, -626.8561408102465, -778.9404566795687, -692.3272330603526, -1377.60516331635, -537.442112325121, -331.08797019051383, -164.8747673988121, -622.5746564002319, -655.3082196983833, -365.3068429364251, -166.0717489039655, -730.847806301367, -851.176848892437, -1114.1395766537662, -415.5826251125499, -675.3754138871566, -1457.3650618516328, -599.0817877988485, -949.60866641203, -675.5905131858598, -96.39789075248827, -98.60803938984519, -909.4007188936381, -459.69648021899155, -880.5336930217169, -1160.7031678828432, -1359.0306175957676, -614.4342291893124, -25.665601597608845, -739.7061021547809, -178.36952439369534, -467.5448020036221, -1297.431759992517, -530.0153779399483, -889.9999303606475, -26.027443451305718, -35.44990149002707, -509.5390174853371, -134.14998624806054, -402.63418084770325, -426.877265939608, -404.77808200989415, -939.0614459467253, -718.6829916338022, -863.9082648841668, -786.4861510828327, -16.491076197171864, -94.57447442778079, -49.87759201212039, -582.9153875047398, -44.65030786299836, -1393.8046381169909, -192.19296463198168, -643.6677691002992, -376.8546806517721, -553.0592197067207, -1151.301404898884, -349.7276366277572, -575.191179632481, -458.53932810200064, -324.2605540756916, -1120.3268261015942, -425.5092955672909, -715.725612268095, -737.2979670876487, -929.0044673878136, -846.7779258066913, -1108.2401431858696, -81.36758337936298, -1072.3391413680195, -1198.016200312208, -785.4102617551019, -648.3669912458084, -573.873250388426, -498.62341458287693, -522.1675367486106, -569.9764058599387, -186.44213128390345, -948.2610653985299, -640.9240330005862, -535.6633508608384, -334.04532435687, -1372.2220137163765, -1056.8208024224975, -42.62801205650194], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 100, 150, 150, 150, 64, 150, 150, 150, 140, 138, 150, 150, 150, 150, 92, 71, 150, 102, 150, 150, 150, 150, 52, 150, 76, 150, 150, 148, 150, 49, 61, 113, 68, 138, 150, 150, 150, 150, 150, 150, 52, 81, 58, 135, 72, 150, 90, 150, 150, 150, 150, 120, 150, 150, 100, 150, 150, 150, 132, 150, 150, 150, 60, 150, 150, 150, 150, 130, 150, 150, 150, 101, 150, 150, 140, 100, 150, 150, 56], "policy_policy_0_reward": [-1349.9684259136216, -971.73426708869, -1114.4229946024623, -1282.881790985618, -727.628739640611, -564.4436228122304, -720.839146709791, -506.66489837925974, -703.14174766692, -809.0178392734877, -357.1190609507022, -748.8669209487134, -1088.6416631276898, -1335.6690441518986, -588.7025888804706, -626.8561408102465, -778.9404566795687, -692.3272330603526, -1377.60516331635, -537.442112325121, -331.08797019051383, -164.8747673988121, -622.5746564002319, -655.3082196983833, -365.3068429364251, -166.0717489039655, -730.847806301367, -851.176848892437, -1114.1395766537662, -415.5826251125499, -675.3754138871566, -1457.3650618516328, -599.0817877988485, -949.60866641203, -675.5905131858598, -96.39789075248827, -98.60803938984519, -909.4007188936381, -459.69648021899155, -880.5336930217169, -1160.7031678828432, -1359.0306175957676, -614.4342291893124, -25.665601597608845, -739.7061021547809, -178.36952439369534, -467.5448020036221, -1297.431759992517, -530.0153779399483, -889.9999303606475, -26.027443451305718, -35.44990149002707, -509.5390174853371, -134.14998624806054, -402.63418084770325, -426.877265939608, -404.77808200989415, -939.0614459467253, -718.6829916338022, -863.9082648841668, -786.4861510828327, -16.491076197171864, -94.57447442778079, -49.87759201212039, -582.9153875047398, -44.65030786299836, -1393.8046381169909, -192.19296463198168, -643.6677691002992, -376.8546806517721, -553.0592197067207, -1151.301404898884, -349.7276366277572, -575.191179632481, -458.53932810200064, -324.2605540756916, -1120.3268261015942, -425.5092955672909, -715.725612268095, -737.2979670876487, -929.0044673878136, -846.7779258066913, -1108.2401431858696, -81.36758337936298, -1072.3391413680195, -1198.016200312208, -785.4102617551019, -648.3669912458084, -573.873250388426, -498.62341458287693, -522.1675367486106, -569.9764058599387, -186.44213128390345, -948.2610653985299, -640.9240330005862, -535.6633508608384, -334.04532435687, -1372.2220137163765, -1056.8208024224975, -42.62801205650194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552282425541168, "mean_inference_ms": 1.6954766898737212, "mean_action_processing_ms": 0.28085802362001006, "mean_env_wait_ms": 3.046535821135182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012004852294921875, "StateBufferConnector_ms": 0.008002042770385742, "ViewRequirementAgentConnector_ms": 0.1961057186126709}, "num_episodes": 29, "episode_return_max": -16.491076197171864, "episode_return_min": -1457.3650618516328, "episode_return_mean": -653.6917699904551, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.73311992258, "num_env_steps_trained_throughput_per_sec": 292.73311992258, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13439.824, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13439.742, "sample_time_ms": 1054.064, "learn_time_ms": 12314.933, "learn_throughput": 324.809, "synch_weights_time_ms": 69.91}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00017", "date": "2024-08-03_11-54-38", "timestamp": 1722666278, "time_this_iter_s": 13.676630020141602, "time_total_s": 240.74867939949036, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a24433db40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 240.74867939949036, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.360000000000003, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.781541522095601, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.808528832594554, "policy_loss": -0.008164075697034907, "vf_loss": 8.828049186865488, "vf_explained_var": 0.6052946746970217, "kl": 0.015224249130672756, "entropy": 1.8207217253744603, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -16.491076197171864, "episode_reward_min": -1457.3650618516328, "episode_reward_mean": -660.401729619371, "episode_len_mean": 131.33, "episode_media": {}, "episodes_timesteps_total": 13133, "policy_reward_min": {"policy_0": -1457.3650618516328}, "policy_reward_max": {"policy_0": -16.491076197171864}, "policy_reward_mean": {"policy_0": -660.401729619371}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-415.5826251125499, -675.3754138871566, -1457.3650618516328, -599.0817877988485, -949.60866641203, -675.5905131858598, -96.39789075248827, -98.60803938984519, -909.4007188936381, -459.69648021899155, -880.5336930217169, -1160.7031678828432, -1359.0306175957676, -614.4342291893124, -25.665601597608845, -739.7061021547809, -178.36952439369534, -467.5448020036221, -1297.431759992517, -530.0153779399483, -889.9999303606475, -26.027443451305718, -35.44990149002707, -509.5390174853371, -134.14998624806054, -402.63418084770325, -426.877265939608, -404.77808200989415, -939.0614459467253, -718.6829916338022, -863.9082648841668, -786.4861510828327, -16.491076197171864, -94.57447442778079, -49.87759201212039, -582.9153875047398, -44.65030786299836, -1393.8046381169909, -192.19296463198168, -643.6677691002992, -376.8546806517721, -553.0592197067207, -1151.301404898884, -349.7276366277572, -575.191179632481, -458.53932810200064, -324.2605540756916, -1120.3268261015942, -425.5092955672909, -715.725612268095, -737.2979670876487, -929.0044673878136, -846.7779258066913, -1108.2401431858696, -81.36758337936298, -1072.3391413680195, -1198.016200312208, -785.4102617551019, -648.3669912458084, -573.873250388426, -498.62341458287693, -522.1675367486106, -569.9764058599387, -186.44213128390345, -948.2610653985299, -640.9240330005862, -535.6633508608384, -334.04532435687, -1372.2220137163765, -1056.8208024224975, -42.62801205650194, -774.3469516723148, -37.94792203703224, -971.8062083816428, -435.75780212326396, -187.5063177974388, -1095.4621806555865, -873.4756389222887, -733.9046888322066, -736.392204505191, -1386.0010540262047, -854.9007086208131, -614.2157755907788, -114.39701915030736, -759.86371347534, -449.09149687114297, -1364.9207383501996, -1171.0702685906317, -1042.1469546416733, -1320.7457140310808, -843.6734526151267, -1374.2815261424435, -798.3694492361972, -575.926858495437, -773.9255861045244, -524.6709189783468, -699.859929674481, -844.6134294405927, -264.37251548101887, -931.6512331479896], "episode_lengths": [140, 138, 150, 150, 150, 150, 92, 71, 150, 102, 150, 150, 150, 150, 52, 150, 76, 150, 150, 148, 150, 49, 61, 113, 68, 138, 150, 150, 150, 150, 150, 150, 52, 81, 58, 135, 72, 150, 90, 150, 150, 150, 150, 120, 150, 150, 100, 150, 150, 150, 132, 150, 150, 150, 60, 150, 150, 150, 150, 130, 150, 150, 150, 101, 150, 150, 140, 100, 150, 150, 56, 150, 58, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 136, 150, 95, 150], "policy_policy_0_reward": [-415.5826251125499, -675.3754138871566, -1457.3650618516328, -599.0817877988485, -949.60866641203, -675.5905131858598, -96.39789075248827, -98.60803938984519, -909.4007188936381, -459.69648021899155, -880.5336930217169, -1160.7031678828432, -1359.0306175957676, -614.4342291893124, -25.665601597608845, -739.7061021547809, -178.36952439369534, -467.5448020036221, -1297.431759992517, -530.0153779399483, -889.9999303606475, -26.027443451305718, -35.44990149002707, -509.5390174853371, -134.14998624806054, -402.63418084770325, -426.877265939608, -404.77808200989415, -939.0614459467253, -718.6829916338022, -863.9082648841668, -786.4861510828327, -16.491076197171864, -94.57447442778079, -49.87759201212039, -582.9153875047398, -44.65030786299836, -1393.8046381169909, -192.19296463198168, -643.6677691002992, -376.8546806517721, -553.0592197067207, -1151.301404898884, -349.7276366277572, -575.191179632481, -458.53932810200064, -324.2605540756916, -1120.3268261015942, -425.5092955672909, -715.725612268095, -737.2979670876487, -929.0044673878136, -846.7779258066913, -1108.2401431858696, -81.36758337936298, -1072.3391413680195, -1198.016200312208, -785.4102617551019, -648.3669912458084, -573.873250388426, -498.62341458287693, -522.1675367486106, -569.9764058599387, -186.44213128390345, -948.2610653985299, -640.9240330005862, -535.6633508608384, -334.04532435687, -1372.2220137163765, -1056.8208024224975, -42.62801205650194, -774.3469516723148, -37.94792203703224, -971.8062083816428, -435.75780212326396, -187.5063177974388, -1095.4621806555865, -873.4756389222887, -733.9046888322066, -736.392204505191, -1386.0010540262047, -854.9007086208131, -614.2157755907788, -114.39701915030736, -759.86371347534, -449.09149687114297, -1364.9207383501996, -1171.0702685906317, -1042.1469546416733, -1320.7457140310808, -843.6734526151267, -1374.2815261424435, -798.3694492361972, -575.926858495437, -773.9255861045244, -524.6709189783468, -699.859929674481, -844.6134294405927, -264.37251548101887, -931.6512331479896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5517181074441104, "mean_inference_ms": 1.6929738205935032, "mean_action_processing_ms": 0.28050044614411473, "mean_env_wait_ms": 3.0465846025486445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011619806289672852, "StateBufferConnector_ms": 0.007927179336547852, "ViewRequirementAgentConnector_ms": 0.19377684593200684}, "num_episodes": 29, "episode_return_max": -16.491076197171864, "episode_return_min": -1457.3650618516328, "episode_return_mean": -660.401729619371, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.42380553375966, "num_env_steps_trained_throughput_per_sec": 306.42380553375966, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13420.095, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13420.012, "sample_time_ms": 1054.448, "learn_time_ms": 12295.142, "learn_throughput": 325.332, "synch_weights_time_ms": 69.584}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00017", "date": "2024-08-03_11-54-51", "timestamp": 1722666291, "time_this_iter_s": 13.065901279449463, "time_total_s": 253.81458067893982, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2443b9fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 253.81458067893982, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 14.127777777777778, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.55113151371479, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.330728006362914, "policy_loss": -0.008110366114609253, "vf_loss": 8.348056822518508, "vf_explained_var": 0.7166924989471833, "kl": 0.013931466622731628, "entropy": 1.5487599824865659, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -16.491076197171864, "episode_reward_min": -1393.8046381169909, "episode_reward_mean": -685.1958081405123, "episode_len_mean": 132.6, "episode_media": {}, "episodes_timesteps_total": 13260, "policy_reward_min": {"policy_0": -1393.8046381169909}, "policy_reward_max": {"policy_0": -16.491076197171864}, "policy_reward_mean": {"policy_0": -685.1958081405123}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-786.4861510828327, -16.491076197171864, -94.57447442778079, -49.87759201212039, -582.9153875047398, -44.65030786299836, -1393.8046381169909, -192.19296463198168, -643.6677691002992, -376.8546806517721, -553.0592197067207, -1151.301404898884, -349.7276366277572, -575.191179632481, -458.53932810200064, -324.2605540756916, -1120.3268261015942, -425.5092955672909, -715.725612268095, -737.2979670876487, -929.0044673878136, -846.7779258066913, -1108.2401431858696, -81.36758337936298, -1072.3391413680195, -1198.016200312208, -785.4102617551019, -648.3669912458084, -573.873250388426, -498.62341458287693, -522.1675367486106, -569.9764058599387, -186.44213128390345, -948.2610653985299, -640.9240330005862, -535.6633508608384, -334.04532435687, -1372.2220137163765, -1056.8208024224975, -42.62801205650194, -774.3469516723148, -37.94792203703224, -971.8062083816428, -435.75780212326396, -187.5063177974388, -1095.4621806555865, -873.4756389222887, -733.9046888322066, -736.392204505191, -1386.0010540262047, -854.9007086208131, -614.2157755907788, -114.39701915030736, -759.86371347534, -449.09149687114297, -1364.9207383501996, -1171.0702685906317, -1042.1469546416733, -1320.7457140310808, -843.6734526151267, -1374.2815261424435, -798.3694492361972, -575.926858495437, -773.9255861045244, -524.6709189783468, -699.859929674481, -844.6134294405927, -264.37251548101887, -931.6512331479896, -1289.774731497093, -702.0728369073042, -58.24537652131503, -300.13296010494975, -360.33385377506573, -246.49947034623307, -1232.490735473314, -380.07978211846626, -486.7271515264547, -914.9440650323476, -924.5979395901884, -387.1043141376115, -982.6101135417724, -1027.8720830705938, -1152.446219285638, -37.4487236528267, -93.0003171459916, -1238.3801677446534, -108.79140698608036, -1385.967725188565, -1054.7583503952087, -1132.350338991257, -1303.9777034420192, -957.8480407244078, -1308.1250980485784, -405.88196477329564, -1003.5781682833097, -46.05871602958686, -344.93797777770465, -440.7416254055713, -112.88047816885353], "episode_lengths": [150, 52, 81, 58, 135, 72, 150, 90, 150, 150, 150, 150, 120, 150, 150, 100, 150, 150, 150, 132, 150, 150, 150, 60, 150, 150, 150, 150, 130, 150, 150, 150, 101, 150, 150, 140, 100, 150, 150, 56, 150, 58, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 136, 150, 95, 150, 150, 150, 68, 150, 109, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 92, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 49], "policy_policy_0_reward": [-786.4861510828327, -16.491076197171864, -94.57447442778079, -49.87759201212039, -582.9153875047398, -44.65030786299836, -1393.8046381169909, -192.19296463198168, -643.6677691002992, -376.8546806517721, -553.0592197067207, -1151.301404898884, -349.7276366277572, -575.191179632481, -458.53932810200064, -324.2605540756916, -1120.3268261015942, -425.5092955672909, -715.725612268095, -737.2979670876487, -929.0044673878136, -846.7779258066913, -1108.2401431858696, -81.36758337936298, -1072.3391413680195, -1198.016200312208, -785.4102617551019, -648.3669912458084, -573.873250388426, -498.62341458287693, -522.1675367486106, -569.9764058599387, -186.44213128390345, -948.2610653985299, -640.9240330005862, -535.6633508608384, -334.04532435687, -1372.2220137163765, -1056.8208024224975, -42.62801205650194, -774.3469516723148, -37.94792203703224, -971.8062083816428, -435.75780212326396, -187.5063177974388, -1095.4621806555865, -873.4756389222887, -733.9046888322066, -736.392204505191, -1386.0010540262047, -854.9007086208131, -614.2157755907788, -114.39701915030736, -759.86371347534, -449.09149687114297, -1364.9207383501996, -1171.0702685906317, -1042.1469546416733, -1320.7457140310808, -843.6734526151267, -1374.2815261424435, -798.3694492361972, -575.926858495437, -773.9255861045244, -524.6709189783468, -699.859929674481, -844.6134294405927, -264.37251548101887, -931.6512331479896, -1289.774731497093, -702.0728369073042, -58.24537652131503, -300.13296010494975, -360.33385377506573, -246.49947034623307, -1232.490735473314, -380.07978211846626, -486.7271515264547, -914.9440650323476, -924.5979395901884, -387.1043141376115, -982.6101135417724, -1027.8720830705938, -1152.446219285638, -37.4487236528267, -93.0003171459916, -1238.3801677446534, -108.79140698608036, -1385.967725188565, -1054.7583503952087, -1132.350338991257, -1303.9777034420192, -957.8480407244078, -1308.1250980485784, -405.88196477329564, -1003.5781682833097, -46.05871602958686, -344.93797777770465, -440.7416254055713, -112.88047816885353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5514437642719235, "mean_inference_ms": 1.6899763198173756, "mean_action_processing_ms": 0.27995507965519745, "mean_env_wait_ms": 3.046084702203961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011606931686401367, "StateBufferConnector_ms": 0.007865428924560547, "ViewRequirementAgentConnector_ms": 0.19179105758666992}, "num_episodes": 31, "episode_return_max": -16.491076197171864, "episode_return_min": -1393.8046381169909, "episode_return_mean": -685.1958081405123, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.28027641837167, "num_env_steps_trained_throughput_per_sec": 329.28027641837167, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13296.67, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13296.589, "sample_time_ms": 1054.191, "learn_time_ms": 12173.027, "learn_throughput": 328.595, "synch_weights_time_ms": 68.549}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00017", "date": "2024-08-03_11-55-03", "timestamp": 1722666303, "time_this_iter_s": 12.15992522239685, "time_total_s": 265.97450590133667, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2443bb640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 265.97450590133667, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 14.166666666666666, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.99285449360808, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.15199856410424, "policy_loss": -0.009733234035472075, "vf_loss": 8.169793026149273, "vf_explained_var": 0.7713782325387001, "kl": 0.015917732750191763, "entropy": 1.5224182289093733, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -37.4487236528267, "episode_reward_min": -1386.0010540262047, "episode_reward_mean": -706.9363539651687, "episode_len_mean": 133.44, "episode_media": {}, "episodes_timesteps_total": 13344, "policy_reward_min": {"policy_0": -1386.0010540262047}, "policy_reward_max": {"policy_0": -37.4487236528267}, "policy_reward_mean": {"policy_0": -706.9363539651687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-573.873250388426, -498.62341458287693, -522.1675367486106, -569.9764058599387, -186.44213128390345, -948.2610653985299, -640.9240330005862, -535.6633508608384, -334.04532435687, -1372.2220137163765, -1056.8208024224975, -42.62801205650194, -774.3469516723148, -37.94792203703224, -971.8062083816428, -435.75780212326396, -187.5063177974388, -1095.4621806555865, -873.4756389222887, -733.9046888322066, -736.392204505191, -1386.0010540262047, -854.9007086208131, -614.2157755907788, -114.39701915030736, -759.86371347534, -449.09149687114297, -1364.9207383501996, -1171.0702685906317, -1042.1469546416733, -1320.7457140310808, -843.6734526151267, -1374.2815261424435, -798.3694492361972, -575.926858495437, -773.9255861045244, -524.6709189783468, -699.859929674481, -844.6134294405927, -264.37251548101887, -931.6512331479896, -1289.774731497093, -702.0728369073042, -58.24537652131503, -300.13296010494975, -360.33385377506573, -246.49947034623307, -1232.490735473314, -380.07978211846626, -486.7271515264547, -914.9440650323476, -924.5979395901884, -387.1043141376115, -982.6101135417724, -1027.8720830705938, -1152.446219285638, -37.4487236528267, -93.0003171459916, -1238.3801677446534, -108.79140698608036, -1385.967725188565, -1054.7583503952087, -1132.350338991257, -1303.9777034420192, -957.8480407244078, -1308.1250980485784, -405.88196477329564, -1003.5781682833097, -46.05871602958686, -344.93797777770465, -440.7416254055713, -112.88047816885353, -872.1927088484134, -974.8164301680603, -1107.8284075121708, -1102.989443021041, -199.85920017674349, -1110.9760862792475, -967.7591232603552, -675.6554117510497, -1009.3790390717543, -705.7245006624678, -131.34707328666457, -1141.537385729621, -1109.8281776354913, -708.318729475051, -98.14419363093532, -1274.0331604577448, -1062.8097387632606, -581.1883825049757, -543.6709097578189, -407.48695440421625, -362.08650310334633, -851.8165156032358, -433.3169922316122, -464.60101131825553, -103.77724714444075, -1074.3186656856126, -220.89066897713957, -139.67870210263024], "episode_lengths": [130, 150, 150, 150, 101, 150, 150, 140, 100, 150, 150, 56, 150, 58, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 136, 150, 95, 150, 150, 150, 68, 150, 109, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 92, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 49, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 57, 150, 150, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 74, 51], "policy_policy_0_reward": [-573.873250388426, -498.62341458287693, -522.1675367486106, -569.9764058599387, -186.44213128390345, -948.2610653985299, -640.9240330005862, -535.6633508608384, -334.04532435687, -1372.2220137163765, -1056.8208024224975, -42.62801205650194, -774.3469516723148, -37.94792203703224, -971.8062083816428, -435.75780212326396, -187.5063177974388, -1095.4621806555865, -873.4756389222887, -733.9046888322066, -736.392204505191, -1386.0010540262047, -854.9007086208131, -614.2157755907788, -114.39701915030736, -759.86371347534, -449.09149687114297, -1364.9207383501996, -1171.0702685906317, -1042.1469546416733, -1320.7457140310808, -843.6734526151267, -1374.2815261424435, -798.3694492361972, -575.926858495437, -773.9255861045244, -524.6709189783468, -699.859929674481, -844.6134294405927, -264.37251548101887, -931.6512331479896, -1289.774731497093, -702.0728369073042, -58.24537652131503, -300.13296010494975, -360.33385377506573, -246.49947034623307, -1232.490735473314, -380.07978211846626, -486.7271515264547, -914.9440650323476, -924.5979395901884, -387.1043141376115, -982.6101135417724, -1027.8720830705938, -1152.446219285638, -37.4487236528267, -93.0003171459916, -1238.3801677446534, -108.79140698608036, -1385.967725188565, -1054.7583503952087, -1132.350338991257, -1303.9777034420192, -957.8480407244078, -1308.1250980485784, -405.88196477329564, -1003.5781682833097, -46.05871602958686, -344.93797777770465, -440.7416254055713, -112.88047816885353, -872.1927088484134, -974.8164301680603, -1107.8284075121708, -1102.989443021041, -199.85920017674349, -1110.9760862792475, -967.7591232603552, -675.6554117510497, -1009.3790390717543, -705.7245006624678, -131.34707328666457, -1141.537385729621, -1109.8281776354913, -708.318729475051, -98.14419363093532, -1274.0331604577448, -1062.8097387632606, -581.1883825049757, -543.6709097578189, -407.48695440421625, -362.08650310334633, -851.8165156032358, -433.3169922316122, -464.60101131825553, -103.77724714444075, -1074.3186656856126, -220.89066897713957, -139.67870210263024]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5511683980840641, "mean_inference_ms": 1.6873703463807905, "mean_action_processing_ms": 0.27967796448826077, "mean_env_wait_ms": 3.0472504265171496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011431694030761719, "StateBufferConnector_ms": 0.007928609848022461, "ViewRequirementAgentConnector_ms": 0.19091057777404785}, "num_episodes": 28, "episode_return_max": -37.4487236528267, "episode_return_min": -1386.0010540262047, "episode_return_mean": -706.9363539651687, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.3445316420724, "num_env_steps_trained_throughput_per_sec": 304.3445316420724, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13267.42, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13267.339, "sample_time_ms": 1052.056, "learn_time_ms": 12145.785, "learn_throughput": 329.332, "synch_weights_time_ms": 68.665}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00017", "date": "2024-08-03_11-55-16", "timestamp": 1722666316, "time_this_iter_s": 13.156010389328003, "time_total_s": 279.1305162906647, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2443bb250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 279.1305162906647, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.894444444444447, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.551625198622546, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.350878524283567, "policy_loss": -0.017072204956881856, "vf_loss": 8.377812734742959, "vf_explained_var": 0.72767103848358, "kl": 0.01792893567411132, "entropy": 1.793002337962389, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -15.663998556159997, "episode_reward_min": -1385.967725188565, "episode_reward_mean": -691.6732524067064, "episode_len_mean": 133.28, "episode_media": {}, "episodes_timesteps_total": 13328, "policy_reward_min": {"policy_0": -1385.967725188565}, "policy_reward_max": {"policy_0": -15.663998556159997}, "policy_reward_mean": {"policy_0": -691.6732524067064}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1374.2815261424435, -798.3694492361972, -575.926858495437, -773.9255861045244, -524.6709189783468, -699.859929674481, -844.6134294405927, -264.37251548101887, -931.6512331479896, -1289.774731497093, -702.0728369073042, -58.24537652131503, -300.13296010494975, -360.33385377506573, -246.49947034623307, -1232.490735473314, -380.07978211846626, -486.7271515264547, -914.9440650323476, -924.5979395901884, -387.1043141376115, -982.6101135417724, -1027.8720830705938, -1152.446219285638, -37.4487236528267, -93.0003171459916, -1238.3801677446534, -108.79140698608036, -1385.967725188565, -1054.7583503952087, -1132.350338991257, -1303.9777034420192, -957.8480407244078, -1308.1250980485784, -405.88196477329564, -1003.5781682833097, -46.05871602958686, -344.93797777770465, -440.7416254055713, -112.88047816885353, -872.1927088484134, -974.8164301680603, -1107.8284075121708, -1102.989443021041, -199.85920017674349, -1110.9760862792475, -967.7591232603552, -675.6554117510497, -1009.3790390717543, -705.7245006624678, -131.34707328666457, -1141.537385729621, -1109.8281776354913, -708.318729475051, -98.14419363093532, -1274.0331604577448, -1062.8097387632606, -581.1883825049757, -543.6709097578189, -407.48695440421625, -362.08650310334633, -851.8165156032358, -433.3169922316122, -464.60101131825553, -103.77724714444075, -1074.3186656856126, -220.89066897713957, -139.67870210263024, -1026.3271474178575, -713.1690841187202, -1275.5017219891038, -135.97399803063476, -244.03714401711383, -774.133005283554, -359.3051425938942, -923.4765767869269, -1051.1545006658832, -387.48848993279023, -919.503346545631, -1085.7844720479272, -547.1938987662712, -891.1456280539007, -746.1317363446288, -450.2382377661301, -459.064655872731, -27.472873687627704, -566.6013666176548, -812.6318175389752, -917.9426705945767, -968.9423583368902, -581.2565597830909, -631.4403832373287, -104.52351033965716, -15.663998556159997, -1285.4473632422255, -649.4286052738723, -608.8946456275963, -883.526396655, -260.44237992815573, -1219.1202800674996], "episode_lengths": [150, 150, 150, 150, 114, 136, 150, 95, 150, 150, 150, 68, 150, 109, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 92, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 49, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 57, 150, 150, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 74, 51, 150, 150, 150, 71, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 57, 150, 150, 150, 150, 150, 130, 98, 40, 150, 150, 150, 150, 105, 150], "policy_policy_0_reward": [-1374.2815261424435, -798.3694492361972, -575.926858495437, -773.9255861045244, -524.6709189783468, -699.859929674481, -844.6134294405927, -264.37251548101887, -931.6512331479896, -1289.774731497093, -702.0728369073042, -58.24537652131503, -300.13296010494975, -360.33385377506573, -246.49947034623307, -1232.490735473314, -380.07978211846626, -486.7271515264547, -914.9440650323476, -924.5979395901884, -387.1043141376115, -982.6101135417724, -1027.8720830705938, -1152.446219285638, -37.4487236528267, -93.0003171459916, -1238.3801677446534, -108.79140698608036, -1385.967725188565, -1054.7583503952087, -1132.350338991257, -1303.9777034420192, -957.8480407244078, -1308.1250980485784, -405.88196477329564, -1003.5781682833097, -46.05871602958686, -344.93797777770465, -440.7416254055713, -112.88047816885353, -872.1927088484134, -974.8164301680603, -1107.8284075121708, -1102.989443021041, -199.85920017674349, -1110.9760862792475, -967.7591232603552, -675.6554117510497, -1009.3790390717543, -705.7245006624678, -131.34707328666457, -1141.537385729621, -1109.8281776354913, -708.318729475051, -98.14419363093532, -1274.0331604577448, -1062.8097387632606, -581.1883825049757, -543.6709097578189, -407.48695440421625, -362.08650310334633, -851.8165156032358, -433.3169922316122, -464.60101131825553, -103.77724714444075, -1074.3186656856126, -220.89066897713957, -139.67870210263024, -1026.3271474178575, -713.1690841187202, -1275.5017219891038, -135.97399803063476, -244.03714401711383, -774.133005283554, -359.3051425938942, -923.4765767869269, -1051.1545006658832, -387.48848993279023, -919.503346545631, -1085.7844720479272, -547.1938987662712, -891.1456280539007, -746.1317363446288, -450.2382377661301, -459.064655872731, -27.472873687627704, -566.6013666176548, -812.6318175389752, -917.9426705945767, -968.9423583368902, -581.2565597830909, -631.4403832373287, -104.52351033965716, -15.663998556159997, -1285.4473632422255, -649.4286052738723, -608.8946456275963, -883.526396655, -260.44237992815573, -1219.1202800674996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5509334084831963, "mean_inference_ms": 1.6857299138474968, "mean_action_processing_ms": 0.2792753563361843, "mean_env_wait_ms": 3.0504762567446098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01183176040649414, "StateBufferConnector_ms": 0.008144140243530273, "ViewRequirementAgentConnector_ms": 0.19724178314208984}, "num_episodes": 32, "episode_return_max": -15.663998556159997, "episode_return_min": -1385.967725188565, "episode_return_mean": -691.6732524067064, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.8615262719784, "num_env_steps_trained_throughput_per_sec": 294.8615262719784, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13295.209, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13295.127, "sample_time_ms": 1062.744, "learn_time_ms": 12163.171, "learn_throughput": 328.862, "synch_weights_time_ms": 68.387}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00017", "date": "2024-08-03_11-55-30", "timestamp": 1722666330, "time_this_iter_s": 13.578090190887451, "time_total_s": 292.7086064815521, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2443bb5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 292.7086064815521, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.749999999999996, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.840993496278923, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.160302059352398, "policy_loss": -0.015295163905830123, "vf_loss": 8.18553583373626, "vf_explained_var": 0.7061958827699224, "kl": 0.017485809087520492, "entropy": 1.780722503364086, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -15.663998556159997, "episode_reward_min": -1476.1126792308091, "episode_reward_mean": -739.8483628127345, "episode_len_mean": 135.48, "episode_media": {}, "episodes_timesteps_total": 13548, "policy_reward_min": {"policy_0": -1476.1126792308091}, "policy_reward_max": {"policy_0": -15.663998556159997}, "policy_reward_mean": {"policy_0": -739.8483628127345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1385.967725188565, -1054.7583503952087, -1132.350338991257, -1303.9777034420192, -957.8480407244078, -1308.1250980485784, -405.88196477329564, -1003.5781682833097, -46.05871602958686, -344.93797777770465, -440.7416254055713, -112.88047816885353, -872.1927088484134, -974.8164301680603, -1107.8284075121708, -1102.989443021041, -199.85920017674349, -1110.9760862792475, -967.7591232603552, -675.6554117510497, -1009.3790390717543, -705.7245006624678, -131.34707328666457, -1141.537385729621, -1109.8281776354913, -708.318729475051, -98.14419363093532, -1274.0331604577448, -1062.8097387632606, -581.1883825049757, -543.6709097578189, -407.48695440421625, -362.08650310334633, -851.8165156032358, -433.3169922316122, -464.60101131825553, -103.77724714444075, -1074.3186656856126, -220.89066897713957, -139.67870210263024, -1026.3271474178575, -713.1690841187202, -1275.5017219891038, -135.97399803063476, -244.03714401711383, -774.133005283554, -359.3051425938942, -923.4765767869269, -1051.1545006658832, -387.48848993279023, -919.503346545631, -1085.7844720479272, -547.1938987662712, -891.1456280539007, -746.1317363446288, -450.2382377661301, -459.064655872731, -27.472873687627704, -566.6013666176548, -812.6318175389752, -917.9426705945767, -968.9423583368902, -581.2565597830909, -631.4403832373287, -104.52351033965716, -15.663998556159997, -1285.4473632422255, -649.4286052738723, -608.8946456275963, -883.526396655, -260.44237992815573, -1219.1202800674996, -891.0012434097341, -1144.1924472347662, -923.6736616587789, -842.3752849709587, -440.2082210233306, -894.581563693669, -425.3307237975857, -893.9108581580871, -1476.1126792308091, -23.361493371253307, -1218.1269684353126, -1256.319006114891, -979.9529205476842, -1025.235345034404, -730.3509581056837, -1211.9198495189894, -639.8830277892819, -930.3557073358678, -1161.5770477058825, -449.8916958414569, -664.7307973212814, -114.13452251783643, -1116.0349882229211, -1046.9897557538245, -543.2988300178781, -1217.1673772100319, -761.5318057003226, -506.4859560392167], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 49, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 57, 150, 150, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 74, 51, 150, 150, 150, 71, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 57, 150, 150, 150, 150, 150, 130, 98, 40, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 127, 150, 107, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1385.967725188565, -1054.7583503952087, -1132.350338991257, -1303.9777034420192, -957.8480407244078, -1308.1250980485784, -405.88196477329564, -1003.5781682833097, -46.05871602958686, -344.93797777770465, -440.7416254055713, -112.88047816885353, -872.1927088484134, -974.8164301680603, -1107.8284075121708, -1102.989443021041, -199.85920017674349, -1110.9760862792475, -967.7591232603552, -675.6554117510497, -1009.3790390717543, -705.7245006624678, -131.34707328666457, -1141.537385729621, -1109.8281776354913, -708.318729475051, -98.14419363093532, -1274.0331604577448, -1062.8097387632606, -581.1883825049757, -543.6709097578189, -407.48695440421625, -362.08650310334633, -851.8165156032358, -433.3169922316122, -464.60101131825553, -103.77724714444075, -1074.3186656856126, -220.89066897713957, -139.67870210263024, -1026.3271474178575, -713.1690841187202, -1275.5017219891038, -135.97399803063476, -244.03714401711383, -774.133005283554, -359.3051425938942, -923.4765767869269, -1051.1545006658832, -387.48848993279023, -919.503346545631, -1085.7844720479272, -547.1938987662712, -891.1456280539007, -746.1317363446288, -450.2382377661301, -459.064655872731, -27.472873687627704, -566.6013666176548, -812.6318175389752, -917.9426705945767, -968.9423583368902, -581.2565597830909, -631.4403832373287, -104.52351033965716, -15.663998556159997, -1285.4473632422255, -649.4286052738723, -608.8946456275963, -883.526396655, -260.44237992815573, -1219.1202800674996, -891.0012434097341, -1144.1924472347662, -923.6736616587789, -842.3752849709587, -440.2082210233306, -894.581563693669, -425.3307237975857, -893.9108581580871, -1476.1126792308091, -23.361493371253307, -1218.1269684353126, -1256.319006114891, -979.9529205476842, -1025.235345034404, -730.3509581056837, -1211.9198495189894, -639.8830277892819, -930.3557073358678, -1161.5770477058825, -449.8916958414569, -664.7307973212814, -114.13452251783643, -1116.0349882229211, -1046.9897557538245, -543.2988300178781, -1217.1673772100319, -761.5318057003226, -506.4859560392167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5511133785594938, "mean_inference_ms": 1.6861669870821763, "mean_action_processing_ms": 0.27929901397104906, "mean_env_wait_ms": 3.05436846529382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012651681900024414, "StateBufferConnector_ms": 0.008194208145141602, "ViewRequirementAgentConnector_ms": 0.19717907905578613}, "num_episodes": 28, "episode_return_max": -15.663998556159997, "episode_return_min": -1476.1126792308091, "episode_return_mean": -739.8483628127345, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.25228991313406, "num_env_steps_trained_throughput_per_sec": 296.25228991313406, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13277.481, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13277.399, "sample_time_ms": 1060.612, "learn_time_ms": 12148.387, "learn_throughput": 329.262, "synch_weights_time_ms": 67.522}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00017", "date": "2024-08-03_11-55-43", "timestamp": 1722666343, "time_this_iter_s": 13.513967275619507, "time_total_s": 306.22257375717163, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a7ab11dea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 306.22257375717163, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.989473684210527, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.17773927599192, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.226090786357721, "policy_loss": -0.006004462370280332, "vf_loss": 8.243946277101834, "vf_explained_var": 0.7925401254867513, "kl": 0.012001771884085148, "entropy": 1.7251794354369243, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -15.663998556159997, "episode_reward_min": -1476.1126792308091, "episode_reward_mean": -739.5916027718729, "episode_len_mean": 137.63, "episode_media": {}, "episodes_timesteps_total": 13763, "policy_reward_min": {"policy_0": -1476.1126792308091}, "policy_reward_max": {"policy_0": -15.663998556159997}, "policy_reward_mean": {"policy_0": -739.5916027718729}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1062.8097387632606, -581.1883825049757, -543.6709097578189, -407.48695440421625, -362.08650310334633, -851.8165156032358, -433.3169922316122, -464.60101131825553, -103.77724714444075, -1074.3186656856126, -220.89066897713957, -139.67870210263024, -1026.3271474178575, -713.1690841187202, -1275.5017219891038, -135.97399803063476, -244.03714401711383, -774.133005283554, -359.3051425938942, -923.4765767869269, -1051.1545006658832, -387.48848993279023, -919.503346545631, -1085.7844720479272, -547.1938987662712, -891.1456280539007, -746.1317363446288, -450.2382377661301, -459.064655872731, -27.472873687627704, -566.6013666176548, -812.6318175389752, -917.9426705945767, -968.9423583368902, -581.2565597830909, -631.4403832373287, -104.52351033965716, -15.663998556159997, -1285.4473632422255, -649.4286052738723, -608.8946456275963, -883.526396655, -260.44237992815573, -1219.1202800674996, -891.0012434097341, -1144.1924472347662, -923.6736616587789, -842.3752849709587, -440.2082210233306, -894.581563693669, -425.3307237975857, -893.9108581580871, -1476.1126792308091, -23.361493371253307, -1218.1269684353126, -1256.319006114891, -979.9529205476842, -1025.235345034404, -730.3509581056837, -1211.9198495189894, -639.8830277892819, -930.3557073358678, -1161.5770477058825, -449.8916958414569, -664.7307973212814, -114.13452251783643, -1116.0349882229211, -1046.9897557538245, -543.2988300178781, -1217.1673772100319, -761.5318057003226, -506.4859560392167, -1119.9605746724521, -1013.9717385866229, -691.5285703063574, -949.8111768819151, -284.8104992371103, -455.6106251450601, -1179.7073235617863, -47.27876768436061, -988.6270867649515, -797.9685177508068, -1187.2137675704382, -1223.2540835773311, -1066.503514063209, -891.2785467637535, -740.0066213390093, -1459.8214249674359, -466.12081986234807, -1385.6327916575724, -1218.3826792116124, -1184.7270575487269, -727.8016156851087, -295.1196053672307, -288.25497718350204, -650.4835453087638, -548.1934132274395, -1134.3078243514842, -598.0209673238127, -67.4211185087923], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 74, 51, 150, 150, 150, 71, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 57, 150, 150, 150, 150, 150, 130, 98, 40, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 127, 150, 107, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 61], "policy_policy_0_reward": [-1062.8097387632606, -581.1883825049757, -543.6709097578189, -407.48695440421625, -362.08650310334633, -851.8165156032358, -433.3169922316122, -464.60101131825553, -103.77724714444075, -1074.3186656856126, -220.89066897713957, -139.67870210263024, -1026.3271474178575, -713.1690841187202, -1275.5017219891038, -135.97399803063476, -244.03714401711383, -774.133005283554, -359.3051425938942, -923.4765767869269, -1051.1545006658832, -387.48848993279023, -919.503346545631, -1085.7844720479272, -547.1938987662712, -891.1456280539007, -746.1317363446288, -450.2382377661301, -459.064655872731, -27.472873687627704, -566.6013666176548, -812.6318175389752, -917.9426705945767, -968.9423583368902, -581.2565597830909, -631.4403832373287, -104.52351033965716, -15.663998556159997, -1285.4473632422255, -649.4286052738723, -608.8946456275963, -883.526396655, -260.44237992815573, -1219.1202800674996, -891.0012434097341, -1144.1924472347662, -923.6736616587789, -842.3752849709587, -440.2082210233306, -894.581563693669, -425.3307237975857, -893.9108581580871, -1476.1126792308091, -23.361493371253307, -1218.1269684353126, -1256.319006114891, -979.9529205476842, -1025.235345034404, -730.3509581056837, -1211.9198495189894, -639.8830277892819, -930.3557073358678, -1161.5770477058825, -449.8916958414569, -664.7307973212814, -114.13452251783643, -1116.0349882229211, -1046.9897557538245, -543.2988300178781, -1217.1673772100319, -761.5318057003226, -506.4859560392167, -1119.9605746724521, -1013.9717385866229, -691.5285703063574, -949.8111768819151, -284.8104992371103, -455.6106251450601, -1179.7073235617863, -47.27876768436061, -988.6270867649515, -797.9685177508068, -1187.2137675704382, -1223.2540835773311, -1066.503514063209, -891.2785467637535, -740.0066213390093, -1459.8214249674359, -466.12081986234807, -1385.6327916575724, -1218.3826792116124, -1184.7270575487269, -727.8016156851087, -295.1196053672307, -288.25497718350204, -650.4835453087638, -548.1934132274395, -1134.3078243514842, -598.0209673238127, -67.4211185087923]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5512675394712016, "mean_inference_ms": 1.686639894526381, "mean_action_processing_ms": 0.2790832809775789, "mean_env_wait_ms": 3.0581621825484446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012824296951293945, "StateBufferConnector_ms": 0.008367538452148438, "ViewRequirementAgentConnector_ms": 0.20233511924743652}, "num_episodes": 28, "episode_return_max": -15.663998556159997, "episode_return_min": -1476.1126792308091, "episode_return_mean": -739.5916027718729, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.91988985949644, "num_env_steps_trained_throughput_per_sec": 298.91988985949644, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13254.909, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13254.833, "sample_time_ms": 1062.571, "learn_time_ms": 12125.154, "learn_throughput": 329.893, "synch_weights_time_ms": 66.246}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00017", "date": "2024-08-03_11-55-57", "timestamp": 1722666357, "time_this_iter_s": 13.39326810836792, "time_total_s": 319.61584186553955, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a7ab11e0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 319.61584186553955, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.963157894736844, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.94249686598778, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.763530317445596, "policy_loss": -0.008401917661346184, "vf_loss": 7.777463337779045, "vf_explained_var": 0.8559268593167265, "kl": 0.01735793640277734, "entropy": 1.3342157827690244, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -15.663998556159997, "episode_reward_min": -1476.1126792308091, "episode_reward_mean": -771.578120699087, "episode_len_mean": 138.6, "episode_media": {}, "episodes_timesteps_total": 13860, "policy_reward_min": {"policy_0": -1476.1126792308091}, "policy_reward_max": {"policy_0": -15.663998556159997}, "policy_reward_mean": {"policy_0": -771.578120699087}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.472873687627704, -566.6013666176548, -812.6318175389752, -917.9426705945767, -968.9423583368902, -581.2565597830909, -631.4403832373287, -104.52351033965716, -15.663998556159997, -1285.4473632422255, -649.4286052738723, -608.8946456275963, -883.526396655, -260.44237992815573, -1219.1202800674996, -891.0012434097341, -1144.1924472347662, -923.6736616587789, -842.3752849709587, -440.2082210233306, -894.581563693669, -425.3307237975857, -893.9108581580871, -1476.1126792308091, -23.361493371253307, -1218.1269684353126, -1256.319006114891, -979.9529205476842, -1025.235345034404, -730.3509581056837, -1211.9198495189894, -639.8830277892819, -930.3557073358678, -1161.5770477058825, -449.8916958414569, -664.7307973212814, -114.13452251783643, -1116.0349882229211, -1046.9897557538245, -543.2988300178781, -1217.1673772100319, -761.5318057003226, -506.4859560392167, -1119.9605746724521, -1013.9717385866229, -691.5285703063574, -949.8111768819151, -284.8104992371103, -455.6106251450601, -1179.7073235617863, -47.27876768436061, -988.6270867649515, -797.9685177508068, -1187.2137675704382, -1223.2540835773311, -1066.503514063209, -891.2785467637535, -740.0066213390093, -1459.8214249674359, -466.12081986234807, -1385.6327916575724, -1218.3826792116124, -1184.7270575487269, -727.8016156851087, -295.1196053672307, -288.25497718350204, -650.4835453087638, -548.1934132274395, -1134.3078243514842, -598.0209673238127, -67.4211185087923, -565.1529337374453, -1152.6719498031898, -978.5812118286531, -257.03323030662574, -792.2937078874477, -577.6672558982694, -440.49726470449554, -310.2111586506667, -953.7921506918851, -763.5863752919607, -966.2288781878481, -498.2714093757003, -685.715568696254, -903.1055664671309, -349.53186370104953, -951.3151132257848, -1122.621077612155, -372.9525592589853, -1218.929034371589, -90.76590223206136, -1083.8471039584667, -592.5593307623487, -1148.3922378494492, -65.81332662109214, -971.9424970848148, -1044.7652019491622, -1001.8497800330396, -832.8738874730291, -740.9552928910537], "episode_lengths": [57, 150, 150, 150, 150, 150, 130, 98, 40, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 127, 150, 107, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 61, 150, 150, 150, 137, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 101, 150, 150, 99, 150, 63, 150, 150, 150, 64, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-27.472873687627704, -566.6013666176548, -812.6318175389752, -917.9426705945767, -968.9423583368902, -581.2565597830909, -631.4403832373287, -104.52351033965716, -15.663998556159997, -1285.4473632422255, -649.4286052738723, -608.8946456275963, -883.526396655, -260.44237992815573, -1219.1202800674996, -891.0012434097341, -1144.1924472347662, -923.6736616587789, -842.3752849709587, -440.2082210233306, -894.581563693669, -425.3307237975857, -893.9108581580871, -1476.1126792308091, -23.361493371253307, -1218.1269684353126, -1256.319006114891, -979.9529205476842, -1025.235345034404, -730.3509581056837, -1211.9198495189894, -639.8830277892819, -930.3557073358678, -1161.5770477058825, -449.8916958414569, -664.7307973212814, -114.13452251783643, -1116.0349882229211, -1046.9897557538245, -543.2988300178781, -1217.1673772100319, -761.5318057003226, -506.4859560392167, -1119.9605746724521, -1013.9717385866229, -691.5285703063574, -949.8111768819151, -284.8104992371103, -455.6106251450601, -1179.7073235617863, -47.27876768436061, -988.6270867649515, -797.9685177508068, -1187.2137675704382, -1223.2540835773311, -1066.503514063209, -891.2785467637535, -740.0066213390093, -1459.8214249674359, -466.12081986234807, -1385.6327916575724, -1218.3826792116124, -1184.7270575487269, -727.8016156851087, -295.1196053672307, -288.25497718350204, -650.4835453087638, -548.1934132274395, -1134.3078243514842, -598.0209673238127, -67.4211185087923, -565.1529337374453, -1152.6719498031898, -978.5812118286531, -257.03323030662574, -792.2937078874477, -577.6672558982694, -440.49726470449554, -310.2111586506667, -953.7921506918851, -763.5863752919607, -966.2288781878481, -498.2714093757003, -685.715568696254, -903.1055664671309, -349.53186370104953, -951.3151132257848, -1122.621077612155, -372.9525592589853, -1218.929034371589, -90.76590223206136, -1083.8471039584667, -592.5593307623487, -1148.3922378494492, -65.81332662109214, -971.9424970848148, -1044.7652019491622, -1001.8497800330396, -832.8738874730291, -740.9552928910537]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5514884459509263, "mean_inference_ms": 1.6867784159550414, "mean_action_processing_ms": 0.27907410562651297, "mean_env_wait_ms": 3.0622614705819093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012360095977783203, "StateBufferConnector_ms": 0.007993698120117188, "ViewRequirementAgentConnector_ms": 0.19684576988220215}, "num_episodes": 29, "episode_return_max": -15.663998556159997, "episode_return_min": -1476.1126792308091, "episode_return_mean": -771.578120699087, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.1784956914148, "num_env_steps_trained_throughput_per_sec": 296.1784956914148, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13260.45, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13260.375, "sample_time_ms": 1056.792, "learn_time_ms": 12136.311, "learn_throughput": 329.589, "synch_weights_time_ms": 66.404}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00017", "date": "2024-08-03_11-56-10", "timestamp": 1722666370, "time_this_iter_s": 13.51694393157959, "time_total_s": 333.13278579711914, "pid": 533720, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2443b8700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 333.13278579711914, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.899999999999999, "ram_util_percent": 27.8}}
