{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1762038989923895, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.432039477924507, "policy_loss": -0.008509471607006465, "vf_loss": 9.439990963538488, "vf_explained_var": 0.0222599678983291, "kl": 0.009886673684043975, "entropy": 1.419376893589894, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -28.51127800678438, "episode_reward_min": -1146.7293307846053, "episode_reward_mean": -723.0929947693379, "episode_len_mean": 137.69565217391303, "episode_media": {}, "episodes_timesteps_total": 3167, "policy_reward_min": {"policy_0": -1146.7293307846053}, "policy_reward_max": {"policy_0": -28.51127800678438}, "policy_reward_mean": {"policy_0": -723.0929947693379}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-984.8490040806595, -750.6255110824758, -696.6777656456269, -919.7579730570403, -698.4990292319427, -768.8704138425593, -992.2796015771189, -631.7798997119254, -69.67764862499482, -861.0264630752202, -1004.7268196666467, -420.5358635296706, -744.5600933004912, -1022.112944818865, -796.2260748434189, -982.0894469005119, -701.5624706449653, -1146.7293307846053, -920.4169648285158, -656.192266623396, -28.51127800678438, -125.21304641061244, -708.2189694067229], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 53, 150], "policy_policy_0_reward": [-984.8490040806595, -750.6255110824758, -696.6777656456269, -919.7579730570403, -698.4990292319427, -768.8704138425593, -992.2796015771189, -631.7798997119254, -69.67764862499482, -861.0264630752202, -1004.7268196666467, -420.5358635296706, -744.5600933004912, -1022.112944818865, -796.2260748434189, -982.0894469005119, -701.5624706449653, -1146.7293307846053, -920.4169648285158, -656.192266623396, -28.51127800678438, -125.21304641061244, -708.2189694067229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5513940804212499, "mean_inference_ms": 1.6295969929643725, "mean_action_processing_ms": 0.27612194000819323, "mean_env_wait_ms": 2.903758826412055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011302077251931896, "StateBufferConnector_ms": 0.008203672326129416, "ViewRequirementAgentConnector_ms": 0.17938095590342645}, "num_episodes": 23, "episode_return_max": -28.51127800678438, "episode_return_min": -1146.7293307846053, "episode_return_mean": -723.0929947693379, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.44548755897455, "num_env_steps_trained_throughput_per_sec": 312.44548755897455, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12802.244, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12802.175, "sample_time_ms": 1017.113, "learn_time_ms": 11717.313, "learn_throughput": 341.375, "synch_weights_time_ms": 66.871}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00001", "date": "2024-08-03_10-19-55", "timestamp": 1722660595, "time_this_iter_s": 12.815010070800781, "time_total_s": 12.815010070800781, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0c3a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.815010070800781, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.489473684210527, "ram_util_percent": 27.394736842105257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.194161575660109, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.26844071696202, "policy_loss": -0.008314425466232933, "vf_loss": 8.276046097278595, "vf_explained_var": 0.30964618821938833, "kl": 0.01059032019870756, "entropy": 1.4090353103975455, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -28.51127800678438, "episode_reward_min": -1180.6279014271952, "episode_reward_mean": -645.0931754805292, "episode_len_mean": 135.87234042553192, "episode_media": {}, "episodes_timesteps_total": 6386, "policy_reward_min": {"policy_0": -1180.6279014271952}, "policy_reward_max": {"policy_0": -28.51127800678438}, "policy_reward_mean": {"policy_0": -645.0931754805292}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-984.8490040806595, -750.6255110824758, -696.6777656456269, -919.7579730570403, -698.4990292319427, -768.8704138425593, -992.2796015771189, -631.7798997119254, -69.67764862499482, -861.0264630752202, -1004.7268196666467, -420.5358635296706, -744.5600933004912, -1022.112944818865, -796.2260748434189, -982.0894469005119, -701.5624706449653, -1146.7293307846053, -920.4169648285158, -656.192266623396, -28.51127800678438, -125.21304641061244, -708.2189694067229, -270.3023938948946, -729.5827835870144, -581.0286687612444, -183.59727397023016, -36.257985773572265, -688.9050316144313, -810.4121018994687, -1180.6279014271952, -752.3420210547295, -917.0014868669472, -373.0878857408176, -427.33235257530714, -385.3190878728757, -932.7943419086639, -255.3212433360328, -170.86103679521653, -314.9522013848751, -634.2677352432244, -317.59211367382323, -989.0827783467001, -737.5475624092379, -851.8854140799351, -871.2878569810913, -276.85110869257727], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 53, 150, 98, 150, 150, 60, 58, 150, 150, 150, 150, 150, 150, 112, 129, 150, 150, 115, 97, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-984.8490040806595, -750.6255110824758, -696.6777656456269, -919.7579730570403, -698.4990292319427, -768.8704138425593, -992.2796015771189, -631.7798997119254, -69.67764862499482, -861.0264630752202, -1004.7268196666467, -420.5358635296706, -744.5600933004912, -1022.112944818865, -796.2260748434189, -982.0894469005119, -701.5624706449653, -1146.7293307846053, -920.4169648285158, -656.192266623396, -28.51127800678438, -125.21304641061244, -708.2189694067229, -270.3023938948946, -729.5827835870144, -581.0286687612444, -183.59727397023016, -36.257985773572265, -688.9050316144313, -810.4121018994687, -1180.6279014271952, -752.3420210547295, -917.0014868669472, -373.0878857408176, -427.33235257530714, -385.3190878728757, -932.7943419086639, -255.3212433360328, -170.86103679521653, -314.9522013848751, -634.2677352432244, -317.59211367382323, -989.0827783467001, -737.5475624092379, -851.8854140799351, -871.2878569810913, -276.85110869257727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5506201663728733, "mean_inference_ms": 1.6470012004668477, "mean_action_processing_ms": 0.2790697650516592, "mean_env_wait_ms": 2.922487191235747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013856177634381234, "StateBufferConnector_ms": 0.008426828587308843, "ViewRequirementAgentConnector_ms": 0.1829492284896526}, "num_episodes": 24, "episode_return_max": -28.51127800678438, "episode_return_min": -1180.6279014271952, "episode_return_mean": -645.0931754805292, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.08213764405764, "num_env_steps_trained_throughput_per_sec": 316.08213764405764, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12728.598, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12728.527, "sample_time_ms": 1013.951, "learn_time_ms": 11641.3, "learn_throughput": 343.604, "synch_weights_time_ms": 72.274}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00001", "date": "2024-08-03_10-20-07", "timestamp": 1722660607, "time_this_iter_s": 12.666272640228271, "time_total_s": 25.481282711029053, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0d870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.481282711029053, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.566666666666668, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.283647216359775, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.767934098094702, "policy_loss": -0.00743320861220127, "vf_loss": 5.7742765021820865, "vf_explained_var": 0.7707784688100219, "kl": 0.012522399454640738, "entropy": 1.4136700133482616, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -28.51127800678438, "episode_reward_min": -1265.8464633277727, "episode_reward_mean": -690.2050048008931, "episode_len_mean": 136.96052631578948, "episode_media": {}, "episodes_timesteps_total": 10409, "policy_reward_min": {"policy_0": -1265.8464633277727}, "policy_reward_max": {"policy_0": -28.51127800678438}, "policy_reward_mean": {"policy_0": -690.2050048008931}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-984.8490040806595, -750.6255110824758, -696.6777656456269, -919.7579730570403, -698.4990292319427, -768.8704138425593, -992.2796015771189, -631.7798997119254, -69.67764862499482, -861.0264630752202, -1004.7268196666467, -420.5358635296706, -744.5600933004912, -1022.112944818865, -796.2260748434189, -982.0894469005119, -701.5624706449653, -1146.7293307846053, -920.4169648285158, -656.192266623396, -28.51127800678438, -125.21304641061244, -708.2189694067229, -270.3023938948946, -729.5827835870144, -581.0286687612444, -183.59727397023016, -36.257985773572265, -688.9050316144313, -810.4121018994687, -1180.6279014271952, -752.3420210547295, -917.0014868669472, -373.0878857408176, -427.33235257530714, -385.3190878728757, -932.7943419086639, -255.3212433360328, -170.86103679521653, -314.9522013848751, -634.2677352432244, -317.59211367382323, -989.0827783467001, -737.5475624092379, -851.8854140799351, -871.2878569810913, -276.85110869257727, -790.2108708096907, -803.9387223570856, -1013.2516332567914, -1109.7786127479844, -859.45258108134, -904.277903925238, -44.21271451372338, -498.53351710937494, -663.7474667008424, -445.517953979921, -689.7941234928304, -1098.58829479143, -1041.198358175105, -894.8324385316015, -584.1782849113902, -124.77867032135481, -733.3861569091778, -1134.6539987492936, -1261.9053434802142, -823.6697916394387, -916.2356832482031, -62.1299303145018, -796.7123049486858, -178.91850958844583, -1079.0096335584194, -986.4618157818795, -1265.8464633277727, -623.2881675035957, -707.6911715276668], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 53, 150, 98, 150, 150, 60, 58, 150, 150, 150, 150, 150, 150, 112, 129, 150, 150, 115, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 112, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 53, 150, 148, 150, 150, 150, 136, 150], "policy_policy_0_reward": [-984.8490040806595, -750.6255110824758, -696.6777656456269, -919.7579730570403, -698.4990292319427, -768.8704138425593, -992.2796015771189, -631.7798997119254, -69.67764862499482, -861.0264630752202, -1004.7268196666467, -420.5358635296706, -744.5600933004912, -1022.112944818865, -796.2260748434189, -982.0894469005119, -701.5624706449653, -1146.7293307846053, -920.4169648285158, -656.192266623396, -28.51127800678438, -125.21304641061244, -708.2189694067229, -270.3023938948946, -729.5827835870144, -581.0286687612444, -183.59727397023016, -36.257985773572265, -688.9050316144313, -810.4121018994687, -1180.6279014271952, -752.3420210547295, -917.0014868669472, -373.0878857408176, -427.33235257530714, -385.3190878728757, -932.7943419086639, -255.3212433360328, -170.86103679521653, -314.9522013848751, -634.2677352432244, -317.59211367382323, -989.0827783467001, -737.5475624092379, -851.8854140799351, -871.2878569810913, -276.85110869257727, -790.2108708096907, -803.9387223570856, -1013.2516332567914, -1109.7786127479844, -859.45258108134, -904.277903925238, -44.21271451372338, -498.53351710937494, -663.7474667008424, -445.517953979921, -689.7941234928304, -1098.58829479143, -1041.198358175105, -894.8324385316015, -584.1782849113902, -124.77867032135481, -733.3861569091778, -1134.6539987492936, -1261.9053434802142, -823.6697916394387, -916.2356832482031, -62.1299303145018, -796.7123049486858, -178.91850958844583, -1079.0096335584194, -986.4618157818795, -1265.8464633277727, -623.2881675035957, -707.6911715276668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5511270617244585, "mean_inference_ms": 1.6517932464923668, "mean_action_processing_ms": 0.27981755476979053, "mean_env_wait_ms": 2.9287403103698244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013388771759836297, "StateBufferConnector_ms": 0.00860251878437243, "ViewRequirementAgentConnector_ms": 0.18765455798098915}, "num_episodes": 29, "episode_return_max": -28.51127800678438, "episode_return_min": -1265.8464633277727, "episode_return_mean": -690.2050048008931, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.0547445540206, "num_env_steps_trained_throughput_per_sec": 399.0547445540206, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11826.965, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11826.897, "sample_time_ms": 1010.148, "learn_time_ms": 10751.775, "learn_throughput": 372.032, "synch_weights_time_ms": 64.048}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00001", "date": "2024-08-03_10-20-18", "timestamp": 1722660618, "time_this_iter_s": 10.036815643310547, "time_total_s": 35.5180983543396, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0f5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 35.5180983543396, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 15.235714285714284, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 71.6547503054142, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.867690350363652, "policy_loss": -0.006361337782194217, "vf_loss": 3.8731416799128056, "vf_explained_var": 0.9193463162208597, "kl": 0.011466112626158065, "entropy": 1.3832100657125315, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -28.51127800678438, "episode_reward_min": -1265.8464633277727, "episode_reward_mean": -660.6273222213941, "episode_len_mean": 136.49, "episode_media": {}, "episodes_timesteps_total": 13649, "policy_reward_min": {"policy_0": -1265.8464633277727}, "policy_reward_max": {"policy_0": -28.51127800678438}, "policy_reward_mean": {"policy_0": -660.6273222213941}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-696.6777656456269, -919.7579730570403, -698.4990292319427, -768.8704138425593, -992.2796015771189, -631.7798997119254, -69.67764862499482, -861.0264630752202, -1004.7268196666467, -420.5358635296706, -744.5600933004912, -1022.112944818865, -796.2260748434189, -982.0894469005119, -701.5624706449653, -1146.7293307846053, -920.4169648285158, -656.192266623396, -28.51127800678438, -125.21304641061244, -708.2189694067229, -270.3023938948946, -729.5827835870144, -581.0286687612444, -183.59727397023016, -36.257985773572265, -688.9050316144313, -810.4121018994687, -1180.6279014271952, -752.3420210547295, -917.0014868669472, -373.0878857408176, -427.33235257530714, -385.3190878728757, -932.7943419086639, -255.3212433360328, -170.86103679521653, -314.9522013848751, -634.2677352432244, -317.59211367382323, -989.0827783467001, -737.5475624092379, -851.8854140799351, -871.2878569810913, -276.85110869257727, -790.2108708096907, -803.9387223570856, -1013.2516332567914, -1109.7786127479844, -859.45258108134, -904.277903925238, -44.21271451372338, -498.53351710937494, -663.7474667008424, -445.517953979921, -689.7941234928304, -1098.58829479143, -1041.198358175105, -894.8324385316015, -584.1782849113902, -124.77867032135481, -733.3861569091778, -1134.6539987492936, -1261.9053434802142, -823.6697916394387, -916.2356832482031, -62.1299303145018, -796.7123049486858, -178.91850958844583, -1079.0096335584194, -986.4618157818795, -1265.8464633277727, -623.2881675035957, -707.6911715276668, -493.2844923694086, -396.94827928102194, -255.68988472747043, -750.2194435952107, -982.4808316159924, -417.6527569756987, -356.17473378400905, -479.37713667229445, -368.0619692586788, -910.5284113147961, -506.5500167458756, -225.87012129679573, -209.7333677085087, -807.5135750370838, -1012.6021401514824, -61.8253197753757, -925.8376796944141, -491.10912690367365, -608.9248382693249, -583.7367284294447, -704.058473133923, -872.9164651650382, -285.70215600526774, -978.3086025853609, -754.3014900725789, -903.2183318659584], "episode_lengths": [150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 53, 150, 98, 150, 150, 60, 58, 150, 150, 150, 150, 150, 150, 112, 129, 150, 150, 115, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 112, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 53, 150, 148, 150, 150, 150, 136, 150, 150, 124, 98, 150, 150, 150, 109, 150, 115, 150, 150, 114, 97, 150, 150, 81, 150, 117, 150, 150, 150, 150, 135, 150, 150, 150], "policy_policy_0_reward": [-696.6777656456269, -919.7579730570403, -698.4990292319427, -768.8704138425593, -992.2796015771189, -631.7798997119254, -69.67764862499482, -861.0264630752202, -1004.7268196666467, -420.5358635296706, -744.5600933004912, -1022.112944818865, -796.2260748434189, -982.0894469005119, -701.5624706449653, -1146.7293307846053, -920.4169648285158, -656.192266623396, -28.51127800678438, -125.21304641061244, -708.2189694067229, -270.3023938948946, -729.5827835870144, -581.0286687612444, -183.59727397023016, -36.257985773572265, -688.9050316144313, -810.4121018994687, -1180.6279014271952, -752.3420210547295, -917.0014868669472, -373.0878857408176, -427.33235257530714, -385.3190878728757, -932.7943419086639, -255.3212433360328, -170.86103679521653, -314.9522013848751, -634.2677352432244, -317.59211367382323, -989.0827783467001, -737.5475624092379, -851.8854140799351, -871.2878569810913, -276.85110869257727, -790.2108708096907, -803.9387223570856, -1013.2516332567914, -1109.7786127479844, -859.45258108134, -904.277903925238, -44.21271451372338, -498.53351710937494, -663.7474667008424, -445.517953979921, -689.7941234928304, -1098.58829479143, -1041.198358175105, -894.8324385316015, -584.1782849113902, -124.77867032135481, -733.3861569091778, -1134.6539987492936, -1261.9053434802142, -823.6697916394387, -916.2356832482031, -62.1299303145018, -796.7123049486858, -178.91850958844583, -1079.0096335584194, -986.4618157818795, -1265.8464633277727, -623.2881675035957, -707.6911715276668, -493.2844923694086, -396.94827928102194, -255.68988472747043, -750.2194435952107, -982.4808316159924, -417.6527569756987, -356.17473378400905, -479.37713667229445, -368.0619692586788, -910.5284113147961, -506.5500167458756, -225.87012129679573, -209.7333677085087, -807.5135750370838, -1012.6021401514824, -61.8253197753757, -925.8376796944141, -491.10912690367365, -608.9248382693249, -583.7367284294447, -704.058473133923, -872.9164651650382, -285.70215600526774, -978.3086025853609, -754.3014900725789, -903.2183318659584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5510175226790127, "mean_inference_ms": 1.6543493175647819, "mean_action_processing_ms": 0.2802354320573551, "mean_env_wait_ms": 2.9300843567879076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013521432876586914, "StateBufferConnector_ms": 0.008664846420288086, "ViewRequirementAgentConnector_ms": 0.187819242477417}, "num_episodes": 26, "episode_return_max": -28.51127800678438, "episode_return_min": -1265.8464633277727, "episode_return_mean": -660.6273222213941, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.1568148702024, "num_env_steps_trained_throughput_per_sec": 325.1568148702024, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 11945.665, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11945.599, "sample_time_ms": 1009.136, "learn_time_ms": 10871.161, "learn_throughput": 367.946, "synch_weights_time_ms": 64.397}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00001", "date": "2024-08-03_10-20-30", "timestamp": 1722660630, "time_this_iter_s": 12.31498670578003, "time_total_s": 47.83308506011963, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0f490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 47.83308506011963, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.433333333333334, "ram_util_percent": 27.41111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.7570668399334, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.7142100684344768, "policy_loss": -0.006010327761759982, "vf_loss": 3.7194679205616317, "vf_explained_var": 0.9563089303051432, "kl": 0.010936949179889173, "entropy": 1.4349210405101378, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -44.21271451372338, "episode_reward_min": -1265.8464633277727, "episode_reward_mean": -699.7296639617092, "episode_len_mean": 139.14, "episode_media": {}, "episodes_timesteps_total": 13914, "policy_reward_min": {"policy_0": -1265.8464633277727}, "policy_reward_max": {"policy_0": -44.21271451372338}, "policy_reward_mean": {"policy_0": -699.7296639617092}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-385.3190878728757, -932.7943419086639, -255.3212433360328, -170.86103679521653, -314.9522013848751, -634.2677352432244, -317.59211367382323, -989.0827783467001, -737.5475624092379, -851.8854140799351, -871.2878569810913, -276.85110869257727, -790.2108708096907, -803.9387223570856, -1013.2516332567914, -1109.7786127479844, -859.45258108134, -904.277903925238, -44.21271451372338, -498.53351710937494, -663.7474667008424, -445.517953979921, -689.7941234928304, -1098.58829479143, -1041.198358175105, -894.8324385316015, -584.1782849113902, -124.77867032135481, -733.3861569091778, -1134.6539987492936, -1261.9053434802142, -823.6697916394387, -916.2356832482031, -62.1299303145018, -796.7123049486858, -178.91850958844583, -1079.0096335584194, -986.4618157818795, -1265.8464633277727, -623.2881675035957, -707.6911715276668, -493.2844923694086, -396.94827928102194, -255.68988472747043, -750.2194435952107, -982.4808316159924, -417.6527569756987, -356.17473378400905, -479.37713667229445, -368.0619692586788, -910.5284113147961, -506.5500167458756, -225.87012129679573, -209.7333677085087, -807.5135750370838, -1012.6021401514824, -61.8253197753757, -925.8376796944141, -491.10912690367365, -608.9248382693249, -583.7367284294447, -704.058473133923, -872.9164651650382, -285.70215600526774, -978.3086025853609, -754.3014900725789, -903.2183318659584, -1015.8863366401395, -1156.1185427284106, -977.5128523875392, -1010.2433670561385, -467.07721143452534, -1008.5073604643269, -572.4661557539815, -842.6917454299987, -665.6091927165961, -342.2340767797028, -432.23609164738247, -125.97514078731584, -899.6059144125128, -1251.6006553990867, -1091.8151416109029, -839.6997619933455, -534.2969223064093, -1151.2253997259595, -1008.1545118276596, -787.1769016037553, -847.7530925585849, -908.182963526302, -921.7314634071441, -1124.8081179109563, -647.156112423149, -149.31865058404043, -799.2592154930499, -316.3011382196215, -827.1489859083471, -1058.5014715118696, -821.5687541883478, -435.1228402276172, -719.3903370642553], "episode_lengths": [129, 150, 150, 115, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 112, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 53, 150, 148, 150, 150, 150, 136, 150, 150, 124, 98, 150, 150, 150, 109, 150, 115, 150, 150, 114, 97, 150, 150, 81, 150, 117, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 112, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 110, 150], "policy_policy_0_reward": [-385.3190878728757, -932.7943419086639, -255.3212433360328, -170.86103679521653, -314.9522013848751, -634.2677352432244, -317.59211367382323, -989.0827783467001, -737.5475624092379, -851.8854140799351, -871.2878569810913, -276.85110869257727, -790.2108708096907, -803.9387223570856, -1013.2516332567914, -1109.7786127479844, -859.45258108134, -904.277903925238, -44.21271451372338, -498.53351710937494, -663.7474667008424, -445.517953979921, -689.7941234928304, -1098.58829479143, -1041.198358175105, -894.8324385316015, -584.1782849113902, -124.77867032135481, -733.3861569091778, -1134.6539987492936, -1261.9053434802142, -823.6697916394387, -916.2356832482031, -62.1299303145018, -796.7123049486858, -178.91850958844583, -1079.0096335584194, -986.4618157818795, -1265.8464633277727, -623.2881675035957, -707.6911715276668, -493.2844923694086, -396.94827928102194, -255.68988472747043, -750.2194435952107, -982.4808316159924, -417.6527569756987, -356.17473378400905, -479.37713667229445, -368.0619692586788, -910.5284113147961, -506.5500167458756, -225.87012129679573, -209.7333677085087, -807.5135750370838, -1012.6021401514824, -61.8253197753757, -925.8376796944141, -491.10912690367365, -608.9248382693249, -583.7367284294447, -704.058473133923, -872.9164651650382, -285.70215600526774, -978.3086025853609, -754.3014900725789, -903.2183318659584, -1015.8863366401395, -1156.1185427284106, -977.5128523875392, -1010.2433670561385, -467.07721143452534, -1008.5073604643269, -572.4661557539815, -842.6917454299987, -665.6091927165961, -342.2340767797028, -432.23609164738247, -125.97514078731584, -899.6059144125128, -1251.6006553990867, -1091.8151416109029, -839.6997619933455, -534.2969223064093, -1151.2253997259595, -1008.1545118276596, -787.1769016037553, -847.7530925585849, -908.182963526302, -921.7314634071441, -1124.8081179109563, -647.156112423149, -149.31865058404043, -799.2592154930499, -316.3011382196215, -827.1489859083471, -1058.5014715118696, -821.5687541883478, -435.1228402276172, -719.3903370642553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5517549128962522, "mean_inference_ms": 1.663401104245215, "mean_action_processing_ms": 0.28170629213602916, "mean_env_wait_ms": 2.943442230740278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013226985931396484, "StateBufferConnector_ms": 0.008676528930664062, "ViewRequirementAgentConnector_ms": 0.18748712539672852}, "num_episodes": 33, "episode_return_max": -44.21271451372338, "episode_return_min": -1265.8464633277727, "episode_return_mean": -699.7296639617092, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.1531799840186, "num_env_steps_trained_throughput_per_sec": 306.1531799840186, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12169.606, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12169.539, "sample_time_ms": 1009.538, "learn_time_ms": 11094.086, "learn_throughput": 360.552, "synch_weights_time_ms": 65.01}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00001", "date": "2024-08-03_10-20-43", "timestamp": 1722660643, "time_this_iter_s": 13.078839778900146, "time_total_s": 60.911924839019775, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf549d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 60.911924839019775, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.177777777777777, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 122.45719443162282, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.078179657831788, "policy_loss": -0.005678969245248785, "vf_loss": 3.082527478039265, "vf_explained_var": 0.9770597603792945, "kl": 0.013879474158450951, "entropy": 1.444743487983942, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -6.219004748213785, "episode_reward_min": -1265.8464633277727, "episode_reward_mean": -717.2888192038367, "episode_len_mean": 138.81, "episode_media": {}, "episodes_timesteps_total": 13881, "policy_reward_min": {"policy_0": -1265.8464633277727}, "policy_reward_max": {"policy_0": -6.219004748213785}, "policy_reward_mean": {"policy_0": -717.2888192038367}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1134.6539987492936, -1261.9053434802142, -823.6697916394387, -916.2356832482031, -62.1299303145018, -796.7123049486858, -178.91850958844583, -1079.0096335584194, -986.4618157818795, -1265.8464633277727, -623.2881675035957, -707.6911715276668, -493.2844923694086, -396.94827928102194, -255.68988472747043, -750.2194435952107, -982.4808316159924, -417.6527569756987, -356.17473378400905, -479.37713667229445, -368.0619692586788, -910.5284113147961, -506.5500167458756, -225.87012129679573, -209.7333677085087, -807.5135750370838, -1012.6021401514824, -61.8253197753757, -925.8376796944141, -491.10912690367365, -608.9248382693249, -583.7367284294447, -704.058473133923, -872.9164651650382, -285.70215600526774, -978.3086025853609, -754.3014900725789, -903.2183318659584, -1015.8863366401395, -1156.1185427284106, -977.5128523875392, -1010.2433670561385, -467.07721143452534, -1008.5073604643269, -572.4661557539815, -842.6917454299987, -665.6091927165961, -342.2340767797028, -432.23609164738247, -125.97514078731584, -899.6059144125128, -1251.6006553990867, -1091.8151416109029, -839.6997619933455, -534.2969223064093, -1151.2253997259595, -1008.1545118276596, -787.1769016037553, -847.7530925585849, -908.182963526302, -921.7314634071441, -1124.8081179109563, -647.156112423149, -149.31865058404043, -799.2592154930499, -316.3011382196215, -827.1489859083471, -1058.5014715118696, -821.5687541883478, -435.1228402276172, -719.3903370642553, -969.7651461769968, -90.73310307028353, -987.0414027342641, -932.9822503605694, -512.4031940297997, -710.7763915933873, -761.4924352193764, -904.4532309861313, -845.1837648444134, -980.0112395508852, -985.4946850738417, -1075.279475719199, -927.8191253456936, -6.219004748213785, -658.6592427683509, -933.9893784175456, -1135.5789337012316, -662.3031057223566, -415.0564780228786, -437.7332940808134, -592.2806658413683, -258.0273306640398, -1095.4913229590318, -955.5691493700743, -1081.7857024316238, -619.2160779605233, -270.99166811888165, -458.1117344665322, -528.9077745735939], "episode_lengths": [150, 150, 150, 150, 53, 150, 148, 150, 150, 150, 136, 150, 150, 124, 98, 150, 150, 150, 109, 150, 115, 150, 150, 114, 97, 150, 150, 81, 150, 117, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 112, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 110, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 131, 144, 81, 150, 150, 150, 150, 90, 150, 150], "policy_policy_0_reward": [-1134.6539987492936, -1261.9053434802142, -823.6697916394387, -916.2356832482031, -62.1299303145018, -796.7123049486858, -178.91850958844583, -1079.0096335584194, -986.4618157818795, -1265.8464633277727, -623.2881675035957, -707.6911715276668, -493.2844923694086, -396.94827928102194, -255.68988472747043, -750.2194435952107, -982.4808316159924, -417.6527569756987, -356.17473378400905, -479.37713667229445, -368.0619692586788, -910.5284113147961, -506.5500167458756, -225.87012129679573, -209.7333677085087, -807.5135750370838, -1012.6021401514824, -61.8253197753757, -925.8376796944141, -491.10912690367365, -608.9248382693249, -583.7367284294447, -704.058473133923, -872.9164651650382, -285.70215600526774, -978.3086025853609, -754.3014900725789, -903.2183318659584, -1015.8863366401395, -1156.1185427284106, -977.5128523875392, -1010.2433670561385, -467.07721143452534, -1008.5073604643269, -572.4661557539815, -842.6917454299987, -665.6091927165961, -342.2340767797028, -432.23609164738247, -125.97514078731584, -899.6059144125128, -1251.6006553990867, -1091.8151416109029, -839.6997619933455, -534.2969223064093, -1151.2253997259595, -1008.1545118276596, -787.1769016037553, -847.7530925585849, -908.182963526302, -921.7314634071441, -1124.8081179109563, -647.156112423149, -149.31865058404043, -799.2592154930499, -316.3011382196215, -827.1489859083471, -1058.5014715118696, -821.5687541883478, -435.1228402276172, -719.3903370642553, -969.7651461769968, -90.73310307028353, -987.0414027342641, -932.9822503605694, -512.4031940297997, -710.7763915933873, -761.4924352193764, -904.4532309861313, -845.1837648444134, -980.0112395508852, -985.4946850738417, -1075.279475719199, -927.8191253456936, -6.219004748213785, -658.6592427683509, -933.9893784175456, -1135.5789337012316, -662.3031057223566, -415.0564780228786, -437.7332940808134, -592.2806658413683, -258.0273306640398, -1095.4913229590318, -955.5691493700743, -1081.7857024316238, -619.2160779605233, -270.99166811888165, -458.1117344665322, -528.9077745735939]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520152168934638, "mean_inference_ms": 1.6679979144101933, "mean_action_processing_ms": 0.28230631235416465, "mean_env_wait_ms": 2.9502966796395396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01306605339050293, "StateBufferConnector_ms": 0.008657217025756836, "ViewRequirementAgentConnector_ms": 0.18732213973999023}, "num_episodes": 29, "episode_return_max": -6.219004748213785, "episode_return_min": -1265.8464633277727, "episode_return_mean": -717.2888192038367, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.81600696932884, "num_env_steps_trained_throughput_per_sec": 301.81600696932884, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12350.192, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12350.124, "sample_time_ms": 1012.031, "learn_time_ms": 11269.343, "learn_throughput": 354.945, "synch_weights_time_ms": 67.854}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00001", "date": "2024-08-03_10-20-56", "timestamp": 1722660656, "time_this_iter_s": 13.266793012619019, "time_total_s": 74.1787178516388, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf55990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 74.1787178516388, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.1, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 126.7604157368342, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.242501659691334, "policy_loss": -0.005521056975703686, "vf_loss": 2.247207655136784, "vf_explained_var": 0.9800859166309237, "kl": 0.010725384169442501, "entropy": 1.3300168310602507, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -6.219004748213785, "episode_reward_min": -1265.9709773049208, "episode_reward_mean": -730.9646403921807, "episode_len_mean": 138.8, "episode_media": {}, "episodes_timesteps_total": 13880, "policy_reward_min": {"policy_0": -1265.9709773049208}, "policy_reward_max": {"policy_0": -6.219004748213785}, "policy_reward_mean": {"policy_0": -730.9646403921807}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-925.8376796944141, -491.10912690367365, -608.9248382693249, -583.7367284294447, -704.058473133923, -872.9164651650382, -285.70215600526774, -978.3086025853609, -754.3014900725789, -903.2183318659584, -1015.8863366401395, -1156.1185427284106, -977.5128523875392, -1010.2433670561385, -467.07721143452534, -1008.5073604643269, -572.4661557539815, -842.6917454299987, -665.6091927165961, -342.2340767797028, -432.23609164738247, -125.97514078731584, -899.6059144125128, -1251.6006553990867, -1091.8151416109029, -839.6997619933455, -534.2969223064093, -1151.2253997259595, -1008.1545118276596, -787.1769016037553, -847.7530925585849, -908.182963526302, -921.7314634071441, -1124.8081179109563, -647.156112423149, -149.31865058404043, -799.2592154930499, -316.3011382196215, -827.1489859083471, -1058.5014715118696, -821.5687541883478, -435.1228402276172, -719.3903370642553, -969.7651461769968, -90.73310307028353, -987.0414027342641, -932.9822503605694, -512.4031940297997, -710.7763915933873, -761.4924352193764, -904.4532309861313, -845.1837648444134, -980.0112395508852, -985.4946850738417, -1075.279475719199, -927.8191253456936, -6.219004748213785, -658.6592427683509, -933.9893784175456, -1135.5789337012316, -662.3031057223566, -415.0564780228786, -437.7332940808134, -592.2806658413683, -258.0273306640398, -1095.4913229590318, -955.5691493700743, -1081.7857024316238, -619.2160779605233, -270.99166811888165, -458.1117344665322, -528.9077745735939, -571.4518481832621, -575.93492606719, -1100.4867049758784, -428.36795603151387, -697.9227237923059, -797.7611569363188, -159.02828606773727, -809.5805600226746, -1080.0981540231494, -310.9593585999166, -886.1765630353295, -62.33691914189846, -690.5276199243327, -153.97823008587423, -491.4843331646828, -1041.124464383904, -868.5701248751487, -816.3499209334689, -1008.4385058349216, -937.2193416937607, -1265.9709773049208, -1116.1646235793614, -444.20354171924726, -384.9280986066295, -954.4752232483793, -191.5224579644674, -705.965872221395, -887.5889203945608], "episode_lengths": [150, 117, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 112, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 110, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 131, 144, 81, 150, 150, 150, 150, 90, 150, 150, 150, 121, 150, 150, 150, 150, 58, 150, 150, 112, 150, 52, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 92, 150, 150], "policy_policy_0_reward": [-925.8376796944141, -491.10912690367365, -608.9248382693249, -583.7367284294447, -704.058473133923, -872.9164651650382, -285.70215600526774, -978.3086025853609, -754.3014900725789, -903.2183318659584, -1015.8863366401395, -1156.1185427284106, -977.5128523875392, -1010.2433670561385, -467.07721143452534, -1008.5073604643269, -572.4661557539815, -842.6917454299987, -665.6091927165961, -342.2340767797028, -432.23609164738247, -125.97514078731584, -899.6059144125128, -1251.6006553990867, -1091.8151416109029, -839.6997619933455, -534.2969223064093, -1151.2253997259595, -1008.1545118276596, -787.1769016037553, -847.7530925585849, -908.182963526302, -921.7314634071441, -1124.8081179109563, -647.156112423149, -149.31865058404043, -799.2592154930499, -316.3011382196215, -827.1489859083471, -1058.5014715118696, -821.5687541883478, -435.1228402276172, -719.3903370642553, -969.7651461769968, -90.73310307028353, -987.0414027342641, -932.9822503605694, -512.4031940297997, -710.7763915933873, -761.4924352193764, -904.4532309861313, -845.1837648444134, -980.0112395508852, -985.4946850738417, -1075.279475719199, -927.8191253456936, -6.219004748213785, -658.6592427683509, -933.9893784175456, -1135.5789337012316, -662.3031057223566, -415.0564780228786, -437.7332940808134, -592.2806658413683, -258.0273306640398, -1095.4913229590318, -955.5691493700743, -1081.7857024316238, -619.2160779605233, -270.99166811888165, -458.1117344665322, -528.9077745735939, -571.4518481832621, -575.93492606719, -1100.4867049758784, -428.36795603151387, -697.9227237923059, -797.7611569363188, -159.02828606773727, -809.5805600226746, -1080.0981540231494, -310.9593585999166, -886.1765630353295, -62.33691914189846, -690.5276199243327, -153.97823008587423, -491.4843331646828, -1041.124464383904, -868.5701248751487, -816.3499209334689, -1008.4385058349216, -937.2193416937607, -1265.9709773049208, -1116.1646235793614, -444.20354171924726, -384.9280986066295, -954.4752232483793, -191.5224579644674, -705.965872221395, -887.5889203945608]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523225306002542, "mean_inference_ms": 1.6743782913302538, "mean_action_processing_ms": 0.28275677721596343, "mean_env_wait_ms": 2.9565370023407724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01311182975769043, "StateBufferConnector_ms": 0.008484601974487305, "ViewRequirementAgentConnector_ms": 0.1896677017211914}, "num_episodes": 28, "episode_return_max": -6.219004748213785, "episode_return_min": -1265.9709773049208, "episode_return_mean": -730.9646403921807, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.76709429025703, "num_env_steps_trained_throughput_per_sec": 447.76709429025703, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 11862.055, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11861.985, "sample_time_ms": 1025.008, "learn_time_ms": 10769.14, "learn_throughput": 371.432, "synch_weights_time_ms": 66.933}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00001", "date": "2024-08-03_10-21-05", "timestamp": 1722660665, "time_this_iter_s": 8.945862770080566, "time_total_s": 83.12458062171936, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf55870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 83.12458062171936, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 16.42307692307692, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.10804406404495, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.47304713682582, "policy_loss": -0.011250575529993511, "vf_loss": 2.482692460219065, "vf_explained_var": 0.9812844324236115, "kl": 0.015017568200255483, "entropy": 1.3982702231655517, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -6.219004748213785, "episode_reward_min": -1265.9709773049208, "episode_reward_mean": -708.848521945258, "episode_len_mean": 136.34, "episode_media": {}, "episodes_timesteps_total": 13634, "policy_reward_min": {"policy_0": -1265.9709773049208}, "policy_reward_max": {"policy_0": -6.219004748213785}, "policy_reward_mean": {"policy_0": -708.848521945258}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1008.1545118276596, -787.1769016037553, -847.7530925585849, -908.182963526302, -921.7314634071441, -1124.8081179109563, -647.156112423149, -149.31865058404043, -799.2592154930499, -316.3011382196215, -827.1489859083471, -1058.5014715118696, -821.5687541883478, -435.1228402276172, -719.3903370642553, -969.7651461769968, -90.73310307028353, -987.0414027342641, -932.9822503605694, -512.4031940297997, -710.7763915933873, -761.4924352193764, -904.4532309861313, -845.1837648444134, -980.0112395508852, -985.4946850738417, -1075.279475719199, -927.8191253456936, -6.219004748213785, -658.6592427683509, -933.9893784175456, -1135.5789337012316, -662.3031057223566, -415.0564780228786, -437.7332940808134, -592.2806658413683, -258.0273306640398, -1095.4913229590318, -955.5691493700743, -1081.7857024316238, -619.2160779605233, -270.99166811888165, -458.1117344665322, -528.9077745735939, -571.4518481832621, -575.93492606719, -1100.4867049758784, -428.36795603151387, -697.9227237923059, -797.7611569363188, -159.02828606773727, -809.5805600226746, -1080.0981540231494, -310.9593585999166, -886.1765630353295, -62.33691914189846, -690.5276199243327, -153.97823008587423, -491.4843331646828, -1041.124464383904, -868.5701248751487, -816.3499209334689, -1008.4385058349216, -937.2193416937607, -1265.9709773049208, -1116.1646235793614, -444.20354171924726, -384.9280986066295, -954.4752232483793, -191.5224579644674, -705.965872221395, -887.5889203945608, -368.3105296464846, -611.1691441646359, -742.0953646669989, -916.9744849320994, -906.6190976141572, -489.1620109405244, -108.94329246441563, -486.3920867362585, -580.6643790310383, -939.6704489313587, -994.7542585577847, -860.801895539891, -606.0021413514377, -349.5494112781327, -973.658487606329, -1114.0110887226879, -1199.6356840144772, -185.4196053477649, -815.6861208319757, -1009.2860346303796, -728.7132362039841, -729.4387338387213, -11.272562264276843, -24.00410560424785, -982.1950605295187, -735.0506616474121, -988.8779129611396, -822.9460766488316], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 110, 150, 150, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 131, 144, 81, 150, 150, 150, 150, 90, 150, 150, 150, 121, 150, 150, 150, 150, 58, 150, 150, 112, 150, 52, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 92, 150, 150, 103, 149, 150, 150, 150, 150, 73, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 41, 45, 150, 150, 150, 150], "policy_policy_0_reward": [-1008.1545118276596, -787.1769016037553, -847.7530925585849, -908.182963526302, -921.7314634071441, -1124.8081179109563, -647.156112423149, -149.31865058404043, -799.2592154930499, -316.3011382196215, -827.1489859083471, -1058.5014715118696, -821.5687541883478, -435.1228402276172, -719.3903370642553, -969.7651461769968, -90.73310307028353, -987.0414027342641, -932.9822503605694, -512.4031940297997, -710.7763915933873, -761.4924352193764, -904.4532309861313, -845.1837648444134, -980.0112395508852, -985.4946850738417, -1075.279475719199, -927.8191253456936, -6.219004748213785, -658.6592427683509, -933.9893784175456, -1135.5789337012316, -662.3031057223566, -415.0564780228786, -437.7332940808134, -592.2806658413683, -258.0273306640398, -1095.4913229590318, -955.5691493700743, -1081.7857024316238, -619.2160779605233, -270.99166811888165, -458.1117344665322, -528.9077745735939, -571.4518481832621, -575.93492606719, -1100.4867049758784, -428.36795603151387, -697.9227237923059, -797.7611569363188, -159.02828606773727, -809.5805600226746, -1080.0981540231494, -310.9593585999166, -886.1765630353295, -62.33691914189846, -690.5276199243327, -153.97823008587423, -491.4843331646828, -1041.124464383904, -868.5701248751487, -816.3499209334689, -1008.4385058349216, -937.2193416937607, -1265.9709773049208, -1116.1646235793614, -444.20354171924726, -384.9280986066295, -954.4752232483793, -191.5224579644674, -705.965872221395, -887.5889203945608, -368.3105296464846, -611.1691441646359, -742.0953646669989, -916.9744849320994, -906.6190976141572, -489.1620109405244, -108.94329246441563, -486.3920867362585, -580.6643790310383, -939.6704489313587, -994.7542585577847, -860.801895539891, -606.0021413514377, -349.5494112781327, -973.658487606329, -1114.0110887226879, -1199.6356840144772, -185.4196053477649, -815.6861208319757, -1009.2860346303796, -728.7132362039841, -729.4387338387213, -11.272562264276843, -24.00410560424785, -982.1950605295187, -735.0506616474121, -988.8779129611396, -822.9460766488316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523406107378809, "mean_inference_ms": 1.6803446517934506, "mean_action_processing_ms": 0.28313144424357306, "mean_env_wait_ms": 2.9621613673529454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012495756149291992, "StateBufferConnector_ms": 0.008352518081665039, "ViewRequirementAgentConnector_ms": 0.19046783447265625}, "num_episodes": 28, "episode_return_max": -6.219004748213785, "episode_return_min": -1265.9709773049208, "episode_return_mean": -708.848521945258, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.20470071450785, "num_env_steps_trained_throughput_per_sec": 377.20470071450785, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 11704.84, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11704.768, "sample_time_ms": 1022.213, "learn_time_ms": 10617.261, "learn_throughput": 376.745, "synch_weights_time_ms": 64.409}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00001", "date": "2024-08-03_10-21-16", "timestamp": 1722660676, "time_this_iter_s": 10.617275714874268, "time_total_s": 93.74185633659363, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0fe20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 93.74185633659363, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 15.513333333333334, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.59944662849108, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.747491695607702, "policy_loss": -0.010560179543487418, "vf_loss": 2.756479113548994, "vf_explained_var": 0.9901774390911062, "kl": 0.014826376174702697, "entropy": 1.3925125340620677, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -11.272562264276843, "episode_reward_min": -1265.9709773049208, "episode_reward_mean": -686.4054364392192, "episode_len_mean": 135.01, "episode_media": {}, "episodes_timesteps_total": 13501, "policy_reward_min": {"policy_0": -1265.9709773049208}, "policy_reward_max": {"policy_0": -11.272562264276843}, "policy_reward_mean": {"policy_0": -686.4054364392192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-658.6592427683509, -933.9893784175456, -1135.5789337012316, -662.3031057223566, -415.0564780228786, -437.7332940808134, -592.2806658413683, -258.0273306640398, -1095.4913229590318, -955.5691493700743, -1081.7857024316238, -619.2160779605233, -270.99166811888165, -458.1117344665322, -528.9077745735939, -571.4518481832621, -575.93492606719, -1100.4867049758784, -428.36795603151387, -697.9227237923059, -797.7611569363188, -159.02828606773727, -809.5805600226746, -1080.0981540231494, -310.9593585999166, -886.1765630353295, -62.33691914189846, -690.5276199243327, -153.97823008587423, -491.4843331646828, -1041.124464383904, -868.5701248751487, -816.3499209334689, -1008.4385058349216, -937.2193416937607, -1265.9709773049208, -1116.1646235793614, -444.20354171924726, -384.9280986066295, -954.4752232483793, -191.5224579644674, -705.965872221395, -887.5889203945608, -368.3105296464846, -611.1691441646359, -742.0953646669989, -916.9744849320994, -906.6190976141572, -489.1620109405244, -108.94329246441563, -486.3920867362585, -580.6643790310383, -939.6704489313587, -994.7542585577847, -860.801895539891, -606.0021413514377, -349.5494112781327, -973.658487606329, -1114.0110887226879, -1199.6356840144772, -185.4196053477649, -815.6861208319757, -1009.2860346303796, -728.7132362039841, -729.4387338387213, -11.272562264276843, -24.00410560424785, -982.1950605295187, -735.0506616474121, -988.8779129611396, -822.9460766488316, -645.8826753440599, -537.0379699206562, -640.766142516865, -506.6681785334382, -1150.3917053910318, -850.2811750618375, -99.42860838708219, -1040.8962674877423, -1222.651617343885, -279.6773564845768, -251.0421112724116, -1212.7665408747175, -356.7737407141002, -50.74626398554117, -1230.7945922338497, -72.8114770144559, -613.1262528839696, -802.5532074356335, -12.222582955277971, -754.555647528741, -449.1261560393608, -860.066490456571, -1094.1318054801309, -351.5940373315179, -1047.9355621600205, -1234.9929633420968, -875.9336025984453, -498.6617817344146, -1073.4039427914527], "episode_lengths": [150, 150, 150, 150, 150, 131, 144, 81, 150, 150, 150, 150, 90, 150, 150, 150, 121, 150, 150, 150, 150, 58, 150, 150, 112, 150, 52, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 92, 150, 150, 103, 149, 150, 150, 150, 150, 73, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 41, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 101, 94, 150, 150, 55, 150, 73, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-658.6592427683509, -933.9893784175456, -1135.5789337012316, -662.3031057223566, -415.0564780228786, -437.7332940808134, -592.2806658413683, -258.0273306640398, -1095.4913229590318, -955.5691493700743, -1081.7857024316238, -619.2160779605233, -270.99166811888165, -458.1117344665322, -528.9077745735939, -571.4518481832621, -575.93492606719, -1100.4867049758784, -428.36795603151387, -697.9227237923059, -797.7611569363188, -159.02828606773727, -809.5805600226746, -1080.0981540231494, -310.9593585999166, -886.1765630353295, -62.33691914189846, -690.5276199243327, -153.97823008587423, -491.4843331646828, -1041.124464383904, -868.5701248751487, -816.3499209334689, -1008.4385058349216, -937.2193416937607, -1265.9709773049208, -1116.1646235793614, -444.20354171924726, -384.9280986066295, -954.4752232483793, -191.5224579644674, -705.965872221395, -887.5889203945608, -368.3105296464846, -611.1691441646359, -742.0953646669989, -916.9744849320994, -906.6190976141572, -489.1620109405244, -108.94329246441563, -486.3920867362585, -580.6643790310383, -939.6704489313587, -994.7542585577847, -860.801895539891, -606.0021413514377, -349.5494112781327, -973.658487606329, -1114.0110887226879, -1199.6356840144772, -185.4196053477649, -815.6861208319757, -1009.2860346303796, -728.7132362039841, -729.4387338387213, -11.272562264276843, -24.00410560424785, -982.1950605295187, -735.0506616474121, -988.8779129611396, -822.9460766488316, -645.8826753440599, -537.0379699206562, -640.766142516865, -506.6681785334382, -1150.3917053910318, -850.2811750618375, -99.42860838708219, -1040.8962674877423, -1222.651617343885, -279.6773564845768, -251.0421112724116, -1212.7665408747175, -356.7737407141002, -50.74626398554117, -1230.7945922338497, -72.8114770144559, -613.1262528839696, -802.5532074356335, -12.222582955277971, -754.555647528741, -449.1261560393608, -860.066490456571, -1094.1318054801309, -351.5940373315179, -1047.9355621600205, -1234.9929633420968, -875.9336025984453, -498.6617817344146, -1073.4039427914527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519820701944521, "mean_inference_ms": 1.6821798503060759, "mean_action_processing_ms": 0.2827772726140665, "mean_env_wait_ms": 2.9653786251998597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012143373489379883, "StateBufferConnector_ms": 0.00824117660522461, "ViewRequirementAgentConnector_ms": 0.1904127597808838}, "num_episodes": 29, "episode_return_max": -11.272562264276843, "episode_return_min": -1265.9709773049208, "episode_return_mean": -686.4054364392192, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.54044781218124, "num_env_steps_trained_throughput_per_sec": 310.54044781218124, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 11835.5, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11835.428, "sample_time_ms": 1019.316, "learn_time_ms": 10749.868, "learn_throughput": 372.098, "synch_weights_time_ms": 65.357}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00001", "date": "2024-08-03_10-21-29", "timestamp": 1722660689, "time_this_iter_s": 12.89441967010498, "time_total_s": 106.63627600669861, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0f5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 106.63627600669861, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.010526315789475, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 169.40580501556397, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.9415593763813377, "policy_loss": -0.01196143676158196, "vf_loss": 1.9517472358420491, "vf_explained_var": 0.9897326198716958, "kl": 0.015688429586407437, "entropy": 1.3641083937138319, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -11.272562264276843, "episode_reward_min": -1265.9709773049208, "episode_reward_mean": -704.5361570479512, "episode_len_mean": 136.65, "episode_media": {}, "episodes_timesteps_total": 13665, "policy_reward_min": {"policy_0": -1265.9709773049208}, "policy_reward_max": {"policy_0": -11.272562264276843}, "policy_reward_mean": {"policy_0": -704.5361570479512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-491.4843331646828, -1041.124464383904, -868.5701248751487, -816.3499209334689, -1008.4385058349216, -937.2193416937607, -1265.9709773049208, -1116.1646235793614, -444.20354171924726, -384.9280986066295, -954.4752232483793, -191.5224579644674, -705.965872221395, -887.5889203945608, -368.3105296464846, -611.1691441646359, -742.0953646669989, -916.9744849320994, -906.6190976141572, -489.1620109405244, -108.94329246441563, -486.3920867362585, -580.6643790310383, -939.6704489313587, -994.7542585577847, -860.801895539891, -606.0021413514377, -349.5494112781327, -973.658487606329, -1114.0110887226879, -1199.6356840144772, -185.4196053477649, -815.6861208319757, -1009.2860346303796, -728.7132362039841, -729.4387338387213, -11.272562264276843, -24.00410560424785, -982.1950605295187, -735.0506616474121, -988.8779129611396, -822.9460766488316, -645.8826753440599, -537.0379699206562, -640.766142516865, -506.6681785334382, -1150.3917053910318, -850.2811750618375, -99.42860838708219, -1040.8962674877423, -1222.651617343885, -279.6773564845768, -251.0421112724116, -1212.7665408747175, -356.7737407141002, -50.74626398554117, -1230.7945922338497, -72.8114770144559, -613.1262528839696, -802.5532074356335, -12.222582955277971, -754.555647528741, -449.1261560393608, -860.066490456571, -1094.1318054801309, -351.5940373315179, -1047.9355621600205, -1234.9929633420968, -875.9336025984453, -498.6617817344146, -1073.4039427914527, -1023.396178384843, -241.68812215358986, -523.1258490045745, -1005.069561338727, -1130.157196352717, -295.90908317738945, -817.9167334883374, -855.2400891306401, -468.48933680130364, -847.7056025957075, -814.222545076157, -1028.7720026013078, -651.0616873566364, -707.7393558545745, -918.3856378248289, -1019.8242918636199, -799.8643724255314, -587.7028468695847, -89.00726240704944, -633.364600801623, -1065.397124313859, -48.31381250714634, -987.2706828178494, -463.19609607534284, -393.46191867838996, -595.3814243014044, -800.291421834218, -918.4754119789849, -510.9546788434636], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 92, 150, 150, 103, 149, 150, 150, 150, 150, 73, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 41, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 101, 94, 150, 150, 55, 150, 73, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 150, 150, 72, 150, 109, 150, 150, 150, 150, 135], "policy_policy_0_reward": [-491.4843331646828, -1041.124464383904, -868.5701248751487, -816.3499209334689, -1008.4385058349216, -937.2193416937607, -1265.9709773049208, -1116.1646235793614, -444.20354171924726, -384.9280986066295, -954.4752232483793, -191.5224579644674, -705.965872221395, -887.5889203945608, -368.3105296464846, -611.1691441646359, -742.0953646669989, -916.9744849320994, -906.6190976141572, -489.1620109405244, -108.94329246441563, -486.3920867362585, -580.6643790310383, -939.6704489313587, -994.7542585577847, -860.801895539891, -606.0021413514377, -349.5494112781327, -973.658487606329, -1114.0110887226879, -1199.6356840144772, -185.4196053477649, -815.6861208319757, -1009.2860346303796, -728.7132362039841, -729.4387338387213, -11.272562264276843, -24.00410560424785, -982.1950605295187, -735.0506616474121, -988.8779129611396, -822.9460766488316, -645.8826753440599, -537.0379699206562, -640.766142516865, -506.6681785334382, -1150.3917053910318, -850.2811750618375, -99.42860838708219, -1040.8962674877423, -1222.651617343885, -279.6773564845768, -251.0421112724116, -1212.7665408747175, -356.7737407141002, -50.74626398554117, -1230.7945922338497, -72.8114770144559, -613.1262528839696, -802.5532074356335, -12.222582955277971, -754.555647528741, -449.1261560393608, -860.066490456571, -1094.1318054801309, -351.5940373315179, -1047.9355621600205, -1234.9929633420968, -875.9336025984453, -498.6617817344146, -1073.4039427914527, -1023.396178384843, -241.68812215358986, -523.1258490045745, -1005.069561338727, -1130.157196352717, -295.90908317738945, -817.9167334883374, -855.2400891306401, -468.48933680130364, -847.7056025957075, -814.222545076157, -1028.7720026013078, -651.0616873566364, -707.7393558545745, -918.3856378248289, -1019.8242918636199, -799.8643724255314, -587.7028468695847, -89.00726240704944, -633.364600801623, -1065.397124313859, -48.31381250714634, -987.2706828178494, -463.19609607534284, -393.46191867838996, -595.3814243014044, -800.291421834218, -918.4754119789849, -510.9546788434636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526023525334388, "mean_inference_ms": 1.684398209511953, "mean_action_processing_ms": 0.28256262190391834, "mean_env_wait_ms": 2.9696253929872016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01200246810913086, "StateBufferConnector_ms": 0.008088350296020508, "ViewRequirementAgentConnector_ms": 0.19040513038635254}, "num_episodes": 29, "episode_return_max": -11.272562264276843, "episode_return_min": -1265.9709773049208, "episode_return_mean": -704.5361570479512, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.05714274378124, "num_env_steps_trained_throughput_per_sec": 311.05714274378124, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 11937.889, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11937.816, "sample_time_ms": 1022.312, "learn_time_ms": 10847.56, "learn_throughput": 368.747, "synch_weights_time_ms": 67.069}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00001", "date": "2024-08-03_10-21-42", "timestamp": 1722660702, "time_this_iter_s": 12.872259378433228, "time_total_s": 119.50853538513184, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf54e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 119.50853538513184, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.494444444444445, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 160.69282885392508, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.346561185643077, "policy_loss": -0.008107665881349627, "vf_loss": 2.3529557550946874, "vf_explained_var": 0.983598931444188, "kl": 0.015236566437124571, "entropy": 1.334207709133625, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -11.272562264276843, "episode_reward_min": -1307.1297069333912, "episode_reward_mean": -697.6205741262961, "episode_len_mean": 137.22, "episode_media": {}, "episodes_timesteps_total": 13722, "policy_reward_min": {"policy_0": -1307.1297069333912}, "policy_reward_max": {"policy_0": -11.272562264276843}, "policy_reward_mean": {"policy_0": -697.6205741262961}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.4196053477649, -815.6861208319757, -1009.2860346303796, -728.7132362039841, -729.4387338387213, -11.272562264276843, -24.00410560424785, -982.1950605295187, -735.0506616474121, -988.8779129611396, -822.9460766488316, -645.8826753440599, -537.0379699206562, -640.766142516865, -506.6681785334382, -1150.3917053910318, -850.2811750618375, -99.42860838708219, -1040.8962674877423, -1222.651617343885, -279.6773564845768, -251.0421112724116, -1212.7665408747175, -356.7737407141002, -50.74626398554117, -1230.7945922338497, -72.8114770144559, -613.1262528839696, -802.5532074356335, -12.222582955277971, -754.555647528741, -449.1261560393608, -860.066490456571, -1094.1318054801309, -351.5940373315179, -1047.9355621600205, -1234.9929633420968, -875.9336025984453, -498.6617817344146, -1073.4039427914527, -1023.396178384843, -241.68812215358986, -523.1258490045745, -1005.069561338727, -1130.157196352717, -295.90908317738945, -817.9167334883374, -855.2400891306401, -468.48933680130364, -847.7056025957075, -814.222545076157, -1028.7720026013078, -651.0616873566364, -707.7393558545745, -918.3856378248289, -1019.8242918636199, -799.8643724255314, -587.7028468695847, -89.00726240704944, -633.364600801623, -1065.397124313859, -48.31381250714634, -987.2706828178494, -463.19609607534284, -393.46191867838996, -595.3814243014044, -800.291421834218, -918.4754119789849, -510.9546788434636, -336.1189535383292, -824.4101976604973, -937.4088770431443, -552.8647902800574, -901.4599131467352, -608.1639621991151, -784.048407090911, -1018.0342060779018, -1209.3170129550988, -1307.1297069333912, -325.06029980230505, -716.0659677182055, -632.3996081295533, -742.8946221322609, -586.7386623445633, -809.7057896800176, -660.8788193592949, -846.1325308251702, -196.96614627336217, -909.374236052434, -999.5084884229344, -815.764207252165, -410.79756688532234, -341.96155909359464, -796.0950308635701, -248.84014142487555, -898.5925073627251, -909.8367344787164, -308.10547938013565, -978.0784205674578, -1058.1090749842444], "episode_lengths": [69, 150, 150, 150, 150, 41, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 101, 94, 150, 150, 55, 150, 73, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 150, 150, 72, 150, 109, 150, 150, 150, 150, 135, 101, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-185.4196053477649, -815.6861208319757, -1009.2860346303796, -728.7132362039841, -729.4387338387213, -11.272562264276843, -24.00410560424785, -982.1950605295187, -735.0506616474121, -988.8779129611396, -822.9460766488316, -645.8826753440599, -537.0379699206562, -640.766142516865, -506.6681785334382, -1150.3917053910318, -850.2811750618375, -99.42860838708219, -1040.8962674877423, -1222.651617343885, -279.6773564845768, -251.0421112724116, -1212.7665408747175, -356.7737407141002, -50.74626398554117, -1230.7945922338497, -72.8114770144559, -613.1262528839696, -802.5532074356335, -12.222582955277971, -754.555647528741, -449.1261560393608, -860.066490456571, -1094.1318054801309, -351.5940373315179, -1047.9355621600205, -1234.9929633420968, -875.9336025984453, -498.6617817344146, -1073.4039427914527, -1023.396178384843, -241.68812215358986, -523.1258490045745, -1005.069561338727, -1130.157196352717, -295.90908317738945, -817.9167334883374, -855.2400891306401, -468.48933680130364, -847.7056025957075, -814.222545076157, -1028.7720026013078, -651.0616873566364, -707.7393558545745, -918.3856378248289, -1019.8242918636199, -799.8643724255314, -587.7028468695847, -89.00726240704944, -633.364600801623, -1065.397124313859, -48.31381250714634, -987.2706828178494, -463.19609607534284, -393.46191867838996, -595.3814243014044, -800.291421834218, -918.4754119789849, -510.9546788434636, -336.1189535383292, -824.4101976604973, -937.4088770431443, -552.8647902800574, -901.4599131467352, -608.1639621991151, -784.048407090911, -1018.0342060779018, -1209.3170129550988, -1307.1297069333912, -325.06029980230505, -716.0659677182055, -632.3996081295533, -742.8946221322609, -586.7386623445633, -809.7057896800176, -660.8788193592949, -846.1325308251702, -196.96614627336217, -909.374236052434, -999.5084884229344, -815.764207252165, -410.79756688532234, -341.96155909359464, -796.0950308635701, -248.84014142487555, -898.5925073627251, -909.8367344787164, -308.10547938013565, -978.0784205674578, -1058.1090749842444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5524421406067952, "mean_inference_ms": 1.684713422094295, "mean_action_processing_ms": 0.28211057555534114, "mean_env_wait_ms": 2.970323230369705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012303829193115234, "StateBufferConnector_ms": 0.007968664169311523, "ViewRequirementAgentConnector_ms": 0.1901230812072754}, "num_episodes": 31, "episode_return_max": -11.272562264276843, "episode_return_min": -1307.1297069333912, "episode_return_mean": -697.6205741262961, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.96119827678007, "num_env_steps_trained_throughput_per_sec": 306.96119827678007, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 11960.762, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11960.689, "sample_time_ms": 1021.845, "learn_time_ms": 10870.461, "learn_throughput": 367.97, "synch_weights_time_ms": 67.511}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00001", "date": "2024-08-03_10-21-55", "timestamp": 1722660715, "time_this_iter_s": 13.042597770690918, "time_total_s": 132.55113315582275, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf544c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 132.55113315582275, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 13.311111111111112, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 159.85042864382268, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.909520341269672, "policy_loss": -0.0071437358623370525, "vf_loss": 1.9150167238588134, "vf_explained_var": 0.9887108816454808, "kl": 0.014798460001838976, "entropy": 1.3123375207185746, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -12.222582955277971, "episode_reward_min": -1307.1297069333912, "episode_reward_mean": -715.1952397176866, "episode_len_mean": 141.4, "episode_media": {}, "episodes_timesteps_total": 14140, "policy_reward_min": {"policy_0": -1307.1297069333912}, "policy_reward_max": {"policy_0": -12.222582955277971}, "policy_reward_mean": {"policy_0": -715.1952397176866}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.222582955277971, -754.555647528741, -449.1261560393608, -860.066490456571, -1094.1318054801309, -351.5940373315179, -1047.9355621600205, -1234.9929633420968, -875.9336025984453, -498.6617817344146, -1073.4039427914527, -1023.396178384843, -241.68812215358986, -523.1258490045745, -1005.069561338727, -1130.157196352717, -295.90908317738945, -817.9167334883374, -855.2400891306401, -468.48933680130364, -847.7056025957075, -814.222545076157, -1028.7720026013078, -651.0616873566364, -707.7393558545745, -918.3856378248289, -1019.8242918636199, -799.8643724255314, -587.7028468695847, -89.00726240704944, -633.364600801623, -1065.397124313859, -48.31381250714634, -987.2706828178494, -463.19609607534284, -393.46191867838996, -595.3814243014044, -800.291421834218, -918.4754119789849, -510.9546788434636, -336.1189535383292, -824.4101976604973, -937.4088770431443, -552.8647902800574, -901.4599131467352, -608.1639621991151, -784.048407090911, -1018.0342060779018, -1209.3170129550988, -1307.1297069333912, -325.06029980230505, -716.0659677182055, -632.3996081295533, -742.8946221322609, -586.7386623445633, -809.7057896800176, -660.8788193592949, -846.1325308251702, -196.96614627336217, -909.374236052434, -999.5084884229344, -815.764207252165, -410.79756688532234, -341.96155909359464, -796.0950308635701, -248.84014142487555, -898.5925073627251, -909.8367344787164, -308.10547938013565, -978.0784205674578, -1058.1090749842444, -317.6853175868073, -1030.7313752823954, -427.55432374632846, -1081.0415735021081, -758.8060693692357, -975.0068302787907, -567.4270258215146, -583.8302901442675, -357.02049268218684, -683.4623790633473, -246.89967251951097, -471.88529970026724, -1022.4484836180122, -854.6053794126292, -925.9794130504865, -757.1533158239407, -348.33062081305553, -883.0900919269651, -659.9021494906158, -387.7357314800699, -968.8749345192214, -653.1722687226086, -862.783302326835, -117.6093145107333, -1067.5238054958984, -532.514364650349, -865.6131882141202, -853.9816655463493, -1091.9838732344974], "episode_lengths": [50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 150, 150, 72, 150, 109, 150, 150, 150, 150, 135, 101, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 124, 150, 128, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 125, 150, 150, 150], "policy_policy_0_reward": [-12.222582955277971, -754.555647528741, -449.1261560393608, -860.066490456571, -1094.1318054801309, -351.5940373315179, -1047.9355621600205, -1234.9929633420968, -875.9336025984453, -498.6617817344146, -1073.4039427914527, -1023.396178384843, -241.68812215358986, -523.1258490045745, -1005.069561338727, -1130.157196352717, -295.90908317738945, -817.9167334883374, -855.2400891306401, -468.48933680130364, -847.7056025957075, -814.222545076157, -1028.7720026013078, -651.0616873566364, -707.7393558545745, -918.3856378248289, -1019.8242918636199, -799.8643724255314, -587.7028468695847, -89.00726240704944, -633.364600801623, -1065.397124313859, -48.31381250714634, -987.2706828178494, -463.19609607534284, -393.46191867838996, -595.3814243014044, -800.291421834218, -918.4754119789849, -510.9546788434636, -336.1189535383292, -824.4101976604973, -937.4088770431443, -552.8647902800574, -901.4599131467352, -608.1639621991151, -784.048407090911, -1018.0342060779018, -1209.3170129550988, -1307.1297069333912, -325.06029980230505, -716.0659677182055, -632.3996081295533, -742.8946221322609, -586.7386623445633, -809.7057896800176, -660.8788193592949, -846.1325308251702, -196.96614627336217, -909.374236052434, -999.5084884229344, -815.764207252165, -410.79756688532234, -341.96155909359464, -796.0950308635701, -248.84014142487555, -898.5925073627251, -909.8367344787164, -308.10547938013565, -978.0784205674578, -1058.1090749842444, -317.6853175868073, -1030.7313752823954, -427.55432374632846, -1081.0415735021081, -758.8060693692357, -975.0068302787907, -567.4270258215146, -583.8302901442675, -357.02049268218684, -683.4623790633473, -246.89967251951097, -471.88529970026724, -1022.4484836180122, -854.6053794126292, -925.9794130504865, -757.1533158239407, -348.33062081305553, -883.0900919269651, -659.9021494906158, -387.7357314800699, -968.8749345192214, -653.1722687226086, -862.783302326835, -117.6093145107333, -1067.5238054958984, -532.514364650349, -865.6131882141202, -853.9816655463493, -1091.9838732344974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522907200488322, "mean_inference_ms": 1.685278856433851, "mean_action_processing_ms": 0.28164906821017377, "mean_env_wait_ms": 2.9701654312545185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01205587387084961, "StateBufferConnector_ms": 0.007892370223999023, "ViewRequirementAgentConnector_ms": 0.1903824806213379}, "num_episodes": 29, "episode_return_max": -12.222582955277971, "episode_return_min": -1307.1297069333912, "episode_return_mean": -715.1952397176866, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.80244852163435, "num_env_steps_trained_throughput_per_sec": 307.80244852163435, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 11994.803, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11994.73, "sample_time_ms": 1021.004, "learn_time_ms": 10906.437, "learn_throughput": 366.756, "synch_weights_time_ms": 66.444}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00001", "date": "2024-08-03_10-22-08", "timestamp": 1722660728, "time_this_iter_s": 13.008185148239136, "time_total_s": 145.5593183040619, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf56f80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 145.5593183040619, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 12.936842105263159, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 160.77537654240925, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.886358202000459, "policy_loss": -0.013445077399956063, "vf_loss": 1.8984363169719776, "vf_explained_var": 0.9931639946376284, "kl": 0.013416066121817501, "entropy": 1.3162572355320057, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -48.31381250714634, "episode_reward_min": -1314.161612162291, "episode_reward_mean": -711.9970644610023, "episode_len_mean": 141.65, "episode_media": {}, "episodes_timesteps_total": 14165, "policy_reward_min": {"policy_0": -1314.161612162291}, "policy_reward_max": {"policy_0": -48.31381250714634}, "policy_reward_mean": {"policy_0": -711.9970644610023}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-799.8643724255314, -587.7028468695847, -89.00726240704944, -633.364600801623, -1065.397124313859, -48.31381250714634, -987.2706828178494, -463.19609607534284, -393.46191867838996, -595.3814243014044, -800.291421834218, -918.4754119789849, -510.9546788434636, -336.1189535383292, -824.4101976604973, -937.4088770431443, -552.8647902800574, -901.4599131467352, -608.1639621991151, -784.048407090911, -1018.0342060779018, -1209.3170129550988, -1307.1297069333912, -325.06029980230505, -716.0659677182055, -632.3996081295533, -742.8946221322609, -586.7386623445633, -809.7057896800176, -660.8788193592949, -846.1325308251702, -196.96614627336217, -909.374236052434, -999.5084884229344, -815.764207252165, -410.79756688532234, -341.96155909359464, -796.0950308635701, -248.84014142487555, -898.5925073627251, -909.8367344787164, -308.10547938013565, -978.0784205674578, -1058.1090749842444, -317.6853175868073, -1030.7313752823954, -427.55432374632846, -1081.0415735021081, -758.8060693692357, -975.0068302787907, -567.4270258215146, -583.8302901442675, -357.02049268218684, -683.4623790633473, -246.89967251951097, -471.88529970026724, -1022.4484836180122, -854.6053794126292, -925.9794130504865, -757.1533158239407, -348.33062081305553, -883.0900919269651, -659.9021494906158, -387.7357314800699, -968.8749345192214, -653.1722687226086, -862.783302326835, -117.6093145107333, -1067.5238054958984, -532.514364650349, -865.6131882141202, -853.9816655463493, -1091.9838732344974, -1066.3328732715065, -362.3601135289495, -976.2314665539963, -1031.7386574008408, -1314.161612162291, -764.5995140291263, -761.8634136990165, -800.2058692868782, -901.3996807240259, -389.6686450931784, -1015.7181831247382, -820.7568009339866, -612.7798588753654, -826.4678996758303, -1051.1639163032319, -798.804275231216, -965.0377780465521, -238.7118674131879, -1047.424623838229, -755.4264988909174, -284.2093980439104, -763.5619750312536, -705.4889068340302, -651.7580646384141, -800.6991284371741, -487.49109458751803, -87.44820409916582], "episode_lengths": [150, 150, 51, 150, 150, 72, 150, 109, 150, 150, 150, 150, 135, 101, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 124, 150, 128, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 134, 150, 150, 150, 150, 127, 77], "policy_policy_0_reward": [-799.8643724255314, -587.7028468695847, -89.00726240704944, -633.364600801623, -1065.397124313859, -48.31381250714634, -987.2706828178494, -463.19609607534284, -393.46191867838996, -595.3814243014044, -800.291421834218, -918.4754119789849, -510.9546788434636, -336.1189535383292, -824.4101976604973, -937.4088770431443, -552.8647902800574, -901.4599131467352, -608.1639621991151, -784.048407090911, -1018.0342060779018, -1209.3170129550988, -1307.1297069333912, -325.06029980230505, -716.0659677182055, -632.3996081295533, -742.8946221322609, -586.7386623445633, -809.7057896800176, -660.8788193592949, -846.1325308251702, -196.96614627336217, -909.374236052434, -999.5084884229344, -815.764207252165, -410.79756688532234, -341.96155909359464, -796.0950308635701, -248.84014142487555, -898.5925073627251, -909.8367344787164, -308.10547938013565, -978.0784205674578, -1058.1090749842444, -317.6853175868073, -1030.7313752823954, -427.55432374632846, -1081.0415735021081, -758.8060693692357, -975.0068302787907, -567.4270258215146, -583.8302901442675, -357.02049268218684, -683.4623790633473, -246.89967251951097, -471.88529970026724, -1022.4484836180122, -854.6053794126292, -925.9794130504865, -757.1533158239407, -348.33062081305553, -883.0900919269651, -659.9021494906158, -387.7357314800699, -968.8749345192214, -653.1722687226086, -862.783302326835, -117.6093145107333, -1067.5238054958984, -532.514364650349, -865.6131882141202, -853.9816655463493, -1091.9838732344974, -1066.3328732715065, -362.3601135289495, -976.2314665539963, -1031.7386574008408, -1314.161612162291, -764.5995140291263, -761.8634136990165, -800.2058692868782, -901.3996807240259, -389.6686450931784, -1015.7181831247382, -820.7568009339866, -612.7798588753654, -826.4678996758303, -1051.1639163032319, -798.804275231216, -965.0377780465521, -238.7118674131879, -1047.424623838229, -755.4264988909174, -284.2093980439104, -763.5619750312536, -705.4889068340302, -651.7580646384141, -800.6991284371741, -487.49109458751803, -87.44820409916582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5517119140624773, "mean_inference_ms": 1.6848716308091607, "mean_action_processing_ms": 0.28130376866264223, "mean_env_wait_ms": 2.969108146305453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012050628662109375, "StateBufferConnector_ms": 0.008080005645751953, "ViewRequirementAgentConnector_ms": 0.19243121147155762}, "num_episodes": 27, "episode_return_max": -48.31381250714634, "episode_return_min": -1314.161612162291, "episode_return_mean": -711.9970644610023, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.7795325665214, "num_env_steps_trained_throughput_per_sec": 297.7795325665214, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12335.711, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12335.634, "sample_time_ms": 1021.674, "learn_time_ms": 11245.26, "learn_throughput": 355.705, "synch_weights_time_ms": 67.847}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00001", "date": "2024-08-03_10-22-22", "timestamp": 1722660742, "time_this_iter_s": 13.444926261901855, "time_total_s": 159.00424456596375, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf56dd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 159.00424456596375, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.173684210526316, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 174.5023856461048, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.8890198564777771, "policy_loss": -0.013794028461173486, "vf_loss": 1.9009689875567952, "vf_explained_var": 0.99136564116925, "kl": 0.01611108514468167, "entropy": 1.3773194565127294, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -87.44820409916582, "episode_reward_min": -1314.161612162291, "episode_reward_mean": -739.6509393833053, "episode_len_mean": 143.05, "episode_media": {}, "episodes_timesteps_total": 14305, "policy_reward_min": {"policy_0": -1314.161612162291}, "policy_reward_max": {"policy_0": -87.44820409916582}, "policy_reward_mean": {"policy_0": -739.6509393833053}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-586.7386623445633, -809.7057896800176, -660.8788193592949, -846.1325308251702, -196.96614627336217, -909.374236052434, -999.5084884229344, -815.764207252165, -410.79756688532234, -341.96155909359464, -796.0950308635701, -248.84014142487555, -898.5925073627251, -909.8367344787164, -308.10547938013565, -978.0784205674578, -1058.1090749842444, -317.6853175868073, -1030.7313752823954, -427.55432374632846, -1081.0415735021081, -758.8060693692357, -975.0068302787907, -567.4270258215146, -583.8302901442675, -357.02049268218684, -683.4623790633473, -246.89967251951097, -471.88529970026724, -1022.4484836180122, -854.6053794126292, -925.9794130504865, -757.1533158239407, -348.33062081305553, -883.0900919269651, -659.9021494906158, -387.7357314800699, -968.8749345192214, -653.1722687226086, -862.783302326835, -117.6093145107333, -1067.5238054958984, -532.514364650349, -865.6131882141202, -853.9816655463493, -1091.9838732344974, -1066.3328732715065, -362.3601135289495, -976.2314665539963, -1031.7386574008408, -1314.161612162291, -764.5995140291263, -761.8634136990165, -800.2058692868782, -901.3996807240259, -389.6686450931784, -1015.7181831247382, -820.7568009339866, -612.7798588753654, -826.4678996758303, -1051.1639163032319, -798.804275231216, -965.0377780465521, -238.7118674131879, -1047.424623838229, -755.4264988909174, -284.2093980439104, -763.5619750312536, -705.4889068340302, -651.7580646384141, -800.6991284371741, -487.49109458751803, -87.44820409916582, -885.5771114342256, -832.7925405063362, -375.6253588010466, -316.6923706500258, -711.2537697075379, -428.20775723653236, -993.104397802049, -915.9026411109703, -748.7832735168089, -668.9681429311896, -757.5307564137985, -450.8444782557199, -247.18129736614983, -1128.3200830539363, -1019.5387683002461, -1174.2387272581232, -736.732247658885, -1088.3193958767938, -767.1223291327653, -1015.5339006758461, -1202.3083739948565, -398.60380682421174, -1117.4961153517277, -927.4757290459496, -1080.5439120280178, -1136.201648360833, -428.546737497678], "episode_lengths": [150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 124, 150, 128, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 134, 150, 150, 150, 150, 127, 77, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-586.7386623445633, -809.7057896800176, -660.8788193592949, -846.1325308251702, -196.96614627336217, -909.374236052434, -999.5084884229344, -815.764207252165, -410.79756688532234, -341.96155909359464, -796.0950308635701, -248.84014142487555, -898.5925073627251, -909.8367344787164, -308.10547938013565, -978.0784205674578, -1058.1090749842444, -317.6853175868073, -1030.7313752823954, -427.55432374632846, -1081.0415735021081, -758.8060693692357, -975.0068302787907, -567.4270258215146, -583.8302901442675, -357.02049268218684, -683.4623790633473, -246.89967251951097, -471.88529970026724, -1022.4484836180122, -854.6053794126292, -925.9794130504865, -757.1533158239407, -348.33062081305553, -883.0900919269651, -659.9021494906158, -387.7357314800699, -968.8749345192214, -653.1722687226086, -862.783302326835, -117.6093145107333, -1067.5238054958984, -532.514364650349, -865.6131882141202, -853.9816655463493, -1091.9838732344974, -1066.3328732715065, -362.3601135289495, -976.2314665539963, -1031.7386574008408, -1314.161612162291, -764.5995140291263, -761.8634136990165, -800.2058692868782, -901.3996807240259, -389.6686450931784, -1015.7181831247382, -820.7568009339866, -612.7798588753654, -826.4678996758303, -1051.1639163032319, -798.804275231216, -965.0377780465521, -238.7118674131879, -1047.424623838229, -755.4264988909174, -284.2093980439104, -763.5619750312536, -705.4889068340302, -651.7580646384141, -800.6991284371741, -487.49109458751803, -87.44820409916582, -885.5771114342256, -832.7925405063362, -375.6253588010466, -316.6923706500258, -711.2537697075379, -428.20775723653236, -993.104397802049, -915.9026411109703, -748.7832735168089, -668.9681429311896, -757.5307564137985, -450.8444782557199, -247.18129736614983, -1128.3200830539363, -1019.5387683002461, -1174.2387272581232, -736.732247658885, -1088.3193958767938, -767.1223291327653, -1015.5339006758461, -1202.3083739948565, -398.60380682421174, -1117.4961153517277, -927.4757290459496, -1080.5439120280178, -1136.201648360833, -428.546737497678]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5513701610682672, "mean_inference_ms": 1.6845928371565666, "mean_action_processing_ms": 0.28101697710144863, "mean_env_wait_ms": 2.969647096220081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01182413101196289, "StateBufferConnector_ms": 0.008087873458862305, "ViewRequirementAgentConnector_ms": 0.1927483081817627}, "num_episodes": 27, "episode_return_max": -87.44820409916582, "episode_return_min": -1314.161612162291, "episode_return_mean": -739.6509393833053, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.62848125659144, "num_env_steps_trained_throughput_per_sec": 305.62848125659144, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12414.314, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12414.236, "sample_time_ms": 1023.945, "learn_time_ms": 11321.331, "learn_throughput": 353.315, "synch_weights_time_ms": 68.107}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00001", "date": "2024-08-03_10-22-35", "timestamp": 1722660755, "time_this_iter_s": 13.10114312171936, "time_total_s": 172.1053876876831, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0e0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 172.1053876876831, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.021052631578947, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 209.7780634244283, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.7542275700718164, "policy_loss": -0.009730476818125075, "vf_loss": 1.7620915543598434, "vf_explained_var": 0.9944073616837462, "kl": 0.016169639253045414, "entropy": 1.3674308030555646, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -58.09106056468251, "episode_reward_min": -1314.161612162291, "episode_reward_mean": -737.6555887049021, "episode_len_mean": 141.04, "episode_media": {}, "episodes_timesteps_total": 14104, "policy_reward_min": {"policy_0": -1314.161612162291}, "policy_reward_max": {"policy_0": -58.09106056468251}, "policy_reward_mean": {"policy_0": -737.6555887049021}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-246.89967251951097, -471.88529970026724, -1022.4484836180122, -854.6053794126292, -925.9794130504865, -757.1533158239407, -348.33062081305553, -883.0900919269651, -659.9021494906158, -387.7357314800699, -968.8749345192214, -653.1722687226086, -862.783302326835, -117.6093145107333, -1067.5238054958984, -532.514364650349, -865.6131882141202, -853.9816655463493, -1091.9838732344974, -1066.3328732715065, -362.3601135289495, -976.2314665539963, -1031.7386574008408, -1314.161612162291, -764.5995140291263, -761.8634136990165, -800.2058692868782, -901.3996807240259, -389.6686450931784, -1015.7181831247382, -820.7568009339866, -612.7798588753654, -826.4678996758303, -1051.1639163032319, -798.804275231216, -965.0377780465521, -238.7118674131879, -1047.424623838229, -755.4264988909174, -284.2093980439104, -763.5619750312536, -705.4889068340302, -651.7580646384141, -800.6991284371741, -487.49109458751803, -87.44820409916582, -885.5771114342256, -832.7925405063362, -375.6253588010466, -316.6923706500258, -711.2537697075379, -428.20775723653236, -993.104397802049, -915.9026411109703, -748.7832735168089, -668.9681429311896, -757.5307564137985, -450.8444782557199, -247.18129736614983, -1128.3200830539363, -1019.5387683002461, -1174.2387272581232, -736.732247658885, -1088.3193958767938, -767.1223291327653, -1015.5339006758461, -1202.3083739948565, -398.60380682421174, -1117.4961153517277, -927.4757290459496, -1080.5439120280178, -1136.201648360833, -428.546737497678, -721.8901740209124, -711.3457917405743, -843.44984992893, -165.1651927192696, -198.80623849874294, -706.1884175968622, -839.4775740693199, -694.5916774263611, -1004.5399330593837, -675.8863877337271, -1039.5181766946066, -380.02182584814653, -534.053506237091, -160.58259655793321, -931.5385752694558, -900.5241245490399, -911.1124750245849, -831.910285966881, -574.5653939762468, -1154.539896442275, -440.636385762867, -911.2785476422157, -639.2562944240861, -144.35056170273273, -1275.5155379323523, -909.6795234979843, -58.09106056468251], "episode_lengths": [83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 134, 150, 150, 150, 150, 127, 77, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 69, 89, 150, 150, 150, 150, 150, 150, 96, 139, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 52], "policy_policy_0_reward": [-246.89967251951097, -471.88529970026724, -1022.4484836180122, -854.6053794126292, -925.9794130504865, -757.1533158239407, -348.33062081305553, -883.0900919269651, -659.9021494906158, -387.7357314800699, -968.8749345192214, -653.1722687226086, -862.783302326835, -117.6093145107333, -1067.5238054958984, -532.514364650349, -865.6131882141202, -853.9816655463493, -1091.9838732344974, -1066.3328732715065, -362.3601135289495, -976.2314665539963, -1031.7386574008408, -1314.161612162291, -764.5995140291263, -761.8634136990165, -800.2058692868782, -901.3996807240259, -389.6686450931784, -1015.7181831247382, -820.7568009339866, -612.7798588753654, -826.4678996758303, -1051.1639163032319, -798.804275231216, -965.0377780465521, -238.7118674131879, -1047.424623838229, -755.4264988909174, -284.2093980439104, -763.5619750312536, -705.4889068340302, -651.7580646384141, -800.6991284371741, -487.49109458751803, -87.44820409916582, -885.5771114342256, -832.7925405063362, -375.6253588010466, -316.6923706500258, -711.2537697075379, -428.20775723653236, -993.104397802049, -915.9026411109703, -748.7832735168089, -668.9681429311896, -757.5307564137985, -450.8444782557199, -247.18129736614983, -1128.3200830539363, -1019.5387683002461, -1174.2387272581232, -736.732247658885, -1088.3193958767938, -767.1223291327653, -1015.5339006758461, -1202.3083739948565, -398.60380682421174, -1117.4961153517277, -927.4757290459496, -1080.5439120280178, -1136.201648360833, -428.546737497678, -721.8901740209124, -711.3457917405743, -843.44984992893, -165.1651927192696, -198.80623849874294, -706.1884175968622, -839.4775740693199, -694.5916774263611, -1004.5399330593837, -675.8863877337271, -1039.5181766946066, -380.02182584814653, -534.053506237091, -160.58259655793321, -931.5385752694558, -900.5241245490399, -911.1124750245849, -831.910285966881, -574.5653939762468, -1154.539896442275, -440.636385762867, -911.2785476422157, -639.2562944240861, -144.35056170273273, -1275.5155379323523, -909.6795234979843, -58.09106056468251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.551694555735545, "mean_inference_ms": 1.6857550829633754, "mean_action_processing_ms": 0.28109804681378364, "mean_env_wait_ms": 2.9737370368085068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01198124885559082, "StateBufferConnector_ms": 0.008175134658813477, "ViewRequirementAgentConnector_ms": 0.19789671897888184}, "num_episodes": 27, "episode_return_max": -58.09106056468251, "episode_return_min": -1314.161612162291, "episode_return_mean": -737.6555887049021, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.15992267318836, "num_env_steps_trained_throughput_per_sec": 308.15992267318836, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12405.806, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12405.729, "sample_time_ms": 1025.61, "learn_time_ms": 11311.719, "learn_throughput": 353.616, "synch_weights_time_ms": 67.559}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00001", "date": "2024-08-03_10-22-48", "timestamp": 1722660768, "time_this_iter_s": 12.993704795837402, "time_total_s": 185.0990924835205, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf54e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 185.0990924835205, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 13.611111111111109, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 165.23033546209336, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.8445197477315862, "policy_loss": -0.015436995897713739, "vf_loss": 1.8575713527699311, "vf_explained_var": 0.9967086403941114, "kl": 0.018918007458978543, "entropy": 1.3982071702678998, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -58.09106056468251, "episode_reward_min": -1275.5155379323523, "episode_reward_mean": -735.3811587372777, "episode_len_mean": 140.78, "episode_media": {}, "episodes_timesteps_total": 14078, "policy_reward_min": {"policy_0": -1275.5155379323523}, "policy_reward_max": {"policy_0": -58.09106056468251}, "policy_reward_mean": {"policy_0": -735.3811587372777}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-389.6686450931784, -1015.7181831247382, -820.7568009339866, -612.7798588753654, -826.4678996758303, -1051.1639163032319, -798.804275231216, -965.0377780465521, -238.7118674131879, -1047.424623838229, -755.4264988909174, -284.2093980439104, -763.5619750312536, -705.4889068340302, -651.7580646384141, -800.6991284371741, -487.49109458751803, -87.44820409916582, -885.5771114342256, -832.7925405063362, -375.6253588010466, -316.6923706500258, -711.2537697075379, -428.20775723653236, -993.104397802049, -915.9026411109703, -748.7832735168089, -668.9681429311896, -757.5307564137985, -450.8444782557199, -247.18129736614983, -1128.3200830539363, -1019.5387683002461, -1174.2387272581232, -736.732247658885, -1088.3193958767938, -767.1223291327653, -1015.5339006758461, -1202.3083739948565, -398.60380682421174, -1117.4961153517277, -927.4757290459496, -1080.5439120280178, -1136.201648360833, -428.546737497678, -721.8901740209124, -711.3457917405743, -843.44984992893, -165.1651927192696, -198.80623849874294, -706.1884175968622, -839.4775740693199, -694.5916774263611, -1004.5399330593837, -675.8863877337271, -1039.5181766946066, -380.02182584814653, -534.053506237091, -160.58259655793321, -931.5385752694558, -900.5241245490399, -911.1124750245849, -831.910285966881, -574.5653939762468, -1154.539896442275, -440.636385762867, -911.2785476422157, -639.2562944240861, -144.35056170273273, -1275.5155379323523, -909.6795234979843, -58.09106056468251, -1087.668534097251, -739.8423399902008, -432.6607521956748, -1120.357076247287, -296.68297655664935, -771.0329606726447, -1021.994222971879, -1067.5754226727756, -968.8080057667803, -71.50465357841021, -616.5007183029768, -107.32378530090988, -381.9451132070198, -125.88548964440663, -898.8868614640121, -910.9798417308778, -1145.0604640720815, -830.218432713127, -1060.3299114989707, -1070.245494984891, -1100.854778175628, -873.9986304151541, -860.3139717459768, -714.8724737420075, -561.0813328687266, -473.98101650854727, -867.709442228635, -1145.2223755968514], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 134, 150, 150, 150, 150, 127, 77, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 69, 89, 150, 150, 150, 150, 150, 150, 96, 139, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 52, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 91, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-389.6686450931784, -1015.7181831247382, -820.7568009339866, -612.7798588753654, -826.4678996758303, -1051.1639163032319, -798.804275231216, -965.0377780465521, -238.7118674131879, -1047.424623838229, -755.4264988909174, -284.2093980439104, -763.5619750312536, -705.4889068340302, -651.7580646384141, -800.6991284371741, -487.49109458751803, -87.44820409916582, -885.5771114342256, -832.7925405063362, -375.6253588010466, -316.6923706500258, -711.2537697075379, -428.20775723653236, -993.104397802049, -915.9026411109703, -748.7832735168089, -668.9681429311896, -757.5307564137985, -450.8444782557199, -247.18129736614983, -1128.3200830539363, -1019.5387683002461, -1174.2387272581232, -736.732247658885, -1088.3193958767938, -767.1223291327653, -1015.5339006758461, -1202.3083739948565, -398.60380682421174, -1117.4961153517277, -927.4757290459496, -1080.5439120280178, -1136.201648360833, -428.546737497678, -721.8901740209124, -711.3457917405743, -843.44984992893, -165.1651927192696, -198.80623849874294, -706.1884175968622, -839.4775740693199, -694.5916774263611, -1004.5399330593837, -675.8863877337271, -1039.5181766946066, -380.02182584814653, -534.053506237091, -160.58259655793321, -931.5385752694558, -900.5241245490399, -911.1124750245849, -831.910285966881, -574.5653939762468, -1154.539896442275, -440.636385762867, -911.2785476422157, -639.2562944240861, -144.35056170273273, -1275.5155379323523, -909.6795234979843, -58.09106056468251, -1087.668534097251, -739.8423399902008, -432.6607521956748, -1120.357076247287, -296.68297655664935, -771.0329606726447, -1021.994222971879, -1067.5754226727756, -968.8080057667803, -71.50465357841021, -616.5007183029768, -107.32378530090988, -381.9451132070198, -125.88548964440663, -898.8868614640121, -910.9798417308778, -1145.0604640720815, -830.218432713127, -1060.3299114989707, -1070.245494984891, -1100.854778175628, -873.9986304151541, -860.3139717459768, -714.8724737420075, -561.0813328687266, -473.98101650854727, -867.709442228635, -1145.2223755968514]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522700132131885, "mean_inference_ms": 1.686710216860294, "mean_action_processing_ms": 0.281068325930409, "mean_env_wait_ms": 2.9761783761608944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01244044303894043, "StateBufferConnector_ms": 0.008306741714477539, "ViewRequirementAgentConnector_ms": 0.20152974128723145}, "num_episodes": 28, "episode_return_max": -58.09106056468251, "episode_return_min": -1275.5155379323523, "episode_return_mean": -735.3811587372777, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.1591733783263, "num_env_steps_trained_throughput_per_sec": 300.1591733783263, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12413.121, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12413.044, "sample_time_ms": 1025.885, "learn_time_ms": 11320.398, "learn_throughput": 353.344, "synch_weights_time_ms": 65.922}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00001", "date": "2024-08-03_10-23-01", "timestamp": 1722660781, "time_this_iter_s": 13.33838939666748, "time_total_s": 198.437481880188, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf565f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 198.437481880188, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.021052631578948, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 152.74086971779664, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.8247990678374966, "policy_loss": -0.006805544771486894, "vf_loss": 1.8299463255951802, "vf_explained_var": 0.9930986331775784, "kl": 0.015245331414454706, "entropy": 1.3907792986681065, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -26.626329215627806, "episode_reward_min": -1356.545934542983, "episode_reward_mean": -750.8222047534099, "episode_len_mean": 139.56, "episode_media": {}, "episodes_timesteps_total": 13956, "policy_reward_min": {"policy_0": -1356.545934542983}, "policy_reward_max": {"policy_0": -26.626329215627806}, "policy_reward_mean": {"policy_0": -750.8222047534099}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1019.5387683002461, -1174.2387272581232, -736.732247658885, -1088.3193958767938, -767.1223291327653, -1015.5339006758461, -1202.3083739948565, -398.60380682421174, -1117.4961153517277, -927.4757290459496, -1080.5439120280178, -1136.201648360833, -428.546737497678, -721.8901740209124, -711.3457917405743, -843.44984992893, -165.1651927192696, -198.80623849874294, -706.1884175968622, -839.4775740693199, -694.5916774263611, -1004.5399330593837, -675.8863877337271, -1039.5181766946066, -380.02182584814653, -534.053506237091, -160.58259655793321, -931.5385752694558, -900.5241245490399, -911.1124750245849, -831.910285966881, -574.5653939762468, -1154.539896442275, -440.636385762867, -911.2785476422157, -639.2562944240861, -144.35056170273273, -1275.5155379323523, -909.6795234979843, -58.09106056468251, -1087.668534097251, -739.8423399902008, -432.6607521956748, -1120.357076247287, -296.68297655664935, -771.0329606726447, -1021.994222971879, -1067.5754226727756, -968.8080057667803, -71.50465357841021, -616.5007183029768, -107.32378530090988, -381.9451132070198, -125.88548964440663, -898.8868614640121, -910.9798417308778, -1145.0604640720815, -830.218432713127, -1060.3299114989707, -1070.245494984891, -1100.854778175628, -873.9986304151541, -860.3139717459768, -714.8724737420075, -561.0813328687266, -473.98101650854727, -867.709442228635, -1145.2223755968514, -1084.3691612839002, -636.7061104932196, -1075.5819956033395, -1093.2760409414345, -300.8355250681528, -875.9483146374205, -87.76447526480987, -713.1374140929092, -994.7817285437475, -944.1732938950441, -26.626329215627806, -476.7996454296806, -662.8425721545576, -676.828998456411, -1189.5854832709313, -418.2158663500185, -938.7221854876673, -796.6723781270452, -1356.545934542983, -1121.0477038785953, -399.29987618776664, -494.7154122273417, -837.295284951967, -932.178407855231, -273.2204469542756, -1038.9136516645779, -655.6709233783897, -766.5768692987283, -250.34642120916374, -727.9636939033646, -471.06371416201785, -989.7998409671153], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 69, 89, 150, 150, 150, 150, 150, 150, 96, 139, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 52, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 91, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 62, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 148, 150, 87, 150, 150, 150], "policy_policy_0_reward": [-1019.5387683002461, -1174.2387272581232, -736.732247658885, -1088.3193958767938, -767.1223291327653, -1015.5339006758461, -1202.3083739948565, -398.60380682421174, -1117.4961153517277, -927.4757290459496, -1080.5439120280178, -1136.201648360833, -428.546737497678, -721.8901740209124, -711.3457917405743, -843.44984992893, -165.1651927192696, -198.80623849874294, -706.1884175968622, -839.4775740693199, -694.5916774263611, -1004.5399330593837, -675.8863877337271, -1039.5181766946066, -380.02182584814653, -534.053506237091, -160.58259655793321, -931.5385752694558, -900.5241245490399, -911.1124750245849, -831.910285966881, -574.5653939762468, -1154.539896442275, -440.636385762867, -911.2785476422157, -639.2562944240861, -144.35056170273273, -1275.5155379323523, -909.6795234979843, -58.09106056468251, -1087.668534097251, -739.8423399902008, -432.6607521956748, -1120.357076247287, -296.68297655664935, -771.0329606726447, -1021.994222971879, -1067.5754226727756, -968.8080057667803, -71.50465357841021, -616.5007183029768, -107.32378530090988, -381.9451132070198, -125.88548964440663, -898.8868614640121, -910.9798417308778, -1145.0604640720815, -830.218432713127, -1060.3299114989707, -1070.245494984891, -1100.854778175628, -873.9986304151541, -860.3139717459768, -714.8724737420075, -561.0813328687266, -473.98101650854727, -867.709442228635, -1145.2223755968514, -1084.3691612839002, -636.7061104932196, -1075.5819956033395, -1093.2760409414345, -300.8355250681528, -875.9483146374205, -87.76447526480987, -713.1374140929092, -994.7817285437475, -944.1732938950441, -26.626329215627806, -476.7996454296806, -662.8425721545576, -676.828998456411, -1189.5854832709313, -418.2158663500185, -938.7221854876673, -796.6723781270452, -1356.545934542983, -1121.0477038785953, -399.29987618776664, -494.7154122273417, -837.295284951967, -932.178407855231, -273.2204469542756, -1038.9136516645779, -655.6709233783897, -766.5768692987283, -250.34642120916374, -727.9636939033646, -471.06371416201785, -989.7998409671153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525399665438091, "mean_inference_ms": 1.6887220009046704, "mean_action_processing_ms": 0.2811596793064222, "mean_env_wait_ms": 2.9812008731159496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012148618698120117, "StateBufferConnector_ms": 0.008197307586669922, "ViewRequirementAgentConnector_ms": 0.20023441314697266}, "num_episodes": 32, "episode_return_max": -26.626329215627806, "episode_return_min": -1356.545934542983, "episode_return_mean": -750.8222047534099, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 570.150108596276, "num_env_steps_trained_throughput_per_sec": 570.150108596276, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12221.369, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12221.293, "sample_time_ms": 1016.561, "learn_time_ms": 11139.499, "learn_throughput": 359.083, "synch_weights_time_ms": 64.41}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00001", "date": "2024-08-03_10-23-08", "timestamp": 1722660788, "time_this_iter_s": 7.026855707168579, "time_total_s": 205.46433758735657, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf54b80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 205.46433758735657, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.62727272727273, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 193.90202399293582, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.174237919722994, "policy_loss": -0.009002469778837015, "vf_loss": 2.181341310404241, "vf_explained_var": 0.9875179686273138, "kl": 0.01639194805772302, "entropy": 1.3793089784681798, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -26.626329215627806, "episode_reward_min": -1356.545934542983, "episode_reward_mean": -712.6258193080452, "episode_len_mean": 138.16, "episode_media": {}, "episodes_timesteps_total": 13816, "policy_reward_min": {"policy_0": -1356.545934542983}, "policy_reward_max": {"policy_0": -26.626329215627806}, "policy_reward_mean": {"policy_0": -712.6258193080452}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-911.1124750245849, -831.910285966881, -574.5653939762468, -1154.539896442275, -440.636385762867, -911.2785476422157, -639.2562944240861, -144.35056170273273, -1275.5155379323523, -909.6795234979843, -58.09106056468251, -1087.668534097251, -739.8423399902008, -432.6607521956748, -1120.357076247287, -296.68297655664935, -771.0329606726447, -1021.994222971879, -1067.5754226727756, -968.8080057667803, -71.50465357841021, -616.5007183029768, -107.32378530090988, -381.9451132070198, -125.88548964440663, -898.8868614640121, -910.9798417308778, -1145.0604640720815, -830.218432713127, -1060.3299114989707, -1070.245494984891, -1100.854778175628, -873.9986304151541, -860.3139717459768, -714.8724737420075, -561.0813328687266, -473.98101650854727, -867.709442228635, -1145.2223755968514, -1084.3691612839002, -636.7061104932196, -1075.5819956033395, -1093.2760409414345, -300.8355250681528, -875.9483146374205, -87.76447526480987, -713.1374140929092, -994.7817285437475, -944.1732938950441, -26.626329215627806, -476.7996454296806, -662.8425721545576, -676.828998456411, -1189.5854832709313, -418.2158663500185, -938.7221854876673, -796.6723781270452, -1356.545934542983, -1121.0477038785953, -399.29987618776664, -494.7154122273417, -837.295284951967, -932.178407855231, -273.2204469542756, -1038.9136516645779, -655.6709233783897, -766.5768692987283, -250.34642120916374, -727.9636939033646, -471.06371416201785, -989.7998409671153, -431.9408644913433, -922.3492725485423, -304.8639532983162, -442.14491003536665, -548.3823728766467, -1064.7400578035927, -319.9268472186603, -484.4726532939729, -1090.3245269529787, -1124.2854707520542, -64.51004570518865, -1096.8590168673113, -687.6190610089908, -62.161899177973474, -942.6736043972994, -745.157215154302, -121.0944185785059, -1009.2066910554731, -336.7306765986777, -344.11208374501587, -1034.1868748345019, -479.64779364175854, -924.3853925272556, -422.75062089473255, -882.7676166001122, -832.061480063197, -809.6324887937841, -492.23414985215896, -759.3811306521063], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 52, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 91, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 62, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 148, 150, 87, 150, 150, 150, 150, 150, 89, 150, 150, 150, 128, 150, 150, 150, 58, 150, 150, 48, 150, 150, 83, 150, 106, 98, 150, 150, 150, 150, 150, 150, 150, 130, 150], "policy_policy_0_reward": [-911.1124750245849, -831.910285966881, -574.5653939762468, -1154.539896442275, -440.636385762867, -911.2785476422157, -639.2562944240861, -144.35056170273273, -1275.5155379323523, -909.6795234979843, -58.09106056468251, -1087.668534097251, -739.8423399902008, -432.6607521956748, -1120.357076247287, -296.68297655664935, -771.0329606726447, -1021.994222971879, -1067.5754226727756, -968.8080057667803, -71.50465357841021, -616.5007183029768, -107.32378530090988, -381.9451132070198, -125.88548964440663, -898.8868614640121, -910.9798417308778, -1145.0604640720815, -830.218432713127, -1060.3299114989707, -1070.245494984891, -1100.854778175628, -873.9986304151541, -860.3139717459768, -714.8724737420075, -561.0813328687266, -473.98101650854727, -867.709442228635, -1145.2223755968514, -1084.3691612839002, -636.7061104932196, -1075.5819956033395, -1093.2760409414345, -300.8355250681528, -875.9483146374205, -87.76447526480987, -713.1374140929092, -994.7817285437475, -944.1732938950441, -26.626329215627806, -476.7996454296806, -662.8425721545576, -676.828998456411, -1189.5854832709313, -418.2158663500185, -938.7221854876673, -796.6723781270452, -1356.545934542983, -1121.0477038785953, -399.29987618776664, -494.7154122273417, -837.295284951967, -932.178407855231, -273.2204469542756, -1038.9136516645779, -655.6709233783897, -766.5768692987283, -250.34642120916374, -727.9636939033646, -471.06371416201785, -989.7998409671153, -431.9408644913433, -922.3492725485423, -304.8639532983162, -442.14491003536665, -548.3823728766467, -1064.7400578035927, -319.9268472186603, -484.4726532939729, -1090.3245269529787, -1124.2854707520542, -64.51004570518865, -1096.8590168673113, -687.6190610089908, -62.161899177973474, -942.6736043972994, -745.157215154302, -121.0944185785059, -1009.2066910554731, -336.7306765986777, -344.11208374501587, -1034.1868748345019, -479.64779364175854, -924.3853925272556, -422.75062089473255, -882.7676166001122, -832.061480063197, -809.6324887937841, -492.23414985215896, -759.3811306521063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526784447808057, "mean_inference_ms": 1.6870950826154043, "mean_action_processing_ms": 0.28081096769699215, "mean_env_wait_ms": 2.9807570990591272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012323856353759766, "StateBufferConnector_ms": 0.008242607116699219, "ViewRequirementAgentConnector_ms": 0.19945454597473145}, "num_episodes": 29, "episode_return_max": -26.626329215627806, "episode_return_min": -1356.545934542983, "episode_return_mean": -712.6258193080452, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.5799505993763, "num_env_steps_trained_throughput_per_sec": 307.5799505993763, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12461.413, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12461.338, "sample_time_ms": 1024.151, "learn_time_ms": 11369.976, "learn_throughput": 351.804, "synch_weights_time_ms": 66.379}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00001", "date": "2024-08-03_10-23-21", "timestamp": 1722660801, "time_this_iter_s": 13.01763129234314, "time_total_s": 218.4819688796997, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf57d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 218.4819688796997, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.427777777777777, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 163.2158388455709, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.9993888372555375, "policy_loss": -0.0101611567408933, "vf_loss": 2.0074132181083164, "vf_explained_var": 0.9928292046611508, "kl": 0.017541585868821145, "entropy": 1.3715367858608565, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -19.818754129961174, "episode_reward_min": -1356.545934542983, "episode_reward_mean": -711.7733079429609, "episode_len_mean": 137.49, "episode_media": {}, "episodes_timesteps_total": 13749, "policy_reward_min": {"policy_0": -1356.545934542983}, "policy_reward_max": {"policy_0": -19.818754129961174}, "policy_reward_mean": {"policy_0": -711.7733079429609}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1100.854778175628, -873.9986304151541, -860.3139717459768, -714.8724737420075, -561.0813328687266, -473.98101650854727, -867.709442228635, -1145.2223755968514, -1084.3691612839002, -636.7061104932196, -1075.5819956033395, -1093.2760409414345, -300.8355250681528, -875.9483146374205, -87.76447526480987, -713.1374140929092, -994.7817285437475, -944.1732938950441, -26.626329215627806, -476.7996454296806, -662.8425721545576, -676.828998456411, -1189.5854832709313, -418.2158663500185, -938.7221854876673, -796.6723781270452, -1356.545934542983, -1121.0477038785953, -399.29987618776664, -494.7154122273417, -837.295284951967, -932.178407855231, -273.2204469542756, -1038.9136516645779, -655.6709233783897, -766.5768692987283, -250.34642120916374, -727.9636939033646, -471.06371416201785, -989.7998409671153, -431.9408644913433, -922.3492725485423, -304.8639532983162, -442.14491003536665, -548.3823728766467, -1064.7400578035927, -319.9268472186603, -484.4726532939729, -1090.3245269529787, -1124.2854707520542, -64.51004570518865, -1096.8590168673113, -687.6190610089908, -62.161899177973474, -942.6736043972994, -745.157215154302, -121.0944185785059, -1009.2066910554731, -336.7306765986777, -344.11208374501587, -1034.1868748345019, -479.64779364175854, -924.3853925272556, -422.75062089473255, -882.7676166001122, -832.061480063197, -809.6324887937841, -492.23414985215896, -759.3811306521063, -1008.0885595133569, -1007.3775286070467, -658.4277563416542, -407.86761927896333, -733.0459194213418, -386.11374588671674, -945.6127294709169, -712.7395116979542, -739.8462715720709, -718.9015348127697, -1243.2769563187849, -943.654254607085, -673.5910830273402, -769.0469316502249, -908.0214021063906, -1232.9832129604054, -517.039943855401, -283.2558424224325, -944.7730112929421, -765.7645950194483, -1246.1125352212355, -125.33077246451582, -670.9007539897407, -962.5562300948633, -782.8202466892814, -796.567529571324, -848.0564539281602, -19.818754129961174, -1330.0052362847207, -23.220537639105036, -86.37042422116], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 62, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 148, 150, 87, 150, 150, 150, 150, 150, 89, 150, 150, 150, 128, 150, 150, 150, 58, 150, 150, 48, 150, 150, 83, 150, 106, 98, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 108, 150, 150, 150, 101, 150, 150, 150, 150, 150, 45, 150, 42, 62], "policy_policy_0_reward": [-1100.854778175628, -873.9986304151541, -860.3139717459768, -714.8724737420075, -561.0813328687266, -473.98101650854727, -867.709442228635, -1145.2223755968514, -1084.3691612839002, -636.7061104932196, -1075.5819956033395, -1093.2760409414345, -300.8355250681528, -875.9483146374205, -87.76447526480987, -713.1374140929092, -994.7817285437475, -944.1732938950441, -26.626329215627806, -476.7996454296806, -662.8425721545576, -676.828998456411, -1189.5854832709313, -418.2158663500185, -938.7221854876673, -796.6723781270452, -1356.545934542983, -1121.0477038785953, -399.29987618776664, -494.7154122273417, -837.295284951967, -932.178407855231, -273.2204469542756, -1038.9136516645779, -655.6709233783897, -766.5768692987283, -250.34642120916374, -727.9636939033646, -471.06371416201785, -989.7998409671153, -431.9408644913433, -922.3492725485423, -304.8639532983162, -442.14491003536665, -548.3823728766467, -1064.7400578035927, -319.9268472186603, -484.4726532939729, -1090.3245269529787, -1124.2854707520542, -64.51004570518865, -1096.8590168673113, -687.6190610089908, -62.161899177973474, -942.6736043972994, -745.157215154302, -121.0944185785059, -1009.2066910554731, -336.7306765986777, -344.11208374501587, -1034.1868748345019, -479.64779364175854, -924.3853925272556, -422.75062089473255, -882.7676166001122, -832.061480063197, -809.6324887937841, -492.23414985215896, -759.3811306521063, -1008.0885595133569, -1007.3775286070467, -658.4277563416542, -407.86761927896333, -733.0459194213418, -386.11374588671674, -945.6127294709169, -712.7395116979542, -739.8462715720709, -718.9015348127697, -1243.2769563187849, -943.654254607085, -673.5910830273402, -769.0469316502249, -908.0214021063906, -1232.9832129604054, -517.039943855401, -283.2558424224325, -944.7730112929421, -765.7645950194483, -1246.1125352212355, -125.33077246451582, -670.9007539897407, -962.5562300948633, -782.8202466892814, -796.567529571324, -848.0564539281602, -19.818754129961174, -1330.0052362847207, -23.220537639105036, -86.37042422116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525051235055706, "mean_inference_ms": 1.685993718910173, "mean_action_processing_ms": 0.2803923564510951, "mean_env_wait_ms": 2.98112019640418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012049674987792969, "StateBufferConnector_ms": 0.008287429809570312, "ViewRequirementAgentConnector_ms": 0.20154404640197754}, "num_episodes": 31, "episode_return_max": -19.818754129961174, "episode_return_min": -1356.545934542983, "episode_return_mean": -711.7733079429609, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.5534433106751, "num_env_steps_trained_throughput_per_sec": 300.5534433106751, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12504.214, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12504.139, "sample_time_ms": 1027.129, "learn_time_ms": 11408.164, "learn_throughput": 350.626, "synch_weights_time_ms": 68.029}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00001", "date": "2024-08-03_10-23-35", "timestamp": 1722660815, "time_this_iter_s": 13.320801019668579, "time_total_s": 231.8027698993683, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00bc550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 231.8027698993683, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.110526315789473, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 171.44402165810268, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.8834606681019068, "policy_loss": -0.010421064266120083, "vf_loss": 1.8917344500000277, "vf_explained_var": 0.9823149730761845, "kl": 0.017557453995686957, "entropy": 1.3642150870213905, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -19.818754129961174, "episode_reward_min": -1330.0052362847207, "episode_reward_mean": -667.6085563568855, "episode_len_mean": 134.35, "episode_media": {}, "episodes_timesteps_total": 13435, "policy_reward_min": {"policy_0": -1330.0052362847207}, "policy_reward_max": {"policy_0": -19.818754129961174}, "policy_reward_mean": {"policy_0": -667.6085563568855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-494.7154122273417, -837.295284951967, -932.178407855231, -273.2204469542756, -1038.9136516645779, -655.6709233783897, -766.5768692987283, -250.34642120916374, -727.9636939033646, -471.06371416201785, -989.7998409671153, -431.9408644913433, -922.3492725485423, -304.8639532983162, -442.14491003536665, -548.3823728766467, -1064.7400578035927, -319.9268472186603, -484.4726532939729, -1090.3245269529787, -1124.2854707520542, -64.51004570518865, -1096.8590168673113, -687.6190610089908, -62.161899177973474, -942.6736043972994, -745.157215154302, -121.0944185785059, -1009.2066910554731, -336.7306765986777, -344.11208374501587, -1034.1868748345019, -479.64779364175854, -924.3853925272556, -422.75062089473255, -882.7676166001122, -832.061480063197, -809.6324887937841, -492.23414985215896, -759.3811306521063, -1008.0885595133569, -1007.3775286070467, -658.4277563416542, -407.86761927896333, -733.0459194213418, -386.11374588671674, -945.6127294709169, -712.7395116979542, -739.8462715720709, -718.9015348127697, -1243.2769563187849, -943.654254607085, -673.5910830273402, -769.0469316502249, -908.0214021063906, -1232.9832129604054, -517.039943855401, -283.2558424224325, -944.7730112929421, -765.7645950194483, -1246.1125352212355, -125.33077246451582, -670.9007539897407, -962.5562300948633, -782.8202466892814, -796.567529571324, -848.0564539281602, -19.818754129961174, -1330.0052362847207, -23.220537639105036, -86.37042422116, -564.5271813775703, -1076.8569923845507, -822.567325871359, -1054.4310327974886, -756.4965546697993, -231.83102774402565, -930.308929624169, -756.5181447252106, -117.88036503210456, -337.18622286231124, -425.8762904989602, -1259.5677668890542, -552.4909140037483, -21.83185947967166, -1059.931204009231, -963.5444440580153, -742.8518160797261, -968.2037518970975, -211.47727736692934, -519.401310746123, -802.2317563684122, -627.609334946037, -420.7976897087167, -363.9325309204803, -74.08592455424885, -769.1362137929906, -636.1546176946189, -552.9210508371116, -430.670364659487], "episode_lengths": [150, 150, 150, 91, 150, 148, 150, 87, 150, 150, 150, 150, 150, 89, 150, 150, 150, 128, 150, 150, 150, 58, 150, 150, 48, 150, 150, 83, 150, 106, 98, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 108, 150, 150, 150, 101, 150, 150, 150, 150, 150, 45, 150, 42, 62, 150, 150, 150, 150, 150, 93, 150, 150, 64, 150, 107, 150, 150, 52, 150, 150, 150, 150, 90, 114, 150, 150, 150, 91, 70, 150, 150, 150, 106], "policy_policy_0_reward": [-494.7154122273417, -837.295284951967, -932.178407855231, -273.2204469542756, -1038.9136516645779, -655.6709233783897, -766.5768692987283, -250.34642120916374, -727.9636939033646, -471.06371416201785, -989.7998409671153, -431.9408644913433, -922.3492725485423, -304.8639532983162, -442.14491003536665, -548.3823728766467, -1064.7400578035927, -319.9268472186603, -484.4726532939729, -1090.3245269529787, -1124.2854707520542, -64.51004570518865, -1096.8590168673113, -687.6190610089908, -62.161899177973474, -942.6736043972994, -745.157215154302, -121.0944185785059, -1009.2066910554731, -336.7306765986777, -344.11208374501587, -1034.1868748345019, -479.64779364175854, -924.3853925272556, -422.75062089473255, -882.7676166001122, -832.061480063197, -809.6324887937841, -492.23414985215896, -759.3811306521063, -1008.0885595133569, -1007.3775286070467, -658.4277563416542, -407.86761927896333, -733.0459194213418, -386.11374588671674, -945.6127294709169, -712.7395116979542, -739.8462715720709, -718.9015348127697, -1243.2769563187849, -943.654254607085, -673.5910830273402, -769.0469316502249, -908.0214021063906, -1232.9832129604054, -517.039943855401, -283.2558424224325, -944.7730112929421, -765.7645950194483, -1246.1125352212355, -125.33077246451582, -670.9007539897407, -962.5562300948633, -782.8202466892814, -796.567529571324, -848.0564539281602, -19.818754129961174, -1330.0052362847207, -23.220537639105036, -86.37042422116, -564.5271813775703, -1076.8569923845507, -822.567325871359, -1054.4310327974886, -756.4965546697993, -231.83102774402565, -930.308929624169, -756.5181447252106, -117.88036503210456, -337.18622286231124, -425.8762904989602, -1259.5677668890542, -552.4909140037483, -21.83185947967166, -1059.931204009231, -963.5444440580153, -742.8518160797261, -968.2037518970975, -211.47727736692934, -519.401310746123, -802.2317563684122, -627.609334946037, -420.7976897087167, -363.9325309204803, -74.08592455424885, -769.1362137929906, -636.1546176946189, -552.9210508371116, -430.670364659487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526490391821709, "mean_inference_ms": 1.6849288946783667, "mean_action_processing_ms": 0.28023709459273316, "mean_env_wait_ms": 2.9807190299628585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011991262435913086, "StateBufferConnector_ms": 0.008245706558227539, "ViewRequirementAgentConnector_ms": 0.2010190486907959}, "num_episodes": 29, "episode_return_max": -19.818754129961174, "episode_return_min": -1330.0052362847207, "episode_return_mean": -667.6085563568855, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.1215351058776, "num_env_steps_trained_throughput_per_sec": 298.1215351058776, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12560.011, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12559.937, "sample_time_ms": 1021.967, "learn_time_ms": 11469.915, "learn_throughput": 348.738, "synch_weights_time_ms": 67.218}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00001", "date": "2024-08-03_10-23-48", "timestamp": 1722660828, "time_this_iter_s": 13.431025743484497, "time_total_s": 245.23379564285278, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf557e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 245.23379564285278, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 12.915789473684208, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 168.0211206873258, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.6828729014533261, "policy_loss": -0.012910959357395769, "vf_loss": 1.6936168153459827, "vf_explained_var": 0.9957343919823567, "kl": 0.017020756453833517, "entropy": 1.2371086922784647, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -0.22179288400050057, "episode_reward_min": -1330.0052362847207, "episode_reward_mean": -674.3556967792043, "episode_len_mean": 134.38, "episode_media": {}, "episodes_timesteps_total": 13438, "policy_reward_min": {"policy_0": -1330.0052362847207}, "policy_reward_max": {"policy_0": -0.22179288400050057}, "policy_reward_mean": {"policy_0": -674.3556967792043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-336.7306765986777, -344.11208374501587, -1034.1868748345019, -479.64779364175854, -924.3853925272556, -422.75062089473255, -882.7676166001122, -832.061480063197, -809.6324887937841, -492.23414985215896, -759.3811306521063, -1008.0885595133569, -1007.3775286070467, -658.4277563416542, -407.86761927896333, -733.0459194213418, -386.11374588671674, -945.6127294709169, -712.7395116979542, -739.8462715720709, -718.9015348127697, -1243.2769563187849, -943.654254607085, -673.5910830273402, -769.0469316502249, -908.0214021063906, -1232.9832129604054, -517.039943855401, -283.2558424224325, -944.7730112929421, -765.7645950194483, -1246.1125352212355, -125.33077246451582, -670.9007539897407, -962.5562300948633, -782.8202466892814, -796.567529571324, -848.0564539281602, -19.818754129961174, -1330.0052362847207, -23.220537639105036, -86.37042422116, -564.5271813775703, -1076.8569923845507, -822.567325871359, -1054.4310327974886, -756.4965546697993, -231.83102774402565, -930.308929624169, -756.5181447252106, -117.88036503210456, -337.18622286231124, -425.8762904989602, -1259.5677668890542, -552.4909140037483, -21.83185947967166, -1059.931204009231, -963.5444440580153, -742.8518160797261, -968.2037518970975, -211.47727736692934, -519.401310746123, -802.2317563684122, -627.609334946037, -420.7976897087167, -363.9325309204803, -74.08592455424885, -769.1362137929906, -636.1546176946189, -552.9210508371116, -430.670364659487, -448.02333460626164, -716.1025532088295, -906.4308182894976, -1047.6598075341228, -287.7496087545327, -1062.890395179838, -106.24137330310072, -1087.9901633350478, -0.22179288400050057, -747.5453766574676, -753.0011092446006, -403.0700679601537, -957.6918134085399, -893.9987052848977, -966.607370551586, -981.5915330037839, -198.84844207174896, -671.366252918425, -798.2035851124122, -924.0665813598952, -219.08061343186367, -629.2771986043348, -254.1317354916091, -573.4981416273603, -532.9071536295886, -357.7741796326912, -1094.9008218919964, -820.0463202573086, -1134.2547407850832], "episode_lengths": [106, 98, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 108, 150, 150, 150, 101, 150, 150, 150, 150, 150, 45, 150, 42, 62, 150, 150, 150, 150, 150, 93, 150, 150, 64, 150, 107, 150, 150, 52, 150, 150, 150, 150, 90, 114, 150, 150, 150, 91, 70, 150, 150, 150, 106, 150, 150, 150, 150, 105, 150, 66, 150, 41, 150, 150, 108, 150, 150, 150, 150, 123, 150, 150, 150, 72, 150, 76, 150, 150, 144, 150, 150, 150], "policy_policy_0_reward": [-336.7306765986777, -344.11208374501587, -1034.1868748345019, -479.64779364175854, -924.3853925272556, -422.75062089473255, -882.7676166001122, -832.061480063197, -809.6324887937841, -492.23414985215896, -759.3811306521063, -1008.0885595133569, -1007.3775286070467, -658.4277563416542, -407.86761927896333, -733.0459194213418, -386.11374588671674, -945.6127294709169, -712.7395116979542, -739.8462715720709, -718.9015348127697, -1243.2769563187849, -943.654254607085, -673.5910830273402, -769.0469316502249, -908.0214021063906, -1232.9832129604054, -517.039943855401, -283.2558424224325, -944.7730112929421, -765.7645950194483, -1246.1125352212355, -125.33077246451582, -670.9007539897407, -962.5562300948633, -782.8202466892814, -796.567529571324, -848.0564539281602, -19.818754129961174, -1330.0052362847207, -23.220537639105036, -86.37042422116, -564.5271813775703, -1076.8569923845507, -822.567325871359, -1054.4310327974886, -756.4965546697993, -231.83102774402565, -930.308929624169, -756.5181447252106, -117.88036503210456, -337.18622286231124, -425.8762904989602, -1259.5677668890542, -552.4909140037483, -21.83185947967166, -1059.931204009231, -963.5444440580153, -742.8518160797261, -968.2037518970975, -211.47727736692934, -519.401310746123, -802.2317563684122, -627.609334946037, -420.7976897087167, -363.9325309204803, -74.08592455424885, -769.1362137929906, -636.1546176946189, -552.9210508371116, -430.670364659487, -448.02333460626164, -716.1025532088295, -906.4308182894976, -1047.6598075341228, -287.7496087545327, -1062.890395179838, -106.24137330310072, -1087.9901633350478, -0.22179288400050057, -747.5453766574676, -753.0011092446006, -403.0700679601537, -957.6918134085399, -893.9987052848977, -966.607370551586, -981.5915330037839, -198.84844207174896, -671.366252918425, -798.2035851124122, -924.0665813598952, -219.08061343186367, -629.2771986043348, -254.1317354916091, -573.4981416273603, -532.9071536295886, -357.7741796326912, -1094.9008218919964, -820.0463202573086, -1134.2547407850832]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5523278980037581, "mean_inference_ms": 1.685464819237788, "mean_action_processing_ms": 0.280345012997084, "mean_env_wait_ms": 2.9831771500934674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01215815544128418, "StateBufferConnector_ms": 0.008236408233642578, "ViewRequirementAgentConnector_ms": 0.2012953758239746}, "num_episodes": 29, "episode_return_max": -0.22179288400050057, "episode_return_min": -1330.0052362847207, "episode_return_mean": -674.3556967792043, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.71245374738123, "num_env_steps_trained_throughput_per_sec": 306.71245374738123, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12561.067, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12560.995, "sample_time_ms": 1021.486, "learn_time_ms": 11471.807, "learn_throughput": 348.681, "synch_weights_time_ms": 66.862}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00001", "date": "2024-08-03_10-24-01", "timestamp": 1722660841, "time_this_iter_s": 13.055077314376831, "time_total_s": 258.2888729572296, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf56710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 258.2888729572296, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.984210526315788, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 152.90914669235548, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.8650273836528262, "policy_loss": -0.010272720694289698, "vf_loss": 1.873440054928263, "vf_explained_var": 0.9822519258285562, "kl": 0.015282731234280315, "entropy": 1.1964963655918837, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -0.22179288400050057, "episode_reward_min": -1330.0052362847207, "episode_reward_mean": -656.2047032808642, "episode_len_mean": 131.98, "episode_media": {}, "episodes_timesteps_total": 13198, "policy_reward_min": {"policy_0": -1330.0052362847207}, "policy_reward_max": {"policy_0": -0.22179288400050057}, "policy_reward_mean": {"policy_0": -656.2047032808642}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-944.7730112929421, -765.7645950194483, -1246.1125352212355, -125.33077246451582, -670.9007539897407, -962.5562300948633, -782.8202466892814, -796.567529571324, -848.0564539281602, -19.818754129961174, -1330.0052362847207, -23.220537639105036, -86.37042422116, -564.5271813775703, -1076.8569923845507, -822.567325871359, -1054.4310327974886, -756.4965546697993, -231.83102774402565, -930.308929624169, -756.5181447252106, -117.88036503210456, -337.18622286231124, -425.8762904989602, -1259.5677668890542, -552.4909140037483, -21.83185947967166, -1059.931204009231, -963.5444440580153, -742.8518160797261, -968.2037518970975, -211.47727736692934, -519.401310746123, -802.2317563684122, -627.609334946037, -420.7976897087167, -363.9325309204803, -74.08592455424885, -769.1362137929906, -636.1546176946189, -552.9210508371116, -430.670364659487, -448.02333460626164, -716.1025532088295, -906.4308182894976, -1047.6598075341228, -287.7496087545327, -1062.890395179838, -106.24137330310072, -1087.9901633350478, -0.22179288400050057, -747.5453766574676, -753.0011092446006, -403.0700679601537, -957.6918134085399, -893.9987052848977, -966.607370551586, -981.5915330037839, -198.84844207174896, -671.366252918425, -798.2035851124122, -924.0665813598952, -219.08061343186367, -629.2771986043348, -254.1317354916091, -573.4981416273603, -532.9071536295886, -357.7741796326912, -1094.9008218919964, -820.0463202573086, -1134.2547407850832, -664.8646747728641, -812.8939242477647, -894.280815278876, -457.0897901813768, -726.0906475174789, -1065.5392860068841, -478.1951421115804, -556.2471380784431, -283.5020319303328, -842.5563510265362, -579.4908789629701, -894.5299795269676, -1107.1933127508219, -776.2849027679322, -679.7236440783141, -888.9896005640152, -823.0540764280422, -729.4574326169915, -309.55584716145995, -781.0276511989356, -257.2852407916046, -582.0938047581636, -681.4872459859324, -117.08805484678257, -1169.4465405499518, -298.0640136477853, -34.35947250254685, -946.0941082481328, -955.1961533806517], "episode_lengths": [150, 150, 150, 101, 150, 150, 150, 150, 150, 45, 150, 42, 62, 150, 150, 150, 150, 150, 93, 150, 150, 64, 150, 107, 150, 150, 52, 150, 150, 150, 150, 90, 114, 150, 150, 150, 91, 70, 150, 150, 150, 106, 150, 150, 150, 150, 105, 150, 66, 150, 41, 150, 150, 108, 150, 150, 150, 150, 123, 150, 150, 150, 72, 150, 76, 150, 150, 144, 150, 150, 150, 150, 150, 150, 122, 150, 150, 136, 122, 123, 150, 127, 150, 150, 150, 150, 150, 150, 150, 91, 150, 129, 150, 150, 78, 150, 102, 46, 150, 150], "policy_policy_0_reward": [-944.7730112929421, -765.7645950194483, -1246.1125352212355, -125.33077246451582, -670.9007539897407, -962.5562300948633, -782.8202466892814, -796.567529571324, -848.0564539281602, -19.818754129961174, -1330.0052362847207, -23.220537639105036, -86.37042422116, -564.5271813775703, -1076.8569923845507, -822.567325871359, -1054.4310327974886, -756.4965546697993, -231.83102774402565, -930.308929624169, -756.5181447252106, -117.88036503210456, -337.18622286231124, -425.8762904989602, -1259.5677668890542, -552.4909140037483, -21.83185947967166, -1059.931204009231, -963.5444440580153, -742.8518160797261, -968.2037518970975, -211.47727736692934, -519.401310746123, -802.2317563684122, -627.609334946037, -420.7976897087167, -363.9325309204803, -74.08592455424885, -769.1362137929906, -636.1546176946189, -552.9210508371116, -430.670364659487, -448.02333460626164, -716.1025532088295, -906.4308182894976, -1047.6598075341228, -287.7496087545327, -1062.890395179838, -106.24137330310072, -1087.9901633350478, -0.22179288400050057, -747.5453766574676, -753.0011092446006, -403.0700679601537, -957.6918134085399, -893.9987052848977, -966.607370551586, -981.5915330037839, -198.84844207174896, -671.366252918425, -798.2035851124122, -924.0665813598952, -219.08061343186367, -629.2771986043348, -254.1317354916091, -573.4981416273603, -532.9071536295886, -357.7741796326912, -1094.9008218919964, -820.0463202573086, -1134.2547407850832, -664.8646747728641, -812.8939242477647, -894.280815278876, -457.0897901813768, -726.0906475174789, -1065.5392860068841, -478.1951421115804, -556.2471380784431, -283.5020319303328, -842.5563510265362, -579.4908789629701, -894.5299795269676, -1107.1933127508219, -776.2849027679322, -679.7236440783141, -888.9896005640152, -823.0540764280422, -729.4574326169915, -309.55584716145995, -781.0276511989356, -257.2852407916046, -582.0938047581636, -681.4872459859324, -117.08805484678257, -1169.4465405499518, -298.0640136477853, -34.35947250254685, -946.0941082481328, -955.1961533806517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5524039916345359, "mean_inference_ms": 1.685043130652015, "mean_action_processing_ms": 0.2802351631651664, "mean_env_wait_ms": 2.982750896451863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011918783187866211, "StateBufferConnector_ms": 0.008648157119750977, "ViewRequirementAgentConnector_ms": 0.1952669620513916}, "num_episodes": 29, "episode_return_max": -0.22179288400050057, "episode_return_min": -1330.0052362847207, "episode_return_mean": -656.2047032808642, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.35775640205065, "num_env_steps_trained_throughput_per_sec": 302.35775640205065, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12584.469, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12584.397, "sample_time_ms": 1021.085, "learn_time_ms": 11496.808, "learn_throughput": 347.923, "synch_weights_time_ms": 65.674}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00001", "date": "2024-08-03_10-24-14", "timestamp": 1722660854, "time_this_iter_s": 13.241746425628662, "time_total_s": 271.5306193828583, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf576d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 271.5306193828583, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 12.931578947368422, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 134.25513162215552, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.1177548792213203, "policy_loss": -0.018659898743984136, "vf_loss": 2.133973804488778, "vf_explained_var": 0.9930900471284986, "kl": 0.01837623555996591, "entropy": 1.234281136840582, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -0.22179288400050057, "episode_reward_min": -1339.2460981039185, "episode_reward_mean": -647.6542165868672, "episode_len_mean": 134.58, "episode_media": {}, "episodes_timesteps_total": 13458, "policy_reward_min": {"policy_0": -1339.2460981039185}, "policy_reward_max": {"policy_0": -0.22179288400050057}, "policy_reward_mean": {"policy_0": -647.6542165868672}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-211.47727736692934, -519.401310746123, -802.2317563684122, -627.609334946037, -420.7976897087167, -363.9325309204803, -74.08592455424885, -769.1362137929906, -636.1546176946189, -552.9210508371116, -430.670364659487, -448.02333460626164, -716.1025532088295, -906.4308182894976, -1047.6598075341228, -287.7496087545327, -1062.890395179838, -106.24137330310072, -1087.9901633350478, -0.22179288400050057, -747.5453766574676, -753.0011092446006, -403.0700679601537, -957.6918134085399, -893.9987052848977, -966.607370551586, -981.5915330037839, -198.84844207174896, -671.366252918425, -798.2035851124122, -924.0665813598952, -219.08061343186367, -629.2771986043348, -254.1317354916091, -573.4981416273603, -532.9071536295886, -357.7741796326912, -1094.9008218919964, -820.0463202573086, -1134.2547407850832, -664.8646747728641, -812.8939242477647, -894.280815278876, -457.0897901813768, -726.0906475174789, -1065.5392860068841, -478.1951421115804, -556.2471380784431, -283.5020319303328, -842.5563510265362, -579.4908789629701, -894.5299795269676, -1107.1933127508219, -776.2849027679322, -679.7236440783141, -888.9896005640152, -823.0540764280422, -729.4574326169915, -309.55584716145995, -781.0276511989356, -257.2852407916046, -582.0938047581636, -681.4872459859324, -117.08805484678257, -1169.4465405499518, -298.0640136477853, -34.35947250254685, -946.0941082481328, -955.1961533806517, -514.0241754121776, -890.4088969098912, -819.6713915679667, -1339.2460981039185, -925.2203696088114, -845.1105644886322, -509.97728341019, -491.0229252282662, -590.6844881950822, -18.492777587426254, -273.7219866417991, -1066.6262463330531, -298.99717921533073, -663.8152842602228, -1002.3881824018877, -1002.3564281267909, -736.8396020829947, -977.5525701357825, -910.819886578109, -833.4205547576059, -815.1116643628111, -564.6400338003424, -300.42786360892586, -824.8864802268218, -551.5399654378447, -621.1005013306026, -316.4973726477275, -630.0287026072297, -218.63926312080338, -577.8381982892643, -259.04329867253136], "episode_lengths": [90, 114, 150, 150, 150, 91, 70, 150, 150, 150, 106, 150, 150, 150, 150, 105, 150, 66, 150, 41, 150, 150, 108, 150, 150, 150, 150, 123, 150, 150, 150, 72, 150, 76, 150, 150, 144, 150, 150, 150, 150, 150, 150, 122, 150, 150, 136, 122, 123, 150, 127, 150, 150, 150, 150, 150, 150, 150, 91, 150, 129, 150, 150, 78, 150, 102, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 118, 150, 83, 150, 84], "policy_policy_0_reward": [-211.47727736692934, -519.401310746123, -802.2317563684122, -627.609334946037, -420.7976897087167, -363.9325309204803, -74.08592455424885, -769.1362137929906, -636.1546176946189, -552.9210508371116, -430.670364659487, -448.02333460626164, -716.1025532088295, -906.4308182894976, -1047.6598075341228, -287.7496087545327, -1062.890395179838, -106.24137330310072, -1087.9901633350478, -0.22179288400050057, -747.5453766574676, -753.0011092446006, -403.0700679601537, -957.6918134085399, -893.9987052848977, -966.607370551586, -981.5915330037839, -198.84844207174896, -671.366252918425, -798.2035851124122, -924.0665813598952, -219.08061343186367, -629.2771986043348, -254.1317354916091, -573.4981416273603, -532.9071536295886, -357.7741796326912, -1094.9008218919964, -820.0463202573086, -1134.2547407850832, -664.8646747728641, -812.8939242477647, -894.280815278876, -457.0897901813768, -726.0906475174789, -1065.5392860068841, -478.1951421115804, -556.2471380784431, -283.5020319303328, -842.5563510265362, -579.4908789629701, -894.5299795269676, -1107.1933127508219, -776.2849027679322, -679.7236440783141, -888.9896005640152, -823.0540764280422, -729.4574326169915, -309.55584716145995, -781.0276511989356, -257.2852407916046, -582.0938047581636, -681.4872459859324, -117.08805484678257, -1169.4465405499518, -298.0640136477853, -34.35947250254685, -946.0941082481328, -955.1961533806517, -514.0241754121776, -890.4088969098912, -819.6713915679667, -1339.2460981039185, -925.2203696088114, -845.1105644886322, -509.97728341019, -491.0229252282662, -590.6844881950822, -18.492777587426254, -273.7219866417991, -1066.6262463330531, -298.99717921533073, -663.8152842602228, -1002.3881824018877, -1002.3564281267909, -736.8396020829947, -977.5525701357825, -910.819886578109, -833.4205547576059, -815.1116643628111, -564.6400338003424, -300.42786360892586, -824.8864802268218, -551.5399654378447, -621.1005013306026, -316.4973726477275, -630.0287026072297, -218.63926312080338, -577.8381982892643, -259.04329867253136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5519883982204032, "mean_inference_ms": 1.6826798346632692, "mean_action_processing_ms": 0.2797667849977417, "mean_env_wait_ms": 2.9794404023848613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011710882186889648, "StateBufferConnector_ms": 0.008542299270629883, "ViewRequirementAgentConnector_ms": 0.19110369682312012}, "num_episodes": 31, "episode_return_max": -0.22179288400050057, "episode_return_min": -1339.2460981039185, "episode_return_mean": -647.6542165868672, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.66354804010103, "num_env_steps_trained_throughput_per_sec": 300.66354804010103, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12571.583, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12571.514, "sample_time_ms": 1020.998, "learn_time_ms": 11483.646, "learn_throughput": 348.321, "synch_weights_time_ms": 66.035}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00001", "date": "2024-08-03_10-24-28", "timestamp": 1722660868, "time_this_iter_s": 13.316354751586914, "time_total_s": 284.8469741344452, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0e0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 284.8469741344452, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 12.936842105263159, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 170.40852608482044, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.854516616401573, "policy_loss": -0.009098290371184703, "vf_loss": 1.8611437815551957, "vf_explained_var": 0.9904387818028529, "kl": 0.019215560431742558, "entropy": 1.3719882963846126, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -18.492777587426254, "episode_reward_min": -1339.2460981039185, "episode_reward_mean": -666.648106178739, "episode_len_mean": 138.13, "episode_media": {}, "episodes_timesteps_total": 13813, "policy_reward_min": {"policy_0": -1339.2460981039185}, "policy_reward_max": {"policy_0": -18.492777587426254}, "policy_reward_mean": {"policy_0": -666.648106178739}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-671.366252918425, -798.2035851124122, -924.0665813598952, -219.08061343186367, -629.2771986043348, -254.1317354916091, -573.4981416273603, -532.9071536295886, -357.7741796326912, -1094.9008218919964, -820.0463202573086, -1134.2547407850832, -664.8646747728641, -812.8939242477647, -894.280815278876, -457.0897901813768, -726.0906475174789, -1065.5392860068841, -478.1951421115804, -556.2471380784431, -283.5020319303328, -842.5563510265362, -579.4908789629701, -894.5299795269676, -1107.1933127508219, -776.2849027679322, -679.7236440783141, -888.9896005640152, -823.0540764280422, -729.4574326169915, -309.55584716145995, -781.0276511989356, -257.2852407916046, -582.0938047581636, -681.4872459859324, -117.08805484678257, -1169.4465405499518, -298.0640136477853, -34.35947250254685, -946.0941082481328, -955.1961533806517, -514.0241754121776, -890.4088969098912, -819.6713915679667, -1339.2460981039185, -925.2203696088114, -845.1105644886322, -509.97728341019, -491.0229252282662, -590.6844881950822, -18.492777587426254, -273.7219866417991, -1066.6262463330531, -298.99717921533073, -663.8152842602228, -1002.3881824018877, -1002.3564281267909, -736.8396020829947, -977.5525701357825, -910.819886578109, -833.4205547576059, -815.1116643628111, -564.6400338003424, -300.42786360892586, -824.8864802268218, -551.5399654378447, -621.1005013306026, -316.4973726477275, -630.0287026072297, -218.63926312080338, -577.8381982892643, -259.04329867253136, -691.7336775068146, -974.9426708072556, -1037.2814498503622, -274.42498987225986, -831.878220095911, -281.0810477866873, -691.8309297112265, -833.0517625644505, -582.0502127161849, -122.77728933799565, -925.2802480074547, -1021.1412337786585, -729.497652994344, -785.9319531384664, -713.1497775158158, -640.7056730993371, -540.0200210422483, -967.6827933709245, -551.7617243691684, -174.20337775705013, -671.5832163187879, -504.7501447313886, -337.6091353871351, -715.9999280541924, -797.6912320187251, -402.02714861749325, -1173.4708372068635, -899.9129484031487], "episode_lengths": [150, 150, 150, 72, 150, 76, 150, 150, 144, 150, 150, 150, 150, 150, 150, 122, 150, 150, 136, 122, 123, 150, 127, 150, 150, 150, 150, 150, 150, 150, 91, 150, 129, 150, 150, 78, 150, 102, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 118, 150, 83, 150, 84, 150, 150, 150, 150, 150, 89, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 143, 140, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-671.366252918425, -798.2035851124122, -924.0665813598952, -219.08061343186367, -629.2771986043348, -254.1317354916091, -573.4981416273603, -532.9071536295886, -357.7741796326912, -1094.9008218919964, -820.0463202573086, -1134.2547407850832, -664.8646747728641, -812.8939242477647, -894.280815278876, -457.0897901813768, -726.0906475174789, -1065.5392860068841, -478.1951421115804, -556.2471380784431, -283.5020319303328, -842.5563510265362, -579.4908789629701, -894.5299795269676, -1107.1933127508219, -776.2849027679322, -679.7236440783141, -888.9896005640152, -823.0540764280422, -729.4574326169915, -309.55584716145995, -781.0276511989356, -257.2852407916046, -582.0938047581636, -681.4872459859324, -117.08805484678257, -1169.4465405499518, -298.0640136477853, -34.35947250254685, -946.0941082481328, -955.1961533806517, -514.0241754121776, -890.4088969098912, -819.6713915679667, -1339.2460981039185, -925.2203696088114, -845.1105644886322, -509.97728341019, -491.0229252282662, -590.6844881950822, -18.492777587426254, -273.7219866417991, -1066.6262463330531, -298.99717921533073, -663.8152842602228, -1002.3881824018877, -1002.3564281267909, -736.8396020829947, -977.5525701357825, -910.819886578109, -833.4205547576059, -815.1116643628111, -564.6400338003424, -300.42786360892586, -824.8864802268218, -551.5399654378447, -621.1005013306026, -316.4973726477275, -630.0287026072297, -218.63926312080338, -577.8381982892643, -259.04329867253136, -691.7336775068146, -974.9426708072556, -1037.2814498503622, -274.42498987225986, -831.878220095911, -281.0810477866873, -691.8309297112265, -833.0517625644505, -582.0502127161849, -122.77728933799565, -925.2802480074547, -1021.1412337786585, -729.497652994344, -785.9319531384664, -713.1497775158158, -640.7056730993371, -540.0200210422483, -967.6827933709245, -551.7617243691684, -174.20337775705013, -671.5832163187879, -504.7501447313886, -337.6091353871351, -715.9999280541924, -797.6912320187251, -402.02714861749325, -1173.4708372068635, -899.9129484031487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.551909658937821, "mean_inference_ms": 1.6821476839539506, "mean_action_processing_ms": 0.2795085472067404, "mean_env_wait_ms": 2.979743441129358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011850357055664062, "StateBufferConnector_ms": 0.008546113967895508, "ViewRequirementAgentConnector_ms": 0.19054532051086426}, "num_episodes": 28, "episode_return_max": -18.492777587426254, "episode_return_min": -1339.2460981039185, "episode_return_mean": -666.648106178739, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.5484506984575, "num_env_steps_trained_throughput_per_sec": 304.5484506984575, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12576.224, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12576.155, "sample_time_ms": 1020.376, "learn_time_ms": 11489.546, "learn_throughput": 348.143, "synch_weights_time_ms": 65.396}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00001", "date": "2024-08-03_10-24-41", "timestamp": 1722660881, "time_this_iter_s": 13.148290395736694, "time_total_s": 297.9952645301819, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf57130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 297.9952645301819, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.366666666666667, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 126.01636727849642, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.0752704940736293, "policy_loss": -0.00899402923193217, "vf_loss": 2.081887491730352, "vf_explained_var": 0.9764260125656923, "kl": 0.01805230975660379, "entropy": 1.2334225479513408, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -18.492777587426254, "episode_reward_min": -1339.2460981039185, "episode_reward_mean": -656.1862915025418, "episode_len_mean": 137.01, "episode_media": {}, "episodes_timesteps_total": 13701, "policy_reward_min": {"policy_0": -1339.2460981039185}, "policy_reward_max": {"policy_0": -18.492777587426254}, "policy_reward_mean": {"policy_0": -656.1862915025418}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-729.4574326169915, -309.55584716145995, -781.0276511989356, -257.2852407916046, -582.0938047581636, -681.4872459859324, -117.08805484678257, -1169.4465405499518, -298.0640136477853, -34.35947250254685, -946.0941082481328, -955.1961533806517, -514.0241754121776, -890.4088969098912, -819.6713915679667, -1339.2460981039185, -925.2203696088114, -845.1105644886322, -509.97728341019, -491.0229252282662, -590.6844881950822, -18.492777587426254, -273.7219866417991, -1066.6262463330531, -298.99717921533073, -663.8152842602228, -1002.3881824018877, -1002.3564281267909, -736.8396020829947, -977.5525701357825, -910.819886578109, -833.4205547576059, -815.1116643628111, -564.6400338003424, -300.42786360892586, -824.8864802268218, -551.5399654378447, -621.1005013306026, -316.4973726477275, -630.0287026072297, -218.63926312080338, -577.8381982892643, -259.04329867253136, -691.7336775068146, -974.9426708072556, -1037.2814498503622, -274.42498987225986, -831.878220095911, -281.0810477866873, -691.8309297112265, -833.0517625644505, -582.0502127161849, -122.77728933799565, -925.2802480074547, -1021.1412337786585, -729.497652994344, -785.9319531384664, -713.1497775158158, -640.7056730993371, -540.0200210422483, -967.6827933709245, -551.7617243691684, -174.20337775705013, -671.5832163187879, -504.7501447313886, -337.6091353871351, -715.9999280541924, -797.6912320187251, -402.02714861749325, -1173.4708372068635, -899.9129484031487, -519.0457457169765, -843.5580309794817, -634.488860483595, -779.170907526951, -254.83544745650272, -740.9374503150959, -1066.52737410488, -674.3230362774951, -1060.7613668881415, -903.9954726360485, -788.9437530028849, -860.661698220562, -475.8706084338079, -887.1632738608167, -336.5264124393466, -510.43442591082237, -395.67477788123495, -567.645578906094, -590.1491178461454, -916.114606788675, -1282.8801326271553, -194.02785777556207, -875.5564499931822, -1055.0700983089228, -335.4977449642426, -822.7827993897236, -300.33306936124995, -761.6610609767332, -59.214894281712226], "episode_lengths": [150, 91, 150, 129, 150, 150, 78, 150, 102, 46, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 118, 150, 83, 150, 84, 150, 150, 150, 150, 150, 89, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 143, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 100, 150, 150, 150, 150, 84, 150, 150, 134, 150, 92, 147, 63], "policy_policy_0_reward": [-729.4574326169915, -309.55584716145995, -781.0276511989356, -257.2852407916046, -582.0938047581636, -681.4872459859324, -117.08805484678257, -1169.4465405499518, -298.0640136477853, -34.35947250254685, -946.0941082481328, -955.1961533806517, -514.0241754121776, -890.4088969098912, -819.6713915679667, -1339.2460981039185, -925.2203696088114, -845.1105644886322, -509.97728341019, -491.0229252282662, -590.6844881950822, -18.492777587426254, -273.7219866417991, -1066.6262463330531, -298.99717921533073, -663.8152842602228, -1002.3881824018877, -1002.3564281267909, -736.8396020829947, -977.5525701357825, -910.819886578109, -833.4205547576059, -815.1116643628111, -564.6400338003424, -300.42786360892586, -824.8864802268218, -551.5399654378447, -621.1005013306026, -316.4973726477275, -630.0287026072297, -218.63926312080338, -577.8381982892643, -259.04329867253136, -691.7336775068146, -974.9426708072556, -1037.2814498503622, -274.42498987225986, -831.878220095911, -281.0810477866873, -691.8309297112265, -833.0517625644505, -582.0502127161849, -122.77728933799565, -925.2802480074547, -1021.1412337786585, -729.497652994344, -785.9319531384664, -713.1497775158158, -640.7056730993371, -540.0200210422483, -967.6827933709245, -551.7617243691684, -174.20337775705013, -671.5832163187879, -504.7501447313886, -337.6091353871351, -715.9999280541924, -797.6912320187251, -402.02714861749325, -1173.4708372068635, -899.9129484031487, -519.0457457169765, -843.5580309794817, -634.488860483595, -779.170907526951, -254.83544745650272, -740.9374503150959, -1066.52737410488, -674.3230362774951, -1060.7613668881415, -903.9954726360485, -788.9437530028849, -860.661698220562, -475.8706084338079, -887.1632738608167, -336.5264124393466, -510.43442591082237, -395.67477788123495, -567.645578906094, -590.1491178461454, -916.114606788675, -1282.8801326271553, -194.02785777556207, -875.5564499931822, -1055.0700983089228, -335.4977449642426, -822.7827993897236, -300.33306936124995, -761.6610609767332, -59.214894281712226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5518577361117765, "mean_inference_ms": 1.6819419864738565, "mean_action_processing_ms": 0.27944100661375354, "mean_env_wait_ms": 2.9797725160797217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011925458908081055, "StateBufferConnector_ms": 0.00805807113647461, "ViewRequirementAgentConnector_ms": 0.19411396980285645}, "num_episodes": 29, "episode_return_max": -18.492777587426254, "episode_return_min": -1339.2460981039185, "episode_return_mean": -656.1862915025418, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.9049649182186, "num_env_steps_trained_throughput_per_sec": 300.9049649182186, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12607.521, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12607.45, "sample_time_ms": 1027.009, "learn_time_ms": 11514.601, "learn_throughput": 347.385, "synch_weights_time_ms": 65.003}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00001", "date": "2024-08-03_10-24-54", "timestamp": 1722660894, "time_this_iter_s": 13.305192470550537, "time_total_s": 311.3004570007324, "pid": 506881, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00bd510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 311.3004570007324, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.326315789473684, "ram_util_percent": 27.600000000000005}}
