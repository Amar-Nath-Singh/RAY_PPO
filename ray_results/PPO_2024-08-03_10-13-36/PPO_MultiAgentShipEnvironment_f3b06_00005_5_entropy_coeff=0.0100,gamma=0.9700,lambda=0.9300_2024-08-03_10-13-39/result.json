{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9990689640243848, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.625421166419983, "policy_loss": -0.0059811837282419825, "vf_loss": 9.643906658887863, "vf_explained_var": 0.028091537269453206, "kl": 0.007597349286697863, "entropy": 1.4023774564266205, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -99.06619434955162, "episode_reward_min": -1028.9961467776193, "episode_reward_mean": -691.5004461271845, "episode_len_mean": 143.3913043478261, "episode_media": {}, "episodes_timesteps_total": 3298, "policy_reward_min": {"policy_0": -1028.9961467776193}, "policy_reward_max": {"policy_0": -99.06619434955162}, "policy_reward_mean": {"policy_0": -691.5004461271845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1013.5168802467738, -803.615892553738, -533.69848320051, -764.3570734457511, -653.7587199585759, -567.2441926675579, -509.9813694602373, -352.14151550447514, -813.3467752496209, -542.1897267399789, -947.5617222990818, -968.9423717024582, -920.1709343688864, -890.2812302922677, -797.8663869373385, -720.1420560745295, -211.27070904735857, -99.06619434955162, -838.3859895111214, -1028.9961467776193, -588.5836866229854, -818.075245859817, -521.3169580550093], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 104, 79, 150, 150, 146, 150, 150], "policy_policy_0_reward": [-1013.5168802467738, -803.615892553738, -533.69848320051, -764.3570734457511, -653.7587199585759, -567.2441926675579, -509.9813694602373, -352.14151550447514, -813.3467752496209, -542.1897267399789, -947.5617222990818, -968.9423717024582, -920.1709343688864, -890.2812302922677, -797.8663869373385, -720.1420560745295, -211.27070904735857, -99.06619434955162, -838.3859895111214, -1028.9961467776193, -588.5836866229854, -818.075245859817, -521.3169580550093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5760826090550349, "mean_inference_ms": 1.676949118532971, "mean_action_processing_ms": 0.2827701339155208, "mean_env_wait_ms": 3.0022009838450394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011306223662003227, "StateBufferConnector_ms": 0.00802537669306216, "ViewRequirementAgentConnector_ms": 0.18062591552734375}, "num_episodes": 23, "episode_return_max": -99.06619434955162, "episode_return_min": -1028.9961467776193, "episode_return_mean": -691.5004461271845, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.4553630332404, "num_env_steps_trained_throughput_per_sec": 297.4553630332404, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13447.406, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13447.344, "sample_time_ms": 1080.849, "learn_time_ms": 12303.225, "learn_throughput": 325.118, "synch_weights_time_ms": 62.479}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00005", "date": "2024-08-03_10-42-21", "timestamp": 1722661941, "time_this_iter_s": 13.459041833877563, "time_total_s": 13.459041833877563, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0fd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.459041833877563, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.774999999999999, "ram_util_percent": 27.494999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.016169662773609, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.03328281690677, "policy_loss": -0.012701632184325717, "vf_loss": 9.056557880342007, "vf_explained_var": 0.27340748185912767, "kl": 0.016308085258485032, "entropy": 1.3835007149726153, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -34.56901181273672, "episode_reward_min": -1146.932621441751, "episode_reward_mean": -649.1298851998558, "episode_len_mean": 135.15217391304347, "episode_media": {}, "episodes_timesteps_total": 6217, "policy_reward_min": {"policy_0": -1146.932621441751}, "policy_reward_max": {"policy_0": -34.56901181273672}, "policy_reward_mean": {"policy_0": -649.1298851998558}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1013.5168802467738, -803.615892553738, -533.69848320051, -764.3570734457511, -653.7587199585759, -567.2441926675579, -509.9813694602373, -352.14151550447514, -813.3467752496209, -542.1897267399789, -947.5617222990818, -968.9423717024582, -920.1709343688864, -890.2812302922677, -797.8663869373385, -720.1420560745295, -211.27070904735857, -99.06619434955162, -838.3859895111214, -1028.9961467776193, -588.5836866229854, -818.075245859817, -521.3169580550093, -189.33568869527141, -113.65640104244689, -213.28952166611475, -205.75818926725202, -34.56901181273672, -794.0141254439819, -803.5035950950701, -692.5687507238695, -863.2716756203216, -999.27597323296, -151.30057134302112, -970.4506116576142, -329.7763098067474, -1038.5504547771734, -858.9776014198285, -36.10026474545173, -879.0330748696548, -943.6664264438589, -815.5087704126634, -1146.932621441751, -1102.1476182725896, -682.1403540889906, -91.63684638875418], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 104, 79, 150, 150, 146, 150, 150, 150, 63, 111, 89, 59, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 83], "policy_policy_0_reward": [-1013.5168802467738, -803.615892553738, -533.69848320051, -764.3570734457511, -653.7587199585759, -567.2441926675579, -509.9813694602373, -352.14151550447514, -813.3467752496209, -542.1897267399789, -947.5617222990818, -968.9423717024582, -920.1709343688864, -890.2812302922677, -797.8663869373385, -720.1420560745295, -211.27070904735857, -99.06619434955162, -838.3859895111214, -1028.9961467776193, -588.5836866229854, -818.075245859817, -521.3169580550093, -189.33568869527141, -113.65640104244689, -213.28952166611475, -205.75818926725202, -34.56901181273672, -794.0141254439819, -803.5035950950701, -692.5687507238695, -863.2716756203216, -999.27597323296, -151.30057134302112, -970.4506116576142, -329.7763098067474, -1038.5504547771734, -858.9776014198285, -36.10026474545173, -879.0330748696548, -943.6664264438589, -815.5087704126634, -1146.932621441751, -1102.1476182725896, -682.1403540889906, -91.63684638875418]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5702848816500345, "mean_inference_ms": 1.6746613545458657, "mean_action_processing_ms": 0.28249201945951563, "mean_env_wait_ms": 2.9939407728594385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013537510581638502, "StateBufferConnector_ms": 0.008383004561714504, "ViewRequirementAgentConnector_ms": 0.19052546957264777}, "num_episodes": 23, "episode_return_max": -34.56901181273672, "episode_return_min": -1146.932621441751, "episode_return_mean": -649.1298851998558, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.39507432905305, "num_env_steps_trained_throughput_per_sec": 300.39507432905305, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13381.611, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13381.536, "sample_time_ms": 1041.275, "learn_time_ms": 12277.063, "learn_throughput": 325.811, "synch_weights_time_ms": 62.371}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00005", "date": "2024-08-03_10-42-34", "timestamp": 1722661954, "time_this_iter_s": 13.328566074371338, "time_total_s": 26.7876079082489, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010b9a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.7876079082489, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.18421052631579, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.27731765601784, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.22510916342338, "policy_loss": -0.008094429973668108, "vf_loss": 9.24395905782779, "vf_explained_var": 0.22900097494324048, "kl": 0.01104847629952322, "entropy": 1.2965141979356607, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -12.125722601977955, "episode_reward_min": -1165.454837388037, "episode_reward_mean": -642.912305119491, "episode_len_mean": 137.32, "episode_media": {}, "episodes_timesteps_total": 10299, "policy_reward_min": {"policy_0": -1165.454837388037}, "policy_reward_max": {"policy_0": -12.125722601977955}, "policy_reward_mean": {"policy_0": -642.912305119491}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1013.5168802467738, -803.615892553738, -533.69848320051, -764.3570734457511, -653.7587199585759, -567.2441926675579, -509.9813694602373, -352.14151550447514, -813.3467752496209, -542.1897267399789, -947.5617222990818, -968.9423717024582, -920.1709343688864, -890.2812302922677, -797.8663869373385, -720.1420560745295, -211.27070904735857, -99.06619434955162, -838.3859895111214, -1028.9961467776193, -588.5836866229854, -818.075245859817, -521.3169580550093, -189.33568869527141, -113.65640104244689, -213.28952166611475, -205.75818926725202, -34.56901181273672, -794.0141254439819, -803.5035950950701, -692.5687507238695, -863.2716756203216, -999.27597323296, -151.30057134302112, -970.4506116576142, -329.7763098067474, -1038.5504547771734, -858.9776014198285, -36.10026474545173, -879.0330748696548, -943.6664264438589, -815.5087704126634, -1146.932621441751, -1102.1476182725896, -682.1403540889906, -91.63684638875418, -696.8588691792642, -1165.454837388037, -1114.2749293898332, -527.2382381008794, -895.0548709709948, -486.38610039894127, -607.6928712830276, -570.6088642609122, -555.5343960014458, -646.4648426714924, -375.041461192686, -382.13390673846334, -269.4417812998679, -852.9895713474598, -443.2176342331323, -785.273874924087, -12.125722601977955, -1102.3827665005624, -1008.3925569896414, -643.5642409432689, -522.4645120435745, -844.7305260134312, -872.0383729650133, -473.0079694179842, -46.52916327987211, -621.8719576670579, -368.86866592010733, -718.3731844113312, -750.4314766341095], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 104, 79, 150, 150, 146, 150, 150, 150, 63, 111, 89, 59, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 103, 150, 56, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150], "policy_policy_0_reward": [-1013.5168802467738, -803.615892553738, -533.69848320051, -764.3570734457511, -653.7587199585759, -567.2441926675579, -509.9813694602373, -352.14151550447514, -813.3467752496209, -542.1897267399789, -947.5617222990818, -968.9423717024582, -920.1709343688864, -890.2812302922677, -797.8663869373385, -720.1420560745295, -211.27070904735857, -99.06619434955162, -838.3859895111214, -1028.9961467776193, -588.5836866229854, -818.075245859817, -521.3169580550093, -189.33568869527141, -113.65640104244689, -213.28952166611475, -205.75818926725202, -34.56901181273672, -794.0141254439819, -803.5035950950701, -692.5687507238695, -863.2716756203216, -999.27597323296, -151.30057134302112, -970.4506116576142, -329.7763098067474, -1038.5504547771734, -858.9776014198285, -36.10026474545173, -879.0330748696548, -943.6664264438589, -815.5087704126634, -1146.932621441751, -1102.1476182725896, -682.1403540889906, -91.63684638875418, -696.8588691792642, -1165.454837388037, -1114.2749293898332, -527.2382381008794, -895.0548709709948, -486.38610039894127, -607.6928712830276, -570.6088642609122, -555.5343960014458, -646.4648426714924, -375.041461192686, -382.13390673846334, -269.4417812998679, -852.9895713474598, -443.2176342331323, -785.273874924087, -12.125722601977955, -1102.3827665005624, -1008.3925569896414, -643.5642409432689, -522.4645120435745, -844.7305260134312, -872.0383729650133, -473.0079694179842, -46.52916327987211, -621.8719576670579, -368.86866592010733, -718.3731844113312, -750.4314766341095]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5699206838207257, "mean_inference_ms": 1.680068097753073, "mean_action_processing_ms": 0.28318853620836076, "mean_env_wait_ms": 2.989341181555841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013763745625813803, "StateBufferConnector_ms": 0.00858147939046224, "ViewRequirementAgentConnector_ms": 0.1936016082763672}, "num_episodes": 29, "episode_return_max": -12.125722601977955, "episode_return_min": -1165.454837388037, "episode_return_mean": -642.912305119491, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.96549175571107, "num_env_steps_trained_throughput_per_sec": 300.96549175571107, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13351.266, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13351.192, "sample_time_ms": 1032.774, "learn_time_ms": 12248.995, "learn_throughput": 326.557, "synch_weights_time_ms": 68.618}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00005", "date": "2024-08-03_10-42-47", "timestamp": 1722661967, "time_this_iter_s": 13.303838968276978, "time_total_s": 40.09144687652588, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907bb520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 40.09144687652588, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.484210526315788, "ram_util_percent": 27.589473684210528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.216246555310985, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.206056326131026, "policy_loss": -0.010998022433098716, "vf_loss": 9.228306568662326, "vf_explained_var": 0.23531271008153756, "kl": 0.01255669143850658, "entropy": 1.3763567825158438, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -12.125722601977955, "episode_reward_min": -1191.066291569416, "episode_reward_mean": -659.6068865127023, "episode_len_mean": 137.01, "episode_media": {}, "episodes_timesteps_total": 13701, "policy_reward_min": {"policy_0": -1191.066291569416}, "policy_reward_max": {"policy_0": -12.125722601977955}, "policy_reward_mean": {"policy_0": -659.6068865127023}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-567.2441926675579, -509.9813694602373, -352.14151550447514, -813.3467752496209, -542.1897267399789, -947.5617222990818, -968.9423717024582, -920.1709343688864, -890.2812302922677, -797.8663869373385, -720.1420560745295, -211.27070904735857, -99.06619434955162, -838.3859895111214, -1028.9961467776193, -588.5836866229854, -818.075245859817, -521.3169580550093, -189.33568869527141, -113.65640104244689, -213.28952166611475, -205.75818926725202, -34.56901181273672, -794.0141254439819, -803.5035950950701, -692.5687507238695, -863.2716756203216, -999.27597323296, -151.30057134302112, -970.4506116576142, -329.7763098067474, -1038.5504547771734, -858.9776014198285, -36.10026474545173, -879.0330748696548, -943.6664264438589, -815.5087704126634, -1146.932621441751, -1102.1476182725896, -682.1403540889906, -91.63684638875418, -696.8588691792642, -1165.454837388037, -1114.2749293898332, -527.2382381008794, -895.0548709709948, -486.38610039894127, -607.6928712830276, -570.6088642609122, -555.5343960014458, -646.4648426714924, -375.041461192686, -382.13390673846334, -269.4417812998679, -852.9895713474598, -443.2176342331323, -785.273874924087, -12.125722601977955, -1102.3827665005624, -1008.3925569896414, -643.5642409432689, -522.4645120435745, -844.7305260134312, -872.0383729650133, -473.0079694179842, -46.52916327987211, -621.8719576670579, -368.86866592010733, -718.3731844113312, -750.4314766341095, -949.3730875379769, -969.7306849234462, -482.8284743192156, -902.0730716427076, -608.3867327734654, -1150.3016017622408, -803.626987312384, -426.19067625123756, -959.3809586648, -110.97912746059947, -928.2866653768097, -33.31083047873709, -351.4248955194983, -857.5064010674264, -653.5275850919694, -724.9463430162763, -1069.5918942144342, -770.2116275146301, -1092.1096702850148, -272.82811981537753, -152.70945068745866, -727.303899560322, -908.8022266397974, -563.5876471622838, -762.5825698708707, -968.3634113112103, -428.551182928117, -780.4819088653713, -1191.066291569416, -911.1487930906563], "episode_lengths": [150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 104, 79, 150, 150, 146, 150, 150, 150, 63, 111, 89, 59, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 103, 150, 56, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 150, 58, 150, 57, 150, 150, 150, 150, 150, 150, 150, 87, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-567.2441926675579, -509.9813694602373, -352.14151550447514, -813.3467752496209, -542.1897267399789, -947.5617222990818, -968.9423717024582, -920.1709343688864, -890.2812302922677, -797.8663869373385, -720.1420560745295, -211.27070904735857, -99.06619434955162, -838.3859895111214, -1028.9961467776193, -588.5836866229854, -818.075245859817, -521.3169580550093, -189.33568869527141, -113.65640104244689, -213.28952166611475, -205.75818926725202, -34.56901181273672, -794.0141254439819, -803.5035950950701, -692.5687507238695, -863.2716756203216, -999.27597323296, -151.30057134302112, -970.4506116576142, -329.7763098067474, -1038.5504547771734, -858.9776014198285, -36.10026474545173, -879.0330748696548, -943.6664264438589, -815.5087704126634, -1146.932621441751, -1102.1476182725896, -682.1403540889906, -91.63684638875418, -696.8588691792642, -1165.454837388037, -1114.2749293898332, -527.2382381008794, -895.0548709709948, -486.38610039894127, -607.6928712830276, -570.6088642609122, -555.5343960014458, -646.4648426714924, -375.041461192686, -382.13390673846334, -269.4417812998679, -852.9895713474598, -443.2176342331323, -785.273874924087, -12.125722601977955, -1102.3827665005624, -1008.3925569896414, -643.5642409432689, -522.4645120435745, -844.7305260134312, -872.0383729650133, -473.0079694179842, -46.52916327987211, -621.8719576670579, -368.86866592010733, -718.3731844113312, -750.4314766341095, -949.3730875379769, -969.7306849234462, -482.8284743192156, -902.0730716427076, -608.3867327734654, -1150.3016017622408, -803.626987312384, -426.19067625123756, -959.3809586648, -110.97912746059947, -928.2866653768097, -33.31083047873709, -351.4248955194983, -857.5064010674264, -653.5275850919694, -724.9463430162763, -1069.5918942144342, -770.2116275146301, -1092.1096702850148, -272.82811981537753, -152.70945068745866, -727.303899560322, -908.8022266397974, -563.5876471622838, -762.5825698708707, -968.3634113112103, -428.551182928117, -780.4819088653713, -1191.066291569416, -911.1487930906563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5679956814612516, "mean_inference_ms": 1.6876385130631788, "mean_action_processing_ms": 0.2841624723604743, "mean_env_wait_ms": 2.9924700973761498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014228582382202148, "StateBufferConnector_ms": 0.008774757385253906, "ViewRequirementAgentConnector_ms": 0.1953144073486328}, "num_episodes": 30, "episode_return_max": -12.125722601977955, "episode_return_min": -1191.066291569416, "episode_return_mean": -659.6068865127023, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 392.6363460543656, "num_env_steps_trained_throughput_per_sec": 392.6363460543656, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12560.338, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12560.268, "sample_time_ms": 1034.776, "learn_time_ms": 11461.881, "learn_throughput": 348.983, "synch_weights_time_ms": 62.832}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00005", "date": "2024-08-03_10-42-58", "timestamp": 1722661978, "time_this_iter_s": 10.199899673461914, "time_total_s": 50.29134654998779, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907baa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.29134654998779, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 15.485714285714286, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.206495251444479, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.181825355688732, "policy_loss": -0.006748859737126622, "vf_loss": 9.199114701151847, "vf_explained_var": 0.3214146100605528, "kl": 0.012353862788828947, "entropy": 1.3011232025921344, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -12.125722601977955, "episode_reward_min": -1316.5321845977803, "episode_reward_mean": -692.539472643067, "episode_len_mean": 138.37, "episode_media": {}, "episodes_timesteps_total": 13837, "policy_reward_min": {"policy_0": -1316.5321845977803}, "policy_reward_max": {"policy_0": -12.125722601977955}, "policy_reward_mean": {"policy_0": -692.539472643067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-970.4506116576142, -329.7763098067474, -1038.5504547771734, -858.9776014198285, -36.10026474545173, -879.0330748696548, -943.6664264438589, -815.5087704126634, -1146.932621441751, -1102.1476182725896, -682.1403540889906, -91.63684638875418, -696.8588691792642, -1165.454837388037, -1114.2749293898332, -527.2382381008794, -895.0548709709948, -486.38610039894127, -607.6928712830276, -570.6088642609122, -555.5343960014458, -646.4648426714924, -375.041461192686, -382.13390673846334, -269.4417812998679, -852.9895713474598, -443.2176342331323, -785.273874924087, -12.125722601977955, -1102.3827665005624, -1008.3925569896414, -643.5642409432689, -522.4645120435745, -844.7305260134312, -872.0383729650133, -473.0079694179842, -46.52916327987211, -621.8719576670579, -368.86866592010733, -718.3731844113312, -750.4314766341095, -949.3730875379769, -969.7306849234462, -482.8284743192156, -902.0730716427076, -608.3867327734654, -1150.3016017622408, -803.626987312384, -426.19067625123756, -959.3809586648, -110.97912746059947, -928.2866653768097, -33.31083047873709, -351.4248955194983, -857.5064010674264, -653.5275850919694, -724.9463430162763, -1069.5918942144342, -770.2116275146301, -1092.1096702850148, -272.82811981537753, -152.70945068745866, -727.303899560322, -908.8022266397974, -563.5876471622838, -762.5825698708707, -968.3634113112103, -428.551182928117, -780.4819088653713, -1191.066291569416, -911.1487930906563, -951.1295643100962, -982.147713569315, -305.81595269484745, -805.0541804690431, -999.3144396648245, -588.1845525007017, -1043.750950300005, -412.4255168281255, -623.9173498859017, -22.41710591899863, -603.2876951437635, -373.3054797584944, -706.6004838266555, -1018.6861033511126, -1316.5321845977803, -890.0016448583063, -905.4384053530854, -687.5512559625683, -606.0516436468837, -799.7644683270153, -505.37680254695704, -628.726180741551, -1130.5973474676302, -725.3665494980377, -640.2310990468951, -883.7083579833331, -307.9416425985475, -998.3194874254785, -27.721170223454298], "episode_lengths": [150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 103, 150, 56, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 150, 58, 150, 57, 150, 150, 150, 150, 150, 150, 150, 87, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 51, 131, 109, 150, 150, 150, 150, 150, 132, 143, 150, 150, 150, 150, 150, 150, 150, 108, 150, 51], "policy_policy_0_reward": [-970.4506116576142, -329.7763098067474, -1038.5504547771734, -858.9776014198285, -36.10026474545173, -879.0330748696548, -943.6664264438589, -815.5087704126634, -1146.932621441751, -1102.1476182725896, -682.1403540889906, -91.63684638875418, -696.8588691792642, -1165.454837388037, -1114.2749293898332, -527.2382381008794, -895.0548709709948, -486.38610039894127, -607.6928712830276, -570.6088642609122, -555.5343960014458, -646.4648426714924, -375.041461192686, -382.13390673846334, -269.4417812998679, -852.9895713474598, -443.2176342331323, -785.273874924087, -12.125722601977955, -1102.3827665005624, -1008.3925569896414, -643.5642409432689, -522.4645120435745, -844.7305260134312, -872.0383729650133, -473.0079694179842, -46.52916327987211, -621.8719576670579, -368.86866592010733, -718.3731844113312, -750.4314766341095, -949.3730875379769, -969.7306849234462, -482.8284743192156, -902.0730716427076, -608.3867327734654, -1150.3016017622408, -803.626987312384, -426.19067625123756, -959.3809586648, -110.97912746059947, -928.2866653768097, -33.31083047873709, -351.4248955194983, -857.5064010674264, -653.5275850919694, -724.9463430162763, -1069.5918942144342, -770.2116275146301, -1092.1096702850148, -272.82811981537753, -152.70945068745866, -727.303899560322, -908.8022266397974, -563.5876471622838, -762.5825698708707, -968.3634113112103, -428.551182928117, -780.4819088653713, -1191.066291569416, -911.1487930906563, -951.1295643100962, -982.147713569315, -305.81595269484745, -805.0541804690431, -999.3144396648245, -588.1845525007017, -1043.750950300005, -412.4255168281255, -623.9173498859017, -22.41710591899863, -603.2876951437635, -373.3054797584944, -706.6004838266555, -1018.6861033511126, -1316.5321845977803, -890.0016448583063, -905.4384053530854, -687.5512559625683, -606.0516436468837, -799.7644683270153, -505.37680254695704, -628.726180741551, -1130.5973474676302, -725.3665494980377, -640.2310990468951, -883.7083579833331, -307.9416425985475, -998.3194874254785, -27.721170223454298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5653723740898616, "mean_inference_ms": 1.690106142959901, "mean_action_processing_ms": 0.28469618813557585, "mean_env_wait_ms": 2.986137811517007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01430368423461914, "StateBufferConnector_ms": 0.008995294570922852, "ViewRequirementAgentConnector_ms": 0.19601702690124512}, "num_episodes": 29, "episode_return_max": -12.125722601977955, "episode_return_min": -1316.5321845977803, "episode_return_mean": -692.539472643067, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 402.9107858167335, "num_env_steps_trained_throughput_per_sec": 402.9107858167335, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12033.825, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12033.755, "sample_time_ms": 1027.037, "learn_time_ms": 10942.952, "learn_throughput": 365.532, "synch_weights_time_ms": 62.972}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00005", "date": "2024-08-03_10-43-08", "timestamp": 1722661988, "time_this_iter_s": 9.941049098968506, "time_total_s": 60.2323956489563, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a8ecf0fd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 60.2323956489563, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 15.414285714285715, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.868828581397732, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.12864798506101, "policy_loss": -0.015738914781832137, "vf_loss": 9.154007183512052, "vf_explained_var": 0.34571498539298773, "kl": 0.019722128366447583, "entropy": 1.3564675593127806, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -12.125722601977955, "episode_reward_min": -1316.5321845977803, "episode_reward_mean": -694.0194148499501, "episode_len_mean": 137.74, "episode_media": {}, "episodes_timesteps_total": 13774, "policy_reward_min": {"policy_0": -1316.5321845977803}, "policy_reward_max": {"policy_0": -12.125722601977955}, "policy_reward_mean": {"policy_0": -694.0194148499501}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-443.2176342331323, -785.273874924087, -12.125722601977955, -1102.3827665005624, -1008.3925569896414, -643.5642409432689, -522.4645120435745, -844.7305260134312, -872.0383729650133, -473.0079694179842, -46.52916327987211, -621.8719576670579, -368.86866592010733, -718.3731844113312, -750.4314766341095, -949.3730875379769, -969.7306849234462, -482.8284743192156, -902.0730716427076, -608.3867327734654, -1150.3016017622408, -803.626987312384, -426.19067625123756, -959.3809586648, -110.97912746059947, -928.2866653768097, -33.31083047873709, -351.4248955194983, -857.5064010674264, -653.5275850919694, -724.9463430162763, -1069.5918942144342, -770.2116275146301, -1092.1096702850148, -272.82811981537753, -152.70945068745866, -727.303899560322, -908.8022266397974, -563.5876471622838, -762.5825698708707, -968.3634113112103, -428.551182928117, -780.4819088653713, -1191.066291569416, -911.1487930906563, -951.1295643100962, -982.147713569315, -305.81595269484745, -805.0541804690431, -999.3144396648245, -588.1845525007017, -1043.750950300005, -412.4255168281255, -623.9173498859017, -22.41710591899863, -603.2876951437635, -373.3054797584944, -706.6004838266555, -1018.6861033511126, -1316.5321845977803, -890.0016448583063, -905.4384053530854, -687.5512559625683, -606.0516436468837, -799.7644683270153, -505.37680254695704, -628.726180741551, -1130.5973474676302, -725.3665494980377, -640.2310990468951, -883.7083579833331, -307.9416425985475, -998.3194874254785, -27.721170223454298, -565.1467630507207, -629.0681884193649, -535.4183381275269, -941.4162591850994, -1003.0733427370947, -748.8556271718722, -210.19908007007828, -1128.332237607556, -1024.104113146768, -898.4480617580241, -577.4226601034806, -1120.8442202452588, -537.0881515899027, -701.2343796977921, -90.9502975700605, -958.3801418066789, -1018.9449047366119, -1000.4348767227065, -421.7426914688344, -900.8130407097716, -224.13321106671754, -656.0396797728032, -583.4272490268714, -308.8129199563815, -700.1132931050976, -703.6469863836242], "episode_lengths": [103, 150, 56, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 150, 58, 150, 57, 150, 150, 150, 150, 150, 150, 150, 87, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 51, 131, 109, 150, 150, 150, 150, 150, 132, 143, 150, 150, 150, 150, 150, 150, 150, 108, 150, 51, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 107, 150, 78, 150, 150, 124, 150, 150], "policy_policy_0_reward": [-443.2176342331323, -785.273874924087, -12.125722601977955, -1102.3827665005624, -1008.3925569896414, -643.5642409432689, -522.4645120435745, -844.7305260134312, -872.0383729650133, -473.0079694179842, -46.52916327987211, -621.8719576670579, -368.86866592010733, -718.3731844113312, -750.4314766341095, -949.3730875379769, -969.7306849234462, -482.8284743192156, -902.0730716427076, -608.3867327734654, -1150.3016017622408, -803.626987312384, -426.19067625123756, -959.3809586648, -110.97912746059947, -928.2866653768097, -33.31083047873709, -351.4248955194983, -857.5064010674264, -653.5275850919694, -724.9463430162763, -1069.5918942144342, -770.2116275146301, -1092.1096702850148, -272.82811981537753, -152.70945068745866, -727.303899560322, -908.8022266397974, -563.5876471622838, -762.5825698708707, -968.3634113112103, -428.551182928117, -780.4819088653713, -1191.066291569416, -911.1487930906563, -951.1295643100962, -982.147713569315, -305.81595269484745, -805.0541804690431, -999.3144396648245, -588.1845525007017, -1043.750950300005, -412.4255168281255, -623.9173498859017, -22.41710591899863, -603.2876951437635, -373.3054797584944, -706.6004838266555, -1018.6861033511126, -1316.5321845977803, -890.0016448583063, -905.4384053530854, -687.5512559625683, -606.0516436468837, -799.7644683270153, -505.37680254695704, -628.726180741551, -1130.5973474676302, -725.3665494980377, -640.2310990468951, -883.7083579833331, -307.9416425985475, -998.3194874254785, -27.721170223454298, -565.1467630507207, -629.0681884193649, -535.4183381275269, -941.4162591850994, -1003.0733427370947, -748.8556271718722, -210.19908007007828, -1128.332237607556, -1024.104113146768, -898.4480617580241, -577.4226601034806, -1120.8442202452588, -537.0881515899027, -701.2343796977921, -90.9502975700605, -958.3801418066789, -1018.9449047366119, -1000.4348767227065, -421.7426914688344, -900.8130407097716, -224.13321106671754, -656.0396797728032, -583.4272490268714, -308.8129199563815, -700.1132931050976, -703.6469863836242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5642209380707779, "mean_inference_ms": 1.697443451262061, "mean_action_processing_ms": 0.2858129211049315, "mean_env_wait_ms": 2.9907266055195962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01447606086730957, "StateBufferConnector_ms": 0.008962631225585938, "ViewRequirementAgentConnector_ms": 0.19478631019592285}, "num_episodes": 26, "episode_return_max": -12.125722601977955, "episode_return_min": -1316.5321845977803, "episode_return_mean": -694.0194148499501, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.5111477442282, "num_env_steps_trained_throughput_per_sec": 296.5111477442282, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12276.56, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12276.489, "sample_time_ms": 1035.297, "learn_time_ms": 11177.479, "learn_throughput": 357.862, "synch_weights_time_ms": 62.912}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00005", "date": "2024-08-03_10-43-21", "timestamp": 1722662001, "time_this_iter_s": 13.50306510925293, "time_total_s": 73.73546075820923, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907bbeb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 73.73546075820923, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.309999999999999, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.325862820446492, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.50290072709322, "policy_loss": -0.012651456580109273, "vf_loss": 8.52558646351099, "vf_explained_var": 0.5108675158272187, "kl": 0.01943484230872249, "entropy": 1.3921249830474456, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -19.14715961110889, "episode_reward_min": -1316.5321845977803, "episode_reward_mean": -701.3637925728727, "episode_len_mean": 138.0, "episode_media": {}, "episodes_timesteps_total": 13800, "policy_reward_min": {"policy_0": -1316.5321845977803}, "policy_reward_max": {"policy_0": -19.14715961110889}, "policy_reward_mean": {"policy_0": -701.3637925728727}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-724.9463430162763, -1069.5918942144342, -770.2116275146301, -1092.1096702850148, -272.82811981537753, -152.70945068745866, -727.303899560322, -908.8022266397974, -563.5876471622838, -762.5825698708707, -968.3634113112103, -428.551182928117, -780.4819088653713, -1191.066291569416, -911.1487930906563, -951.1295643100962, -982.147713569315, -305.81595269484745, -805.0541804690431, -999.3144396648245, -588.1845525007017, -1043.750950300005, -412.4255168281255, -623.9173498859017, -22.41710591899863, -603.2876951437635, -373.3054797584944, -706.6004838266555, -1018.6861033511126, -1316.5321845977803, -890.0016448583063, -905.4384053530854, -687.5512559625683, -606.0516436468837, -799.7644683270153, -505.37680254695704, -628.726180741551, -1130.5973474676302, -725.3665494980377, -640.2310990468951, -883.7083579833331, -307.9416425985475, -998.3194874254785, -27.721170223454298, -565.1467630507207, -629.0681884193649, -535.4183381275269, -941.4162591850994, -1003.0733427370947, -748.8556271718722, -210.19908007007828, -1128.332237607556, -1024.104113146768, -898.4480617580241, -577.4226601034806, -1120.8442202452588, -537.0881515899027, -701.2343796977921, -90.9502975700605, -958.3801418066789, -1018.9449047366119, -1000.4348767227065, -421.7426914688344, -900.8130407097716, -224.13321106671754, -656.0396797728032, -583.4272490268714, -308.8129199563815, -700.1132931050976, -703.6469863836242, -826.1923765833282, -913.3143672586298, -213.90792933847194, -708.1642257710761, -608.286956006009, -1111.7289267589747, -545.7351639153216, -960.8976466424946, -117.10012866464666, -963.4559515482617, -944.3291205859864, -523.0918659490184, -575.064317614259, -873.8781343120194, -956.8010203517664, -513.9136958254273, -832.2756756020686, -381.10867849674804, -1051.480324616101, -759.8425577705514, -19.14715961110889, -884.5671064430335, -587.8893383609162, -805.0335665474097, -860.6080225402607, -983.4546195726355, -855.3920162208514, -484.20241462777466, -58.50289162151179, -215.27197786327955], "episode_lengths": [150, 150, 150, 150, 87, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 51, 131, 109, 150, 150, 150, 150, 150, 132, 143, 150, 150, 150, 150, 150, 150, 150, 108, 150, 51, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 107, 150, 78, 150, 150, 124, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 49, 66], "policy_policy_0_reward": [-724.9463430162763, -1069.5918942144342, -770.2116275146301, -1092.1096702850148, -272.82811981537753, -152.70945068745866, -727.303899560322, -908.8022266397974, -563.5876471622838, -762.5825698708707, -968.3634113112103, -428.551182928117, -780.4819088653713, -1191.066291569416, -911.1487930906563, -951.1295643100962, -982.147713569315, -305.81595269484745, -805.0541804690431, -999.3144396648245, -588.1845525007017, -1043.750950300005, -412.4255168281255, -623.9173498859017, -22.41710591899863, -603.2876951437635, -373.3054797584944, -706.6004838266555, -1018.6861033511126, -1316.5321845977803, -890.0016448583063, -905.4384053530854, -687.5512559625683, -606.0516436468837, -799.7644683270153, -505.37680254695704, -628.726180741551, -1130.5973474676302, -725.3665494980377, -640.2310990468951, -883.7083579833331, -307.9416425985475, -998.3194874254785, -27.721170223454298, -565.1467630507207, -629.0681884193649, -535.4183381275269, -941.4162591850994, -1003.0733427370947, -748.8556271718722, -210.19908007007828, -1128.332237607556, -1024.104113146768, -898.4480617580241, -577.4226601034806, -1120.8442202452588, -537.0881515899027, -701.2343796977921, -90.9502975700605, -958.3801418066789, -1018.9449047366119, -1000.4348767227065, -421.7426914688344, -900.8130407097716, -224.13321106671754, -656.0396797728032, -583.4272490268714, -308.8129199563815, -700.1132931050976, -703.6469863836242, -826.1923765833282, -913.3143672586298, -213.90792933847194, -708.1642257710761, -608.286956006009, -1111.7289267589747, -545.7351639153216, -960.8976466424946, -117.10012866464666, -963.4559515482617, -944.3291205859864, -523.0918659490184, -575.064317614259, -873.8781343120194, -956.8010203517664, -513.9136958254273, -832.2756756020686, -381.10867849674804, -1051.480324616101, -759.8425577705514, -19.14715961110889, -884.5671064430335, -587.8893383609162, -805.0335665474097, -860.6080225402607, -983.4546195726355, -855.3920162208514, -484.20241462777466, -58.50289162151179, -215.27197786327955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5632597121501196, "mean_inference_ms": 1.7008819616002482, "mean_action_processing_ms": 0.2861487889075976, "mean_env_wait_ms": 2.9912951042274263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014111518859863281, "StateBufferConnector_ms": 0.008789539337158203, "ViewRequirementAgentConnector_ms": 0.19851446151733398}, "num_episodes": 30, "episode_return_max": -19.14715961110889, "episode_return_min": -1316.5321845977803, "episode_return_mean": -701.3637925728727, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.7016830327426, "num_env_steps_trained_throughput_per_sec": 299.7016830327426, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12429.426, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12429.355, "sample_time_ms": 1032.537, "learn_time_ms": 11333.13, "learn_throughput": 352.948, "synch_weights_time_ms": 62.879}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00005", "date": "2024-08-03_10-43-35", "timestamp": 1722662015, "time_this_iter_s": 13.359390497207642, "time_total_s": 87.09485125541687, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907bab00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 87.09485125541687, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.415789473684208, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.154455344006418, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.346858816345533, "policy_loss": -0.007421270052630765, "vf_loss": 8.36523873458306, "vf_explained_var": 0.6466150602325798, "kl": 0.014022414172480542, "entropy": 1.3763086304068566, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -19.14715961110889, "episode_reward_min": -1202.3082464702018, "episode_reward_mean": -667.4122368799889, "episode_len_mean": 136.75, "episode_media": {}, "episodes_timesteps_total": 13675, "policy_reward_min": {"policy_0": -1202.3082464702018}, "policy_reward_max": {"policy_0": -19.14715961110889}, "policy_reward_mean": {"policy_0": -667.4122368799889}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-905.4384053530854, -687.5512559625683, -606.0516436468837, -799.7644683270153, -505.37680254695704, -628.726180741551, -1130.5973474676302, -725.3665494980377, -640.2310990468951, -883.7083579833331, -307.9416425985475, -998.3194874254785, -27.721170223454298, -565.1467630507207, -629.0681884193649, -535.4183381275269, -941.4162591850994, -1003.0733427370947, -748.8556271718722, -210.19908007007828, -1128.332237607556, -1024.104113146768, -898.4480617580241, -577.4226601034806, -1120.8442202452588, -537.0881515899027, -701.2343796977921, -90.9502975700605, -958.3801418066789, -1018.9449047366119, -1000.4348767227065, -421.7426914688344, -900.8130407097716, -224.13321106671754, -656.0396797728032, -583.4272490268714, -308.8129199563815, -700.1132931050976, -703.6469863836242, -826.1923765833282, -913.3143672586298, -213.90792933847194, -708.1642257710761, -608.286956006009, -1111.7289267589747, -545.7351639153216, -960.8976466424946, -117.10012866464666, -963.4559515482617, -944.3291205859864, -523.0918659490184, -575.064317614259, -873.8781343120194, -956.8010203517664, -513.9136958254273, -832.2756756020686, -381.10867849674804, -1051.480324616101, -759.8425577705514, -19.14715961110889, -884.5671064430335, -587.8893383609162, -805.0335665474097, -860.6080225402607, -983.4546195726355, -855.3920162208514, -484.20241462777466, -58.50289162151179, -215.27197786327955, -771.9736881364776, -272.66556126521397, -700.3869132409739, -488.9410017254954, -975.992940575543, -1081.159823103464, -384.5007451943936, -750.0954661932649, -837.2597323755365, -748.0339903317604, -930.6468387085242, -651.9670801885298, -367.3198294434023, -901.2294750569476, -833.6490281995644, -186.50796227555492, -1202.3082464702018, -336.3219853190015, -733.2793352892102, -30.847843072204647, -1020.4742166756174, -234.34315426507507, -716.7679466696032, -880.9478072783202, -355.8465849514965, -451.4819913490241, -63.626935126672635, -993.2873410757387, -639.8725494205466, -154.14720348824702, -875.8171684552202], "episode_lengths": [150, 132, 143, 150, 150, 150, 150, 150, 150, 150, 108, 150, 51, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 107, 150, 78, 150, 150, 124, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 49, 66, 150, 99, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 93, 150, 150, 150, 64, 150, 111, 150, 150, 129, 150, 61, 150, 150, 89, 150], "policy_policy_0_reward": [-905.4384053530854, -687.5512559625683, -606.0516436468837, -799.7644683270153, -505.37680254695704, -628.726180741551, -1130.5973474676302, -725.3665494980377, -640.2310990468951, -883.7083579833331, -307.9416425985475, -998.3194874254785, -27.721170223454298, -565.1467630507207, -629.0681884193649, -535.4183381275269, -941.4162591850994, -1003.0733427370947, -748.8556271718722, -210.19908007007828, -1128.332237607556, -1024.104113146768, -898.4480617580241, -577.4226601034806, -1120.8442202452588, -537.0881515899027, -701.2343796977921, -90.9502975700605, -958.3801418066789, -1018.9449047366119, -1000.4348767227065, -421.7426914688344, -900.8130407097716, -224.13321106671754, -656.0396797728032, -583.4272490268714, -308.8129199563815, -700.1132931050976, -703.6469863836242, -826.1923765833282, -913.3143672586298, -213.90792933847194, -708.1642257710761, -608.286956006009, -1111.7289267589747, -545.7351639153216, -960.8976466424946, -117.10012866464666, -963.4559515482617, -944.3291205859864, -523.0918659490184, -575.064317614259, -873.8781343120194, -956.8010203517664, -513.9136958254273, -832.2756756020686, -381.10867849674804, -1051.480324616101, -759.8425577705514, -19.14715961110889, -884.5671064430335, -587.8893383609162, -805.0335665474097, -860.6080225402607, -983.4546195726355, -855.3920162208514, -484.20241462777466, -58.50289162151179, -215.27197786327955, -771.9736881364776, -272.66556126521397, -700.3869132409739, -488.9410017254954, -975.992940575543, -1081.159823103464, -384.5007451943936, -750.0954661932649, -837.2597323755365, -748.0339903317604, -930.6468387085242, -651.9670801885298, -367.3198294434023, -901.2294750569476, -833.6490281995644, -186.50796227555492, -1202.3082464702018, -336.3219853190015, -733.2793352892102, -30.847843072204647, -1020.4742166756174, -234.34315426507507, -716.7679466696032, -880.9478072783202, -355.8465849514965, -451.4819913490241, -63.626935126672635, -993.2873410757387, -639.8725494205466, -154.14720348824702, -875.8171684552202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5639795439381876, "mean_inference_ms": 1.7069723698652612, "mean_action_processing_ms": 0.28661727836667583, "mean_env_wait_ms": 2.995308965625402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01355600357055664, "StateBufferConnector_ms": 0.008446455001831055, "ViewRequirementAgentConnector_ms": 0.1990966796875}, "num_episodes": 31, "episode_return_max": -19.14715961110889, "episode_return_min": -1202.3082464702018, "episode_return_mean": -667.4122368799889, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.2860790167419, "num_env_steps_trained_throughput_per_sec": 295.2860790167419, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12569.023, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12568.95, "sample_time_ms": 1033.106, "learn_time_ms": 11471.705, "learn_throughput": 348.684, "synch_weights_time_ms": 63.327}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00005", "date": "2024-08-03_10-43-48", "timestamp": 1722662028, "time_this_iter_s": 13.55765986442566, "time_total_s": 100.65251111984253, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907bb9a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 100.65251111984253, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.478947368421053, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.95508135780692, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.363573560118676, "policy_loss": -0.012047298460189874, "vf_loss": 8.385976266860961, "vf_explained_var": 0.7060557942216595, "kl": 0.018994910018075947, "entropy": 1.4154370958606401, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -19.07582715980693, "episode_reward_min": -1259.1071967700975, "episode_reward_mean": -660.5325232346927, "episode_len_mean": 135.23, "episode_media": {}, "episodes_timesteps_total": 13523, "policy_reward_min": {"policy_0": -1259.1071967700975}, "policy_reward_max": {"policy_0": -19.07582715980693}, "policy_reward_mean": {"policy_0": -660.5325232346927}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1018.9449047366119, -1000.4348767227065, -421.7426914688344, -900.8130407097716, -224.13321106671754, -656.0396797728032, -583.4272490268714, -308.8129199563815, -700.1132931050976, -703.6469863836242, -826.1923765833282, -913.3143672586298, -213.90792933847194, -708.1642257710761, -608.286956006009, -1111.7289267589747, -545.7351639153216, -960.8976466424946, -117.10012866464666, -963.4559515482617, -944.3291205859864, -523.0918659490184, -575.064317614259, -873.8781343120194, -956.8010203517664, -513.9136958254273, -832.2756756020686, -381.10867849674804, -1051.480324616101, -759.8425577705514, -19.14715961110889, -884.5671064430335, -587.8893383609162, -805.0335665474097, -860.6080225402607, -983.4546195726355, -855.3920162208514, -484.20241462777466, -58.50289162151179, -215.27197786327955, -771.9736881364776, -272.66556126521397, -700.3869132409739, -488.9410017254954, -975.992940575543, -1081.159823103464, -384.5007451943936, -750.0954661932649, -837.2597323755365, -748.0339903317604, -930.6468387085242, -651.9670801885298, -367.3198294434023, -901.2294750569476, -833.6490281995644, -186.50796227555492, -1202.3082464702018, -336.3219853190015, -733.2793352892102, -30.847843072204647, -1020.4742166756174, -234.34315426507507, -716.7679466696032, -880.9478072783202, -355.8465849514965, -451.4819913490241, -63.626935126672635, -993.2873410757387, -639.8725494205466, -154.14720348824702, -875.8171684552202, -703.4911832350579, -146.75122336241515, -414.3750748815541, -850.110481537704, -554.9256224088105, -19.07582715980693, -916.8711408207819, -427.14449466030624, -665.4375226086936, -1211.2695344573622, -392.81563713957564, -1057.4866346551416, -1064.7356800056111, -738.5341857271351, -655.9477869353497, -87.2357375303106, -31.33019648286459, -843.3402339380581, -823.8080631032891, -419.2209151320438, -1103.189832654817, -643.9376097348156, -1078.8048704479097, -1008.172706847845, -250.2017991828815, -1213.5894075918466, -1259.1071967700975, -511.7424647424027, -736.1518448245852], "episode_lengths": [150, 150, 107, 150, 78, 150, 150, 124, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 49, 66, 150, 99, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 93, 150, 150, 150, 64, 150, 111, 150, 150, 129, 150, 61, 150, 150, 89, 150, 150, 110, 124, 150, 150, 50, 150, 116, 150, 150, 150, 150, 150, 150, 150, 76, 63, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 122, 150], "policy_policy_0_reward": [-1018.9449047366119, -1000.4348767227065, -421.7426914688344, -900.8130407097716, -224.13321106671754, -656.0396797728032, -583.4272490268714, -308.8129199563815, -700.1132931050976, -703.6469863836242, -826.1923765833282, -913.3143672586298, -213.90792933847194, -708.1642257710761, -608.286956006009, -1111.7289267589747, -545.7351639153216, -960.8976466424946, -117.10012866464666, -963.4559515482617, -944.3291205859864, -523.0918659490184, -575.064317614259, -873.8781343120194, -956.8010203517664, -513.9136958254273, -832.2756756020686, -381.10867849674804, -1051.480324616101, -759.8425577705514, -19.14715961110889, -884.5671064430335, -587.8893383609162, -805.0335665474097, -860.6080225402607, -983.4546195726355, -855.3920162208514, -484.20241462777466, -58.50289162151179, -215.27197786327955, -771.9736881364776, -272.66556126521397, -700.3869132409739, -488.9410017254954, -975.992940575543, -1081.159823103464, -384.5007451943936, -750.0954661932649, -837.2597323755365, -748.0339903317604, -930.6468387085242, -651.9670801885298, -367.3198294434023, -901.2294750569476, -833.6490281995644, -186.50796227555492, -1202.3082464702018, -336.3219853190015, -733.2793352892102, -30.847843072204647, -1020.4742166756174, -234.34315426507507, -716.7679466696032, -880.9478072783202, -355.8465849514965, -451.4819913490241, -63.626935126672635, -993.2873410757387, -639.8725494205466, -154.14720348824702, -875.8171684552202, -703.4911832350579, -146.75122336241515, -414.3750748815541, -850.110481537704, -554.9256224088105, -19.07582715980693, -916.8711408207819, -427.14449466030624, -665.4375226086936, -1211.2695344573622, -392.81563713957564, -1057.4866346551416, -1064.7356800056111, -738.5341857271351, -655.9477869353497, -87.2357375303106, -31.33019648286459, -843.3402339380581, -823.8080631032891, -419.2209151320438, -1103.189832654817, -643.9376097348156, -1078.8048704479097, -1008.172706847845, -250.2017991828815, -1213.5894075918466, -1259.1071967700975, -511.7424647424027, -736.1518448245852]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5641320421029481, "mean_inference_ms": 1.709615756490628, "mean_action_processing_ms": 0.2863017190919569, "mean_env_wait_ms": 2.999351553896882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013065099716186523, "StateBufferConnector_ms": 0.008279561996459961, "ViewRequirementAgentConnector_ms": 0.20021367073059082}, "num_episodes": 29, "episode_return_max": -19.07582715980693, "episode_return_min": -1259.1071967700975, "episode_return_mean": -660.5325232346927, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.5241453978848, "num_env_steps_trained_throughput_per_sec": 292.5241453978848, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12691.809, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12691.736, "sample_time_ms": 1030.388, "learn_time_ms": 11596.668, "learn_throughput": 344.927, "synch_weights_time_ms": 63.855}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00005", "date": "2024-08-03_10-44-02", "timestamp": 1722662042, "time_this_iter_s": 13.686794519424438, "time_total_s": 114.33930563926697, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00be200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.33930563926697, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.37894736842105, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.901300059258936, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.68835326731205, "policy_loss": -0.017603122948397262, "vf_loss": 7.714917369683584, "vf_explained_var": 0.7814962776998678, "kl": 0.02459319394511113, "entropy": 1.3879612163951, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -19.07582715980693, "episode_reward_min": -1259.1071967700975, "episode_reward_mean": -662.5070278664616, "episode_len_mean": 135.41, "episode_media": {}, "episodes_timesteps_total": 13541, "policy_reward_min": {"policy_0": -1259.1071967700975}, "policy_reward_max": {"policy_0": -19.07582715980693}, "policy_reward_mean": {"policy_0": -662.5070278664616}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1051.480324616101, -759.8425577705514, -19.14715961110889, -884.5671064430335, -587.8893383609162, -805.0335665474097, -860.6080225402607, -983.4546195726355, -855.3920162208514, -484.20241462777466, -58.50289162151179, -215.27197786327955, -771.9736881364776, -272.66556126521397, -700.3869132409739, -488.9410017254954, -975.992940575543, -1081.159823103464, -384.5007451943936, -750.0954661932649, -837.2597323755365, -748.0339903317604, -930.6468387085242, -651.9670801885298, -367.3198294434023, -901.2294750569476, -833.6490281995644, -186.50796227555492, -1202.3082464702018, -336.3219853190015, -733.2793352892102, -30.847843072204647, -1020.4742166756174, -234.34315426507507, -716.7679466696032, -880.9478072783202, -355.8465849514965, -451.4819913490241, -63.626935126672635, -993.2873410757387, -639.8725494205466, -154.14720348824702, -875.8171684552202, -703.4911832350579, -146.75122336241515, -414.3750748815541, -850.110481537704, -554.9256224088105, -19.07582715980693, -916.8711408207819, -427.14449466030624, -665.4375226086936, -1211.2695344573622, -392.81563713957564, -1057.4866346551416, -1064.7356800056111, -738.5341857271351, -655.9477869353497, -87.2357375303106, -31.33019648286459, -843.3402339380581, -823.8080631032891, -419.2209151320438, -1103.189832654817, -643.9376097348156, -1078.8048704479097, -1008.172706847845, -250.2017991828815, -1213.5894075918466, -1259.1071967700975, -511.7424647424027, -736.1518448245852, -890.2268098648883, -975.962371038476, -214.1999211259842, -703.9542111138818, -979.3127502903365, -406.7237449236104, -302.9648454710926, -412.24922845401846, -768.5370692166691, -681.9835099569048, -1048.94211711592, -821.7605022730716, -950.4187456062119, -748.1804755472859, -761.1671311935917, -754.3931061035327, -668.1848892486222, -129.29631575123562, -731.574815161715, -367.9686810910964, -857.4242538737652, -970.4215011076185, -638.570670352627, -737.8883082239626, -653.997775016813, -1104.6904186687168, -247.7607394953305, -756.0505900638354], "episode_lengths": [150, 150, 47, 150, 150, 150, 150, 150, 150, 150, 49, 66, 150, 99, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 93, 150, 150, 150, 64, 150, 111, 150, 150, 129, 150, 61, 150, 150, 89, 150, 150, 110, 124, 150, 150, 50, 150, 116, 150, 150, 150, 150, 150, 150, 150, 76, 63, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 122, 150, 150, 150, 78, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 116, 150, 150, 150, 150, 150, 150, 98, 150], "policy_policy_0_reward": [-1051.480324616101, -759.8425577705514, -19.14715961110889, -884.5671064430335, -587.8893383609162, -805.0335665474097, -860.6080225402607, -983.4546195726355, -855.3920162208514, -484.20241462777466, -58.50289162151179, -215.27197786327955, -771.9736881364776, -272.66556126521397, -700.3869132409739, -488.9410017254954, -975.992940575543, -1081.159823103464, -384.5007451943936, -750.0954661932649, -837.2597323755365, -748.0339903317604, -930.6468387085242, -651.9670801885298, -367.3198294434023, -901.2294750569476, -833.6490281995644, -186.50796227555492, -1202.3082464702018, -336.3219853190015, -733.2793352892102, -30.847843072204647, -1020.4742166756174, -234.34315426507507, -716.7679466696032, -880.9478072783202, -355.8465849514965, -451.4819913490241, -63.626935126672635, -993.2873410757387, -639.8725494205466, -154.14720348824702, -875.8171684552202, -703.4911832350579, -146.75122336241515, -414.3750748815541, -850.110481537704, -554.9256224088105, -19.07582715980693, -916.8711408207819, -427.14449466030624, -665.4375226086936, -1211.2695344573622, -392.81563713957564, -1057.4866346551416, -1064.7356800056111, -738.5341857271351, -655.9477869353497, -87.2357375303106, -31.33019648286459, -843.3402339380581, -823.8080631032891, -419.2209151320438, -1103.189832654817, -643.9376097348156, -1078.8048704479097, -1008.172706847845, -250.2017991828815, -1213.5894075918466, -1259.1071967700975, -511.7424647424027, -736.1518448245852, -890.2268098648883, -975.962371038476, -214.1999211259842, -703.9542111138818, -979.3127502903365, -406.7237449236104, -302.9648454710926, -412.24922845401846, -768.5370692166691, -681.9835099569048, -1048.94211711592, -821.7605022730716, -950.4187456062119, -748.1804755472859, -761.1671311935917, -754.3931061035327, -668.1848892486222, -129.29631575123562, -731.574815161715, -367.9686810910964, -857.4242538737652, -970.4215011076185, -638.570670352627, -737.8883082239626, -653.997775016813, -1104.6904186687168, -247.7607394953305, -756.0505900638354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5627482389691028, "mean_inference_ms": 1.7080971324656822, "mean_action_processing_ms": 0.2858764025702285, "mean_env_wait_ms": 3.0002664233900656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012438774108886719, "StateBufferConnector_ms": 0.008069515228271484, "ViewRequirementAgentConnector_ms": 0.19689702987670898}, "num_episodes": 28, "episode_return_max": -19.07582715980693, "episode_return_min": -1259.1071967700975, "episode_return_mean": -662.5070278664616, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.2870324236924, "num_env_steps_trained_throughput_per_sec": 309.2870324236924, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12715.927, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12715.854, "sample_time_ms": 1027.45, "learn_time_ms": 11622.894, "learn_throughput": 344.148, "synch_weights_time_ms": 64.681}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00005", "date": "2024-08-03_10-44-15", "timestamp": 1722662055, "time_this_iter_s": 12.945087194442749, "time_total_s": 127.28439283370972, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c521240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 127.28439283370972, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.26842105263158, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.289325229575237, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.025303636988005, "policy_loss": -0.011669183033518493, "vf_loss": 8.047573214272658, "vf_explained_var": 0.7366645039990545, "kl": 0.017134585994760223, "entropy": 1.5740772827217977, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -19.07582715980693, "episode_reward_min": -1266.2766667757544, "episode_reward_mean": -690.6403507121483, "episode_len_mean": 138.85, "episode_media": {}, "episodes_timesteps_total": 13885, "policy_reward_min": {"policy_0": -1266.2766667757544}, "policy_reward_max": {"policy_0": -19.07582715980693}, "policy_reward_mean": {"policy_0": -690.6403507121483}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-733.2793352892102, -30.847843072204647, -1020.4742166756174, -234.34315426507507, -716.7679466696032, -880.9478072783202, -355.8465849514965, -451.4819913490241, -63.626935126672635, -993.2873410757387, -639.8725494205466, -154.14720348824702, -875.8171684552202, -703.4911832350579, -146.75122336241515, -414.3750748815541, -850.110481537704, -554.9256224088105, -19.07582715980693, -916.8711408207819, -427.14449466030624, -665.4375226086936, -1211.2695344573622, -392.81563713957564, -1057.4866346551416, -1064.7356800056111, -738.5341857271351, -655.9477869353497, -87.2357375303106, -31.33019648286459, -843.3402339380581, -823.8080631032891, -419.2209151320438, -1103.189832654817, -643.9376097348156, -1078.8048704479097, -1008.172706847845, -250.2017991828815, -1213.5894075918466, -1259.1071967700975, -511.7424647424027, -736.1518448245852, -890.2268098648883, -975.962371038476, -214.1999211259842, -703.9542111138818, -979.3127502903365, -406.7237449236104, -302.9648454710926, -412.24922845401846, -768.5370692166691, -681.9835099569048, -1048.94211711592, -821.7605022730716, -950.4187456062119, -748.1804755472859, -761.1671311935917, -754.3931061035327, -668.1848892486222, -129.29631575123562, -731.574815161715, -367.9686810910964, -857.4242538737652, -970.4215011076185, -638.570670352627, -737.8883082239626, -653.997775016813, -1104.6904186687168, -247.7607394953305, -756.0505900638354, -1033.8611839483433, -265.257368123898, -408.4479378645471, -1242.7097287615259, -924.3860582205756, -809.9386138274418, -102.09509255967673, -664.0283814270273, -1266.2766667757544, -962.465967711577, -657.7353270633324, -657.9498780252469, -926.5976285572211, -648.8497288618016, -450.2629663300514, -830.7881348032199, -781.973655887951, -641.1188004648105, -770.6001053458656, -811.477041571988, -1264.6298004485268, -995.5104818440906, -908.0979999960526, -597.2229227348371, -927.4901096596304, -268.06680258980424, -979.2951179496424, -475.7668425066837, -900.6090213391653, -626.1752229676919], "episode_lengths": [150, 64, 150, 111, 150, 150, 129, 150, 61, 150, 150, 89, 150, 150, 110, 124, 150, 150, 50, 150, 116, 150, 150, 150, 150, 150, 150, 150, 76, 63, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 122, 150, 150, 150, 78, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 116, 150, 150, 150, 150, 150, 150, 98, 150, 150, 125, 115, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150], "policy_policy_0_reward": [-733.2793352892102, -30.847843072204647, -1020.4742166756174, -234.34315426507507, -716.7679466696032, -880.9478072783202, -355.8465849514965, -451.4819913490241, -63.626935126672635, -993.2873410757387, -639.8725494205466, -154.14720348824702, -875.8171684552202, -703.4911832350579, -146.75122336241515, -414.3750748815541, -850.110481537704, -554.9256224088105, -19.07582715980693, -916.8711408207819, -427.14449466030624, -665.4375226086936, -1211.2695344573622, -392.81563713957564, -1057.4866346551416, -1064.7356800056111, -738.5341857271351, -655.9477869353497, -87.2357375303106, -31.33019648286459, -843.3402339380581, -823.8080631032891, -419.2209151320438, -1103.189832654817, -643.9376097348156, -1078.8048704479097, -1008.172706847845, -250.2017991828815, -1213.5894075918466, -1259.1071967700975, -511.7424647424027, -736.1518448245852, -890.2268098648883, -975.962371038476, -214.1999211259842, -703.9542111138818, -979.3127502903365, -406.7237449236104, -302.9648454710926, -412.24922845401846, -768.5370692166691, -681.9835099569048, -1048.94211711592, -821.7605022730716, -950.4187456062119, -748.1804755472859, -761.1671311935917, -754.3931061035327, -668.1848892486222, -129.29631575123562, -731.574815161715, -367.9686810910964, -857.4242538737652, -970.4215011076185, -638.570670352627, -737.8883082239626, -653.997775016813, -1104.6904186687168, -247.7607394953305, -756.0505900638354, -1033.8611839483433, -265.257368123898, -408.4479378645471, -1242.7097287615259, -924.3860582205756, -809.9386138274418, -102.09509255967673, -664.0283814270273, -1266.2766667757544, -962.465967711577, -657.7353270633324, -657.9498780252469, -926.5976285572211, -648.8497288618016, -450.2629663300514, -830.7881348032199, -781.973655887951, -641.1188004648105, -770.6001053458656, -811.477041571988, -1264.6298004485268, -995.5104818440906, -908.0979999960526, -597.2229227348371, -927.4901096596304, -268.06680258980424, -979.2951179496424, -475.7668425066837, -900.6090213391653, -626.1752229676919]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5613030386898167, "mean_inference_ms": 1.7070051365050523, "mean_action_processing_ms": 0.28550569609946946, "mean_env_wait_ms": 3.001955380472477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012427806854248047, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.1946866512298584}, "num_episodes": 30, "episode_return_max": -19.07582715980693, "episode_return_min": -1266.2766667757544, "episode_return_mean": -690.6403507121483, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.39999414619456, "num_env_steps_trained_throughput_per_sec": 316.39999414619456, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12635.411, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12635.335, "sample_time_ms": 1022.19, "learn_time_ms": 11547.182, "learn_throughput": 346.405, "synch_weights_time_ms": 65.118}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00005", "date": "2024-08-03_10-44-28", "timestamp": 1722662068, "time_this_iter_s": 12.654612302780151, "time_total_s": 139.93900513648987, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c521510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 139.93900513648987, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 13.905555555555557, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.389608119924866, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.895070661604405, "policy_loss": -0.019092458849869823, "vf_loss": 6.922890284160773, "vf_explained_var": 0.8498332538331549, "kl": 0.021328360234868646, "entropy": 1.5125653203576803, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -62.00571038824984, "episode_reward_min": -1266.2766667757544, "episode_reward_mean": -719.5677686229267, "episode_len_mean": 143.79, "episode_media": {}, "episodes_timesteps_total": 14379, "policy_reward_min": {"policy_0": -1266.2766667757544}, "policy_reward_max": {"policy_0": -62.00571038824984}, "policy_reward_mean": {"policy_0": -719.5677686229267}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-843.3402339380581, -823.8080631032891, -419.2209151320438, -1103.189832654817, -643.9376097348156, -1078.8048704479097, -1008.172706847845, -250.2017991828815, -1213.5894075918466, -1259.1071967700975, -511.7424647424027, -736.1518448245852, -890.2268098648883, -975.962371038476, -214.1999211259842, -703.9542111138818, -979.3127502903365, -406.7237449236104, -302.9648454710926, -412.24922845401846, -768.5370692166691, -681.9835099569048, -1048.94211711592, -821.7605022730716, -950.4187456062119, -748.1804755472859, -761.1671311935917, -754.3931061035327, -668.1848892486222, -129.29631575123562, -731.574815161715, -367.9686810910964, -857.4242538737652, -970.4215011076185, -638.570670352627, -737.8883082239626, -653.997775016813, -1104.6904186687168, -247.7607394953305, -756.0505900638354, -1033.8611839483433, -265.257368123898, -408.4479378645471, -1242.7097287615259, -924.3860582205756, -809.9386138274418, -102.09509255967673, -664.0283814270273, -1266.2766667757544, -962.465967711577, -657.7353270633324, -657.9498780252469, -926.5976285572211, -648.8497288618016, -450.2629663300514, -830.7881348032199, -781.973655887951, -641.1188004648105, -770.6001053458656, -811.477041571988, -1264.6298004485268, -995.5104818440906, -908.0979999960526, -597.2229227348371, -927.4901096596304, -268.06680258980424, -979.2951179496424, -475.7668425066837, -900.6090213391653, -626.1752229676919, -194.18702909601575, -409.47893989781596, -1133.9944242854224, -357.253397795474, -1004.4776515563642, -1099.087142478822, -707.1525469074936, -173.45158275113917, -799.2871773604987, -955.7760494726954, -501.4790511879801, -576.5182390126678, -62.00571038824984, -388.8298543462863, -771.5039894214556, -986.7411594132495, -803.891617906767, -1072.4923227806548, -752.4540720079863, -700.5375926320331, -327.5598591336756, -1171.035638018239, -358.3315407588754, -549.3979112955668, -543.6374623292438, -716.978834722125, -737.9907486266217, -909.7306722440121, -526.0846568828532, -689.6729570930057], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 122, 150, 150, 150, 78, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 116, 150, 150, 150, 150, 150, 150, 98, 150, 150, 125, 115, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-843.3402339380581, -823.8080631032891, -419.2209151320438, -1103.189832654817, -643.9376097348156, -1078.8048704479097, -1008.172706847845, -250.2017991828815, -1213.5894075918466, -1259.1071967700975, -511.7424647424027, -736.1518448245852, -890.2268098648883, -975.962371038476, -214.1999211259842, -703.9542111138818, -979.3127502903365, -406.7237449236104, -302.9648454710926, -412.24922845401846, -768.5370692166691, -681.9835099569048, -1048.94211711592, -821.7605022730716, -950.4187456062119, -748.1804755472859, -761.1671311935917, -754.3931061035327, -668.1848892486222, -129.29631575123562, -731.574815161715, -367.9686810910964, -857.4242538737652, -970.4215011076185, -638.570670352627, -737.8883082239626, -653.997775016813, -1104.6904186687168, -247.7607394953305, -756.0505900638354, -1033.8611839483433, -265.257368123898, -408.4479378645471, -1242.7097287615259, -924.3860582205756, -809.9386138274418, -102.09509255967673, -664.0283814270273, -1266.2766667757544, -962.465967711577, -657.7353270633324, -657.9498780252469, -926.5976285572211, -648.8497288618016, -450.2629663300514, -830.7881348032199, -781.973655887951, -641.1188004648105, -770.6001053458656, -811.477041571988, -1264.6298004485268, -995.5104818440906, -908.0979999960526, -597.2229227348371, -927.4901096596304, -268.06680258980424, -979.2951179496424, -475.7668425066837, -900.6090213391653, -626.1752229676919, -194.18702909601575, -409.47893989781596, -1133.9944242854224, -357.253397795474, -1004.4776515563642, -1099.087142478822, -707.1525469074936, -173.45158275113917, -799.2871773604987, -955.7760494726954, -501.4790511879801, -576.5182390126678, -62.00571038824984, -388.8298543462863, -771.5039894214556, -986.7411594132495, -803.891617906767, -1072.4923227806548, -752.4540720079863, -700.5375926320331, -327.5598591336756, -1171.035638018239, -358.3315407588754, -549.3979112955668, -543.6374623292438, -716.978834722125, -737.9907486266217, -909.7306722440121, -526.0846568828532, -689.6729570930057]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.560076312573075, "mean_inference_ms": 1.704634578970639, "mean_action_processing_ms": 0.28491566628033665, "mean_env_wait_ms": 3.003699496614276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012281417846679688, "StateBufferConnector_ms": 0.007992029190063477, "ViewRequirementAgentConnector_ms": 0.19443321228027344}, "num_episodes": 30, "episode_return_max": -62.00571038824984, "episode_return_min": -1266.2766667757544, "episode_return_mean": -719.5677686229267, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.3770097261077, "num_env_steps_trained_throughput_per_sec": 297.3770097261077, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12648.925, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12648.85, "sample_time_ms": 1024.345, "learn_time_ms": 11558.684, "learn_throughput": 346.06, "synch_weights_time_ms": 64.976}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00005", "date": "2024-08-03_10-44-41", "timestamp": 1722662081, "time_this_iter_s": 13.463765621185303, "time_total_s": 153.40277075767517, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00be200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 153.40277075767517, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.305263157894737, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.139544659356275, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.490847218533357, "policy_loss": -0.007958878319671688, "vf_loss": 7.510016407072544, "vf_explained_var": 0.8049946014458934, "kl": 0.013124212242595011, "entropy": 1.7116210764894884, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -33.38761724678898, "episode_reward_min": -1388.5623854182456, "episode_reward_mean": -700.7234370750436, "episode_len_mean": 141.66, "episode_media": {}, "episodes_timesteps_total": 14166, "policy_reward_min": {"policy_0": -1388.5623854182456}, "policy_reward_max": {"policy_0": -33.38761724678898}, "policy_reward_mean": {"policy_0": -700.7234370750436}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-761.1671311935917, -754.3931061035327, -668.1848892486222, -129.29631575123562, -731.574815161715, -367.9686810910964, -857.4242538737652, -970.4215011076185, -638.570670352627, -737.8883082239626, -653.997775016813, -1104.6904186687168, -247.7607394953305, -756.0505900638354, -1033.8611839483433, -265.257368123898, -408.4479378645471, -1242.7097287615259, -924.3860582205756, -809.9386138274418, -102.09509255967673, -664.0283814270273, -1266.2766667757544, -962.465967711577, -657.7353270633324, -657.9498780252469, -926.5976285572211, -648.8497288618016, -450.2629663300514, -830.7881348032199, -781.973655887951, -641.1188004648105, -770.6001053458656, -811.477041571988, -1264.6298004485268, -995.5104818440906, -908.0979999960526, -597.2229227348371, -927.4901096596304, -268.06680258980424, -979.2951179496424, -475.7668425066837, -900.6090213391653, -626.1752229676919, -194.18702909601575, -409.47893989781596, -1133.9944242854224, -357.253397795474, -1004.4776515563642, -1099.087142478822, -707.1525469074936, -173.45158275113917, -799.2871773604987, -955.7760494726954, -501.4790511879801, -576.5182390126678, -62.00571038824984, -388.8298543462863, -771.5039894214556, -986.7411594132495, -803.891617906767, -1072.4923227806548, -752.4540720079863, -700.5375926320331, -327.5598591336756, -1171.035638018239, -358.3315407588754, -549.3979112955668, -543.6374623292438, -716.978834722125, -737.9907486266217, -909.7306722440121, -526.0846568828532, -689.6729570930057, -1031.4319478807288, -270.90535598625326, -641.2829978412458, -531.149462235653, -46.50107204115435, -924.8198705586716, -754.4083237243397, -33.38761724678898, -1388.5623854182456, -813.0414267688285, -413.8602180922506, -891.0829052342389, -837.8811162645114, -956.291228790338, -748.2719966157943, -1258.0763476529476, -511.3802444945158, -141.02955065159443, -769.3505643381146, -773.2836236348919, -978.8861648057377, -984.1257568529737, -725.0474260490614, -683.9263270678064, -593.9277248614069, -210.3384370725359], "episode_lengths": [150, 150, 150, 82, 150, 116, 150, 150, 150, 150, 150, 150, 98, 150, 150, 125, 115, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 140, 140, 57, 150, 150, 56, 150, 150, 116, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 148, 74], "policy_policy_0_reward": [-761.1671311935917, -754.3931061035327, -668.1848892486222, -129.29631575123562, -731.574815161715, -367.9686810910964, -857.4242538737652, -970.4215011076185, -638.570670352627, -737.8883082239626, -653.997775016813, -1104.6904186687168, -247.7607394953305, -756.0505900638354, -1033.8611839483433, -265.257368123898, -408.4479378645471, -1242.7097287615259, -924.3860582205756, -809.9386138274418, -102.09509255967673, -664.0283814270273, -1266.2766667757544, -962.465967711577, -657.7353270633324, -657.9498780252469, -926.5976285572211, -648.8497288618016, -450.2629663300514, -830.7881348032199, -781.973655887951, -641.1188004648105, -770.6001053458656, -811.477041571988, -1264.6298004485268, -995.5104818440906, -908.0979999960526, -597.2229227348371, -927.4901096596304, -268.06680258980424, -979.2951179496424, -475.7668425066837, -900.6090213391653, -626.1752229676919, -194.18702909601575, -409.47893989781596, -1133.9944242854224, -357.253397795474, -1004.4776515563642, -1099.087142478822, -707.1525469074936, -173.45158275113917, -799.2871773604987, -955.7760494726954, -501.4790511879801, -576.5182390126678, -62.00571038824984, -388.8298543462863, -771.5039894214556, -986.7411594132495, -803.891617906767, -1072.4923227806548, -752.4540720079863, -700.5375926320331, -327.5598591336756, -1171.035638018239, -358.3315407588754, -549.3979112955668, -543.6374623292438, -716.978834722125, -737.9907486266217, -909.7306722440121, -526.0846568828532, -689.6729570930057, -1031.4319478807288, -270.90535598625326, -641.2829978412458, -531.149462235653, -46.50107204115435, -924.8198705586716, -754.4083237243397, -33.38761724678898, -1388.5623854182456, -813.0414267688285, -413.8602180922506, -891.0829052342389, -837.8811162645114, -956.291228790338, -748.2719966157943, -1258.0763476529476, -511.3802444945158, -141.02955065159443, -769.3505643381146, -773.2836236348919, -978.8861648057377, -984.1257568529737, -725.0474260490614, -683.9263270678064, -593.9277248614069, -210.3384370725359]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5597144758672435, "mean_inference_ms": 1.704164920924454, "mean_action_processing_ms": 0.2844190242039212, "mean_env_wait_ms": 3.0079991329253972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01212453842163086, "StateBufferConnector_ms": 0.007851362228393555, "ViewRequirementAgentConnector_ms": 0.1923363208770752}, "num_episodes": 26, "episode_return_max": -33.38761724678898, "episode_return_min": -1388.5623854182456, "episode_return_mean": -700.7234370750436, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.75971292921366, "num_env_steps_trained_throughput_per_sec": 292.75971292921366, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12686.177, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12686.102, "sample_time_ms": 1028.972, "learn_time_ms": 11591.23, "learn_throughput": 345.088, "synch_weights_time_ms": 65.044}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00005", "date": "2024-08-03_10-44-55", "timestamp": 1722662095, "time_this_iter_s": 13.676188468933105, "time_total_s": 167.07895922660828, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907ba9e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 167.07895922660828, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.315000000000001, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.021607001125815, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.959160353243351, "policy_loss": -0.013687875975544253, "vf_loss": 7.9852590873837475, "vf_explained_var": 0.8636407849689325, "kl": 0.01506498622353926, "entropy": 1.9190099654098352, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -33.38761724678898, "episode_reward_min": -1400.8809650395967, "episode_reward_mean": -745.5914934909582, "episode_len_mean": 142.94, "episode_media": {}, "episodes_timesteps_total": 14294, "policy_reward_min": {"policy_0": -1400.8809650395967}, "policy_reward_max": {"policy_0": -33.38761724678898}, "policy_reward_mean": {"policy_0": -745.5914934909582}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-648.8497288618016, -450.2629663300514, -830.7881348032199, -781.973655887951, -641.1188004648105, -770.6001053458656, -811.477041571988, -1264.6298004485268, -995.5104818440906, -908.0979999960526, -597.2229227348371, -927.4901096596304, -268.06680258980424, -979.2951179496424, -475.7668425066837, -900.6090213391653, -626.1752229676919, -194.18702909601575, -409.47893989781596, -1133.9944242854224, -357.253397795474, -1004.4776515563642, -1099.087142478822, -707.1525469074936, -173.45158275113917, -799.2871773604987, -955.7760494726954, -501.4790511879801, -576.5182390126678, -62.00571038824984, -388.8298543462863, -771.5039894214556, -986.7411594132495, -803.891617906767, -1072.4923227806548, -752.4540720079863, -700.5375926320331, -327.5598591336756, -1171.035638018239, -358.3315407588754, -549.3979112955668, -543.6374623292438, -716.978834722125, -737.9907486266217, -909.7306722440121, -526.0846568828532, -689.6729570930057, -1031.4319478807288, -270.90535598625326, -641.2829978412458, -531.149462235653, -46.50107204115435, -924.8198705586716, -754.4083237243397, -33.38761724678898, -1388.5623854182456, -813.0414267688285, -413.8602180922506, -891.0829052342389, -837.8811162645114, -956.291228790338, -748.2719966157943, -1258.0763476529476, -511.3802444945158, -141.02955065159443, -769.3505643381146, -773.2836236348919, -978.8861648057377, -984.1257568529737, -725.0474260490614, -683.9263270678064, -593.9277248614069, -210.3384370725359, -944.1134006215502, -718.4564176869882, -900.8048686216265, -800.5525223853084, -915.8275441762554, -518.0263437180166, -975.6368470202386, -797.5523650235201, -82.24355755806245, -396.6712676201551, -935.0397624004106, -1187.0525853297047, -920.5181383517057, -923.5694042420931, -1235.8365301798992, -1400.8809650395967, -819.4782754834466, -1078.1920594476696, -307.5532665632251, -830.5137808814098, -1245.1431509396912, -814.0207222019914, -1059.220718107734, -1028.4002606149443, -1004.2451497055863, -1065.0270285059871, -883.3677373832772], "episode_lengths": [150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 140, 140, 57, 150, 150, 56, 150, 150, 116, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 148, 74, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-648.8497288618016, -450.2629663300514, -830.7881348032199, -781.973655887951, -641.1188004648105, -770.6001053458656, -811.477041571988, -1264.6298004485268, -995.5104818440906, -908.0979999960526, -597.2229227348371, -927.4901096596304, -268.06680258980424, -979.2951179496424, -475.7668425066837, -900.6090213391653, -626.1752229676919, -194.18702909601575, -409.47893989781596, -1133.9944242854224, -357.253397795474, -1004.4776515563642, -1099.087142478822, -707.1525469074936, -173.45158275113917, -799.2871773604987, -955.7760494726954, -501.4790511879801, -576.5182390126678, -62.00571038824984, -388.8298543462863, -771.5039894214556, -986.7411594132495, -803.891617906767, -1072.4923227806548, -752.4540720079863, -700.5375926320331, -327.5598591336756, -1171.035638018239, -358.3315407588754, -549.3979112955668, -543.6374623292438, -716.978834722125, -737.9907486266217, -909.7306722440121, -526.0846568828532, -689.6729570930057, -1031.4319478807288, -270.90535598625326, -641.2829978412458, -531.149462235653, -46.50107204115435, -924.8198705586716, -754.4083237243397, -33.38761724678898, -1388.5623854182456, -813.0414267688285, -413.8602180922506, -891.0829052342389, -837.8811162645114, -956.291228790338, -748.2719966157943, -1258.0763476529476, -511.3802444945158, -141.02955065159443, -769.3505643381146, -773.2836236348919, -978.8861648057377, -984.1257568529737, -725.0474260490614, -683.9263270678064, -593.9277248614069, -210.3384370725359, -944.1134006215502, -718.4564176869882, -900.8048686216265, -800.5525223853084, -915.8275441762554, -518.0263437180166, -975.6368470202386, -797.5523650235201, -82.24355755806245, -396.6712676201551, -935.0397624004106, -1187.0525853297047, -920.5181383517057, -923.5694042420931, -1235.8365301798992, -1400.8809650395967, -819.4782754834466, -1078.1920594476696, -307.5532665632251, -830.5137808814098, -1245.1431509396912, -814.0207222019914, -1059.220718107734, -1028.4002606149443, -1004.2451497055863, -1065.0270285059871, -883.3677373832772]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5591878299505934, "mean_inference_ms": 1.7037349161441713, "mean_action_processing_ms": 0.2839548706222269, "mean_env_wait_ms": 3.0157816146792533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012198925018310547, "StateBufferConnector_ms": 0.00789499282836914, "ViewRequirementAgentConnector_ms": 0.1940762996673584}, "num_episodes": 27, "episode_return_max": -33.38761724678898, "episode_return_min": -1400.8809650395967, "episode_return_mean": -745.5914934909582, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.91000452976476, "num_env_steps_trained_throughput_per_sec": 297.91000452976476, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13010.111, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13010.034, "sample_time_ms": 1030.545, "learn_time_ms": 11911.925, "learn_throughput": 335.798, "synch_weights_time_ms": 66.694}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00005", "date": "2024-08-03_10-45-08", "timestamp": 1722662108, "time_this_iter_s": 13.441336154937744, "time_total_s": 180.52029538154602, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a010b250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 180.52029538154602, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.278947368421052, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.757280367612836, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.925651561220487, "policy_loss": -0.014285346124476442, "vf_loss": 6.949955880641937, "vf_explained_var": 0.8691029220819473, "kl": 0.015710836252219453, "entropy": 1.7088835041970014, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -16.90844218912264, "episode_reward_min": -1400.8809650395967, "episode_reward_mean": -760.4950202316774, "episode_len_mean": 141.09, "episode_media": {}, "episodes_timesteps_total": 14109, "policy_reward_min": {"policy_0": -1400.8809650395967}, "policy_reward_max": {"policy_0": -16.90844218912264}, "policy_reward_mean": {"policy_0": -760.4950202316774}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-388.8298543462863, -771.5039894214556, -986.7411594132495, -803.891617906767, -1072.4923227806548, -752.4540720079863, -700.5375926320331, -327.5598591336756, -1171.035638018239, -358.3315407588754, -549.3979112955668, -543.6374623292438, -716.978834722125, -737.9907486266217, -909.7306722440121, -526.0846568828532, -689.6729570930057, -1031.4319478807288, -270.90535598625326, -641.2829978412458, -531.149462235653, -46.50107204115435, -924.8198705586716, -754.4083237243397, -33.38761724678898, -1388.5623854182456, -813.0414267688285, -413.8602180922506, -891.0829052342389, -837.8811162645114, -956.291228790338, -748.2719966157943, -1258.0763476529476, -511.3802444945158, -141.02955065159443, -769.3505643381146, -773.2836236348919, -978.8861648057377, -984.1257568529737, -725.0474260490614, -683.9263270678064, -593.9277248614069, -210.3384370725359, -944.1134006215502, -718.4564176869882, -900.8048686216265, -800.5525223853084, -915.8275441762554, -518.0263437180166, -975.6368470202386, -797.5523650235201, -82.24355755806245, -396.6712676201551, -935.0397624004106, -1187.0525853297047, -920.5181383517057, -923.5694042420931, -1235.8365301798992, -1400.8809650395967, -819.4782754834466, -1078.1920594476696, -307.5532665632251, -830.5137808814098, -1245.1431509396912, -814.0207222019914, -1059.220718107734, -1028.4002606149443, -1004.2451497055863, -1065.0270285059871, -883.3677373832772, -740.3309753945862, -506.8524524261201, -849.5785928187751, -344.5480587317849, -595.2642175049406, -449.4065413528298, -1163.9024439389163, -619.2640935501589, -963.0426126766528, -1237.242661926163, -1230.152207882444, -912.9777526036152, -1233.5255559229388, -314.19576312394867, -1032.6776988520114, -1149.4313872187154, -1308.898971089785, -1165.2414477298105, -16.90844218912264, -223.87177294484263, -791.6730347183322, -791.9112515487357, -361.9001660454775, -251.87405919186278, -1064.3152724735896, -586.8073340712782, -1028.3436101106595, -194.45660110997076, -862.7276713749714, -351.11372104133244], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 140, 140, 57, 150, 150, 56, 150, 150, 116, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 148, 74, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 49, 97, 150, 150, 150, 82, 150, 150, 150, 67, 150, 150], "policy_policy_0_reward": [-388.8298543462863, -771.5039894214556, -986.7411594132495, -803.891617906767, -1072.4923227806548, -752.4540720079863, -700.5375926320331, -327.5598591336756, -1171.035638018239, -358.3315407588754, -549.3979112955668, -543.6374623292438, -716.978834722125, -737.9907486266217, -909.7306722440121, -526.0846568828532, -689.6729570930057, -1031.4319478807288, -270.90535598625326, -641.2829978412458, -531.149462235653, -46.50107204115435, -924.8198705586716, -754.4083237243397, -33.38761724678898, -1388.5623854182456, -813.0414267688285, -413.8602180922506, -891.0829052342389, -837.8811162645114, -956.291228790338, -748.2719966157943, -1258.0763476529476, -511.3802444945158, -141.02955065159443, -769.3505643381146, -773.2836236348919, -978.8861648057377, -984.1257568529737, -725.0474260490614, -683.9263270678064, -593.9277248614069, -210.3384370725359, -944.1134006215502, -718.4564176869882, -900.8048686216265, -800.5525223853084, -915.8275441762554, -518.0263437180166, -975.6368470202386, -797.5523650235201, -82.24355755806245, -396.6712676201551, -935.0397624004106, -1187.0525853297047, -920.5181383517057, -923.5694042420931, -1235.8365301798992, -1400.8809650395967, -819.4782754834466, -1078.1920594476696, -307.5532665632251, -830.5137808814098, -1245.1431509396912, -814.0207222019914, -1059.220718107734, -1028.4002606149443, -1004.2451497055863, -1065.0270285059871, -883.3677373832772, -740.3309753945862, -506.8524524261201, -849.5785928187751, -344.5480587317849, -595.2642175049406, -449.4065413528298, -1163.9024439389163, -619.2640935501589, -963.0426126766528, -1237.242661926163, -1230.152207882444, -912.9777526036152, -1233.5255559229388, -314.19576312394867, -1032.6776988520114, -1149.4313872187154, -1308.898971089785, -1165.2414477298105, -16.90844218912264, -223.87177294484263, -791.6730347183322, -791.9112515487357, -361.9001660454775, -251.87405919186278, -1064.3152724735896, -586.8073340712782, -1028.3436101106595, -194.45660110997076, -862.7276713749714, -351.11372104133244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5588486434492527, "mean_inference_ms": 1.7032215904800523, "mean_action_processing_ms": 0.2834859991864664, "mean_env_wait_ms": 3.0238040057299793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012353658676147461, "StateBufferConnector_ms": 0.00797891616821289, "ViewRequirementAgentConnector_ms": 0.19577908515930176}, "num_episodes": 30, "episode_return_max": -16.90844218912264, "episode_return_min": -1400.8809650395967, "episode_return_mean": -760.4950202316774, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.2931147996797, "num_env_steps_trained_throughput_per_sec": 296.2931147996797, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13367.35, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13367.273, "sample_time_ms": 1041.926, "learn_time_ms": 12257.359, "learn_throughput": 326.335, "synch_weights_time_ms": 67.111}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00005", "date": "2024-08-03_10-45-22", "timestamp": 1722662122, "time_this_iter_s": 13.51293420791626, "time_total_s": 194.03322958946228, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907b9480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 194.03322958946228, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 13.626315789473686, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 61.91880784630776, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.812512370944023, "policy_loss": -0.016923513147533716, "vf_loss": 6.838122058908144, "vf_explained_var": 0.9052818096553286, "kl": 0.016416478579246056, "entropy": 1.6073588747531176, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -16.18815506373578, "episode_reward_min": -1400.8809650395967, "episode_reward_mean": -762.1598432926642, "episode_len_mean": 141.51, "episode_media": {}, "episodes_timesteps_total": 14151, "policy_reward_min": {"policy_0": -1400.8809650395967}, "policy_reward_max": {"policy_0": -16.18815506373578}, "policy_reward_mean": {"policy_0": -762.1598432926642}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-956.291228790338, -748.2719966157943, -1258.0763476529476, -511.3802444945158, -141.02955065159443, -769.3505643381146, -773.2836236348919, -978.8861648057377, -984.1257568529737, -725.0474260490614, -683.9263270678064, -593.9277248614069, -210.3384370725359, -944.1134006215502, -718.4564176869882, -900.8048686216265, -800.5525223853084, -915.8275441762554, -518.0263437180166, -975.6368470202386, -797.5523650235201, -82.24355755806245, -396.6712676201551, -935.0397624004106, -1187.0525853297047, -920.5181383517057, -923.5694042420931, -1235.8365301798992, -1400.8809650395967, -819.4782754834466, -1078.1920594476696, -307.5532665632251, -830.5137808814098, -1245.1431509396912, -814.0207222019914, -1059.220718107734, -1028.4002606149443, -1004.2451497055863, -1065.0270285059871, -883.3677373832772, -740.3309753945862, -506.8524524261201, -849.5785928187751, -344.5480587317849, -595.2642175049406, -449.4065413528298, -1163.9024439389163, -619.2640935501589, -963.0426126766528, -1237.242661926163, -1230.152207882444, -912.9777526036152, -1233.5255559229388, -314.19576312394867, -1032.6776988520114, -1149.4313872187154, -1308.898971089785, -1165.2414477298105, -16.90844218912264, -223.87177294484263, -791.6730347183322, -791.9112515487357, -361.9001660454775, -251.87405919186278, -1064.3152724735896, -586.8073340712782, -1028.3436101106595, -194.45660110997076, -862.7276713749714, -351.11372104133244, -441.80990262115415, -568.9965724645429, -1047.0563556411546, -749.2092071651584, -508.85360587654947, -861.9483627427152, -650.5206525180345, -837.5966486411908, -980.8572018821391, -437.4570922915945, -1002.8193183222713, -887.4851878879633, -977.28488171159, -691.6401308818643, -400.9894560200799, -959.4316658200428, -491.3551936794367, -740.926971825189, -956.3774985210721, -680.9686908139497, -16.18815506373578, -409.0852299613352, -512.4715293523035, -729.925998875907, -615.1074470742321, -20.058273760294668, -1195.7930799071933, -528.0892085081211, -572.9599997596594, -1278.4043754137763], "episode_lengths": [150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 148, 74, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 49, 97, 150, 150, 150, 82, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 63, 150, 150, 150, 150], "policy_policy_0_reward": [-956.291228790338, -748.2719966157943, -1258.0763476529476, -511.3802444945158, -141.02955065159443, -769.3505643381146, -773.2836236348919, -978.8861648057377, -984.1257568529737, -725.0474260490614, -683.9263270678064, -593.9277248614069, -210.3384370725359, -944.1134006215502, -718.4564176869882, -900.8048686216265, -800.5525223853084, -915.8275441762554, -518.0263437180166, -975.6368470202386, -797.5523650235201, -82.24355755806245, -396.6712676201551, -935.0397624004106, -1187.0525853297047, -920.5181383517057, -923.5694042420931, -1235.8365301798992, -1400.8809650395967, -819.4782754834466, -1078.1920594476696, -307.5532665632251, -830.5137808814098, -1245.1431509396912, -814.0207222019914, -1059.220718107734, -1028.4002606149443, -1004.2451497055863, -1065.0270285059871, -883.3677373832772, -740.3309753945862, -506.8524524261201, -849.5785928187751, -344.5480587317849, -595.2642175049406, -449.4065413528298, -1163.9024439389163, -619.2640935501589, -963.0426126766528, -1237.242661926163, -1230.152207882444, -912.9777526036152, -1233.5255559229388, -314.19576312394867, -1032.6776988520114, -1149.4313872187154, -1308.898971089785, -1165.2414477298105, -16.90844218912264, -223.87177294484263, -791.6730347183322, -791.9112515487357, -361.9001660454775, -251.87405919186278, -1064.3152724735896, -586.8073340712782, -1028.3436101106595, -194.45660110997076, -862.7276713749714, -351.11372104133244, -441.80990262115415, -568.9965724645429, -1047.0563556411546, -749.2092071651584, -508.85360587654947, -861.9483627427152, -650.5206525180345, -837.5966486411908, -980.8572018821391, -437.4570922915945, -1002.8193183222713, -887.4851878879633, -977.28488171159, -691.6401308818643, -400.9894560200799, -959.4316658200428, -491.3551936794367, -740.926971825189, -956.3774985210721, -680.9686908139497, -16.18815506373578, -409.0852299613352, -512.4715293523035, -729.925998875907, -615.1074470742321, -20.058273760294668, -1195.7930799071933, -528.0892085081211, -572.9599997596594, -1278.4043754137763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5591559201226531, "mean_inference_ms": 1.7040164765516914, "mean_action_processing_ms": 0.28332910874166656, "mean_env_wait_ms": 3.031566037402424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012642383575439453, "StateBufferConnector_ms": 0.008022546768188477, "ViewRequirementAgentConnector_ms": 0.19857311248779297}, "num_episodes": 30, "episode_return_max": -16.18815506373578, "episode_return_min": -1400.8809650395967, "episode_return_mean": -762.1598432926642, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.61726132531805, "num_env_steps_trained_throughput_per_sec": 296.61726132531805, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13366.867, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13366.789, "sample_time_ms": 1039.524, "learn_time_ms": 12258.308, "learn_throughput": 326.309, "synch_weights_time_ms": 68.08}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00005", "date": "2024-08-03_10-45-35", "timestamp": 1722662135, "time_this_iter_s": 13.498898983001709, "time_total_s": 207.532128572464, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2a00be200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 207.532128572464, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.46842105263158, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.60404839416345, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.083038933575153, "policy_loss": -0.0080861245796162, "vf_loss": 7.100626821815967, "vf_explained_var": 0.9043429102748632, "kl": 0.01620125114595794, "entropy": 1.6792328264564276, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -16.18815506373578, "episode_reward_min": -1400.8809650395967, "episode_reward_mean": -734.6789870288277, "episode_len_mean": 139.35, "episode_media": {}, "episodes_timesteps_total": 13935, "policy_reward_min": {"policy_0": -1400.8809650395967}, "policy_reward_max": {"policy_0": -16.18815506373578}, "policy_reward_mean": {"policy_0": -734.6789870288277}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1400.8809650395967, -819.4782754834466, -1078.1920594476696, -307.5532665632251, -830.5137808814098, -1245.1431509396912, -814.0207222019914, -1059.220718107734, -1028.4002606149443, -1004.2451497055863, -1065.0270285059871, -883.3677373832772, -740.3309753945862, -506.8524524261201, -849.5785928187751, -344.5480587317849, -595.2642175049406, -449.4065413528298, -1163.9024439389163, -619.2640935501589, -963.0426126766528, -1237.242661926163, -1230.152207882444, -912.9777526036152, -1233.5255559229388, -314.19576312394867, -1032.6776988520114, -1149.4313872187154, -1308.898971089785, -1165.2414477298105, -16.90844218912264, -223.87177294484263, -791.6730347183322, -791.9112515487357, -361.9001660454775, -251.87405919186278, -1064.3152724735896, -586.8073340712782, -1028.3436101106595, -194.45660110997076, -862.7276713749714, -351.11372104133244, -441.80990262115415, -568.9965724645429, -1047.0563556411546, -749.2092071651584, -508.85360587654947, -861.9483627427152, -650.5206525180345, -837.5966486411908, -980.8572018821391, -437.4570922915945, -1002.8193183222713, -887.4851878879633, -977.28488171159, -691.6401308818643, -400.9894560200799, -959.4316658200428, -491.3551936794367, -740.926971825189, -956.3774985210721, -680.9686908139497, -16.18815506373578, -409.0852299613352, -512.4715293523035, -729.925998875907, -615.1074470742321, -20.058273760294668, -1195.7930799071933, -528.0892085081211, -572.9599997596594, -1278.4043754137763, -956.7028924147055, -482.375632643319, -144.64077534671324, -1309.8989932605264, -917.394071791495, -938.4296063218015, -1162.5823035893698, -704.6678919778735, -1119.0920731057936, -481.2908308312733, -137.9415857913027, -61.45995703282852, -600.3383273086029, -188.37799547189877, -22.16661597778836, -1032.9263363583, -934.9197283891083, -1228.3744133661214, -396.65646916848345, -1180.7881868406241, -569.7400777935437, -636.3349874170276, -724.7373495934524, -805.1122262656385, -678.4039083177249, -137.1637726501302, -699.8169087981062, -585.4174036160283], "episode_lengths": [150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 49, 97, 150, 150, 150, 82, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 94, 150, 150, 149, 150, 150, 150, 141, 85, 56, 150, 150, 41, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 63, 150, 150], "policy_policy_0_reward": [-1400.8809650395967, -819.4782754834466, -1078.1920594476696, -307.5532665632251, -830.5137808814098, -1245.1431509396912, -814.0207222019914, -1059.220718107734, -1028.4002606149443, -1004.2451497055863, -1065.0270285059871, -883.3677373832772, -740.3309753945862, -506.8524524261201, -849.5785928187751, -344.5480587317849, -595.2642175049406, -449.4065413528298, -1163.9024439389163, -619.2640935501589, -963.0426126766528, -1237.242661926163, -1230.152207882444, -912.9777526036152, -1233.5255559229388, -314.19576312394867, -1032.6776988520114, -1149.4313872187154, -1308.898971089785, -1165.2414477298105, -16.90844218912264, -223.87177294484263, -791.6730347183322, -791.9112515487357, -361.9001660454775, -251.87405919186278, -1064.3152724735896, -586.8073340712782, -1028.3436101106595, -194.45660110997076, -862.7276713749714, -351.11372104133244, -441.80990262115415, -568.9965724645429, -1047.0563556411546, -749.2092071651584, -508.85360587654947, -861.9483627427152, -650.5206525180345, -837.5966486411908, -980.8572018821391, -437.4570922915945, -1002.8193183222713, -887.4851878879633, -977.28488171159, -691.6401308818643, -400.9894560200799, -959.4316658200428, -491.3551936794367, -740.926971825189, -956.3774985210721, -680.9686908139497, -16.18815506373578, -409.0852299613352, -512.4715293523035, -729.925998875907, -615.1074470742321, -20.058273760294668, -1195.7930799071933, -528.0892085081211, -572.9599997596594, -1278.4043754137763, -956.7028924147055, -482.375632643319, -144.64077534671324, -1309.8989932605264, -917.394071791495, -938.4296063218015, -1162.5823035893698, -704.6678919778735, -1119.0920731057936, -481.2908308312733, -137.9415857913027, -61.45995703282852, -600.3383273086029, -188.37799547189877, -22.16661597778836, -1032.9263363583, -934.9197283891083, -1228.3744133661214, -396.65646916848345, -1180.7881868406241, -569.7400777935437, -636.3349874170276, -724.7373495934524, -805.1122262656385, -678.4039083177249, -137.1637726501302, -699.8169087981062, -585.4174036160283]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5594584927574187, "mean_inference_ms": 1.704299854253079, "mean_action_processing_ms": 0.2831472516705164, "mean_env_wait_ms": 3.0351810561327044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012389659881591797, "StateBufferConnector_ms": 0.008127450942993164, "ViewRequirementAgentConnector_ms": 0.19867873191833496}, "num_episodes": 28, "episode_return_max": -16.18815506373578, "episode_return_min": -1400.8809650395967, "episode_return_mean": -734.6789870288277, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.6515729684343, "num_env_steps_trained_throughput_per_sec": 292.6515729684343, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13399.02, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13398.941, "sample_time_ms": 1042.917, "learn_time_ms": 12286.478, "learn_throughput": 325.561, "synch_weights_time_ms": 68.672}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00005", "date": "2024-08-03_10-45-49", "timestamp": 1722662149, "time_this_iter_s": 13.681189060211182, "time_total_s": 221.21331763267517, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c522e60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 221.21331763267517, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.37, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.14884425401688, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.999661456048488, "policy_loss": -0.014540897181238204, "vf_loss": 7.028135294218858, "vf_explained_var": 0.880057631370922, "kl": 0.014429147036253198, "entropy": 2.042605937769016, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -16.18815506373578, "episode_reward_min": -1321.4027165771452, "episode_reward_mean": -707.7500469972016, "episode_len_mean": 136.88, "episode_media": {}, "episodes_timesteps_total": 13688, "policy_reward_min": {"policy_0": -1321.4027165771452}, "policy_reward_max": {"policy_0": -16.18815506373578}, "policy_reward_mean": {"policy_0": -707.7500469972016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1032.6776988520114, -1149.4313872187154, -1308.898971089785, -1165.2414477298105, -16.90844218912264, -223.87177294484263, -791.6730347183322, -791.9112515487357, -361.9001660454775, -251.87405919186278, -1064.3152724735896, -586.8073340712782, -1028.3436101106595, -194.45660110997076, -862.7276713749714, -351.11372104133244, -441.80990262115415, -568.9965724645429, -1047.0563556411546, -749.2092071651584, -508.85360587654947, -861.9483627427152, -650.5206525180345, -837.5966486411908, -980.8572018821391, -437.4570922915945, -1002.8193183222713, -887.4851878879633, -977.28488171159, -691.6401308818643, -400.9894560200799, -959.4316658200428, -491.3551936794367, -740.926971825189, -956.3774985210721, -680.9686908139497, -16.18815506373578, -409.0852299613352, -512.4715293523035, -729.925998875907, -615.1074470742321, -20.058273760294668, -1195.7930799071933, -528.0892085081211, -572.9599997596594, -1278.4043754137763, -956.7028924147055, -482.375632643319, -144.64077534671324, -1309.8989932605264, -917.394071791495, -938.4296063218015, -1162.5823035893698, -704.6678919778735, -1119.0920731057936, -481.2908308312733, -137.9415857913027, -61.45995703282852, -600.3383273086029, -188.37799547189877, -22.16661597778836, -1032.9263363583, -934.9197283891083, -1228.3744133661214, -396.65646916848345, -1180.7881868406241, -569.7400777935437, -636.3349874170276, -724.7373495934524, -805.1122262656385, -678.4039083177249, -137.1637726501302, -699.8169087981062, -585.4174036160283, -535.9691859297177, -921.8105626657399, -1149.4950287765673, -623.1336304987968, -172.25917609938992, -874.0501048466288, -1031.396136344139, -887.0181274863232, -1204.5930275646897, -471.3498782984768, -1165.2089855920015, -794.3954740317253, -434.7141987769089, -1215.49246531037, -1321.4027165771452, -162.36978083295907, -589.6143555855256, -1309.4312934018133, -650.4592625331253, -55.33769867603064, -866.9564068392788, -44.37742725634287, -1042.312521815474, -199.36716837643104, -994.3923621408353, -1286.5260653093978], "episode_lengths": [150, 150, 150, 150, 49, 97, 150, 150, 150, 82, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 94, 150, 150, 149, 150, 150, 150, 141, 85, 56, 150, 150, 41, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 67, 150, 66, 150, 90, 150, 150], "policy_policy_0_reward": [-1032.6776988520114, -1149.4313872187154, -1308.898971089785, -1165.2414477298105, -16.90844218912264, -223.87177294484263, -791.6730347183322, -791.9112515487357, -361.9001660454775, -251.87405919186278, -1064.3152724735896, -586.8073340712782, -1028.3436101106595, -194.45660110997076, -862.7276713749714, -351.11372104133244, -441.80990262115415, -568.9965724645429, -1047.0563556411546, -749.2092071651584, -508.85360587654947, -861.9483627427152, -650.5206525180345, -837.5966486411908, -980.8572018821391, -437.4570922915945, -1002.8193183222713, -887.4851878879633, -977.28488171159, -691.6401308818643, -400.9894560200799, -959.4316658200428, -491.3551936794367, -740.926971825189, -956.3774985210721, -680.9686908139497, -16.18815506373578, -409.0852299613352, -512.4715293523035, -729.925998875907, -615.1074470742321, -20.058273760294668, -1195.7930799071933, -528.0892085081211, -572.9599997596594, -1278.4043754137763, -956.7028924147055, -482.375632643319, -144.64077534671324, -1309.8989932605264, -917.394071791495, -938.4296063218015, -1162.5823035893698, -704.6678919778735, -1119.0920731057936, -481.2908308312733, -137.9415857913027, -61.45995703282852, -600.3383273086029, -188.37799547189877, -22.16661597778836, -1032.9263363583, -934.9197283891083, -1228.3744133661214, -396.65646916848345, -1180.7881868406241, -569.7400777935437, -636.3349874170276, -724.7373495934524, -805.1122262656385, -678.4039083177249, -137.1637726501302, -699.8169087981062, -585.4174036160283, -535.9691859297177, -921.8105626657399, -1149.4950287765673, -623.1336304987968, -172.25917609938992, -874.0501048466288, -1031.396136344139, -887.0181274863232, -1204.5930275646897, -471.3498782984768, -1165.2089855920015, -794.3954740317253, -434.7141987769089, -1215.49246531037, -1321.4027165771452, -162.36978083295907, -589.6143555855256, -1309.4312934018133, -650.4592625331253, -55.33769867603064, -866.9564068392788, -44.37742725634287, -1042.312521815474, -199.36716837643104, -994.3923621408353, -1286.5260653093978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5598370908420691, "mean_inference_ms": 1.7046998499526083, "mean_action_processing_ms": 0.2830462617314697, "mean_env_wait_ms": 3.0404628164766576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012572765350341797, "StateBufferConnector_ms": 0.008178234100341797, "ViewRequirementAgentConnector_ms": 0.19846272468566895}, "num_episodes": 26, "episode_return_max": -16.18815506373578, "episode_return_min": -1321.4027165771452, "episode_return_mean": -707.7500469972016, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.2839631451301, "num_env_steps_trained_throughput_per_sec": 296.2839631451301, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13394.457, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13394.378, "sample_time_ms": 1048.3, "learn_time_ms": 12277.292, "learn_throughput": 325.805, "synch_weights_time_ms": 67.91}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00005", "date": "2024-08-03_10-46-03", "timestamp": 1722662163, "time_this_iter_s": 13.51261043548584, "time_total_s": 234.725928068161, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907b9480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 234.725928068161, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.505263157894738, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 74.13884268303713, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.283734781046708, "policy_loss": -0.008305846913329636, "vf_loss": 6.302990815043449, "vf_explained_var": 0.8724963924537102, "kl": 0.014143821344138512, "entropy": 1.7314913195868333, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -16.18815506373578, "episode_reward_min": -1436.3388689757414, "episode_reward_mean": -723.3030921301074, "episode_len_mean": 138.24, "episode_media": {}, "episodes_timesteps_total": 13824, "policy_reward_min": {"policy_0": -1436.3388689757414}, "policy_reward_max": {"policy_0": -16.18815506373578}, "policy_reward_mean": {"policy_0": -723.3030921301074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-400.9894560200799, -959.4316658200428, -491.3551936794367, -740.926971825189, -956.3774985210721, -680.9686908139497, -16.18815506373578, -409.0852299613352, -512.4715293523035, -729.925998875907, -615.1074470742321, -20.058273760294668, -1195.7930799071933, -528.0892085081211, -572.9599997596594, -1278.4043754137763, -956.7028924147055, -482.375632643319, -144.64077534671324, -1309.8989932605264, -917.394071791495, -938.4296063218015, -1162.5823035893698, -704.6678919778735, -1119.0920731057936, -481.2908308312733, -137.9415857913027, -61.45995703282852, -600.3383273086029, -188.37799547189877, -22.16661597778836, -1032.9263363583, -934.9197283891083, -1228.3744133661214, -396.65646916848345, -1180.7881868406241, -569.7400777935437, -636.3349874170276, -724.7373495934524, -805.1122262656385, -678.4039083177249, -137.1637726501302, -699.8169087981062, -585.4174036160283, -535.9691859297177, -921.8105626657399, -1149.4950287765673, -623.1336304987968, -172.25917609938992, -874.0501048466288, -1031.396136344139, -887.0181274863232, -1204.5930275646897, -471.3498782984768, -1165.2089855920015, -794.3954740317253, -434.7141987769089, -1215.49246531037, -1321.4027165771452, -162.36978083295907, -589.6143555855256, -1309.4312934018133, -650.4592625331253, -55.33769867603064, -866.9564068392788, -44.37742725634287, -1042.312521815474, -199.36716837643104, -994.3923621408353, -1286.5260653093978, -505.74462865541216, -487.1325416406022, -689.489935201637, -1074.8050487845971, -756.6670523838766, -358.532555561216, -751.2757414329392, -733.6844190019716, -528.1449396067312, -866.1457719063293, -1084.139470162405, -1299.5764480847106, -628.1277577085884, -655.2118284883948, -549.6801577131888, -801.1504763408886, -1338.86486789186, -375.79868738238406, -1392.8779740245468, -1436.3388689757414, -1354.6258368192493, -674.122198354567, -615.7601779413302, -612.01791532221, -707.4912902872055, -1171.9545205146344, -116.88150066914056, -369.069182298845, -39.493499971557426, -1406.1867825222257], "episode_lengths": [150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 94, 150, 150, 149, 150, 150, 150, 141, 85, 56, 150, 150, 41, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 67, 150, 66, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 59, 150], "policy_policy_0_reward": [-400.9894560200799, -959.4316658200428, -491.3551936794367, -740.926971825189, -956.3774985210721, -680.9686908139497, -16.18815506373578, -409.0852299613352, -512.4715293523035, -729.925998875907, -615.1074470742321, -20.058273760294668, -1195.7930799071933, -528.0892085081211, -572.9599997596594, -1278.4043754137763, -956.7028924147055, -482.375632643319, -144.64077534671324, -1309.8989932605264, -917.394071791495, -938.4296063218015, -1162.5823035893698, -704.6678919778735, -1119.0920731057936, -481.2908308312733, -137.9415857913027, -61.45995703282852, -600.3383273086029, -188.37799547189877, -22.16661597778836, -1032.9263363583, -934.9197283891083, -1228.3744133661214, -396.65646916848345, -1180.7881868406241, -569.7400777935437, -636.3349874170276, -724.7373495934524, -805.1122262656385, -678.4039083177249, -137.1637726501302, -699.8169087981062, -585.4174036160283, -535.9691859297177, -921.8105626657399, -1149.4950287765673, -623.1336304987968, -172.25917609938992, -874.0501048466288, -1031.396136344139, -887.0181274863232, -1204.5930275646897, -471.3498782984768, -1165.2089855920015, -794.3954740317253, -434.7141987769089, -1215.49246531037, -1321.4027165771452, -162.36978083295907, -589.6143555855256, -1309.4312934018133, -650.4592625331253, -55.33769867603064, -866.9564068392788, -44.37742725634287, -1042.312521815474, -199.36716837643104, -994.3923621408353, -1286.5260653093978, -505.74462865541216, -487.1325416406022, -689.489935201637, -1074.8050487845971, -756.6670523838766, -358.532555561216, -751.2757414329392, -733.6844190019716, -528.1449396067312, -866.1457719063293, -1084.139470162405, -1299.5764480847106, -628.1277577085884, -655.2118284883948, -549.6801577131888, -801.1504763408886, -1338.86486789186, -375.79868738238406, -1392.8779740245468, -1436.3388689757414, -1354.6258368192493, -674.122198354567, -615.7601779413302, -612.01791532221, -707.4912902872055, -1171.9545205146344, -116.88150066914056, -369.069182298845, -39.493499971557426, -1406.1867825222257]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5596618214354927, "mean_inference_ms": 1.7037402045305228, "mean_action_processing_ms": 0.28277220040407963, "mean_env_wait_ms": 3.0444083094553873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01204061508178711, "StateBufferConnector_ms": 0.008068084716796875, "ViewRequirementAgentConnector_ms": 0.19740772247314453}, "num_episodes": 30, "episode_return_max": -16.18815506373578, "episode_return_min": -1436.3388689757414, "episode_return_mean": -723.3030921301074, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.1346770689562, "num_env_steps_trained_throughput_per_sec": 297.1346770689562, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13373.24, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13373.161, "sample_time_ms": 1054.335, "learn_time_ms": 12248.991, "learn_throughput": 326.558, "synch_weights_time_ms": 68.973}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00005", "date": "2024-08-03_10-46-16", "timestamp": 1722662176, "time_this_iter_s": 13.474785566329956, "time_total_s": 248.20071363449097, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907bab90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 248.20071363449097, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.421052631578947, "ram_util_percent": 27.668421052631576}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 68.42505227426687, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.748647349576156, "policy_loss": -0.0058926938247168435, "vf_loss": 6.766567425429821, "vf_explained_var": 0.9069135624915361, "kl": 0.013690285023388545, "entropy": 1.8188009854406118, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -16.008472851081592, "episode_reward_min": -1436.3388689757414, "episode_reward_mean": -734.2621439468832, "episode_len_mean": 139.19, "episode_media": {}, "episodes_timesteps_total": 13919, "policy_reward_min": {"policy_0": -1436.3388689757414}, "policy_reward_max": {"policy_0": -16.008472851081592}, "policy_reward_mean": {"policy_0": -734.2621439468832}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-61.45995703282852, -600.3383273086029, -188.37799547189877, -22.16661597778836, -1032.9263363583, -934.9197283891083, -1228.3744133661214, -396.65646916848345, -1180.7881868406241, -569.7400777935437, -636.3349874170276, -724.7373495934524, -805.1122262656385, -678.4039083177249, -137.1637726501302, -699.8169087981062, -585.4174036160283, -535.9691859297177, -921.8105626657399, -1149.4950287765673, -623.1336304987968, -172.25917609938992, -874.0501048466288, -1031.396136344139, -887.0181274863232, -1204.5930275646897, -471.3498782984768, -1165.2089855920015, -794.3954740317253, -434.7141987769089, -1215.49246531037, -1321.4027165771452, -162.36978083295907, -589.6143555855256, -1309.4312934018133, -650.4592625331253, -55.33769867603064, -866.9564068392788, -44.37742725634287, -1042.312521815474, -199.36716837643104, -994.3923621408353, -1286.5260653093978, -505.74462865541216, -487.1325416406022, -689.489935201637, -1074.8050487845971, -756.6670523838766, -358.532555561216, -751.2757414329392, -733.6844190019716, -528.1449396067312, -866.1457719063293, -1084.139470162405, -1299.5764480847106, -628.1277577085884, -655.2118284883948, -549.6801577131888, -801.1504763408886, -1338.86486789186, -375.79868738238406, -1392.8779740245468, -1436.3388689757414, -1354.6258368192493, -674.122198354567, -615.7601779413302, -612.01791532221, -707.4912902872055, -1171.9545205146344, -116.88150066914056, -369.069182298845, -39.493499971557426, -1406.1867825222257, -531.6153091621723, -894.0940287368009, -1033.6772029401786, -193.26141593245922, -174.5279020505953, -650.6791053072527, -821.8712160037551, -993.1321032981402, -1092.563735471186, -726.1890485387104, -443.62963394092225, -204.52210641821955, -1378.339200780245, -799.1018509078115, -533.0625013207638, -560.433315515992, -994.2112906877801, -1121.5324389531022, -724.6251267174661, -730.7558654766431, -1383.785856581614, -796.3837268050928, -824.46216242673, -16.008472851081592, -492.23909703853775, -887.3824804621013, -556.968418782732], "episode_lengths": [56, 150, 150, 41, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 67, 150, 66, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 59, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 121, 150, 150], "policy_policy_0_reward": [-61.45995703282852, -600.3383273086029, -188.37799547189877, -22.16661597778836, -1032.9263363583, -934.9197283891083, -1228.3744133661214, -396.65646916848345, -1180.7881868406241, -569.7400777935437, -636.3349874170276, -724.7373495934524, -805.1122262656385, -678.4039083177249, -137.1637726501302, -699.8169087981062, -585.4174036160283, -535.9691859297177, -921.8105626657399, -1149.4950287765673, -623.1336304987968, -172.25917609938992, -874.0501048466288, -1031.396136344139, -887.0181274863232, -1204.5930275646897, -471.3498782984768, -1165.2089855920015, -794.3954740317253, -434.7141987769089, -1215.49246531037, -1321.4027165771452, -162.36978083295907, -589.6143555855256, -1309.4312934018133, -650.4592625331253, -55.33769867603064, -866.9564068392788, -44.37742725634287, -1042.312521815474, -199.36716837643104, -994.3923621408353, -1286.5260653093978, -505.74462865541216, -487.1325416406022, -689.489935201637, -1074.8050487845971, -756.6670523838766, -358.532555561216, -751.2757414329392, -733.6844190019716, -528.1449396067312, -866.1457719063293, -1084.139470162405, -1299.5764480847106, -628.1277577085884, -655.2118284883948, -549.6801577131888, -801.1504763408886, -1338.86486789186, -375.79868738238406, -1392.8779740245468, -1436.3388689757414, -1354.6258368192493, -674.122198354567, -615.7601779413302, -612.01791532221, -707.4912902872055, -1171.9545205146344, -116.88150066914056, -369.069182298845, -39.493499971557426, -1406.1867825222257, -531.6153091621723, -894.0940287368009, -1033.6772029401786, -193.26141593245922, -174.5279020505953, -650.6791053072527, -821.8712160037551, -993.1321032981402, -1092.563735471186, -726.1890485387104, -443.62963394092225, -204.52210641821955, -1378.339200780245, -799.1018509078115, -533.0625013207638, -560.433315515992, -994.2112906877801, -1121.5324389531022, -724.6251267174661, -730.7558654766431, -1383.785856581614, -796.3837268050928, -824.46216242673, -16.008472851081592, -492.23909703853775, -887.3824804621013, -556.968418782732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5591083902782991, "mean_inference_ms": 1.7035186221252798, "mean_action_processing_ms": 0.2825692185613585, "mean_env_wait_ms": 3.049973418454137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01283121109008789, "StateBufferConnector_ms": 0.008189201354980469, "ViewRequirementAgentConnector_ms": 0.1982886791229248}, "num_episodes": 27, "episode_return_max": -16.008472851081592, "episode_return_min": -1436.3388689757414, "episode_return_mean": -734.2621439468832, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.86937808152953, "num_env_steps_trained_throughput_per_sec": 290.86937808152953, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13455.131, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13455.051, "sample_time_ms": 1063.441, "learn_time_ms": 12322.783, "learn_throughput": 324.602, "synch_weights_time_ms": 67.958}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00005", "date": "2024-08-03_10-46-30", "timestamp": 1722662190, "time_this_iter_s": 13.764370203018188, "time_total_s": 261.96508383750916, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c523520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 261.96508383750916, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.14, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 75.177150452137, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.6284782181183495, "policy_loss": -0.01733384081016993, "vf_loss": 6.658040529986223, "vf_explained_var": 0.9013762110223372, "kl": 0.016287606000241824, "entropy": 1.955790009101232, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -16.008472851081592, "episode_reward_min": -1436.3388689757414, "episode_reward_mean": -741.3727035395874, "episode_len_mean": 138.65, "episode_media": {}, "episodes_timesteps_total": 13865, "policy_reward_min": {"policy_0": -1436.3388689757414}, "policy_reward_max": {"policy_0": -16.008472851081592}, "policy_reward_mean": {"policy_0": -741.3727035395874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-162.36978083295907, -589.6143555855256, -1309.4312934018133, -650.4592625331253, -55.33769867603064, -866.9564068392788, -44.37742725634287, -1042.312521815474, -199.36716837643104, -994.3923621408353, -1286.5260653093978, -505.74462865541216, -487.1325416406022, -689.489935201637, -1074.8050487845971, -756.6670523838766, -358.532555561216, -751.2757414329392, -733.6844190019716, -528.1449396067312, -866.1457719063293, -1084.139470162405, -1299.5764480847106, -628.1277577085884, -655.2118284883948, -549.6801577131888, -801.1504763408886, -1338.86486789186, -375.79868738238406, -1392.8779740245468, -1436.3388689757414, -1354.6258368192493, -674.122198354567, -615.7601779413302, -612.01791532221, -707.4912902872055, -1171.9545205146344, -116.88150066914056, -369.069182298845, -39.493499971557426, -1406.1867825222257, -531.6153091621723, -894.0940287368009, -1033.6772029401786, -193.26141593245922, -174.5279020505953, -650.6791053072527, -821.8712160037551, -993.1321032981402, -1092.563735471186, -726.1890485387104, -443.62963394092225, -204.52210641821955, -1378.339200780245, -799.1018509078115, -533.0625013207638, -560.433315515992, -994.2112906877801, -1121.5324389531022, -724.6251267174661, -730.7558654766431, -1383.785856581614, -796.3837268050928, -824.46216242673, -16.008472851081592, -492.23909703853775, -887.3824804621013, -556.968418782732, -181.46237954375562, -650.5991729706107, -1296.1122265423223, -1215.924334999643, -487.9566944569059, -985.0196747570733, -1193.2247927030323, -524.5036755736838, -236.99493589604666, -48.29366491454201, -1024.0348131357619, -1152.0520922623693, -980.3049110915516, -357.5591246146454, -748.2557704878553, -1116.4500849496933, -683.5177013018583, -508.2476415375632, -827.322584390931, -110.8426496412269, -704.2448966970798, -1044.6218621548444, -837.1501546028746, -936.9948547742997, -943.4646014669697, -1401.781706902449, -457.0506471170796, -1287.1218059447904, -135.45081001810863, -964.5049646805868, -421.82003326367226, -533.1940590406175], "episode_lengths": [67, 150, 150, 150, 67, 150, 66, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 59, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 121, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 89, 44, 150, 150, 150, 126, 150, 150, 150, 118, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 145], "policy_policy_0_reward": [-162.36978083295907, -589.6143555855256, -1309.4312934018133, -650.4592625331253, -55.33769867603064, -866.9564068392788, -44.37742725634287, -1042.312521815474, -199.36716837643104, -994.3923621408353, -1286.5260653093978, -505.74462865541216, -487.1325416406022, -689.489935201637, -1074.8050487845971, -756.6670523838766, -358.532555561216, -751.2757414329392, -733.6844190019716, -528.1449396067312, -866.1457719063293, -1084.139470162405, -1299.5764480847106, -628.1277577085884, -655.2118284883948, -549.6801577131888, -801.1504763408886, -1338.86486789186, -375.79868738238406, -1392.8779740245468, -1436.3388689757414, -1354.6258368192493, -674.122198354567, -615.7601779413302, -612.01791532221, -707.4912902872055, -1171.9545205146344, -116.88150066914056, -369.069182298845, -39.493499971557426, -1406.1867825222257, -531.6153091621723, -894.0940287368009, -1033.6772029401786, -193.26141593245922, -174.5279020505953, -650.6791053072527, -821.8712160037551, -993.1321032981402, -1092.563735471186, -726.1890485387104, -443.62963394092225, -204.52210641821955, -1378.339200780245, -799.1018509078115, -533.0625013207638, -560.433315515992, -994.2112906877801, -1121.5324389531022, -724.6251267174661, -730.7558654766431, -1383.785856581614, -796.3837268050928, -824.46216242673, -16.008472851081592, -492.23909703853775, -887.3824804621013, -556.968418782732, -181.46237954375562, -650.5991729706107, -1296.1122265423223, -1215.924334999643, -487.9566944569059, -985.0196747570733, -1193.2247927030323, -524.5036755736838, -236.99493589604666, -48.29366491454201, -1024.0348131357619, -1152.0520922623693, -980.3049110915516, -357.5591246146454, -748.2557704878553, -1116.4500849496933, -683.5177013018583, -508.2476415375632, -827.322584390931, -110.8426496412269, -704.2448966970798, -1044.6218621548444, -837.1501546028746, -936.9948547742997, -943.4646014669697, -1401.781706902449, -457.0506471170796, -1287.1218059447904, -135.45081001810863, -964.5049646805868, -421.82003326367226, -533.1940590406175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5585334515533311, "mean_inference_ms": 1.7020472007545482, "mean_action_processing_ms": 0.28220975880199933, "mean_env_wait_ms": 3.0537506311821985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012798547744750977, "StateBufferConnector_ms": 0.008162975311279297, "ViewRequirementAgentConnector_ms": 0.19919180870056152}, "num_episodes": 32, "episode_return_max": -16.008472851081592, "episode_return_min": -1436.3388689757414, "episode_return_mean": -741.3727035395874, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.28742609580434, "num_env_steps_trained_throughput_per_sec": 299.28742609580434, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13527.416, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13527.333, "sample_time_ms": 1063.658, "learn_time_ms": 12394.654, "learn_throughput": 322.72, "synch_weights_time_ms": 68.154}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00005", "date": "2024-08-03_10-46-44", "timestamp": 1722662204, "time_this_iter_s": 13.377617359161377, "time_total_s": 275.34270119667053, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a2907bab00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 275.34270119667053, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.34736842105263, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 79.47053718566895, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.65645848363638, "policy_loss": -0.011189229924639221, "vf_loss": 6.6796319911877315, "vf_explained_var": 0.9353761998936534, "kl": 0.014826063125171155, "entropy": 1.8656015418469907, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -16.008472851081592, "episode_reward_min": -1436.3388689757414, "episode_reward_mean": -733.6011908398275, "episode_len_mean": 137.82, "episode_media": {}, "episodes_timesteps_total": 13782, "policy_reward_min": {"policy_0": -1436.3388689757414}, "policy_reward_max": {"policy_0": -16.008472851081592}, "policy_reward_mean": {"policy_0": -733.6011908398275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801.1504763408886, -1338.86486789186, -375.79868738238406, -1392.8779740245468, -1436.3388689757414, -1354.6258368192493, -674.122198354567, -615.7601779413302, -612.01791532221, -707.4912902872055, -1171.9545205146344, -116.88150066914056, -369.069182298845, -39.493499971557426, -1406.1867825222257, -531.6153091621723, -894.0940287368009, -1033.6772029401786, -193.26141593245922, -174.5279020505953, -650.6791053072527, -821.8712160037551, -993.1321032981402, -1092.563735471186, -726.1890485387104, -443.62963394092225, -204.52210641821955, -1378.339200780245, -799.1018509078115, -533.0625013207638, -560.433315515992, -994.2112906877801, -1121.5324389531022, -724.6251267174661, -730.7558654766431, -1383.785856581614, -796.3837268050928, -824.46216242673, -16.008472851081592, -492.23909703853775, -887.3824804621013, -556.968418782732, -181.46237954375562, -650.5991729706107, -1296.1122265423223, -1215.924334999643, -487.9566944569059, -985.0196747570733, -1193.2247927030323, -524.5036755736838, -236.99493589604666, -48.29366491454201, -1024.0348131357619, -1152.0520922623693, -980.3049110915516, -357.5591246146454, -748.2557704878553, -1116.4500849496933, -683.5177013018583, -508.2476415375632, -827.322584390931, -110.8426496412269, -704.2448966970798, -1044.6218621548444, -837.1501546028746, -936.9948547742997, -943.4646014669697, -1401.781706902449, -457.0506471170796, -1287.1218059447904, -135.45081001810863, -964.5049646805868, -421.82003326367226, -533.1940590406175, -1218.7830202275686, -1236.2370752914405, -898.9326734317029, -719.9305002982139, -723.1871130777304, -437.6795160930811, -889.6468433171375, -529.9466396432571, -856.8800467017627, -334.8531512101282, -1249.9487087070052, -875.2329888562007, -1000.2048287389566, -52.12384751282439, -22.729131221524046, -412.76937066381635, -1121.0637001523983, -134.59843543062925, -1125.63796595642, -61.24462451750067, -893.9563951259123, -391.6954621646859, -454.61852215467496, -749.0179657717376, -471.71010986015943, -529.7227329973756], "episode_lengths": [141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 59, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 143, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 121, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 89, 44, 150, 150, 150, 126, 150, 150, 150, 118, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 145, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 71, 55, 150, 150, 69, 150, 59, 150, 94, 150, 150, 150, 138], "policy_policy_0_reward": [-801.1504763408886, -1338.86486789186, -375.79868738238406, -1392.8779740245468, -1436.3388689757414, -1354.6258368192493, -674.122198354567, -615.7601779413302, -612.01791532221, -707.4912902872055, -1171.9545205146344, -116.88150066914056, -369.069182298845, -39.493499971557426, -1406.1867825222257, -531.6153091621723, -894.0940287368009, -1033.6772029401786, -193.26141593245922, -174.5279020505953, -650.6791053072527, -821.8712160037551, -993.1321032981402, -1092.563735471186, -726.1890485387104, -443.62963394092225, -204.52210641821955, -1378.339200780245, -799.1018509078115, -533.0625013207638, -560.433315515992, -994.2112906877801, -1121.5324389531022, -724.6251267174661, -730.7558654766431, -1383.785856581614, -796.3837268050928, -824.46216242673, -16.008472851081592, -492.23909703853775, -887.3824804621013, -556.968418782732, -181.46237954375562, -650.5991729706107, -1296.1122265423223, -1215.924334999643, -487.9566944569059, -985.0196747570733, -1193.2247927030323, -524.5036755736838, -236.99493589604666, -48.29366491454201, -1024.0348131357619, -1152.0520922623693, -980.3049110915516, -357.5591246146454, -748.2557704878553, -1116.4500849496933, -683.5177013018583, -508.2476415375632, -827.322584390931, -110.8426496412269, -704.2448966970798, -1044.6218621548444, -837.1501546028746, -936.9948547742997, -943.4646014669697, -1401.781706902449, -457.0506471170796, -1287.1218059447904, -135.45081001810863, -964.5049646805868, -421.82003326367226, -533.1940590406175, -1218.7830202275686, -1236.2370752914405, -898.9326734317029, -719.9305002982139, -723.1871130777304, -437.6795160930811, -889.6468433171375, -529.9466396432571, -856.8800467017627, -334.8531512101282, -1249.9487087070052, -875.2329888562007, -1000.2048287389566, -52.12384751282439, -22.729131221524046, -412.76937066381635, -1121.0637001523983, -134.59843543062925, -1125.63796595642, -61.24462451750067, -893.9563951259123, -391.6954621646859, -454.61852215467496, -749.0179657717376, -471.71010986015943, -529.7227329973756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5580469234075799, "mean_inference_ms": 1.7012818319804541, "mean_action_processing_ms": 0.2818947213720403, "mean_env_wait_ms": 3.057576846413466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01278233528137207, "StateBufferConnector_ms": 0.008025884628295898, "ViewRequirementAgentConnector_ms": 0.19689369201660156}, "num_episodes": 26, "episode_return_max": -16.008472851081592, "episode_return_min": -1436.3388689757414, "episode_return_mean": -733.6011908398275, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.4248637276431, "num_env_steps_trained_throughput_per_sec": 300.4248637276431, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13513.77, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13513.687, "sample_time_ms": 1065.702, "learn_time_ms": 12377.641, "learn_throughput": 323.163, "synch_weights_time_ms": 69.476}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00005", "date": "2024-08-03_10-46-57", "timestamp": 1722662217, "time_this_iter_s": 13.326422691345215, "time_total_s": 288.66912388801575, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5216c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 288.66912388801575, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.278947368421052, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 83.5500824779272, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.336583459377289, "policy_loss": -0.01800557883543661, "vf_loss": 6.366390468925237, "vf_explained_var": 0.9575562347347538, "kl": 0.016493004643113332, "entropy": 1.9223295477529367, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -16.008472851081592, "episode_reward_min": -1401.781706902449, "episode_reward_mean": -712.3050444112232, "episode_len_mean": 135.72, "episode_media": {}, "episodes_timesteps_total": 13572, "policy_reward_min": {"policy_0": -1401.781706902449}, "policy_reward_max": {"policy_0": -16.008472851081592}, "policy_reward_mean": {"policy_0": -712.3050444112232}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-560.433315515992, -994.2112906877801, -1121.5324389531022, -724.6251267174661, -730.7558654766431, -1383.785856581614, -796.3837268050928, -824.46216242673, -16.008472851081592, -492.23909703853775, -887.3824804621013, -556.968418782732, -181.46237954375562, -650.5991729706107, -1296.1122265423223, -1215.924334999643, -487.9566944569059, -985.0196747570733, -1193.2247927030323, -524.5036755736838, -236.99493589604666, -48.29366491454201, -1024.0348131357619, -1152.0520922623693, -980.3049110915516, -357.5591246146454, -748.2557704878553, -1116.4500849496933, -683.5177013018583, -508.2476415375632, -827.322584390931, -110.8426496412269, -704.2448966970798, -1044.6218621548444, -837.1501546028746, -936.9948547742997, -943.4646014669697, -1401.781706902449, -457.0506471170796, -1287.1218059447904, -135.45081001810863, -964.5049646805868, -421.82003326367226, -533.1940590406175, -1218.7830202275686, -1236.2370752914405, -898.9326734317029, -719.9305002982139, -723.1871130777304, -437.6795160930811, -889.6468433171375, -529.9466396432571, -856.8800467017627, -334.8531512101282, -1249.9487087070052, -875.2329888562007, -1000.2048287389566, -52.12384751282439, -22.729131221524046, -412.76937066381635, -1121.0637001523983, -134.59843543062925, -1125.63796595642, -61.24462451750067, -893.9563951259123, -391.6954621646859, -454.61852215467496, -749.0179657717376, -471.71010986015943, -529.7227329973756, -842.3038028909145, -740.2621861929788, -506.12939532285077, -1223.5218669325743, -1010.2635227804466, -40.278409367757504, -1156.0492767935486, -788.1903575101435, -215.3855579548201, -65.98489989681111, -807.3269638832918, -881.250935942544, -622.4467955184273, -847.8283416371395, -1025.464574212598, -159.8980393650478, -310.58475729510485, -848.9954027170927, -654.7486101243751, -474.3563898703182, -939.2685107782999, -751.0498897906813, -1290.5008283906352, -1196.0960885212105, -612.214692546857, -1113.9114291052435, -26.453839543944753, -109.08128961608553, -1081.4307448591098, -412.0080979043116], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 51, 121, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 89, 44, 150, 150, 150, 126, 150, 150, 150, 118, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 145, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 71, 55, 150, 150, 69, 150, 59, 150, 94, 150, 150, 150, 138, 150, 150, 150, 150, 150, 47, 150, 150, 77, 66, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 87, 150, 150], "policy_policy_0_reward": [-560.433315515992, -994.2112906877801, -1121.5324389531022, -724.6251267174661, -730.7558654766431, -1383.785856581614, -796.3837268050928, -824.46216242673, -16.008472851081592, -492.23909703853775, -887.3824804621013, -556.968418782732, -181.46237954375562, -650.5991729706107, -1296.1122265423223, -1215.924334999643, -487.9566944569059, -985.0196747570733, -1193.2247927030323, -524.5036755736838, -236.99493589604666, -48.29366491454201, -1024.0348131357619, -1152.0520922623693, -980.3049110915516, -357.5591246146454, -748.2557704878553, -1116.4500849496933, -683.5177013018583, -508.2476415375632, -827.322584390931, -110.8426496412269, -704.2448966970798, -1044.6218621548444, -837.1501546028746, -936.9948547742997, -943.4646014669697, -1401.781706902449, -457.0506471170796, -1287.1218059447904, -135.45081001810863, -964.5049646805868, -421.82003326367226, -533.1940590406175, -1218.7830202275686, -1236.2370752914405, -898.9326734317029, -719.9305002982139, -723.1871130777304, -437.6795160930811, -889.6468433171375, -529.9466396432571, -856.8800467017627, -334.8531512101282, -1249.9487087070052, -875.2329888562007, -1000.2048287389566, -52.12384751282439, -22.729131221524046, -412.76937066381635, -1121.0637001523983, -134.59843543062925, -1125.63796595642, -61.24462451750067, -893.9563951259123, -391.6954621646859, -454.61852215467496, -749.0179657717376, -471.71010986015943, -529.7227329973756, -842.3038028909145, -740.2621861929788, -506.12939532285077, -1223.5218669325743, -1010.2635227804466, -40.278409367757504, -1156.0492767935486, -788.1903575101435, -215.3855579548201, -65.98489989681111, -807.3269638832918, -881.250935942544, -622.4467955184273, -847.8283416371395, -1025.464574212598, -159.8980393650478, -310.58475729510485, -848.9954027170927, -654.7486101243751, -474.3563898703182, -939.2685107782999, -751.0498897906813, -1290.5008283906352, -1196.0960885212105, -612.214692546857, -1113.9114291052435, -26.453839543944753, -109.08128961608553, -1081.4307448591098, -412.0080979043116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578991209256313, "mean_inference_ms": 1.7011020791691243, "mean_action_processing_ms": 0.28174679667209945, "mean_env_wait_ms": 3.060750403212848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013133049011230469, "StateBufferConnector_ms": 0.008050203323364258, "ViewRequirementAgentConnector_ms": 0.19903111457824707}, "num_episodes": 30, "episode_return_max": -16.008472851081592, "episode_return_min": -1401.781706902449, "episode_return_mean": -712.3050444112232, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.8849697573194, "num_env_steps_trained_throughput_per_sec": 295.8849697573194, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13499.338, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13499.254, "sample_time_ms": 1064.986, "learn_time_ms": 12366.304, "learn_throughput": 323.46, "synch_weights_time_ms": 67.105}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00005", "date": "2024-08-03_10-47-11", "timestamp": 1722662231, "time_this_iter_s": 13.531586408615112, "time_total_s": 302.20071029663086, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c523880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 302.20071029663086, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.594736842105263, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.71025922894478, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.730579247077306, "policy_loss": -0.01725660525262356, "vf_loss": 5.760622227191925, "vf_explained_var": 0.9323500202968716, "kl": 0.015733135255777634, "entropy": 1.9866303728272519, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -22.729131221524046, "episode_reward_min": -1424.7949317303517, "episode_reward_mean": -727.7354543469727, "episode_len_mean": 137.56, "episode_media": {}, "episodes_timesteps_total": 13756, "policy_reward_min": {"policy_0": -1424.7949317303517}, "policy_reward_max": {"policy_0": -22.729131221524046}, "policy_reward_mean": {"policy_0": -727.7354543469727}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-827.322584390931, -110.8426496412269, -704.2448966970798, -1044.6218621548444, -837.1501546028746, -936.9948547742997, -943.4646014669697, -1401.781706902449, -457.0506471170796, -1287.1218059447904, -135.45081001810863, -964.5049646805868, -421.82003326367226, -533.1940590406175, -1218.7830202275686, -1236.2370752914405, -898.9326734317029, -719.9305002982139, -723.1871130777304, -437.6795160930811, -889.6468433171375, -529.9466396432571, -856.8800467017627, -334.8531512101282, -1249.9487087070052, -875.2329888562007, -1000.2048287389566, -52.12384751282439, -22.729131221524046, -412.76937066381635, -1121.0637001523983, -134.59843543062925, -1125.63796595642, -61.24462451750067, -893.9563951259123, -391.6954621646859, -454.61852215467496, -749.0179657717376, -471.71010986015943, -529.7227329973756, -842.3038028909145, -740.2621861929788, -506.12939532285077, -1223.5218669325743, -1010.2635227804466, -40.278409367757504, -1156.0492767935486, -788.1903575101435, -215.3855579548201, -65.98489989681111, -807.3269638832918, -881.250935942544, -622.4467955184273, -847.8283416371395, -1025.464574212598, -159.8980393650478, -310.58475729510485, -848.9954027170927, -654.7486101243751, -474.3563898703182, -939.2685107782999, -751.0498897906813, -1290.5008283906352, -1196.0960885212105, -612.214692546857, -1113.9114291052435, -26.453839543944753, -109.08128961608553, -1081.4307448591098, -412.0080979043116, -661.5917038681465, -1041.955934754853, -1398.0617036649398, -1424.7949317303517, -34.83061090558286, -1010.026083045837, -1172.2877050307395, -507.0279606897943, -499.3870293516869, -1160.439036688919, -787.9184868957641, -793.4044886718425, -1226.7997638888735, -646.0716230568397, -784.5917154386841, -1032.2813882960145, -1083.5968077820874, -1163.7578094662292, -907.1055616461662, -707.517070725913, -512.3247867737266, -623.822524901856, -51.75589696226789, -423.593954209126, -333.86652466623866, -668.0440505968379, -1023.8145878473088, -789.0530443158895, -427.6566624085681, -1124.9634893316463], "episode_lengths": [150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 145, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 71, 55, 150, 150, 69, 150, 59, 150, 94, 150, 150, 150, 138, 150, 150, 150, 150, 150, 47, 150, 150, 77, 66, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 87, 150, 150, 150, 150, 150, 150, 44, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 148, 123, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-827.322584390931, -110.8426496412269, -704.2448966970798, -1044.6218621548444, -837.1501546028746, -936.9948547742997, -943.4646014669697, -1401.781706902449, -457.0506471170796, -1287.1218059447904, -135.45081001810863, -964.5049646805868, -421.82003326367226, -533.1940590406175, -1218.7830202275686, -1236.2370752914405, -898.9326734317029, -719.9305002982139, -723.1871130777304, -437.6795160930811, -889.6468433171375, -529.9466396432571, -856.8800467017627, -334.8531512101282, -1249.9487087070052, -875.2329888562007, -1000.2048287389566, -52.12384751282439, -22.729131221524046, -412.76937066381635, -1121.0637001523983, -134.59843543062925, -1125.63796595642, -61.24462451750067, -893.9563951259123, -391.6954621646859, -454.61852215467496, -749.0179657717376, -471.71010986015943, -529.7227329973756, -842.3038028909145, -740.2621861929788, -506.12939532285077, -1223.5218669325743, -1010.2635227804466, -40.278409367757504, -1156.0492767935486, -788.1903575101435, -215.3855579548201, -65.98489989681111, -807.3269638832918, -881.250935942544, -622.4467955184273, -847.8283416371395, -1025.464574212598, -159.8980393650478, -310.58475729510485, -848.9954027170927, -654.7486101243751, -474.3563898703182, -939.2685107782999, -751.0498897906813, -1290.5008283906352, -1196.0960885212105, -612.214692546857, -1113.9114291052435, -26.453839543944753, -109.08128961608553, -1081.4307448591098, -412.0080979043116, -661.5917038681465, -1041.955934754853, -1398.0617036649398, -1424.7949317303517, -34.83061090558286, -1010.026083045837, -1172.2877050307395, -507.0279606897943, -499.3870293516869, -1160.439036688919, -787.9184868957641, -793.4044886718425, -1226.7997638888735, -646.0716230568397, -784.5917154386841, -1032.2813882960145, -1083.5968077820874, -1163.7578094662292, -907.1055616461662, -707.517070725913, -512.3247867737266, -623.822524901856, -51.75589696226789, -423.593954209126, -333.86652466623866, -668.0440505968379, -1023.8145878473088, -789.0530443158895, -427.6566624085681, -1124.9634893316463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5571475722496243, "mean_inference_ms": 1.7001460764340075, "mean_action_processing_ms": 0.28153834634832653, "mean_env_wait_ms": 3.0637752615195386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01296687126159668, "StateBufferConnector_ms": 0.008113861083984375, "ViewRequirementAgentConnector_ms": 0.20100879669189453}, "num_episodes": 30, "episode_return_max": -22.729131221524046, "episode_return_min": -1424.7949317303517, "episode_return_mean": -727.7354543469727, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.9561928163948, "num_env_steps_trained_throughput_per_sec": 297.9561928163948, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13499.13, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13499.046, "sample_time_ms": 1067.664, "learn_time_ms": 12363.139, "learn_throughput": 323.542, "synch_weights_time_ms": 67.373}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00005", "date": "2024-08-03_10-47-24", "timestamp": 1722662244, "time_this_iter_s": 13.437581539154053, "time_total_s": 315.6382918357849, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5745e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 315.6382918357849, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.378947368421054, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 108.1061105688413, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.0049113844831785, "policy_loss": -0.01220589683750101, "vf_loss": 6.027944648762544, "vf_explained_var": 0.9444479200368127, "kl": 0.016037076114738133, "entropy": 1.8044038460900387, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -22.729131221524046, "episode_reward_min": -1445.1675451448984, "episode_reward_mean": -734.032956520297, "episode_len_mean": 138.72, "episode_media": {}, "episodes_timesteps_total": 13872, "policy_reward_min": {"policy_0": -1445.1675451448984}, "policy_reward_max": {"policy_0": -22.729131221524046}, "policy_reward_mean": {"policy_0": -734.032956520297}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.729131221524046, -412.76937066381635, -1121.0637001523983, -134.59843543062925, -1125.63796595642, -61.24462451750067, -893.9563951259123, -391.6954621646859, -454.61852215467496, -749.0179657717376, -471.71010986015943, -529.7227329973756, -842.3038028909145, -740.2621861929788, -506.12939532285077, -1223.5218669325743, -1010.2635227804466, -40.278409367757504, -1156.0492767935486, -788.1903575101435, -215.3855579548201, -65.98489989681111, -807.3269638832918, -881.250935942544, -622.4467955184273, -847.8283416371395, -1025.464574212598, -159.8980393650478, -310.58475729510485, -848.9954027170927, -654.7486101243751, -474.3563898703182, -939.2685107782999, -751.0498897906813, -1290.5008283906352, -1196.0960885212105, -612.214692546857, -1113.9114291052435, -26.453839543944753, -109.08128961608553, -1081.4307448591098, -412.0080979043116, -661.5917038681465, -1041.955934754853, -1398.0617036649398, -1424.7949317303517, -34.83061090558286, -1010.026083045837, -1172.2877050307395, -507.0279606897943, -499.3870293516869, -1160.439036688919, -787.9184868957641, -793.4044886718425, -1226.7997638888735, -646.0716230568397, -784.5917154386841, -1032.2813882960145, -1083.5968077820874, -1163.7578094662292, -907.1055616461662, -707.517070725913, -512.3247867737266, -623.822524901856, -51.75589696226789, -423.593954209126, -333.86652466623866, -668.0440505968379, -1023.8145878473088, -789.0530443158895, -427.6566624085681, -1124.9634893316463, -836.3509647059594, -1334.0451664751326, -1053.2022286852607, -1408.647190114536, -730.1504176690602, -747.8853130914575, -333.18193055795825, -502.6752589161154, -1026.1820533380658, -587.3795455573252, -873.9027474866843, -835.1630172422806, -661.2085128810438, -964.6751446560651, -426.8632289635446, -1333.5747340006874, -1445.1675451448984, -66.1524198704989, -784.5891575976012, -806.2688598386865, -981.3621682207024, -650.3528510053504, -927.1685620632255, -454.8159792242545, -458.1441154320981, -409.9968711848642, -637.8320536346556, -981.964763576945], "episode_lengths": [55, 150, 150, 69, 150, 59, 150, 94, 150, 150, 150, 138, 150, 150, 150, 150, 150, 47, 150, 150, 77, 66, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 87, 150, 150, 150, 150, 150, 150, 44, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 148, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-22.729131221524046, -412.76937066381635, -1121.0637001523983, -134.59843543062925, -1125.63796595642, -61.24462451750067, -893.9563951259123, -391.6954621646859, -454.61852215467496, -749.0179657717376, -471.71010986015943, -529.7227329973756, -842.3038028909145, -740.2621861929788, -506.12939532285077, -1223.5218669325743, -1010.2635227804466, -40.278409367757504, -1156.0492767935486, -788.1903575101435, -215.3855579548201, -65.98489989681111, -807.3269638832918, -881.250935942544, -622.4467955184273, -847.8283416371395, -1025.464574212598, -159.8980393650478, -310.58475729510485, -848.9954027170927, -654.7486101243751, -474.3563898703182, -939.2685107782999, -751.0498897906813, -1290.5008283906352, -1196.0960885212105, -612.214692546857, -1113.9114291052435, -26.453839543944753, -109.08128961608553, -1081.4307448591098, -412.0080979043116, -661.5917038681465, -1041.955934754853, -1398.0617036649398, -1424.7949317303517, -34.83061090558286, -1010.026083045837, -1172.2877050307395, -507.0279606897943, -499.3870293516869, -1160.439036688919, -787.9184868957641, -793.4044886718425, -1226.7997638888735, -646.0716230568397, -784.5917154386841, -1032.2813882960145, -1083.5968077820874, -1163.7578094662292, -907.1055616461662, -707.517070725913, -512.3247867737266, -623.822524901856, -51.75589696226789, -423.593954209126, -333.86652466623866, -668.0440505968379, -1023.8145878473088, -789.0530443158895, -427.6566624085681, -1124.9634893316463, -836.3509647059594, -1334.0451664751326, -1053.2022286852607, -1408.647190114536, -730.1504176690602, -747.8853130914575, -333.18193055795825, -502.6752589161154, -1026.1820533380658, -587.3795455573252, -873.9027474866843, -835.1630172422806, -661.2085128810438, -964.6751446560651, -426.8632289635446, -1333.5747340006874, -1445.1675451448984, -66.1524198704989, -784.5891575976012, -806.2688598386865, -981.3621682207024, -650.3528510053504, -927.1685620632255, -454.8159792242545, -458.1441154320981, -409.9968711848642, -637.8320536346556, -981.964763576945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5573417548000732, "mean_inference_ms": 1.7017315253873753, "mean_action_processing_ms": 0.28170020746641855, "mean_env_wait_ms": 3.0662463028860696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01291513442993164, "StateBufferConnector_ms": 0.008260726928710938, "ViewRequirementAgentConnector_ms": 0.20289111137390137}, "num_episodes": 28, "episode_return_max": -22.729131221524046, "episode_return_min": -1445.1675451448984, "episode_return_mean": -734.032956520297, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.803091792775, "num_env_steps_trained_throughput_per_sec": 295.803091792775, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13501.367, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13501.281, "sample_time_ms": 1064.708, "learn_time_ms": 12368.539, "learn_throughput": 323.401, "synch_weights_time_ms": 67.175}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00005", "date": "2024-08-03_10-47-38", "timestamp": 1722662258, "time_this_iter_s": 13.534968852996826, "time_total_s": 329.17326068878174, "pid": 513981, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c523b50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 329.17326068878174, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.610526315789471, "ram_util_percent": 27.7}}
