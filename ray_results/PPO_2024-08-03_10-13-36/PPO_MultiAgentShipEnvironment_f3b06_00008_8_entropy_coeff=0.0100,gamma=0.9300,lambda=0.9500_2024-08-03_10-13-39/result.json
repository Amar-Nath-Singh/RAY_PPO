{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9984293766630192, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.573065655430158, "policy_loss": -0.005725765895234266, "vf_loss": 9.590785443782806, "vf_explained_var": 0.005044698032240073, "kl": 0.01011169161078366, "entropy": 1.4016356762498616, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -23.2646350562833, "episode_reward_min": -1193.681052944376, "episode_reward_mean": -696.4208046332545, "episode_len_mean": 132.54166666666666, "episode_media": {}, "episodes_timesteps_total": 3181, "policy_reward_min": {"policy_0": -1193.681052944376}, "policy_reward_max": {"policy_0": -23.2646350562833}, "policy_reward_mean": {"policy_0": -696.4208046332545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-648.3249467093679, -1047.6326659796753, -1193.681052944376, -87.47798989003992, -23.2646350562833, -650.4008953214874, -823.318826304921, -150.54535379459202, -977.2044096673709, -833.8684892407683, -346.6394245457072, -1078.5522811649744, -385.38241546006356, -844.353942700766, -753.4446738883908, -731.7623301096852, -914.2185285410903, -717.3785589264317, -865.0409578775656, -1014.13762034349, -849.3589524651233, -912.9748946110884, -172.03017002538326, -693.1052956294659], "episode_lengths": [139, 150, 150, 50, 47, 150, 150, 55, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150], "policy_policy_0_reward": [-648.3249467093679, -1047.6326659796753, -1193.681052944376, -87.47798989003992, -23.2646350562833, -650.4008953214874, -823.318826304921, -150.54535379459202, -977.2044096673709, -833.8684892407683, -346.6394245457072, -1078.5522811649744, -385.38241546006356, -844.353942700766, -753.4446738883908, -731.7623301096852, -914.2185285410903, -717.3785589264317, -865.0409578775656, -1014.13762034349, -849.3589524651233, -912.9748946110884, -172.03017002538326, -693.1052956294659]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5636030752018102, "mean_inference_ms": 1.653965963779673, "mean_action_processing_ms": 0.27871192741341844, "mean_env_wait_ms": 2.961325018080976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01086890697479248, "StateBufferConnector_ms": 0.00787973403930664, "ViewRequirementAgentConnector_ms": 0.17475088437398276}, "num_episodes": 24, "episode_return_max": -23.2646350562833, "episode_return_min": -1193.681052944376, "episode_return_mean": -696.4208046332545, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.5421244048361, "num_env_steps_trained_throughput_per_sec": 305.5421244048361, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13091.494, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13091.429, "sample_time_ms": 1019.743, "learn_time_ms": 12001.855, "learn_throughput": 333.282, "synch_weights_time_ms": 68.945}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "f3b06_00008", "date": "2024-08-03_10-59-30", "timestamp": 1722662970, "time_this_iter_s": 13.102861166000366, "time_total_s": 13.102861166000366, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d1750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.102861166000366, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 13.063157894736843, "ram_util_percent": 27.526315789473685}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7526896234291296, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.061501829822857, "policy_loss": -0.00926202146996123, "vf_loss": 9.082420958081881, "vf_explained_var": 0.029415700087944665, "kl": 0.014087440963370076, "entropy": 1.4474590819329023, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -23.2646350562833, "episode_reward_min": -1193.681052944376, "episode_reward_mean": -713.3140549030686, "episode_len_mean": 133.34, "episode_media": {}, "episodes_timesteps_total": 6667, "policy_reward_min": {"policy_0": -1193.681052944376}, "policy_reward_max": {"policy_0": -23.2646350562833}, "policy_reward_mean": {"policy_0": -713.3140549030686}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-648.3249467093679, -1047.6326659796753, -1193.681052944376, -87.47798989003992, -23.2646350562833, -650.4008953214874, -823.318826304921, -150.54535379459202, -977.2044096673709, -833.8684892407683, -346.6394245457072, -1078.5522811649744, -385.38241546006356, -844.353942700766, -753.4446738883908, -731.7623301096852, -914.2185285410903, -717.3785589264317, -865.0409578775656, -1014.13762034349, -849.3589524651233, -912.9748946110884, -172.03017002538326, -693.1052956294659, -1189.9554159288512, -318.714437660177, -311.0742197123871, -1004.1907166055147, -960.4766542435423, -1028.527390226494, -121.69925023939626, -228.24130540125938, -1072.5871262960682, -831.9902026351809, -1007.5204251396578, -628.2224193849862, -868.2032155088183, -127.01210654842896, -259.9986143056132, -1069.3777514490787, -897.5201225427644, -1073.4346367494854, -1070.2579477322058, -1110.0332811616956, -753.0192055826118, -836.1449196454582, -674.9488364234473, -247.68603860213048, -225.917364702326, -1034.849829527744], "episode_lengths": [139, 150, 150, 50, 47, 150, 150, 55, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 106, 87, 150, 150, 150, 80, 107, 150, 150, 150, 150, 150, 58, 107, 150, 150, 150, 150, 150, 150, 150, 138, 150, 103, 150], "policy_policy_0_reward": [-648.3249467093679, -1047.6326659796753, -1193.681052944376, -87.47798989003992, -23.2646350562833, -650.4008953214874, -823.318826304921, -150.54535379459202, -977.2044096673709, -833.8684892407683, -346.6394245457072, -1078.5522811649744, -385.38241546006356, -844.353942700766, -753.4446738883908, -731.7623301096852, -914.2185285410903, -717.3785589264317, -865.0409578775656, -1014.13762034349, -849.3589524651233, -912.9748946110884, -172.03017002538326, -693.1052956294659, -1189.9554159288512, -318.714437660177, -311.0742197123871, -1004.1907166055147, -960.4766542435423, -1028.527390226494, -121.69925023939626, -228.24130540125938, -1072.5871262960682, -831.9902026351809, -1007.5204251396578, -628.2224193849862, -868.2032155088183, -127.01210654842896, -259.9986143056132, -1069.3777514490787, -897.5201225427644, -1073.4346367494854, -1070.2579477322058, -1110.0332811616956, -753.0192055826118, -836.1449196454582, -674.9488364234473, -247.68603860213048, -225.917364702326, -1034.849829527744]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5623417823336961, "mean_inference_ms": 1.6693494910681526, "mean_action_processing_ms": 0.2808514030342239, "mean_env_wait_ms": 2.967728932323884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01368093490600586, "StateBufferConnector_ms": 0.008121490478515625, "ViewRequirementAgentConnector_ms": 0.17880868911743164}, "num_episodes": 26, "episode_return_max": -23.2646350562833, "episode_return_min": -1193.681052944376, "episode_return_mean": -713.3140549030686, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.7234065968312, "num_env_steps_trained_throughput_per_sec": 315.7234065968312, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12880.412, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12880.344, "sample_time_ms": 1016.893, "learn_time_ms": 11797.635, "learn_throughput": 339.051, "synch_weights_time_ms": 64.943}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "f3b06_00008", "date": "2024-08-03_10-59-43", "timestamp": 1722662983, "time_this_iter_s": 12.682886600494385, "time_total_s": 25.78574776649475, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c522b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.78574776649475, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.8, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.282148867721359, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.382145391404629, "policy_loss": -0.008438982137886342, "vf_loss": 8.402565656105677, "vf_explained_var": 0.2380780308196942, "kl": 0.01218653490251806, "entropy": 1.4418584605058034, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -23.2646350562833, "episode_reward_min": -1220.5475697170884, "episode_reward_mean": -676.7053059055542, "episode_len_mean": 132.37974683544303, "episode_media": {}, "episodes_timesteps_total": 10458, "policy_reward_min": {"policy_0": -1220.5475697170884}, "policy_reward_max": {"policy_0": -23.2646350562833}, "policy_reward_mean": {"policy_0": -676.7053059055542}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-648.3249467093679, -1047.6326659796753, -1193.681052944376, -87.47798989003992, -23.2646350562833, -650.4008953214874, -823.318826304921, -150.54535379459202, -977.2044096673709, -833.8684892407683, -346.6394245457072, -1078.5522811649744, -385.38241546006356, -844.353942700766, -753.4446738883908, -731.7623301096852, -914.2185285410903, -717.3785589264317, -865.0409578775656, -1014.13762034349, -849.3589524651233, -912.9748946110884, -172.03017002538326, -693.1052956294659, -1189.9554159288512, -318.714437660177, -311.0742197123871, -1004.1907166055147, -960.4766542435423, -1028.527390226494, -121.69925023939626, -228.24130540125938, -1072.5871262960682, -831.9902026351809, -1007.5204251396578, -628.2224193849862, -868.2032155088183, -127.01210654842896, -259.9986143056132, -1069.3777514490787, -897.5201225427644, -1073.4346367494854, -1070.2579477322058, -1110.0332811616956, -753.0192055826118, -836.1449196454582, -674.9488364234473, -247.68603860213048, -225.917364702326, -1034.849829527744, -145.89073258233952, -692.0137008831714, -739.1906830758203, -220.1746083585823, -755.1675183889091, -1220.5475697170884, -403.252979773953, -448.94026013671623, -926.0700513413889, -1126.1210404815308, -987.809647387571, -514.4486729417554, -848.9536007334078, -837.7943872988577, -803.1347103705125, -133.55366590727863, -305.74790730343943, -28.24212410055757, -664.9714745900394, -897.5149781815015, -116.59110455923552, -806.019349981913, -881.0787143471342, -749.1238133201622, -115.93311938266113, -788.2924195363645, -700.7042270492248, -66.38312185777897, -870.3502377964571], "episode_lengths": [139, 150, 150, 50, 47, 150, 150, 55, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 106, 87, 150, 150, 150, 80, 107, 150, 150, 150, 150, 150, 58, 107, 150, 150, 150, 150, 150, 150, 150, 138, 150, 103, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 90, 53, 150, 150, 61, 150, 150, 150, 64, 150, 150, 63, 150], "policy_policy_0_reward": [-648.3249467093679, -1047.6326659796753, -1193.681052944376, -87.47798989003992, -23.2646350562833, -650.4008953214874, -823.318826304921, -150.54535379459202, -977.2044096673709, -833.8684892407683, -346.6394245457072, -1078.5522811649744, -385.38241546006356, -844.353942700766, -753.4446738883908, -731.7623301096852, -914.2185285410903, -717.3785589264317, -865.0409578775656, -1014.13762034349, -849.3589524651233, -912.9748946110884, -172.03017002538326, -693.1052956294659, -1189.9554159288512, -318.714437660177, -311.0742197123871, -1004.1907166055147, -960.4766542435423, -1028.527390226494, -121.69925023939626, -228.24130540125938, -1072.5871262960682, -831.9902026351809, -1007.5204251396578, -628.2224193849862, -868.2032155088183, -127.01210654842896, -259.9986143056132, -1069.3777514490787, -897.5201225427644, -1073.4346367494854, -1070.2579477322058, -1110.0332811616956, -753.0192055826118, -836.1449196454582, -674.9488364234473, -247.68603860213048, -225.917364702326, -1034.849829527744, -145.89073258233952, -692.0137008831714, -739.1906830758203, -220.1746083585823, -755.1675183889091, -1220.5475697170884, -403.252979773953, -448.94026013671623, -926.0700513413889, -1126.1210404815308, -987.809647387571, -514.4486729417554, -848.9536007334078, -837.7943872988577, -803.1347103705125, -133.55366590727863, -305.74790730343943, -28.24212410055757, -664.9714745900394, -897.5149781815015, -116.59110455923552, -806.019349981913, -881.0787143471342, -749.1238133201622, -115.93311938266113, -788.2924195363645, -700.7042270492248, -66.38312185777897, -870.3502377964571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5629666196271409, "mean_inference_ms": 1.678507473278239, "mean_action_processing_ms": 0.2820830428188863, "mean_env_wait_ms": 2.9727640320814537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013542778884308248, "StateBufferConnector_ms": 0.008379960361915299, "ViewRequirementAgentConnector_ms": 0.18652964241897005}, "num_episodes": 29, "episode_return_max": -23.2646350562833, "episode_return_min": -1220.5475697170884, "episode_return_mean": -676.7053059055542, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.71045384457835, "num_env_steps_trained_throughput_per_sec": 297.71045384457835, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13065.571, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13065.496, "sample_time_ms": 1023.369, "learn_time_ms": 11974.133, "learn_throughput": 334.053, "synch_weights_time_ms": 67.115}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "f3b06_00008", "date": "2024-08-03_10-59-56", "timestamp": 1722662996, "time_this_iter_s": 13.449732065200806, "time_total_s": 39.23547983169556, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d3490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.23547983169556, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.494736842105265, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.785349565247696, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.850741221010685, "policy_loss": -0.008706732712986802, "vf_loss": 6.87114114065965, "vf_explained_var": 0.553361636089782, "kl": 0.015182997640082855, "entropy": 1.4729779788603385, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -18.565718958203252, "episode_reward_min": -1221.9013779940312, "episode_reward_mean": -695.640133549025, "episode_len_mean": 135.94, "episode_media": {}, "episodes_timesteps_total": 13594, "policy_reward_min": {"policy_0": -1221.9013779940312}, "policy_reward_max": {"policy_0": -18.565718958203252}, "policy_reward_mean": {"policy_0": -695.640133549025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-823.318826304921, -150.54535379459202, -977.2044096673709, -833.8684892407683, -346.6394245457072, -1078.5522811649744, -385.38241546006356, -844.353942700766, -753.4446738883908, -731.7623301096852, -914.2185285410903, -717.3785589264317, -865.0409578775656, -1014.13762034349, -849.3589524651233, -912.9748946110884, -172.03017002538326, -693.1052956294659, -1189.9554159288512, -318.714437660177, -311.0742197123871, -1004.1907166055147, -960.4766542435423, -1028.527390226494, -121.69925023939626, -228.24130540125938, -1072.5871262960682, -831.9902026351809, -1007.5204251396578, -628.2224193849862, -868.2032155088183, -127.01210654842896, -259.9986143056132, -1069.3777514490787, -897.5201225427644, -1073.4346367494854, -1070.2579477322058, -1110.0332811616956, -753.0192055826118, -836.1449196454582, -674.9488364234473, -247.68603860213048, -225.917364702326, -1034.849829527744, -145.89073258233952, -692.0137008831714, -739.1906830758203, -220.1746083585823, -755.1675183889091, -1220.5475697170884, -403.252979773953, -448.94026013671623, -926.0700513413889, -1126.1210404815308, -987.809647387571, -514.4486729417554, -848.9536007334078, -837.7943872988577, -803.1347103705125, -133.55366590727863, -305.74790730343943, -28.24212410055757, -664.9714745900394, -897.5149781815015, -116.59110455923552, -806.019349981913, -881.0787143471342, -749.1238133201622, -115.93311938266113, -788.2924195363645, -700.7042270492248, -66.38312185777897, -870.3502377964571, -519.4704641168844, -530.1045358072922, -928.4440746837395, -924.0780031283583, -588.2549656925243, -706.5361645234958, -588.5689127143715, -18.565718958203252, -1188.8193900465258, -933.3247806913446, -1221.9013779940312, -1000.326198650391, -847.7668890492866, -951.2161655211737, -731.3865490818615, -583.0442996491211, -631.7550806140234, -569.1541225204727, -1077.2676282970683, -995.3305509471189, -700.5742337786361, -989.6056518458181, -371.903961017798, -842.8704844883367, -351.450961429062, -241.263580523481, -722.0916284945448], "episode_lengths": [150, 55, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 106, 87, 150, 150, 150, 80, 107, 150, 150, 150, 150, 150, 58, 107, 150, 150, 150, 150, 150, 150, 150, 138, 150, 103, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 90, 53, 150, 150, 61, 150, 150, 150, 64, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 95, 150, 144, 99, 150], "policy_policy_0_reward": [-823.318826304921, -150.54535379459202, -977.2044096673709, -833.8684892407683, -346.6394245457072, -1078.5522811649744, -385.38241546006356, -844.353942700766, -753.4446738883908, -731.7623301096852, -914.2185285410903, -717.3785589264317, -865.0409578775656, -1014.13762034349, -849.3589524651233, -912.9748946110884, -172.03017002538326, -693.1052956294659, -1189.9554159288512, -318.714437660177, -311.0742197123871, -1004.1907166055147, -960.4766542435423, -1028.527390226494, -121.69925023939626, -228.24130540125938, -1072.5871262960682, -831.9902026351809, -1007.5204251396578, -628.2224193849862, -868.2032155088183, -127.01210654842896, -259.9986143056132, -1069.3777514490787, -897.5201225427644, -1073.4346367494854, -1070.2579477322058, -1110.0332811616956, -753.0192055826118, -836.1449196454582, -674.9488364234473, -247.68603860213048, -225.917364702326, -1034.849829527744, -145.89073258233952, -692.0137008831714, -739.1906830758203, -220.1746083585823, -755.1675183889091, -1220.5475697170884, -403.252979773953, -448.94026013671623, -926.0700513413889, -1126.1210404815308, -987.809647387571, -514.4486729417554, -848.9536007334078, -837.7943872988577, -803.1347103705125, -133.55366590727863, -305.74790730343943, -28.24212410055757, -664.9714745900394, -897.5149781815015, -116.59110455923552, -806.019349981913, -881.0787143471342, -749.1238133201622, -115.93311938266113, -788.2924195363645, -700.7042270492248, -66.38312185777897, -870.3502377964571, -519.4704641168844, -530.1045358072922, -928.4440746837395, -924.0780031283583, -588.2549656925243, -706.5361645234958, -588.5689127143715, -18.565718958203252, -1188.8193900465258, -933.3247806913446, -1221.9013779940312, -1000.326198650391, -847.7668890492866, -951.2161655211737, -731.3865490818615, -583.0442996491211, -631.7550806140234, -569.1541225204727, -1077.2676282970683, -995.3305509471189, -700.5742337786361, -989.6056518458181, -371.903961017798, -842.8704844883367, -351.450961429062, -241.263580523481, -722.0916284945448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5622470196943649, "mean_inference_ms": 1.6812293029156127, "mean_action_processing_ms": 0.28246637575148326, "mean_env_wait_ms": 2.970126570756566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013946533203125, "StateBufferConnector_ms": 0.008477210998535156, "ViewRequirementAgentConnector_ms": 0.18761825561523438}, "num_episodes": 27, "episode_return_max": -18.565718958203252, "episode_return_min": -1221.9013779940312, "episode_return_mean": -695.640133549025, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.0560920501434, "num_env_steps_trained_throughput_per_sec": 302.0560920501434, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13109.824, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13109.749, "sample_time_ms": 1019.886, "learn_time_ms": 12021.634, "learn_throughput": 332.733, "synch_weights_time_ms": 67.355}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "f3b06_00008", "date": "2024-08-03_11-00-10", "timestamp": 1722663010, "time_this_iter_s": 13.255405187606812, "time_total_s": 52.49088501930237, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d3c70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.49088501930237, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.557894736842107, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.08729306459427, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.956422080347935, "policy_loss": -0.00994616955673943, "vf_loss": 4.97761073956887, "vf_explained_var": 0.8044919424379865, "kl": 0.015409811838738584, "entropy": 1.4324452699472507, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -18.565718958203252, "episode_reward_min": -1221.9013779940312, "episode_reward_mean": -679.5296561931998, "episode_len_mean": 136.68, "episode_media": {}, "episodes_timesteps_total": 13668, "policy_reward_min": {"policy_0": -1221.9013779940312}, "policy_reward_max": {"policy_0": -18.565718958203252}, "policy_reward_mean": {"policy_0": -679.5296561931998}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-628.2224193849862, -868.2032155088183, -127.01210654842896, -259.9986143056132, -1069.3777514490787, -897.5201225427644, -1073.4346367494854, -1070.2579477322058, -1110.0332811616956, -753.0192055826118, -836.1449196454582, -674.9488364234473, -247.68603860213048, -225.917364702326, -1034.849829527744, -145.89073258233952, -692.0137008831714, -739.1906830758203, -220.1746083585823, -755.1675183889091, -1220.5475697170884, -403.252979773953, -448.94026013671623, -926.0700513413889, -1126.1210404815308, -987.809647387571, -514.4486729417554, -848.9536007334078, -837.7943872988577, -803.1347103705125, -133.55366590727863, -305.74790730343943, -28.24212410055757, -664.9714745900394, -897.5149781815015, -116.59110455923552, -806.019349981913, -881.0787143471342, -749.1238133201622, -115.93311938266113, -788.2924195363645, -700.7042270492248, -66.38312185777897, -870.3502377964571, -519.4704641168844, -530.1045358072922, -928.4440746837395, -924.0780031283583, -588.2549656925243, -706.5361645234958, -588.5689127143715, -18.565718958203252, -1188.8193900465258, -933.3247806913446, -1221.9013779940312, -1000.326198650391, -847.7668890492866, -951.2161655211737, -731.3865490818615, -583.0442996491211, -631.7550806140234, -569.1541225204727, -1077.2676282970683, -995.3305509471189, -700.5742337786361, -989.6056518458181, -371.903961017798, -842.8704844883367, -351.450961429062, -241.263580523481, -722.0916284945448, -1180.3750568838902, -476.7579389362314, -867.6430190159081, -285.3962823597888, -864.506303676735, -755.7612393306727, -1075.6350992154848, -567.3898313956353, -681.0846373736117, -113.7176875716612, -567.6476382770778, -712.5192207427912, -685.4198957525059, -416.1263923117734, -1199.849703643864, -529.0744303163203, -1182.3740076571003, -995.4044304858352, -760.9296582199607, -749.3775551591045, -725.337471985724, -149.8824256163542, -395.5732077577119, -832.5431536220069, -87.99186279543271, -530.9844038847843, -483.6510276516609, -697.6992229964344, -956.5937291667984], "episode_lengths": [150, 150, 58, 107, 150, 150, 150, 150, 150, 150, 150, 138, 150, 103, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 90, 53, 150, 150, 61, 150, 150, 150, 64, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 95, 150, 144, 99, 150, 150, 122, 150, 92, 150, 150, 150, 120, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 108, 150, 72, 150, 150, 150, 150], "policy_policy_0_reward": [-628.2224193849862, -868.2032155088183, -127.01210654842896, -259.9986143056132, -1069.3777514490787, -897.5201225427644, -1073.4346367494854, -1070.2579477322058, -1110.0332811616956, -753.0192055826118, -836.1449196454582, -674.9488364234473, -247.68603860213048, -225.917364702326, -1034.849829527744, -145.89073258233952, -692.0137008831714, -739.1906830758203, -220.1746083585823, -755.1675183889091, -1220.5475697170884, -403.252979773953, -448.94026013671623, -926.0700513413889, -1126.1210404815308, -987.809647387571, -514.4486729417554, -848.9536007334078, -837.7943872988577, -803.1347103705125, -133.55366590727863, -305.74790730343943, -28.24212410055757, -664.9714745900394, -897.5149781815015, -116.59110455923552, -806.019349981913, -881.0787143471342, -749.1238133201622, -115.93311938266113, -788.2924195363645, -700.7042270492248, -66.38312185777897, -870.3502377964571, -519.4704641168844, -530.1045358072922, -928.4440746837395, -924.0780031283583, -588.2549656925243, -706.5361645234958, -588.5689127143715, -18.565718958203252, -1188.8193900465258, -933.3247806913446, -1221.9013779940312, -1000.326198650391, -847.7668890492866, -951.2161655211737, -731.3865490818615, -583.0442996491211, -631.7550806140234, -569.1541225204727, -1077.2676282970683, -995.3305509471189, -700.5742337786361, -989.6056518458181, -371.903961017798, -842.8704844883367, -351.450961429062, -241.263580523481, -722.0916284945448, -1180.3750568838902, -476.7579389362314, -867.6430190159081, -285.3962823597888, -864.506303676735, -755.7612393306727, -1075.6350992154848, -567.3898313956353, -681.0846373736117, -113.7176875716612, -567.6476382770778, -712.5192207427912, -685.4198957525059, -416.1263923117734, -1199.849703643864, -529.0744303163203, -1182.3740076571003, -995.4044304858352, -760.9296582199607, -749.3775551591045, -725.337471985724, -149.8824256163542, -395.5732077577119, -832.5431536220069, -87.99186279543271, -530.9844038847843, -483.6510276516609, -697.6992229964344, -956.5937291667984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5596116570718539, "mean_inference_ms": 1.6885749632806226, "mean_action_processing_ms": 0.2837628056387416, "mean_env_wait_ms": 2.974034539367385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013968944549560547, "StateBufferConnector_ms": 0.008759260177612305, "ViewRequirementAgentConnector_ms": 0.19327402114868164}, "num_episodes": 29, "episode_return_max": -18.565718958203252, "episode_return_min": -1221.9013779940312, "episode_return_mean": -679.5296561931998, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.1758448623475, "num_env_steps_trained_throughput_per_sec": 366.1758448623475, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12672.605, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12672.53, "sample_time_ms": 1021.601, "learn_time_ms": 11584.215, "learn_throughput": 345.297, "synch_weights_time_ms": 65.841}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "f3b06_00008", "date": "2024-08-03_11-00-21", "timestamp": 1722663021, "time_this_iter_s": 10.938669919967651, "time_total_s": 63.42955493927002, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f53520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 63.42955493927002, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 14.975000000000001, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 66.22904790639878, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.357714830338955, "policy_loss": -0.013848031098799158, "vf_loss": 4.383007110903661, "vf_explained_var": 0.8862701852495471, "kl": 0.015164157093856077, "entropy": 1.4477091091374557, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -6.005391313124098, "episode_reward_min": -1221.9013779940312, "episode_reward_mean": -653.2050936232575, "episode_len_mean": 134.24, "episode_media": {}, "episodes_timesteps_total": 13424, "policy_reward_min": {"policy_0": -1221.9013779940312}, "policy_reward_max": {"policy_0": -6.005391313124098}, "policy_reward_mean": {"policy_0": -653.2050936232575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-133.55366590727863, -305.74790730343943, -28.24212410055757, -664.9714745900394, -897.5149781815015, -116.59110455923552, -806.019349981913, -881.0787143471342, -749.1238133201622, -115.93311938266113, -788.2924195363645, -700.7042270492248, -66.38312185777897, -870.3502377964571, -519.4704641168844, -530.1045358072922, -928.4440746837395, -924.0780031283583, -588.2549656925243, -706.5361645234958, -588.5689127143715, -18.565718958203252, -1188.8193900465258, -933.3247806913446, -1221.9013779940312, -1000.326198650391, -847.7668890492866, -951.2161655211737, -731.3865490818615, -583.0442996491211, -631.7550806140234, -569.1541225204727, -1077.2676282970683, -995.3305509471189, -700.5742337786361, -989.6056518458181, -371.903961017798, -842.8704844883367, -351.450961429062, -241.263580523481, -722.0916284945448, -1180.3750568838902, -476.7579389362314, -867.6430190159081, -285.3962823597888, -864.506303676735, -755.7612393306727, -1075.6350992154848, -567.3898313956353, -681.0846373736117, -113.7176875716612, -567.6476382770778, -712.5192207427912, -685.4198957525059, -416.1263923117734, -1199.849703643864, -529.0744303163203, -1182.3740076571003, -995.4044304858352, -760.9296582199607, -749.3775551591045, -725.337471985724, -149.8824256163542, -395.5732077577119, -832.5431536220069, -87.99186279543271, -530.9844038847843, -483.6510276516609, -697.6992229964344, -956.5937291667984, -756.6734369764838, -579.2688145903348, -786.3090055060711, -706.0929484751053, -566.2374344333995, -435.5788873956164, -799.5743684367205, -484.5671078542377, -593.4006674547428, -759.9148681885674, -109.41545327782995, -806.9873563161702, -798.1417310575235, -244.98812561189112, -309.779426024251, -800.5944324430067, -1084.0460971275656, -364.8891574841798, -413.94552469221486, -100.62574600273858, -796.027000071888, -207.97857956424068, -1201.6019379319655, -1035.5010046318018, -495.55065147235354, -6.005391313124098, -656.755210771935, -829.4525001974024, -991.2161157954197, -1192.5612152453882], "episode_lengths": [69, 90, 53, 150, 150, 61, 150, 150, 150, 64, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 95, 150, 144, 99, 150, 150, 122, 150, 92, 150, 150, 150, 120, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 108, 150, 72, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 118, 150, 150, 53, 150, 150, 100, 150, 150, 150, 150, 102, 47, 150, 92, 150, 150, 150, 44, 150, 150, 150, 150], "policy_policy_0_reward": [-133.55366590727863, -305.74790730343943, -28.24212410055757, -664.9714745900394, -897.5149781815015, -116.59110455923552, -806.019349981913, -881.0787143471342, -749.1238133201622, -115.93311938266113, -788.2924195363645, -700.7042270492248, -66.38312185777897, -870.3502377964571, -519.4704641168844, -530.1045358072922, -928.4440746837395, -924.0780031283583, -588.2549656925243, -706.5361645234958, -588.5689127143715, -18.565718958203252, -1188.8193900465258, -933.3247806913446, -1221.9013779940312, -1000.326198650391, -847.7668890492866, -951.2161655211737, -731.3865490818615, -583.0442996491211, -631.7550806140234, -569.1541225204727, -1077.2676282970683, -995.3305509471189, -700.5742337786361, -989.6056518458181, -371.903961017798, -842.8704844883367, -351.450961429062, -241.263580523481, -722.0916284945448, -1180.3750568838902, -476.7579389362314, -867.6430190159081, -285.3962823597888, -864.506303676735, -755.7612393306727, -1075.6350992154848, -567.3898313956353, -681.0846373736117, -113.7176875716612, -567.6476382770778, -712.5192207427912, -685.4198957525059, -416.1263923117734, -1199.849703643864, -529.0744303163203, -1182.3740076571003, -995.4044304858352, -760.9296582199607, -749.3775551591045, -725.337471985724, -149.8824256163542, -395.5732077577119, -832.5431536220069, -87.99186279543271, -530.9844038847843, -483.6510276516609, -697.6992229964344, -956.5937291667984, -756.6734369764838, -579.2688145903348, -786.3090055060711, -706.0929484751053, -566.2374344333995, -435.5788873956164, -799.5743684367205, -484.5671078542377, -593.4006674547428, -759.9148681885674, -109.41545327782995, -806.9873563161702, -798.1417310575235, -244.98812561189112, -309.779426024251, -800.5944324430067, -1084.0460971275656, -364.8891574841798, -413.94552469221486, -100.62574600273858, -796.027000071888, -207.97857956424068, -1201.6019379319655, -1035.5010046318018, -495.55065147235354, -6.005391313124098, -656.755210771935, -829.4525001974024, -991.2161157954197, -1192.5612152453882]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5590318413501807, "mean_inference_ms": 1.6952434875500533, "mean_action_processing_ms": 0.2848938038195607, "mean_env_wait_ms": 2.978967120710993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013857841491699219, "StateBufferConnector_ms": 0.008788347244262695, "ViewRequirementAgentConnector_ms": 0.19314098358154297}, "num_episodes": 30, "episode_return_max": -6.005391313124098, "episode_return_min": -1221.9013779940312, "episode_return_mean": -653.2050936232575, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.6092926917857, "num_env_steps_trained_throughput_per_sec": 333.6092926917857, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12558.852, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12558.774, "sample_time_ms": 1022.069, "learn_time_ms": 11470.917, "learn_throughput": 348.708, "synch_weights_time_ms": 64.894}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "f3b06_00008", "date": "2024-08-03_11-00-33", "timestamp": 1722663033, "time_this_iter_s": 12.002846956253052, "time_total_s": 75.43240189552307, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f53400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 75.43240189552307, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 14.364705882352942, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 64.80529119968415, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.085178814083338, "policy_loss": -0.01173859506767864, "vf_loss": 4.108234226206938, "vf_explained_var": 0.9221088130647938, "kl": 0.01691759266726271, "entropy": 1.4700333375483752, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -6.005391313124098, "episode_reward_min": -1289.5458247149434, "episode_reward_mean": -643.2874968393858, "episode_len_mean": 135.96, "episode_media": {}, "episodes_timesteps_total": 13596, "policy_reward_min": {"policy_0": -1289.5458247149434}, "policy_reward_max": {"policy_0": -6.005391313124098}, "policy_reward_mean": {"policy_0": -643.2874968393858}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-569.1541225204727, -1077.2676282970683, -995.3305509471189, -700.5742337786361, -989.6056518458181, -371.903961017798, -842.8704844883367, -351.450961429062, -241.263580523481, -722.0916284945448, -1180.3750568838902, -476.7579389362314, -867.6430190159081, -285.3962823597888, -864.506303676735, -755.7612393306727, -1075.6350992154848, -567.3898313956353, -681.0846373736117, -113.7176875716612, -567.6476382770778, -712.5192207427912, -685.4198957525059, -416.1263923117734, -1199.849703643864, -529.0744303163203, -1182.3740076571003, -995.4044304858352, -760.9296582199607, -749.3775551591045, -725.337471985724, -149.8824256163542, -395.5732077577119, -832.5431536220069, -87.99186279543271, -530.9844038847843, -483.6510276516609, -697.6992229964344, -956.5937291667984, -756.6734369764838, -579.2688145903348, -786.3090055060711, -706.0929484751053, -566.2374344333995, -435.5788873956164, -799.5743684367205, -484.5671078542377, -593.4006674547428, -759.9148681885674, -109.41545327782995, -806.9873563161702, -798.1417310575235, -244.98812561189112, -309.779426024251, -800.5944324430067, -1084.0460971275656, -364.8891574841798, -413.94552469221486, -100.62574600273858, -796.027000071888, -207.97857956424068, -1201.6019379319655, -1035.5010046318018, -495.55065147235354, -6.005391313124098, -656.755210771935, -829.4525001974024, -991.2161157954197, -1192.5612152453882, -509.67850354902765, -389.5945436899595, -901.9806453608445, -165.7159938265745, -647.9143103411772, -895.5224139589094, -679.5211516308127, -330.5687841641846, -636.2807354195335, -447.33109272571653, -1241.7465064088426, -612.7170268043252, -390.753070276116, -1059.2109615188651, -925.096158528455, -489.21460027270535, -662.3653610543921, -1289.5458247149434, -190.62368251025296, -674.2346901338394, -634.6183551637035, -138.13680262286883, -777.9215500255604, -791.9030687168653, -365.0786327972864, -74.37253327037746, -484.9870603642929, -1109.2418387305174, -381.4631902735059, -957.9162942725306, -171.0547673222261], "episode_lengths": [150, 150, 150, 150, 150, 95, 150, 144, 99, 150, 150, 122, 150, 92, 150, 150, 150, 120, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 108, 150, 72, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 118, 150, 150, 53, 150, 150, 100, 150, 150, 150, 150, 102, 47, 150, 92, 150, 150, 150, 44, 150, 150, 150, 150, 150, 137, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 103, 150, 141, 85, 150, 150, 100, 70, 150, 150, 150, 150, 77], "policy_policy_0_reward": [-569.1541225204727, -1077.2676282970683, -995.3305509471189, -700.5742337786361, -989.6056518458181, -371.903961017798, -842.8704844883367, -351.450961429062, -241.263580523481, -722.0916284945448, -1180.3750568838902, -476.7579389362314, -867.6430190159081, -285.3962823597888, -864.506303676735, -755.7612393306727, -1075.6350992154848, -567.3898313956353, -681.0846373736117, -113.7176875716612, -567.6476382770778, -712.5192207427912, -685.4198957525059, -416.1263923117734, -1199.849703643864, -529.0744303163203, -1182.3740076571003, -995.4044304858352, -760.9296582199607, -749.3775551591045, -725.337471985724, -149.8824256163542, -395.5732077577119, -832.5431536220069, -87.99186279543271, -530.9844038847843, -483.6510276516609, -697.6992229964344, -956.5937291667984, -756.6734369764838, -579.2688145903348, -786.3090055060711, -706.0929484751053, -566.2374344333995, -435.5788873956164, -799.5743684367205, -484.5671078542377, -593.4006674547428, -759.9148681885674, -109.41545327782995, -806.9873563161702, -798.1417310575235, -244.98812561189112, -309.779426024251, -800.5944324430067, -1084.0460971275656, -364.8891574841798, -413.94552469221486, -100.62574600273858, -796.027000071888, -207.97857956424068, -1201.6019379319655, -1035.5010046318018, -495.55065147235354, -6.005391313124098, -656.755210771935, -829.4525001974024, -991.2161157954197, -1192.5612152453882, -509.67850354902765, -389.5945436899595, -901.9806453608445, -165.7159938265745, -647.9143103411772, -895.5224139589094, -679.5211516308127, -330.5687841641846, -636.2807354195335, -447.33109272571653, -1241.7465064088426, -612.7170268043252, -390.753070276116, -1059.2109615188651, -925.096158528455, -489.21460027270535, -662.3653610543921, -1289.5458247149434, -190.62368251025296, -674.2346901338394, -634.6183551637035, -138.13680262286883, -777.9215500255604, -791.9030687168653, -365.0786327972864, -74.37253327037746, -484.9870603642929, -1109.2418387305174, -381.4631902735059, -957.9162942725306, -171.0547673222261]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5585652528879068, "mean_inference_ms": 1.6996509678639617, "mean_action_processing_ms": 0.2854986434028485, "mean_env_wait_ms": 2.9856689825273866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013676881790161133, "StateBufferConnector_ms": 0.008733034133911133, "ViewRequirementAgentConnector_ms": 0.1987776756286621}, "num_episodes": 31, "episode_return_max": -6.005391313124098, "episode_return_min": -1289.5458247149434, "episode_return_mean": -643.2874968393858, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.22390993655705, "num_env_steps_trained_throughput_per_sec": 301.22390993655705, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12661.755, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12661.679, "sample_time_ms": 1022.764, "learn_time_ms": 11574.132, "learn_throughput": 345.598, "synch_weights_time_ms": 63.908}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "f3b06_00008", "date": "2024-08-03_11-00-46", "timestamp": 1722663046, "time_this_iter_s": 13.291649580001831, "time_total_s": 88.7240514755249, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f53e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 88.7240514755249, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.478947368421053, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 88.5893121957779, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.9277110185474156, "policy_loss": -0.01272824115488523, "vf_loss": 3.9520142763853072, "vf_explained_var": 0.9469078985974193, "kl": 0.01965233370468317, "entropy": 1.5505485796680054, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -6.005391313124098, "episode_reward_min": -1289.5458247149434, "episode_reward_mean": -621.6485972694021, "episode_len_mean": 133.4, "episode_media": {}, "episodes_timesteps_total": 13340, "policy_reward_min": {"policy_0": -1289.5458247149434}, "policy_reward_max": {"policy_0": -6.005391313124098}, "policy_reward_mean": {"policy_0": -621.6485972694021}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-760.9296582199607, -749.3775551591045, -725.337471985724, -149.8824256163542, -395.5732077577119, -832.5431536220069, -87.99186279543271, -530.9844038847843, -483.6510276516609, -697.6992229964344, -956.5937291667984, -756.6734369764838, -579.2688145903348, -786.3090055060711, -706.0929484751053, -566.2374344333995, -435.5788873956164, -799.5743684367205, -484.5671078542377, -593.4006674547428, -759.9148681885674, -109.41545327782995, -806.9873563161702, -798.1417310575235, -244.98812561189112, -309.779426024251, -800.5944324430067, -1084.0460971275656, -364.8891574841798, -413.94552469221486, -100.62574600273858, -796.027000071888, -207.97857956424068, -1201.6019379319655, -1035.5010046318018, -495.55065147235354, -6.005391313124098, -656.755210771935, -829.4525001974024, -991.2161157954197, -1192.5612152453882, -509.67850354902765, -389.5945436899595, -901.9806453608445, -165.7159938265745, -647.9143103411772, -895.5224139589094, -679.5211516308127, -330.5687841641846, -636.2807354195335, -447.33109272571653, -1241.7465064088426, -612.7170268043252, -390.753070276116, -1059.2109615188651, -925.096158528455, -489.21460027270535, -662.3653610543921, -1289.5458247149434, -190.62368251025296, -674.2346901338394, -634.6183551637035, -138.13680262286883, -777.9215500255604, -791.9030687168653, -365.0786327972864, -74.37253327037746, -484.9870603642929, -1109.2418387305174, -381.4631902735059, -957.9162942725306, -171.0547673222261, -892.1780859149926, -1100.2076633248748, -224.68931735545831, -100.95219777585557, -1121.4113872374915, -337.49393059873404, -544.0943688001422, -886.0547018031608, -973.8935140079291, -881.9650684263564, -136.7274950501812, -622.85138132798, -229.30351691787908, -48.403356119017054, -1173.7500599994514, -1041.6538487314403, -1224.081182200891, -923.0933827135209, -665.8528811921867, -91.75670928177252, -148.1941090331499, -802.5574718247688, -760.7289040816196, -775.7657832822887, -390.14064253856765, -1002.6087566402651, -152.45000606163393, -601.4459390492485], "episode_lengths": [150, 150, 150, 108, 108, 150, 72, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 118, 150, 150, 53, 150, 150, 100, 150, 150, 150, 150, 102, 47, 150, 92, 150, 150, 150, 44, 150, 150, 150, 150, 150, 137, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 103, 150, 141, 85, 150, 150, 100, 70, 150, 150, 150, 150, 77, 150, 150, 83, 90, 150, 144, 140, 150, 150, 150, 150, 150, 74, 61, 150, 150, 150, 150, 150, 47, 87, 150, 150, 150, 119, 150, 98, 150], "policy_policy_0_reward": [-760.9296582199607, -749.3775551591045, -725.337471985724, -149.8824256163542, -395.5732077577119, -832.5431536220069, -87.99186279543271, -530.9844038847843, -483.6510276516609, -697.6992229964344, -956.5937291667984, -756.6734369764838, -579.2688145903348, -786.3090055060711, -706.0929484751053, -566.2374344333995, -435.5788873956164, -799.5743684367205, -484.5671078542377, -593.4006674547428, -759.9148681885674, -109.41545327782995, -806.9873563161702, -798.1417310575235, -244.98812561189112, -309.779426024251, -800.5944324430067, -1084.0460971275656, -364.8891574841798, -413.94552469221486, -100.62574600273858, -796.027000071888, -207.97857956424068, -1201.6019379319655, -1035.5010046318018, -495.55065147235354, -6.005391313124098, -656.755210771935, -829.4525001974024, -991.2161157954197, -1192.5612152453882, -509.67850354902765, -389.5945436899595, -901.9806453608445, -165.7159938265745, -647.9143103411772, -895.5224139589094, -679.5211516308127, -330.5687841641846, -636.2807354195335, -447.33109272571653, -1241.7465064088426, -612.7170268043252, -390.753070276116, -1059.2109615188651, -925.096158528455, -489.21460027270535, -662.3653610543921, -1289.5458247149434, -190.62368251025296, -674.2346901338394, -634.6183551637035, -138.13680262286883, -777.9215500255604, -791.9030687168653, -365.0786327972864, -74.37253327037746, -484.9870603642929, -1109.2418387305174, -381.4631902735059, -957.9162942725306, -171.0547673222261, -892.1780859149926, -1100.2076633248748, -224.68931735545831, -100.95219777585557, -1121.4113872374915, -337.49393059873404, -544.0943688001422, -886.0547018031608, -973.8935140079291, -881.9650684263564, -136.7274950501812, -622.85138132798, -229.30351691787908, -48.403356119017054, -1173.7500599994514, -1041.6538487314403, -1224.081182200891, -923.0933827135209, -665.8528811921867, -91.75670928177252, -148.1941090331499, -802.5574718247688, -760.7289040816196, -775.7657832822887, -390.14064253856765, -1002.6087566402651, -152.45000606163393, -601.4459390492485]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5582167689588765, "mean_inference_ms": 1.7022297966291082, "mean_action_processing_ms": 0.2855287104722568, "mean_env_wait_ms": 2.99180783962089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013320684432983398, "StateBufferConnector_ms": 0.008496522903442383, "ViewRequirementAgentConnector_ms": 0.19771933555603027}, "num_episodes": 28, "episode_return_max": -6.005391313124098, "episode_return_min": -1289.5458247149434, "episode_return_mean": -621.6485972694021, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.22070068669905, "num_env_steps_trained_throughput_per_sec": 297.22070068669905, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12761.289, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12761.211, "sample_time_ms": 1022.122, "learn_time_ms": 11673.551, "learn_throughput": 342.655, "synch_weights_time_ms": 64.666}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "f3b06_00008", "date": "2024-08-03_11-01-00", "timestamp": 1722663060, "time_this_iter_s": 13.47045111656189, "time_total_s": 102.19450259208679, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f52c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.19450259208679, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.536842105263156, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 83.28463887572289, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.8626617987950644, "policy_loss": -0.017158597109179632, "vf_loss": 3.8917049224177998, "vf_explained_var": 0.9501028774306178, "kl": 0.01894687095414156, "entropy": 1.567389129474759, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -6.005391313124098, "episode_reward_min": -1289.5458247149434, "episode_reward_mean": -651.3751036942783, "episode_len_mean": 134.04, "episode_media": {}, "episodes_timesteps_total": 13404, "policy_reward_min": {"policy_0": -1289.5458247149434}, "policy_reward_max": {"policy_0": -6.005391313124098}, "policy_reward_mean": {"policy_0": -651.3751036942783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1201.6019379319655, -1035.5010046318018, -495.55065147235354, -6.005391313124098, -656.755210771935, -829.4525001974024, -991.2161157954197, -1192.5612152453882, -509.67850354902765, -389.5945436899595, -901.9806453608445, -165.7159938265745, -647.9143103411772, -895.5224139589094, -679.5211516308127, -330.5687841641846, -636.2807354195335, -447.33109272571653, -1241.7465064088426, -612.7170268043252, -390.753070276116, -1059.2109615188651, -925.096158528455, -489.21460027270535, -662.3653610543921, -1289.5458247149434, -190.62368251025296, -674.2346901338394, -634.6183551637035, -138.13680262286883, -777.9215500255604, -791.9030687168653, -365.0786327972864, -74.37253327037746, -484.9870603642929, -1109.2418387305174, -381.4631902735059, -957.9162942725306, -171.0547673222261, -892.1780859149926, -1100.2076633248748, -224.68931735545831, -100.95219777585557, -1121.4113872374915, -337.49393059873404, -544.0943688001422, -886.0547018031608, -973.8935140079291, -881.9650684263564, -136.7274950501812, -622.85138132798, -229.30351691787908, -48.403356119017054, -1173.7500599994514, -1041.6538487314403, -1224.081182200891, -923.0933827135209, -665.8528811921867, -91.75670928177252, -148.1941090331499, -802.5574718247688, -760.7289040816196, -775.7657832822887, -390.14064253856765, -1002.6087566402651, -152.45000606163393, -601.4459390492485, -576.9913070247642, -25.2550754045692, -632.8237142816417, -974.7713783481456, -509.5693978485853, -382.17106386464286, -1277.9628396501166, -822.5086569747147, -85.56944350419104, -1038.1196632843669, -1039.0039088731335, -982.8052589099655, -341.64883210344254, -826.4127377354537, -659.7153885788422, -454.58146833852436, -1090.63427445991, -102.80220050888742, -1181.4720604069282, -896.6568922663346, -448.32626867650646, -47.10584237244781, -583.5119065927664, -795.6026376935318, -1122.939141356309, -502.5364952876885, -895.2728125745377, -609.5380019899795, -607.2932990857942, -220.4565489753959, -870.837799504452, -667.96382181159, -575.3903920402262], "episode_lengths": [150, 150, 150, 44, 150, 150, 150, 150, 150, 137, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 103, 150, 141, 85, 150, 150, 100, 70, 150, 150, 150, 150, 77, 150, 150, 83, 90, 150, 144, 140, 150, 150, 150, 150, 150, 74, 61, 150, 150, 150, 150, 150, 47, 87, 150, 150, 150, 119, 150, 98, 150, 150, 51, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 95, 150, 150, 150, 150, 93, 150, 150, 110, 53, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150], "policy_policy_0_reward": [-1201.6019379319655, -1035.5010046318018, -495.55065147235354, -6.005391313124098, -656.755210771935, -829.4525001974024, -991.2161157954197, -1192.5612152453882, -509.67850354902765, -389.5945436899595, -901.9806453608445, -165.7159938265745, -647.9143103411772, -895.5224139589094, -679.5211516308127, -330.5687841641846, -636.2807354195335, -447.33109272571653, -1241.7465064088426, -612.7170268043252, -390.753070276116, -1059.2109615188651, -925.096158528455, -489.21460027270535, -662.3653610543921, -1289.5458247149434, -190.62368251025296, -674.2346901338394, -634.6183551637035, -138.13680262286883, -777.9215500255604, -791.9030687168653, -365.0786327972864, -74.37253327037746, -484.9870603642929, -1109.2418387305174, -381.4631902735059, -957.9162942725306, -171.0547673222261, -892.1780859149926, -1100.2076633248748, -224.68931735545831, -100.95219777585557, -1121.4113872374915, -337.49393059873404, -544.0943688001422, -886.0547018031608, -973.8935140079291, -881.9650684263564, -136.7274950501812, -622.85138132798, -229.30351691787908, -48.403356119017054, -1173.7500599994514, -1041.6538487314403, -1224.081182200891, -923.0933827135209, -665.8528811921867, -91.75670928177252, -148.1941090331499, -802.5574718247688, -760.7289040816196, -775.7657832822887, -390.14064253856765, -1002.6087566402651, -152.45000606163393, -601.4459390492485, -576.9913070247642, -25.2550754045692, -632.8237142816417, -974.7713783481456, -509.5693978485853, -382.17106386464286, -1277.9628396501166, -822.5086569747147, -85.56944350419104, -1038.1196632843669, -1039.0039088731335, -982.8052589099655, -341.64883210344254, -826.4127377354537, -659.7153885788422, -454.58146833852436, -1090.63427445991, -102.80220050888742, -1181.4720604069282, -896.6568922663346, -448.32626867650646, -47.10584237244781, -583.5119065927664, -795.6026376935318, -1122.939141356309, -502.5364952876885, -895.2728125745377, -609.5380019899795, -607.2932990857942, -220.4565489753959, -870.837799504452, -667.96382181159, -575.3903920402262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5563913975048502, "mean_inference_ms": 1.6974801507371047, "mean_action_processing_ms": 0.2841602718937594, "mean_env_wait_ms": 2.9943029763155575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012493133544921875, "StateBufferConnector_ms": 0.008255481719970703, "ViewRequirementAgentConnector_ms": 0.1973247528076172}, "num_episodes": 33, "episode_return_max": -6.005391313124098, "episode_return_min": -1289.5458247149434, "episode_return_mean": -651.3751036942783, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.7445992879646, "num_env_steps_trained_throughput_per_sec": 303.7445992879646, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12806.587, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12806.51, "sample_time_ms": 1023.231, "learn_time_ms": 11718.29, "learn_throughput": 341.347, "synch_weights_time_ms": 64.118}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "f3b06_00008", "date": "2024-08-03_11-01-13", "timestamp": 1722663073, "time_this_iter_s": 13.181380033493042, "time_total_s": 115.37588262557983, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f52d40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.37588262557983, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.142105263157896, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.16878663202127, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.4703379690647127, "policy_loss": -0.015674381447024644, "vf_loss": 3.497448765486479, "vf_explained_var": 0.9710511568933725, "kl": 0.01662506891480007, "entropy": 1.4761428014685711, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -24.308116535662922, "episode_reward_min": -1305.8229315386836, "episode_reward_mean": -624.222615097203, "episode_len_mean": 129.69, "episode_media": {}, "episodes_timesteps_total": 12969, "policy_reward_min": {"policy_0": -1305.8229315386836}, "policy_reward_max": {"policy_0": -24.308116535662922}, "policy_reward_mean": {"policy_0": -624.222615097203}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-791.9030687168653, -365.0786327972864, -74.37253327037746, -484.9870603642929, -1109.2418387305174, -381.4631902735059, -957.9162942725306, -171.0547673222261, -892.1780859149926, -1100.2076633248748, -224.68931735545831, -100.95219777585557, -1121.4113872374915, -337.49393059873404, -544.0943688001422, -886.0547018031608, -973.8935140079291, -881.9650684263564, -136.7274950501812, -622.85138132798, -229.30351691787908, -48.403356119017054, -1173.7500599994514, -1041.6538487314403, -1224.081182200891, -923.0933827135209, -665.8528811921867, -91.75670928177252, -148.1941090331499, -802.5574718247688, -760.7289040816196, -775.7657832822887, -390.14064253856765, -1002.6087566402651, -152.45000606163393, -601.4459390492485, -576.9913070247642, -25.2550754045692, -632.8237142816417, -974.7713783481456, -509.5693978485853, -382.17106386464286, -1277.9628396501166, -822.5086569747147, -85.56944350419104, -1038.1196632843669, -1039.0039088731335, -982.8052589099655, -341.64883210344254, -826.4127377354537, -659.7153885788422, -454.58146833852436, -1090.63427445991, -102.80220050888742, -1181.4720604069282, -896.6568922663346, -448.32626867650646, -47.10584237244781, -583.5119065927664, -795.6026376935318, -1122.939141356309, -502.5364952876885, -895.2728125745377, -609.5380019899795, -607.2932990857942, -220.4565489753959, -870.837799504452, -667.96382181159, -575.3903920402262, -710.4786784192422, -693.2808254555968, -1291.8646288390985, -791.817757745514, -837.2060622812152, -735.774474283959, -954.856427360086, -61.14159511502466, -201.06831254462384, -640.4475713608484, -785.9996756731257, -775.6504719805738, -740.3289715184186, -1074.4172173840777, -718.0317238024119, -533.5675238247786, -670.3036704875808, -561.531713494019, -40.60807596164267, -99.04143743693962, -1007.4408812050824, -41.92355243830954, -109.04977006673458, -419.94741331847274, -918.6920352756711, -24.308116535662922, -771.3926663299209, -432.8731512603425, -308.95701714113824, -1305.8229315386836, -125.86358227464927], "episode_lengths": [150, 100, 70, 150, 150, 150, 150, 77, 150, 150, 83, 90, 150, 144, 140, 150, 150, 150, 150, 150, 74, 61, 150, 150, 150, 150, 150, 47, 87, 150, 150, 150, 119, 150, 98, 150, 150, 51, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 95, 150, 150, 150, 150, 93, 150, 150, 110, 53, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 47, 150, 56, 67, 150, 150, 53, 150, 137, 99, 150, 67], "policy_policy_0_reward": [-791.9030687168653, -365.0786327972864, -74.37253327037746, -484.9870603642929, -1109.2418387305174, -381.4631902735059, -957.9162942725306, -171.0547673222261, -892.1780859149926, -1100.2076633248748, -224.68931735545831, -100.95219777585557, -1121.4113872374915, -337.49393059873404, -544.0943688001422, -886.0547018031608, -973.8935140079291, -881.9650684263564, -136.7274950501812, -622.85138132798, -229.30351691787908, -48.403356119017054, -1173.7500599994514, -1041.6538487314403, -1224.081182200891, -923.0933827135209, -665.8528811921867, -91.75670928177252, -148.1941090331499, -802.5574718247688, -760.7289040816196, -775.7657832822887, -390.14064253856765, -1002.6087566402651, -152.45000606163393, -601.4459390492485, -576.9913070247642, -25.2550754045692, -632.8237142816417, -974.7713783481456, -509.5693978485853, -382.17106386464286, -1277.9628396501166, -822.5086569747147, -85.56944350419104, -1038.1196632843669, -1039.0039088731335, -982.8052589099655, -341.64883210344254, -826.4127377354537, -659.7153885788422, -454.58146833852436, -1090.63427445991, -102.80220050888742, -1181.4720604069282, -896.6568922663346, -448.32626867650646, -47.10584237244781, -583.5119065927664, -795.6026376935318, -1122.939141356309, -502.5364952876885, -895.2728125745377, -609.5380019899795, -607.2932990857942, -220.4565489753959, -870.837799504452, -667.96382181159, -575.3903920402262, -710.4786784192422, -693.2808254555968, -1291.8646288390985, -791.817757745514, -837.2060622812152, -735.774474283959, -954.856427360086, -61.14159511502466, -201.06831254462384, -640.4475713608484, -785.9996756731257, -775.6504719805738, -740.3289715184186, -1074.4172173840777, -718.0317238024119, -533.5675238247786, -670.3036704875808, -561.531713494019, -40.60807596164267, -99.04143743693962, -1007.4408812050824, -41.92355243830954, -109.04977006673458, -419.94741331847274, -918.6920352756711, -24.308116535662922, -771.3926663299209, -432.8731512603425, -308.95701714113824, -1305.8229315386836, -125.86358227464927]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553276727067604, "mean_inference_ms": 1.6956776178504651, "mean_action_processing_ms": 0.2831546757151654, "mean_env_wait_ms": 2.996664527688674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01226043701171875, "StateBufferConnector_ms": 0.008063793182373047, "ViewRequirementAgentConnector_ms": 0.19519281387329102}, "num_episodes": 31, "episode_return_max": -24.308116535662922, "episode_return_min": -1305.8229315386836, "episode_return_mean": -624.222615097203, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.66020657533346, "num_env_steps_trained_throughput_per_sec": 297.66020657533346, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12869.744, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12869.667, "sample_time_ms": 1039.121, "learn_time_ms": 11765.181, "learn_throughput": 339.986, "synch_weights_time_ms": 64.495}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "f3b06_00008", "date": "2024-08-03_11-01-26", "timestamp": 1722663086, "time_this_iter_s": 13.450774669647217, "time_total_s": 128.82665729522705, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c574b80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 128.82665729522705, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.852631578947367, "ram_util_percent": 27.694736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 119.21368552446366, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.289802648499608, "policy_loss": -0.013576853055080088, "vf_loss": 3.3164283094306786, "vf_explained_var": 0.9796544110402465, "kl": 0.01730308902297112, "entropy": 1.6509416289627552, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -24.308116535662922, "episode_reward_min": -1305.8229315386836, "episode_reward_mean": -639.5361845905722, "episode_len_mean": 132.59, "episode_media": {}, "episodes_timesteps_total": 13259, "policy_reward_min": {"policy_0": -1305.8229315386836}, "policy_reward_max": {"policy_0": -24.308116535662922}, "policy_reward_mean": {"policy_0": -639.5361845905722}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-760.7289040816196, -775.7657832822887, -390.14064253856765, -1002.6087566402651, -152.45000606163393, -601.4459390492485, -576.9913070247642, -25.2550754045692, -632.8237142816417, -974.7713783481456, -509.5693978485853, -382.17106386464286, -1277.9628396501166, -822.5086569747147, -85.56944350419104, -1038.1196632843669, -1039.0039088731335, -982.8052589099655, -341.64883210344254, -826.4127377354537, -659.7153885788422, -454.58146833852436, -1090.63427445991, -102.80220050888742, -1181.4720604069282, -896.6568922663346, -448.32626867650646, -47.10584237244781, -583.5119065927664, -795.6026376935318, -1122.939141356309, -502.5364952876885, -895.2728125745377, -609.5380019899795, -607.2932990857942, -220.4565489753959, -870.837799504452, -667.96382181159, -575.3903920402262, -710.4786784192422, -693.2808254555968, -1291.8646288390985, -791.817757745514, -837.2060622812152, -735.774474283959, -954.856427360086, -61.14159511502466, -201.06831254462384, -640.4475713608484, -785.9996756731257, -775.6504719805738, -740.3289715184186, -1074.4172173840777, -718.0317238024119, -533.5675238247786, -670.3036704875808, -561.531713494019, -40.60807596164267, -99.04143743693962, -1007.4408812050824, -41.92355243830954, -109.04977006673458, -419.94741331847274, -918.6920352756711, -24.308116535662922, -771.3926663299209, -432.8731512603425, -308.95701714113824, -1305.8229315386836, -125.86358227464927, -881.7428785924917, -1126.6707034868434, -181.951793967898, -765.6262589003612, -1087.540640987172, -534.1531388256733, -723.38471349288, -65.1932425699676, -253.07936538332544, -471.64098570845704, -607.3021719577733, -1021.311419669691, -1239.3873220399996, -632.9175001724097, -806.6729052297195, -1126.9565911273983, -906.6598971607498, -1138.3901092138753, -878.7495744518503, -415.19170439137787, -216.48697569218774, -548.3080556809241, -658.8819032430439, -962.1997318656015, -460.4259048955648, -443.85877254522956, -59.90275351764665, -969.7745817132939, -486.847434511242, -367.3309337271291], "episode_lengths": [150, 150, 119, 150, 98, 150, 150, 51, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 95, 150, 150, 150, 150, 93, 150, 150, 110, 53, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 47, 150, 56, 67, 150, 150, 53, 150, 137, 99, 150, 67, 150, 150, 92, 150, 150, 146, 150, 66, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 150, 120, 150, 63, 150, 150, 150], "policy_policy_0_reward": [-760.7289040816196, -775.7657832822887, -390.14064253856765, -1002.6087566402651, -152.45000606163393, -601.4459390492485, -576.9913070247642, -25.2550754045692, -632.8237142816417, -974.7713783481456, -509.5693978485853, -382.17106386464286, -1277.9628396501166, -822.5086569747147, -85.56944350419104, -1038.1196632843669, -1039.0039088731335, -982.8052589099655, -341.64883210344254, -826.4127377354537, -659.7153885788422, -454.58146833852436, -1090.63427445991, -102.80220050888742, -1181.4720604069282, -896.6568922663346, -448.32626867650646, -47.10584237244781, -583.5119065927664, -795.6026376935318, -1122.939141356309, -502.5364952876885, -895.2728125745377, -609.5380019899795, -607.2932990857942, -220.4565489753959, -870.837799504452, -667.96382181159, -575.3903920402262, -710.4786784192422, -693.2808254555968, -1291.8646288390985, -791.817757745514, -837.2060622812152, -735.774474283959, -954.856427360086, -61.14159511502466, -201.06831254462384, -640.4475713608484, -785.9996756731257, -775.6504719805738, -740.3289715184186, -1074.4172173840777, -718.0317238024119, -533.5675238247786, -670.3036704875808, -561.531713494019, -40.60807596164267, -99.04143743693962, -1007.4408812050824, -41.92355243830954, -109.04977006673458, -419.94741331847274, -918.6920352756711, -24.308116535662922, -771.3926663299209, -432.8731512603425, -308.95701714113824, -1305.8229315386836, -125.86358227464927, -881.7428785924917, -1126.6707034868434, -181.951793967898, -765.6262589003612, -1087.540640987172, -534.1531388256733, -723.38471349288, -65.1932425699676, -253.07936538332544, -471.64098570845704, -607.3021719577733, -1021.311419669691, -1239.3873220399996, -632.9175001724097, -806.6729052297195, -1126.9565911273983, -906.6598971607498, -1138.3901092138753, -878.7495744518503, -415.19170439137787, -216.48697569218774, -548.3080556809241, -658.8819032430439, -962.1997318656015, -460.4259048955648, -443.85877254522956, -59.90275351764665, -969.7745817132939, -486.847434511242, -367.3309337271291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549324237981232, "mean_inference_ms": 1.6954541024852683, "mean_action_processing_ms": 0.28266999432180706, "mean_env_wait_ms": 3.000553995643311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012558460235595703, "StateBufferConnector_ms": 0.008202791213989258, "ViewRequirementAgentConnector_ms": 0.19854164123535156}, "num_episodes": 30, "episode_return_max": -24.308116535662922, "episode_return_min": -1305.8229315386836, "episode_return_mean": -639.5361845905722, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.9934643788865, "num_env_steps_trained_throughput_per_sec": 327.9934643788865, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12780.132, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12780.054, "sample_time_ms": 1040.519, "learn_time_ms": 11674.732, "learn_throughput": 342.62, "synch_weights_time_ms": 63.937}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "f3b06_00008", "date": "2024-08-03_11-01-39", "timestamp": 1722663099, "time_this_iter_s": 12.209250211715698, "time_total_s": 141.03590750694275, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f52c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 141.03590750694275, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 13.744444444444444, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 135.0020496716102, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.562371689702074, "policy_loss": -0.012641855978775615, "vf_loss": 2.5888258747756483, "vf_explained_var": 0.9818023343880972, "kl": 0.01762146166410427, "entropy": 1.7336634953816732, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -24.308116535662922, "episode_reward_min": -1336.6025683680039, "episode_reward_mean": -671.7927158543702, "episode_len_mean": 133.38, "episode_media": {}, "episodes_timesteps_total": 13338, "policy_reward_min": {"policy_0": -1336.6025683680039}, "policy_reward_max": {"policy_0": -24.308116535662922}, "policy_reward_mean": {"policy_0": -671.7927158543702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-47.10584237244781, -583.5119065927664, -795.6026376935318, -1122.939141356309, -502.5364952876885, -895.2728125745377, -609.5380019899795, -607.2932990857942, -220.4565489753959, -870.837799504452, -667.96382181159, -575.3903920402262, -710.4786784192422, -693.2808254555968, -1291.8646288390985, -791.817757745514, -837.2060622812152, -735.774474283959, -954.856427360086, -61.14159511502466, -201.06831254462384, -640.4475713608484, -785.9996756731257, -775.6504719805738, -740.3289715184186, -1074.4172173840777, -718.0317238024119, -533.5675238247786, -670.3036704875808, -561.531713494019, -40.60807596164267, -99.04143743693962, -1007.4408812050824, -41.92355243830954, -109.04977006673458, -419.94741331847274, -918.6920352756711, -24.308116535662922, -771.3926663299209, -432.8731512603425, -308.95701714113824, -1305.8229315386836, -125.86358227464927, -881.7428785924917, -1126.6707034868434, -181.951793967898, -765.6262589003612, -1087.540640987172, -534.1531388256733, -723.38471349288, -65.1932425699676, -253.07936538332544, -471.64098570845704, -607.3021719577733, -1021.311419669691, -1239.3873220399996, -632.9175001724097, -806.6729052297195, -1126.9565911273983, -906.6598971607498, -1138.3901092138753, -878.7495744518503, -415.19170439137787, -216.48697569218774, -548.3080556809241, -658.8819032430439, -962.1997318656015, -460.4259048955648, -443.85877254522956, -59.90275351764665, -969.7745817132939, -486.847434511242, -367.3309337271291, -439.2449463602274, -754.0250808529034, -789.3620413521156, -795.7080007152645, -25.650232517391398, -913.9775605704929, -798.8583187234336, -1094.3659408951428, -1082.4868846979386, -930.0905125592528, -998.497208743645, -407.0741421194675, -1072.0677059539612, -146.68774126266288, -1052.2696511899117, -994.6476751420298, -921.446361381966, -811.6363353426725, -141.6204774394346, -692.3505153827919, -764.5833801497541, -345.00353970901807, -1077.7955639090267, -1336.6025683680039, -713.7369648204035, -1151.2852723563087, -1007.5203665618603], "episode_lengths": [53, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 98, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 47, 150, 56, 67, 150, 150, 53, 150, 137, 99, 150, 67, 150, 150, 92, 150, 150, 146, 150, 66, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 150, 120, 150, 63, 150, 150, 150, 142, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 105, 150, 65, 150, 150, 150, 150, 62, 150, 150, 136, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-47.10584237244781, -583.5119065927664, -795.6026376935318, -1122.939141356309, -502.5364952876885, -895.2728125745377, -609.5380019899795, -607.2932990857942, -220.4565489753959, -870.837799504452, -667.96382181159, -575.3903920402262, -710.4786784192422, -693.2808254555968, -1291.8646288390985, -791.817757745514, -837.2060622812152, -735.774474283959, -954.856427360086, -61.14159511502466, -201.06831254462384, -640.4475713608484, -785.9996756731257, -775.6504719805738, -740.3289715184186, -1074.4172173840777, -718.0317238024119, -533.5675238247786, -670.3036704875808, -561.531713494019, -40.60807596164267, -99.04143743693962, -1007.4408812050824, -41.92355243830954, -109.04977006673458, -419.94741331847274, -918.6920352756711, -24.308116535662922, -771.3926663299209, -432.8731512603425, -308.95701714113824, -1305.8229315386836, -125.86358227464927, -881.7428785924917, -1126.6707034868434, -181.951793967898, -765.6262589003612, -1087.540640987172, -534.1531388256733, -723.38471349288, -65.1932425699676, -253.07936538332544, -471.64098570845704, -607.3021719577733, -1021.311419669691, -1239.3873220399996, -632.9175001724097, -806.6729052297195, -1126.9565911273983, -906.6598971607498, -1138.3901092138753, -878.7495744518503, -415.19170439137787, -216.48697569218774, -548.3080556809241, -658.8819032430439, -962.1997318656015, -460.4259048955648, -443.85877254522956, -59.90275351764665, -969.7745817132939, -486.847434511242, -367.3309337271291, -439.2449463602274, -754.0250808529034, -789.3620413521156, -795.7080007152645, -25.650232517391398, -913.9775605704929, -798.8583187234336, -1094.3659408951428, -1082.4868846979386, -930.0905125592528, -998.497208743645, -407.0741421194675, -1072.0677059539612, -146.68774126266288, -1052.2696511899117, -994.6476751420298, -921.446361381966, -811.6363353426725, -141.6204774394346, -692.3505153827919, -764.5833801497541, -345.00353970901807, -1077.7955639090267, -1336.6025683680039, -713.7369648204035, -1151.2852723563087, -1007.5203665618603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551313675057712, "mean_inference_ms": 1.6974866537308422, "mean_action_processing_ms": 0.28284020442472096, "mean_env_wait_ms": 3.007408442566214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012628316879272461, "StateBufferConnector_ms": 0.008221149444580078, "ViewRequirementAgentConnector_ms": 0.20056509971618652}, "num_episodes": 27, "episode_return_max": -24.308116535662922, "episode_return_min": -1336.6025683680039, "episode_return_mean": -671.7927158543702, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.32658865340767, "num_env_steps_trained_throughput_per_sec": 300.32658865340767, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12845.084, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12845.006, "sample_time_ms": 1043.452, "learn_time_ms": 11737.054, "learn_throughput": 340.801, "synch_weights_time_ms": 63.641}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "f3b06_00008", "date": "2024-08-03_11-01-52", "timestamp": 1722663112, "time_this_iter_s": 13.331610918045044, "time_total_s": 154.3675184249878, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246facaf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 154.3675184249878, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.442105263157895, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.03970084786414, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.4649193234120808, "policy_loss": -0.01191693346821315, "vf_loss": 2.48960224793603, "vf_explained_var": 0.9865217770139376, "kl": 0.016618993190907847, "entropy": 1.6089789771785339, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -24.308116535662922, "episode_reward_min": -1336.6025683680039, "episode_reward_mean": -694.7431981268331, "episode_len_mean": 133.79, "episode_media": {}, "episodes_timesteps_total": 13379, "policy_reward_min": {"policy_0": -1336.6025683680039}, "policy_reward_max": {"policy_0": -24.308116535662922}, "policy_reward_mean": {"policy_0": -694.7431981268331}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.04143743693962, -1007.4408812050824, -41.92355243830954, -109.04977006673458, -419.94741331847274, -918.6920352756711, -24.308116535662922, -771.3926663299209, -432.8731512603425, -308.95701714113824, -1305.8229315386836, -125.86358227464927, -881.7428785924917, -1126.6707034868434, -181.951793967898, -765.6262589003612, -1087.540640987172, -534.1531388256733, -723.38471349288, -65.1932425699676, -253.07936538332544, -471.64098570845704, -607.3021719577733, -1021.311419669691, -1239.3873220399996, -632.9175001724097, -806.6729052297195, -1126.9565911273983, -906.6598971607498, -1138.3901092138753, -878.7495744518503, -415.19170439137787, -216.48697569218774, -548.3080556809241, -658.8819032430439, -962.1997318656015, -460.4259048955648, -443.85877254522956, -59.90275351764665, -969.7745817132939, -486.847434511242, -367.3309337271291, -439.2449463602274, -754.0250808529034, -789.3620413521156, -795.7080007152645, -25.650232517391398, -913.9775605704929, -798.8583187234336, -1094.3659408951428, -1082.4868846979386, -930.0905125592528, -998.497208743645, -407.0741421194675, -1072.0677059539612, -146.68774126266288, -1052.2696511899117, -994.6476751420298, -921.446361381966, -811.6363353426725, -141.6204774394346, -692.3505153827919, -764.5833801497541, -345.00353970901807, -1077.7955639090267, -1336.6025683680039, -713.7369648204035, -1151.2852723563087, -1007.5203665618603, -382.5517183239775, -1215.150927000301, -1090.48010108379, -981.7590174734001, -315.93307208579614, -1007.1497035939344, -715.9327872544263, -928.4560361662024, -110.90553286478718, -427.3948035294315, -690.7522534486593, -798.4494781327817, -633.6047470223759, -787.293351129313, -667.008843669018, -937.8763323833284, -1106.39304248234, -768.3129047049914, -1032.2956309041322, -736.186919079483, -441.24437653537996, -707.7653278797267, -85.41671551495803, -771.7001420242561, -959.2187566181196, -1248.8466264544315, -116.72285905059181, -732.1165402227036, -929.5300498444936, -1048.2312028030976, -237.19250478261804], "episode_lengths": [47, 150, 56, 67, 150, 150, 53, 150, 137, 99, 150, 67, 150, 150, 92, 150, 150, 146, 150, 66, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 150, 120, 150, 63, 150, 150, 150, 142, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 105, 150, 65, 150, 150, 150, 150, 62, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 76, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 69, 142, 150, 150, 85, 150, 150, 150, 104], "policy_policy_0_reward": [-99.04143743693962, -1007.4408812050824, -41.92355243830954, -109.04977006673458, -419.94741331847274, -918.6920352756711, -24.308116535662922, -771.3926663299209, -432.8731512603425, -308.95701714113824, -1305.8229315386836, -125.86358227464927, -881.7428785924917, -1126.6707034868434, -181.951793967898, -765.6262589003612, -1087.540640987172, -534.1531388256733, -723.38471349288, -65.1932425699676, -253.07936538332544, -471.64098570845704, -607.3021719577733, -1021.311419669691, -1239.3873220399996, -632.9175001724097, -806.6729052297195, -1126.9565911273983, -906.6598971607498, -1138.3901092138753, -878.7495744518503, -415.19170439137787, -216.48697569218774, -548.3080556809241, -658.8819032430439, -962.1997318656015, -460.4259048955648, -443.85877254522956, -59.90275351764665, -969.7745817132939, -486.847434511242, -367.3309337271291, -439.2449463602274, -754.0250808529034, -789.3620413521156, -795.7080007152645, -25.650232517391398, -913.9775605704929, -798.8583187234336, -1094.3659408951428, -1082.4868846979386, -930.0905125592528, -998.497208743645, -407.0741421194675, -1072.0677059539612, -146.68774126266288, -1052.2696511899117, -994.6476751420298, -921.446361381966, -811.6363353426725, -141.6204774394346, -692.3505153827919, -764.5833801497541, -345.00353970901807, -1077.7955639090267, -1336.6025683680039, -713.7369648204035, -1151.2852723563087, -1007.5203665618603, -382.5517183239775, -1215.150927000301, -1090.48010108379, -981.7590174734001, -315.93307208579614, -1007.1497035939344, -715.9327872544263, -928.4560361662024, -110.90553286478718, -427.3948035294315, -690.7522534486593, -798.4494781327817, -633.6047470223759, -787.293351129313, -667.008843669018, -937.8763323833284, -1106.39304248234, -768.3129047049914, -1032.2956309041322, -736.186919079483, -441.24437653537996, -707.7653278797267, -85.41671551495803, -771.7001420242561, -959.2187566181196, -1248.8466264544315, -116.72285905059181, -732.1165402227036, -929.5300498444936, -1048.2312028030976, -237.19250478261804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549321270492911, "mean_inference_ms": 1.6965127750815472, "mean_action_processing_ms": 0.28240260126378314, "mean_env_wait_ms": 3.013219384910874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012421607971191406, "StateBufferConnector_ms": 0.008318424224853516, "ViewRequirementAgentConnector_ms": 0.19970226287841797}, "num_episodes": 31, "episode_return_max": -24.308116535662922, "episode_return_min": -1336.6025683680039, "episode_return_mean": -694.7431981268331, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 413.7657095213695, "num_env_steps_trained_throughput_per_sec": 413.7657095213695, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12468.227, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12468.151, "sample_time_ms": 1042.133, "learn_time_ms": 11363.79, "learn_throughput": 351.995, "synch_weights_time_ms": 61.387}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "f3b06_00008", "date": "2024-08-03_11-02-02", "timestamp": 1722663122, "time_this_iter_s": 9.681616306304932, "time_total_s": 164.04913473129272, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246fad360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.04913473129272, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 16.62307692307692, "ram_util_percent": 27.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 157.64497676293055, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.219656034807364, "policy_loss": -0.008870312732081704, "vf_loss": 2.241670999241372, "vf_explained_var": 0.9920002094159523, "kl": 0.015048277200761125, "entropy": 1.6154310444990794, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -3.7504998556450584, "episode_reward_min": -1336.6025683680039, "episode_reward_mean": -707.3519901989531, "episode_len_mean": 135.93, "episode_media": {}, "episodes_timesteps_total": 13593, "policy_reward_min": {"policy_0": -1336.6025683680039}, "policy_reward_max": {"policy_0": -3.7504998556450584}, "policy_reward_mean": {"policy_0": -707.3519901989531}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1126.9565911273983, -906.6598971607498, -1138.3901092138753, -878.7495744518503, -415.19170439137787, -216.48697569218774, -548.3080556809241, -658.8819032430439, -962.1997318656015, -460.4259048955648, -443.85877254522956, -59.90275351764665, -969.7745817132939, -486.847434511242, -367.3309337271291, -439.2449463602274, -754.0250808529034, -789.3620413521156, -795.7080007152645, -25.650232517391398, -913.9775605704929, -798.8583187234336, -1094.3659408951428, -1082.4868846979386, -930.0905125592528, -998.497208743645, -407.0741421194675, -1072.0677059539612, -146.68774126266288, -1052.2696511899117, -994.6476751420298, -921.446361381966, -811.6363353426725, -141.6204774394346, -692.3505153827919, -764.5833801497541, -345.00353970901807, -1077.7955639090267, -1336.6025683680039, -713.7369648204035, -1151.2852723563087, -1007.5203665618603, -382.5517183239775, -1215.150927000301, -1090.48010108379, -981.7590174734001, -315.93307208579614, -1007.1497035939344, -715.9327872544263, -928.4560361662024, -110.90553286478718, -427.3948035294315, -690.7522534486593, -798.4494781327817, -633.6047470223759, -787.293351129313, -667.008843669018, -937.8763323833284, -1106.39304248234, -768.3129047049914, -1032.2956309041322, -736.186919079483, -441.24437653537996, -707.7653278797267, -85.41671551495803, -771.7001420242561, -959.2187566181196, -1248.8466264544315, -116.72285905059181, -732.1165402227036, -929.5300498444936, -1048.2312028030976, -237.19250478261804, -326.4652663398296, -1011.9328992997446, -731.3968860478396, -469.46178814711095, -278.6366727755018, -898.2702990927273, -905.5096631151449, -1019.8929645839172, -1099.291325696361, -281.109933354938, -918.4757601184488, -1011.6767383268077, -617.1702404505999, -864.2393053001165, -132.64064486060823, -884.5204243302838, -26.20441821432783, -3.7504998556450584, -95.01630013079723, -221.40611602221617, -940.4714281728532, -600.3767521536539, -1093.7195150889056, -587.3294904304614, -929.5832724341104, -329.30303296277594, -946.9151657125363], "episode_lengths": [150, 150, 150, 150, 150, 91, 150, 150, 150, 120, 150, 63, 150, 150, 150, 142, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 105, 150, 65, 150, 150, 150, 150, 62, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 76, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 69, 142, 150, 150, 85, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 88, 150, 47, 44, 48, 81, 150, 150, 150, 148, 150, 95, 150], "policy_policy_0_reward": [-1126.9565911273983, -906.6598971607498, -1138.3901092138753, -878.7495744518503, -415.19170439137787, -216.48697569218774, -548.3080556809241, -658.8819032430439, -962.1997318656015, -460.4259048955648, -443.85877254522956, -59.90275351764665, -969.7745817132939, -486.847434511242, -367.3309337271291, -439.2449463602274, -754.0250808529034, -789.3620413521156, -795.7080007152645, -25.650232517391398, -913.9775605704929, -798.8583187234336, -1094.3659408951428, -1082.4868846979386, -930.0905125592528, -998.497208743645, -407.0741421194675, -1072.0677059539612, -146.68774126266288, -1052.2696511899117, -994.6476751420298, -921.446361381966, -811.6363353426725, -141.6204774394346, -692.3505153827919, -764.5833801497541, -345.00353970901807, -1077.7955639090267, -1336.6025683680039, -713.7369648204035, -1151.2852723563087, -1007.5203665618603, -382.5517183239775, -1215.150927000301, -1090.48010108379, -981.7590174734001, -315.93307208579614, -1007.1497035939344, -715.9327872544263, -928.4560361662024, -110.90553286478718, -427.3948035294315, -690.7522534486593, -798.4494781327817, -633.6047470223759, -787.293351129313, -667.008843669018, -937.8763323833284, -1106.39304248234, -768.3129047049914, -1032.2956309041322, -736.186919079483, -441.24437653537996, -707.7653278797267, -85.41671551495803, -771.7001420242561, -959.2187566181196, -1248.8466264544315, -116.72285905059181, -732.1165402227036, -929.5300498444936, -1048.2312028030976, -237.19250478261804, -326.4652663398296, -1011.9328992997446, -731.3968860478396, -469.46178814711095, -278.6366727755018, -898.2702990927273, -905.5096631151449, -1019.8929645839172, -1099.291325696361, -281.109933354938, -918.4757601184488, -1011.6767383268077, -617.1702404505999, -864.2393053001165, -132.64064486060823, -884.5204243302838, -26.20441821432783, -3.7504998556450584, -95.01630013079723, -221.40611602221617, -940.4714281728532, -600.3767521536539, -1093.7195150889056, -587.3294904304614, -929.5832724341104, -329.30303296277594, -946.9151657125363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543013657192695, "mean_inference_ms": 1.6950310811924194, "mean_action_processing_ms": 0.2819907063750746, "mean_env_wait_ms": 3.0146395246506184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012104511260986328, "StateBufferConnector_ms": 0.008185625076293945, "ViewRequirementAgentConnector_ms": 0.19640517234802246}, "num_episodes": 27, "episode_return_max": -3.7504998556450584, "episode_return_min": -1336.6025683680039, "episode_return_mean": -707.3519901989531, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.86959298729363, "num_env_steps_trained_throughput_per_sec": 332.86959298729363, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12345.642, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12345.567, "sample_time_ms": 1042.653, "learn_time_ms": 11241.574, "learn_throughput": 355.822, "synch_weights_time_ms": 60.5}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "f3b06_00008", "date": "2024-08-03_11-02-14", "timestamp": 1722663134, "time_this_iter_s": 12.030077695846558, "time_total_s": 176.07921242713928, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f52e60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 176.07921242713928, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.633333333333333, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 142.57717956105867, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.6826146147524317, "policy_loss": -0.007171598247562846, "vf_loss": 2.702391550689936, "vf_explained_var": 0.9901979799692829, "kl": 0.013081595122260613, "entropy": 1.5221659973263741, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -3.7504998556450584, "episode_reward_min": -1417.9723801605357, "episode_reward_mean": -714.8409292352108, "episode_len_mean": 134.83, "episode_media": {}, "episodes_timesteps_total": 13483, "policy_reward_min": {"policy_0": -1417.9723801605357}, "policy_reward_max": {"policy_0": -3.7504998556450584}, "policy_reward_mean": {"policy_0": -714.8409292352108}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-811.6363353426725, -141.6204774394346, -692.3505153827919, -764.5833801497541, -345.00353970901807, -1077.7955639090267, -1336.6025683680039, -713.7369648204035, -1151.2852723563087, -1007.5203665618603, -382.5517183239775, -1215.150927000301, -1090.48010108379, -981.7590174734001, -315.93307208579614, -1007.1497035939344, -715.9327872544263, -928.4560361662024, -110.90553286478718, -427.3948035294315, -690.7522534486593, -798.4494781327817, -633.6047470223759, -787.293351129313, -667.008843669018, -937.8763323833284, -1106.39304248234, -768.3129047049914, -1032.2956309041322, -736.186919079483, -441.24437653537996, -707.7653278797267, -85.41671551495803, -771.7001420242561, -959.2187566181196, -1248.8466264544315, -116.72285905059181, -732.1165402227036, -929.5300498444936, -1048.2312028030976, -237.19250478261804, -326.4652663398296, -1011.9328992997446, -731.3968860478396, -469.46178814711095, -278.6366727755018, -898.2702990927273, -905.5096631151449, -1019.8929645839172, -1099.291325696361, -281.109933354938, -918.4757601184488, -1011.6767383268077, -617.1702404505999, -864.2393053001165, -132.64064486060823, -884.5204243302838, -26.20441821432783, -3.7504998556450584, -95.01630013079723, -221.40611602221617, -940.4714281728532, -600.3767521536539, -1093.7195150889056, -587.3294904304614, -929.5832724341104, -329.30303296277594, -946.9151657125363, -650.4344575035516, -36.15016101768232, -80.91884759855307, -968.6553314778687, -749.5314967860428, -966.5247456698833, -826.3803774147973, -1417.9723801605357, -743.2892085767771, -1204.2818411876067, -920.4273944244219, -255.34831550493547, -1291.8099903967209, -819.5945892597913, -993.2670965903042, -665.3823849834246, -716.287458945609, -424.91057958884215, -1146.6203620721737, -183.5742330058832, -1076.908818348948, -953.133792756229, -1138.5268856898406, -864.7420973532005, -598.2691393522493, -81.90401259135868, -796.383510493865, -86.62873140197584, -662.0320673286913, -1143.1365758740333, -856.8003309321293, -285.49161811276133], "episode_lengths": [150, 62, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 76, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 69, 142, 150, 150, 85, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 88, 150, 47, 44, 48, 81, 150, 150, 150, 148, 150, 95, 150, 150, 51, 51, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 59, 150, 51, 150, 150, 150, 113], "policy_policy_0_reward": [-811.6363353426725, -141.6204774394346, -692.3505153827919, -764.5833801497541, -345.00353970901807, -1077.7955639090267, -1336.6025683680039, -713.7369648204035, -1151.2852723563087, -1007.5203665618603, -382.5517183239775, -1215.150927000301, -1090.48010108379, -981.7590174734001, -315.93307208579614, -1007.1497035939344, -715.9327872544263, -928.4560361662024, -110.90553286478718, -427.3948035294315, -690.7522534486593, -798.4494781327817, -633.6047470223759, -787.293351129313, -667.008843669018, -937.8763323833284, -1106.39304248234, -768.3129047049914, -1032.2956309041322, -736.186919079483, -441.24437653537996, -707.7653278797267, -85.41671551495803, -771.7001420242561, -959.2187566181196, -1248.8466264544315, -116.72285905059181, -732.1165402227036, -929.5300498444936, -1048.2312028030976, -237.19250478261804, -326.4652663398296, -1011.9328992997446, -731.3968860478396, -469.46178814711095, -278.6366727755018, -898.2702990927273, -905.5096631151449, -1019.8929645839172, -1099.291325696361, -281.109933354938, -918.4757601184488, -1011.6767383268077, -617.1702404505999, -864.2393053001165, -132.64064486060823, -884.5204243302838, -26.20441821432783, -3.7504998556450584, -95.01630013079723, -221.40611602221617, -940.4714281728532, -600.3767521536539, -1093.7195150889056, -587.3294904304614, -929.5832724341104, -329.30303296277594, -946.9151657125363, -650.4344575035516, -36.15016101768232, -80.91884759855307, -968.6553314778687, -749.5314967860428, -966.5247456698833, -826.3803774147973, -1417.9723801605357, -743.2892085767771, -1204.2818411876067, -920.4273944244219, -255.34831550493547, -1291.8099903967209, -819.5945892597913, -993.2670965903042, -665.3823849834246, -716.287458945609, -424.91057958884215, -1146.6203620721737, -183.5742330058832, -1076.908818348948, -953.133792756229, -1138.5268856898406, -864.7420973532005, -598.2691393522493, -81.90401259135868, -796.383510493865, -86.62873140197584, -662.0320673286913, -1143.1365758740333, -856.8003309321293, -285.49161811276133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542349119806218, "mean_inference_ms": 1.694604213926287, "mean_action_processing_ms": 0.28154513473528164, "mean_env_wait_ms": 3.020400280587893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012767791748046875, "StateBufferConnector_ms": 0.008235454559326172, "ViewRequirementAgentConnector_ms": 0.19840097427368164}, "num_episodes": 32, "episode_return_max": -3.7504998556450584, "episode_return_min": -1417.9723801605357, "episode_return_mean": -714.8409292352108, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.2864295916182, "num_env_steps_trained_throughput_per_sec": 322.2864295916182, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12494.402, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12494.327, "sample_time_ms": 1044.904, "learn_time_ms": 11387.826, "learn_throughput": 351.252, "synch_weights_time_ms": 60.768}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "f3b06_00008", "date": "2024-08-03_11-02-26", "timestamp": 1722663146, "time_this_iter_s": 12.424090147018433, "time_total_s": 188.50330257415771, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f52560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 188.50330257415771, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 14.729411764705883, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 169.42316541870434, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.8839278159663082, "policy_loss": -0.01385796604930268, "vf_loss": 1.9115289459004998, "vf_explained_var": 0.9895864321539799, "kl": 0.014748993942703237, "entropy": 1.6692959563185772, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -3.7504998556450584, "episode_reward_min": -1417.9723801605357, "episode_reward_mean": -711.0384245137736, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"policy_0": -1417.9723801605357}, "policy_reward_max": {"policy_0": -3.7504998556450584}, "policy_reward_mean": {"policy_0": -711.0384245137736}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1032.2956309041322, -736.186919079483, -441.24437653537996, -707.7653278797267, -85.41671551495803, -771.7001420242561, -959.2187566181196, -1248.8466264544315, -116.72285905059181, -732.1165402227036, -929.5300498444936, -1048.2312028030976, -237.19250478261804, -326.4652663398296, -1011.9328992997446, -731.3968860478396, -469.46178814711095, -278.6366727755018, -898.2702990927273, -905.5096631151449, -1019.8929645839172, -1099.291325696361, -281.109933354938, -918.4757601184488, -1011.6767383268077, -617.1702404505999, -864.2393053001165, -132.64064486060823, -884.5204243302838, -26.20441821432783, -3.7504998556450584, -95.01630013079723, -221.40611602221617, -940.4714281728532, -600.3767521536539, -1093.7195150889056, -587.3294904304614, -929.5832724341104, -329.30303296277594, -946.9151657125363, -650.4344575035516, -36.15016101768232, -80.91884759855307, -968.6553314778687, -749.5314967860428, -966.5247456698833, -826.3803774147973, -1417.9723801605357, -743.2892085767771, -1204.2818411876067, -920.4273944244219, -255.34831550493547, -1291.8099903967209, -819.5945892597913, -993.2670965903042, -665.3823849834246, -716.287458945609, -424.91057958884215, -1146.6203620721737, -183.5742330058832, -1076.908818348948, -953.133792756229, -1138.5268856898406, -864.7420973532005, -598.2691393522493, -81.90401259135868, -796.383510493865, -86.62873140197584, -662.0320673286913, -1143.1365758740333, -856.8003309321293, -285.49161811276133, -1197.7034313173663, -890.899386201084, -1128.6649366373672, -697.3454427929231, -684.2329538037781, -972.1765500954571, -466.69184137329813, -130.85422631074624, -238.17072871549811, -528.7462757498065, -609.3496499386788, -521.9143459250348, -786.7454787502182, -995.227804608999, -943.7546646643148, -824.3088007275222, -1006.906415531161, -719.5107662034859, -351.4944244601951, -689.171016478458, -1057.736528293821, -214.02222802956894, -892.4316826863442, -879.1573070272207, -937.8047598372484, -394.8723073641211, -1261.056638985321, -1206.3385717353797], "episode_lengths": [150, 150, 106, 150, 69, 142, 150, 150, 85, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 88, 150, 47, 44, 48, 81, 150, 150, 150, 148, 150, 95, 150, 150, 51, 51, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 59, 150, 51, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 77, 114, 150, 150, 122, 150, 150, 150, 150, 150, 150, 110, 150, 150, 115, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1032.2956309041322, -736.186919079483, -441.24437653537996, -707.7653278797267, -85.41671551495803, -771.7001420242561, -959.2187566181196, -1248.8466264544315, -116.72285905059181, -732.1165402227036, -929.5300498444936, -1048.2312028030976, -237.19250478261804, -326.4652663398296, -1011.9328992997446, -731.3968860478396, -469.46178814711095, -278.6366727755018, -898.2702990927273, -905.5096631151449, -1019.8929645839172, -1099.291325696361, -281.109933354938, -918.4757601184488, -1011.6767383268077, -617.1702404505999, -864.2393053001165, -132.64064486060823, -884.5204243302838, -26.20441821432783, -3.7504998556450584, -95.01630013079723, -221.40611602221617, -940.4714281728532, -600.3767521536539, -1093.7195150889056, -587.3294904304614, -929.5832724341104, -329.30303296277594, -946.9151657125363, -650.4344575035516, -36.15016101768232, -80.91884759855307, -968.6553314778687, -749.5314967860428, -966.5247456698833, -826.3803774147973, -1417.9723801605357, -743.2892085767771, -1204.2818411876067, -920.4273944244219, -255.34831550493547, -1291.8099903967209, -819.5945892597913, -993.2670965903042, -665.3823849834246, -716.287458945609, -424.91057958884215, -1146.6203620721737, -183.5742330058832, -1076.908818348948, -953.133792756229, -1138.5268856898406, -864.7420973532005, -598.2691393522493, -81.90401259135868, -796.383510493865, -86.62873140197584, -662.0320673286913, -1143.1365758740333, -856.8003309321293, -285.49161811276133, -1197.7034313173663, -890.899386201084, -1128.6649366373672, -697.3454427929231, -684.2329538037781, -972.1765500954571, -466.69184137329813, -130.85422631074624, -238.17072871549811, -528.7462757498065, -609.3496499386788, -521.9143459250348, -786.7454787502182, -995.227804608999, -943.7546646643148, -824.3088007275222, -1006.906415531161, -719.5107662034859, -351.4944244601951, -689.171016478458, -1057.736528293821, -214.02222802956894, -892.4316826863442, -879.1573070272207, -937.8047598372484, -394.8723073641211, -1261.056638985321, -1206.3385717353797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537115060375734, "mean_inference_ms": 1.693616819994955, "mean_action_processing_ms": 0.2812710386813457, "mean_env_wait_ms": 3.022847640086174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012599945068359375, "StateBufferConnector_ms": 0.008280038833618164, "ViewRequirementAgentConnector_ms": 0.19921469688415527}, "num_episodes": 28, "episode_return_max": -3.7504998556450584, "episode_return_min": -1417.9723801605357, "episode_return_mean": -711.0384245137736, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 453.97757108539156, "num_env_steps_trained_throughput_per_sec": 453.97757108539156, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12176.495, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12176.423, "sample_time_ms": 1047.255, "learn_time_ms": 11067.641, "learn_throughput": 361.414, "synch_weights_time_ms": 60.713}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "f3b06_00008", "date": "2024-08-03_11-02-35", "timestamp": 1722663155, "time_this_iter_s": 8.82328724861145, "time_total_s": 197.32658982276917, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d1750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 197.32658982276917, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 16.415384615384617, "ram_util_percent": 27.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.46354795296986, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.041299589909613, "policy_loss": -0.01098292990839885, "vf_loss": 2.0641473117594917, "vf_explained_var": 0.991742506933709, "kl": 0.016607020722282578, "entropy": 1.518619134525458, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -3.7504998556450584, "episode_reward_min": -1417.9723801605357, "episode_reward_mean": -725.9039234555246, "episode_len_mean": 136.82, "episode_media": {}, "episodes_timesteps_total": 13682, "policy_reward_min": {"policy_0": -1417.9723801605357}, "policy_reward_max": {"policy_0": -3.7504998556450584}, "policy_reward_mean": {"policy_0": -725.9039234555246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-864.2393053001165, -132.64064486060823, -884.5204243302838, -26.20441821432783, -3.7504998556450584, -95.01630013079723, -221.40611602221617, -940.4714281728532, -600.3767521536539, -1093.7195150889056, -587.3294904304614, -929.5832724341104, -329.30303296277594, -946.9151657125363, -650.4344575035516, -36.15016101768232, -80.91884759855307, -968.6553314778687, -749.5314967860428, -966.5247456698833, -826.3803774147973, -1417.9723801605357, -743.2892085767771, -1204.2818411876067, -920.4273944244219, -255.34831550493547, -1291.8099903967209, -819.5945892597913, -993.2670965903042, -665.3823849834246, -716.287458945609, -424.91057958884215, -1146.6203620721737, -183.5742330058832, -1076.908818348948, -953.133792756229, -1138.5268856898406, -864.7420973532005, -598.2691393522493, -81.90401259135868, -796.383510493865, -86.62873140197584, -662.0320673286913, -1143.1365758740333, -856.8003309321293, -285.49161811276133, -1197.7034313173663, -890.899386201084, -1128.6649366373672, -697.3454427929231, -684.2329538037781, -972.1765500954571, -466.69184137329813, -130.85422631074624, -238.17072871549811, -528.7462757498065, -609.3496499386788, -521.9143459250348, -786.7454787502182, -995.227804608999, -943.7546646643148, -824.3088007275222, -1006.906415531161, -719.5107662034859, -351.4944244601951, -689.171016478458, -1057.736528293821, -214.02222802956894, -892.4316826863442, -879.1573070272207, -937.8047598372484, -394.8723073641211, -1261.056638985321, -1206.3385717353797, -946.6018971530674, -912.9303601138797, -1223.3540695029412, -666.8911078411099, -1159.935284633934, -847.1425898272136, -909.4793227445452, -463.2109229222205, -1058.7808072438634, -658.6704003385221, -403.6345659963222, -1266.0264406474396, -747.5024678424041, -868.2226780050491, -363.2839162966686, -695.3522114686521, -751.3573384112962, -208.7081855462755, -1108.2330285451453, -652.6965853718854, -464.0601094544205, -887.1230092035811, -802.3033940630345, -972.0929725622984, -502.6323833875205, -562.0819341147709], "episode_lengths": [150, 88, 150, 47, 44, 48, 81, 150, 150, 150, 148, 150, 95, 150, 150, 51, 51, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 59, 150, 51, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 77, 114, 150, 150, 122, 150, 150, 150, 150, 150, 150, 110, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-864.2393053001165, -132.64064486060823, -884.5204243302838, -26.20441821432783, -3.7504998556450584, -95.01630013079723, -221.40611602221617, -940.4714281728532, -600.3767521536539, -1093.7195150889056, -587.3294904304614, -929.5832724341104, -329.30303296277594, -946.9151657125363, -650.4344575035516, -36.15016101768232, -80.91884759855307, -968.6553314778687, -749.5314967860428, -966.5247456698833, -826.3803774147973, -1417.9723801605357, -743.2892085767771, -1204.2818411876067, -920.4273944244219, -255.34831550493547, -1291.8099903967209, -819.5945892597913, -993.2670965903042, -665.3823849834246, -716.287458945609, -424.91057958884215, -1146.6203620721737, -183.5742330058832, -1076.908818348948, -953.133792756229, -1138.5268856898406, -864.7420973532005, -598.2691393522493, -81.90401259135868, -796.383510493865, -86.62873140197584, -662.0320673286913, -1143.1365758740333, -856.8003309321293, -285.49161811276133, -1197.7034313173663, -890.899386201084, -1128.6649366373672, -697.3454427929231, -684.2329538037781, -972.1765500954571, -466.69184137329813, -130.85422631074624, -238.17072871549811, -528.7462757498065, -609.3496499386788, -521.9143459250348, -786.7454787502182, -995.227804608999, -943.7546646643148, -824.3088007275222, -1006.906415531161, -719.5107662034859, -351.4944244601951, -689.171016478458, -1057.736528293821, -214.02222802956894, -892.4316826863442, -879.1573070272207, -937.8047598372484, -394.8723073641211, -1261.056638985321, -1206.3385717353797, -946.6018971530674, -912.9303601138797, -1223.3540695029412, -666.8911078411099, -1159.935284633934, -847.1425898272136, -909.4793227445452, -463.2109229222205, -1058.7808072438634, -658.6704003385221, -403.6345659963222, -1266.0264406474396, -747.5024678424041, -868.2226780050491, -363.2839162966686, -695.3522114686521, -751.3573384112962, -208.7081855462755, -1108.2330285451453, -652.6965853718854, -464.0601094544205, -887.1230092035811, -802.3033940630345, -972.0929725622984, -502.6323833875205, -562.0819341147709]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534936850045878, "mean_inference_ms": 1.6938751835188786, "mean_action_processing_ms": 0.28104222803224466, "mean_env_wait_ms": 3.0271084591662616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012701988220214844, "StateBufferConnector_ms": 0.008234024047851562, "ViewRequirementAgentConnector_ms": 0.20098018646240234}, "num_episodes": 26, "episode_return_max": -3.7504998556450584, "episode_return_min": -1417.9723801605357, "episode_return_mean": -725.9039234555246, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.6170065223935, "num_env_steps_trained_throughput_per_sec": 298.6170065223935, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12188.088, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12188.014, "sample_time_ms": 1050.241, "learn_time_ms": 11074.857, "learn_throughput": 361.178, "synch_weights_time_ms": 62.088}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "f3b06_00008", "date": "2024-08-03_11-02-49", "timestamp": 1722663169, "time_this_iter_s": 13.409224271774292, "time_total_s": 210.73581409454346, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f53130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 210.73581409454346, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.542105263157895, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 172.1718818883101, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 1.8762074230859678, "policy_loss": -0.01442190244512555, "vf_loss": 1.9006873669102788, "vf_explained_var": 0.9936704837406675, "kl": 0.01946093496502878, "entropy": 1.3950220732639234, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -81.90401259135868, "episode_reward_min": -1266.0264406474396, "episode_reward_mean": -733.3289314845472, "episode_len_mean": 142.32, "episode_media": {}, "episodes_timesteps_total": 14232, "policy_reward_min": {"policy_0": -1266.0264406474396}, "policy_reward_max": {"policy_0": -81.90401259135868}, "policy_reward_mean": {"policy_0": -733.3289314845472}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-716.287458945609, -424.91057958884215, -1146.6203620721737, -183.5742330058832, -1076.908818348948, -953.133792756229, -1138.5268856898406, -864.7420973532005, -598.2691393522493, -81.90401259135868, -796.383510493865, -86.62873140197584, -662.0320673286913, -1143.1365758740333, -856.8003309321293, -285.49161811276133, -1197.7034313173663, -890.899386201084, -1128.6649366373672, -697.3454427929231, -684.2329538037781, -972.1765500954571, -466.69184137329813, -130.85422631074624, -238.17072871549811, -528.7462757498065, -609.3496499386788, -521.9143459250348, -786.7454787502182, -995.227804608999, -943.7546646643148, -824.3088007275222, -1006.906415531161, -719.5107662034859, -351.4944244601951, -689.171016478458, -1057.736528293821, -214.02222802956894, -892.4316826863442, -879.1573070272207, -937.8047598372484, -394.8723073641211, -1261.056638985321, -1206.3385717353797, -946.6018971530674, -912.9303601138797, -1223.3540695029412, -666.8911078411099, -1159.935284633934, -847.1425898272136, -909.4793227445452, -463.2109229222205, -1058.7808072438634, -658.6704003385221, -403.6345659963222, -1266.0264406474396, -747.5024678424041, -868.2226780050491, -363.2839162966686, -695.3522114686521, -751.3573384112962, -208.7081855462755, -1108.2330285451453, -652.6965853718854, -464.0601094544205, -887.1230092035811, -802.3033940630345, -972.0929725622984, -502.6323833875205, -562.0819341147709, -581.5354581975254, -276.6020633975063, -132.51577003510738, -1046.5152775147271, -1005.4012943867008, -706.0350404929932, -1023.4543077398877, -694.4738503423625, -1001.2203619254719, -447.77640068751674, -565.4509856087752, -843.0199323822014, -743.1018058792031, -807.9169410740809, -534.740877759191, -477.57233608167354, -660.0448547929971, -555.5754298678805, -889.4935975883565, -960.0020571566677, -785.8899513613397, -547.2393418950807, -753.8474531956028, -705.8748548470988, -499.63766870525393, -587.2990129347603, -1029.4519221866965, -1063.7071290471017, -416.0609533492056, -646.4888566914689], "episode_lengths": [150, 150, 150, 93, 150, 150, 150, 150, 150, 59, 150, 51, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 77, 114, 150, 150, 122, 150, 150, 150, 150, 150, 150, 110, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 56, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-716.287458945609, -424.91057958884215, -1146.6203620721737, -183.5742330058832, -1076.908818348948, -953.133792756229, -1138.5268856898406, -864.7420973532005, -598.2691393522493, -81.90401259135868, -796.383510493865, -86.62873140197584, -662.0320673286913, -1143.1365758740333, -856.8003309321293, -285.49161811276133, -1197.7034313173663, -890.899386201084, -1128.6649366373672, -697.3454427929231, -684.2329538037781, -972.1765500954571, -466.69184137329813, -130.85422631074624, -238.17072871549811, -528.7462757498065, -609.3496499386788, -521.9143459250348, -786.7454787502182, -995.227804608999, -943.7546646643148, -824.3088007275222, -1006.906415531161, -719.5107662034859, -351.4944244601951, -689.171016478458, -1057.736528293821, -214.02222802956894, -892.4316826863442, -879.1573070272207, -937.8047598372484, -394.8723073641211, -1261.056638985321, -1206.3385717353797, -946.6018971530674, -912.9303601138797, -1223.3540695029412, -666.8911078411099, -1159.935284633934, -847.1425898272136, -909.4793227445452, -463.2109229222205, -1058.7808072438634, -658.6704003385221, -403.6345659963222, -1266.0264406474396, -747.5024678424041, -868.2226780050491, -363.2839162966686, -695.3522114686521, -751.3573384112962, -208.7081855462755, -1108.2330285451453, -652.6965853718854, -464.0601094544205, -887.1230092035811, -802.3033940630345, -972.0929725622984, -502.6323833875205, -562.0819341147709, -581.5354581975254, -276.6020633975063, -132.51577003510738, -1046.5152775147271, -1005.4012943867008, -706.0350404929932, -1023.4543077398877, -694.4738503423625, -1001.2203619254719, -447.77640068751674, -565.4509856087752, -843.0199323822014, -743.1018058792031, -807.9169410740809, -534.740877759191, -477.57233608167354, -660.0448547929971, -555.5754298678805, -889.4935975883565, -960.0020571566677, -785.8899513613397, -547.2393418950807, -753.8474531956028, -705.8748548470988, -499.63766870525393, -587.2990129347603, -1029.4519221866965, -1063.7071290471017, -416.0609533492056, -646.4888566914689]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536173231383495, "mean_inference_ms": 1.6934727921757682, "mean_action_processing_ms": 0.28087810467704877, "mean_env_wait_ms": 3.0296476635310294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011928081512451172, "StateBufferConnector_ms": 0.008160829544067383, "ViewRequirementAgentConnector_ms": 0.1997995376586914}, "num_episodes": 30, "episode_return_max": -81.90401259135868, "episode_return_min": -1266.0264406474396, "episode_return_mean": -733.3289314845472, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.97974711301595, "num_env_steps_trained_throughput_per_sec": 299.97974711301595, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12175.71, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12175.638, "sample_time_ms": 1048.484, "learn_time_ms": 11064.418, "learn_throughput": 361.519, "synch_weights_time_ms": 61.908}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "f3b06_00008", "date": "2024-08-03_11-03-02", "timestamp": 1722663182, "time_this_iter_s": 13.347205638885498, "time_total_s": 224.08301973342896, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246fad900>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 224.08301973342896, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.200000000000001, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 161.52164082924526, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 2.2403893986095986, "policy_loss": -0.013992282687104307, "vf_loss": 2.264589884194235, "vf_explained_var": 0.9890660888825854, "kl": 0.0228970966058114, "entropy": 1.4787619575858115, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -87.79239634669334, "episode_reward_min": -1266.3136013019518, "episode_reward_mean": -731.0459458585686, "episode_len_mean": 144.3, "episode_media": {}, "episodes_timesteps_total": 14430, "policy_reward_min": {"policy_0": -1266.3136013019518}, "policy_reward_max": {"policy_0": -87.79239634669334}, "policy_reward_mean": {"policy_0": -731.0459458585686}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-521.9143459250348, -786.7454787502182, -995.227804608999, -943.7546646643148, -824.3088007275222, -1006.906415531161, -719.5107662034859, -351.4944244601951, -689.171016478458, -1057.736528293821, -214.02222802956894, -892.4316826863442, -879.1573070272207, -937.8047598372484, -394.8723073641211, -1261.056638985321, -1206.3385717353797, -946.6018971530674, -912.9303601138797, -1223.3540695029412, -666.8911078411099, -1159.935284633934, -847.1425898272136, -909.4793227445452, -463.2109229222205, -1058.7808072438634, -658.6704003385221, -403.6345659963222, -1266.0264406474396, -747.5024678424041, -868.2226780050491, -363.2839162966686, -695.3522114686521, -751.3573384112962, -208.7081855462755, -1108.2330285451453, -652.6965853718854, -464.0601094544205, -887.1230092035811, -802.3033940630345, -972.0929725622984, -502.6323833875205, -562.0819341147709, -581.5354581975254, -276.6020633975063, -132.51577003510738, -1046.5152775147271, -1005.4012943867008, -706.0350404929932, -1023.4543077398877, -694.4738503423625, -1001.2203619254719, -447.77640068751674, -565.4509856087752, -843.0199323822014, -743.1018058792031, -807.9169410740809, -534.740877759191, -477.57233608167354, -660.0448547929971, -555.5754298678805, -889.4935975883565, -960.0020571566677, -785.8899513613397, -547.2393418950807, -753.8474531956028, -705.8748548470988, -499.63766870525393, -587.2990129347603, -1029.4519221866965, -1063.7071290471017, -416.0609533492056, -646.4888566914689, -853.4483864223863, -87.79239634669334, -703.1543522663186, -1199.5059154913954, -734.011189030798, -782.0467341631758, -398.23033227842274, -392.9022676824888, -297.5629344151395, -907.7619635207685, -739.5213640546924, -782.1311590987971, -905.5717679354882, -602.380130343424, -708.3650582700013, -430.50418983353285, -970.9994717277822, -1266.3136013019518, -607.4929991382483, -662.652147980859, -800.4796053748911, -1022.8275647874522, -533.0440590859974, -536.2945379851612, -525.6451557555459, -328.73049546751963, -552.5172944270164], "episode_lengths": [122, 150, 150, 150, 150, 150, 150, 110, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 56, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 141, 86, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-521.9143459250348, -786.7454787502182, -995.227804608999, -943.7546646643148, -824.3088007275222, -1006.906415531161, -719.5107662034859, -351.4944244601951, -689.171016478458, -1057.736528293821, -214.02222802956894, -892.4316826863442, -879.1573070272207, -937.8047598372484, -394.8723073641211, -1261.056638985321, -1206.3385717353797, -946.6018971530674, -912.9303601138797, -1223.3540695029412, -666.8911078411099, -1159.935284633934, -847.1425898272136, -909.4793227445452, -463.2109229222205, -1058.7808072438634, -658.6704003385221, -403.6345659963222, -1266.0264406474396, -747.5024678424041, -868.2226780050491, -363.2839162966686, -695.3522114686521, -751.3573384112962, -208.7081855462755, -1108.2330285451453, -652.6965853718854, -464.0601094544205, -887.1230092035811, -802.3033940630345, -972.0929725622984, -502.6323833875205, -562.0819341147709, -581.5354581975254, -276.6020633975063, -132.51577003510738, -1046.5152775147271, -1005.4012943867008, -706.0350404929932, -1023.4543077398877, -694.4738503423625, -1001.2203619254719, -447.77640068751674, -565.4509856087752, -843.0199323822014, -743.1018058792031, -807.9169410740809, -534.740877759191, -477.57233608167354, -660.0448547929971, -555.5754298678805, -889.4935975883565, -960.0020571566677, -785.8899513613397, -547.2393418950807, -753.8474531956028, -705.8748548470988, -499.63766870525393, -587.2990129347603, -1029.4519221866965, -1063.7071290471017, -416.0609533492056, -646.4888566914689, -853.4483864223863, -87.79239634669334, -703.1543522663186, -1199.5059154913954, -734.011189030798, -782.0467341631758, -398.23033227842274, -392.9022676824888, -297.5629344151395, -907.7619635207685, -739.5213640546924, -782.1311590987971, -905.5717679354882, -602.380130343424, -708.3650582700013, -430.50418983353285, -970.9994717277822, -1266.3136013019518, -607.4929991382483, -662.652147980859, -800.4796053748911, -1022.8275647874522, -533.0440590859974, -536.2945379851612, -525.6451557555459, -328.73049546751963, -552.5172944270164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532024882930835, "mean_inference_ms": 1.6913415613796443, "mean_action_processing_ms": 0.28046226444930833, "mean_env_wait_ms": 3.026862573891862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011643409729003906, "StateBufferConnector_ms": 0.007979869842529297, "ViewRequirementAgentConnector_ms": 0.19430947303771973}, "num_episodes": 27, "episode_return_max": -87.79239634669334, "episode_return_min": -1266.3136013019518, "episode_return_mean": -731.0459458585686, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.4172293988828, "num_env_steps_trained_throughput_per_sec": 303.4172293988828, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12177.131, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12177.059, "sample_time_ms": 1045.605, "learn_time_ms": 11068.524, "learn_throughput": 361.385, "synch_weights_time_ms": 62.1}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "f3b06_00008", "date": "2024-08-03_11-03-15", "timestamp": 1722663195, "time_this_iter_s": 13.197000741958618, "time_total_s": 237.28002047538757, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246fae290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 237.28002047538757, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.36315789473684, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 166.91521259744962, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.922484051125745, "policy_loss": -0.018983948069702213, "vf_loss": 1.9531436946243048, "vf_explained_var": 0.9951823487256964, "kl": 0.016738260136844475, "entropy": 1.669717784722646, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -28.51765695514313, "episode_reward_min": -1336.9947964311223, "episode_reward_mean": -694.6334200073366, "episode_len_mean": 140.92, "episode_media": {}, "episodes_timesteps_total": 14092, "policy_reward_min": {"policy_0": -1336.9947964311223}, "policy_reward_max": {"policy_0": -28.51765695514313}, "policy_reward_mean": {"policy_0": -694.6334200073366}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-868.2226780050491, -363.2839162966686, -695.3522114686521, -751.3573384112962, -208.7081855462755, -1108.2330285451453, -652.6965853718854, -464.0601094544205, -887.1230092035811, -802.3033940630345, -972.0929725622984, -502.6323833875205, -562.0819341147709, -581.5354581975254, -276.6020633975063, -132.51577003510738, -1046.5152775147271, -1005.4012943867008, -706.0350404929932, -1023.4543077398877, -694.4738503423625, -1001.2203619254719, -447.77640068751674, -565.4509856087752, -843.0199323822014, -743.1018058792031, -807.9169410740809, -534.740877759191, -477.57233608167354, -660.0448547929971, -555.5754298678805, -889.4935975883565, -960.0020571566677, -785.8899513613397, -547.2393418950807, -753.8474531956028, -705.8748548470988, -499.63766870525393, -587.2990129347603, -1029.4519221866965, -1063.7071290471017, -416.0609533492056, -646.4888566914689, -853.4483864223863, -87.79239634669334, -703.1543522663186, -1199.5059154913954, -734.011189030798, -782.0467341631758, -398.23033227842274, -392.9022676824888, -297.5629344151395, -907.7619635207685, -739.5213640546924, -782.1311590987971, -905.5717679354882, -602.380130343424, -708.3650582700013, -430.50418983353285, -970.9994717277822, -1266.3136013019518, -607.4929991382483, -662.652147980859, -800.4796053748911, -1022.8275647874522, -533.0440590859974, -536.2945379851612, -525.6451557555459, -328.73049546751963, -552.5172944270164, -1231.7595440120178, -1199.929583322283, -887.2065235996263, -609.0610357834561, -956.716620787246, -703.8169166214304, -949.0181711175571, -991.3631612848823, -222.56932517299438, -342.63323613557816, -1163.4711016445574, -1205.140136665874, -1006.9964107607044, -970.2798777434989, -1336.9947964311223, -484.61302521654784, -678.2890453688404, -1035.1824409273167, -48.49959544225369, -151.57358768459844, -625.2096000021729, -431.9793436309748, -1023.3408640365543, -167.8362778223137, -1194.0319388561077, -569.4547906770133, -642.1650668654986, -77.33659960003227, -370.3751188244642, -28.51765695514313], "episode_lengths": [150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 56, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 141, 86, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 65, 150, 150, 150, 109, 150, 150, 150, 66, 125, 53], "policy_policy_0_reward": [-868.2226780050491, -363.2839162966686, -695.3522114686521, -751.3573384112962, -208.7081855462755, -1108.2330285451453, -652.6965853718854, -464.0601094544205, -887.1230092035811, -802.3033940630345, -972.0929725622984, -502.6323833875205, -562.0819341147709, -581.5354581975254, -276.6020633975063, -132.51577003510738, -1046.5152775147271, -1005.4012943867008, -706.0350404929932, -1023.4543077398877, -694.4738503423625, -1001.2203619254719, -447.77640068751674, -565.4509856087752, -843.0199323822014, -743.1018058792031, -807.9169410740809, -534.740877759191, -477.57233608167354, -660.0448547929971, -555.5754298678805, -889.4935975883565, -960.0020571566677, -785.8899513613397, -547.2393418950807, -753.8474531956028, -705.8748548470988, -499.63766870525393, -587.2990129347603, -1029.4519221866965, -1063.7071290471017, -416.0609533492056, -646.4888566914689, -853.4483864223863, -87.79239634669334, -703.1543522663186, -1199.5059154913954, -734.011189030798, -782.0467341631758, -398.23033227842274, -392.9022676824888, -297.5629344151395, -907.7619635207685, -739.5213640546924, -782.1311590987971, -905.5717679354882, -602.380130343424, -708.3650582700013, -430.50418983353285, -970.9994717277822, -1266.3136013019518, -607.4929991382483, -662.652147980859, -800.4796053748911, -1022.8275647874522, -533.0440590859974, -536.2945379851612, -525.6451557555459, -328.73049546751963, -552.5172944270164, -1231.7595440120178, -1199.929583322283, -887.2065235996263, -609.0610357834561, -956.716620787246, -703.8169166214304, -949.0181711175571, -991.3631612848823, -222.56932517299438, -342.63323613557816, -1163.4711016445574, -1205.140136665874, -1006.9964107607044, -970.2798777434989, -1336.9947964311223, -484.61302521654784, -678.2890453688404, -1035.1824409273167, -48.49959544225369, -151.57358768459844, -625.2096000021729, -431.9793436309748, -1023.3408640365543, -167.8362778223137, -1194.0319388561077, -569.4547906770133, -642.1650668654986, -77.33659960003227, -370.3751188244642, -28.51765695514313]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5529708561900761, "mean_inference_ms": 1.6903037496287476, "mean_action_processing_ms": 0.280240322086105, "mean_env_wait_ms": 3.025470445517668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011632442474365234, "StateBufferConnector_ms": 0.007884025573730469, "ViewRequirementAgentConnector_ms": 0.19301462173461914}, "num_episodes": 30, "episode_return_max": -28.51765695514313, "episode_return_min": -1336.9947964311223, "episode_return_mean": -694.6334200073366, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.51567561276, "num_env_steps_trained_throughput_per_sec": 295.51567561276, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12186.883, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12186.811, "sample_time_ms": 1033.103, "learn_time_ms": 11090.444, "learn_throughput": 360.671, "synch_weights_time_ms": 62.436}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "f3b06_00008", "date": "2024-08-03_11-03-29", "timestamp": 1722663209, "time_this_iter_s": 13.547972679138184, "time_total_s": 250.82799315452576, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c576a70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 250.82799315452576, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.547368421052633, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 171.90766112605732, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.071807674349596, "policy_loss": -0.00867215522545545, "vf_loss": 2.0912982654447356, "vf_explained_var": 0.9898961812878648, "kl": 0.015466837414654353, "entropy": 1.5458492464075486, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -16.043609835094898, "episode_reward_min": -1336.9947964311223, "episode_reward_mean": -697.3919172517255, "episode_len_mean": 137.79, "episode_media": {}, "episodes_timesteps_total": 13779, "policy_reward_min": {"policy_0": -1336.9947964311223}, "policy_reward_max": {"policy_0": -16.043609835094898}, "policy_reward_mean": {"policy_0": -697.3919172517255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-889.4935975883565, -960.0020571566677, -785.8899513613397, -547.2393418950807, -753.8474531956028, -705.8748548470988, -499.63766870525393, -587.2990129347603, -1029.4519221866965, -1063.7071290471017, -416.0609533492056, -646.4888566914689, -853.4483864223863, -87.79239634669334, -703.1543522663186, -1199.5059154913954, -734.011189030798, -782.0467341631758, -398.23033227842274, -392.9022676824888, -297.5629344151395, -907.7619635207685, -739.5213640546924, -782.1311590987971, -905.5717679354882, -602.380130343424, -708.3650582700013, -430.50418983353285, -970.9994717277822, -1266.3136013019518, -607.4929991382483, -662.652147980859, -800.4796053748911, -1022.8275647874522, -533.0440590859974, -536.2945379851612, -525.6451557555459, -328.73049546751963, -552.5172944270164, -1231.7595440120178, -1199.929583322283, -887.2065235996263, -609.0610357834561, -956.716620787246, -703.8169166214304, -949.0181711175571, -991.3631612848823, -222.56932517299438, -342.63323613557816, -1163.4711016445574, -1205.140136665874, -1006.9964107607044, -970.2798777434989, -1336.9947964311223, -484.61302521654784, -678.2890453688404, -1035.1824409273167, -48.49959544225369, -151.57358768459844, -625.2096000021729, -431.9793436309748, -1023.3408640365543, -167.8362778223137, -1194.0319388561077, -569.4547906770133, -642.1650668654986, -77.33659960003227, -370.3751188244642, -28.51765695514313, -320.41034110556143, -271.19936925324066, -559.8719185313383, -914.6497548193324, -644.7012589817714, -339.1243581176948, -616.5799488719808, -66.2192179387846, -371.3593449238242, -586.0682005987534, -161.7634232589609, -1096.8103695165253, -851.2690284547136, -741.8482704764356, -862.9660061069432, -551.9357708410505, -23.2223494384128, -981.8618295066485, -1172.9448656869565, -198.15225512678794, -1162.5441298826665, -16.043609835094898, -1068.2841035140195, -814.9919714210573, -1026.2671244571925, -1250.251722632086, -789.3506481758421, -806.6468539713117, -997.8187400880223, -693.7259576860781, -1258.067715816226], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 141, 86, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 65, 150, 150, 150, 109, 150, 150, 150, 66, 125, 53, 90, 90, 150, 150, 150, 150, 150, 74, 123, 150, 71, 150, 150, 150, 150, 135, 54, 150, 150, 114, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-889.4935975883565, -960.0020571566677, -785.8899513613397, -547.2393418950807, -753.8474531956028, -705.8748548470988, -499.63766870525393, -587.2990129347603, -1029.4519221866965, -1063.7071290471017, -416.0609533492056, -646.4888566914689, -853.4483864223863, -87.79239634669334, -703.1543522663186, -1199.5059154913954, -734.011189030798, -782.0467341631758, -398.23033227842274, -392.9022676824888, -297.5629344151395, -907.7619635207685, -739.5213640546924, -782.1311590987971, -905.5717679354882, -602.380130343424, -708.3650582700013, -430.50418983353285, -970.9994717277822, -1266.3136013019518, -607.4929991382483, -662.652147980859, -800.4796053748911, -1022.8275647874522, -533.0440590859974, -536.2945379851612, -525.6451557555459, -328.73049546751963, -552.5172944270164, -1231.7595440120178, -1199.929583322283, -887.2065235996263, -609.0610357834561, -956.716620787246, -703.8169166214304, -949.0181711175571, -991.3631612848823, -222.56932517299438, -342.63323613557816, -1163.4711016445574, -1205.140136665874, -1006.9964107607044, -970.2798777434989, -1336.9947964311223, -484.61302521654784, -678.2890453688404, -1035.1824409273167, -48.49959544225369, -151.57358768459844, -625.2096000021729, -431.9793436309748, -1023.3408640365543, -167.8362778223137, -1194.0319388561077, -569.4547906770133, -642.1650668654986, -77.33659960003227, -370.3751188244642, -28.51765695514313, -320.41034110556143, -271.19936925324066, -559.8719185313383, -914.6497548193324, -644.7012589817714, -339.1243581176948, -616.5799488719808, -66.2192179387846, -371.3593449238242, -586.0682005987534, -161.7634232589609, -1096.8103695165253, -851.2690284547136, -741.8482704764356, -862.9660061069432, -551.9357708410505, -23.2223494384128, -981.8618295066485, -1172.9448656869565, -198.15225512678794, -1162.5441298826665, -16.043609835094898, -1068.2841035140195, -814.9919714210573, -1026.2671244571925, -1250.251722632086, -789.3506481758421, -806.6468539713117, -997.8187400880223, -693.7259576860781, -1258.067715816226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522102757432422, "mean_inference_ms": 1.6898146854585852, "mean_action_processing_ms": 0.2802363879166726, "mean_env_wait_ms": 3.022188328993089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011943578720092773, "StateBufferConnector_ms": 0.007941246032714844, "ViewRequirementAgentConnector_ms": 0.19522356986999512}, "num_episodes": 31, "episode_return_max": -16.043609835094898, "episode_return_min": -1336.9947964311223, "episode_return_mean": -697.3919172517255, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.6720990275776, "num_env_steps_trained_throughput_per_sec": 303.6720990275776, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12284.557, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12284.483, "sample_time_ms": 1033.03, "learn_time_ms": 11188.49, "learn_throughput": 357.51, "synch_weights_time_ms": 62.137}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "f3b06_00008", "date": "2024-08-03_11-03-42", "timestamp": 1722663222, "time_this_iter_s": 13.184377908706665, "time_total_s": 264.0123710632324, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a26c5d1f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 264.0123710632324, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.6, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 168.36811313231786, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.1490163703759513, "policy_loss": -0.01813567455149799, "vf_loss": 2.1775882062812646, "vf_explained_var": 0.9865453739340106, "kl": 0.015482414825479901, "entropy": 1.508088516443968, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -16.043609835094898, "episode_reward_min": -1336.9947964311223, "episode_reward_mean": -680.4278622698803, "episode_len_mean": 135.36, "episode_media": {}, "episodes_timesteps_total": 13536, "policy_reward_min": {"policy_0": -1336.9947964311223}, "policy_reward_max": {"policy_0": -16.043609835094898}, "policy_reward_mean": {"policy_0": -680.4278622698803}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1266.3136013019518, -607.4929991382483, -662.652147980859, -800.4796053748911, -1022.8275647874522, -533.0440590859974, -536.2945379851612, -525.6451557555459, -328.73049546751963, -552.5172944270164, -1231.7595440120178, -1199.929583322283, -887.2065235996263, -609.0610357834561, -956.716620787246, -703.8169166214304, -949.0181711175571, -991.3631612848823, -222.56932517299438, -342.63323613557816, -1163.4711016445574, -1205.140136665874, -1006.9964107607044, -970.2798777434989, -1336.9947964311223, -484.61302521654784, -678.2890453688404, -1035.1824409273167, -48.49959544225369, -151.57358768459844, -625.2096000021729, -431.9793436309748, -1023.3408640365543, -167.8362778223137, -1194.0319388561077, -569.4547906770133, -642.1650668654986, -77.33659960003227, -370.3751188244642, -28.51765695514313, -320.41034110556143, -271.19936925324066, -559.8719185313383, -914.6497548193324, -644.7012589817714, -339.1243581176948, -616.5799488719808, -66.2192179387846, -371.3593449238242, -586.0682005987534, -161.7634232589609, -1096.8103695165253, -851.2690284547136, -741.8482704764356, -862.9660061069432, -551.9357708410505, -23.2223494384128, -981.8618295066485, -1172.9448656869565, -198.15225512678794, -1162.5441298826665, -16.043609835094898, -1068.2841035140195, -814.9919714210573, -1026.2671244571925, -1250.251722632086, -789.3506481758421, -806.6468539713117, -997.8187400880223, -693.7259576860781, -1258.067715816226, -1023.2895060314011, -505.9082851411834, -572.3781077234507, -110.30996475071561, -812.4705322031311, -300.22470921525365, -843.0972563841462, -868.2470846257276, -155.92902292389562, -1012.0070472954033, -579.9971919065889, -915.1867397938096, -787.2735916551951, -1281.5298399513624, -707.4274146480527, -32.870018961347604, -440.4870896117433, -718.8742266891676, -202.64837225218602, -251.30194144009087, -1192.631207909627, -943.0037936185888, -596.0304968222467, -893.163884781328, -747.9673753879382, -379.1720325099388, -312.66319708871146, -690.9942789248923, -807.3927034082867], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 65, 150, 150, 150, 109, 150, 150, 150, 66, 125, 53, 90, 90, 150, 150, 150, 150, 150, 74, 123, 150, 71, 150, 150, 150, 150, 135, 54, 150, 150, 114, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 62, 150, 97, 150, 150, 117, 150, 150, 150, 150, 150, 150, 60, 150, 150, 109, 77, 150, 150, 139, 150, 150, 109, 150, 150, 150], "policy_policy_0_reward": [-1266.3136013019518, -607.4929991382483, -662.652147980859, -800.4796053748911, -1022.8275647874522, -533.0440590859974, -536.2945379851612, -525.6451557555459, -328.73049546751963, -552.5172944270164, -1231.7595440120178, -1199.929583322283, -887.2065235996263, -609.0610357834561, -956.716620787246, -703.8169166214304, -949.0181711175571, -991.3631612848823, -222.56932517299438, -342.63323613557816, -1163.4711016445574, -1205.140136665874, -1006.9964107607044, -970.2798777434989, -1336.9947964311223, -484.61302521654784, -678.2890453688404, -1035.1824409273167, -48.49959544225369, -151.57358768459844, -625.2096000021729, -431.9793436309748, -1023.3408640365543, -167.8362778223137, -1194.0319388561077, -569.4547906770133, -642.1650668654986, -77.33659960003227, -370.3751188244642, -28.51765695514313, -320.41034110556143, -271.19936925324066, -559.8719185313383, -914.6497548193324, -644.7012589817714, -339.1243581176948, -616.5799488719808, -66.2192179387846, -371.3593449238242, -586.0682005987534, -161.7634232589609, -1096.8103695165253, -851.2690284547136, -741.8482704764356, -862.9660061069432, -551.9357708410505, -23.2223494384128, -981.8618295066485, -1172.9448656869565, -198.15225512678794, -1162.5441298826665, -16.043609835094898, -1068.2841035140195, -814.9919714210573, -1026.2671244571925, -1250.251722632086, -789.3506481758421, -806.6468539713117, -997.8187400880223, -693.7259576860781, -1258.067715816226, -1023.2895060314011, -505.9082851411834, -572.3781077234507, -110.30996475071561, -812.4705322031311, -300.22470921525365, -843.0972563841462, -868.2470846257276, -155.92902292389562, -1012.0070472954033, -579.9971919065889, -915.1867397938096, -787.2735916551951, -1281.5298399513624, -707.4274146480527, -32.870018961347604, -440.4870896117433, -718.8742266891676, -202.64837225218602, -251.30194144009087, -1192.631207909627, -943.0037936185888, -596.0304968222467, -893.163884781328, -747.9673753879382, -379.1720325099388, -312.66319708871146, -690.9942789248923, -807.3927034082867]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526985154089838, "mean_inference_ms": 1.690067578560321, "mean_action_processing_ms": 0.28025766978963446, "mean_env_wait_ms": 3.025998618922888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011911630630493164, "StateBufferConnector_ms": 0.007971048355102539, "ViewRequirementAgentConnector_ms": 0.19344544410705566}, "num_episodes": 29, "episode_return_max": -16.043609835094898, "episode_return_min": -1336.9947964311223, "episode_return_mean": -680.4278622698803, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.68718593836815, "num_env_steps_trained_throughput_per_sec": 301.68718593836815, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12278.55, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12278.477, "sample_time_ms": 1030.165, "learn_time_ms": 11184.393, "learn_throughput": 357.641, "synch_weights_time_ms": 63.062}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "f3b06_00008", "date": "2024-08-03_11-03-55", "timestamp": 1722663235, "time_this_iter_s": 13.271537780761719, "time_total_s": 277.28390884399414, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f53f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 277.28390884399414, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.394736842105264, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 172.6687105168899, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.204594226864477, "policy_loss": -0.018353180865718362, "vf_loss": 2.232693892655273, "vf_explained_var": 0.9879412698249023, "kl": 0.01636265758409839, "entropy": 1.4655271391073863, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -16.043609835094898, "episode_reward_min": -1281.5298399513624, "episode_reward_mean": -641.5518685940584, "episode_len_mean": 134.26, "episode_media": {}, "episodes_timesteps_total": 13426, "policy_reward_min": {"policy_0": -1281.5298399513624}, "policy_reward_max": {"policy_0": -16.043609835094898}, "policy_reward_mean": {"policy_0": -641.5518685940584}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151.57358768459844, -625.2096000021729, -431.9793436309748, -1023.3408640365543, -167.8362778223137, -1194.0319388561077, -569.4547906770133, -642.1650668654986, -77.33659960003227, -370.3751188244642, -28.51765695514313, -320.41034110556143, -271.19936925324066, -559.8719185313383, -914.6497548193324, -644.7012589817714, -339.1243581176948, -616.5799488719808, -66.2192179387846, -371.3593449238242, -586.0682005987534, -161.7634232589609, -1096.8103695165253, -851.2690284547136, -741.8482704764356, -862.9660061069432, -551.9357708410505, -23.2223494384128, -981.8618295066485, -1172.9448656869565, -198.15225512678794, -1162.5441298826665, -16.043609835094898, -1068.2841035140195, -814.9919714210573, -1026.2671244571925, -1250.251722632086, -789.3506481758421, -806.6468539713117, -997.8187400880223, -693.7259576860781, -1258.067715816226, -1023.2895060314011, -505.9082851411834, -572.3781077234507, -110.30996475071561, -812.4705322031311, -300.22470921525365, -843.0972563841462, -868.2470846257276, -155.92902292389562, -1012.0070472954033, -579.9971919065889, -915.1867397938096, -787.2735916551951, -1281.5298399513624, -707.4274146480527, -32.870018961347604, -440.4870896117433, -718.8742266891676, -202.64837225218602, -251.30194144009087, -1192.631207909627, -943.0037936185888, -596.0304968222467, -893.163884781328, -747.9673753879382, -379.1720325099388, -312.66319708871146, -690.9942789248923, -807.3927034082867, -693.807694838216, -346.47378425657485, -824.1792427739209, -775.0619705486739, -1095.3466641142077, -584.3649128887791, -785.7706212288945, -895.0455149229834, -898.3874621610652, -633.7338270703574, -1158.2372394827762, -708.5938775921223, -452.0145580547591, -276.58331375882943, -822.3424891733699, -114.45196212294411, -853.4625825560311, -427.67038756714635, -639.3753996252848, -632.45970730567, -570.249054584522, -841.4085544661499, -864.7943389527235, -87.73562658897687, -262.9550142956905, -93.40705441155119, -821.9069609351142, -784.6046099557082, -1027.5142155271965], "episode_lengths": [65, 150, 150, 150, 109, 150, 150, 150, 66, 125, 53, 90, 90, 150, 150, 150, 150, 150, 74, 123, 150, 71, 150, 150, 150, 150, 135, 54, 150, 150, 114, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 62, 150, 97, 150, 150, 117, 150, 150, 150, 150, 150, 150, 60, 150, 150, 109, 77, 150, 150, 139, 150, 150, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 134, 150, 150, 150, 50, 150, 82, 150, 150, 150], "policy_policy_0_reward": [-151.57358768459844, -625.2096000021729, -431.9793436309748, -1023.3408640365543, -167.8362778223137, -1194.0319388561077, -569.4547906770133, -642.1650668654986, -77.33659960003227, -370.3751188244642, -28.51765695514313, -320.41034110556143, -271.19936925324066, -559.8719185313383, -914.6497548193324, -644.7012589817714, -339.1243581176948, -616.5799488719808, -66.2192179387846, -371.3593449238242, -586.0682005987534, -161.7634232589609, -1096.8103695165253, -851.2690284547136, -741.8482704764356, -862.9660061069432, -551.9357708410505, -23.2223494384128, -981.8618295066485, -1172.9448656869565, -198.15225512678794, -1162.5441298826665, -16.043609835094898, -1068.2841035140195, -814.9919714210573, -1026.2671244571925, -1250.251722632086, -789.3506481758421, -806.6468539713117, -997.8187400880223, -693.7259576860781, -1258.067715816226, -1023.2895060314011, -505.9082851411834, -572.3781077234507, -110.30996475071561, -812.4705322031311, -300.22470921525365, -843.0972563841462, -868.2470846257276, -155.92902292389562, -1012.0070472954033, -579.9971919065889, -915.1867397938096, -787.2735916551951, -1281.5298399513624, -707.4274146480527, -32.870018961347604, -440.4870896117433, -718.8742266891676, -202.64837225218602, -251.30194144009087, -1192.631207909627, -943.0037936185888, -596.0304968222467, -893.163884781328, -747.9673753879382, -379.1720325099388, -312.66319708871146, -690.9942789248923, -807.3927034082867, -693.807694838216, -346.47378425657485, -824.1792427739209, -775.0619705486739, -1095.3466641142077, -584.3649128887791, -785.7706212288945, -895.0455149229834, -898.3874621610652, -633.7338270703574, -1158.2372394827762, -708.5938775921223, -452.0145580547591, -276.58331375882943, -822.3424891733699, -114.45196212294411, -853.4625825560311, -427.67038756714635, -639.3753996252848, -632.45970730567, -570.249054584522, -841.4085544661499, -864.7943389527235, -87.73562658897687, -262.9550142956905, -93.40705441155119, -821.9069609351142, -784.6046099557082, -1027.5142155271965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5528515061958403, "mean_inference_ms": 1.6898927619582529, "mean_action_processing_ms": 0.2800535908077783, "mean_env_wait_ms": 3.026391279137655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012091875076293945, "StateBufferConnector_ms": 0.007921457290649414, "ViewRequirementAgentConnector_ms": 0.19453763961791992}, "num_episodes": 29, "episode_return_max": -16.043609835094898, "episode_return_min": -1281.5298399513624, "episode_return_mean": -641.5518685940584, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.17995622709907, "num_env_steps_trained_throughput_per_sec": 298.17995622709907, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12653.291, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12653.217, "sample_time_ms": 1030.266, "learn_time_ms": 11557.129, "learn_throughput": 346.107, "synch_weights_time_ms": 64.948}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "f3b06_00008", "date": "2024-08-03_11-04-09", "timestamp": 1722663249, "time_this_iter_s": 13.427947521209717, "time_total_s": 290.71185636520386, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246fae0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 290.71185636520386, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.505263157894738, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 142.6698930780093, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.181588359984259, "policy_loss": -0.016787677333923057, "vf_loss": 2.2082151734580595, "vf_explained_var": 0.9783384348576267, "kl": 0.01729089487259142, "entropy": 1.502640210588773, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -16.043609835094898, "episode_reward_min": -1281.5298399513624, "episode_reward_mean": -652.282383643668, "episode_len_mean": 136.53, "episode_media": {}, "episodes_timesteps_total": 13653, "policy_reward_min": {"policy_0": -1281.5298399513624}, "policy_reward_max": {"policy_0": -16.043609835094898}, "policy_reward_mean": {"policy_0": -652.282383643668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.043609835094898, -1068.2841035140195, -814.9919714210573, -1026.2671244571925, -1250.251722632086, -789.3506481758421, -806.6468539713117, -997.8187400880223, -693.7259576860781, -1258.067715816226, -1023.2895060314011, -505.9082851411834, -572.3781077234507, -110.30996475071561, -812.4705322031311, -300.22470921525365, -843.0972563841462, -868.2470846257276, -155.92902292389562, -1012.0070472954033, -579.9971919065889, -915.1867397938096, -787.2735916551951, -1281.5298399513624, -707.4274146480527, -32.870018961347604, -440.4870896117433, -718.8742266891676, -202.64837225218602, -251.30194144009087, -1192.631207909627, -943.0037936185888, -596.0304968222467, -893.163884781328, -747.9673753879382, -379.1720325099388, -312.66319708871146, -690.9942789248923, -807.3927034082867, -693.807694838216, -346.47378425657485, -824.1792427739209, -775.0619705486739, -1095.3466641142077, -584.3649128887791, -785.7706212288945, -895.0455149229834, -898.3874621610652, -633.7338270703574, -1158.2372394827762, -708.5938775921223, -452.0145580547591, -276.58331375882943, -822.3424891733699, -114.45196212294411, -853.4625825560311, -427.67038756714635, -639.3753996252848, -632.45970730567, -570.249054584522, -841.4085544661499, -864.7943389527235, -87.73562658897687, -262.9550142956905, -93.40705441155119, -821.9069609351142, -784.6046099557082, -1027.5142155271965, -355.5039938785967, -876.6674832445563, -976.4270015539845, -162.62881222650847, -381.0033164934297, -869.349357617071, -701.9577962785705, -300.5805420765393, -968.002158541755, -389.2524979445035, -492.8974819100629, -728.1423357615116, -651.0920128321751, -637.9523456835802, -468.3387276245721, -692.9674743849969, -900.0730099506378, -1091.7805424004564, -228.6020139397387, -683.2960557223754, -36.21843269451392, -334.20989501477237, -644.2893704347385, -278.4419098070843, -406.5483683155026, -575.315201775636, -821.4555650882867, -1073.8326986227376, -273.8881307152919, -176.48506025181726, -939.460830209805, -733.7139383584063], "episode_lengths": [47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 62, 150, 97, 150, 150, 117, 150, 150, 150, 150, 150, 150, 60, 150, 150, 109, 77, 150, 150, 139, 150, 150, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 134, 150, 150, 150, 50, 150, 82, 150, 150, 150, 124, 150, 150, 76, 144, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 58, 100, 150, 107, 150, 150, 150, 150, 92, 63, 150, 150], "policy_policy_0_reward": [-16.043609835094898, -1068.2841035140195, -814.9919714210573, -1026.2671244571925, -1250.251722632086, -789.3506481758421, -806.6468539713117, -997.8187400880223, -693.7259576860781, -1258.067715816226, -1023.2895060314011, -505.9082851411834, -572.3781077234507, -110.30996475071561, -812.4705322031311, -300.22470921525365, -843.0972563841462, -868.2470846257276, -155.92902292389562, -1012.0070472954033, -579.9971919065889, -915.1867397938096, -787.2735916551951, -1281.5298399513624, -707.4274146480527, -32.870018961347604, -440.4870896117433, -718.8742266891676, -202.64837225218602, -251.30194144009087, -1192.631207909627, -943.0037936185888, -596.0304968222467, -893.163884781328, -747.9673753879382, -379.1720325099388, -312.66319708871146, -690.9942789248923, -807.3927034082867, -693.807694838216, -346.47378425657485, -824.1792427739209, -775.0619705486739, -1095.3466641142077, -584.3649128887791, -785.7706212288945, -895.0455149229834, -898.3874621610652, -633.7338270703574, -1158.2372394827762, -708.5938775921223, -452.0145580547591, -276.58331375882943, -822.3424891733699, -114.45196212294411, -853.4625825560311, -427.67038756714635, -639.3753996252848, -632.45970730567, -570.249054584522, -841.4085544661499, -864.7943389527235, -87.73562658897687, -262.9550142956905, -93.40705441155119, -821.9069609351142, -784.6046099557082, -1027.5142155271965, -355.5039938785967, -876.6674832445563, -976.4270015539845, -162.62881222650847, -381.0033164934297, -869.349357617071, -701.9577962785705, -300.5805420765393, -968.002158541755, -389.2524979445035, -492.8974819100629, -728.1423357615116, -651.0920128321751, -637.9523456835802, -468.3387276245721, -692.9674743849969, -900.0730099506378, -1091.7805424004564, -228.6020139397387, -683.2960557223754, -36.21843269451392, -334.20989501477237, -644.2893704347385, -278.4419098070843, -406.5483683155026, -575.315201775636, -821.4555650882867, -1073.8326986227376, -273.8881307152919, -176.48506025181726, -939.460830209805, -733.7139383584063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533434495928659, "mean_inference_ms": 1.6908389668861727, "mean_action_processing_ms": 0.27999775659525605, "mean_env_wait_ms": 3.027369822815954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012078285217285156, "StateBufferConnector_ms": 0.00800633430480957, "ViewRequirementAgentConnector_ms": 0.19616293907165527}, "num_episodes": 32, "episode_return_max": -16.043609835094898, "episode_return_min": -1281.5298399513624, "episode_return_mean": -652.282383643668, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.58605166108873, "num_env_steps_trained_throughput_per_sec": 295.58605166108873, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12804.863, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12804.788, "sample_time_ms": 1038.495, "learn_time_ms": 11700.258, "learn_throughput": 341.873, "synch_weights_time_ms": 65.159}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "f3b06_00008", "date": "2024-08-03_11-04-22", "timestamp": 1722663262, "time_this_iter_s": 13.54517674446106, "time_total_s": 304.2570331096649, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246f53d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 304.2570331096649, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.805263157894737, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.73250739574434, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.135586317939063, "policy_loss": -0.013944629455121078, "vf_loss": 2.161249842122197, "vf_explained_var": 0.9846996103723844, "kl": 0.014932385678184801, "entropy": 1.61986097941796, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -4.866491812246591, "episode_reward_min": -1352.4458506775013, "episode_reward_mean": -628.8434550218523, "episode_len_mean": 134.93, "episode_media": {}, "episodes_timesteps_total": 13493, "policy_reward_min": {"policy_0": -1352.4458506775013}, "policy_reward_max": {"policy_0": -4.866491812246591}, "policy_reward_mean": {"policy_0": -628.8434550218523}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-718.8742266891676, -202.64837225218602, -251.30194144009087, -1192.631207909627, -943.0037936185888, -596.0304968222467, -893.163884781328, -747.9673753879382, -379.1720325099388, -312.66319708871146, -690.9942789248923, -807.3927034082867, -693.807694838216, -346.47378425657485, -824.1792427739209, -775.0619705486739, -1095.3466641142077, -584.3649128887791, -785.7706212288945, -895.0455149229834, -898.3874621610652, -633.7338270703574, -1158.2372394827762, -708.5938775921223, -452.0145580547591, -276.58331375882943, -822.3424891733699, -114.45196212294411, -853.4625825560311, -427.67038756714635, -639.3753996252848, -632.45970730567, -570.249054584522, -841.4085544661499, -864.7943389527235, -87.73562658897687, -262.9550142956905, -93.40705441155119, -821.9069609351142, -784.6046099557082, -1027.5142155271965, -355.5039938785967, -876.6674832445563, -976.4270015539845, -162.62881222650847, -381.0033164934297, -869.349357617071, -701.9577962785705, -300.5805420765393, -968.002158541755, -389.2524979445035, -492.8974819100629, -728.1423357615116, -651.0920128321751, -637.9523456835802, -468.3387276245721, -692.9674743849969, -900.0730099506378, -1091.7805424004564, -228.6020139397387, -683.2960557223754, -36.21843269451392, -334.20989501477237, -644.2893704347385, -278.4419098070843, -406.5483683155026, -575.315201775636, -821.4555650882867, -1073.8326986227376, -273.8881307152919, -176.48506025181726, -939.460830209805, -733.7139383584063, -158.81646294019694, -448.2671313659394, -268.85627453576257, -76.13798542782096, -798.2973893961025, -1231.9168742489467, -321.9128799092705, -828.7334722101266, -1037.928065502412, -746.3594060171811, -378.1451519805746, -635.5776182598191, -29.40058241787594, -889.2776957381845, -1207.3542619614805, -620.585174710664, -4.866491812246591, -914.0662385420416, -668.0083959671152, -1352.4458506775013, -892.3877314935382, -390.81198774003155, -891.194524198313, -387.1431631745735, -642.5339733636016, -946.0453021933882, -559.1189024530688], "episode_lengths": [150, 109, 77, 150, 150, 139, 150, 150, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 134, 150, 150, 150, 50, 150, 82, 150, 150, 150, 124, 150, 150, 76, 144, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 58, 100, 150, 107, 150, 150, 150, 150, 92, 63, 150, 150, 97, 150, 107, 50, 150, 150, 102, 150, 150, 150, 150, 150, 46, 150, 150, 150, 44, 150, 150, 150, 150, 107, 150, 112, 150, 150, 150], "policy_policy_0_reward": [-718.8742266891676, -202.64837225218602, -251.30194144009087, -1192.631207909627, -943.0037936185888, -596.0304968222467, -893.163884781328, -747.9673753879382, -379.1720325099388, -312.66319708871146, -690.9942789248923, -807.3927034082867, -693.807694838216, -346.47378425657485, -824.1792427739209, -775.0619705486739, -1095.3466641142077, -584.3649128887791, -785.7706212288945, -895.0455149229834, -898.3874621610652, -633.7338270703574, -1158.2372394827762, -708.5938775921223, -452.0145580547591, -276.58331375882943, -822.3424891733699, -114.45196212294411, -853.4625825560311, -427.67038756714635, -639.3753996252848, -632.45970730567, -570.249054584522, -841.4085544661499, -864.7943389527235, -87.73562658897687, -262.9550142956905, -93.40705441155119, -821.9069609351142, -784.6046099557082, -1027.5142155271965, -355.5039938785967, -876.6674832445563, -976.4270015539845, -162.62881222650847, -381.0033164934297, -869.349357617071, -701.9577962785705, -300.5805420765393, -968.002158541755, -389.2524979445035, -492.8974819100629, -728.1423357615116, -651.0920128321751, -637.9523456835802, -468.3387276245721, -692.9674743849969, -900.0730099506378, -1091.7805424004564, -228.6020139397387, -683.2960557223754, -36.21843269451392, -334.20989501477237, -644.2893704347385, -278.4419098070843, -406.5483683155026, -575.315201775636, -821.4555650882867, -1073.8326986227376, -273.8881307152919, -176.48506025181726, -939.460830209805, -733.7139383584063, -158.81646294019694, -448.2671313659394, -268.85627453576257, -76.13798542782096, -798.2973893961025, -1231.9168742489467, -321.9128799092705, -828.7334722101266, -1037.928065502412, -746.3594060171811, -378.1451519805746, -635.5776182598191, -29.40058241787594, -889.2776957381845, -1207.3542619614805, -620.585174710664, -4.866491812246591, -914.0662385420416, -668.0083959671152, -1352.4458506775013, -892.3877314935382, -390.81198774003155, -891.194524198313, -387.1431631745735, -642.5339733636016, -946.0453021933882, -559.1189024530688]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553094179150063, "mean_inference_ms": 1.691232598980345, "mean_action_processing_ms": 0.2799766177422137, "mean_env_wait_ms": 3.026597257210634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012099981307983398, "StateBufferConnector_ms": 0.008015632629394531, "ViewRequirementAgentConnector_ms": 0.19736361503601074}, "num_episodes": 27, "episode_return_max": -4.866491812246591, "episode_return_min": -1352.4458506775013, "episode_return_mean": -628.8434550218523, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.37195476035043, "num_env_steps_trained_throughput_per_sec": 303.37195476035043, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12882.244, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12882.17, "sample_time_ms": 1034.972, "learn_time_ms": 11780.577, "learn_throughput": 339.542, "synch_weights_time_ms": 65.731}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "f3b06_00008", "date": "2024-08-03_11-04-36", "timestamp": 1722663276, "time_this_iter_s": 13.199582576751709, "time_total_s": 317.4566156864166, "pid": 518929, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x77a246fadcf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 317.4566156864166, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.29473684210526, "ram_util_percent": 27.7}}
