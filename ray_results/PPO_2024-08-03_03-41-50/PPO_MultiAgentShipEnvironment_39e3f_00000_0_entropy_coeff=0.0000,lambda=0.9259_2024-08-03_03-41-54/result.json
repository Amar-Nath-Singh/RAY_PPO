{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0008221758529543, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.598490412036577, "policy_loss": -0.004337323795577201, "vf_loss": 9.601586087544758, "vf_explained_var": 0.05648989267647266, "kl": 0.006279354121223453, "entropy": 1.4201480840643248, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -54.43745500110189, "episode_reward_min": -1108.3226521446104, "episode_reward_mean": -683.4021882604737, "episode_len_mean": 139.1304347826087, "episode_media": {}, "episodes_timesteps_total": 3200, "policy_reward_min": {"policy_0": -1108.3226521446104}, "policy_reward_max": {"policy_0": -54.43745500110189}, "policy_reward_mean": {"policy_0": -683.4021882604737}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-965.2886175544259, -1108.3226521446104, -626.5479147225071, -968.9329035472153, -535.9693703348231, -54.43745500110189, -852.4325653878333, -400.90262487114995, -901.2182342487667, -335.8201249486789, -491.640493066322, -870.8850560400393, -955.3536047950205, -785.8142913913372, -660.9676084144478, -928.2710520525844, -861.4329376845699, -749.2705324294104, -608.2136454076423, -847.788503070178, -352.05371669311023, -768.8204205880271, -87.86600559709197], "episode_lengths": [150, 150, 150, 150, 150, 62, 150, 98, 150, 121, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79], "policy_policy_0_reward": [-965.2886175544259, -1108.3226521446104, -626.5479147225071, -968.9329035472153, -535.9693703348231, -54.43745500110189, -852.4325653878333, -400.90262487114995, -901.2182342487667, -335.8201249486789, -491.640493066322, -870.8850560400393, -955.3536047950205, -785.8142913913372, -660.9676084144478, -928.2710520525844, -861.4329376845699, -749.2705324294104, -608.2136454076423, -847.788503070178, -352.05371669311023, -768.8204205880271, -87.86600559709197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5695863473744739, "mean_inference_ms": 1.6752096729546824, "mean_action_processing_ms": 0.2821823407982898, "mean_env_wait_ms": 2.9668224166817825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011305187059485394, "StateBufferConnector_ms": 0.007922753043796705, "ViewRequirementAgentConnector_ms": 0.17680707185164743}, "num_episodes": 23, "episode_return_max": -54.43745500110189, "episode_return_min": -1108.3226521446104, "episode_return_mean": -683.4021882604737, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.5638998973257, "num_env_steps_trained_throughput_per_sec": 308.5638998973257, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12963.289, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12963.221, "sample_time_ms": 1041.507, "learn_time_ms": 11851.353, "learn_throughput": 337.514, "synch_weights_time_ms": 69.25}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "39e3f_00000", "date": "2024-08-03_03-42-23", "timestamp": 1722636743, "time_this_iter_s": 12.974212884902954, "time_total_s": 12.974212884902954, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190e194700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.974212884902954, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.557894736842105, "ram_util_percent": 26.81578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0046926751732825, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.17875329653422, "policy_loss": -0.00838819473865442, "vf_loss": 9.185209020972252, "vf_explained_var": 0.1638580889751514, "kl": 0.009733213897440389, "entropy": 1.4145818470666807, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -9.875327478242816, "episode_reward_min": -1194.3233909254334, "episode_reward_mean": -647.2064544706427, "episode_len_mean": 133.51020408163265, "episode_media": {}, "episodes_timesteps_total": 6542, "policy_reward_min": {"policy_0": -1194.3233909254334}, "policy_reward_max": {"policy_0": -9.875327478242816}, "policy_reward_mean": {"policy_0": -647.2064544706427}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-965.2886175544259, -1108.3226521446104, -626.5479147225071, -968.9329035472153, -535.9693703348231, -54.43745500110189, -852.4325653878333, -400.90262487114995, -901.2182342487667, -335.8201249486789, -491.640493066322, -870.8850560400393, -955.3536047950205, -785.8142913913372, -660.9676084144478, -928.2710520525844, -861.4329376845699, -749.2705324294104, -608.2136454076423, -847.788503070178, -352.05371669311023, -768.8204205880271, -87.86600559709197, -9.875327478242816, -613.8564437730029, -662.9904060934488, -330.41044036821387, -821.9499107700594, -1194.3233909254334, -1061.092497460905, -340.188254079422, -691.9824604286532, -761.0385480536419, -694.8596582165984, -891.3805489446835, -731.4510944534834, -805.3331913745894, -783.0911616779944, -262.1714617078739, -999.7885045495427, -42.010357046492274, -818.4825723653175, -167.69125939940432, -188.86675206256672, -865.5491678892259, -453.3826277931002, -1058.3878044225235, -727.9157056973471, -16.796392038828568], "episode_lengths": [150, 150, 150, 150, 150, 62, 150, 98, 150, 121, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 54, 129, 150, 105, 150, 150, 150, 142, 150, 140, 150, 150, 150, 150, 150, 89, 150, 63, 150, 114, 66, 150, 150, 150, 150, 40], "policy_policy_0_reward": [-965.2886175544259, -1108.3226521446104, -626.5479147225071, -968.9329035472153, -535.9693703348231, -54.43745500110189, -852.4325653878333, -400.90262487114995, -901.2182342487667, -335.8201249486789, -491.640493066322, -870.8850560400393, -955.3536047950205, -785.8142913913372, -660.9676084144478, -928.2710520525844, -861.4329376845699, -749.2705324294104, -608.2136454076423, -847.788503070178, -352.05371669311023, -768.8204205880271, -87.86600559709197, -9.875327478242816, -613.8564437730029, -662.9904060934488, -330.41044036821387, -821.9499107700594, -1194.3233909254334, -1061.092497460905, -340.188254079422, -691.9824604286532, -761.0385480536419, -694.8596582165984, -891.3805489446835, -731.4510944534834, -805.3331913745894, -783.0911616779944, -262.1714617078739, -999.7885045495427, -42.010357046492274, -818.4825723653175, -167.69125939940432, -188.86675206256672, -865.5491678892259, -453.3826277931002, -1058.3878044225235, -727.9157056973471, -16.796392038828568]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5657955402126309, "mean_inference_ms": 1.679162330256053, "mean_action_processing_ms": 0.2827242727054371, "mean_env_wait_ms": 2.9690332589986084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013357279252032844, "StateBufferConnector_ms": 0.00813056011589206, "ViewRequirementAgentConnector_ms": 0.18142680732571348}, "num_episodes": 26, "episode_return_max": -9.875327478242816, "episode_return_min": -1194.3233909254334, "episode_return_mean": -647.2064544706427, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.19913963953354, "num_env_steps_trained_throughput_per_sec": 331.19913963953354, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12520.315, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12520.232, "sample_time_ms": 1025.872, "learn_time_ms": 11423.374, "learn_throughput": 350.159, "synch_weights_time_ms": 70.083}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "39e3f_00000", "date": "2024-08-03_03-42-35", "timestamp": 1722636755, "time_this_iter_s": 12.089316606521606, "time_total_s": 25.06352949142456, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d961000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.06352949142456, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 22.170588235294115, "ram_util_percent": 27.005882352941175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.957120234395067, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.280260645846527, "policy_loss": -0.011909941528574563, "vf_loss": 9.289002388715744, "vf_explained_var": 0.3346602537979682, "kl": 0.015909712271843547, "entropy": 1.3757159383346638, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -9.875327478242816, "episode_reward_min": -1213.1927104203035, "episode_reward_mean": -657.812419476833, "episode_len_mean": 135.64473684210526, "episode_media": {}, "episodes_timesteps_total": 10309, "policy_reward_min": {"policy_0": -1213.1927104203035}, "policy_reward_max": {"policy_0": -9.875327478242816}, "policy_reward_mean": {"policy_0": -657.812419476833}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-965.2886175544259, -1108.3226521446104, -626.5479147225071, -968.9329035472153, -535.9693703348231, -54.43745500110189, -852.4325653878333, -400.90262487114995, -901.2182342487667, -335.8201249486789, -491.640493066322, -870.8850560400393, -955.3536047950205, -785.8142913913372, -660.9676084144478, -928.2710520525844, -861.4329376845699, -749.2705324294104, -608.2136454076423, -847.788503070178, -352.05371669311023, -768.8204205880271, -87.86600559709197, -9.875327478242816, -613.8564437730029, -662.9904060934488, -330.41044036821387, -821.9499107700594, -1194.3233909254334, -1061.092497460905, -340.188254079422, -691.9824604286532, -761.0385480536419, -694.8596582165984, -891.3805489446835, -731.4510944534834, -805.3331913745894, -783.0911616779944, -262.1714617078739, -999.7885045495427, -42.010357046492274, -818.4825723653175, -167.69125939940432, -188.86675206256672, -865.5491678892259, -453.3826277931002, -1058.3878044225235, -727.9157056973471, -16.796392038828568, -608.5280540847451, -582.2610312697915, -774.6454312753582, -338.96384510608124, -883.624988131274, -986.716463655076, -602.1172146640727, -1150.8149753798139, -686.6277166304209, -658.7350515911928, -913.2338889649259, -702.68472881055, -265.12393856634674, -148.8521954475706, -653.9641016213384, -963.9442814486794, -1213.1927104203035, -119.11497178179052, -359.13377080769754, -460.88537573274755, -421.18228094319096, -472.1719719311894, -1027.6420052525496, -469.8001232303474, -945.4618239436872, -991.8909924490772, -879.3136780379947], "episode_lengths": [150, 150, 150, 150, 150, 62, 150, 98, 150, 121, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 54, 129, 150, 105, 150, 150, 150, 142, 150, 140, 150, 150, 150, 150, 150, 89, 150, 63, 150, 114, 66, 150, 150, 150, 150, 40, 143, 150, 150, 97, 150, 150, 150, 150, 150, 147, 150, 150, 94, 64, 146, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-965.2886175544259, -1108.3226521446104, -626.5479147225071, -968.9329035472153, -535.9693703348231, -54.43745500110189, -852.4325653878333, -400.90262487114995, -901.2182342487667, -335.8201249486789, -491.640493066322, -870.8850560400393, -955.3536047950205, -785.8142913913372, -660.9676084144478, -928.2710520525844, -861.4329376845699, -749.2705324294104, -608.2136454076423, -847.788503070178, -352.05371669311023, -768.8204205880271, -87.86600559709197, -9.875327478242816, -613.8564437730029, -662.9904060934488, -330.41044036821387, -821.9499107700594, -1194.3233909254334, -1061.092497460905, -340.188254079422, -691.9824604286532, -761.0385480536419, -694.8596582165984, -891.3805489446835, -731.4510944534834, -805.3331913745894, -783.0911616779944, -262.1714617078739, -999.7885045495427, -42.010357046492274, -818.4825723653175, -167.69125939940432, -188.86675206256672, -865.5491678892259, -453.3826277931002, -1058.3878044225235, -727.9157056973471, -16.796392038828568, -608.5280540847451, -582.2610312697915, -774.6454312753582, -338.96384510608124, -883.624988131274, -986.716463655076, -602.1172146640727, -1150.8149753798139, -686.6277166304209, -658.7350515911928, -913.2338889649259, -702.68472881055, -265.12393856634674, -148.8521954475706, -653.9641016213384, -963.9442814486794, -1213.1927104203035, -119.11497178179052, -359.13377080769754, -460.88537573274755, -421.18228094319096, -472.1719719311894, -1027.6420052525496, -469.8001232303474, -945.4618239436872, -991.8909924490772, -879.3136780379947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5619360664850586, "mean_inference_ms": 1.6761383387370135, "mean_action_processing_ms": 0.2820518540750017, "mean_env_wait_ms": 2.9604982199116363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013167293448197214, "StateBufferConnector_ms": 0.0083026133085552, "ViewRequirementAgentConnector_ms": 0.18436375417207418}, "num_episodes": 27, "episode_return_max": -9.875327478242816, "episode_return_min": -1213.1927104203035, "episode_return_mean": -657.812419476833, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.38490462367923, "num_env_steps_trained_throughput_per_sec": 308.38490462367923, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12670.481, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12670.405, "sample_time_ms": 1022.876, "learn_time_ms": 11576.395, "learn_throughput": 345.531, "synch_weights_time_ms": 70.205}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "39e3f_00000", "date": "2024-08-03_03-42-48", "timestamp": 1722636768, "time_this_iter_s": 12.982576370239258, "time_total_s": 38.04610586166382, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d89d3f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.04610586166382, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 16.889473684210525, "ram_util_percent": 27.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.538999895751476, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.24914269944032, "policy_loss": -0.009044653562402043, "vf_loss": 9.25550999691089, "vf_explained_var": 0.3775278000161052, "kl": 0.013458114167951866, "entropy": 1.425270693625013, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -9.875327478242816, "episode_reward_min": -1213.1927104203035, "episode_reward_mean": -639.517525909419, "episode_len_mean": 135.38, "episode_media": {}, "episodes_timesteps_total": 13538, "policy_reward_min": {"policy_0": -1213.1927104203035}, "policy_reward_max": {"policy_0": -9.875327478242816}, "policy_reward_mean": {"policy_0": -639.517525909419}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.43745500110189, -852.4325653878333, -400.90262487114995, -901.2182342487667, -335.8201249486789, -491.640493066322, -870.8850560400393, -955.3536047950205, -785.8142913913372, -660.9676084144478, -928.2710520525844, -861.4329376845699, -749.2705324294104, -608.2136454076423, -847.788503070178, -352.05371669311023, -768.8204205880271, -87.86600559709197, -9.875327478242816, -613.8564437730029, -662.9904060934488, -330.41044036821387, -821.9499107700594, -1194.3233909254334, -1061.092497460905, -340.188254079422, -691.9824604286532, -761.0385480536419, -694.8596582165984, -891.3805489446835, -731.4510944534834, -805.3331913745894, -783.0911616779944, -262.1714617078739, -999.7885045495427, -42.010357046492274, -818.4825723653175, -167.69125939940432, -188.86675206256672, -865.5491678892259, -453.3826277931002, -1058.3878044225235, -727.9157056973471, -16.796392038828568, -608.5280540847451, -582.2610312697915, -774.6454312753582, -338.96384510608124, -883.624988131274, -986.716463655076, -602.1172146640727, -1150.8149753798139, -686.6277166304209, -658.7350515911928, -913.2338889649259, -702.68472881055, -265.12393856634674, -148.8521954475706, -653.9641016213384, -963.9442814486794, -1213.1927104203035, -119.11497178179052, -359.13377080769754, -460.88537573274755, -421.18228094319096, -472.1719719311894, -1027.6420052525496, -469.8001232303474, -945.4618239436872, -991.8909924490772, -879.3136780379947, -377.3540151413911, -643.124352551385, -550.5986240724525, -90.98718820719276, -539.5344705889022, -143.8009793736299, -1001.671793637892, -242.47436253688116, -929.2213953760977, -874.7724006564506, -309.04551516025214, -201.9210972762952, -881.6909139505858, -530.6011582247522, -538.0244300432321, -783.4604201750448, -969.4800505554346, -724.613685882574, -1075.2910413235709, -693.9474433403408, -346.74086895615045, -521.349356807626, -281.5174679532513, -1110.3824073484936, -915.7366418732936, -116.06790369398433, -993.5564285046764, -676.3836376694567, -1099.7201181248786], "episode_lengths": [62, 150, 98, 150, 121, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 54, 129, 150, 105, 150, 150, 150, 142, 150, 140, 150, 150, 150, 150, 150, 89, 150, 63, 150, 114, 66, 150, 150, 150, 150, 40, 143, 150, 150, 97, 150, 150, 150, 150, 150, 147, 150, 150, 94, 64, 146, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 69, 150, 92, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 79, 150, 150, 150], "policy_policy_0_reward": [-54.43745500110189, -852.4325653878333, -400.90262487114995, -901.2182342487667, -335.8201249486789, -491.640493066322, -870.8850560400393, -955.3536047950205, -785.8142913913372, -660.9676084144478, -928.2710520525844, -861.4329376845699, -749.2705324294104, -608.2136454076423, -847.788503070178, -352.05371669311023, -768.8204205880271, -87.86600559709197, -9.875327478242816, -613.8564437730029, -662.9904060934488, -330.41044036821387, -821.9499107700594, -1194.3233909254334, -1061.092497460905, -340.188254079422, -691.9824604286532, -761.0385480536419, -694.8596582165984, -891.3805489446835, -731.4510944534834, -805.3331913745894, -783.0911616779944, -262.1714617078739, -999.7885045495427, -42.010357046492274, -818.4825723653175, -167.69125939940432, -188.86675206256672, -865.5491678892259, -453.3826277931002, -1058.3878044225235, -727.9157056973471, -16.796392038828568, -608.5280540847451, -582.2610312697915, -774.6454312753582, -338.96384510608124, -883.624988131274, -986.716463655076, -602.1172146640727, -1150.8149753798139, -686.6277166304209, -658.7350515911928, -913.2338889649259, -702.68472881055, -265.12393856634674, -148.8521954475706, -653.9641016213384, -963.9442814486794, -1213.1927104203035, -119.11497178179052, -359.13377080769754, -460.88537573274755, -421.18228094319096, -472.1719719311894, -1027.6420052525496, -469.8001232303474, -945.4618239436872, -991.8909924490772, -879.3136780379947, -377.3540151413911, -643.124352551385, -550.5986240724525, -90.98718820719276, -539.5344705889022, -143.8009793736299, -1001.671793637892, -242.47436253688116, -929.2213953760977, -874.7724006564506, -309.04551516025214, -201.9210972762952, -881.6909139505858, -530.6011582247522, -538.0244300432321, -783.4604201750448, -969.4800505554346, -724.613685882574, -1075.2910413235709, -693.9474433403408, -346.74086895615045, -521.349356807626, -281.5174679532513, -1110.3824073484936, -915.7366418732936, -116.06790369398433, -993.5564285046764, -676.3836376694567, -1099.7201181248786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5591793478473118, "mean_inference_ms": 1.6754282063603139, "mean_action_processing_ms": 0.2820138440276092, "mean_env_wait_ms": 2.961182193642537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013461112976074219, "StateBufferConnector_ms": 0.01227426528930664, "ViewRequirementAgentConnector_ms": 0.1850121021270752}, "num_episodes": 29, "episode_return_max": -9.875327478242816, "episode_return_min": -1213.1927104203035, "episode_return_mean": -639.517525909419, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.7915150244371, "num_env_steps_trained_throughput_per_sec": 305.7915150244371, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12773.067, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12772.985, "sample_time_ms": 1021.775, "learn_time_ms": 11682.381, "learn_throughput": 342.396, "synch_weights_time_ms": 67.835}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "39e3f_00000", "date": "2024-08-03_03-43-01", "timestamp": 1722636781, "time_this_iter_s": 13.093016147613525, "time_total_s": 51.139122009277344, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d811510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.139122009277344, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.43333333333333, "ram_util_percent": 27.41111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.229582933336497, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.48098924557368, "policy_loss": -0.012508057438147565, "vf_loss": 9.49016358355681, "vf_explained_var": 0.2773852241535982, "kl": 0.016745504955057795, "entropy": 1.5362039803216854, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -14.842221113379829, "episode_reward_min": -1259.5949517331771, "episode_reward_mean": -677.1495020093372, "episode_len_mean": 137.18, "episode_media": {}, "episodes_timesteps_total": 13718, "policy_reward_min": {"policy_0": -1259.5949517331771}, "policy_reward_max": {"policy_0": -14.842221113379829}, "policy_reward_mean": {"policy_0": -677.1495020093372}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-691.9824604286532, -761.0385480536419, -694.8596582165984, -891.3805489446835, -731.4510944534834, -805.3331913745894, -783.0911616779944, -262.1714617078739, -999.7885045495427, -42.010357046492274, -818.4825723653175, -167.69125939940432, -188.86675206256672, -865.5491678892259, -453.3826277931002, -1058.3878044225235, -727.9157056973471, -16.796392038828568, -608.5280540847451, -582.2610312697915, -774.6454312753582, -338.96384510608124, -883.624988131274, -986.716463655076, -602.1172146640727, -1150.8149753798139, -686.6277166304209, -658.7350515911928, -913.2338889649259, -702.68472881055, -265.12393856634674, -148.8521954475706, -653.9641016213384, -963.9442814486794, -1213.1927104203035, -119.11497178179052, -359.13377080769754, -460.88537573274755, -421.18228094319096, -472.1719719311894, -1027.6420052525496, -469.8001232303474, -945.4618239436872, -991.8909924490772, -879.3136780379947, -377.3540151413911, -643.124352551385, -550.5986240724525, -90.98718820719276, -539.5344705889022, -143.8009793736299, -1001.671793637892, -242.47436253688116, -929.2213953760977, -874.7724006564506, -309.04551516025214, -201.9210972762952, -881.6909139505858, -530.6011582247522, -538.0244300432321, -783.4604201750448, -969.4800505554346, -724.613685882574, -1075.2910413235709, -693.9474433403408, -346.74086895615045, -521.349356807626, -281.5174679532513, -1110.3824073484936, -915.7366418732936, -116.06790369398433, -993.5564285046764, -676.3836376694567, -1099.7201181248786, -935.131197288976, -1253.6547583163024, -884.6477036371242, -14.842221113379829, -533.3249414903398, -817.2366758000504, -741.3963579876346, -1127.4115146670401, -974.76377555676, -1259.5949517331771, -1104.9626123239734, -588.8098389939646, -833.3722698309766, -834.344555278725, -514.185224840566, -701.4705167712694, -233.46981728293218, -1050.837710319119, -669.5274868274429, -93.06073625192873, -605.1998503441857, -1108.0099140602565, -1038.2634451012784, -931.963294270428, -1081.6148732662457, -379.97690927380035], "episode_lengths": [150, 140, 150, 150, 150, 150, 150, 89, 150, 63, 150, 114, 66, 150, 150, 150, 150, 40, 143, 150, 150, 97, 150, 150, 150, 150, 150, 147, 150, 150, 94, 64, 146, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 69, 150, 92, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 79, 150, 150, 150, 150, 150, 150, 41, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 80, 149, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-691.9824604286532, -761.0385480536419, -694.8596582165984, -891.3805489446835, -731.4510944534834, -805.3331913745894, -783.0911616779944, -262.1714617078739, -999.7885045495427, -42.010357046492274, -818.4825723653175, -167.69125939940432, -188.86675206256672, -865.5491678892259, -453.3826277931002, -1058.3878044225235, -727.9157056973471, -16.796392038828568, -608.5280540847451, -582.2610312697915, -774.6454312753582, -338.96384510608124, -883.624988131274, -986.716463655076, -602.1172146640727, -1150.8149753798139, -686.6277166304209, -658.7350515911928, -913.2338889649259, -702.68472881055, -265.12393856634674, -148.8521954475706, -653.9641016213384, -963.9442814486794, -1213.1927104203035, -119.11497178179052, -359.13377080769754, -460.88537573274755, -421.18228094319096, -472.1719719311894, -1027.6420052525496, -469.8001232303474, -945.4618239436872, -991.8909924490772, -879.3136780379947, -377.3540151413911, -643.124352551385, -550.5986240724525, -90.98718820719276, -539.5344705889022, -143.8009793736299, -1001.671793637892, -242.47436253688116, -929.2213953760977, -874.7724006564506, -309.04551516025214, -201.9210972762952, -881.6909139505858, -530.6011582247522, -538.0244300432321, -783.4604201750448, -969.4800505554346, -724.613685882574, -1075.2910413235709, -693.9474433403408, -346.74086895615045, -521.349356807626, -281.5174679532513, -1110.3824073484936, -915.7366418732936, -116.06790369398433, -993.5564285046764, -676.3836376694567, -1099.7201181248786, -935.131197288976, -1253.6547583163024, -884.6477036371242, -14.842221113379829, -533.3249414903398, -817.2366758000504, -741.3963579876346, -1127.4115146670401, -974.76377555676, -1259.5949517331771, -1104.9626123239734, -588.8098389939646, -833.3722698309766, -834.344555278725, -514.185224840566, -701.4705167712694, -233.46981728293218, -1050.837710319119, -669.5274868274429, -93.06073625192873, -605.1998503441857, -1108.0099140602565, -1038.2634451012784, -931.963294270428, -1081.6148732662457, -379.97690927380035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562572222420128, "mean_inference_ms": 1.6758588134428387, "mean_action_processing_ms": 0.2819422956235731, "mean_env_wait_ms": 2.957552949752056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013361454010009766, "StateBufferConnector_ms": 0.012379646301269531, "ViewRequirementAgentConnector_ms": 0.18783354759216309}, "num_episodes": 26, "episode_return_max": -14.842221113379829, "episode_return_min": -1259.5949517331771, "episode_return_mean": -677.1495020093372, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.1588101655066, "num_env_steps_trained_throughput_per_sec": 303.1588101655066, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12857.337, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12857.256, "sample_time_ms": 1020.101, "learn_time_ms": 11770.546, "learn_throughput": 339.831, "synch_weights_time_ms": 65.666}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "39e3f_00000", "date": "2024-08-03_03-43-15", "timestamp": 1722636795, "time_this_iter_s": 13.206102132797241, "time_total_s": 64.34522414207458, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d961000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 64.34522414207458, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 16.76842105263158, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.052696839875231, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.432312458753586, "policy_loss": -0.013816735884756782, "vf_loss": 9.442496206363042, "vf_explained_var": 0.17415317744016648, "kl": 0.01824135883292305, "entropy": 1.5253726487358412, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -14.842221113379829, "episode_reward_min": -1259.5949517331771, "episode_reward_mean": -706.4267737125278, "episode_len_mean": 140.32, "episode_media": {}, "episodes_timesteps_total": 14032, "policy_reward_min": {"policy_0": -1259.5949517331771}, "policy_reward_max": {"policy_0": -14.842221113379829}, "policy_reward_mean": {"policy_0": -706.4267737125278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-265.12393856634674, -148.8521954475706, -653.9641016213384, -963.9442814486794, -1213.1927104203035, -119.11497178179052, -359.13377080769754, -460.88537573274755, -421.18228094319096, -472.1719719311894, -1027.6420052525496, -469.8001232303474, -945.4618239436872, -991.8909924490772, -879.3136780379947, -377.3540151413911, -643.124352551385, -550.5986240724525, -90.98718820719276, -539.5344705889022, -143.8009793736299, -1001.671793637892, -242.47436253688116, -929.2213953760977, -874.7724006564506, -309.04551516025214, -201.9210972762952, -881.6909139505858, -530.6011582247522, -538.0244300432321, -783.4604201750448, -969.4800505554346, -724.613685882574, -1075.2910413235709, -693.9474433403408, -346.74086895615045, -521.349356807626, -281.5174679532513, -1110.3824073484936, -915.7366418732936, -116.06790369398433, -993.5564285046764, -676.3836376694567, -1099.7201181248786, -935.131197288976, -1253.6547583163024, -884.6477036371242, -14.842221113379829, -533.3249414903398, -817.2366758000504, -741.3963579876346, -1127.4115146670401, -974.76377555676, -1259.5949517331771, -1104.9626123239734, -588.8098389939646, -833.3722698309766, -834.344555278725, -514.185224840566, -701.4705167712694, -233.46981728293218, -1050.837710319119, -669.5274868274429, -93.06073625192873, -605.1998503441857, -1108.0099140602565, -1038.2634451012784, -931.963294270428, -1081.6148732662457, -379.97690927380035, -360.29841977139324, -1164.4826323646826, -610.0813280277857, -1118.2191394271347, -576.439114154659, -855.2778761707281, -651.7496638944216, -875.4682227339193, -543.0454943724347, -916.9902872027353, -873.603318333348, -968.4282742118091, -687.4549305069061, -1025.3080618808428, -657.1389495092534, -821.2881370979239, -1019.0822251027012, -1022.4358026509032, -220.1967520931911, -509.8790465402352, -913.7544089297522, -218.53273686948216, -861.8219991979925, -583.5916881932444, -1012.3376716420869, -834.021807416929, -359.6395523232779, -806.6577538239105, -853.5994928772092, -856.0350406833289], "episode_lengths": [94, 64, 146, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 69, 150, 92, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 79, 150, 150, 150, 150, 150, 150, 41, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 80, 149, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 71, 150, 136, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-265.12393856634674, -148.8521954475706, -653.9641016213384, -963.9442814486794, -1213.1927104203035, -119.11497178179052, -359.13377080769754, -460.88537573274755, -421.18228094319096, -472.1719719311894, -1027.6420052525496, -469.8001232303474, -945.4618239436872, -991.8909924490772, -879.3136780379947, -377.3540151413911, -643.124352551385, -550.5986240724525, -90.98718820719276, -539.5344705889022, -143.8009793736299, -1001.671793637892, -242.47436253688116, -929.2213953760977, -874.7724006564506, -309.04551516025214, -201.9210972762952, -881.6909139505858, -530.6011582247522, -538.0244300432321, -783.4604201750448, -969.4800505554346, -724.613685882574, -1075.2910413235709, -693.9474433403408, -346.74086895615045, -521.349356807626, -281.5174679532513, -1110.3824073484936, -915.7366418732936, -116.06790369398433, -993.5564285046764, -676.3836376694567, -1099.7201181248786, -935.131197288976, -1253.6547583163024, -884.6477036371242, -14.842221113379829, -533.3249414903398, -817.2366758000504, -741.3963579876346, -1127.4115146670401, -974.76377555676, -1259.5949517331771, -1104.9626123239734, -588.8098389939646, -833.3722698309766, -834.344555278725, -514.185224840566, -701.4705167712694, -233.46981728293218, -1050.837710319119, -669.5274868274429, -93.06073625192873, -605.1998503441857, -1108.0099140602565, -1038.2634451012784, -931.963294270428, -1081.6148732662457, -379.97690927380035, -360.29841977139324, -1164.4826323646826, -610.0813280277857, -1118.2191394271347, -576.439114154659, -855.2778761707281, -651.7496638944216, -875.4682227339193, -543.0454943724347, -916.9902872027353, -873.603318333348, -968.4282742118091, -687.4549305069061, -1025.3080618808428, -657.1389495092534, -821.2881370979239, -1019.0822251027012, -1022.4358026509032, -220.1967520931911, -509.8790465402352, -913.7544089297522, -218.53273686948216, -861.8219991979925, -583.5916881932444, -1012.3376716420869, -834.021807416929, -359.6395523232779, -806.6577538239105, -853.5994928772092, -856.0350406833289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547769787549041, "mean_inference_ms": 1.675827121407442, "mean_action_processing_ms": 0.2823987010063564, "mean_env_wait_ms": 2.962160873713742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012956380844116211, "StateBufferConnector_ms": 0.012347698211669922, "ViewRequirementAgentConnector_ms": 0.18696379661560059}, "num_episodes": 30, "episode_return_max": -14.842221113379829, "episode_return_min": -1259.5949517331771, "episode_return_mean": -706.4267737125278, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.77172196263746, "num_env_steps_trained_throughput_per_sec": 345.77172196263746, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12642.504, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12642.425, "sample_time_ms": 1047.735, "learn_time_ms": 11529.863, "learn_throughput": 346.925, "synch_weights_time_ms": 63.921}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "39e3f_00000", "date": "2024-08-03_03-43-26", "timestamp": 1722636806, "time_this_iter_s": 11.579711675643921, "time_total_s": 75.9249358177185, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d8112d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 75.9249358177185, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.61176470588235, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.66071495525539, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.047914690275986, "policy_loss": -0.012094197818078101, "vf_loss": 9.056099160512288, "vf_explained_var": 0.5192239943891763, "kl": 0.019623539408924747, "entropy": 1.4982044664522012, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -14.842221113379829, "episode_reward_min": -1288.6815739874187, "episode_reward_mean": -736.9827456257866, "episode_len_mean": 140.61, "episode_media": {}, "episodes_timesteps_total": 14061, "policy_reward_min": {"policy_0": -1288.6815739874187}, "policy_reward_max": {"policy_0": -14.842221113379829}, "policy_reward_mean": {"policy_0": -736.9827456257866}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-969.4800505554346, -724.613685882574, -1075.2910413235709, -693.9474433403408, -346.74086895615045, -521.349356807626, -281.5174679532513, -1110.3824073484936, -915.7366418732936, -116.06790369398433, -993.5564285046764, -676.3836376694567, -1099.7201181248786, -935.131197288976, -1253.6547583163024, -884.6477036371242, -14.842221113379829, -533.3249414903398, -817.2366758000504, -741.3963579876346, -1127.4115146670401, -974.76377555676, -1259.5949517331771, -1104.9626123239734, -588.8098389939646, -833.3722698309766, -834.344555278725, -514.185224840566, -701.4705167712694, -233.46981728293218, -1050.837710319119, -669.5274868274429, -93.06073625192873, -605.1998503441857, -1108.0099140602565, -1038.2634451012784, -931.963294270428, -1081.6148732662457, -379.97690927380035, -360.29841977139324, -1164.4826323646826, -610.0813280277857, -1118.2191394271347, -576.439114154659, -855.2778761707281, -651.7496638944216, -875.4682227339193, -543.0454943724347, -916.9902872027353, -873.603318333348, -968.4282742118091, -687.4549305069061, -1025.3080618808428, -657.1389495092534, -821.2881370979239, -1019.0822251027012, -1022.4358026509032, -220.1967520931911, -509.8790465402352, -913.7544089297522, -218.53273686948216, -861.8219991979925, -583.5916881932444, -1012.3376716420869, -834.021807416929, -359.6395523232779, -806.6577538239105, -853.5994928772092, -856.0350406833289, -970.5285162620806, -338.6403790862584, -916.405559707013, -986.1406028992062, -353.2422873437715, -519.6226390228409, -1179.5050655374491, -146.2703495270858, -603.1581250628481, -726.8636743846828, -268.042414050108, -729.6933899839556, -351.732897483811, -994.9076424762559, -1073.250777746495, -1220.3478305085291, -643.5409618503303, -1288.6815739874187, -1145.5486415495811, -1021.1865142634816, -366.7091017445239, -866.0585600640277, -229.35223147050053, -185.91097072312996, -901.5357721627032, -673.5327687328507, -620.4825979212641, -82.70726040873093, -500.62674678770554, -414.8203519816396, -766.5083251825629], "episode_lengths": [150, 150, 150, 150, 150, 150, 122, 150, 150, 79, 150, 150, 150, 150, 150, 150, 41, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 80, 149, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 71, 150, 136, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 105, 150, 150, 101, 150, 150, 84, 150, 100, 150, 150, 150, 150, 150, 150, 150, 141, 150, 87, 102, 150, 150, 150, 74, 146, 150, 150], "policy_policy_0_reward": [-969.4800505554346, -724.613685882574, -1075.2910413235709, -693.9474433403408, -346.74086895615045, -521.349356807626, -281.5174679532513, -1110.3824073484936, -915.7366418732936, -116.06790369398433, -993.5564285046764, -676.3836376694567, -1099.7201181248786, -935.131197288976, -1253.6547583163024, -884.6477036371242, -14.842221113379829, -533.3249414903398, -817.2366758000504, -741.3963579876346, -1127.4115146670401, -974.76377555676, -1259.5949517331771, -1104.9626123239734, -588.8098389939646, -833.3722698309766, -834.344555278725, -514.185224840566, -701.4705167712694, -233.46981728293218, -1050.837710319119, -669.5274868274429, -93.06073625192873, -605.1998503441857, -1108.0099140602565, -1038.2634451012784, -931.963294270428, -1081.6148732662457, -379.97690927380035, -360.29841977139324, -1164.4826323646826, -610.0813280277857, -1118.2191394271347, -576.439114154659, -855.2778761707281, -651.7496638944216, -875.4682227339193, -543.0454943724347, -916.9902872027353, -873.603318333348, -968.4282742118091, -687.4549305069061, -1025.3080618808428, -657.1389495092534, -821.2881370979239, -1019.0822251027012, -1022.4358026509032, -220.1967520931911, -509.8790465402352, -913.7544089297522, -218.53273686948216, -861.8219991979925, -583.5916881932444, -1012.3376716420869, -834.021807416929, -359.6395523232779, -806.6577538239105, -853.5994928772092, -856.0350406833289, -970.5285162620806, -338.6403790862584, -916.405559707013, -986.1406028992062, -353.2422873437715, -519.6226390228409, -1179.5050655374491, -146.2703495270858, -603.1581250628481, -726.8636743846828, -268.042414050108, -729.6933899839556, -351.732897483811, -994.9076424762559, -1073.250777746495, -1220.3478305085291, -643.5409618503303, -1288.6815739874187, -1145.5486415495811, -1021.1865142634816, -366.7091017445239, -866.0585600640277, -229.35223147050053, -185.91097072312996, -901.5357721627032, -673.5327687328507, -620.4825979212641, -82.70726040873093, -500.62674678770554, -414.8203519816396, -766.5083251825629]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545094460515613, "mean_inference_ms": 1.6799080941591182, "mean_action_processing_ms": 0.28319548461839605, "mean_env_wait_ms": 2.974666380857325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012773752212524414, "StateBufferConnector_ms": 0.008342504501342773, "ViewRequirementAgentConnector_ms": 0.19171714782714844}, "num_episodes": 31, "episode_return_max": -14.842221113379829, "episode_return_min": -1288.6815739874187, "episode_return_mean": -736.9827456257866, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 457.0283514924193, "num_env_steps_trained_throughput_per_sec": 457.0283514924193, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12086.747, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12086.667, "sample_time_ms": 1064.974, "learn_time_ms": 10958.857, "learn_throughput": 365.002, "synch_weights_time_ms": 61.953}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "39e3f_00000", "date": "2024-08-03_03-43-35", "timestamp": 1722636815, "time_this_iter_s": 8.7653648853302, "time_total_s": 84.6903007030487, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d8113f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 84.6903007030487, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 20.741666666666667, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.94648734057943, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.96484628667434, "policy_loss": -0.010600199385468538, "vf_loss": 8.971680656075478, "vf_explained_var": 0.6124932401503126, "kl": 0.01890343088204342, "entropy": 1.4858606828997531, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -82.70726040873093, "episode_reward_min": -1288.6815739874187, "episode_reward_mean": -722.6070991872231, "episode_len_mean": 141.3, "episode_media": {}, "episodes_timesteps_total": 14130, "policy_reward_min": {"policy_0": -1288.6815739874187}, "policy_reward_max": {"policy_0": -82.70726040873093}, "policy_reward_mean": {"policy_0": -722.6070991872231}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-833.3722698309766, -834.344555278725, -514.185224840566, -701.4705167712694, -233.46981728293218, -1050.837710319119, -669.5274868274429, -93.06073625192873, -605.1998503441857, -1108.0099140602565, -1038.2634451012784, -931.963294270428, -1081.6148732662457, -379.97690927380035, -360.29841977139324, -1164.4826323646826, -610.0813280277857, -1118.2191394271347, -576.439114154659, -855.2778761707281, -651.7496638944216, -875.4682227339193, -543.0454943724347, -916.9902872027353, -873.603318333348, -968.4282742118091, -687.4549305069061, -1025.3080618808428, -657.1389495092534, -821.2881370979239, -1019.0822251027012, -1022.4358026509032, -220.1967520931911, -509.8790465402352, -913.7544089297522, -218.53273686948216, -861.8219991979925, -583.5916881932444, -1012.3376716420869, -834.021807416929, -359.6395523232779, -806.6577538239105, -853.5994928772092, -856.0350406833289, -970.5285162620806, -338.6403790862584, -916.405559707013, -986.1406028992062, -353.2422873437715, -519.6226390228409, -1179.5050655374491, -146.2703495270858, -603.1581250628481, -726.8636743846828, -268.042414050108, -729.6933899839556, -351.732897483811, -994.9076424762559, -1073.250777746495, -1220.3478305085291, -643.5409618503303, -1288.6815739874187, -1145.5486415495811, -1021.1865142634816, -366.7091017445239, -866.0585600640277, -229.35223147050053, -185.91097072312996, -901.5357721627032, -673.5327687328507, -620.4825979212641, -82.70726040873093, -500.62674678770554, -414.8203519816396, -766.5083251825629, -780.7366315279269, -1120.5429965806334, -790.0779807709598, -1158.2603191068094, -1241.5364454255846, -90.4652604472923, -907.2329072251947, -987.4189389956267, -885.8464791707547, -646.7305514010811, -456.65038154183287, -873.0868892996252, -567.731420719252, -995.3263013052594, -154.88651157481226, -474.6695200857726, -338.14538471560275, -1136.4116385065136, -449.12084458206243, -951.057380616181, -687.9025105130314, -899.7027548351409, -411.4563890486965, -888.355328056942, -429.6471910334972], "episode_lengths": [150, 150, 150, 150, 102, 150, 150, 80, 149, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 71, 150, 136, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 105, 150, 150, 101, 150, 150, 84, 150, 100, 150, 150, 150, 150, 150, 150, 150, 141, 150, 87, 102, 150, 150, 150, 74, 146, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 131, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145], "policy_policy_0_reward": [-833.3722698309766, -834.344555278725, -514.185224840566, -701.4705167712694, -233.46981728293218, -1050.837710319119, -669.5274868274429, -93.06073625192873, -605.1998503441857, -1108.0099140602565, -1038.2634451012784, -931.963294270428, -1081.6148732662457, -379.97690927380035, -360.29841977139324, -1164.4826323646826, -610.0813280277857, -1118.2191394271347, -576.439114154659, -855.2778761707281, -651.7496638944216, -875.4682227339193, -543.0454943724347, -916.9902872027353, -873.603318333348, -968.4282742118091, -687.4549305069061, -1025.3080618808428, -657.1389495092534, -821.2881370979239, -1019.0822251027012, -1022.4358026509032, -220.1967520931911, -509.8790465402352, -913.7544089297522, -218.53273686948216, -861.8219991979925, -583.5916881932444, -1012.3376716420869, -834.021807416929, -359.6395523232779, -806.6577538239105, -853.5994928772092, -856.0350406833289, -970.5285162620806, -338.6403790862584, -916.405559707013, -986.1406028992062, -353.2422873437715, -519.6226390228409, -1179.5050655374491, -146.2703495270858, -603.1581250628481, -726.8636743846828, -268.042414050108, -729.6933899839556, -351.732897483811, -994.9076424762559, -1073.250777746495, -1220.3478305085291, -643.5409618503303, -1288.6815739874187, -1145.5486415495811, -1021.1865142634816, -366.7091017445239, -866.0585600640277, -229.35223147050053, -185.91097072312996, -901.5357721627032, -673.5327687328507, -620.4825979212641, -82.70726040873093, -500.62674678770554, -414.8203519816396, -766.5083251825629, -780.7366315279269, -1120.5429965806334, -790.0779807709598, -1158.2603191068094, -1241.5364454255846, -90.4652604472923, -907.2329072251947, -987.4189389956267, -885.8464791707547, -646.7305514010811, -456.65038154183287, -873.0868892996252, -567.731420719252, -995.3263013052594, -154.88651157481226, -474.6695200857726, -338.14538471560275, -1136.4116385065136, -449.12084458206243, -951.057380616181, -687.9025105130314, -899.7027548351409, -411.4563890486965, -888.355328056942, -429.6471910334972]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540789667508971, "mean_inference_ms": 1.6804156877789567, "mean_action_processing_ms": 0.2832163023656626, "mean_env_wait_ms": 2.9806210016702606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012436389923095703, "StateBufferConnector_ms": 0.00816655158996582, "ViewRequirementAgentConnector_ms": 0.19176101684570312}, "num_episodes": 25, "episode_return_max": -82.70726040873093, "episode_return_min": -1288.6815739874187, "episode_return_mean": -722.6070991872231, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 420.71910468957464, "num_env_steps_trained_throughput_per_sec": 420.71910468957464, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 11764.346, "restore_workers_time_ms": 0.034, "training_step_time_ms": 11764.27, "sample_time_ms": 1058.252, "learn_time_ms": 10643.465, "learn_throughput": 375.817, "synch_weights_time_ms": 61.691}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "39e3f_00000", "date": "2024-08-03_03-43-45", "timestamp": 1722636825, "time_this_iter_s": 9.52070927619934, "time_total_s": 94.21100997924805, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d9637f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 94.21100997924805, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.307142857142853, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.861527050783236, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.160963385800521, "policy_loss": -0.011395841688499785, "vf_loss": 9.1688873787721, "vf_explained_var": 0.693269042360286, "kl": 0.017428326550574032, "entropy": 1.379745040461421, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -14.145185723106687, "episode_reward_min": -1288.6815739874187, "episode_reward_mean": -680.0574411852874, "episode_len_mean": 137.58, "episode_media": {}, "episodes_timesteps_total": 13758, "policy_reward_min": {"policy_0": -1288.6815739874187}, "policy_reward_max": {"policy_0": -14.145185723106687}, "policy_reward_mean": {"policy_0": -680.0574411852874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-509.8790465402352, -913.7544089297522, -218.53273686948216, -861.8219991979925, -583.5916881932444, -1012.3376716420869, -834.021807416929, -359.6395523232779, -806.6577538239105, -853.5994928772092, -856.0350406833289, -970.5285162620806, -338.6403790862584, -916.405559707013, -986.1406028992062, -353.2422873437715, -519.6226390228409, -1179.5050655374491, -146.2703495270858, -603.1581250628481, -726.8636743846828, -268.042414050108, -729.6933899839556, -351.732897483811, -994.9076424762559, -1073.250777746495, -1220.3478305085291, -643.5409618503303, -1288.6815739874187, -1145.5486415495811, -1021.1865142634816, -366.7091017445239, -866.0585600640277, -229.35223147050053, -185.91097072312996, -901.5357721627032, -673.5327687328507, -620.4825979212641, -82.70726040873093, -500.62674678770554, -414.8203519816396, -766.5083251825629, -780.7366315279269, -1120.5429965806334, -790.0779807709598, -1158.2603191068094, -1241.5364454255846, -90.4652604472923, -907.2329072251947, -987.4189389956267, -885.8464791707547, -646.7305514010811, -456.65038154183287, -873.0868892996252, -567.731420719252, -995.3263013052594, -154.88651157481226, -474.6695200857726, -338.14538471560275, -1136.4116385065136, -449.12084458206243, -951.057380616181, -687.9025105130314, -899.7027548351409, -411.4563890486965, -888.355328056942, -429.6471910334972, -1077.000814856981, -496.95398583477413, -305.9024428125835, -572.3107628824835, -737.3830347389431, -463.97845049924337, -652.013895324392, -564.2673217179056, -825.7348151925953, -1148.6499827351518, -835.1061980161913, -319.28006530155216, -103.07496507612198, -194.75214872663113, -35.0113868230139, -891.9738467452158, -296.7009139758087, -1125.7196340852847, -871.5484872126967, -879.9078568934146, -964.4214398233637, -965.0692087740401, -747.2278192561373, -792.6955047487781, -660.3679955019676, -730.6882156328314, -951.4363929473536, -778.3491706156717, -424.30095136834404, -287.61719528517085, -478.9209582570578, -594.8083856475627, -14.145185723106687], "episode_lengths": [150, 150, 71, 150, 136, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 105, 150, 150, 101, 150, 150, 84, 150, 100, 150, 150, 150, 150, 150, 150, 150, 141, 150, 87, 102, 150, 150, 150, 74, 146, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 131, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 133, 95, 150, 150, 143, 150, 150, 150, 150, 150, 118, 80, 103, 41, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 127, 150, 150, 40], "policy_policy_0_reward": [-509.8790465402352, -913.7544089297522, -218.53273686948216, -861.8219991979925, -583.5916881932444, -1012.3376716420869, -834.021807416929, -359.6395523232779, -806.6577538239105, -853.5994928772092, -856.0350406833289, -970.5285162620806, -338.6403790862584, -916.405559707013, -986.1406028992062, -353.2422873437715, -519.6226390228409, -1179.5050655374491, -146.2703495270858, -603.1581250628481, -726.8636743846828, -268.042414050108, -729.6933899839556, -351.732897483811, -994.9076424762559, -1073.250777746495, -1220.3478305085291, -643.5409618503303, -1288.6815739874187, -1145.5486415495811, -1021.1865142634816, -366.7091017445239, -866.0585600640277, -229.35223147050053, -185.91097072312996, -901.5357721627032, -673.5327687328507, -620.4825979212641, -82.70726040873093, -500.62674678770554, -414.8203519816396, -766.5083251825629, -780.7366315279269, -1120.5429965806334, -790.0779807709598, -1158.2603191068094, -1241.5364454255846, -90.4652604472923, -907.2329072251947, -987.4189389956267, -885.8464791707547, -646.7305514010811, -456.65038154183287, -873.0868892996252, -567.731420719252, -995.3263013052594, -154.88651157481226, -474.6695200857726, -338.14538471560275, -1136.4116385065136, -449.12084458206243, -951.057380616181, -687.9025105130314, -899.7027548351409, -411.4563890486965, -888.355328056942, -429.6471910334972, -1077.000814856981, -496.95398583477413, -305.9024428125835, -572.3107628824835, -737.3830347389431, -463.97845049924337, -652.013895324392, -564.2673217179056, -825.7348151925953, -1148.6499827351518, -835.1061980161913, -319.28006530155216, -103.07496507612198, -194.75214872663113, -35.0113868230139, -891.9738467452158, -296.7009139758087, -1125.7196340852847, -871.5484872126967, -879.9078568934146, -964.4214398233637, -965.0692087740401, -747.2278192561373, -792.6955047487781, -660.3679955019676, -730.6882156328314, -951.4363929473536, -778.3491706156717, -424.30095136834404, -287.61719528517085, -478.9209582570578, -594.8083856475627, -14.145185723106687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530802682174153, "mean_inference_ms": 1.6807521898713496, "mean_action_processing_ms": 0.2824886346543244, "mean_env_wait_ms": 2.985461063152487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012047290802001953, "StateBufferConnector_ms": 0.008021116256713867, "ViewRequirementAgentConnector_ms": 0.19160985946655273}, "num_episodes": 33, "episode_return_max": -14.145185723106687, "episode_return_min": -1288.6815739874187, "episode_return_mean": -680.0574411852874, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 339.50169433993796, "num_env_steps_trained_throughput_per_sec": 339.50169433993796, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 11766.306, "restore_workers_time_ms": 0.034, "training_step_time_ms": 11766.23, "sample_time_ms": 1055.353, "learn_time_ms": 10647.946, "learn_throughput": 375.659, "synch_weights_time_ms": 62.08}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "39e3f_00000", "date": "2024-08-03_03-43-57", "timestamp": 1722636837, "time_this_iter_s": 11.79531192779541, "time_total_s": 106.00632190704346, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d8127a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 106.00632190704346, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.61176470588235, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.967760742704074, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.863456047077973, "policy_loss": -0.011730152258921104, "vf_loss": 8.87137019832929, "vf_explained_var": 0.6518259794140856, "kl": 0.019152173970481575, "entropy": 1.4448061063885689, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -14.145185723106687, "episode_reward_min": -1288.6815739874187, "episode_reward_mean": -701.0996593350952, "episode_len_mean": 140.18, "episode_media": {}, "episodes_timesteps_total": 14018, "policy_reward_min": {"policy_0": -1288.6815739874187}, "policy_reward_max": {"policy_0": -14.145185723106687}, "policy_reward_mean": {"policy_0": -701.0996593350952}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1220.3478305085291, -643.5409618503303, -1288.6815739874187, -1145.5486415495811, -1021.1865142634816, -366.7091017445239, -866.0585600640277, -229.35223147050053, -185.91097072312996, -901.5357721627032, -673.5327687328507, -620.4825979212641, -82.70726040873093, -500.62674678770554, -414.8203519816396, -766.5083251825629, -780.7366315279269, -1120.5429965806334, -790.0779807709598, -1158.2603191068094, -1241.5364454255846, -90.4652604472923, -907.2329072251947, -987.4189389956267, -885.8464791707547, -646.7305514010811, -456.65038154183287, -873.0868892996252, -567.731420719252, -995.3263013052594, -154.88651157481226, -474.6695200857726, -338.14538471560275, -1136.4116385065136, -449.12084458206243, -951.057380616181, -687.9025105130314, -899.7027548351409, -411.4563890486965, -888.355328056942, -429.6471910334972, -1077.000814856981, -496.95398583477413, -305.9024428125835, -572.3107628824835, -737.3830347389431, -463.97845049924337, -652.013895324392, -564.2673217179056, -825.7348151925953, -1148.6499827351518, -835.1061980161913, -319.28006530155216, -103.07496507612198, -194.75214872663113, -35.0113868230139, -891.9738467452158, -296.7009139758087, -1125.7196340852847, -871.5484872126967, -879.9078568934146, -964.4214398233637, -965.0692087740401, -747.2278192561373, -792.6955047487781, -660.3679955019676, -730.6882156328314, -951.4363929473536, -778.3491706156717, -424.30095136834404, -287.61719528517085, -478.9209582570578, -594.8083856475627, -14.145185723106687, -1015.5017486884651, -490.52054131855346, -1239.1714515346416, -1027.4906160038083, -880.3617598194338, -835.1114953148972, -845.6151228157609, -798.2780336900157, -866.6695961136736, -1078.3138763692773, -935.1112019239883, -752.9271129885238, -97.80657857047206, -709.6823250209416, -896.5708581711903, -981.0513412090528, -611.6925962403329, -594.4302694261302, -471.1257009134789, -906.827880427403, -349.70107293407256, -956.5160602245556, -286.37925707346386, -644.9994893725584, -1151.8763732672278, -648.3649746201879], "episode_lengths": [150, 150, 150, 150, 150, 141, 150, 87, 102, 150, 150, 150, 74, 146, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 131, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 133, 95, 150, 150, 143, 150, 150, 150, 150, 150, 118, 80, 103, 41, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 127, 150, 150, 40, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150], "policy_policy_0_reward": [-1220.3478305085291, -643.5409618503303, -1288.6815739874187, -1145.5486415495811, -1021.1865142634816, -366.7091017445239, -866.0585600640277, -229.35223147050053, -185.91097072312996, -901.5357721627032, -673.5327687328507, -620.4825979212641, -82.70726040873093, -500.62674678770554, -414.8203519816396, -766.5083251825629, -780.7366315279269, -1120.5429965806334, -790.0779807709598, -1158.2603191068094, -1241.5364454255846, -90.4652604472923, -907.2329072251947, -987.4189389956267, -885.8464791707547, -646.7305514010811, -456.65038154183287, -873.0868892996252, -567.731420719252, -995.3263013052594, -154.88651157481226, -474.6695200857726, -338.14538471560275, -1136.4116385065136, -449.12084458206243, -951.057380616181, -687.9025105130314, -899.7027548351409, -411.4563890486965, -888.355328056942, -429.6471910334972, -1077.000814856981, -496.95398583477413, -305.9024428125835, -572.3107628824835, -737.3830347389431, -463.97845049924337, -652.013895324392, -564.2673217179056, -825.7348151925953, -1148.6499827351518, -835.1061980161913, -319.28006530155216, -103.07496507612198, -194.75214872663113, -35.0113868230139, -891.9738467452158, -296.7009139758087, -1125.7196340852847, -871.5484872126967, -879.9078568934146, -964.4214398233637, -965.0692087740401, -747.2278192561373, -792.6955047487781, -660.3679955019676, -730.6882156328314, -951.4363929473536, -778.3491706156717, -424.30095136834404, -287.61719528517085, -478.9209582570578, -594.8083856475627, -14.145185723106687, -1015.5017486884651, -490.52054131855346, -1239.1714515346416, -1027.4906160038083, -880.3617598194338, -835.1114953148972, -845.6151228157609, -798.2780336900157, -866.6695961136736, -1078.3138763692773, -935.1112019239883, -752.9271129885238, -97.80657857047206, -709.6823250209416, -896.5708581711903, -981.0513412090528, -611.6925962403329, -594.4302694261302, -471.1257009134789, -906.827880427403, -349.70107293407256, -956.5160602245556, -286.37925707346386, -644.9994893725584, -1151.8763732672278, -648.3649746201879]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.552727379559661, "mean_inference_ms": 1.6809185616081563, "mean_action_processing_ms": 0.2817549862250129, "mean_env_wait_ms": 2.991378089521656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011751890182495117, "StateBufferConnector_ms": 0.007955789566040039, "ViewRequirementAgentConnector_ms": 0.19301056861877441}, "num_episodes": 26, "episode_return_max": -14.145185723106687, "episode_return_min": -1288.6815739874187, "episode_return_mean": -701.0996593350952, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.4664111842946, "num_env_steps_trained_throughput_per_sec": 504.4664111842946, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 11382.593, "restore_workers_time_ms": 0.033, "training_step_time_ms": 11382.519, "sample_time_ms": 1057.189, "learn_time_ms": 10262.717, "learn_throughput": 389.76, "synch_weights_time_ms": 61.774}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "39e3f_00000", "date": "2024-08-03_03-44-05", "timestamp": 1722636845, "time_this_iter_s": 7.941174745559692, "time_total_s": 113.94749665260315, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d8115a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 113.94749665260315, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.16363636363636, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.707315627547603, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.234334469834964, "policy_loss": -0.009887865208050546, "vf_loss": 9.24064338306586, "vf_explained_var": 0.6198224038506548, "kl": 0.017972325723530958, "entropy": 1.5492486663162708, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -14.145185723106687, "episode_reward_min": -1329.132433561969, "episode_reward_mean": -696.5945574829173, "episode_len_mean": 140.91, "episode_media": {}, "episodes_timesteps_total": 14091, "policy_reward_min": {"policy_0": -1329.132433561969}, "policy_reward_max": {"policy_0": -14.145185723106687}, "policy_reward_mean": {"policy_0": -696.5945574829173}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154.88651157481226, -474.6695200857726, -338.14538471560275, -1136.4116385065136, -449.12084458206243, -951.057380616181, -687.9025105130314, -899.7027548351409, -411.4563890486965, -888.355328056942, -429.6471910334972, -1077.000814856981, -496.95398583477413, -305.9024428125835, -572.3107628824835, -737.3830347389431, -463.97845049924337, -652.013895324392, -564.2673217179056, -825.7348151925953, -1148.6499827351518, -835.1061980161913, -319.28006530155216, -103.07496507612198, -194.75214872663113, -35.0113868230139, -891.9738467452158, -296.7009139758087, -1125.7196340852847, -871.5484872126967, -879.9078568934146, -964.4214398233637, -965.0692087740401, -747.2278192561373, -792.6955047487781, -660.3679955019676, -730.6882156328314, -951.4363929473536, -778.3491706156717, -424.30095136834404, -287.61719528517085, -478.9209582570578, -594.8083856475627, -14.145185723106687, -1015.5017486884651, -490.52054131855346, -1239.1714515346416, -1027.4906160038083, -880.3617598194338, -835.1114953148972, -845.6151228157609, -798.2780336900157, -866.6695961136736, -1078.3138763692773, -935.1112019239883, -752.9271129885238, -97.80657857047206, -709.6823250209416, -896.5708581711903, -981.0513412090528, -611.6925962403329, -594.4302694261302, -471.1257009134789, -906.827880427403, -349.70107293407256, -956.5160602245556, -286.37925707346386, -644.9994893725584, -1151.8763732672278, -648.3649746201879, -913.1421229514144, -570.0546918562612, -828.7926966437378, -542.5795303911457, -549.6848852243111, -481.34489001538645, -1020.6861876196572, -630.8951706580388, -837.6570641656929, -748.349112510409, -522.4579711553082, -904.859099017772, -1158.2562592900729, -953.6618928938167, -806.0094425461214, -1329.132433561969, -48.33952596665996, -925.8940602627521, -559.572708238448, -319.7001934596217, -807.8953162718035, -711.5542313239495, -528.3078762573786, -813.7383985568224, -903.4601568587605, -868.2662554390597, -799.8174694593554, -1058.4873232337577, -532.473937840718, -303.61262396878533], "episode_lengths": [107, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 133, 95, 150, 150, 143, 150, 150, 150, 150, 150, 118, 80, 103, 41, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 127, 150, 150, 40, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 45, 150, 139, 101, 150, 150, 150, 150, 150, 150, 150, 150, 128, 118], "policy_policy_0_reward": [-154.88651157481226, -474.6695200857726, -338.14538471560275, -1136.4116385065136, -449.12084458206243, -951.057380616181, -687.9025105130314, -899.7027548351409, -411.4563890486965, -888.355328056942, -429.6471910334972, -1077.000814856981, -496.95398583477413, -305.9024428125835, -572.3107628824835, -737.3830347389431, -463.97845049924337, -652.013895324392, -564.2673217179056, -825.7348151925953, -1148.6499827351518, -835.1061980161913, -319.28006530155216, -103.07496507612198, -194.75214872663113, -35.0113868230139, -891.9738467452158, -296.7009139758087, -1125.7196340852847, -871.5484872126967, -879.9078568934146, -964.4214398233637, -965.0692087740401, -747.2278192561373, -792.6955047487781, -660.3679955019676, -730.6882156328314, -951.4363929473536, -778.3491706156717, -424.30095136834404, -287.61719528517085, -478.9209582570578, -594.8083856475627, -14.145185723106687, -1015.5017486884651, -490.52054131855346, -1239.1714515346416, -1027.4906160038083, -880.3617598194338, -835.1114953148972, -845.6151228157609, -798.2780336900157, -866.6695961136736, -1078.3138763692773, -935.1112019239883, -752.9271129885238, -97.80657857047206, -709.6823250209416, -896.5708581711903, -981.0513412090528, -611.6925962403329, -594.4302694261302, -471.1257009134789, -906.827880427403, -349.70107293407256, -956.5160602245556, -286.37925707346386, -644.9994893725584, -1151.8763732672278, -648.3649746201879, -913.1421229514144, -570.0546918562612, -828.7926966437378, -542.5795303911457, -549.6848852243111, -481.34489001538645, -1020.6861876196572, -630.8951706580388, -837.6570641656929, -748.349112510409, -522.4579711553082, -904.859099017772, -1158.2562592900729, -953.6618928938167, -806.0094425461214, -1329.132433561969, -48.33952596665996, -925.8940602627521, -559.572708238448, -319.7001934596217, -807.8953162718035, -711.5542313239495, -528.3078762573786, -813.7383985568224, -903.4601568587605, -868.2662554390597, -799.8174694593554, -1058.4873232337577, -532.473937840718, -303.61262396878533]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533557817964995, "mean_inference_ms": 1.6836817830202069, "mean_action_processing_ms": 0.2818504132327839, "mean_env_wait_ms": 3.001147064747861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011441707611083984, "StateBufferConnector_ms": 0.008111000061035156, "ViewRequirementAgentConnector_ms": 0.1883547306060791}, "num_episodes": 30, "episode_return_max": -14.145185723106687, "episode_return_min": -1329.132433561969, "episode_return_mean": -696.5945574829173, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.94026598177084, "num_env_steps_trained_throughput_per_sec": 505.94026598177084, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 10876.873, "restore_workers_time_ms": 0.033, "training_step_time_ms": 10876.799, "sample_time_ms": 1070.956, "learn_time_ms": 9743.924, "learn_throughput": 410.512, "synch_weights_time_ms": 61.111}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "39e3f_00000", "date": "2024-08-03_03-44-13", "timestamp": 1722636853, "time_this_iter_s": 7.918936729431152, "time_total_s": 121.8664333820343, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d8135b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 121.8664333820343, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 22.22727272727273, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.368411929284534, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.482278631130855, "policy_loss": -0.01169875425742551, "vf_loss": 8.489689839382967, "vf_explained_var": 0.7049837673703829, "kl": 0.021507719414997465, "entropy": 1.4015039746339122, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -14.145185723106687, "episode_reward_min": -1460.336145726366, "episode_reward_mean": -716.127106504625, "episode_len_mean": 140.36, "episode_media": {}, "episodes_timesteps_total": 14036, "policy_reward_min": {"policy_0": -1460.336145726366}, "policy_reward_max": {"policy_0": -14.145185723106687}, "policy_reward_mean": {"policy_0": -716.127106504625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1125.7196340852847, -871.5484872126967, -879.9078568934146, -964.4214398233637, -965.0692087740401, -747.2278192561373, -792.6955047487781, -660.3679955019676, -730.6882156328314, -951.4363929473536, -778.3491706156717, -424.30095136834404, -287.61719528517085, -478.9209582570578, -594.8083856475627, -14.145185723106687, -1015.5017486884651, -490.52054131855346, -1239.1714515346416, -1027.4906160038083, -880.3617598194338, -835.1114953148972, -845.6151228157609, -798.2780336900157, -866.6695961136736, -1078.3138763692773, -935.1112019239883, -752.9271129885238, -97.80657857047206, -709.6823250209416, -896.5708581711903, -981.0513412090528, -611.6925962403329, -594.4302694261302, -471.1257009134789, -906.827880427403, -349.70107293407256, -956.5160602245556, -286.37925707346386, -644.9994893725584, -1151.8763732672278, -648.3649746201879, -913.1421229514144, -570.0546918562612, -828.7926966437378, -542.5795303911457, -549.6848852243111, -481.34489001538645, -1020.6861876196572, -630.8951706580388, -837.6570641656929, -748.349112510409, -522.4579711553082, -904.859099017772, -1158.2562592900729, -953.6618928938167, -806.0094425461214, -1329.132433561969, -48.33952596665996, -925.8940602627521, -559.572708238448, -319.7001934596217, -807.8953162718035, -711.5542313239495, -528.3078762573786, -813.7383985568224, -903.4601568587605, -868.2662554390597, -799.8174694593554, -1058.4873232337577, -532.473937840718, -303.61262396878533, -760.1580515825092, -867.1373091062228, -1261.1426080973645, -981.8885339792471, -673.9162587875318, -847.3737019474206, -509.062950252813, -727.6317339356003, -888.201613735699, -426.3467593486334, -1460.336145726366, -1034.8585496395217, -133.868959782903, -924.1893053200378, -103.92967497922396, -827.4706033538495, -341.95834400986615, -231.83287344983327, -385.27523107948326, -268.20894077986105, -1130.078573218381, -362.8420882985293, -47.26375800354895, -204.23574440455053, -1216.6252010739986, -1041.9204714490224, -369.88407864926523, -267.0673230073435], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 127, 150, 150, 40, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 45, 150, 139, 101, 150, 150, 150, 150, 150, 150, 150, 150, 128, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 105, 150, 134, 109, 150, 83, 150, 103, 65, 70, 150, 150, 150, 143], "policy_policy_0_reward": [-1125.7196340852847, -871.5484872126967, -879.9078568934146, -964.4214398233637, -965.0692087740401, -747.2278192561373, -792.6955047487781, -660.3679955019676, -730.6882156328314, -951.4363929473536, -778.3491706156717, -424.30095136834404, -287.61719528517085, -478.9209582570578, -594.8083856475627, -14.145185723106687, -1015.5017486884651, -490.52054131855346, -1239.1714515346416, -1027.4906160038083, -880.3617598194338, -835.1114953148972, -845.6151228157609, -798.2780336900157, -866.6695961136736, -1078.3138763692773, -935.1112019239883, -752.9271129885238, -97.80657857047206, -709.6823250209416, -896.5708581711903, -981.0513412090528, -611.6925962403329, -594.4302694261302, -471.1257009134789, -906.827880427403, -349.70107293407256, -956.5160602245556, -286.37925707346386, -644.9994893725584, -1151.8763732672278, -648.3649746201879, -913.1421229514144, -570.0546918562612, -828.7926966437378, -542.5795303911457, -549.6848852243111, -481.34489001538645, -1020.6861876196572, -630.8951706580388, -837.6570641656929, -748.349112510409, -522.4579711553082, -904.859099017772, -1158.2562592900729, -953.6618928938167, -806.0094425461214, -1329.132433561969, -48.33952596665996, -925.8940602627521, -559.572708238448, -319.7001934596217, -807.8953162718035, -711.5542313239495, -528.3078762573786, -813.7383985568224, -903.4601568587605, -868.2662554390597, -799.8174694593554, -1058.4873232337577, -532.473937840718, -303.61262396878533, -760.1580515825092, -867.1373091062228, -1261.1426080973645, -981.8885339792471, -673.9162587875318, -847.3737019474206, -509.062950252813, -727.6317339356003, -888.201613735699, -426.3467593486334, -1460.336145726366, -1034.8585496395217, -133.868959782903, -924.1893053200378, -103.92967497922396, -827.4706033538495, -341.95834400986615, -231.83287344983327, -385.27523107948326, -268.20894077986105, -1130.078573218381, -362.8420882985293, -47.26375800354895, -204.23574440455053, -1216.6252010739986, -1041.9204714490224, -369.88407864926523, -267.0673230073435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544197025078511, "mean_inference_ms": 1.685665589264209, "mean_action_processing_ms": 0.28166208597796233, "mean_env_wait_ms": 3.009768250388349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011497974395751953, "StateBufferConnector_ms": 0.008069276809692383, "ViewRequirementAgentConnector_ms": 0.1868114471435547}, "num_episodes": 28, "episode_return_max": -14.145185723106687, "episode_return_min": -1460.336145726366, "episode_return_mean": -716.127106504625, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.21557969030744, "num_env_steps_trained_throughput_per_sec": 332.21557969030744, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 10873.177, "restore_workers_time_ms": 0.031, "training_step_time_ms": 10873.106, "sample_time_ms": 1073.415, "learn_time_ms": 9736.731, "learn_throughput": 410.815, "synch_weights_time_ms": 62.143}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "39e3f_00000", "date": "2024-08-03_03-44-25", "timestamp": 1722636865, "time_this_iter_s": 12.054419755935669, "time_total_s": 133.92085313796997, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d963910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 133.92085313796997, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.82941176470588, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.104581704735756, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.89739021162192, "policy_loss": -0.011478343016642611, "vf_loss": 8.903211493293444, "vf_explained_var": 0.7749009910970927, "kl": 0.0189095619634827, "entropy": 1.5827923805763324, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -26.007196630126472, "episode_reward_min": -1460.336145726366, "episode_reward_mean": -703.8035860392556, "episode_len_mean": 139.67, "episode_media": {}, "episodes_timesteps_total": 13967, "policy_reward_min": {"policy_0": -1460.336145726366}, "policy_reward_max": {"policy_0": -26.007196630126472}, "policy_reward_mean": {"policy_0": -703.8035860392556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.80657857047206, -709.6823250209416, -896.5708581711903, -981.0513412090528, -611.6925962403329, -594.4302694261302, -471.1257009134789, -906.827880427403, -349.70107293407256, -956.5160602245556, -286.37925707346386, -644.9994893725584, -1151.8763732672278, -648.3649746201879, -913.1421229514144, -570.0546918562612, -828.7926966437378, -542.5795303911457, -549.6848852243111, -481.34489001538645, -1020.6861876196572, -630.8951706580388, -837.6570641656929, -748.349112510409, -522.4579711553082, -904.859099017772, -1158.2562592900729, -953.6618928938167, -806.0094425461214, -1329.132433561969, -48.33952596665996, -925.8940602627521, -559.572708238448, -319.7001934596217, -807.8953162718035, -711.5542313239495, -528.3078762573786, -813.7383985568224, -903.4601568587605, -868.2662554390597, -799.8174694593554, -1058.4873232337577, -532.473937840718, -303.61262396878533, -760.1580515825092, -867.1373091062228, -1261.1426080973645, -981.8885339792471, -673.9162587875318, -847.3737019474206, -509.062950252813, -727.6317339356003, -888.201613735699, -426.3467593486334, -1460.336145726366, -1034.8585496395217, -133.868959782903, -924.1893053200378, -103.92967497922396, -827.4706033538495, -341.95834400986615, -231.83287344983327, -385.27523107948326, -268.20894077986105, -1130.078573218381, -362.8420882985293, -47.26375800354895, -204.23574440455053, -1216.6252010739986, -1041.9204714490224, -369.88407864926523, -267.0673230073435, -608.3946880301315, -932.2385254835415, -78.63850821889623, -904.9930938526957, -435.98269169947076, -26.007196630126472, -991.4885015487447, -908.752599720133, -1024.6327372128533, -1086.5386865169194, -904.3771095552504, -815.4774659765676, -222.75109698270919, -1044.561376537483, -799.9700067036487, -979.5827698415475, -1183.6691199607694, -1265.8456152671527, -778.2519879792326, -737.8238855184709, -406.58654483661866, -763.637936500304, -613.7233189547194, -675.5884607670513, -179.55494664047885, -591.6104489215005, -1171.4087716553024, -667.8568203045447], "episode_lengths": [96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 45, 150, 139, 101, 150, 150, 150, 150, 150, 150, 150, 150, 128, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 105, 150, 134, 109, 150, 83, 150, 103, 65, 70, 150, 150, 150, 143, 150, 150, 76, 150, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150], "policy_policy_0_reward": [-97.80657857047206, -709.6823250209416, -896.5708581711903, -981.0513412090528, -611.6925962403329, -594.4302694261302, -471.1257009134789, -906.827880427403, -349.70107293407256, -956.5160602245556, -286.37925707346386, -644.9994893725584, -1151.8763732672278, -648.3649746201879, -913.1421229514144, -570.0546918562612, -828.7926966437378, -542.5795303911457, -549.6848852243111, -481.34489001538645, -1020.6861876196572, -630.8951706580388, -837.6570641656929, -748.349112510409, -522.4579711553082, -904.859099017772, -1158.2562592900729, -953.6618928938167, -806.0094425461214, -1329.132433561969, -48.33952596665996, -925.8940602627521, -559.572708238448, -319.7001934596217, -807.8953162718035, -711.5542313239495, -528.3078762573786, -813.7383985568224, -903.4601568587605, -868.2662554390597, -799.8174694593554, -1058.4873232337577, -532.473937840718, -303.61262396878533, -760.1580515825092, -867.1373091062228, -1261.1426080973645, -981.8885339792471, -673.9162587875318, -847.3737019474206, -509.062950252813, -727.6317339356003, -888.201613735699, -426.3467593486334, -1460.336145726366, -1034.8585496395217, -133.868959782903, -924.1893053200378, -103.92967497922396, -827.4706033538495, -341.95834400986615, -231.83287344983327, -385.27523107948326, -268.20894077986105, -1130.078573218381, -362.8420882985293, -47.26375800354895, -204.23574440455053, -1216.6252010739986, -1041.9204714490224, -369.88407864926523, -267.0673230073435, -608.3946880301315, -932.2385254835415, -78.63850821889623, -904.9930938526957, -435.98269169947076, -26.007196630126472, -991.4885015487447, -908.752599720133, -1024.6327372128533, -1086.5386865169194, -904.3771095552504, -815.4774659765676, -222.75109698270919, -1044.561376537483, -799.9700067036487, -979.5827698415475, -1183.6691199607694, -1265.8456152671527, -778.2519879792326, -737.8238855184709, -406.58654483661866, -763.637936500304, -613.7233189547194, -675.5884607670513, -179.55494664047885, -591.6104489215005, -1171.4087716553024, -667.8568203045447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538299232264722, "mean_inference_ms": 1.68417519746718, "mean_action_processing_ms": 0.28111272954851096, "mean_env_wait_ms": 3.013104308454653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011340856552124023, "StateBufferConnector_ms": 0.007941484451293945, "ViewRequirementAgentConnector_ms": 0.18538475036621094}, "num_episodes": 28, "episode_return_max": -26.007196630126472, "episode_return_min": -1460.336145726366, "episode_return_mean": -703.8035860392556, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.39491835100154, "num_env_steps_trained_throughput_per_sec": 300.39491835100154, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 10907.677, "restore_workers_time_ms": 0.031, "training_step_time_ms": 10907.606, "sample_time_ms": 1077.094, "learn_time_ms": 9768.848, "learn_throughput": 409.465, "synch_weights_time_ms": 60.871}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "39e3f_00000", "date": "2024-08-03_03-44-38", "timestamp": 1722636878, "time_this_iter_s": 13.32944130897522, "time_total_s": 147.2502944469452, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d811630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 147.2502944469452, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 16.784210526315793, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.9461419240882, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.829940318067868, "policy_loss": -0.009014986152760685, "vf_loss": 8.833939159413179, "vf_explained_var": 0.6928046944861611, "kl": 0.01676868666096804, "entropy": 1.4443441465497018, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -26.007196630126472, "episode_reward_min": -1460.336145726366, "episode_reward_mean": -720.536521718161, "episode_len_mean": 138.76, "episode_media": {}, "episodes_timesteps_total": 13876, "policy_reward_min": {"policy_0": -1460.336145726366}, "policy_reward_max": {"policy_0": -26.007196630126472}, "policy_reward_mean": {"policy_0": -720.536521718161}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-953.6618928938167, -806.0094425461214, -1329.132433561969, -48.33952596665996, -925.8940602627521, -559.572708238448, -319.7001934596217, -807.8953162718035, -711.5542313239495, -528.3078762573786, -813.7383985568224, -903.4601568587605, -868.2662554390597, -799.8174694593554, -1058.4873232337577, -532.473937840718, -303.61262396878533, -760.1580515825092, -867.1373091062228, -1261.1426080973645, -981.8885339792471, -673.9162587875318, -847.3737019474206, -509.062950252813, -727.6317339356003, -888.201613735699, -426.3467593486334, -1460.336145726366, -1034.8585496395217, -133.868959782903, -924.1893053200378, -103.92967497922396, -827.4706033538495, -341.95834400986615, -231.83287344983327, -385.27523107948326, -268.20894077986105, -1130.078573218381, -362.8420882985293, -47.26375800354895, -204.23574440455053, -1216.6252010739986, -1041.9204714490224, -369.88407864926523, -267.0673230073435, -608.3946880301315, -932.2385254835415, -78.63850821889623, -904.9930938526957, -435.98269169947076, -26.007196630126472, -991.4885015487447, -908.752599720133, -1024.6327372128533, -1086.5386865169194, -904.3771095552504, -815.4774659765676, -222.75109698270919, -1044.561376537483, -799.9700067036487, -979.5827698415475, -1183.6691199607694, -1265.8456152671527, -778.2519879792326, -737.8238855184709, -406.58654483661866, -763.637936500304, -613.7233189547194, -675.5884607670513, -179.55494664047885, -591.6104489215005, -1171.4087716553024, -667.8568203045447, -350.2231709464606, -1000.7555456396278, -934.1945543397908, -758.3491168790429, -625.429386718831, -585.7072370843343, -1014.3460450444959, -981.3970052852293, -630.9791072462782, -668.2821689268397, -951.4484916949737, -439.38496520505606, -952.5563662902942, -718.2243432434442, -907.0376088482459, -541.2096580806549, -1116.584693832466, -364.32246295630495, -1189.3423397185295, -796.3422475843579, -1038.4134925521357, -640.5985502056692, -468.14459329498493, -36.40183295177788, -1009.2612793417908, -715.2803305129233, -1254.8614324363075], "episode_lengths": [150, 150, 150, 45, 150, 139, 101, 150, 150, 150, 150, 150, 150, 150, 150, 128, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 105, 150, 134, 109, 150, 83, 150, 103, 65, 70, 150, 150, 150, 143, 150, 150, 76, 150, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 96, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150], "policy_policy_0_reward": [-953.6618928938167, -806.0094425461214, -1329.132433561969, -48.33952596665996, -925.8940602627521, -559.572708238448, -319.7001934596217, -807.8953162718035, -711.5542313239495, -528.3078762573786, -813.7383985568224, -903.4601568587605, -868.2662554390597, -799.8174694593554, -1058.4873232337577, -532.473937840718, -303.61262396878533, -760.1580515825092, -867.1373091062228, -1261.1426080973645, -981.8885339792471, -673.9162587875318, -847.3737019474206, -509.062950252813, -727.6317339356003, -888.201613735699, -426.3467593486334, -1460.336145726366, -1034.8585496395217, -133.868959782903, -924.1893053200378, -103.92967497922396, -827.4706033538495, -341.95834400986615, -231.83287344983327, -385.27523107948326, -268.20894077986105, -1130.078573218381, -362.8420882985293, -47.26375800354895, -204.23574440455053, -1216.6252010739986, -1041.9204714490224, -369.88407864926523, -267.0673230073435, -608.3946880301315, -932.2385254835415, -78.63850821889623, -904.9930938526957, -435.98269169947076, -26.007196630126472, -991.4885015487447, -908.752599720133, -1024.6327372128533, -1086.5386865169194, -904.3771095552504, -815.4774659765676, -222.75109698270919, -1044.561376537483, -799.9700067036487, -979.5827698415475, -1183.6691199607694, -1265.8456152671527, -778.2519879792326, -737.8238855184709, -406.58654483661866, -763.637936500304, -613.7233189547194, -675.5884607670513, -179.55494664047885, -591.6104489215005, -1171.4087716553024, -667.8568203045447, -350.2231709464606, -1000.7555456396278, -934.1945543397908, -758.3491168790429, -625.429386718831, -585.7072370843343, -1014.3460450444959, -981.3970052852293, -630.9791072462782, -668.2821689268397, -951.4484916949737, -439.38496520505606, -952.5563662902942, -718.2243432434442, -907.0376088482459, -541.2096580806549, -1116.584693832466, -364.32246295630495, -1189.3423397185295, -796.3422475843579, -1038.4134925521357, -640.5985502056692, -468.14459329498493, -36.40183295177788, -1009.2612793417908, -715.2803305129233, -1254.8614324363075]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541043362625373, "mean_inference_ms": 1.6841396541038998, "mean_action_processing_ms": 0.2808612529527916, "mean_env_wait_ms": 3.019487011291631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011808395385742188, "StateBufferConnector_ms": 0.0077250003814697266, "ViewRequirementAgentConnector_ms": 0.18718290328979492}, "num_episodes": 27, "episode_return_max": -26.007196630126472, "episode_return_min": -1460.336145726366, "episode_return_mean": -720.536521718161, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.6110792723892, "num_env_steps_trained_throughput_per_sec": 309.6110792723892, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 10891.54, "restore_workers_time_ms": 0.03, "training_step_time_ms": 10891.47, "sample_time_ms": 1083.652, "learn_time_ms": 9746.322, "learn_throughput": 410.411, "synch_weights_time_ms": 60.74}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "39e3f_00000", "date": "2024-08-03_03-44-51", "timestamp": 1722636891, "time_this_iter_s": 12.931323528289795, "time_total_s": 160.18161797523499, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d813e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 160.18161797523499, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.84736842105263, "ram_util_percent": 27.542105263157897}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.56775702809294, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.680258605380853, "policy_loss": -0.009344288412830793, "vf_loss": 8.684934697051842, "vf_explained_var": 0.7053013139714798, "kl": 0.015609078602574322, "entropy": 1.4532519832253457, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -26.007196630126472, "episode_reward_min": -1265.8456152671527, "episode_reward_mean": -715.3782368469917, "episode_len_mean": 138.78, "episode_media": {}, "episodes_timesteps_total": 13878, "policy_reward_min": {"policy_0": -1265.8456152671527}, "policy_reward_max": {"policy_0": -26.007196630126472}, "policy_reward_mean": {"policy_0": -715.3782368469917}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-103.92967497922396, -827.4706033538495, -341.95834400986615, -231.83287344983327, -385.27523107948326, -268.20894077986105, -1130.078573218381, -362.8420882985293, -47.26375800354895, -204.23574440455053, -1216.6252010739986, -1041.9204714490224, -369.88407864926523, -267.0673230073435, -608.3946880301315, -932.2385254835415, -78.63850821889623, -904.9930938526957, -435.98269169947076, -26.007196630126472, -991.4885015487447, -908.752599720133, -1024.6327372128533, -1086.5386865169194, -904.3771095552504, -815.4774659765676, -222.75109698270919, -1044.561376537483, -799.9700067036487, -979.5827698415475, -1183.6691199607694, -1265.8456152671527, -778.2519879792326, -737.8238855184709, -406.58654483661866, -763.637936500304, -613.7233189547194, -675.5884607670513, -179.55494664047885, -591.6104489215005, -1171.4087716553024, -667.8568203045447, -350.2231709464606, -1000.7555456396278, -934.1945543397908, -758.3491168790429, -625.429386718831, -585.7072370843343, -1014.3460450444959, -981.3970052852293, -630.9791072462782, -668.2821689268397, -951.4484916949737, -439.38496520505606, -952.5563662902942, -718.2243432434442, -907.0376088482459, -541.2096580806549, -1116.584693832466, -364.32246295630495, -1189.3423397185295, -796.3422475843579, -1038.4134925521357, -640.5985502056692, -468.14459329498493, -36.40183295177788, -1009.2612793417908, -715.2803305129233, -1254.8614324363075, -899.7150358126497, -105.54366394052256, -199.46132311636725, -1166.5263739831125, -1259.934288795159, -1247.0297035909632, -196.4475284159007, -701.2542083631847, -641.5689176785644, -666.6748473550188, -734.3285504897136, -874.1976648678539, -1196.0587924031845, -854.1074477368059, -718.104095887377, -645.549656496523, -503.3257396257639, -974.0451406790085, -803.1123991364489, -630.418760858673, -1140.6414796738584, -913.0803642300466, -920.1989441325119, -432.85936494540204, -1011.3608480059315, -1017.5630417467189, -571.0134973515214, -467.98859080638425, -847.7921302487964, -89.58384020609579, -820.721599684651], "episode_lengths": [105, 150, 134, 109, 150, 83, 150, 103, 65, 70, 150, 150, 150, 143, 150, 150, 76, 150, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 96, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 72, 84, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 86, 150], "policy_policy_0_reward": [-103.92967497922396, -827.4706033538495, -341.95834400986615, -231.83287344983327, -385.27523107948326, -268.20894077986105, -1130.078573218381, -362.8420882985293, -47.26375800354895, -204.23574440455053, -1216.6252010739986, -1041.9204714490224, -369.88407864926523, -267.0673230073435, -608.3946880301315, -932.2385254835415, -78.63850821889623, -904.9930938526957, -435.98269169947076, -26.007196630126472, -991.4885015487447, -908.752599720133, -1024.6327372128533, -1086.5386865169194, -904.3771095552504, -815.4774659765676, -222.75109698270919, -1044.561376537483, -799.9700067036487, -979.5827698415475, -1183.6691199607694, -1265.8456152671527, -778.2519879792326, -737.8238855184709, -406.58654483661866, -763.637936500304, -613.7233189547194, -675.5884607670513, -179.55494664047885, -591.6104489215005, -1171.4087716553024, -667.8568203045447, -350.2231709464606, -1000.7555456396278, -934.1945543397908, -758.3491168790429, -625.429386718831, -585.7072370843343, -1014.3460450444959, -981.3970052852293, -630.9791072462782, -668.2821689268397, -951.4484916949737, -439.38496520505606, -952.5563662902942, -718.2243432434442, -907.0376088482459, -541.2096580806549, -1116.584693832466, -364.32246295630495, -1189.3423397185295, -796.3422475843579, -1038.4134925521357, -640.5985502056692, -468.14459329498493, -36.40183295177788, -1009.2612793417908, -715.2803305129233, -1254.8614324363075, -899.7150358126497, -105.54366394052256, -199.46132311636725, -1166.5263739831125, -1259.934288795159, -1247.0297035909632, -196.4475284159007, -701.2542083631847, -641.5689176785644, -666.6748473550188, -734.3285504897136, -874.1976648678539, -1196.0587924031845, -854.1074477368059, -718.104095887377, -645.549656496523, -503.3257396257639, -974.0451406790085, -803.1123991364489, -630.418760858673, -1140.6414796738584, -913.0803642300466, -920.1989441325119, -432.85936494540204, -1011.3608480059315, -1017.5630417467189, -571.0134973515214, -467.98859080638425, -847.7921302487964, -89.58384020609579, -820.721599684651]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547809468556887, "mean_inference_ms": 1.6838452701897477, "mean_action_processing_ms": 0.2806168377034992, "mean_env_wait_ms": 3.021276303457049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011947154998779297, "StateBufferConnector_ms": 0.007855892181396484, "ViewRequirementAgentConnector_ms": 0.19054269790649414}, "num_episodes": 31, "episode_return_max": -26.007196630126472, "episode_return_min": -1265.8456152671527, "episode_return_mean": -715.3782368469917, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.613026190852, "num_env_steps_trained_throughput_per_sec": 306.613026190852, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 10876.675, "restore_workers_time_ms": 0.029, "training_step_time_ms": 10876.606, "sample_time_ms": 1083.816, "learn_time_ms": 9730.817, "learn_throughput": 411.065, "synch_weights_time_ms": 61.217}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "39e3f_00000", "date": "2024-08-03_03-45-04", "timestamp": 1722636904, "time_this_iter_s": 13.058435678482056, "time_total_s": 173.24005365371704, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d813d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 173.24005365371704, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.32222222222222, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.69382432848215, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.210549414654572, "policy_loss": -0.012215624380041845, "vf_loss": 8.217195591330528, "vf_explained_var": 0.8119857563326757, "kl": 0.018616053011768014, "entropy": 1.536065529907743, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -24.902365429358536, "episode_reward_min": -1265.8456152671527, "episode_reward_mean": -735.5470041617679, "episode_len_mean": 139.51, "episode_media": {}, "episodes_timesteps_total": 13951, "policy_reward_min": {"policy_0": -1265.8456152671527}, "policy_reward_max": {"policy_0": -24.902365429358536}, "policy_reward_mean": {"policy_0": -735.5470041617679}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1183.6691199607694, -1265.8456152671527, -778.2519879792326, -737.8238855184709, -406.58654483661866, -763.637936500304, -613.7233189547194, -675.5884607670513, -179.55494664047885, -591.6104489215005, -1171.4087716553024, -667.8568203045447, -350.2231709464606, -1000.7555456396278, -934.1945543397908, -758.3491168790429, -625.429386718831, -585.7072370843343, -1014.3460450444959, -981.3970052852293, -630.9791072462782, -668.2821689268397, -951.4484916949737, -439.38496520505606, -952.5563662902942, -718.2243432434442, -907.0376088482459, -541.2096580806549, -1116.584693832466, -364.32246295630495, -1189.3423397185295, -796.3422475843579, -1038.4134925521357, -640.5985502056692, -468.14459329498493, -36.40183295177788, -1009.2612793417908, -715.2803305129233, -1254.8614324363075, -899.7150358126497, -105.54366394052256, -199.46132311636725, -1166.5263739831125, -1259.934288795159, -1247.0297035909632, -196.4475284159007, -701.2542083631847, -641.5689176785644, -666.6748473550188, -734.3285504897136, -874.1976648678539, -1196.0587924031845, -854.1074477368059, -718.104095887377, -645.549656496523, -503.3257396257639, -974.0451406790085, -803.1123991364489, -630.418760858673, -1140.6414796738584, -913.0803642300466, -920.1989441325119, -432.85936494540204, -1011.3608480059315, -1017.5630417467189, -571.0134973515214, -467.98859080638425, -847.7921302487964, -89.58384020609579, -820.721599684651, -956.2817147419178, -373.65182522666703, -779.1889808213525, -633.6438494518934, -780.0995007124606, -253.4466848911955, -24.902365429358536, -906.578891710195, -865.4994760987103, -1205.6686417796323, -709.7855919330336, -1256.7459549099465, -1138.0991075087431, -253.0565563634825, -44.926635978308504, -1177.4853816297293, -776.444347653296, -863.0029198271598, -481.30016679709775, -1036.5329296434084, -550.3836170595521, -506.84031949269774, -853.2053179005245, -1093.4053230849486, -675.5217306503524, -1022.1311241632538, -852.605076397974, -160.6790223091998, -198.64760330836856, -150.09603427062004], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 96, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 72, 84, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 86, 150, 150, 150, 150, 150, 150, 86, 54, 150, 150, 150, 150, 150, 150, 92, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 66, 82], "policy_policy_0_reward": [-1183.6691199607694, -1265.8456152671527, -778.2519879792326, -737.8238855184709, -406.58654483661866, -763.637936500304, -613.7233189547194, -675.5884607670513, -179.55494664047885, -591.6104489215005, -1171.4087716553024, -667.8568203045447, -350.2231709464606, -1000.7555456396278, -934.1945543397908, -758.3491168790429, -625.429386718831, -585.7072370843343, -1014.3460450444959, -981.3970052852293, -630.9791072462782, -668.2821689268397, -951.4484916949737, -439.38496520505606, -952.5563662902942, -718.2243432434442, -907.0376088482459, -541.2096580806549, -1116.584693832466, -364.32246295630495, -1189.3423397185295, -796.3422475843579, -1038.4134925521357, -640.5985502056692, -468.14459329498493, -36.40183295177788, -1009.2612793417908, -715.2803305129233, -1254.8614324363075, -899.7150358126497, -105.54366394052256, -199.46132311636725, -1166.5263739831125, -1259.934288795159, -1247.0297035909632, -196.4475284159007, -701.2542083631847, -641.5689176785644, -666.6748473550188, -734.3285504897136, -874.1976648678539, -1196.0587924031845, -854.1074477368059, -718.104095887377, -645.549656496523, -503.3257396257639, -974.0451406790085, -803.1123991364489, -630.418760858673, -1140.6414796738584, -913.0803642300466, -920.1989441325119, -432.85936494540204, -1011.3608480059315, -1017.5630417467189, -571.0134973515214, -467.98859080638425, -847.7921302487964, -89.58384020609579, -820.721599684651, -956.2817147419178, -373.65182522666703, -779.1889808213525, -633.6438494518934, -780.0995007124606, -253.4466848911955, -24.902365429358536, -906.578891710195, -865.4994760987103, -1205.6686417796323, -709.7855919330336, -1256.7459549099465, -1138.0991075087431, -253.0565563634825, -44.926635978308504, -1177.4853816297293, -776.444347653296, -863.0029198271598, -481.30016679709775, -1036.5329296434084, -550.3836170595521, -506.84031949269774, -853.2053179005245, -1093.4053230849486, -675.5217306503524, -1022.1311241632538, -852.605076397974, -160.6790223091998, -198.64760330836856, -150.09603427062004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549855317121308, "mean_inference_ms": 1.6849433061844903, "mean_action_processing_ms": 0.2807512718570445, "mean_env_wait_ms": 3.0300954274588197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012125968933105469, "StateBufferConnector_ms": 0.00784754753112793, "ViewRequirementAgentConnector_ms": 0.19046616554260254}, "num_episodes": 30, "episode_return_max": -24.902365429358536, "episode_return_min": -1265.8456152671527, "episode_return_mean": -735.5470041617679, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.86542012389805, "num_env_steps_trained_throughput_per_sec": 303.86542012389805, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 11036.215, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11036.146, "sample_time_ms": 1072.652, "learn_time_ms": 9900.561, "learn_throughput": 404.018, "synch_weights_time_ms": 62.175}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "39e3f_00000", "date": "2024-08-03_03-45-17", "timestamp": 1722636917, "time_this_iter_s": 13.175978422164917, "time_total_s": 186.41603207588196, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d4a1000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 186.41603207588196, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.01578947368421, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.747093752026558, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.312727597852549, "policy_loss": -0.008907747383151825, "vf_loss": 8.31668816904227, "vf_explained_var": 0.7777441398551067, "kl": 0.01654163720880509, "entropy": 1.5317849915474653, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -9.33890777770597, "episode_reward_min": -1399.6242538703673, "episode_reward_mean": -738.6338889606086, "episode_len_mean": 137.35, "episode_media": {}, "episodes_timesteps_total": 13735, "policy_reward_min": {"policy_0": -1399.6242538703673}, "policy_reward_max": {"policy_0": -9.33890777770597}, "policy_reward_mean": {"policy_0": -738.6338889606086}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1116.584693832466, -364.32246295630495, -1189.3423397185295, -796.3422475843579, -1038.4134925521357, -640.5985502056692, -468.14459329498493, -36.40183295177788, -1009.2612793417908, -715.2803305129233, -1254.8614324363075, -899.7150358126497, -105.54366394052256, -199.46132311636725, -1166.5263739831125, -1259.934288795159, -1247.0297035909632, -196.4475284159007, -701.2542083631847, -641.5689176785644, -666.6748473550188, -734.3285504897136, -874.1976648678539, -1196.0587924031845, -854.1074477368059, -718.104095887377, -645.549656496523, -503.3257396257639, -974.0451406790085, -803.1123991364489, -630.418760858673, -1140.6414796738584, -913.0803642300466, -920.1989441325119, -432.85936494540204, -1011.3608480059315, -1017.5630417467189, -571.0134973515214, -467.98859080638425, -847.7921302487964, -89.58384020609579, -820.721599684651, -956.2817147419178, -373.65182522666703, -779.1889808213525, -633.6438494518934, -780.0995007124606, -253.4466848911955, -24.902365429358536, -906.578891710195, -865.4994760987103, -1205.6686417796323, -709.7855919330336, -1256.7459549099465, -1138.0991075087431, -253.0565563634825, -44.926635978308504, -1177.4853816297293, -776.444347653296, -863.0029198271598, -481.30016679709775, -1036.5329296434084, -550.3836170595521, -506.84031949269774, -853.2053179005245, -1093.4053230849486, -675.5217306503524, -1022.1311241632538, -852.605076397974, -160.6790223091998, -198.64760330836856, -150.09603427062004, -1197.0513578577868, -1154.0810378462108, -1029.381413590115, -1399.6242538703673, -610.209103090631, -905.6160657623299, -804.2636739435097, -124.03457039562062, -9.33890777770597, -617.4629078089578, -461.55207750012033, -749.4164160291699, -1047.796879565014, -802.4416253365775, -208.8814267930322, -1034.1371643355694, -724.6493596100211, -754.4806950405078, -700.2873249887106, -353.07588860698354, -550.1668986670381, -582.325556809031, -1010.7502432256233, -1133.8053188781305, -1092.2837283235265, -1010.1111786021099, -522.2096880046827, -814.336346404731], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 72, 84, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 86, 150, 150, 150, 150, 150, 150, 86, 54, 150, 150, 150, 150, 150, 150, 92, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 66, 82, 150, 150, 150, 150, 131, 150, 150, 76, 40, 150, 133, 150, 150, 150, 69, 150, 150, 150, 150, 113, 145, 121, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1116.584693832466, -364.32246295630495, -1189.3423397185295, -796.3422475843579, -1038.4134925521357, -640.5985502056692, -468.14459329498493, -36.40183295177788, -1009.2612793417908, -715.2803305129233, -1254.8614324363075, -899.7150358126497, -105.54366394052256, -199.46132311636725, -1166.5263739831125, -1259.934288795159, -1247.0297035909632, -196.4475284159007, -701.2542083631847, -641.5689176785644, -666.6748473550188, -734.3285504897136, -874.1976648678539, -1196.0587924031845, -854.1074477368059, -718.104095887377, -645.549656496523, -503.3257396257639, -974.0451406790085, -803.1123991364489, -630.418760858673, -1140.6414796738584, -913.0803642300466, -920.1989441325119, -432.85936494540204, -1011.3608480059315, -1017.5630417467189, -571.0134973515214, -467.98859080638425, -847.7921302487964, -89.58384020609579, -820.721599684651, -956.2817147419178, -373.65182522666703, -779.1889808213525, -633.6438494518934, -780.0995007124606, -253.4466848911955, -24.902365429358536, -906.578891710195, -865.4994760987103, -1205.6686417796323, -709.7855919330336, -1256.7459549099465, -1138.0991075087431, -253.0565563634825, -44.926635978308504, -1177.4853816297293, -776.444347653296, -863.0029198271598, -481.30016679709775, -1036.5329296434084, -550.3836170595521, -506.84031949269774, -853.2053179005245, -1093.4053230849486, -675.5217306503524, -1022.1311241632538, -852.605076397974, -160.6790223091998, -198.64760330836856, -150.09603427062004, -1197.0513578577868, -1154.0810378462108, -1029.381413590115, -1399.6242538703673, -610.209103090631, -905.6160657623299, -804.2636739435097, -124.03457039562062, -9.33890777770597, -617.4629078089578, -461.55207750012033, -749.4164160291699, -1047.796879565014, -802.4416253365775, -208.8814267930322, -1034.1371643355694, -724.6493596100211, -754.4806950405078, -700.2873249887106, -353.07588860698354, -550.1668986670381, -582.325556809031, -1010.7502432256233, -1133.8053188781305, -1092.2837283235265, -1010.1111786021099, -522.2096880046827, -814.336346404731]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545328442665451, "mean_inference_ms": 1.6849733336383814, "mean_action_processing_ms": 0.2806091156485224, "mean_env_wait_ms": 3.0335585356823818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01183009147644043, "StateBufferConnector_ms": 0.007826805114746094, "ViewRequirementAgentConnector_ms": 0.18973588943481445}, "num_episodes": 28, "episode_return_max": -9.33890777770597, "episode_return_min": -1399.6242538703673, "episode_return_mean": -738.6338889606086, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.07458929120884, "num_env_steps_trained_throughput_per_sec": 306.07458929120884, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 11467.866, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11467.8, "sample_time_ms": 1059.675, "learn_time_ms": 10343.429, "learn_throughput": 386.719, "synch_weights_time_ms": 63.927}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "39e3f_00000", "date": "2024-08-03_03-45-30", "timestamp": 1722636930, "time_this_iter_s": 13.080198049545288, "time_total_s": 199.49623012542725, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d813e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 199.49623012542725, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 16.84736842105263, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.133232069512207, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.319921510914961, "policy_loss": -0.013991790018432463, "vf_loss": 8.327511886755625, "vf_explained_var": 0.849558350071311, "kl": 0.021382263124814928, "entropy": 1.330095084818701, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -9.33890777770597, "episode_reward_min": -1399.6242538703673, "episode_reward_mean": -716.7396157220729, "episode_len_mean": 135.24, "episode_media": {}, "episodes_timesteps_total": 13524, "policy_reward_min": {"policy_0": -1399.6242538703673}, "policy_reward_max": {"policy_0": -9.33890777770597}, "policy_reward_mean": {"policy_0": -716.7396157220729}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1140.6414796738584, -913.0803642300466, -920.1989441325119, -432.85936494540204, -1011.3608480059315, -1017.5630417467189, -571.0134973515214, -467.98859080638425, -847.7921302487964, -89.58384020609579, -820.721599684651, -956.2817147419178, -373.65182522666703, -779.1889808213525, -633.6438494518934, -780.0995007124606, -253.4466848911955, -24.902365429358536, -906.578891710195, -865.4994760987103, -1205.6686417796323, -709.7855919330336, -1256.7459549099465, -1138.0991075087431, -253.0565563634825, -44.926635978308504, -1177.4853816297293, -776.444347653296, -863.0029198271598, -481.30016679709775, -1036.5329296434084, -550.3836170595521, -506.84031949269774, -853.2053179005245, -1093.4053230849486, -675.5217306503524, -1022.1311241632538, -852.605076397974, -160.6790223091998, -198.64760330836856, -150.09603427062004, -1197.0513578577868, -1154.0810378462108, -1029.381413590115, -1399.6242538703673, -610.209103090631, -905.6160657623299, -804.2636739435097, -124.03457039562062, -9.33890777770597, -617.4629078089578, -461.55207750012033, -749.4164160291699, -1047.796879565014, -802.4416253365775, -208.8814267930322, -1034.1371643355694, -724.6493596100211, -754.4806950405078, -700.2873249887106, -353.07588860698354, -550.1668986670381, -582.325556809031, -1010.7502432256233, -1133.8053188781305, -1092.2837283235265, -1010.1111786021099, -522.2096880046827, -814.336346404731, -206.9611631657513, -1263.6564675128013, -171.27940072365635, -337.1583045622144, -1004.679553738877, -1016.5746605467825, -55.29856096480772, -700.0164902895634, -1128.1153860404852, -1203.1830616435743, -551.823927394192, -654.5215525803842, -364.0541434851286, -860.505610550972, -1121.0406462006772, -60.724417792399684, -307.40782834250155, -1245.5812158033884, -303.92397325004316, -1011.8718452339716, -617.9194001512776, -696.8059747795064, -480.9450475627154, -772.5922076277903, -82.56513355822327, -1176.718496122537, -1063.9992846579132, -1028.11811953328, -543.0104146498174, -652.836684470667, -773.6410978305795], "episode_lengths": [150, 150, 150, 150, 150, 150, 138, 150, 150, 86, 150, 150, 150, 150, 150, 150, 86, 54, 150, 150, 150, 150, 150, 150, 92, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 66, 82, 150, 150, 150, 150, 131, 150, 150, 76, 40, 150, 133, 150, 150, 150, 69, 150, 150, 150, 150, 113, 145, 121, 150, 150, 150, 150, 150, 150, 87, 150, 90, 91, 150, 150, 67, 150, 150, 150, 150, 150, 130, 150, 150, 56, 150, 150, 99, 150, 150, 150, 115, 150, 82, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1140.6414796738584, -913.0803642300466, -920.1989441325119, -432.85936494540204, -1011.3608480059315, -1017.5630417467189, -571.0134973515214, -467.98859080638425, -847.7921302487964, -89.58384020609579, -820.721599684651, -956.2817147419178, -373.65182522666703, -779.1889808213525, -633.6438494518934, -780.0995007124606, -253.4466848911955, -24.902365429358536, -906.578891710195, -865.4994760987103, -1205.6686417796323, -709.7855919330336, -1256.7459549099465, -1138.0991075087431, -253.0565563634825, -44.926635978308504, -1177.4853816297293, -776.444347653296, -863.0029198271598, -481.30016679709775, -1036.5329296434084, -550.3836170595521, -506.84031949269774, -853.2053179005245, -1093.4053230849486, -675.5217306503524, -1022.1311241632538, -852.605076397974, -160.6790223091998, -198.64760330836856, -150.09603427062004, -1197.0513578577868, -1154.0810378462108, -1029.381413590115, -1399.6242538703673, -610.209103090631, -905.6160657623299, -804.2636739435097, -124.03457039562062, -9.33890777770597, -617.4629078089578, -461.55207750012033, -749.4164160291699, -1047.796879565014, -802.4416253365775, -208.8814267930322, -1034.1371643355694, -724.6493596100211, -754.4806950405078, -700.2873249887106, -353.07588860698354, -550.1668986670381, -582.325556809031, -1010.7502432256233, -1133.8053188781305, -1092.2837283235265, -1010.1111786021099, -522.2096880046827, -814.336346404731, -206.9611631657513, -1263.6564675128013, -171.27940072365635, -337.1583045622144, -1004.679553738877, -1016.5746605467825, -55.29856096480772, -700.0164902895634, -1128.1153860404852, -1203.1830616435743, -551.823927394192, -654.5215525803842, -364.0541434851286, -860.505610550972, -1121.0406462006772, -60.724417792399684, -307.40782834250155, -1245.5812158033884, -303.92397325004316, -1011.8718452339716, -617.9194001512776, -696.8059747795064, -480.9450475627154, -772.5922076277903, -82.56513355822327, -1176.718496122537, -1063.9992846579132, -1028.11811953328, -543.0104146498174, -652.836684470667, -773.6410978305795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543336819886416, "mean_inference_ms": 1.6830121943813179, "mean_action_processing_ms": 0.2800842103253339, "mean_env_wait_ms": 3.0329634415620808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01206517219543457, "StateBufferConnector_ms": 0.007838010787963867, "ViewRequirementAgentConnector_ms": 0.19093918800354004}, "num_episodes": 31, "episode_return_max": -9.33890777770597, "episode_return_min": -1399.6242538703673, "episode_return_mean": -716.7396157220729, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.6207893122892, "num_env_steps_trained_throughput_per_sec": 304.6207893122892, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 11830.221, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11830.154, "sample_time_ms": 1060.258, "learn_time_ms": 10704.039, "learn_throughput": 373.691, "synch_weights_time_ms": 65.081}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "39e3f_00000", "date": "2024-08-03_03-45-44", "timestamp": 1722636944, "time_this_iter_s": 13.144948959350586, "time_total_s": 212.64117908477783, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d813d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 212.64117908477783, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 16.85263157894737, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.245796311398344, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.033510591089726, "policy_loss": -0.007548806991932603, "vf_loss": 8.034755424658458, "vf_explained_var": 0.8254653496046861, "kl": 0.01404169305545416, "entropy": 1.479755873978138, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -9.33890777770597, "episode_reward_min": -1399.6242538703673, "episode_reward_mean": -708.3917205186779, "episode_len_mean": 133.25, "episode_media": {}, "episodes_timesteps_total": 13325, "policy_reward_min": {"policy_0": -1399.6242538703673}, "policy_reward_max": {"policy_0": -9.33890777770597}, "policy_reward_mean": {"policy_0": -708.3917205186779}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-550.3836170595521, -506.84031949269774, -853.2053179005245, -1093.4053230849486, -675.5217306503524, -1022.1311241632538, -852.605076397974, -160.6790223091998, -198.64760330836856, -150.09603427062004, -1197.0513578577868, -1154.0810378462108, -1029.381413590115, -1399.6242538703673, -610.209103090631, -905.6160657623299, -804.2636739435097, -124.03457039562062, -9.33890777770597, -617.4629078089578, -461.55207750012033, -749.4164160291699, -1047.796879565014, -802.4416253365775, -208.8814267930322, -1034.1371643355694, -724.6493596100211, -754.4806950405078, -700.2873249887106, -353.07588860698354, -550.1668986670381, -582.325556809031, -1010.7502432256233, -1133.8053188781305, -1092.2837283235265, -1010.1111786021099, -522.2096880046827, -814.336346404731, -206.9611631657513, -1263.6564675128013, -171.27940072365635, -337.1583045622144, -1004.679553738877, -1016.5746605467825, -55.29856096480772, -700.0164902895634, -1128.1153860404852, -1203.1830616435743, -551.823927394192, -654.5215525803842, -364.0541434851286, -860.505610550972, -1121.0406462006772, -60.724417792399684, -307.40782834250155, -1245.5812158033884, -303.92397325004316, -1011.8718452339716, -617.9194001512776, -696.8059747795064, -480.9450475627154, -772.5922076277903, -82.56513355822327, -1176.718496122537, -1063.9992846579132, -1028.11811953328, -543.0104146498174, -652.836684470667, -773.6410978305795, -1056.0019999540284, -911.6072889130267, -785.9064162909457, -688.8166894725139, -1052.9990472802128, -558.5438271596212, -373.32189377873254, -700.5481009812303, -308.4415813244178, -1228.243974011824, -556.0624862100143, -1073.0857272353805, -40.94353838593045, -634.8012112569038, -788.2227376451691, -1300.0880514900025, -267.2957310535121, -954.7006521815192, -1268.607097252504, -354.5553958016984, -245.34218679597495, -996.8533902679884, -728.9348216616603, -99.13757777461728, -852.1146272672712, -92.3998839747036, -1361.8153158010916, -869.1096970232122, -271.044841400126, -178.96729817952163, -1315.842615974638], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 106, 66, 82, 150, 150, 150, 150, 131, 150, 150, 76, 40, 150, 133, 150, 150, 150, 69, 150, 150, 150, 150, 113, 145, 121, 150, 150, 150, 150, 150, 150, 87, 150, 90, 91, 150, 150, 67, 150, 150, 150, 150, 150, 130, 150, 150, 56, 150, 150, 99, 150, 150, 150, 115, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 60, 150, 150, 150, 106, 150, 150, 97, 87, 150, 150, 74, 150, 90, 150, 150, 83, 85, 150], "policy_policy_0_reward": [-550.3836170595521, -506.84031949269774, -853.2053179005245, -1093.4053230849486, -675.5217306503524, -1022.1311241632538, -852.605076397974, -160.6790223091998, -198.64760330836856, -150.09603427062004, -1197.0513578577868, -1154.0810378462108, -1029.381413590115, -1399.6242538703673, -610.209103090631, -905.6160657623299, -804.2636739435097, -124.03457039562062, -9.33890777770597, -617.4629078089578, -461.55207750012033, -749.4164160291699, -1047.796879565014, -802.4416253365775, -208.8814267930322, -1034.1371643355694, -724.6493596100211, -754.4806950405078, -700.2873249887106, -353.07588860698354, -550.1668986670381, -582.325556809031, -1010.7502432256233, -1133.8053188781305, -1092.2837283235265, -1010.1111786021099, -522.2096880046827, -814.336346404731, -206.9611631657513, -1263.6564675128013, -171.27940072365635, -337.1583045622144, -1004.679553738877, -1016.5746605467825, -55.29856096480772, -700.0164902895634, -1128.1153860404852, -1203.1830616435743, -551.823927394192, -654.5215525803842, -364.0541434851286, -860.505610550972, -1121.0406462006772, -60.724417792399684, -307.40782834250155, -1245.5812158033884, -303.92397325004316, -1011.8718452339716, -617.9194001512776, -696.8059747795064, -480.9450475627154, -772.5922076277903, -82.56513355822327, -1176.718496122537, -1063.9992846579132, -1028.11811953328, -543.0104146498174, -652.836684470667, -773.6410978305795, -1056.0019999540284, -911.6072889130267, -785.9064162909457, -688.8166894725139, -1052.9990472802128, -558.5438271596212, -373.32189377873254, -700.5481009812303, -308.4415813244178, -1228.243974011824, -556.0624862100143, -1073.0857272353805, -40.94353838593045, -634.8012112569038, -788.2227376451691, -1300.0880514900025, -267.2957310535121, -954.7006521815192, -1268.607097252504, -354.5553958016984, -245.34218679597495, -996.8533902679884, -728.9348216616603, -99.13757777461728, -852.1146272672712, -92.3998839747036, -1361.8153158010916, -869.1096970232122, -271.044841400126, -178.96729817952163, -1315.842615974638]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541223394695194, "mean_inference_ms": 1.6814226069752078, "mean_action_processing_ms": 0.27984604719762934, "mean_env_wait_ms": 3.0341147567604736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012203454971313477, "StateBufferConnector_ms": 0.007791042327880859, "ViewRequirementAgentConnector_ms": 0.19118165969848633}, "num_episodes": 31, "episode_return_max": -9.33890777770597, "episode_return_min": -1399.6242538703673, "episode_return_mean": -708.3917205186779, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.74178012659087, "num_env_steps_trained_throughput_per_sec": 355.74178012659087, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 11776.435, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11776.367, "sample_time_ms": 1074.434, "learn_time_ms": 10634.814, "learn_throughput": 376.123, "synch_weights_time_ms": 66.332}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "39e3f_00000", "date": "2024-08-03_03-45-55", "timestamp": 1722636955, "time_this_iter_s": 11.257234573364258, "time_total_s": 223.8984136581421, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d812ef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 223.8984136581421, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.068749999999998, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.871808053553103, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.441324608027935, "policy_loss": -0.011726988010923377, "vf_loss": 8.445345834394296, "vf_explained_var": 0.8671745505183935, "kl": 0.01716083526631946, "entropy": 1.6612668335437775, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 2.0940090770716915, "episode_reward_min": -1408.0962017365605, "episode_reward_mean": -723.0902449053898, "episode_len_mean": 132.5, "episode_media": {}, "episodes_timesteps_total": 13250, "policy_reward_min": {"policy_0": -1408.0962017365605}, "policy_reward_max": {"policy_0": 2.0940090770716915}, "policy_reward_mean": {"policy_0": -723.0902449053898}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-550.1668986670381, -582.325556809031, -1010.7502432256233, -1133.8053188781305, -1092.2837283235265, -1010.1111786021099, -522.2096880046827, -814.336346404731, -206.9611631657513, -1263.6564675128013, -171.27940072365635, -337.1583045622144, -1004.679553738877, -1016.5746605467825, -55.29856096480772, -700.0164902895634, -1128.1153860404852, -1203.1830616435743, -551.823927394192, -654.5215525803842, -364.0541434851286, -860.505610550972, -1121.0406462006772, -60.724417792399684, -307.40782834250155, -1245.5812158033884, -303.92397325004316, -1011.8718452339716, -617.9194001512776, -696.8059747795064, -480.9450475627154, -772.5922076277903, -82.56513355822327, -1176.718496122537, -1063.9992846579132, -1028.11811953328, -543.0104146498174, -652.836684470667, -773.6410978305795, -1056.0019999540284, -911.6072889130267, -785.9064162909457, -688.8166894725139, -1052.9990472802128, -558.5438271596212, -373.32189377873254, -700.5481009812303, -308.4415813244178, -1228.243974011824, -556.0624862100143, -1073.0857272353805, -40.94353838593045, -634.8012112569038, -788.2227376451691, -1300.0880514900025, -267.2957310535121, -954.7006521815192, -1268.607097252504, -354.5553958016984, -245.34218679597495, -996.8533902679884, -728.9348216616603, -99.13757777461728, -852.1146272672712, -92.3998839747036, -1361.8153158010916, -869.1096970232122, -271.044841400126, -178.96729817952163, -1315.842615974638, -170.14096820518463, -739.7934306653465, -530.9917781437267, 2.0940090770716915, -1063.141549178922, -996.543453963236, -1103.3946733505175, -867.4860213795263, -171.4232618734953, -1272.5197235563776, -1321.9879392530408, -630.1159856182682, -118.13264190630544, -1408.0962017365605, -156.68469873347644, -274.0515526085063, -1069.5926752274984, -805.1879458664541, -1210.0321608239315, -731.9052573521883, -1151.1048776028133, -622.2255781698791, -201.51959987754535, -482.01855267843996, -1171.95580263325, -681.649104010491, -122.92527586828186, -948.8458108882858, -1098.3493999862476, -1101.4278449769263], "episode_lengths": [145, 121, 150, 150, 150, 150, 150, 150, 87, 150, 90, 91, 150, 150, 67, 150, 150, 150, 150, 150, 130, 150, 150, 56, 150, 150, 99, 150, 150, 150, 115, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 60, 150, 150, 150, 106, 150, 150, 97, 87, 150, 150, 74, 150, 90, 150, 150, 83, 85, 150, 102, 150, 150, 39, 150, 150, 150, 150, 82, 150, 150, 150, 56, 150, 78, 118, 150, 150, 150, 150, 150, 150, 74, 122, 150, 150, 70, 150, 150, 150], "policy_policy_0_reward": [-550.1668986670381, -582.325556809031, -1010.7502432256233, -1133.8053188781305, -1092.2837283235265, -1010.1111786021099, -522.2096880046827, -814.336346404731, -206.9611631657513, -1263.6564675128013, -171.27940072365635, -337.1583045622144, -1004.679553738877, -1016.5746605467825, -55.29856096480772, -700.0164902895634, -1128.1153860404852, -1203.1830616435743, -551.823927394192, -654.5215525803842, -364.0541434851286, -860.505610550972, -1121.0406462006772, -60.724417792399684, -307.40782834250155, -1245.5812158033884, -303.92397325004316, -1011.8718452339716, -617.9194001512776, -696.8059747795064, -480.9450475627154, -772.5922076277903, -82.56513355822327, -1176.718496122537, -1063.9992846579132, -1028.11811953328, -543.0104146498174, -652.836684470667, -773.6410978305795, -1056.0019999540284, -911.6072889130267, -785.9064162909457, -688.8166894725139, -1052.9990472802128, -558.5438271596212, -373.32189377873254, -700.5481009812303, -308.4415813244178, -1228.243974011824, -556.0624862100143, -1073.0857272353805, -40.94353838593045, -634.8012112569038, -788.2227376451691, -1300.0880514900025, -267.2957310535121, -954.7006521815192, -1268.607097252504, -354.5553958016984, -245.34218679597495, -996.8533902679884, -728.9348216616603, -99.13757777461728, -852.1146272672712, -92.3998839747036, -1361.8153158010916, -869.1096970232122, -271.044841400126, -178.96729817952163, -1315.842615974638, -170.14096820518463, -739.7934306653465, -530.9917781437267, 2.0940090770716915, -1063.141549178922, -996.543453963236, -1103.3946733505175, -867.4860213795263, -171.4232618734953, -1272.5197235563776, -1321.9879392530408, -630.1159856182682, -118.13264190630544, -1408.0962017365605, -156.68469873347644, -274.0515526085063, -1069.5926752274984, -805.1879458664541, -1210.0321608239315, -731.9052573521883, -1151.1048776028133, -622.2255781698791, -201.51959987754535, -482.01855267843996, -1171.95580263325, -681.649104010491, -122.92527586828186, -948.8458108882858, -1098.3493999862476, -1101.4278449769263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542548810549439, "mean_inference_ms": 1.681947460310749, "mean_action_processing_ms": 0.27998438100263034, "mean_env_wait_ms": 3.0401037553531847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012223958969116211, "StateBufferConnector_ms": 0.007872581481933594, "ViewRequirementAgentConnector_ms": 0.21273231506347656}, "num_episodes": 30, "episode_return_max": 2.0940090770716915, "episode_return_min": -1408.0962017365605, "episode_return_mean": -723.0902449053898, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.3598597574372, "num_env_steps_trained_throughput_per_sec": 302.3598597574372, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12306.445, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12306.374, "sample_time_ms": 1075.555, "learn_time_ms": 11162.193, "learn_throughput": 358.353, "synch_weights_time_ms": 67.833}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "39e3f_00000", "date": "2024-08-03_03-46-08", "timestamp": 1722636968, "time_this_iter_s": 13.241616487503052, "time_total_s": 237.14003014564514, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d4a0a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 237.14003014564514, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.05263157894737, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.55631679445505, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.102868404487769, "policy_loss": -0.010257798343081959, "vf_loss": 8.105707342922688, "vf_explained_var": 0.8677493945385019, "kl": 0.01652078199379806, "entropy": 1.5488914916912715, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": 2.0940090770716915, "episode_reward_min": -1408.0962017365605, "episode_reward_mean": -703.6598300351235, "episode_len_mean": 131.65, "episode_media": {}, "episodes_timesteps_total": 13165, "policy_reward_min": {"policy_0": -1408.0962017365605}, "policy_reward_max": {"policy_0": 2.0940090770716915}, "policy_reward_mean": {"policy_0": -703.6598300351235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-480.9450475627154, -772.5922076277903, -82.56513355822327, -1176.718496122537, -1063.9992846579132, -1028.11811953328, -543.0104146498174, -652.836684470667, -773.6410978305795, -1056.0019999540284, -911.6072889130267, -785.9064162909457, -688.8166894725139, -1052.9990472802128, -558.5438271596212, -373.32189377873254, -700.5481009812303, -308.4415813244178, -1228.243974011824, -556.0624862100143, -1073.0857272353805, -40.94353838593045, -634.8012112569038, -788.2227376451691, -1300.0880514900025, -267.2957310535121, -954.7006521815192, -1268.607097252504, -354.5553958016984, -245.34218679597495, -996.8533902679884, -728.9348216616603, -99.13757777461728, -852.1146272672712, -92.3998839747036, -1361.8153158010916, -869.1096970232122, -271.044841400126, -178.96729817952163, -1315.842615974638, -170.14096820518463, -739.7934306653465, -530.9917781437267, 2.0940090770716915, -1063.141549178922, -996.543453963236, -1103.3946733505175, -867.4860213795263, -171.4232618734953, -1272.5197235563776, -1321.9879392530408, -630.1159856182682, -118.13264190630544, -1408.0962017365605, -156.68469873347644, -274.0515526085063, -1069.5926752274984, -805.1879458664541, -1210.0321608239315, -731.9052573521883, -1151.1048776028133, -622.2255781698791, -201.51959987754535, -482.01855267843996, -1171.95580263325, -681.649104010491, -122.92527586828186, -948.8458108882858, -1098.3493999862476, -1101.4278449769263, -1205.182160333481, -622.4277577095004, -760.1391449894202, -1016.850954536517, -61.29518194738791, -76.06186113053066, -1020.0691464592511, -1318.9730747158274, -828.3281905139339, -203.85968591534143, -451.7708156828352, -45.76000559965371, -926.8441661069563, -502.1487665020983, -400.96524315021884, -638.5741598231587, -434.474509710213, -765.2282211257498, -177.58273870844522, -1322.2737453593447, -236.34027226634382, -1217.9294116764186, -737.9598061268113, -1086.279585474991, -422.7725997201311, -123.46652551626906, -883.3286412935935, -780.4200388268397, -789.1272106626483, -599.6174350572716], "episode_lengths": [115, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 60, 150, 150, 150, 106, 150, 150, 97, 87, 150, 150, 74, 150, 90, 150, 150, 83, 85, 150, 102, 150, 150, 39, 150, 150, 150, 150, 82, 150, 150, 150, 56, 150, 78, 118, 150, 150, 150, 150, 150, 150, 74, 122, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 68, 49, 150, 150, 150, 65, 126, 58, 150, 150, 150, 150, 150, 150, 66, 150, 129, 150, 150, 150, 150, 90, 150, 150, 150, 150], "policy_policy_0_reward": [-480.9450475627154, -772.5922076277903, -82.56513355822327, -1176.718496122537, -1063.9992846579132, -1028.11811953328, -543.0104146498174, -652.836684470667, -773.6410978305795, -1056.0019999540284, -911.6072889130267, -785.9064162909457, -688.8166894725139, -1052.9990472802128, -558.5438271596212, -373.32189377873254, -700.5481009812303, -308.4415813244178, -1228.243974011824, -556.0624862100143, -1073.0857272353805, -40.94353838593045, -634.8012112569038, -788.2227376451691, -1300.0880514900025, -267.2957310535121, -954.7006521815192, -1268.607097252504, -354.5553958016984, -245.34218679597495, -996.8533902679884, -728.9348216616603, -99.13757777461728, -852.1146272672712, -92.3998839747036, -1361.8153158010916, -869.1096970232122, -271.044841400126, -178.96729817952163, -1315.842615974638, -170.14096820518463, -739.7934306653465, -530.9917781437267, 2.0940090770716915, -1063.141549178922, -996.543453963236, -1103.3946733505175, -867.4860213795263, -171.4232618734953, -1272.5197235563776, -1321.9879392530408, -630.1159856182682, -118.13264190630544, -1408.0962017365605, -156.68469873347644, -274.0515526085063, -1069.5926752274984, -805.1879458664541, -1210.0321608239315, -731.9052573521883, -1151.1048776028133, -622.2255781698791, -201.51959987754535, -482.01855267843996, -1171.95580263325, -681.649104010491, -122.92527586828186, -948.8458108882858, -1098.3493999862476, -1101.4278449769263, -1205.182160333481, -622.4277577095004, -760.1391449894202, -1016.850954536517, -61.29518194738791, -76.06186113053066, -1020.0691464592511, -1318.9730747158274, -828.3281905139339, -203.85968591534143, -451.7708156828352, -45.76000559965371, -926.8441661069563, -502.1487665020983, -400.96524315021884, -638.5741598231587, -434.474509710213, -765.2282211257498, -177.58273870844522, -1322.2737453593447, -236.34027226634382, -1217.9294116764186, -737.9598061268113, -1086.279585474991, -422.7725997201311, -123.46652551626906, -883.3286412935935, -780.4200388268397, -789.1272106626483, -599.6174350572716]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544150011265482, "mean_inference_ms": 1.681600505294353, "mean_action_processing_ms": 0.2798747527663922, "mean_env_wait_ms": 3.0446247069089547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012094259262084961, "StateBufferConnector_ms": 0.00782465934753418, "ViewRequirementAgentConnector_ms": 0.21537303924560547}, "num_episodes": 30, "episode_return_max": 2.0940090770716915, "episode_return_min": -1408.0962017365605, "episode_return_mean": -703.6598300351235, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.6896724136606, "num_env_steps_trained_throughput_per_sec": 307.6896724136606, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12815.85, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12815.776, "sample_time_ms": 1060.575, "learn_time_ms": 11686.751, "learn_throughput": 342.268, "synch_weights_time_ms": 67.664}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "39e3f_00000", "date": "2024-08-03_03-46-21", "timestamp": 1722636981, "time_this_iter_s": 13.014115810394287, "time_total_s": 250.15414595603943, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d4a0790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 250.15414595603943, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.27777777777778, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.97230752557516, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.693141026298205, "policy_loss": -0.010713350771402475, "vf_loss": 8.69721567183733, "vf_explained_var": 0.8022209261233608, "kl": 0.0147899750458843, "entropy": 1.6814926808079085, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": 2.0940090770716915, "episode_reward_min": -1450.5781408199468, "episode_reward_mean": -731.6617958427785, "episode_len_mean": 130.96, "episode_media": {}, "episodes_timesteps_total": 13096, "policy_reward_min": {"policy_0": -1450.5781408199468}, "policy_reward_max": {"policy_0": 2.0940090770716915}, "policy_reward_mean": {"policy_0": -731.6617958427785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-354.5553958016984, -245.34218679597495, -996.8533902679884, -728.9348216616603, -99.13757777461728, -852.1146272672712, -92.3998839747036, -1361.8153158010916, -869.1096970232122, -271.044841400126, -178.96729817952163, -1315.842615974638, -170.14096820518463, -739.7934306653465, -530.9917781437267, 2.0940090770716915, -1063.141549178922, -996.543453963236, -1103.3946733505175, -867.4860213795263, -171.4232618734953, -1272.5197235563776, -1321.9879392530408, -630.1159856182682, -118.13264190630544, -1408.0962017365605, -156.68469873347644, -274.0515526085063, -1069.5926752274984, -805.1879458664541, -1210.0321608239315, -731.9052573521883, -1151.1048776028133, -622.2255781698791, -201.51959987754535, -482.01855267843996, -1171.95580263325, -681.649104010491, -122.92527586828186, -948.8458108882858, -1098.3493999862476, -1101.4278449769263, -1205.182160333481, -622.4277577095004, -760.1391449894202, -1016.850954536517, -61.29518194738791, -76.06186113053066, -1020.0691464592511, -1318.9730747158274, -828.3281905139339, -203.85968591534143, -451.7708156828352, -45.76000559965371, -926.8441661069563, -502.1487665020983, -400.96524315021884, -638.5741598231587, -434.474509710213, -765.2282211257498, -177.58273870844522, -1322.2737453593447, -236.34027226634382, -1217.9294116764186, -737.9598061268113, -1086.279585474991, -422.7725997201311, -123.46652551626906, -883.3286412935935, -780.4200388268397, -789.1272106626483, -599.6174350572716, -755.171334732988, -1450.5781408199468, -844.8420502494113, -148.10073438161217, -1247.0517270932773, -1106.5592935991583, -1095.654236553789, -90.94123104977871, -867.2969690627099, -836.9749011065978, -863.5992797173047, -1055.137924079032, -1172.7697331012962, -789.8019473630152, -1110.6557876657778, -634.5780486382685, -1084.13196257396, -998.9860343310762, -637.3837103376285, -939.708750920498, -1055.2375905033189, -342.6168542201773, -625.4038874391441, -8.052755419822146, -1316.52128041162, -1413.8328279939517, -935.4085125889887, -495.86361270238183], "episode_lengths": [97, 87, 150, 150, 74, 150, 90, 150, 150, 83, 85, 150, 102, 150, 150, 39, 150, 150, 150, 150, 82, 150, 150, 150, 56, 150, 78, 118, 150, 150, 150, 150, 150, 150, 74, 122, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 68, 49, 150, 150, 150, 65, 126, 58, 150, 150, 150, 150, 150, 150, 66, 150, 129, 150, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 102, 150, 36, 150, 150, 150, 133], "policy_policy_0_reward": [-354.5553958016984, -245.34218679597495, -996.8533902679884, -728.9348216616603, -99.13757777461728, -852.1146272672712, -92.3998839747036, -1361.8153158010916, -869.1096970232122, -271.044841400126, -178.96729817952163, -1315.842615974638, -170.14096820518463, -739.7934306653465, -530.9917781437267, 2.0940090770716915, -1063.141549178922, -996.543453963236, -1103.3946733505175, -867.4860213795263, -171.4232618734953, -1272.5197235563776, -1321.9879392530408, -630.1159856182682, -118.13264190630544, -1408.0962017365605, -156.68469873347644, -274.0515526085063, -1069.5926752274984, -805.1879458664541, -1210.0321608239315, -731.9052573521883, -1151.1048776028133, -622.2255781698791, -201.51959987754535, -482.01855267843996, -1171.95580263325, -681.649104010491, -122.92527586828186, -948.8458108882858, -1098.3493999862476, -1101.4278449769263, -1205.182160333481, -622.4277577095004, -760.1391449894202, -1016.850954536517, -61.29518194738791, -76.06186113053066, -1020.0691464592511, -1318.9730747158274, -828.3281905139339, -203.85968591534143, -451.7708156828352, -45.76000559965371, -926.8441661069563, -502.1487665020983, -400.96524315021884, -638.5741598231587, -434.474509710213, -765.2282211257498, -177.58273870844522, -1322.2737453593447, -236.34027226634382, -1217.9294116764186, -737.9598061268113, -1086.279585474991, -422.7725997201311, -123.46652551626906, -883.3286412935935, -780.4200388268397, -789.1272106626483, -599.6174350572716, -755.171334732988, -1450.5781408199468, -844.8420502494113, -148.10073438161217, -1247.0517270932773, -1106.5592935991583, -1095.654236553789, -90.94123104977871, -867.2969690627099, -836.9749011065978, -863.5992797173047, -1055.137924079032, -1172.7697331012962, -789.8019473630152, -1110.6557876657778, -634.5780486382685, -1084.13196257396, -998.9860343310762, -637.3837103376285, -939.708750920498, -1055.2375905033189, -342.6168542201773, -625.4038874391441, -8.052755419822146, -1316.52128041162, -1413.8328279939517, -935.4085125889887, -495.86361270238183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544427718728482, "mean_inference_ms": 1.6824730385372189, "mean_action_processing_ms": 0.2800466239023309, "mean_env_wait_ms": 3.048808831966029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01211690902709961, "StateBufferConnector_ms": 0.00783395767211914, "ViewRequirementAgentConnector_ms": 0.21342682838439941}, "num_episodes": 28, "episode_return_max": 2.0940090770716915, "episode_return_min": -1450.5781408199468, "episode_return_mean": -731.6617958427785, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.8274426900983, "num_env_steps_trained_throughput_per_sec": 302.8274426900983, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12932.696, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12932.623, "sample_time_ms": 1062.965, "learn_time_ms": 11802.034, "learn_throughput": 338.925, "synch_weights_time_ms": 66.84}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "39e3f_00000", "date": "2024-08-03_03-46-35", "timestamp": 1722636995, "time_this_iter_s": 13.221782445907593, "time_total_s": 263.375928401947, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d4a1fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 263.375928401947, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.53157894736842, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.730150356392066, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.71690039485693, "policy_loss": -0.0055752233262561885, "vf_loss": 7.7164060513178505, "vf_explained_var": 0.8958509902780255, "kl": 0.01352342327772934, "entropy": 1.59709001754721, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -8.052755419822146, "episode_reward_min": -1450.5781408199468, "episode_reward_mean": -734.9535545898726, "episode_len_mean": 133.96, "episode_media": {}, "episodes_timesteps_total": 13396, "policy_reward_min": {"policy_0": -1450.5781408199468}, "policy_reward_max": {"policy_0": -8.052755419822146}, "policy_reward_mean": {"policy_0": -734.9535545898726}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-805.1879458664541, -1210.0321608239315, -731.9052573521883, -1151.1048776028133, -622.2255781698791, -201.51959987754535, -482.01855267843996, -1171.95580263325, -681.649104010491, -122.92527586828186, -948.8458108882858, -1098.3493999862476, -1101.4278449769263, -1205.182160333481, -622.4277577095004, -760.1391449894202, -1016.850954536517, -61.29518194738791, -76.06186113053066, -1020.0691464592511, -1318.9730747158274, -828.3281905139339, -203.85968591534143, -451.7708156828352, -45.76000559965371, -926.8441661069563, -502.1487665020983, -400.96524315021884, -638.5741598231587, -434.474509710213, -765.2282211257498, -177.58273870844522, -1322.2737453593447, -236.34027226634382, -1217.9294116764186, -737.9598061268113, -1086.279585474991, -422.7725997201311, -123.46652551626906, -883.3286412935935, -780.4200388268397, -789.1272106626483, -599.6174350572716, -755.171334732988, -1450.5781408199468, -844.8420502494113, -148.10073438161217, -1247.0517270932773, -1106.5592935991583, -1095.654236553789, -90.94123104977871, -867.2969690627099, -836.9749011065978, -863.5992797173047, -1055.137924079032, -1172.7697331012962, -789.8019473630152, -1110.6557876657778, -634.5780486382685, -1084.13196257396, -998.9860343310762, -637.3837103376285, -939.708750920498, -1055.2375905033189, -342.6168542201773, -625.4038874391441, -8.052755419822146, -1316.52128041162, -1413.8328279939517, -935.4085125889887, -495.86361270238183, -823.3119777115702, -63.04319567052936, -918.8305866017341, -983.7194421433754, -927.2506472139138, -756.1880176331108, -252.23574527171587, -600.2379461330779, -1176.9351324026993, -746.0843873808356, -197.43370289265397, -758.4676407268026, -913.9808154801166, -637.8357806078939, -797.1090093538138, -856.6469361504289, -350.3276000677862, -214.63215416923072, -1205.366448617966, -140.59294708878264, -143.0741931408241, -971.3873716527319, -339.76258481327864, -880.3043427549494, -1030.0991528766845, -965.1030626558559, -645.1777185716185, -814.4551144237012, -477.70241874713275], "episode_lengths": [150, 150, 150, 150, 150, 74, 122, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 68, 49, 150, 150, 150, 65, 126, 58, 150, 150, 150, 150, 150, 150, 66, 150, 129, 150, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 102, 150, 36, 150, 150, 150, 133, 150, 68, 150, 150, 150, 150, 75, 150, 150, 150, 109, 150, 150, 150, 150, 150, 134, 94, 150, 67, 59, 150, 101, 150, 150, 150, 134, 150, 150], "policy_policy_0_reward": [-805.1879458664541, -1210.0321608239315, -731.9052573521883, -1151.1048776028133, -622.2255781698791, -201.51959987754535, -482.01855267843996, -1171.95580263325, -681.649104010491, -122.92527586828186, -948.8458108882858, -1098.3493999862476, -1101.4278449769263, -1205.182160333481, -622.4277577095004, -760.1391449894202, -1016.850954536517, -61.29518194738791, -76.06186113053066, -1020.0691464592511, -1318.9730747158274, -828.3281905139339, -203.85968591534143, -451.7708156828352, -45.76000559965371, -926.8441661069563, -502.1487665020983, -400.96524315021884, -638.5741598231587, -434.474509710213, -765.2282211257498, -177.58273870844522, -1322.2737453593447, -236.34027226634382, -1217.9294116764186, -737.9598061268113, -1086.279585474991, -422.7725997201311, -123.46652551626906, -883.3286412935935, -780.4200388268397, -789.1272106626483, -599.6174350572716, -755.171334732988, -1450.5781408199468, -844.8420502494113, -148.10073438161217, -1247.0517270932773, -1106.5592935991583, -1095.654236553789, -90.94123104977871, -867.2969690627099, -836.9749011065978, -863.5992797173047, -1055.137924079032, -1172.7697331012962, -789.8019473630152, -1110.6557876657778, -634.5780486382685, -1084.13196257396, -998.9860343310762, -637.3837103376285, -939.708750920498, -1055.2375905033189, -342.6168542201773, -625.4038874391441, -8.052755419822146, -1316.52128041162, -1413.8328279939517, -935.4085125889887, -495.86361270238183, -823.3119777115702, -63.04319567052936, -918.8305866017341, -983.7194421433754, -927.2506472139138, -756.1880176331108, -252.23574527171587, -600.2379461330779, -1176.9351324026993, -746.0843873808356, -197.43370289265397, -758.4676407268026, -913.9808154801166, -637.8357806078939, -797.1090093538138, -856.6469361504289, -350.3276000677862, -214.63215416923072, -1205.366448617966, -140.59294708878264, -143.0741931408241, -971.3873716527319, -339.76258481327864, -880.3043427549494, -1030.0991528766845, -965.1030626558559, -645.1777185716185, -814.4551144237012, -477.70241874713275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538498744636025, "mean_inference_ms": 1.6821875435812228, "mean_action_processing_ms": 0.2800807540785246, "mean_env_wait_ms": 3.0533021518403114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012222528457641602, "StateBufferConnector_ms": 0.007784843444824219, "ViewRequirementAgentConnector_ms": 0.19543218612670898}, "num_episodes": 29, "episode_return_max": -8.052755419822146, "episode_return_min": -1450.5781408199468, "episode_return_mean": -734.9535545898726, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.85775475917586, "num_env_steps_trained_throughput_per_sec": 302.85775475917586, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12921.868, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12921.796, "sample_time_ms": 1062.126, "learn_time_ms": 11791.687, "learn_throughput": 339.222, "synch_weights_time_ms": 67.192}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "39e3f_00000", "date": "2024-08-03_03-46-48", "timestamp": 1722637008, "time_this_iter_s": 13.22021222114563, "time_total_s": 276.59614062309265, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d4a28c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 276.59614062309265, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 16.952631578947365, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.98766700377067, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.033396836121877, "policy_loss": -0.007202437684948867, "vf_loss": 8.033830312887828, "vf_explained_var": 0.8454568169390162, "kl": 0.015081315840264663, "entropy": 1.765478330353896, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -8.052755419822146, "episode_reward_min": -1550.1358857234961, "episode_reward_mean": -767.1896261458106, "episode_len_mean": 135.57, "episode_media": {}, "episodes_timesteps_total": 13557, "policy_reward_min": {"policy_0": -1550.1358857234961}, "policy_reward_max": {"policy_0": -8.052755419822146}, "policy_reward_mean": {"policy_0": -767.1896261458106}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-765.2282211257498, -177.58273870844522, -1322.2737453593447, -236.34027226634382, -1217.9294116764186, -737.9598061268113, -1086.279585474991, -422.7725997201311, -123.46652551626906, -883.3286412935935, -780.4200388268397, -789.1272106626483, -599.6174350572716, -755.171334732988, -1450.5781408199468, -844.8420502494113, -148.10073438161217, -1247.0517270932773, -1106.5592935991583, -1095.654236553789, -90.94123104977871, -867.2969690627099, -836.9749011065978, -863.5992797173047, -1055.137924079032, -1172.7697331012962, -789.8019473630152, -1110.6557876657778, -634.5780486382685, -1084.13196257396, -998.9860343310762, -637.3837103376285, -939.708750920498, -1055.2375905033189, -342.6168542201773, -625.4038874391441, -8.052755419822146, -1316.52128041162, -1413.8328279939517, -935.4085125889887, -495.86361270238183, -823.3119777115702, -63.04319567052936, -918.8305866017341, -983.7194421433754, -927.2506472139138, -756.1880176331108, -252.23574527171587, -600.2379461330779, -1176.9351324026993, -746.0843873808356, -197.43370289265397, -758.4676407268026, -913.9808154801166, -637.8357806078939, -797.1090093538138, -856.6469361504289, -350.3276000677862, -214.63215416923072, -1205.366448617966, -140.59294708878264, -143.0741931408241, -971.3873716527319, -339.76258481327864, -880.3043427549494, -1030.0991528766845, -965.1030626558559, -645.1777185716185, -814.4551144237012, -477.70241874713275, -939.8374693843592, -620.9979440882612, -1043.4698558285852, -497.5508929920845, -931.5440210454923, -27.56522316093474, -896.8288360427206, -1021.5071462541543, -1062.3063731559546, -1018.8815998509192, -825.6428253621626, -721.7875317829581, -957.5326163273269, -725.4922583217241, -451.6011140761883, -441.152422543182, -1284.8937475414582, -1021.0840397620939, -943.6998875922326, -72.0939058624056, -601.7249468207802, -85.09623520346528, -1550.1358857234961, -843.0797767003731, -985.1448963800955, -1114.387781601752, -968.2312414971503, -386.71959427789795, -1213.4686247338059, -813.0204972408326], "episode_lengths": [150, 66, 150, 129, 150, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 102, 150, 36, 150, 150, 150, 133, 150, 68, 150, 150, 150, 150, 75, 150, 150, 150, 109, 150, 150, 150, 150, 150, 134, 94, 150, 67, 59, 150, 101, 150, 150, 150, 134, 150, 150, 150, 150, 150, 127, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 43, 150, 76, 150, 150, 150, 150, 150, 101, 150, 150], "policy_policy_0_reward": [-765.2282211257498, -177.58273870844522, -1322.2737453593447, -236.34027226634382, -1217.9294116764186, -737.9598061268113, -1086.279585474991, -422.7725997201311, -123.46652551626906, -883.3286412935935, -780.4200388268397, -789.1272106626483, -599.6174350572716, -755.171334732988, -1450.5781408199468, -844.8420502494113, -148.10073438161217, -1247.0517270932773, -1106.5592935991583, -1095.654236553789, -90.94123104977871, -867.2969690627099, -836.9749011065978, -863.5992797173047, -1055.137924079032, -1172.7697331012962, -789.8019473630152, -1110.6557876657778, -634.5780486382685, -1084.13196257396, -998.9860343310762, -637.3837103376285, -939.708750920498, -1055.2375905033189, -342.6168542201773, -625.4038874391441, -8.052755419822146, -1316.52128041162, -1413.8328279939517, -935.4085125889887, -495.86361270238183, -823.3119777115702, -63.04319567052936, -918.8305866017341, -983.7194421433754, -927.2506472139138, -756.1880176331108, -252.23574527171587, -600.2379461330779, -1176.9351324026993, -746.0843873808356, -197.43370289265397, -758.4676407268026, -913.9808154801166, -637.8357806078939, -797.1090093538138, -856.6469361504289, -350.3276000677862, -214.63215416923072, -1205.366448617966, -140.59294708878264, -143.0741931408241, -971.3873716527319, -339.76258481327864, -880.3043427549494, -1030.0991528766845, -965.1030626558559, -645.1777185716185, -814.4551144237012, -477.70241874713275, -939.8374693843592, -620.9979440882612, -1043.4698558285852, -497.5508929920845, -931.5440210454923, -27.56522316093474, -896.8288360427206, -1021.5071462541543, -1062.3063731559546, -1018.8815998509192, -825.6428253621626, -721.7875317829581, -957.5326163273269, -725.4922583217241, -451.6011140761883, -441.152422543182, -1284.8937475414582, -1021.0840397620939, -943.6998875922326, -72.0939058624056, -601.7249468207802, -85.09623520346528, -1550.1358857234961, -843.0797767003731, -985.1448963800955, -1114.387781601752, -968.2312414971503, -386.71959427789795, -1213.4686247338059, -813.0204972408326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553478042205759, "mean_inference_ms": 1.6811373455754395, "mean_action_processing_ms": 0.2797535405281584, "mean_env_wait_ms": 3.0533811541504448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012432336807250977, "StateBufferConnector_ms": 0.007849931716918945, "ViewRequirementAgentConnector_ms": 0.19454717636108398}, "num_episodes": 30, "episode_return_max": -8.052755419822146, "episode_return_min": -1550.1358857234961, "episode_return_mean": -767.1896261458106, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.6880190391821, "num_env_steps_trained_throughput_per_sec": 307.6880190391821, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12929.942, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12929.872, "sample_time_ms": 1058.037, "learn_time_ms": 11803.489, "learn_throughput": 338.883, "synch_weights_time_ms": 67.565}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "39e3f_00000", "date": "2024-08-03_03-47-01", "timestamp": 1722637021, "time_this_iter_s": 13.012155532836914, "time_total_s": 289.60829615592957, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d963910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 289.60829615592957, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.666666666666668, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.82600308159987, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.0431457241376245, "policy_loss": -0.008799507023650222, "vf_loss": 7.044611273705959, "vf_explained_var": 0.8947577382127444, "kl": 0.016330350434873294, "entropy": 1.4683615210776528, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -8.052755419822146, "episode_reward_min": -1550.1358857234961, "episode_reward_mean": -758.5299933886278, "episode_len_mean": 134.77, "episode_media": {}, "episodes_timesteps_total": 13477, "policy_reward_min": {"policy_0": -1550.1358857234961}, "policy_reward_max": {"policy_0": -8.052755419822146}, "policy_reward_mean": {"policy_0": -758.5299933886278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1055.2375905033189, -342.6168542201773, -625.4038874391441, -8.052755419822146, -1316.52128041162, -1413.8328279939517, -935.4085125889887, -495.86361270238183, -823.3119777115702, -63.04319567052936, -918.8305866017341, -983.7194421433754, -927.2506472139138, -756.1880176331108, -252.23574527171587, -600.2379461330779, -1176.9351324026993, -746.0843873808356, -197.43370289265397, -758.4676407268026, -913.9808154801166, -637.8357806078939, -797.1090093538138, -856.6469361504289, -350.3276000677862, -214.63215416923072, -1205.366448617966, -140.59294708878264, -143.0741931408241, -971.3873716527319, -339.76258481327864, -880.3043427549494, -1030.0991528766845, -965.1030626558559, -645.1777185716185, -814.4551144237012, -477.70241874713275, -939.8374693843592, -620.9979440882612, -1043.4698558285852, -497.5508929920845, -931.5440210454923, -27.56522316093474, -896.8288360427206, -1021.5071462541543, -1062.3063731559546, -1018.8815998509192, -825.6428253621626, -721.7875317829581, -957.5326163273269, -725.4922583217241, -451.6011140761883, -441.152422543182, -1284.8937475414582, -1021.0840397620939, -943.6998875922326, -72.0939058624056, -601.7249468207802, -85.09623520346528, -1550.1358857234961, -843.0797767003731, -985.1448963800955, -1114.387781601752, -968.2312414971503, -386.71959427789795, -1213.4686247338059, -813.0204972408326, -507.409119863805, -1080.4524287867266, -1257.1902569304489, -1346.2410345311619, -1298.7989984425972, -51.44063869950325, -45.00351005047877, -998.9572724679795, -1036.2777331800673, -778.5667762988769, -788.4610255412671, -1061.4329036787622, -147.25816708083354, -703.0794561825088, -912.8903819847873, -505.3444618031511, -632.5920340067281, -163.33941023267332, -1117.4971657111696, -781.5966142741837, -732.7281484303873, -621.4609269230481, -1161.663670095863, -454.42377309235235, -643.1714352536492, -783.1754921528675, -968.2012272616129, -822.9876702319019, -277.4958198316871, -1299.9409904676497, -712.6437955398235, -943.9466741333154, -1370.6177403118531], "episode_lengths": [150, 102, 150, 36, 150, 150, 150, 133, 150, 68, 150, 150, 150, 150, 75, 150, 150, 150, 109, 150, 150, 150, 150, 150, 134, 94, 150, 67, 59, 150, 101, 150, 150, 150, 134, 150, 150, 150, 150, 150, 127, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 43, 150, 76, 150, 150, 150, 150, 150, 101, 150, 150, 127, 150, 150, 150, 150, 64, 48, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 105, 150, 150, 150, 150], "policy_policy_0_reward": [-1055.2375905033189, -342.6168542201773, -625.4038874391441, -8.052755419822146, -1316.52128041162, -1413.8328279939517, -935.4085125889887, -495.86361270238183, -823.3119777115702, -63.04319567052936, -918.8305866017341, -983.7194421433754, -927.2506472139138, -756.1880176331108, -252.23574527171587, -600.2379461330779, -1176.9351324026993, -746.0843873808356, -197.43370289265397, -758.4676407268026, -913.9808154801166, -637.8357806078939, -797.1090093538138, -856.6469361504289, -350.3276000677862, -214.63215416923072, -1205.366448617966, -140.59294708878264, -143.0741931408241, -971.3873716527319, -339.76258481327864, -880.3043427549494, -1030.0991528766845, -965.1030626558559, -645.1777185716185, -814.4551144237012, -477.70241874713275, -939.8374693843592, -620.9979440882612, -1043.4698558285852, -497.5508929920845, -931.5440210454923, -27.56522316093474, -896.8288360427206, -1021.5071462541543, -1062.3063731559546, -1018.8815998509192, -825.6428253621626, -721.7875317829581, -957.5326163273269, -725.4922583217241, -451.6011140761883, -441.152422543182, -1284.8937475414582, -1021.0840397620939, -943.6998875922326, -72.0939058624056, -601.7249468207802, -85.09623520346528, -1550.1358857234961, -843.0797767003731, -985.1448963800955, -1114.387781601752, -968.2312414971503, -386.71959427789795, -1213.4686247338059, -813.0204972408326, -507.409119863805, -1080.4524287867266, -1257.1902569304489, -1346.2410345311619, -1298.7989984425972, -51.44063869950325, -45.00351005047877, -998.9572724679795, -1036.2777331800673, -778.5667762988769, -788.4610255412671, -1061.4329036787622, -147.25816708083354, -703.0794561825088, -912.8903819847873, -505.3444618031511, -632.5920340067281, -163.33941023267332, -1117.4971657111696, -781.5966142741837, -732.7281484303873, -621.4609269230481, -1161.663670095863, -454.42377309235235, -643.1714352536492, -783.1754921528675, -968.2012272616129, -822.9876702319019, -277.4958198316871, -1299.9409904676497, -712.6437955398235, -943.9466741333154, -1370.6177403118531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533303135997839, "mean_inference_ms": 1.6791479207885276, "mean_action_processing_ms": 0.2792210394005347, "mean_env_wait_ms": 3.053855017615829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012361288070678711, "StateBufferConnector_ms": 0.007942914962768555, "ViewRequirementAgentConnector_ms": 0.19343209266662598}, "num_episodes": 33, "episode_return_max": -8.052755419822146, "episode_return_min": -1550.1358857234961, "episode_return_mean": -758.5299933886278, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.9704967140426, "num_env_steps_trained_throughput_per_sec": 300.9704967140426, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12954.4, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12954.33, "sample_time_ms": 1062.635, "learn_time_ms": 11821.714, "learn_throughput": 338.36, "synch_weights_time_ms": 69.2}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "training_iteration": 25, "trial_id": "39e3f_00000", "date": "2024-08-03_03-47-14", "timestamp": 1722637034, "time_this_iter_s": 13.302211046218872, "time_total_s": 302.91050720214844, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d812950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 302.91050720214844, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.673684210526318, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.81687415291866, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.808117722471555, "policy_loss": -0.005667912924157766, "vf_loss": 7.806075422465801, "vf_explained_var": 0.8695713551715016, "kl": 0.017166539049988733, "entropy": 1.4728302272657554, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": -27.56522316093474, "episode_reward_min": -1550.1358857234961, "episode_reward_mean": -775.8296079837836, "episode_len_mean": 136.65, "episode_media": {}, "episodes_timesteps_total": 13665, "policy_reward_min": {"policy_0": -1550.1358857234961}, "policy_reward_max": {"policy_0": -27.56522316093474}, "policy_reward_mean": {"policy_0": -775.8296079837836}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-143.0741931408241, -971.3873716527319, -339.76258481327864, -880.3043427549494, -1030.0991528766845, -965.1030626558559, -645.1777185716185, -814.4551144237012, -477.70241874713275, -939.8374693843592, -620.9979440882612, -1043.4698558285852, -497.5508929920845, -931.5440210454923, -27.56522316093474, -896.8288360427206, -1021.5071462541543, -1062.3063731559546, -1018.8815998509192, -825.6428253621626, -721.7875317829581, -957.5326163273269, -725.4922583217241, -451.6011140761883, -441.152422543182, -1284.8937475414582, -1021.0840397620939, -943.6998875922326, -72.0939058624056, -601.7249468207802, -85.09623520346528, -1550.1358857234961, -843.0797767003731, -985.1448963800955, -1114.387781601752, -968.2312414971503, -386.71959427789795, -1213.4686247338059, -813.0204972408326, -507.409119863805, -1080.4524287867266, -1257.1902569304489, -1346.2410345311619, -1298.7989984425972, -51.44063869950325, -45.00351005047877, -998.9572724679795, -1036.2777331800673, -778.5667762988769, -788.4610255412671, -1061.4329036787622, -147.25816708083354, -703.0794561825088, -912.8903819847873, -505.3444618031511, -632.5920340067281, -163.33941023267332, -1117.4971657111696, -781.5966142741837, -732.7281484303873, -621.4609269230481, -1161.663670095863, -454.42377309235235, -643.1714352536492, -783.1754921528675, -968.2012272616129, -822.9876702319019, -277.4958198316871, -1299.9409904676497, -712.6437955398235, -943.9466741333154, -1370.6177403118531, -1084.9373244764106, -1045.6736024718132, -436.25678988022014, -1015.8273443553062, -564.3608588881901, -931.2319070872499, -334.81766372148775, -392.07024187858343, -609.7590462397395, -1078.5356079588498, -473.9662992414654, -664.7419584536734, -653.0972491497354, -310.4549371466211, -894.8900743256116, -754.01683912358, -772.6169663792713, -996.33080003192, -1261.3661531906012, -365.92113558913366, -661.6963827060067, -1141.310009382635, -647.4522481977332, -211.91944195812448, -1255.5029827584196, -981.3891146232081, -837.1405931759355, -865.8453217215006], "episode_lengths": [59, 150, 101, 150, 150, 150, 134, 150, 150, 150, 150, 150, 127, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 43, 150, 76, 150, 150, 150, 150, 150, 101, 150, 150, 127, 150, 150, 150, 150, 64, 48, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 107, 150, 121, 150, 115, 110, 143, 150, 110, 150, 150, 98, 150, 150, 150, 150, 150, 105, 150, 150, 150, 97, 150, 150, 150, 150], "policy_policy_0_reward": [-143.0741931408241, -971.3873716527319, -339.76258481327864, -880.3043427549494, -1030.0991528766845, -965.1030626558559, -645.1777185716185, -814.4551144237012, -477.70241874713275, -939.8374693843592, -620.9979440882612, -1043.4698558285852, -497.5508929920845, -931.5440210454923, -27.56522316093474, -896.8288360427206, -1021.5071462541543, -1062.3063731559546, -1018.8815998509192, -825.6428253621626, -721.7875317829581, -957.5326163273269, -725.4922583217241, -451.6011140761883, -441.152422543182, -1284.8937475414582, -1021.0840397620939, -943.6998875922326, -72.0939058624056, -601.7249468207802, -85.09623520346528, -1550.1358857234961, -843.0797767003731, -985.1448963800955, -1114.387781601752, -968.2312414971503, -386.71959427789795, -1213.4686247338059, -813.0204972408326, -507.409119863805, -1080.4524287867266, -1257.1902569304489, -1346.2410345311619, -1298.7989984425972, -51.44063869950325, -45.00351005047877, -998.9572724679795, -1036.2777331800673, -778.5667762988769, -788.4610255412671, -1061.4329036787622, -147.25816708083354, -703.0794561825088, -912.8903819847873, -505.3444618031511, -632.5920340067281, -163.33941023267332, -1117.4971657111696, -781.5966142741837, -732.7281484303873, -621.4609269230481, -1161.663670095863, -454.42377309235235, -643.1714352536492, -783.1754921528675, -968.2012272616129, -822.9876702319019, -277.4958198316871, -1299.9409904676497, -712.6437955398235, -943.9466741333154, -1370.6177403118531, -1084.9373244764106, -1045.6736024718132, -436.25678988022014, -1015.8273443553062, -564.3608588881901, -931.2319070872499, -334.81766372148775, -392.07024187858343, -609.7590462397395, -1078.5356079588498, -473.9662992414654, -664.7419584536734, -653.0972491497354, -310.4549371466211, -894.8900743256116, -754.01683912358, -772.6169663792713, -996.33080003192, -1261.3661531906012, -365.92113558913366, -661.6963827060067, -1141.310009382635, -647.4522481977332, -211.91944195812448, -1255.5029827584196, -981.3891146232081, -837.1405931759355, -865.8453217215006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533275363462067, "mean_inference_ms": 1.6791354653482042, "mean_action_processing_ms": 0.27913013292647754, "mean_env_wait_ms": 3.0559563241653085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01255488395690918, "StateBufferConnector_ms": 0.008034944534301758, "ViewRequirementAgentConnector_ms": 0.19247722625732422}, "num_episodes": 28, "episode_return_max": -27.56522316093474, "episode_return_min": -1550.1358857234961, "episode_return_mean": -775.8296079837836, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.76933657410143, "num_env_steps_trained_throughput_per_sec": 303.76933657410143, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 12954.817, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12954.743, "sample_time_ms": 1061.336, "learn_time_ms": 11823.837, "learn_throughput": 338.3, "synch_weights_time_ms": 68.787}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 26, "trial_id": "39e3f_00000", "date": "2024-08-03_03-47-28", "timestamp": 1722637048, "time_this_iter_s": 13.18134069442749, "time_total_s": 316.0918478965759, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d4a13f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 316.0918478965759, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.05263157894737, "ram_util_percent": 27.64736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.26409505556027, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.816746388872464, "policy_loss": -0.01063077728128216, "vf_loss": 7.820148782928785, "vf_explained_var": 0.8797728916009268, "kl": 0.016093079563749293, "entropy": 1.3469971794014175, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": -19.34901308585627, "episode_reward_min": -1550.1358857234961, "episode_reward_mean": -751.1887724487035, "episode_len_mean": 135.94, "episode_media": {}, "episodes_timesteps_total": 13594, "policy_reward_min": {"policy_0": -1550.1358857234961}, "policy_reward_max": {"policy_0": -19.34901308585627}, "policy_reward_mean": {"policy_0": -751.1887724487035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-85.09623520346528, -1550.1358857234961, -843.0797767003731, -985.1448963800955, -1114.387781601752, -968.2312414971503, -386.71959427789795, -1213.4686247338059, -813.0204972408326, -507.409119863805, -1080.4524287867266, -1257.1902569304489, -1346.2410345311619, -1298.7989984425972, -51.44063869950325, -45.00351005047877, -998.9572724679795, -1036.2777331800673, -778.5667762988769, -788.4610255412671, -1061.4329036787622, -147.25816708083354, -703.0794561825088, -912.8903819847873, -505.3444618031511, -632.5920340067281, -163.33941023267332, -1117.4971657111696, -781.5966142741837, -732.7281484303873, -621.4609269230481, -1161.663670095863, -454.42377309235235, -643.1714352536492, -783.1754921528675, -968.2012272616129, -822.9876702319019, -277.4958198316871, -1299.9409904676497, -712.6437955398235, -943.9466741333154, -1370.6177403118531, -1084.9373244764106, -1045.6736024718132, -436.25678988022014, -1015.8273443553062, -564.3608588881901, -931.2319070872499, -334.81766372148775, -392.07024187858343, -609.7590462397395, -1078.5356079588498, -473.9662992414654, -664.7419584536734, -653.0972491497354, -310.4549371466211, -894.8900743256116, -754.01683912358, -772.6169663792713, -996.33080003192, -1261.3661531906012, -365.92113558913366, -661.6963827060067, -1141.310009382635, -647.4522481977332, -211.91944195812448, -1255.5029827584196, -981.3891146232081, -837.1405931759355, -865.8453217215006, -590.5879550888834, -970.4997208171682, -323.021070721393, -1054.5419577499074, -512.6205141277205, -958.3298700788725, -1327.1527683233596, -527.4659092606813, -580.5673048341374, -496.00133417013745, -1060.9854028866448, -999.2864064856732, -269.7865530179878, -584.3490886825905, -123.00955624860181, -1003.8516938263028, -283.5189773917422, -19.34901308585627, -984.2120679718738, -1241.750321103269, -873.5171740385871, -391.54429021962494, -558.6814950223228, -975.3479436019019, -24.269597357649204, -198.62914370736695, -1038.5860919710462, -428.00121849000914, -985.97937553558, -524.7332481078478], "episode_lengths": [76, 150, 150, 150, 150, 150, 101, 150, 150, 127, 150, 150, 150, 150, 64, 48, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 107, 150, 121, 150, 115, 110, 143, 150, 110, 150, 150, 98, 150, 150, 150, 150, 150, 105, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 131, 150, 124, 150, 150, 127, 131, 150, 150, 150, 90, 150, 98, 150, 122, 50, 150, 150, 150, 150, 150, 150, 43, 89, 150, 134, 150, 150], "policy_policy_0_reward": [-85.09623520346528, -1550.1358857234961, -843.0797767003731, -985.1448963800955, -1114.387781601752, -968.2312414971503, -386.71959427789795, -1213.4686247338059, -813.0204972408326, -507.409119863805, -1080.4524287867266, -1257.1902569304489, -1346.2410345311619, -1298.7989984425972, -51.44063869950325, -45.00351005047877, -998.9572724679795, -1036.2777331800673, -778.5667762988769, -788.4610255412671, -1061.4329036787622, -147.25816708083354, -703.0794561825088, -912.8903819847873, -505.3444618031511, -632.5920340067281, -163.33941023267332, -1117.4971657111696, -781.5966142741837, -732.7281484303873, -621.4609269230481, -1161.663670095863, -454.42377309235235, -643.1714352536492, -783.1754921528675, -968.2012272616129, -822.9876702319019, -277.4958198316871, -1299.9409904676497, -712.6437955398235, -943.9466741333154, -1370.6177403118531, -1084.9373244764106, -1045.6736024718132, -436.25678988022014, -1015.8273443553062, -564.3608588881901, -931.2319070872499, -334.81766372148775, -392.07024187858343, -609.7590462397395, -1078.5356079588498, -473.9662992414654, -664.7419584536734, -653.0972491497354, -310.4549371466211, -894.8900743256116, -754.01683912358, -772.6169663792713, -996.33080003192, -1261.3661531906012, -365.92113558913366, -661.6963827060067, -1141.310009382635, -647.4522481977332, -211.91944195812448, -1255.5029827584196, -981.3891146232081, -837.1405931759355, -865.8453217215006, -590.5879550888834, -970.4997208171682, -323.021070721393, -1054.5419577499074, -512.6205141277205, -958.3298700788725, -1327.1527683233596, -527.4659092606813, -580.5673048341374, -496.00133417013745, -1060.9854028866448, -999.2864064856732, -269.7865530179878, -584.3490886825905, -123.00955624860181, -1003.8516938263028, -283.5189773917422, -19.34901308585627, -984.2120679718738, -1241.750321103269, -873.5171740385871, -391.54429021962494, -558.6814950223228, -975.3479436019019, -24.269597357649204, -198.62914370736695, -1038.5860919710462, -428.00121849000914, -985.97937553558, -524.7332481078478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533271442110824, "mean_inference_ms": 1.6786944761662212, "mean_action_processing_ms": 0.27892539201707245, "mean_env_wait_ms": 3.0589072073019734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012272834777832031, "StateBufferConnector_ms": 0.007955312728881836, "ViewRequirementAgentConnector_ms": 0.19225525856018066}, "num_episodes": 30, "episode_return_max": -19.34901308585627, "episode_return_min": -1550.1358857234961, "episode_return_mean": -751.1887724487035, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.01790684221294, "num_env_steps_trained_throughput_per_sec": 306.01790684221294, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 12955.06, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12954.985, "sample_time_ms": 1063.783, "learn_time_ms": 11821.956, "learn_throughput": 338.353, "synch_weights_time_ms": 68.46}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 27, "trial_id": "39e3f_00000", "date": "2024-08-03_03-47-41", "timestamp": 1722637061, "time_this_iter_s": 13.082539319992065, "time_total_s": 329.174387216568, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d963910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 329.174387216568, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.08421052631579, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.192035937309264, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.911610593895118, "policy_loss": -0.005441560248436872, "vf_loss": 7.909446440140406, "vf_explained_var": 0.9083747188871105, "kl": 0.01693815468624966, "entropy": 1.6452072590589524, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -8.426814544634357, "episode_reward_min": -1440.3368773536554, "episode_reward_mean": -728.8677585228028, "episode_len_mean": 135.42, "episode_media": {}, "episodes_timesteps_total": 13542, "policy_reward_min": {"policy_0": -1440.3368773536554}, "policy_reward_max": {"policy_0": -8.426814544634357}, "policy_reward_mean": {"policy_0": -728.8677585228028}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-643.1714352536492, -783.1754921528675, -968.2012272616129, -822.9876702319019, -277.4958198316871, -1299.9409904676497, -712.6437955398235, -943.9466741333154, -1370.6177403118531, -1084.9373244764106, -1045.6736024718132, -436.25678988022014, -1015.8273443553062, -564.3608588881901, -931.2319070872499, -334.81766372148775, -392.07024187858343, -609.7590462397395, -1078.5356079588498, -473.9662992414654, -664.7419584536734, -653.0972491497354, -310.4549371466211, -894.8900743256116, -754.01683912358, -772.6169663792713, -996.33080003192, -1261.3661531906012, -365.92113558913366, -661.6963827060067, -1141.310009382635, -647.4522481977332, -211.91944195812448, -1255.5029827584196, -981.3891146232081, -837.1405931759355, -865.8453217215006, -590.5879550888834, -970.4997208171682, -323.021070721393, -1054.5419577499074, -512.6205141277205, -958.3298700788725, -1327.1527683233596, -527.4659092606813, -580.5673048341374, -496.00133417013745, -1060.9854028866448, -999.2864064856732, -269.7865530179878, -584.3490886825905, -123.00955624860181, -1003.8516938263028, -283.5189773917422, -19.34901308585627, -984.2120679718738, -1241.750321103269, -873.5171740385871, -391.54429021962494, -558.6814950223228, -975.3479436019019, -24.269597357649204, -198.62914370736695, -1038.5860919710462, -428.00121849000914, -985.97937553558, -524.7332481078478, -103.12618242677384, -504.74432902126716, -704.6101868798282, -1056.3312389008909, -1106.143695404316, -928.5645587900142, -8.426814544634357, -756.3345176692894, -294.3744778209077, -1349.4364681031143, -763.6293883359308, -638.6524138773066, -976.6212116342233, -155.42550954852908, -632.0180528792514, -92.20304199776513, -1087.8517626659473, -753.6533941765057, -244.764902315076, -1139.3368556254945, -715.5084599062346, -1070.7674036811052, -301.48563117863836, -1440.3368773536554, -750.928554862822, -837.3758933102376, -514.8047246953863, -1043.833938558546, -958.9826758874449, -943.8535006672272, -120.52147760465868, -1435.3706804198723, -481.2702283152455], "episode_lengths": [150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 107, 150, 121, 150, 115, 110, 143, 150, 110, 150, 150, 98, 150, 150, 150, 150, 150, 105, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 131, 150, 124, 150, 150, 127, 131, 150, 150, 150, 90, 150, 98, 150, 122, 50, 150, 150, 150, 150, 150, 150, 43, 89, 150, 134, 150, 150, 73, 150, 150, 150, 150, 150, 40, 150, 97, 150, 150, 150, 150, 88, 150, 67, 150, 150, 121, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150], "policy_policy_0_reward": [-643.1714352536492, -783.1754921528675, -968.2012272616129, -822.9876702319019, -277.4958198316871, -1299.9409904676497, -712.6437955398235, -943.9466741333154, -1370.6177403118531, -1084.9373244764106, -1045.6736024718132, -436.25678988022014, -1015.8273443553062, -564.3608588881901, -931.2319070872499, -334.81766372148775, -392.07024187858343, -609.7590462397395, -1078.5356079588498, -473.9662992414654, -664.7419584536734, -653.0972491497354, -310.4549371466211, -894.8900743256116, -754.01683912358, -772.6169663792713, -996.33080003192, -1261.3661531906012, -365.92113558913366, -661.6963827060067, -1141.310009382635, -647.4522481977332, -211.91944195812448, -1255.5029827584196, -981.3891146232081, -837.1405931759355, -865.8453217215006, -590.5879550888834, -970.4997208171682, -323.021070721393, -1054.5419577499074, -512.6205141277205, -958.3298700788725, -1327.1527683233596, -527.4659092606813, -580.5673048341374, -496.00133417013745, -1060.9854028866448, -999.2864064856732, -269.7865530179878, -584.3490886825905, -123.00955624860181, -1003.8516938263028, -283.5189773917422, -19.34901308585627, -984.2120679718738, -1241.750321103269, -873.5171740385871, -391.54429021962494, -558.6814950223228, -975.3479436019019, -24.269597357649204, -198.62914370736695, -1038.5860919710462, -428.00121849000914, -985.97937553558, -524.7332481078478, -103.12618242677384, -504.74432902126716, -704.6101868798282, -1056.3312389008909, -1106.143695404316, -928.5645587900142, -8.426814544634357, -756.3345176692894, -294.3744778209077, -1349.4364681031143, -763.6293883359308, -638.6524138773066, -976.6212116342233, -155.42550954852908, -632.0180528792514, -92.20304199776513, -1087.8517626659473, -753.6533941765057, -244.764902315076, -1139.3368556254945, -715.5084599062346, -1070.7674036811052, -301.48563117863836, -1440.3368773536554, -750.928554862822, -837.3758933102376, -514.8047246953863, -1043.833938558546, -958.9826758874449, -943.8535006672272, -120.52147760465868, -1435.3706804198723, -481.2702283152455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532927120480623, "mean_inference_ms": 1.6775833623648133, "mean_action_processing_ms": 0.27862777752234735, "mean_env_wait_ms": 3.058731956611327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012235879898071289, "StateBufferConnector_ms": 0.007832765579223633, "ViewRequirementAgentConnector_ms": 0.1893296241760254}, "num_episodes": 33, "episode_return_max": -8.426814544634357, "episode_return_min": -1440.3368773536554, "episode_return_mean": -728.8677585228028, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.97850711334075, "num_env_steps_trained_throughput_per_sec": 298.97850711334075, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 12979.84, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12979.766, "sample_time_ms": 1068.822, "learn_time_ms": 11842.321, "learn_throughput": 337.772, "synch_weights_time_ms": 67.842}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 28, "trial_id": "39e3f_00000", "date": "2024-08-03_03-47-54", "timestamp": 1722637074, "time_this_iter_s": 13.39122486114502, "time_total_s": 342.565612077713, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d812950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 342.565612077713, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 16.97894736842105, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 61.534882643818854, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.538592845201492, "policy_loss": -0.009138991397533876, "vf_loss": 7.539250761767229, "vf_explained_var": 0.8993280284727613, "kl": 0.018875338204846562, "entropy": 1.2825845601037145, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "env_runners": {"episode_reward_max": -8.426814544634357, "episode_reward_min": -1440.3368773536554, "episode_reward_mean": -702.2276639644333, "episode_len_mean": 131.83, "episode_media": {}, "episodes_timesteps_total": 13183, "policy_reward_min": {"policy_0": -1440.3368773536554}, "policy_reward_max": {"policy_0": -8.426814544634357}, "policy_reward_mean": {"policy_0": -702.2276639644333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-661.6963827060067, -1141.310009382635, -647.4522481977332, -211.91944195812448, -1255.5029827584196, -981.3891146232081, -837.1405931759355, -865.8453217215006, -590.5879550888834, -970.4997208171682, -323.021070721393, -1054.5419577499074, -512.6205141277205, -958.3298700788725, -1327.1527683233596, -527.4659092606813, -580.5673048341374, -496.00133417013745, -1060.9854028866448, -999.2864064856732, -269.7865530179878, -584.3490886825905, -123.00955624860181, -1003.8516938263028, -283.5189773917422, -19.34901308585627, -984.2120679718738, -1241.750321103269, -873.5171740385871, -391.54429021962494, -558.6814950223228, -975.3479436019019, -24.269597357649204, -198.62914370736695, -1038.5860919710462, -428.00121849000914, -985.97937553558, -524.7332481078478, -103.12618242677384, -504.74432902126716, -704.6101868798282, -1056.3312389008909, -1106.143695404316, -928.5645587900142, -8.426814544634357, -756.3345176692894, -294.3744778209077, -1349.4364681031143, -763.6293883359308, -638.6524138773066, -976.6212116342233, -155.42550954852908, -632.0180528792514, -92.20304199776513, -1087.8517626659473, -753.6533941765057, -244.764902315076, -1139.3368556254945, -715.5084599062346, -1070.7674036811052, -301.48563117863836, -1440.3368773536554, -750.928554862822, -837.3758933102376, -514.8047246953863, -1043.833938558546, -958.9826758874449, -943.8535006672272, -120.52147760465868, -1435.3706804198723, -481.2702283152455, -1073.74522353966, -760.5608512094177, -82.17342769516023, -125.9317198798679, -572.0262870680039, -1039.8347947380244, -1074.681926325543, -998.0607493892602, -906.2784357043629, -1090.8033429105594, -186.51364064788493, -231.30709328363514, -546.4726169507471, -1249.1225719242077, -835.0114278431149, -860.5946164613803, -215.43617154051148, -418.66487435772376, -884.48808898189, -267.1668296586761, -771.4488722933718, -1275.9528900414803, -513.6385762150952, -1138.7628635736996, -753.0514871815085, -1396.9631661831968, -174.36394071445244, -263.5985282188236, -92.38917440562989], "episode_lengths": [150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 131, 150, 124, 150, 150, 127, 131, 150, 150, 150, 90, 150, 98, 150, 122, 50, 150, 150, 150, 150, 150, 150, 43, 89, 150, 134, 150, 150, 73, 150, 150, 150, 150, 150, 40, 150, 97, 150, 150, 150, 150, 88, 150, 67, 150, 150, 121, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 44, 54, 137, 150, 150, 150, 150, 150, 79, 124, 150, 150, 150, 150, 70, 118, 150, 92, 150, 150, 118, 150, 150, 150, 99, 85, 85], "policy_policy_0_reward": [-661.6963827060067, -1141.310009382635, -647.4522481977332, -211.91944195812448, -1255.5029827584196, -981.3891146232081, -837.1405931759355, -865.8453217215006, -590.5879550888834, -970.4997208171682, -323.021070721393, -1054.5419577499074, -512.6205141277205, -958.3298700788725, -1327.1527683233596, -527.4659092606813, -580.5673048341374, -496.00133417013745, -1060.9854028866448, -999.2864064856732, -269.7865530179878, -584.3490886825905, -123.00955624860181, -1003.8516938263028, -283.5189773917422, -19.34901308585627, -984.2120679718738, -1241.750321103269, -873.5171740385871, -391.54429021962494, -558.6814950223228, -975.3479436019019, -24.269597357649204, -198.62914370736695, -1038.5860919710462, -428.00121849000914, -985.97937553558, -524.7332481078478, -103.12618242677384, -504.74432902126716, -704.6101868798282, -1056.3312389008909, -1106.143695404316, -928.5645587900142, -8.426814544634357, -756.3345176692894, -294.3744778209077, -1349.4364681031143, -763.6293883359308, -638.6524138773066, -976.6212116342233, -155.42550954852908, -632.0180528792514, -92.20304199776513, -1087.8517626659473, -753.6533941765057, -244.764902315076, -1139.3368556254945, -715.5084599062346, -1070.7674036811052, -301.48563117863836, -1440.3368773536554, -750.928554862822, -837.3758933102376, -514.8047246953863, -1043.833938558546, -958.9826758874449, -943.8535006672272, -120.52147760465868, -1435.3706804198723, -481.2702283152455, -1073.74522353966, -760.5608512094177, -82.17342769516023, -125.9317198798679, -572.0262870680039, -1039.8347947380244, -1074.681926325543, -998.0607493892602, -906.2784357043629, -1090.8033429105594, -186.51364064788493, -231.30709328363514, -546.4726169507471, -1249.1225719242077, -835.0114278431149, -860.5946164613803, -215.43617154051148, -418.66487435772376, -884.48808898189, -267.1668296586761, -771.4488722933718, -1275.9528900414803, -513.6385762150952, -1138.7628635736996, -753.0514871815085, -1396.9631661831968, -174.36394071445244, -263.5985282188236, -92.38917440562989]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531520201699494, "mean_inference_ms": 1.6773263841891402, "mean_action_processing_ms": 0.27824283593612104, "mean_env_wait_ms": 3.0599559756255585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0120391845703125, "StateBufferConnector_ms": 0.007706642150878906, "ViewRequirementAgentConnector_ms": 0.18842697143554688}, "num_episodes": 29, "episode_return_max": -8.426814544634357, "episode_return_min": -1440.3368773536554, "episode_return_mean": -702.2276639644333, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.4160998902284, "num_env_steps_trained_throughput_per_sec": 312.4160998902284, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 13135.773, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13135.697, "sample_time_ms": 1068.214, "learn_time_ms": 12000.332, "learn_throughput": 333.324, "synch_weights_time_ms": 66.373}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "training_iteration": 29, "trial_id": "39e3f_00000", "date": "2024-08-03_03-48-07", "timestamp": 1722637087, "time_this_iter_s": 12.815733671188354, "time_total_s": 355.38134574890137, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d4a1990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 355.38134574890137, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 17.383333333333333, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 71.78915871083737, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.4518727545936905, "policy_loss": 0.0008858983002331418, "vf_loss": 7.443022686243057, "vf_explained_var": 0.9028012381866575, "kl": 0.01772449785360853, "entropy": 1.1868744988615314, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": -8.426814544634357, "episode_reward_min": -1440.3368773536554, "episode_reward_mean": -662.064087899034, "episode_len_mean": 128.42, "episode_media": {}, "episodes_timesteps_total": 12842, "policy_reward_min": {"policy_0": -1440.3368773536554}, "policy_reward_max": {"policy_0": -8.426814544634357}, "policy_reward_mean": {"policy_0": -662.064087899034}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-558.6814950223228, -975.3479436019019, -24.269597357649204, -198.62914370736695, -1038.5860919710462, -428.00121849000914, -985.97937553558, -524.7332481078478, -103.12618242677384, -504.74432902126716, -704.6101868798282, -1056.3312389008909, -1106.143695404316, -928.5645587900142, -8.426814544634357, -756.3345176692894, -294.3744778209077, -1349.4364681031143, -763.6293883359308, -638.6524138773066, -976.6212116342233, -155.42550954852908, -632.0180528792514, -92.20304199776513, -1087.8517626659473, -753.6533941765057, -244.764902315076, -1139.3368556254945, -715.5084599062346, -1070.7674036811052, -301.48563117863836, -1440.3368773536554, -750.928554862822, -837.3758933102376, -514.8047246953863, -1043.833938558546, -958.9826758874449, -943.8535006672272, -120.52147760465868, -1435.3706804198723, -481.2702283152455, -1073.74522353966, -760.5608512094177, -82.17342769516023, -125.9317198798679, -572.0262870680039, -1039.8347947380244, -1074.681926325543, -998.0607493892602, -906.2784357043629, -1090.8033429105594, -186.51364064788493, -231.30709328363514, -546.4726169507471, -1249.1225719242077, -835.0114278431149, -860.5946164613803, -215.43617154051148, -418.66487435772376, -884.48808898189, -267.1668296586761, -771.4488722933718, -1275.9528900414803, -513.6385762150952, -1138.7628635736996, -753.0514871815085, -1396.9631661831968, -174.36394071445244, -263.5985282188236, -92.38917440562989, -639.1934892417396, -871.6085610753485, -904.844429219145, -870.0888790584187, -905.5918432298294, -1240.1893338450886, -543.8178611146951, -576.2947450155683, -430.89714726029206, -81.84674839050314, -832.2111968910111, -27.41260120789103, -47.40393285497463, -368.443309070495, -339.2925786455446, -413.85062727613087, -601.1944625331708, -460.62727823538347, -324.21248670097003, -624.884500298714, -55.15134497096704, -1075.3992686346899, -1427.3665323741989, -1040.0268688599572, -561.0029587152117, -674.8193109757723, -804.4608465006129, -440.4949296984379, -96.15343665578673, -483.06592956410725], "episode_lengths": [150, 150, 43, 89, 150, 134, 150, 150, 73, 150, 150, 150, 150, 150, 40, 150, 97, 150, 150, 150, 150, 88, 150, 67, 150, 150, 121, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 44, 54, 137, 150, 150, 150, 150, 150, 79, 124, 150, 150, 150, 150, 70, 118, 150, 92, 150, 150, 118, 150, 150, 150, 99, 85, 85, 150, 150, 150, 150, 150, 150, 120, 150, 150, 85, 150, 54, 79, 96, 93, 102, 150, 150, 95, 150, 51, 150, 150, 150, 134, 150, 150, 112, 58, 150], "policy_policy_0_reward": [-558.6814950223228, -975.3479436019019, -24.269597357649204, -198.62914370736695, -1038.5860919710462, -428.00121849000914, -985.97937553558, -524.7332481078478, -103.12618242677384, -504.74432902126716, -704.6101868798282, -1056.3312389008909, -1106.143695404316, -928.5645587900142, -8.426814544634357, -756.3345176692894, -294.3744778209077, -1349.4364681031143, -763.6293883359308, -638.6524138773066, -976.6212116342233, -155.42550954852908, -632.0180528792514, -92.20304199776513, -1087.8517626659473, -753.6533941765057, -244.764902315076, -1139.3368556254945, -715.5084599062346, -1070.7674036811052, -301.48563117863836, -1440.3368773536554, -750.928554862822, -837.3758933102376, -514.8047246953863, -1043.833938558546, -958.9826758874449, -943.8535006672272, -120.52147760465868, -1435.3706804198723, -481.2702283152455, -1073.74522353966, -760.5608512094177, -82.17342769516023, -125.9317198798679, -572.0262870680039, -1039.8347947380244, -1074.681926325543, -998.0607493892602, -906.2784357043629, -1090.8033429105594, -186.51364064788493, -231.30709328363514, -546.4726169507471, -1249.1225719242077, -835.0114278431149, -860.5946164613803, -215.43617154051148, -418.66487435772376, -884.48808898189, -267.1668296586761, -771.4488722933718, -1275.9528900414803, -513.6385762150952, -1138.7628635736996, -753.0514871815085, -1396.9631661831968, -174.36394071445244, -263.5985282188236, -92.38917440562989, -639.1934892417396, -871.6085610753485, -904.844429219145, -870.0888790584187, -905.5918432298294, -1240.1893338450886, -543.8178611146951, -576.2947450155683, -430.89714726029206, -81.84674839050314, -832.2111968910111, -27.41260120789103, -47.40393285497463, -368.443309070495, -339.2925786455446, -413.85062727613087, -601.1944625331708, -460.62727823538347, -324.21248670097003, -624.884500298714, -55.15134497096704, -1075.3992686346899, -1427.3665323741989, -1040.0268688599572, -561.0029587152117, -674.8193109757723, -804.4608465006129, -440.4949296984379, -96.15343665578673, -483.06592956410725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531184066928604, "mean_inference_ms": 1.6782975157872024, "mean_action_processing_ms": 0.27821473214574555, "mean_env_wait_ms": 3.0631666423624186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011957168579101562, "StateBufferConnector_ms": 0.00786137580871582, "ViewRequirementAgentConnector_ms": 0.1886768341064453}, "num_episodes": 30, "episode_return_max": -8.426814544634357, "episode_return_min": -1440.3368773536554, "episode_return_mean": -662.064087899034, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.0911040425545, "num_env_steps_trained_throughput_per_sec": 309.0911040425545, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 13106.963, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13106.89, "sample_time_ms": 1063.63, "learn_time_ms": 11977.293, "learn_throughput": 333.965, "synch_weights_time_ms": 65.195}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 30, "trial_id": "39e3f_00000", "date": "2024-08-03_03-48-20", "timestamp": 1722637100, "time_this_iter_s": 12.953582763671875, "time_total_s": 368.33492851257324, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d9636d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 368.33492851257324, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.27777777777778, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 68.56077474355698, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.505709325770537, "policy_loss": -0.006441272254839229, "vf_loss": 7.504133934279283, "vf_explained_var": 0.9197694063807528, "kl": 0.017853925056442677, "entropy": 1.7596862162152926, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "env_runners": {"episode_reward_max": -7.346282260130021, "episode_reward_min": -1565.0703826054366, "episode_reward_mean": -677.3708980066007, "episode_len_mean": 128.3, "episode_media": {}, "episodes_timesteps_total": 12830, "policy_reward_min": {"policy_0": -1565.0703826054366}, "policy_reward_max": {"policy_0": -7.346282260130021}, "policy_reward_mean": {"policy_0": -677.3708980066007}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1440.3368773536554, -750.928554862822, -837.3758933102376, -514.8047246953863, -1043.833938558546, -958.9826758874449, -943.8535006672272, -120.52147760465868, -1435.3706804198723, -481.2702283152455, -1073.74522353966, -760.5608512094177, -82.17342769516023, -125.9317198798679, -572.0262870680039, -1039.8347947380244, -1074.681926325543, -998.0607493892602, -906.2784357043629, -1090.8033429105594, -186.51364064788493, -231.30709328363514, -546.4726169507471, -1249.1225719242077, -835.0114278431149, -860.5946164613803, -215.43617154051148, -418.66487435772376, -884.48808898189, -267.1668296586761, -771.4488722933718, -1275.9528900414803, -513.6385762150952, -1138.7628635736996, -753.0514871815085, -1396.9631661831968, -174.36394071445244, -263.5985282188236, -92.38917440562989, -639.1934892417396, -871.6085610753485, -904.844429219145, -870.0888790584187, -905.5918432298294, -1240.1893338450886, -543.8178611146951, -576.2947450155683, -430.89714726029206, -81.84674839050314, -832.2111968910111, -27.41260120789103, -47.40393285497463, -368.443309070495, -339.2925786455446, -413.85062727613087, -601.1944625331708, -460.62727823538347, -324.21248670097003, -624.884500298714, -55.15134497096704, -1075.3992686346899, -1427.3665323741989, -1040.0268688599572, -561.0029587152117, -674.8193109757723, -804.4608465006129, -440.4949296984379, -96.15343665578673, -483.06592956410725, -1154.688591698701, -784.1858000025906, -200.08011756247762, -213.00164978071143, -9.306855976088812, -850.7694394247757, -1565.0703826054366, -580.7659605705039, -215.81663882972106, -1353.0985899682955, -939.197163588676, -785.94232227745, -849.8356024478311, -1004.9563357513574, -320.8610471007187, -124.0034931971111, -414.1048043494889, -210.26102193839998, -262.5106283251114, -1037.550423389765, -972.8957065964086, -818.4844155224899, -753.55647034662, -901.6356841837949, -657.207342952448, -7.346282260130021, -988.703373402911, -1108.420715639694, -868.6441363121222, -1028.7169601461992, -667.3016657854001], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 44, 54, 137, 150, 150, 150, 150, 150, 79, 124, 150, 150, 150, 150, 70, 118, 150, 92, 150, 150, 118, 150, 150, 150, 99, 85, 85, 150, 150, 150, 150, 150, 150, 120, 150, 150, 85, 150, 54, 79, 96, 93, 102, 150, 150, 95, 150, 51, 150, 150, 150, 134, 150, 150, 112, 58, 150, 150, 150, 87, 97, 49, 150, 150, 150, 89, 150, 150, 150, 150, 150, 110, 65, 112, 68, 96, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1440.3368773536554, -750.928554862822, -837.3758933102376, -514.8047246953863, -1043.833938558546, -958.9826758874449, -943.8535006672272, -120.52147760465868, -1435.3706804198723, -481.2702283152455, -1073.74522353966, -760.5608512094177, -82.17342769516023, -125.9317198798679, -572.0262870680039, -1039.8347947380244, -1074.681926325543, -998.0607493892602, -906.2784357043629, -1090.8033429105594, -186.51364064788493, -231.30709328363514, -546.4726169507471, -1249.1225719242077, -835.0114278431149, -860.5946164613803, -215.43617154051148, -418.66487435772376, -884.48808898189, -267.1668296586761, -771.4488722933718, -1275.9528900414803, -513.6385762150952, -1138.7628635736996, -753.0514871815085, -1396.9631661831968, -174.36394071445244, -263.5985282188236, -92.38917440562989, -639.1934892417396, -871.6085610753485, -904.844429219145, -870.0888790584187, -905.5918432298294, -1240.1893338450886, -543.8178611146951, -576.2947450155683, -430.89714726029206, -81.84674839050314, -832.2111968910111, -27.41260120789103, -47.40393285497463, -368.443309070495, -339.2925786455446, -413.85062727613087, -601.1944625331708, -460.62727823538347, -324.21248670097003, -624.884500298714, -55.15134497096704, -1075.3992686346899, -1427.3665323741989, -1040.0268688599572, -561.0029587152117, -674.8193109757723, -804.4608465006129, -440.4949296984379, -96.15343665578673, -483.06592956410725, -1154.688591698701, -784.1858000025906, -200.08011756247762, -213.00164978071143, -9.306855976088812, -850.7694394247757, -1565.0703826054366, -580.7659605705039, -215.81663882972106, -1353.0985899682955, -939.197163588676, -785.94232227745, -849.8356024478311, -1004.9563357513574, -320.8610471007187, -124.0034931971111, -414.1048043494889, -210.26102193839998, -262.5106283251114, -1037.550423389765, -972.8957065964086, -818.4844155224899, -753.55647034662, -901.6356841837949, -657.207342952448, -7.346282260130021, -988.703373402911, -1108.420715639694, -868.6441363121222, -1028.7169601461992, -667.3016657854001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539153375659422, "mean_inference_ms": 1.6884545642809163, "mean_action_processing_ms": 0.27790052828750506, "mean_env_wait_ms": 3.0605812076798706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011977672576904297, "StateBufferConnector_ms": 0.007933378219604492, "ViewRequirementAgentConnector_ms": 0.19246411323547363}, "num_episodes": 31, "episode_return_max": -7.346282260130021, "episode_return_min": -1565.0703826054366, "episode_return_mean": -677.3708980066007, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.3650210137664, "num_env_steps_trained_throughput_per_sec": 290.3650210137664, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 13184.529, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13184.456, "sample_time_ms": 1096.948, "learn_time_ms": 12019.944, "learn_throughput": 332.78, "synch_weights_time_ms": 66.785}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "training_iteration": 31, "trial_id": "39e3f_00000", "date": "2024-08-03_03-48-34", "timestamp": 1722637114, "time_this_iter_s": 13.789936304092407, "time_total_s": 382.12486481666565, "pid": 451301, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.98, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73190d963a30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9259142179874106, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 382.12486481666565, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 18.225, "ram_util_percent": 27.7}}
