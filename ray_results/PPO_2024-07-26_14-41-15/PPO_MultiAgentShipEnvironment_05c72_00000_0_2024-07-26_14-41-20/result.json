{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.786761777666776, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.001, "total_loss": 8.840680578270474, "policy_loss": -0.0005083666377079984, "vf_loss": 8.854600860943666, "vf_explained_var": 0.1952935625706707, "kl": 0.004336858063290312, "entropy": 1.4279279034953933, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.62162162162163, "num_grad_updates_lifetime": 2220.5, "diff_num_grad_updates_vs_sampler_policy": 2219.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 18888, "num_agent_steps_trained": 18888}, "env_runners": {"episode_reward_max": -2798.8408573795687, "episode_reward_min": -4656.014638372261, "episode_reward_mean": -3838.6746772022307, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 3000, "policy_reward_min": {"policy_0": -1301.41707543262}, "policy_reward_max": {"policy_0": -61.27461805064071}, "policy_reward_mean": {"policy_0": -767.7349354404457}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3254.4748245322758, -4498.651107279361, -3960.1609243664525, -4066.0993663587747, -3708.1750311898063, -3126.0283994914616, -4555.651977337898, -4489.21155257836, -3401.8165426554233, -3455.6515792166597, -4015.879749995769, -3331.430765325376, -4622.569467589365, -4320.936509907978, -3134.1081896576857, -4656.014638372261, -3860.957992223862, -2798.8408573795687, -4203.907984995677, -3312.926083590584], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-562.3008432494819, -964.044738885273, -727.9181634263554, -609.5275568063192, -390.6835221648477, -783.0230577510397, -1111.7357864212406, -575.9439615790916, -1301.41707543262, -726.531226095368, -924.5192324858001, -984.9551753627682, -370.6884025641759, -1113.6569964373145, -566.3411175163915, -1042.1989076642612, -262.4336835680502, -995.4240423606605, -1174.807223394556, -591.2355093712462, -919.8941166879279, -1056.7814782588823, -945.1941693982262, -83.6908979993792, -702.614368845388, -723.1897572491129, -215.16772263871218, -1138.457188538006, -114.49777623799791, -934.7159548276293, -710.3104928416471, -897.8667373950063, -901.5118221826855, -1199.0641768889498, -846.8987480296128, -1185.5637817436007, -822.7838778875675, -959.551725446479, -781.879825551242, -739.432341949473, -231.48341193833693, -288.2456328964043, -1031.6738785935277, -1034.9311644414486, -815.4824547857064, -569.592852102508, -84.10861414149721, -897.9958217402265, -1188.2388434243987, -715.7154478080304, -667.1032922863862, -1118.0508679229993, -285.0022835750982, -1080.2611588290172, -865.4621473822712, -118.60086103108294, -1159.4057176167084, -714.3292687133205, -833.7964012081401, -505.2985167561209, -514.4528006458655, -1059.263934936012, -998.5163074302893, -1143.1504996852902, -907.1859248919075, -705.6672670531307, -1122.2379004326265, -1114.2398595078137, -797.0768151372929, -581.7146677771084, -557.4656841450271, -991.2317728513073, -1151.5851518222698, -204.49240697008386, -229.3331738689984, -964.6374064349328, -1044.6735922955013, -767.6824755695515, -1205.8731430013916, -673.14802107088, -1121.761827877676, -978.6025515450102, -879.8219854466155, -819.4970093039201, -61.27461805064071, -164.30374058417408, -362.0607469270141, -1132.5408474788455, -234.68948603668744, -905.2460363528439, -1008.3900884914406, -942.8327922059293, -384.6354491599059, -980.2585794514775, -887.7910756869204, -482.55121207888965, -865.0036373837706, -691.5719713170753, -931.938908209675, -341.86035460117347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.747311229136453, "mean_inference_ms": 1.8285252561616658, "mean_action_processing_ms": 0.8878625447477274, "mean_env_wait_ms": 11.394517516615378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01854419708251953, "StateBufferConnector_ms": 0.01582503318786621, "ViewRequirementAgentConnector_ms": 0.5244338512420654}, "num_episodes": 20, "episode_return_max": -2798.8408573795687, "episode_return_min": -4656.014638372261, "episode_return_mean": -3838.6746772022307, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18888, "num_agent_steps_trained": 18888, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 115.39614977177794, "num_env_steps_trained_throughput_per_sec": 115.39614977177794, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 18888, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 18888, "timers": {"training_iteration_time_ms": 34663.212, "restore_workers_time_ms": 0.027, "training_step_time_ms": 34663.145, "sample_time_ms": 3585.667, "learn_time_ms": 31035.818, "learn_throughput": 128.883, "synch_weights_time_ms": 38.817}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 18888, "num_agent_steps_trained": 18888}, "done": false, "training_iteration": 1, "trial_id": "05c72_00000", "date": "2024-07-26_14-43-32", "timestamp": 1721985212, "time_this_iter_s": 34.67242980003357, "time_total_s": 34.67242980003357, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d3c3b29630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 34.67242980003357, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.886000000000003, "ram_util_percent": 32.792}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 78.67839212643501, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.0010000000000000002, "total_loss": 6.682467798990746, "policy_loss": -0.002058196251204059, "vf_loss": 6.6978795949182555, "vf_explained_var": 0.8361533164841943, "kl": 0.010802167306319794, "entropy": 1.4433821059253118, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.15753424657534, "num_grad_updates_lifetime": 6630.5, "diff_num_grad_updates_vs_sampler_policy": 2189.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 37453, "num_agent_steps_trained": 37453}, "env_runners": {"episode_reward_max": -2331.379017367973, "episode_reward_min": -4656.014638372261, "episode_reward_mean": -3694.3421372115054, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 6000, "policy_reward_min": {"policy_0": -1301.41707543262}, "policy_reward_max": {"policy_0": -30.22946640729348}, "policy_reward_mean": {"policy_0": -738.8684274423009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3254.4748245322758, -4498.651107279361, -3960.1609243664525, -4066.0993663587747, -3708.1750311898063, -3126.0283994914616, -4555.651977337898, -4489.21155257836, -3401.8165426554233, -3455.6515792166597, -4015.879749995769, -3331.430765325376, -4622.569467589365, -4320.936509907978, -3134.1081896576857, -4656.014638372261, -3860.957992223862, -2798.8408573795687, -4203.907984995677, -3312.926083590584, -3794.743245962256, -2859.632617428003, -4242.213261315405, -3706.5926579811294, -3675.9226643926045, -3692.4284196927993, -3674.274519152444, -2753.7978872901126, -4020.661985811614, -3446.7533710797757, -2937.8344368444123, -3822.8957606906565, -3419.4346887201773, -2331.379017367973, -4444.507678305128, -3679.5972046475536, -3600.332323002007, -4654.851866360345, -3420.354668800449, -2821.983669570764], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-562.3008432494819, -964.044738885273, -727.9181634263554, -609.5275568063192, -390.6835221648477, -783.0230577510397, -1111.7357864212406, -575.9439615790916, -1301.41707543262, -726.531226095368, -924.5192324858001, -984.9551753627682, -370.6884025641759, -1113.6569964373145, -566.3411175163915, -1042.1989076642612, -262.4336835680502, -995.4240423606605, -1174.807223394556, -591.2355093712462, -919.8941166879279, -1056.7814782588823, -945.1941693982262, -83.6908979993792, -702.614368845388, -723.1897572491129, -215.16772263871218, -1138.457188538006, -114.49777623799791, -934.7159548276293, -710.3104928416471, -897.8667373950063, -901.5118221826855, -1199.0641768889498, -846.8987480296128, -1185.5637817436007, -822.7838778875675, -959.551725446479, -781.879825551242, -739.432341949473, -231.48341193833693, -288.2456328964043, -1031.6738785935277, -1034.9311644414486, -815.4824547857064, -569.592852102508, -84.10861414149721, -897.9958217402265, -1188.2388434243987, -715.7154478080304, -667.1032922863862, -1118.0508679229993, -285.0022835750982, -1080.2611588290172, -865.4621473822712, -118.60086103108294, -1159.4057176167084, -714.3292687133205, -833.7964012081401, -505.2985167561209, -514.4528006458655, -1059.263934936012, -998.5163074302893, -1143.1504996852902, -907.1859248919075, -705.6672670531307, -1122.2379004326265, -1114.2398595078137, -797.0768151372929, -581.7146677771084, -557.4656841450271, -991.2317728513073, -1151.5851518222698, -204.49240697008386, -229.3331738689984, -964.6374064349328, -1044.6735922955013, -767.6824755695515, -1205.8731430013916, -673.14802107088, -1121.761827877676, -978.6025515450102, -879.8219854466155, -819.4970093039201, -61.27461805064071, -164.30374058417408, -362.0607469270141, -1132.5408474788455, -234.68948603668744, -905.2460363528439, -1008.3900884914406, -942.8327922059293, -384.6354491599059, -980.2585794514775, -887.7910756869204, -482.55121207888965, -865.0036373837706, -691.5719713170753, -931.938908209675, -341.86035460117347, -895.5342479559961, -586.3763739162728, -930.4652060501461, -1085.7338729238709, -296.63354511596674, -690.4292239811427, -596.1640637520325, -451.66943144651236, -429.30518497930353, -692.0647132690133, -1260.1974135529556, -129.93938580941025, -1008.4321048755593, -1178.6423021349858, -665.002054942491, -620.81601174053, -971.4349698704613, -585.3901402134603, -683.7575059989886, -845.1940301576916, -869.6407270574481, -795.4014661195718, -922.206239622404, -234.38486365163615, -854.2893679415457, -133.11212495727455, -1049.1762402994746, -1075.706770068621, -447.18950576096256, -987.2437786064665, -862.4307103042938, -573.7916195313126, -700.5819645097415, -496.460742287508, -1041.0094825195881, -1068.4289299393529, -265.25338641395587, -37.79643888110528, -697.0629949000136, -685.2561371556848, -943.7899480541498, -922.4909138255241, -971.0182795264409, -1153.1333779982015, -30.22946640729348, -785.8161780107657, -846.383371565024, -881.046763249836, -856.0689436873882, -77.43811456676004, -1047.970440090734, -47.504291933643735, -39.14131588897237, -913.0242892952207, -890.1940996358436, -1173.3460374250358, -1121.1240448112526, -50.86972883324663, -315.7701142339373, -1161.7858353871825, -881.0099019802996, -935.0973289176908, -526.3342764754651, -446.07260981834, -630.9205715283797, -653.7505494829197, -539.79848061499, -559.2196397094968, -475.93700372788953, -102.67334383267956, -938.7041597222017, -1029.764410879461, -1121.2832761521859, -967.8023026316954, -386.9535289195838, -894.7733004761161, -738.9176184034027, -725.3209960062896, -752.202036460586, -568.3832533011669, -812.8450618713072, -819.2143802752623, -930.4024373349545, -436.8743957885877, -600.9960477318971, -1135.7303716669599, -700.315636581709, -1185.6798088593232, -998.127699685008, -634.9983495673434, -219.6799849262109, -749.3782415820815, -934.6107252054837, -888.748746921281, -627.936970165389, -448.7389531013134, -428.41643355494386, -668.2095413772116, -736.6933846626729, -539.925356874623]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.724831405578524, "mean_inference_ms": 1.8128670240590044, "mean_action_processing_ms": 0.8873667308449195, "mean_env_wait_ms": 11.309141226719143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019187331199645996, "StateBufferConnector_ms": 0.01466989517211914, "ViewRequirementAgentConnector_ms": 0.522913932800293}, "num_episodes": 20, "episode_return_max": -2331.379017367973, "episode_return_min": -4656.014638372261, "episode_return_mean": -3694.3421372115054, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37453, "num_agent_steps_trained": 37453, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.44341759072536, "num_env_steps_trained_throughput_per_sec": 71.44341759072536, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 37453, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 37453, "timers": {"training_iteration_time_ms": 45325.793, "restore_workers_time_ms": 0.025, "training_step_time_ms": 45325.727, "sample_time_ms": 3530.434, "learn_time_ms": 41743.384, "learn_throughput": 95.824, "synch_weights_time_ms": 48.746}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 37453, "num_agent_steps_trained": 37453}, "done": false, "training_iteration": 2, "trial_id": "05c72_00000", "date": "2024-07-26_14-44-28", "timestamp": 1721985268, "time_this_iter_s": 55.99874305725098, "time_total_s": 90.67117285728455, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d280528e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 90.67117285728455, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.150632911392403, "ram_util_percent": 32.82531645569622}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 105.52979433072937, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.001, "total_loss": 6.311110381947623, "policy_loss": -0.0012423208480733458, "vf_loss": 6.325635928688226, "vf_explained_var": 0.9467957039812097, "kl": 0.011791367557695292, "entropy": 1.4462365082292645, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.49305555555556, "num_grad_updates_lifetime": 10980.5, "diff_num_grad_updates_vs_sampler_policy": 2159.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 55812, "num_agent_steps_trained": 55812}, "env_runners": {"episode_reward_max": -1801.4669351579291, "episode_reward_min": -4656.014638372261, "episode_reward_mean": -3507.101589407056, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 12000, "policy_reward_min": {"policy_0": -1301.41707543262}, "policy_reward_max": {"policy_0": -10.712307924410862}, "policy_reward_mean": {"policy_0": -701.4203178814112}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3254.4748245322758, -4498.651107279361, -3960.1609243664525, -4066.0993663587747, -3708.1750311898063, -3126.0283994914616, -4555.651977337898, -4489.21155257836, -3401.8165426554233, -3455.6515792166597, -4015.879749995769, -3331.430765325376, -4622.569467589365, -4320.936509907978, -3134.1081896576857, -4656.014638372261, -3860.957992223862, -2798.8408573795687, -4203.907984995677, -3312.926083590584, -3794.743245962256, -2859.632617428003, -4242.213261315405, -3706.5926579811294, -3675.9226643926045, -3692.4284196927993, -3674.274519152444, -2753.7978872901126, -4020.661985811614, -3446.7533710797757, -2937.8344368444123, -3822.8957606906565, -3419.4346887201773, -2331.379017367973, -4444.507678305128, -3679.5972046475536, -3600.332323002007, -4654.851866360345, -3420.354668800449, -2821.983669570764, -2989.009691014752, -3932.0793692704283, -3734.3958097538716, -2436.066535993926, -3684.979185910415, -2641.7141051325953, -2939.561467003024, -2552.0629147255513, -3637.073491309488, -2829.439770767549, -3820.8399624522167, -2238.7950022187515, -2627.3861093918913, -3144.067933856129, -4540.80442720475, -2681.7953467736083, -3473.2581256761687, -2555.7720055666305, -3278.7767299645616, -3688.765202841058, -3444.97759756242, -3088.0164143377424, -1801.4669351579291, -3801.685786493232, -4278.17884425774, -3930.89025162019, -3021.849239985826, -4148.996009122738, -4008.1620650856335, -3758.482183807932, -3158.6406513637917, -3186.5208184630474, -3124.5950092247654, -2228.827135077238, -3419.84765582216, -3363.44793102633, -4084.84115903057, -4042.6538379085887, -3577.923652284576, -3897.795299644494], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-562.3008432494819, -964.044738885273, -727.9181634263554, -609.5275568063192, -390.6835221648477, -783.0230577510397, -1111.7357864212406, -575.9439615790916, -1301.41707543262, -726.531226095368, -924.5192324858001, -984.9551753627682, -370.6884025641759, -1113.6569964373145, -566.3411175163915, -1042.1989076642612, -262.4336835680502, -995.4240423606605, -1174.807223394556, -591.2355093712462, -919.8941166879279, -1056.7814782588823, -945.1941693982262, -83.6908979993792, -702.614368845388, -723.1897572491129, -215.16772263871218, -1138.457188538006, -114.49777623799791, -934.7159548276293, -710.3104928416471, -897.8667373950063, -901.5118221826855, -1199.0641768889498, -846.8987480296128, -1185.5637817436007, -822.7838778875675, -959.551725446479, -781.879825551242, -739.432341949473, -231.48341193833693, -288.2456328964043, -1031.6738785935277, -1034.9311644414486, -815.4824547857064, -569.592852102508, -84.10861414149721, -897.9958217402265, -1188.2388434243987, -715.7154478080304, -667.1032922863862, -1118.0508679229993, -285.0022835750982, -1080.2611588290172, -865.4621473822712, -118.60086103108294, -1159.4057176167084, -714.3292687133205, -833.7964012081401, -505.2985167561209, -514.4528006458655, -1059.263934936012, -998.5163074302893, -1143.1504996852902, -907.1859248919075, -705.6672670531307, -1122.2379004326265, -1114.2398595078137, -797.0768151372929, -581.7146677771084, -557.4656841450271, -991.2317728513073, -1151.5851518222698, -204.49240697008386, -229.3331738689984, -964.6374064349328, -1044.6735922955013, -767.6824755695515, -1205.8731430013916, -673.14802107088, -1121.761827877676, -978.6025515450102, -879.8219854466155, -819.4970093039201, -61.27461805064071, -164.30374058417408, -362.0607469270141, -1132.5408474788455, -234.68948603668744, -905.2460363528439, -1008.3900884914406, -942.8327922059293, -384.6354491599059, -980.2585794514775, -887.7910756869204, -482.55121207888965, -865.0036373837706, -691.5719713170753, -931.938908209675, -341.86035460117347, -895.5342479559961, -586.3763739162728, -930.4652060501461, -1085.7338729238709, -296.63354511596674, -690.4292239811427, -596.1640637520325, -451.66943144651236, -429.30518497930353, -692.0647132690133, -1260.1974135529556, -129.93938580941025, -1008.4321048755593, -1178.6423021349858, -665.002054942491, -620.81601174053, -971.4349698704613, -585.3901402134603, -683.7575059989886, -845.1940301576916, -869.6407270574481, -795.4014661195718, -922.206239622404, -234.38486365163615, -854.2893679415457, -133.11212495727455, -1049.1762402994746, -1075.706770068621, -447.18950576096256, -987.2437786064665, -862.4307103042938, -573.7916195313126, -700.5819645097415, -496.460742287508, -1041.0094825195881, -1068.4289299393529, -265.25338641395587, -37.79643888110528, -697.0629949000136, -685.2561371556848, -943.7899480541498, -922.4909138255241, -971.0182795264409, -1153.1333779982015, -30.22946640729348, -785.8161780107657, -846.383371565024, -881.046763249836, -856.0689436873882, -77.43811456676004, -1047.970440090734, -47.504291933643735, -39.14131588897237, -913.0242892952207, -890.1940996358436, -1173.3460374250358, -1121.1240448112526, -50.86972883324663, -315.7701142339373, -1161.7858353871825, -881.0099019802996, -935.0973289176908, -526.3342764754651, -446.07260981834, -630.9205715283797, -653.7505494829197, -539.79848061499, -559.2196397094968, -475.93700372788953, -102.67334383267956, -938.7041597222017, -1029.764410879461, -1121.2832761521859, -967.8023026316954, -386.9535289195838, -894.7733004761161, -738.9176184034027, -725.3209960062896, -752.202036460586, -568.3832533011669, -812.8450618713072, -819.2143802752623, -930.4024373349545, -436.8743957885877, -600.9960477318971, -1135.7303716669599, -700.315636581709, -1185.6798088593232, -998.127699685008, -634.9983495673434, -219.6799849262109, -749.3782415820815, -934.6107252054837, -888.748746921281, -627.936970165389, -448.7389531013134, -428.41643355494386, -668.2095413772116, -736.6933846626729, -539.925356874623, -32.598327530046774, -900.9267528519823, -1015.2173094543018, -526.1286803585801, -514.1386208198431, -1067.0451663194776, -646.4050150387556, -442.28434704933795, -1027.9170979348864, -748.4277429279716, -719.7482280014859, -782.7525207592367, -937.0355469275604, -432.4848182400083, -862.3746958255847, -497.9210430518801, -900.7546225656408, -320.18207507360916, -79.45426457624686, -637.7545307265483, -987.5105247017902, -694.8255548861248, -839.2687832684526, -138.64267991153972, -1024.7316431425083, -191.13181383522124, -741.8784896515721, -322.8479927170321, -503.46506238856057, -882.3907465402125, -509.30877326284434, -776.7217271801336, -550.8562134451415, -591.589545697865, -511.0852074170372, -474.0970751278814, -402.2220091384676, -814.5331326958474, -329.2295061831752, -531.9811915801797, -567.8502177100737, -797.2056433987707, -734.9349880470285, -795.5987468498587, -741.4838953037565, -825.2835669759681, -366.74576253003397, -886.5306797921838, -126.7954374702447, -624.0843239991192, -697.8008926992878, -765.6939960527255, -761.7314574992781, -588.934462542855, -1006.6791536580706, -1042.7615467198195, -88.18026845439616, -76.79441143514357, -540.0727170184642, -490.98605859092925, -549.7190214199477, -318.73929719957175, -743.6397158755717, -673.4154123978668, -341.87266249893554, -593.9921638129134, -720.9395816587746, -253.58046742351047, -867.7407870801018, -707.8149338808322, -838.0282846204454, -899.1078289104678, -994.5429378732196, -1160.869186016122, -648.2561897844932, -719.7993766317379, -716.4531549819362, -208.09359368426772, -670.6123632482564, -366.8368582274087, -901.9240179320842, -440.97160687590275, -703.0797051535691, -692.7438822979283, -734.5389134166833, -500.5052125082694, -292.23904016468504, -1218.2154916071074, -14.172614289011674, -530.639646997554, -343.55133324827625, -161.31541559078047, -1142.8629084770234, -822.1274917755569, -808.9195808729229, -722.8599401818088, -918.1386013258422, -542.8983330330473, -327.4224558177306, -1177.4458724826309, -66.22755833364907, -226.7972527937261, -986.1903715103907, -1165.3522051034588, -1000.4102098211933, -760.0325331640121, -782.1336209483622, -163.62730053360508, -1120.0275341421973, -262.1954255495633, -865.2995621390503, -60.79295222190148, -557.5279806248634, -231.41453920611877, -86.43190096599464, -1120.6338432939654, -315.6016814082098, -671.5757595411388, -813.4993732665762, -880.3751289833446, -1009.6981501804954, -898.3352632951006, -741.4278852293706, -555.6578558097206, -1073.0596897430523, -854.6690946747296, -1043.6300488230575, -848.7437483544653, -1055.9585786539528, -127.88878111398537, -691.9307648949728, -456.2641282582026, -746.2645111066754, -195.77724379614222, -931.6125919298362, -983.179749338279, -1053.50950801154, -890.639241984973, -1160.5632294758739, -61.10428031206952, -935.5968798035004, -206.33939041322077, -1128.4221851442906, -934.3593570407664, -803.4442526838532, -493.0441378483217, -722.7354827989607, -1023.0695629225931, -841.2294691856031, -678.4035310524548, -1059.3037397479989, -1021.9088242545308, -635.5006010047758, -190.76905493974326, -251.15843141674242, -475.1812208979839, -1091.220617773451, -10.712307924410862, -896.7326037234725, -712.67406814373, -793.8189151458322, -294.7381029103132, -811.0933130050505, -957.938244877493, -267.00643328607475, -598.8761716605475, -163.5901204839263, -906.2660897692256, -540.5246273439946, -19.57012581954243, -671.2571495994375, -811.3807327982638, -410.28285622743647, -888.1937550450251, -638.733162151996, -748.6402887652883, -986.6228147585084, -910.5257759696773, -599.285710306452, -118.37334122640235, -457.31172722501935, -968.6828956259858, -1103.8466383289237, -430.7283437328791, -1124.2715541177602, -658.531418094197, -945.5933587736092, -1051.618843661465, -1119.3129834065658, -267.59723397275, -238.9606071480072, -860.6674241336216, -1125.9200315736512, -1040.766400959526, -311.6091884697713, -1060.2075426744698, -868.8187887256213, -1105.9810719268905, -841.6104112439359, -21.177485073575703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6875120894305755, "mean_inference_ms": 1.7981423041780353, "mean_action_processing_ms": 0.8807672801744741, "mean_env_wait_ms": 11.162117068374732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01720041036605835, "StateBufferConnector_ms": 0.01319795846939087, "ViewRequirementAgentConnector_ms": 0.48578619956970215}, "num_episodes": 40, "episode_return_max": -1801.4669351579291, "episode_return_min": -4656.014638372261, "episode_return_mean": -3507.101589407056, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55812, "num_agent_steps_trained": 55812, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.1755671018837, "num_env_steps_trained_throughput_per_sec": 75.1755671018837, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 55812, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 55812, "timers": {"training_iteration_time_ms": 47953.459, "restore_workers_time_ms": 0.026, "training_step_time_ms": 47953.392, "sample_time_ms": 3477.658, "learn_time_ms": 44421.586, "learn_throughput": 90.046, "synch_weights_time_ms": 51.045}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 55812, "num_agent_steps_trained": 55812}, "done": false, "training_iteration": 3, "trial_id": "05c72_00000", "date": "2024-07-26_14-45-22", "timestamp": 1721985322, "time_this_iter_s": 53.21726727485657, "time_total_s": 143.8884401321411, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d3c4451750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 143.8884401321411, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.271052631578948, "ram_util_percent": 32.88421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.26210360537851, "cur_kl_coeff": 0.09999999999999998, "cur_lr": 0.001, "total_loss": 6.012325119701913, "policy_loss": -0.003199955246193744, "vf_loss": 6.028536374768973, "vf_explained_var": 0.9665932435297371, "kl": 0.011182752002402891, "entropy": 1.4129584552749754, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.20408163265306, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 2204.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 74511, "num_agent_steps_trained": 74511}, "env_runners": {"episode_reward_max": -1801.4669351579291, "episode_reward_min": -4689.163840339777, "episode_reward_mean": -3505.1421073669444, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1313.133472223908}, "policy_reward_max": {"policy_0": -10.712307924410862}, "policy_reward_mean": {"policy_0": -701.0284214733888}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3254.4748245322758, -4498.651107279361, -3960.1609243664525, -4066.0993663587747, -3708.1750311898063, -3126.0283994914616, -4555.651977337898, -4489.21155257836, -3401.8165426554233, -3455.6515792166597, -4015.879749995769, -3331.430765325376, -4622.569467589365, -4320.936509907978, -3134.1081896576857, -4656.014638372261, -3860.957992223862, -2798.8408573795687, -4203.907984995677, -3312.926083590584, -3794.743245962256, -2859.632617428003, -4242.213261315405, -3706.5926579811294, -3675.9226643926045, -3692.4284196927993, -3674.274519152444, -2753.7978872901126, -4020.661985811614, -3446.7533710797757, -2937.8344368444123, -3822.8957606906565, -3419.4346887201773, -2331.379017367973, -4444.507678305128, -3679.5972046475536, -3600.332323002007, -4654.851866360345, -3420.354668800449, -2821.983669570764, -2989.009691014752, -3932.0793692704283, -3734.3958097538716, -2436.066535993926, -3684.979185910415, -2641.7141051325953, -2939.561467003024, -2552.0629147255513, -3637.073491309488, -2829.439770767549, -3820.8399624522167, -2238.7950022187515, -2627.3861093918913, -3144.067933856129, -4540.80442720475, -2681.7953467736083, -3473.2581256761687, -2555.7720055666305, -3278.7767299645616, -3688.765202841058, -3444.97759756242, -3088.0164143377424, -1801.4669351579291, -3801.685786493232, -4278.17884425774, -3930.89025162019, -3021.849239985826, -4148.996009122738, -4008.1620650856335, -3758.482183807932, -3158.6406513637917, -3186.5208184630474, -3124.5950092247654, -2228.827135077238, -3419.84765582216, -3363.44793102633, -4084.84115903057, -4042.6538379085887, -3577.923652284576, -3897.795299644494, -3758.4299804556103, -1821.8713869010076, -3985.457403473812, -3937.015637466144, -4266.880318230402, -2885.930927010266, -2779.7247582101068, -4339.316112176567, -4224.772879336736, -3908.0602055537715, -3669.108260919351, -3789.035746804783, -2822.5357428332914, -4689.163840339777, -3938.4549868920785, -1985.5072692320034, -3442.373403076378, -3782.176683221683, -2835.3896658622803, -3084.8783761338923], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-562.3008432494819, -964.044738885273, -727.9181634263554, -609.5275568063192, -390.6835221648477, -783.0230577510397, -1111.7357864212406, -575.9439615790916, -1301.41707543262, -726.531226095368, -924.5192324858001, -984.9551753627682, -370.6884025641759, -1113.6569964373145, -566.3411175163915, -1042.1989076642612, -262.4336835680502, -995.4240423606605, -1174.807223394556, -591.2355093712462, -919.8941166879279, -1056.7814782588823, -945.1941693982262, -83.6908979993792, -702.614368845388, -723.1897572491129, -215.16772263871218, -1138.457188538006, -114.49777623799791, -934.7159548276293, -710.3104928416471, -897.8667373950063, -901.5118221826855, -1199.0641768889498, -846.8987480296128, -1185.5637817436007, -822.7838778875675, -959.551725446479, -781.879825551242, -739.432341949473, -231.48341193833693, -288.2456328964043, -1031.6738785935277, -1034.9311644414486, -815.4824547857064, -569.592852102508, -84.10861414149721, -897.9958217402265, -1188.2388434243987, -715.7154478080304, -667.1032922863862, -1118.0508679229993, -285.0022835750982, -1080.2611588290172, -865.4621473822712, -118.60086103108294, -1159.4057176167084, -714.3292687133205, -833.7964012081401, -505.2985167561209, -514.4528006458655, -1059.263934936012, -998.5163074302893, -1143.1504996852902, -907.1859248919075, -705.6672670531307, -1122.2379004326265, -1114.2398595078137, -797.0768151372929, -581.7146677771084, -557.4656841450271, -991.2317728513073, -1151.5851518222698, -204.49240697008386, -229.3331738689984, -964.6374064349328, -1044.6735922955013, -767.6824755695515, -1205.8731430013916, -673.14802107088, -1121.761827877676, -978.6025515450102, -879.8219854466155, -819.4970093039201, -61.27461805064071, -164.30374058417408, -362.0607469270141, -1132.5408474788455, -234.68948603668744, -905.2460363528439, -1008.3900884914406, -942.8327922059293, -384.6354491599059, -980.2585794514775, -887.7910756869204, -482.55121207888965, -865.0036373837706, -691.5719713170753, -931.938908209675, -341.86035460117347, -895.5342479559961, -586.3763739162728, -930.4652060501461, -1085.7338729238709, -296.63354511596674, -690.4292239811427, -596.1640637520325, -451.66943144651236, -429.30518497930353, -692.0647132690133, -1260.1974135529556, -129.93938580941025, -1008.4321048755593, -1178.6423021349858, -665.002054942491, -620.81601174053, -971.4349698704613, -585.3901402134603, -683.7575059989886, -845.1940301576916, -869.6407270574481, -795.4014661195718, -922.206239622404, -234.38486365163615, -854.2893679415457, -133.11212495727455, -1049.1762402994746, -1075.706770068621, -447.18950576096256, -987.2437786064665, -862.4307103042938, -573.7916195313126, -700.5819645097415, -496.460742287508, -1041.0094825195881, -1068.4289299393529, -265.25338641395587, -37.79643888110528, -697.0629949000136, -685.2561371556848, -943.7899480541498, -922.4909138255241, -971.0182795264409, -1153.1333779982015, -30.22946640729348, -785.8161780107657, -846.383371565024, -881.046763249836, -856.0689436873882, -77.43811456676004, -1047.970440090734, -47.504291933643735, -39.14131588897237, -913.0242892952207, -890.1940996358436, -1173.3460374250358, -1121.1240448112526, -50.86972883324663, -315.7701142339373, -1161.7858353871825, -881.0099019802996, -935.0973289176908, -526.3342764754651, -446.07260981834, -630.9205715283797, -653.7505494829197, -539.79848061499, -559.2196397094968, -475.93700372788953, -102.67334383267956, -938.7041597222017, -1029.764410879461, -1121.2832761521859, -967.8023026316954, -386.9535289195838, -894.7733004761161, -738.9176184034027, -725.3209960062896, -752.202036460586, -568.3832533011669, -812.8450618713072, -819.2143802752623, -930.4024373349545, -436.8743957885877, -600.9960477318971, -1135.7303716669599, -700.315636581709, -1185.6798088593232, -998.127699685008, -634.9983495673434, -219.6799849262109, -749.3782415820815, -934.6107252054837, -888.748746921281, -627.936970165389, -448.7389531013134, -428.41643355494386, -668.2095413772116, -736.6933846626729, -539.925356874623, -32.598327530046774, -900.9267528519823, -1015.2173094543018, -526.1286803585801, -514.1386208198431, -1067.0451663194776, -646.4050150387556, -442.28434704933795, -1027.9170979348864, -748.4277429279716, -719.7482280014859, -782.7525207592367, -937.0355469275604, -432.4848182400083, -862.3746958255847, -497.9210430518801, -900.7546225656408, -320.18207507360916, -79.45426457624686, -637.7545307265483, -987.5105247017902, -694.8255548861248, -839.2687832684526, -138.64267991153972, -1024.7316431425083, -191.13181383522124, -741.8784896515721, -322.8479927170321, -503.46506238856057, -882.3907465402125, -509.30877326284434, -776.7217271801336, -550.8562134451415, -591.589545697865, -511.0852074170372, -474.0970751278814, -402.2220091384676, -814.5331326958474, -329.2295061831752, -531.9811915801797, -567.8502177100737, -797.2056433987707, -734.9349880470285, -795.5987468498587, -741.4838953037565, -825.2835669759681, -366.74576253003397, -886.5306797921838, -126.7954374702447, -624.0843239991192, -697.8008926992878, -765.6939960527255, -761.7314574992781, -588.934462542855, -1006.6791536580706, -1042.7615467198195, -88.18026845439616, -76.79441143514357, -540.0727170184642, -490.98605859092925, -549.7190214199477, -318.73929719957175, -743.6397158755717, -673.4154123978668, -341.87266249893554, -593.9921638129134, -720.9395816587746, -253.58046742351047, -867.7407870801018, -707.8149338808322, -838.0282846204454, -899.1078289104678, -994.5429378732196, -1160.869186016122, -648.2561897844932, -719.7993766317379, -716.4531549819362, -208.09359368426772, -670.6123632482564, -366.8368582274087, -901.9240179320842, -440.97160687590275, -703.0797051535691, -692.7438822979283, -734.5389134166833, -500.5052125082694, -292.23904016468504, -1218.2154916071074, -14.172614289011674, -530.639646997554, -343.55133324827625, -161.31541559078047, -1142.8629084770234, -822.1274917755569, -808.9195808729229, -722.8599401818088, -918.1386013258422, -542.8983330330473, -327.4224558177306, -1177.4458724826309, -66.22755833364907, -226.7972527937261, -986.1903715103907, -1165.3522051034588, -1000.4102098211933, -760.0325331640121, -782.1336209483622, -163.62730053360508, -1120.0275341421973, -262.1954255495633, -865.2995621390503, -60.79295222190148, -557.5279806248634, -231.41453920611877, -86.43190096599464, -1120.6338432939654, -315.6016814082098, -671.5757595411388, -813.4993732665762, -880.3751289833446, -1009.6981501804954, -898.3352632951006, -741.4278852293706, -555.6578558097206, -1073.0596897430523, -854.6690946747296, -1043.6300488230575, -848.7437483544653, -1055.9585786539528, -127.88878111398537, -691.9307648949728, -456.2641282582026, -746.2645111066754, -195.77724379614222, -931.6125919298362, -983.179749338279, -1053.50950801154, -890.639241984973, -1160.5632294758739, -61.10428031206952, -935.5968798035004, -206.33939041322077, -1128.4221851442906, -934.3593570407664, -803.4442526838532, -493.0441378483217, -722.7354827989607, -1023.0695629225931, -841.2294691856031, -678.4035310524548, -1059.3037397479989, -1021.9088242545308, -635.5006010047758, -190.76905493974326, -251.15843141674242, -475.1812208979839, -1091.220617773451, -10.712307924410862, -896.7326037234725, -712.67406814373, -793.8189151458322, -294.7381029103132, -811.0933130050505, -957.938244877493, -267.00643328607475, -598.8761716605475, -163.5901204839263, -906.2660897692256, -540.5246273439946, -19.57012581954243, -671.2571495994375, -811.3807327982638, -410.28285622743647, -888.1937550450251, -638.733162151996, -748.6402887652883, -986.6228147585084, -910.5257759696773, -599.285710306452, -118.37334122640235, -457.31172722501935, -968.6828956259858, -1103.8466383289237, -430.7283437328791, -1124.2715541177602, -658.531418094197, -945.5933587736092, -1051.618843661465, -1119.3129834065658, -267.59723397275, -238.9606071480072, -860.6674241336216, -1125.9200315736512, -1040.766400959526, -311.6091884697713, -1060.2075426744698, -868.8187887256213, -1105.9810719268905, -841.6104112439359, -21.177485073575703, -825.7929080140631, -1034.0583768720924, -1025.3310886243414, -306.6794028872859, -566.5682040578293, -119.46057051679665, -241.17749478267433, -577.606660276461, -743.2901041039728, -140.33655722110223, -833.6255805011499, -1250.4029997022708, -184.86791294186767, -843.7220532891936, -872.838857039328, -854.4313799527931, -956.3479670628017, -909.9667243567876, -131.92541163094003, -1084.3441544628215, -913.9899653650414, -1124.9111159843187, -479.3873360722484, -970.7338175020827, -777.858083306715, -973.2954661523121, -658.7130319814044, -95.53743287027712, -261.0082573741302, -897.3767386321429, -39.508223771057615, -879.7674423686127, -348.1801161729559, -580.6703369438673, -931.5986389536107, -814.7105633679224, -829.3018324857567, -738.3491326707606, -937.9744092609411, -1018.9801743911795, -810.5068307444593, -790.9173923160564, -963.587837206958, -872.9920453306726, -786.7687737385858, -792.6222998981262, -1155.0102192457753, -302.98692719343666, -849.9417449817145, -807.4990142347185, -618.3524611028494, -41.593717919039236, -1036.437435605739, -1282.0946955863778, -690.6299507053451, -595.697247411206, -1216.7323415694011, -891.5379706899164, -885.6356812166317, -199.4325059176267, -195.26622930653397, -884.7234331329787, -1020.1244064497233, -82.24631729235948, -640.1753566516995, -574.996292834759, -1187.7856771458282, -977.4157659788898, -1248.0760093215051, -700.8900950587954, -1002.2721955805446, -661.298678241174, -974.3722731595179, -488.2800977999595, -812.2317421108812, -468.6026169890553, -651.6843841717792, -675.2771765495415, -55.89307453202057, -134.0500169896088, -765.7143790308917, -848.036085074391, -685.1327006500172, -43.05495251181607, -1100.4352858092611, -445.43589560461334, -389.41398468255585, -752.2930604280641, -1313.133472223908, -881.9002702825377, -712.6467048865889, -809.9810401584177, -107.36924592430462, -487.8301816387857, -717.562493254181, -67.12786213522934, -476.4602726635424, -450.37042590917946, -942.8572360561017, -1148.0625793698412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6849118919954438, "mean_inference_ms": 1.7961211621586906, "mean_action_processing_ms": 0.8805396462844672, "mean_env_wait_ms": 11.153824570938065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01757669448852539, "StateBufferConnector_ms": 0.013393878936767578, "ViewRequirementAgentConnector_ms": 0.49646973609924316}, "num_episodes": 20, "episode_return_max": -1801.4669351579291, "episode_return_min": -4689.163840339777, "episode_return_mean": -3505.1421073669444, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74511, "num_agent_steps_trained": 74511, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.99824185277771, "num_env_steps_trained_throughput_per_sec": 71.99824185277771, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 74511, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 74511, "timers": {"training_iteration_time_ms": 49854.326, "restore_workers_time_ms": 0.028, "training_step_time_ms": 49854.256, "sample_time_ms": 3496.532, "learn_time_ms": 46302.505, "learn_throughput": 86.388, "synch_weights_time_ms": 52.115}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 74511, "num_agent_steps_trained": 74511}, "done": false, "training_iteration": 4, "trial_id": "05c72_00000", "date": "2024-07-26_14-46-17", "timestamp": 1721985377, "time_this_iter_s": 55.56939339637756, "time_total_s": 199.45783352851868, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d28052a440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 199.45783352851868, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.735443037974683, "ram_util_percent": 32.90886075949367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.3699324825583, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.0010000000000000002, "total_loss": 5.43148067672503, "policy_loss": -0.00468061045601594, "vf_loss": 5.4490098540641405, "vf_explained_var": 0.973402682001188, "kl": 0.012605667242567167, "entropy": 1.4109136635582196, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65753424657534, "num_grad_updates_lifetime": 19740.5, "diff_num_grad_updates_vs_sampler_policy": 2189.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 93149, "num_agent_steps_trained": 93149}, "env_runners": {"episode_reward_max": -1801.4669351579291, "episode_reward_min": -4826.944015764904, "episode_reward_mean": -3392.6534210789455, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1313.133472223908}, "policy_reward_max": {"policy_0": -10.712307924410862}, "policy_reward_mean": {"policy_0": -678.5306842157892}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3794.743245962256, -2859.632617428003, -4242.213261315405, -3706.5926579811294, -3675.9226643926045, -3692.4284196927993, -3674.274519152444, -2753.7978872901126, -4020.661985811614, -3446.7533710797757, -2937.8344368444123, -3822.8957606906565, -3419.4346887201773, -2331.379017367973, -4444.507678305128, -3679.5972046475536, -3600.332323002007, -4654.851866360345, -3420.354668800449, -2821.983669570764, -2989.009691014752, -3932.0793692704283, -3734.3958097538716, -2436.066535993926, -3684.979185910415, -2641.7141051325953, -2939.561467003024, -2552.0629147255513, -3637.073491309488, -2829.439770767549, -3820.8399624522167, -2238.7950022187515, -2627.3861093918913, -3144.067933856129, -4540.80442720475, -2681.7953467736083, -3473.2581256761687, -2555.7720055666305, -3278.7767299645616, -3688.765202841058, -3444.97759756242, -3088.0164143377424, -1801.4669351579291, -3801.685786493232, -4278.17884425774, -3930.89025162019, -3021.849239985826, -4148.996009122738, -4008.1620650856335, -3758.482183807932, -3158.6406513637917, -3186.5208184630474, -3124.5950092247654, -2228.827135077238, -3419.84765582216, -3363.44793102633, -4084.84115903057, -4042.6538379085887, -3577.923652284576, -3897.795299644494, -3758.4299804556103, -1821.8713869010076, -3985.457403473812, -3937.015637466144, -4266.880318230402, -2885.930927010266, -2779.7247582101068, -4339.316112176567, -4224.772879336736, -3908.0602055537715, -3669.108260919351, -3789.035746804783, -2822.5357428332914, -4689.163840339777, -3938.4549868920785, -1985.5072692320034, -3442.373403076378, -3782.176683221683, -2835.3896658622803, -3084.8783761338923, -3466.9068100388304, -3600.2579512664142, -3446.4292058583005, -3673.456670463839, -3127.0617258376064, -3696.6016569845015, -2967.2601326260615, -2358.1344733416518, -3381.3902099838865, -2867.9939820797235, -4826.944015764904, -3705.652722839873, -2738.3540158097476, -3801.9845240680434, -2865.4994598942717, -2814.9944561571256, -3426.345999430594, -3389.4806409852313, -3300.1295677700737, -2069.746694044037], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-895.5342479559961, -586.3763739162728, -930.4652060501461, -1085.7338729238709, -296.63354511596674, -690.4292239811427, -596.1640637520325, -451.66943144651236, -429.30518497930353, -692.0647132690133, -1260.1974135529556, -129.93938580941025, -1008.4321048755593, -1178.6423021349858, -665.002054942491, -620.81601174053, -971.4349698704613, -585.3901402134603, -683.7575059989886, -845.1940301576916, -869.6407270574481, -795.4014661195718, -922.206239622404, -234.38486365163615, -854.2893679415457, -133.11212495727455, -1049.1762402994746, -1075.706770068621, -447.18950576096256, -987.2437786064665, -862.4307103042938, -573.7916195313126, -700.5819645097415, -496.460742287508, -1041.0094825195881, -1068.4289299393529, -265.25338641395587, -37.79643888110528, -697.0629949000136, -685.2561371556848, -943.7899480541498, -922.4909138255241, -971.0182795264409, -1153.1333779982015, -30.22946640729348, -785.8161780107657, -846.383371565024, -881.046763249836, -856.0689436873882, -77.43811456676004, -1047.970440090734, -47.504291933643735, -39.14131588897237, -913.0242892952207, -890.1940996358436, -1173.3460374250358, -1121.1240448112526, -50.86972883324663, -315.7701142339373, -1161.7858353871825, -881.0099019802996, -935.0973289176908, -526.3342764754651, -446.07260981834, -630.9205715283797, -653.7505494829197, -539.79848061499, -559.2196397094968, -475.93700372788953, -102.67334383267956, -938.7041597222017, -1029.764410879461, -1121.2832761521859, -967.8023026316954, -386.9535289195838, -894.7733004761161, -738.9176184034027, -725.3209960062896, -752.202036460586, -568.3832533011669, -812.8450618713072, -819.2143802752623, -930.4024373349545, -436.8743957885877, -600.9960477318971, -1135.7303716669599, -700.315636581709, -1185.6798088593232, -998.127699685008, -634.9983495673434, -219.6799849262109, -749.3782415820815, -934.6107252054837, -888.748746921281, -627.936970165389, -448.7389531013134, -428.41643355494386, -668.2095413772116, -736.6933846626729, -539.925356874623, -32.598327530046774, -900.9267528519823, -1015.2173094543018, -526.1286803585801, -514.1386208198431, -1067.0451663194776, -646.4050150387556, -442.28434704933795, -1027.9170979348864, -748.4277429279716, -719.7482280014859, -782.7525207592367, -937.0355469275604, -432.4848182400083, -862.3746958255847, -497.9210430518801, -900.7546225656408, -320.18207507360916, -79.45426457624686, -637.7545307265483, -987.5105247017902, -694.8255548861248, -839.2687832684526, -138.64267991153972, -1024.7316431425083, -191.13181383522124, -741.8784896515721, -322.8479927170321, -503.46506238856057, -882.3907465402125, -509.30877326284434, -776.7217271801336, -550.8562134451415, -591.589545697865, -511.0852074170372, -474.0970751278814, -402.2220091384676, -814.5331326958474, -329.2295061831752, -531.9811915801797, -567.8502177100737, -797.2056433987707, -734.9349880470285, -795.5987468498587, -741.4838953037565, -825.2835669759681, -366.74576253003397, -886.5306797921838, -126.7954374702447, -624.0843239991192, -697.8008926992878, -765.6939960527255, -761.7314574992781, -588.934462542855, -1006.6791536580706, -1042.7615467198195, -88.18026845439616, -76.79441143514357, -540.0727170184642, -490.98605859092925, -549.7190214199477, -318.73929719957175, -743.6397158755717, -673.4154123978668, -341.87266249893554, -593.9921638129134, -720.9395816587746, -253.58046742351047, -867.7407870801018, -707.8149338808322, -838.0282846204454, -899.1078289104678, -994.5429378732196, -1160.869186016122, -648.2561897844932, -719.7993766317379, -716.4531549819362, -208.09359368426772, -670.6123632482564, -366.8368582274087, -901.9240179320842, -440.97160687590275, -703.0797051535691, -692.7438822979283, -734.5389134166833, -500.5052125082694, -292.23904016468504, -1218.2154916071074, -14.172614289011674, -530.639646997554, -343.55133324827625, -161.31541559078047, -1142.8629084770234, -822.1274917755569, -808.9195808729229, -722.8599401818088, -918.1386013258422, -542.8983330330473, -327.4224558177306, -1177.4458724826309, -66.22755833364907, -226.7972527937261, -986.1903715103907, -1165.3522051034588, -1000.4102098211933, -760.0325331640121, -782.1336209483622, -163.62730053360508, -1120.0275341421973, -262.1954255495633, -865.2995621390503, -60.79295222190148, -557.5279806248634, -231.41453920611877, -86.43190096599464, -1120.6338432939654, -315.6016814082098, -671.5757595411388, -813.4993732665762, -880.3751289833446, -1009.6981501804954, -898.3352632951006, -741.4278852293706, -555.6578558097206, -1073.0596897430523, -854.6690946747296, -1043.6300488230575, -848.7437483544653, -1055.9585786539528, -127.88878111398537, -691.9307648949728, -456.2641282582026, -746.2645111066754, -195.77724379614222, -931.6125919298362, -983.179749338279, -1053.50950801154, -890.639241984973, -1160.5632294758739, -61.10428031206952, -935.5968798035004, -206.33939041322077, -1128.4221851442906, -934.3593570407664, -803.4442526838532, -493.0441378483217, -722.7354827989607, -1023.0695629225931, -841.2294691856031, -678.4035310524548, -1059.3037397479989, -1021.9088242545308, -635.5006010047758, -190.76905493974326, -251.15843141674242, -475.1812208979839, -1091.220617773451, -10.712307924410862, -896.7326037234725, -712.67406814373, -793.8189151458322, -294.7381029103132, -811.0933130050505, -957.938244877493, -267.00643328607475, -598.8761716605475, -163.5901204839263, -906.2660897692256, -540.5246273439946, -19.57012581954243, -671.2571495994375, -811.3807327982638, -410.28285622743647, -888.1937550450251, -638.733162151996, -748.6402887652883, -986.6228147585084, -910.5257759696773, -599.285710306452, -118.37334122640235, -457.31172722501935, -968.6828956259858, -1103.8466383289237, -430.7283437328791, -1124.2715541177602, -658.531418094197, -945.5933587736092, -1051.618843661465, -1119.3129834065658, -267.59723397275, -238.9606071480072, -860.6674241336216, -1125.9200315736512, -1040.766400959526, -311.6091884697713, -1060.2075426744698, -868.8187887256213, -1105.9810719268905, -841.6104112439359, -21.177485073575703, -825.7929080140631, -1034.0583768720924, -1025.3310886243414, -306.6794028872859, -566.5682040578293, -119.46057051679665, -241.17749478267433, -577.606660276461, -743.2901041039728, -140.33655722110223, -833.6255805011499, -1250.4029997022708, -184.86791294186767, -843.7220532891936, -872.838857039328, -854.4313799527931, -956.3479670628017, -909.9667243567876, -131.92541163094003, -1084.3441544628215, -913.9899653650414, -1124.9111159843187, -479.3873360722484, -970.7338175020827, -777.858083306715, -973.2954661523121, -658.7130319814044, -95.53743287027712, -261.0082573741302, -897.3767386321429, -39.508223771057615, -879.7674423686127, -348.1801161729559, -580.6703369438673, -931.5986389536107, -814.7105633679224, -829.3018324857567, -738.3491326707606, -937.9744092609411, -1018.9801743911795, -810.5068307444593, -790.9173923160564, -963.587837206958, -872.9920453306726, -786.7687737385858, -792.6222998981262, -1155.0102192457753, -302.98692719343666, -849.9417449817145, -807.4990142347185, -618.3524611028494, -41.593717919039236, -1036.437435605739, -1282.0946955863778, -690.6299507053451, -595.697247411206, -1216.7323415694011, -891.5379706899164, -885.6356812166317, -199.4325059176267, -195.26622930653397, -884.7234331329787, -1020.1244064497233, -82.24631729235948, -640.1753566516995, -574.996292834759, -1187.7856771458282, -977.4157659788898, -1248.0760093215051, -700.8900950587954, -1002.2721955805446, -661.298678241174, -974.3722731595179, -488.2800977999595, -812.2317421108812, -468.6026169890553, -651.6843841717792, -675.2771765495415, -55.89307453202057, -134.0500169896088, -765.7143790308917, -848.036085074391, -685.1327006500172, -43.05495251181607, -1100.4352858092611, -445.43589560461334, -389.41398468255585, -752.2930604280641, -1313.133472223908, -881.9002702825377, -712.6467048865889, -809.9810401584177, -107.36924592430462, -487.8301816387857, -717.562493254181, -67.12786213522934, -476.4602726635424, -450.37042590917946, -942.8572360561017, -1148.0625793698412, -720.5508277215482, -984.9436313655107, -493.28680938428823, -474.6430183731352, -793.4825231943477, -396.97963799860895, -924.9604059242147, -575.5671896118507, -543.5448380985648, -1159.2058796331785, -754.9653974688634, -367.5988883324086, -718.091748145085, -611.9044143491275, -993.8687575628152, -600.0612519759128, -790.65503853438, -709.0503310378951, -930.3646322531608, -643.3254166624907, -624.1499844082672, -932.080985426822, -447.2629961771832, -266.8184740951915, -856.7492857301436, -309.05111678301364, -746.2203637242427, -855.2338748432055, -732.361251380755, -1053.7350502532875, -42.60523160139861, -542.4080563065758, -668.6076671066903, -664.7763272048013, -1048.8628504065996, -602.6896385809515, -410.9936246036499, -392.0781618176783, -306.75813577007455, -645.6149125692968, -301.2344304073454, -601.7690997488436, -848.8426510049795, -1004.9134279949363, -624.6306008277847, -654.6042086659819, -833.6502494801194, -882.3106924732788, -178.99875519226504, -318.4300762680792, -951.3265884522261, -1006.0565914585817, -683.0692643112814, -1259.3656739085598, -927.1258976342505, -771.5702298519548, -619.553010458449, -925.7203807272656, -735.2249893666096, -653.584112435592, -764.5783626677396, -90.6983668686957, -886.6941644144867, -661.7619178317104, -334.6212040271183, -538.3684698428543, -1143.989607834308, -592.8609704261861, -702.5280783548577, -824.2373976098345, -862.3282412693887, -160.52407480389877, -390.66408659897377, -1197.6491299599734, -254.33392726203664, -574.6473729592751, -787.4659857995072, -231.6393837503443, -695.8463313803749, -525.3953822676211, -921.3672720719939, -287.2223918844016, -1131.4096606179712, -858.7839586367924, -227.5627162194336, -889.2873196949048, -587.570226477839, -798.732731740699, -142.78224027951273, -971.1081227922764, -939.2002312174081, -1052.0255251893461, -759.8358282291003, -323.0786882479477, -225.9892948862691, -154.16486900476997, -794.8281732685562, -339.9420458893901, -614.9857652967308, -165.82584058459076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6720879267299071, "mean_inference_ms": 1.789938390252256, "mean_action_processing_ms": 0.9204633571452325, "mean_env_wait_ms": 11.118142066662937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01775383949279785, "StateBufferConnector_ms": 0.013084650039672852, "ViewRequirementAgentConnector_ms": 0.4983251094818115}, "num_episodes": 20, "episode_return_max": -1801.4669351579291, "episode_return_min": -4826.944015764904, "episode_return_mean": -3392.6534210789455, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93149, "num_agent_steps_trained": 93149, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.86796543930717, "num_env_steps_trained_throughput_per_sec": 73.86796543930717, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 93149, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 93149, "timers": {"training_iteration_time_ms": 50713.598, "restore_workers_time_ms": 0.029, "training_step_time_ms": 50713.525, "sample_time_ms": 3545.935, "learn_time_ms": 47110.674, "learn_throughput": 84.906, "synch_weights_time_ms": 53.692}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 93149, "num_agent_steps_trained": 93149}, "done": false, "training_iteration": 5, "trial_id": "05c72_00000", "date": "2024-07-26_14-47-12", "timestamp": 1721985432, "time_this_iter_s": 54.16235971450806, "time_total_s": 253.62019324302673, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d28052b370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 253.62019324302673, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 11.922077922077921, "ram_util_percent": 32.94155844155845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 148.85124449889932, "cur_kl_coeff": 0.1, "cur_lr": 0.0010000000000000002, "total_loss": 5.535104421161165, "policy_loss": 0.0002338705951753187, "vf_loss": 5.54759322626212, "vf_explained_var": 0.9644129509093777, "kl": 0.014930392822817955, "entropy": 1.4215711623230236, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.24161073825503, "num_grad_updates_lifetime": 24165.5, "diff_num_grad_updates_vs_sampler_policy": 2234.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 112108, "num_agent_steps_trained": 112108}, "env_runners": {"episode_reward_max": -1801.4669351579291, "episode_reward_min": -4826.944015764904, "episode_reward_mean": -3421.410304767136, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1434.7485765599768}, "policy_reward_max": {"policy_0": -10.712307924410862}, "policy_reward_mean": {"policy_0": -684.2820609534272}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3444.97759756242, -3088.0164143377424, -1801.4669351579291, -3801.685786493232, -4278.17884425774, -3930.89025162019, -3021.849239985826, -4148.996009122738, -4008.1620650856335, -3758.482183807932, -3158.6406513637917, -3186.5208184630474, -3124.5950092247654, -2228.827135077238, -3419.84765582216, -3363.44793102633, -4084.84115903057, -4042.6538379085887, -3577.923652284576, -3897.795299644494, -3758.4299804556103, -1821.8713869010076, -3985.457403473812, -3937.015637466144, -4266.880318230402, -2885.930927010266, -2779.7247582101068, -4339.316112176567, -4224.772879336736, -3908.0602055537715, -3669.108260919351, -3789.035746804783, -2822.5357428332914, -4689.163840339777, -3938.4549868920785, -1985.5072692320034, -3442.373403076378, -3782.176683221683, -2835.3896658622803, -3084.8783761338923, -3466.9068100388304, -3600.2579512664142, -3446.4292058583005, -3673.456670463839, -3127.0617258376064, -3696.6016569845015, -2967.2601326260615, -2358.1344733416518, -3381.3902099838865, -2867.9939820797235, -4826.944015764904, -3705.652722839873, -2738.3540158097476, -3801.9845240680434, -2865.4994598942717, -2814.9944561571256, -3426.345999430594, -3389.4806409852313, -3300.1295677700737, -2069.746694044037, -2770.1322481865805, -3852.4470061325273, -2624.7773830684705, -3408.55210287573, -3526.9196861274554, -3492.15230072194, -3151.4042988779356, -3254.1867348894925, -3671.1004193017297, -2766.274512991638, -3472.04814946915, -3068.341698165981, -2118.7086566173302, -3016.262670117141, -3081.3503749039705, -2565.026053203529, -4093.9710145014637, -3487.8237221043664, -3864.701358574803, -3808.494794387506, -2534.5874381104622, -3755.073052645967, -4169.991023151548, -2940.963432453634, -4536.313035968302, -3376.2932884051447, -3596.009300971806, -3432.3057776583264, -3795.9417691597087, -3570.987086042639, -3727.163558051498, -2052.9861580766074, -3739.912185150554, -4554.688501372253, -3632.0184984138336, -3961.9334289546687, -3300.6505333016416, -4015.7875793713024, -3530.83480386109, -3983.407863722295], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-66.22755833364907, -226.7972527937261, -986.1903715103907, -1165.3522051034588, -1000.4102098211933, -760.0325331640121, -782.1336209483622, -163.62730053360508, -1120.0275341421973, -262.1954255495633, -865.2995621390503, -60.79295222190148, -557.5279806248634, -231.41453920611877, -86.43190096599464, -1120.6338432939654, -315.6016814082098, -671.5757595411388, -813.4993732665762, -880.3751289833446, -1009.6981501804954, -898.3352632951006, -741.4278852293706, -555.6578558097206, -1073.0596897430523, -854.6690946747296, -1043.6300488230575, -848.7437483544653, -1055.9585786539528, -127.88878111398537, -691.9307648949728, -456.2641282582026, -746.2645111066754, -195.77724379614222, -931.6125919298362, -983.179749338279, -1053.50950801154, -890.639241984973, -1160.5632294758739, -61.10428031206952, -935.5968798035004, -206.33939041322077, -1128.4221851442906, -934.3593570407664, -803.4442526838532, -493.0441378483217, -722.7354827989607, -1023.0695629225931, -841.2294691856031, -678.4035310524548, -1059.3037397479989, -1021.9088242545308, -635.5006010047758, -190.76905493974326, -251.15843141674242, -475.1812208979839, -1091.220617773451, -10.712307924410862, -896.7326037234725, -712.67406814373, -793.8189151458322, -294.7381029103132, -811.0933130050505, -957.938244877493, -267.00643328607475, -598.8761716605475, -163.5901204839263, -906.2660897692256, -540.5246273439946, -19.57012581954243, -671.2571495994375, -811.3807327982638, -410.28285622743647, -888.1937550450251, -638.733162151996, -748.6402887652883, -986.6228147585084, -910.5257759696773, -599.285710306452, -118.37334122640235, -457.31172722501935, -968.6828956259858, -1103.8466383289237, -430.7283437328791, -1124.2715541177602, -658.531418094197, -945.5933587736092, -1051.618843661465, -1119.3129834065658, -267.59723397275, -238.9606071480072, -860.6674241336216, -1125.9200315736512, -1040.766400959526, -311.6091884697713, -1060.2075426744698, -868.8187887256213, -1105.9810719268905, -841.6104112439359, -21.177485073575703, -825.7929080140631, -1034.0583768720924, -1025.3310886243414, -306.6794028872859, -566.5682040578293, -119.46057051679665, -241.17749478267433, -577.606660276461, -743.2901041039728, -140.33655722110223, -833.6255805011499, -1250.4029997022708, -184.86791294186767, -843.7220532891936, -872.838857039328, -854.4313799527931, -956.3479670628017, -909.9667243567876, -131.92541163094003, -1084.3441544628215, -913.9899653650414, -1124.9111159843187, -479.3873360722484, -970.7338175020827, -777.858083306715, -973.2954661523121, -658.7130319814044, -95.53743287027712, -261.0082573741302, -897.3767386321429, -39.508223771057615, -879.7674423686127, -348.1801161729559, -580.6703369438673, -931.5986389536107, -814.7105633679224, -829.3018324857567, -738.3491326707606, -937.9744092609411, -1018.9801743911795, -810.5068307444593, -790.9173923160564, -963.587837206958, -872.9920453306726, -786.7687737385858, -792.6222998981262, -1155.0102192457753, -302.98692719343666, -849.9417449817145, -807.4990142347185, -618.3524611028494, -41.593717919039236, -1036.437435605739, -1282.0946955863778, -690.6299507053451, -595.697247411206, -1216.7323415694011, -891.5379706899164, -885.6356812166317, -199.4325059176267, -195.26622930653397, -884.7234331329787, -1020.1244064497233, -82.24631729235948, -640.1753566516995, -574.996292834759, -1187.7856771458282, -977.4157659788898, -1248.0760093215051, -700.8900950587954, -1002.2721955805446, -661.298678241174, -974.3722731595179, -488.2800977999595, -812.2317421108812, -468.6026169890553, -651.6843841717792, -675.2771765495415, -55.89307453202057, -134.0500169896088, -765.7143790308917, -848.036085074391, -685.1327006500172, -43.05495251181607, -1100.4352858092611, -445.43589560461334, -389.41398468255585, -752.2930604280641, -1313.133472223908, -881.9002702825377, -712.6467048865889, -809.9810401584177, -107.36924592430462, -487.8301816387857, -717.562493254181, -67.12786213522934, -476.4602726635424, -450.37042590917946, -942.8572360561017, -1148.0625793698412, -720.5508277215482, -984.9436313655107, -493.28680938428823, -474.6430183731352, -793.4825231943477, -396.97963799860895, -924.9604059242147, -575.5671896118507, -543.5448380985648, -1159.2058796331785, -754.9653974688634, -367.5988883324086, -718.091748145085, -611.9044143491275, -993.8687575628152, -600.0612519759128, -790.65503853438, -709.0503310378951, -930.3646322531608, -643.3254166624907, -624.1499844082672, -932.080985426822, -447.2629961771832, -266.8184740951915, -856.7492857301436, -309.05111678301364, -746.2203637242427, -855.2338748432055, -732.361251380755, -1053.7350502532875, -42.60523160139861, -542.4080563065758, -668.6076671066903, -664.7763272048013, -1048.8628504065996, -602.6896385809515, -410.9936246036499, -392.0781618176783, -306.75813577007455, -645.6149125692968, -301.2344304073454, -601.7690997488436, -848.8426510049795, -1004.9134279949363, -624.6306008277847, -654.6042086659819, -833.6502494801194, -882.3106924732788, -178.99875519226504, -318.4300762680792, -951.3265884522261, -1006.0565914585817, -683.0692643112814, -1259.3656739085598, -927.1258976342505, -771.5702298519548, -619.553010458449, -925.7203807272656, -735.2249893666096, -653.584112435592, -764.5783626677396, -90.6983668686957, -886.6941644144867, -661.7619178317104, -334.6212040271183, -538.3684698428543, -1143.989607834308, -592.8609704261861, -702.5280783548577, -824.2373976098345, -862.3282412693887, -160.52407480389877, -390.66408659897377, -1197.6491299599734, -254.33392726203664, -574.6473729592751, -787.4659857995072, -231.6393837503443, -695.8463313803749, -525.3953822676211, -921.3672720719939, -287.2223918844016, -1131.4096606179712, -858.7839586367924, -227.5627162194336, -889.2873196949048, -587.570226477839, -798.732731740699, -142.78224027951273, -971.1081227922764, -939.2002312174081, -1052.0255251893461, -759.8358282291003, -323.0786882479477, -225.9892948862691, -154.16486900476997, -794.8281732685562, -339.9420458893901, -614.9857652967308, -165.82584058459076, -140.58980285217604, -492.6379011651336, -658.6959336989047, -780.8834494962472, -697.3251609741193, -757.4249147456344, -1151.2616987448014, -559.0369763434272, -462.13521030103885, -922.588205997623, -480.4166119043437, -63.711124635487366, -1051.6270898086423, -935.8500388329658, -93.17251788703008, -941.6705879628686, -196.90819974228745, -1148.1346097414662, -895.4678172960216, -226.37088813308824, -587.9904842772403, -622.1510105614324, -653.870597296127, -823.9557608279306, -838.9518331647241, -227.30238331501175, -258.07599648682975, -1238.865816876448, -965.3076076300259, -802.6004964136271, -788.2574004642091, -222.94127012464787, -88.16785480783406, -852.3982705461613, -1199.6395029350865, -1177.8138552606101, -1030.0687337852744, -45.55444967434804, -897.8941437704848, -102.85555239877532, -657.45269546142, -1044.5161175107494, -73.84873383690628, -865.657231760936, -1029.625640731714, -402.55452210227594, -591.1758676452965, -566.7837340934192, -433.8153223472141, -771.9450668034314, -643.0332631008433, -826.4183699089732, -841.1124731960809, -337.66250614540365, -823.8215371178517, -424.88448996526984, -974.9445862824572, -254.74234095042823, -464.2969871483255, -949.4732938194988, -656.3459953859269, -248.5157086024128, -29.406678487667314, -319.0563233631889, -865.383950778133, -58.36038366973059, -675.5881286175303, -22.288970612305814, -1434.7485765599768, -825.2766106575984, -590.261978226089, -460.8562535331758, -77.99167123411695, -1113.5346388673588, -838.7058330432319, -306.7592994728392, -203.23995151454167, -702.8837905798465, -719.3752028047171, -632.7678088315854, -1045.649015725935, -1045.6044396067252, -300.30975597730986, -781.4385143417244, -920.9692888497693, -959.4340689463137, -838.8667895204836, -657.5759321162939, -799.7849273770626, -232.16200414421508, -826.4717209214971, -24.782029070222755, -916.6806147134519, -1295.1784696699472, -801.5885241996837, -749.3712820625205, -441.75123515133953, -741.5568571887975, -997.2101428934956, -878.6052770913489, -376.46965341833646, -431.90402499728134, -666.440873748459, -612.7199732717406, -447.052912674646, -961.9497964793887, -621.409940336529, -720.2189878502265, -589.5039219285486, -861.9904060512744, -580.8618838251372, -866.5050445764169, -875.2172499835646, -938.3529547515831, -909.0538900148471, -534.2637408534479, -696.5641389020523, -657.5213520050584, -717.3084407580769, -335.3057599349979, -727.0299234031544, -919.7767037173438, -693.9300869367469, -1168.8019414593118, -1026.7743804517474, -454.3935761296725, -823.3876414371811, -734.5145145868969, -561.6794675456232, -802.3180887057688, -546.1848984936512, -961.3348829903878, -769.7724569780517, -834.1292094370197, -484.5878530726939, -395.724459630912, -1011.7876529282064, -825.4087078590035, -857.0388458787253, -342.34611136148123, -872.846382064238, -942.6912656327481, -628.1894933755301, -338.22396101352285, -1013.9906670736688, -962.7713600528436, -747.0256702529341, -646.496557562358, -848.8539558723636, -365.8395423021414, -918.5796651835531, -578.743718167018, -153.51448159921313, -930.7826329373563, -1145.5430601643582, -33.76814841752279, -317.6913851008433, -547.2560875983474, -961.6792985510809, -192.59123840881333, -1062.624033571662, -277.48969903262, -808.9240841271458, -835.9535774544092, -754.9207909647166, -885.4986905717675, -1069.6755165236113, -1094.8599871324145, -721.9297052046334, -782.7246019398252, -768.4460074350802, -575.7962911662555, -864.7292040989955, -385.01091722421074, -1038.0360784892944, -412.90699598125275, -828.5268456000676, -938.7683166912071, -873.3607068168474, -908.3705638652947, -71.82853764453994, -203.24487709573884, -888.700949825263, -1199.915563766902, -936.9606049692001, -786.5867901291306, -979.4180308427156, -670.832428359889, -834.6559957192156, -744.2943343203464, -527.5817384771825, -83.54756984215258, -645.9190369065112, -1181.4851716337955, -1092.3012870014475, -763.6898663177637, -983.3840704161843, -378.01065320305116, -1026.9622637542232, -831.361010031071]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.670174121383428, "mean_inference_ms": 1.7953557314294661, "mean_action_processing_ms": 0.9891399464291123, "mean_env_wait_ms": 11.173096522792468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017154932022094727, "StateBufferConnector_ms": 0.012700557708740234, "ViewRequirementAgentConnector_ms": 0.4830629825592041}, "num_episodes": 40, "episode_return_max": -1801.4669351579291, "episode_return_min": -4826.944015764904, "episode_return_mean": -3421.410304767136, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112108, "num_agent_steps_trained": 112108, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.49202432111389, "num_env_steps_trained_throughput_per_sec": 67.49202432111389, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 112108, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112108, "timers": {"training_iteration_time_ms": 52139.045, "restore_workers_time_ms": 0.029, "training_step_time_ms": 52138.971, "sample_time_ms": 3520.198, "learn_time_ms": 48560.427, "learn_throughput": 82.372, "synch_weights_time_ms": 55.077}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 112108, "num_agent_steps_trained": 112108}, "done": false, "training_iteration": 6, "trial_id": "05c72_00000", "date": "2024-07-26_14-48-11", "timestamp": 1721985491, "time_this_iter_s": 59.277663469314575, "time_total_s": 312.8978567123413, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d28052a7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 312.8978567123413, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 10.776190476190477, "ram_util_percent": 32.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 130.0596520582835, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.001, "total_loss": 5.823933380153444, "policy_loss": -0.0020609478342036407, "vf_loss": 5.838113874342707, "vf_explained_var": 0.969407602098253, "kl": 0.015109689922207811, "entropy": 1.3630524977313148, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.16666666666667, "num_grad_updates_lifetime": 28650.5, "diff_num_grad_updates_vs_sampler_policy": 2249.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 131183, "num_agent_steps_trained": 131183}, "env_runners": {"episode_reward_max": -1821.8713869010076, "episode_reward_min": -4826.944015764904, "episode_reward_mean": -3402.0556038796703, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1434.7485765599768}, "policy_reward_max": {"policy_0": -22.288970612305814}, "policy_reward_mean": {"policy_0": -680.411120775934}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3758.4299804556103, -1821.8713869010076, -3985.457403473812, -3937.015637466144, -4266.880318230402, -2885.930927010266, -2779.7247582101068, -4339.316112176567, -4224.772879336736, -3908.0602055537715, -3669.108260919351, -3789.035746804783, -2822.5357428332914, -4689.163840339777, -3938.4549868920785, -1985.5072692320034, -3442.373403076378, -3782.176683221683, -2835.3896658622803, -3084.8783761338923, -3466.9068100388304, -3600.2579512664142, -3446.4292058583005, -3673.456670463839, -3127.0617258376064, -3696.6016569845015, -2967.2601326260615, -2358.1344733416518, -3381.3902099838865, -2867.9939820797235, -4826.944015764904, -3705.652722839873, -2738.3540158097476, -3801.9845240680434, -2865.4994598942717, -2814.9944561571256, -3426.345999430594, -3389.4806409852313, -3300.1295677700737, -2069.746694044037, -2770.1322481865805, -3852.4470061325273, -2624.7773830684705, -3408.55210287573, -3526.9196861274554, -3492.15230072194, -3151.4042988779356, -3254.1867348894925, -3671.1004193017297, -2766.274512991638, -3472.04814946915, -3068.341698165981, -2118.7086566173302, -3016.262670117141, -3081.3503749039705, -2565.026053203529, -4093.9710145014637, -3487.8237221043664, -3864.701358574803, -3808.494794387506, -2534.5874381104622, -3755.073052645967, -4169.991023151548, -2940.963432453634, -4536.313035968302, -3376.2932884051447, -3596.009300971806, -3432.3057776583264, -3795.9417691597087, -3570.987086042639, -3727.163558051498, -2052.9861580766074, -3739.912185150554, -4554.688501372253, -3632.0184984138336, -3961.9334289546687, -3300.6505333016416, -4015.7875793713024, -3530.83480386109, -3983.407863722295, -3292.5716014963955, -3355.3964939797825, -2391.9568342969383, -3184.8884808360335, -2750.1792895066387, -3338.778722223505, -2781.7837735263975, -4419.098262018869, -4144.185728505304, -3843.598598873359, -1934.916029668721, -4487.286598210308, -2182.9158771145026, -3868.883410593177, -3845.4668786277466, -3068.667718391519, -3370.7448088606952, -3772.608526747745, -2966.321923615838, -4432.078831436904], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-825.7929080140631, -1034.0583768720924, -1025.3310886243414, -306.6794028872859, -566.5682040578293, -119.46057051679665, -241.17749478267433, -577.606660276461, -743.2901041039728, -140.33655722110223, -833.6255805011499, -1250.4029997022708, -184.86791294186767, -843.7220532891936, -872.838857039328, -854.4313799527931, -956.3479670628017, -909.9667243567876, -131.92541163094003, -1084.3441544628215, -913.9899653650414, -1124.9111159843187, -479.3873360722484, -970.7338175020827, -777.858083306715, -973.2954661523121, -658.7130319814044, -95.53743287027712, -261.0082573741302, -897.3767386321429, -39.508223771057615, -879.7674423686127, -348.1801161729559, -580.6703369438673, -931.5986389536107, -814.7105633679224, -829.3018324857567, -738.3491326707606, -937.9744092609411, -1018.9801743911795, -810.5068307444593, -790.9173923160564, -963.587837206958, -872.9920453306726, -786.7687737385858, -792.6222998981262, -1155.0102192457753, -302.98692719343666, -849.9417449817145, -807.4990142347185, -618.3524611028494, -41.593717919039236, -1036.437435605739, -1282.0946955863778, -690.6299507053451, -595.697247411206, -1216.7323415694011, -891.5379706899164, -885.6356812166317, -199.4325059176267, -195.26622930653397, -884.7234331329787, -1020.1244064497233, -82.24631729235948, -640.1753566516995, -574.996292834759, -1187.7856771458282, -977.4157659788898, -1248.0760093215051, -700.8900950587954, -1002.2721955805446, -661.298678241174, -974.3722731595179, -488.2800977999595, -812.2317421108812, -468.6026169890553, -651.6843841717792, -675.2771765495415, -55.89307453202057, -134.0500169896088, -765.7143790308917, -848.036085074391, -685.1327006500172, -43.05495251181607, -1100.4352858092611, -445.43589560461334, -389.41398468255585, -752.2930604280641, -1313.133472223908, -881.9002702825377, -712.6467048865889, -809.9810401584177, -107.36924592430462, -487.8301816387857, -717.562493254181, -67.12786213522934, -476.4602726635424, -450.37042590917946, -942.8572360561017, -1148.0625793698412, -720.5508277215482, -984.9436313655107, -493.28680938428823, -474.6430183731352, -793.4825231943477, -396.97963799860895, -924.9604059242147, -575.5671896118507, -543.5448380985648, -1159.2058796331785, -754.9653974688634, -367.5988883324086, -718.091748145085, -611.9044143491275, -993.8687575628152, -600.0612519759128, -790.65503853438, -709.0503310378951, -930.3646322531608, -643.3254166624907, -624.1499844082672, -932.080985426822, -447.2629961771832, -266.8184740951915, -856.7492857301436, -309.05111678301364, -746.2203637242427, -855.2338748432055, -732.361251380755, -1053.7350502532875, -42.60523160139861, -542.4080563065758, -668.6076671066903, -664.7763272048013, -1048.8628504065996, -602.6896385809515, -410.9936246036499, -392.0781618176783, -306.75813577007455, -645.6149125692968, -301.2344304073454, -601.7690997488436, -848.8426510049795, -1004.9134279949363, -624.6306008277847, -654.6042086659819, -833.6502494801194, -882.3106924732788, -178.99875519226504, -318.4300762680792, -951.3265884522261, -1006.0565914585817, -683.0692643112814, -1259.3656739085598, -927.1258976342505, -771.5702298519548, -619.553010458449, -925.7203807272656, -735.2249893666096, -653.584112435592, -764.5783626677396, -90.6983668686957, -886.6941644144867, -661.7619178317104, -334.6212040271183, -538.3684698428543, -1143.989607834308, -592.8609704261861, -702.5280783548577, -824.2373976098345, -862.3282412693887, -160.52407480389877, -390.66408659897377, -1197.6491299599734, -254.33392726203664, -574.6473729592751, -787.4659857995072, -231.6393837503443, -695.8463313803749, -525.3953822676211, -921.3672720719939, -287.2223918844016, -1131.4096606179712, -858.7839586367924, -227.5627162194336, -889.2873196949048, -587.570226477839, -798.732731740699, -142.78224027951273, -971.1081227922764, -939.2002312174081, -1052.0255251893461, -759.8358282291003, -323.0786882479477, -225.9892948862691, -154.16486900476997, -794.8281732685562, -339.9420458893901, -614.9857652967308, -165.82584058459076, -140.58980285217604, -492.6379011651336, -658.6959336989047, -780.8834494962472, -697.3251609741193, -757.4249147456344, -1151.2616987448014, -559.0369763434272, -462.13521030103885, -922.588205997623, -480.4166119043437, -63.711124635487366, -1051.6270898086423, -935.8500388329658, -93.17251788703008, -941.6705879628686, -196.90819974228745, -1148.1346097414662, -895.4678172960216, -226.37088813308824, -587.9904842772403, -622.1510105614324, -653.870597296127, -823.9557608279306, -838.9518331647241, -227.30238331501175, -258.07599648682975, -1238.865816876448, -965.3076076300259, -802.6004964136271, -788.2574004642091, -222.94127012464787, -88.16785480783406, -852.3982705461613, -1199.6395029350865, -1177.8138552606101, -1030.0687337852744, -45.55444967434804, -897.8941437704848, -102.85555239877532, -657.45269546142, -1044.5161175107494, -73.84873383690628, -865.657231760936, -1029.625640731714, -402.55452210227594, -591.1758676452965, -566.7837340934192, -433.8153223472141, -771.9450668034314, -643.0332631008433, -826.4183699089732, -841.1124731960809, -337.66250614540365, -823.8215371178517, -424.88448996526984, -974.9445862824572, -254.74234095042823, -464.2969871483255, -949.4732938194988, -656.3459953859269, -248.5157086024128, -29.406678487667314, -319.0563233631889, -865.383950778133, -58.36038366973059, -675.5881286175303, -22.288970612305814, -1434.7485765599768, -825.2766106575984, -590.261978226089, -460.8562535331758, -77.99167123411695, -1113.5346388673588, -838.7058330432319, -306.7592994728392, -203.23995151454167, -702.8837905798465, -719.3752028047171, -632.7678088315854, -1045.649015725935, -1045.6044396067252, -300.30975597730986, -781.4385143417244, -920.9692888497693, -959.4340689463137, -838.8667895204836, -657.5759321162939, -799.7849273770626, -232.16200414421508, -826.4717209214971, -24.782029070222755, -916.6806147134519, -1295.1784696699472, -801.5885241996837, -749.3712820625205, -441.75123515133953, -741.5568571887975, -997.2101428934956, -878.6052770913489, -376.46965341833646, -431.90402499728134, -666.440873748459, -612.7199732717406, -447.052912674646, -961.9497964793887, -621.409940336529, -720.2189878502265, -589.5039219285486, -861.9904060512744, -580.8618838251372, -866.5050445764169, -875.2172499835646, -938.3529547515831, -909.0538900148471, -534.2637408534479, -696.5641389020523, -657.5213520050584, -717.3084407580769, -335.3057599349979, -727.0299234031544, -919.7767037173438, -693.9300869367469, -1168.8019414593118, -1026.7743804517474, -454.3935761296725, -823.3876414371811, -734.5145145868969, -561.6794675456232, -802.3180887057688, -546.1848984936512, -961.3348829903878, -769.7724569780517, -834.1292094370197, -484.5878530726939, -395.724459630912, -1011.7876529282064, -825.4087078590035, -857.0388458787253, -342.34611136148123, -872.846382064238, -942.6912656327481, -628.1894933755301, -338.22396101352285, -1013.9906670736688, -962.7713600528436, -747.0256702529341, -646.496557562358, -848.8539558723636, -365.8395423021414, -918.5796651835531, -578.743718167018, -153.51448159921313, -930.7826329373563, -1145.5430601643582, -33.76814841752279, -317.6913851008433, -547.2560875983474, -961.6792985510809, -192.59123840881333, -1062.624033571662, -277.48969903262, -808.9240841271458, -835.9535774544092, -754.9207909647166, -885.4986905717675, -1069.6755165236113, -1094.8599871324145, -721.9297052046334, -782.7246019398252, -768.4460074350802, -575.7962911662555, -864.7292040989955, -385.01091722421074, -1038.0360784892944, -412.90699598125275, -828.5268456000676, -938.7683166912071, -873.3607068168474, -908.3705638652947, -71.82853764453994, -203.24487709573884, -888.700949825263, -1199.915563766902, -936.9606049692001, -786.5867901291306, -979.4180308427156, -670.832428359889, -834.6559957192156, -744.2943343203464, -527.5817384771825, -83.54756984215258, -645.9190369065112, -1181.4851716337955, -1092.3012870014475, -763.6898663177637, -983.3840704161843, -378.01065320305116, -1026.9622637542232, -831.361010031071, -876.3725907011051, -498.97467918146964, -784.149192786371, -559.6908495228228, -573.3842893046178, -1109.3966876781597, -1027.5420292011631, -401.0540655714209, -64.38525602005892, -753.018455508977, -535.6915650437211, -348.16151452750677, -87.97209311164892, -795.1355563488238, -624.9961052652357, -536.8398095262226, -391.20311790264117, -778.5930053364376, -821.3406694176296, -656.911878653103, -628.4302688533876, -425.7156853072061, -438.9498193137315, -914.5037728364942, -342.5797431958233, -751.3985527388942, -534.9061697909989, -928.1118336353145, -279.3370976334351, -845.0250684248645, -106.34409733529249, -648.4683602109045, -345.56445284231427, -1124.2896312678645, -557.1172318700189, -1184.3702524620662, -725.3526174353352, -486.212711116028, -1005.5152559189573, -1017.6474250864788, -1099.0008694186502, -976.6197449057182, -910.8907207004114, -521.9613523359621, -635.7130411445643, -464.6485026362718, -584.3380665996364, -633.5797114642328, -957.0327763605723, -1203.9995418126439, -613.8477945254924, -259.19924681333015, -524.7679576047254, -501.68695629842335, -35.4140744267488, -1082.5930200188698, -866.546704731361, -1297.3565390715064, -775.099318392261, -465.69101599631284, -785.475389463978, -256.30386268268876, -822.5460959363396, -31.777926591395634, -286.8126024400989, -873.6255737722505, -665.5419389891148, -975.6672289497423, -652.7284439358119, -701.3202249462581, -899.873515050838, -204.03820497884865, -1217.5913342826389, -603.6251509064598, -920.3386734089606, -24.38504975817548, -725.2741206477504, -881.8991689360133, -708.3761968638385, -728.7331821857429, -531.6395606492777, -620.2535376014969, -500.91978158100454, -1014.5863640900269, -703.3455649388916, -681.3983597618466, -601.6505758120239, -1279.5007638455947, -820.1576043966321, -389.9012229316454, -207.26903761075414, -742.1591769513714, -650.9440769613186, -893.5429361693954, -472.40669592299787, -811.5415809630613, -855.7465784632838, -881.5551420435692, -972.8230553868408, -910.4124745801557]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6764838559451076, "mean_inference_ms": 1.7869823532399933, "mean_action_processing_ms": 1.016217921143502, "mean_env_wait_ms": 11.151768067480239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017601728439331055, "StateBufferConnector_ms": 0.013130664825439453, "ViewRequirementAgentConnector_ms": 0.5086045265197754}, "num_episodes": 20, "episode_return_max": -1821.8713869010076, "episode_return_min": -4826.944015764904, "episode_return_mean": -3402.0556038796703, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131183, "num_agent_steps_trained": 131183, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.97033871255272, "num_env_steps_trained_throughput_per_sec": 73.97033871255272, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 131183, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 131183, "timers": {"training_iteration_time_ms": 52415.716, "restore_workers_time_ms": 0.029, "training_step_time_ms": 52415.643, "sample_time_ms": 3525.731, "learn_time_ms": 48833.817, "learn_throughput": 81.91, "synch_weights_time_ms": 52.873}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 131183, "num_agent_steps_trained": 131183}, "done": false, "training_iteration": 7, "trial_id": "05c72_00000", "date": "2024-07-26_14-49-05", "timestamp": 1721985545, "time_this_iter_s": 54.088653564453125, "time_total_s": 366.98651027679443, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d28052beb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 366.98651027679443, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.302597402597403, "ram_util_percent": 32.900000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 142.72235006541362, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.001, "total_loss": 5.46624941542432, "policy_loss": -0.004593728622733691, "vf_loss": 5.483805822436904, "vf_explained_var": 0.9752854678180668, "kl": 0.015508656624822918, "entropy": 1.4513543690279092, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.46153846153847, "num_grad_updates_lifetime": 33045.5, "diff_num_grad_updates_vs_sampler_policy": 2144.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 149410, "num_agent_steps_trained": 149410}, "env_runners": {"episode_reward_max": -1739.4551127687957, "episode_reward_min": -4826.944015764904, "episode_reward_mean": -3349.6581096024584, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1434.7485765599768}, "policy_reward_max": {"policy_0": -17.21785497220013}, "policy_reward_mean": {"policy_0": -669.9316219204916}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3466.9068100388304, -3600.2579512664142, -3446.4292058583005, -3673.456670463839, -3127.0617258376064, -3696.6016569845015, -2967.2601326260615, -2358.1344733416518, -3381.3902099838865, -2867.9939820797235, -4826.944015764904, -3705.652722839873, -2738.3540158097476, -3801.9845240680434, -2865.4994598942717, -2814.9944561571256, -3426.345999430594, -3389.4806409852313, -3300.1295677700737, -2069.746694044037, -2770.1322481865805, -3852.4470061325273, -2624.7773830684705, -3408.55210287573, -3526.9196861274554, -3492.15230072194, -3151.4042988779356, -3254.1867348894925, -3671.1004193017297, -2766.274512991638, -3472.04814946915, -3068.341698165981, -2118.7086566173302, -3016.262670117141, -3081.3503749039705, -2565.026053203529, -4093.9710145014637, -3487.8237221043664, -3864.701358574803, -3808.494794387506, -2534.5874381104622, -3755.073052645967, -4169.991023151548, -2940.963432453634, -4536.313035968302, -3376.2932884051447, -3596.009300971806, -3432.3057776583264, -3795.9417691597087, -3570.987086042639, -3727.163558051498, -2052.9861580766074, -3739.912185150554, -4554.688501372253, -3632.0184984138336, -3961.9334289546687, -3300.6505333016416, -4015.7875793713024, -3530.83480386109, -3983.407863722295, -3292.5716014963955, -3355.3964939797825, -2391.9568342969383, -3184.8884808360335, -2750.1792895066387, -3338.778722223505, -2781.7837735263975, -4419.098262018869, -4144.185728505304, -3843.598598873359, -1934.916029668721, -4487.286598210308, -2182.9158771145026, -3868.883410593177, -3845.4668786277466, -3068.667718391519, -3370.7448088606952, -3772.608526747745, -2966.321923615838, -4432.078831436904, -3214.4020195342578, -4795.232162402093, -1739.4551127687957, -3302.234107174806, -3470.5454360505337, -3151.950634629911, -3803.9650914717226, -4540.550043423791, -2181.637996117816, -3191.911047520761, -2453.0974028916307, -3123.853638112837, -3288.4142317623023, -3386.77777126306, -1993.4257182599597, -4172.364938125467, -4189.726126139229, -3008.422733849009, -2264.116864081005, -3434.251080829641], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-720.5508277215482, -984.9436313655107, -493.28680938428823, -474.6430183731352, -793.4825231943477, -396.97963799860895, -924.9604059242147, -575.5671896118507, -543.5448380985648, -1159.2058796331785, -754.9653974688634, -367.5988883324086, -718.091748145085, -611.9044143491275, -993.8687575628152, -600.0612519759128, -790.65503853438, -709.0503310378951, -930.3646322531608, -643.3254166624907, -624.1499844082672, -932.080985426822, -447.2629961771832, -266.8184740951915, -856.7492857301436, -309.05111678301364, -746.2203637242427, -855.2338748432055, -732.361251380755, -1053.7350502532875, -42.60523160139861, -542.4080563065758, -668.6076671066903, -664.7763272048013, -1048.8628504065996, -602.6896385809515, -410.9936246036499, -392.0781618176783, -306.75813577007455, -645.6149125692968, -301.2344304073454, -601.7690997488436, -848.8426510049795, -1004.9134279949363, -624.6306008277847, -654.6042086659819, -833.6502494801194, -882.3106924732788, -178.99875519226504, -318.4300762680792, -951.3265884522261, -1006.0565914585817, -683.0692643112814, -1259.3656739085598, -927.1258976342505, -771.5702298519548, -619.553010458449, -925.7203807272656, -735.2249893666096, -653.584112435592, -764.5783626677396, -90.6983668686957, -886.6941644144867, -661.7619178317104, -334.6212040271183, -538.3684698428543, -1143.989607834308, -592.8609704261861, -702.5280783548577, -824.2373976098345, -862.3282412693887, -160.52407480389877, -390.66408659897377, -1197.6491299599734, -254.33392726203664, -574.6473729592751, -787.4659857995072, -231.6393837503443, -695.8463313803749, -525.3953822676211, -921.3672720719939, -287.2223918844016, -1131.4096606179712, -858.7839586367924, -227.5627162194336, -889.2873196949048, -587.570226477839, -798.732731740699, -142.78224027951273, -971.1081227922764, -939.2002312174081, -1052.0255251893461, -759.8358282291003, -323.0786882479477, -225.9892948862691, -154.16486900476997, -794.8281732685562, -339.9420458893901, -614.9857652967308, -165.82584058459076, -140.58980285217604, -492.6379011651336, -658.6959336989047, -780.8834494962472, -697.3251609741193, -757.4249147456344, -1151.2616987448014, -559.0369763434272, -462.13521030103885, -922.588205997623, -480.4166119043437, -63.711124635487366, -1051.6270898086423, -935.8500388329658, -93.17251788703008, -941.6705879628686, -196.90819974228745, -1148.1346097414662, -895.4678172960216, -226.37088813308824, -587.9904842772403, -622.1510105614324, -653.870597296127, -823.9557608279306, -838.9518331647241, -227.30238331501175, -258.07599648682975, -1238.865816876448, -965.3076076300259, -802.6004964136271, -788.2574004642091, -222.94127012464787, -88.16785480783406, -852.3982705461613, -1199.6395029350865, -1177.8138552606101, -1030.0687337852744, -45.55444967434804, -897.8941437704848, -102.85555239877532, -657.45269546142, -1044.5161175107494, -73.84873383690628, -865.657231760936, -1029.625640731714, -402.55452210227594, -591.1758676452965, -566.7837340934192, -433.8153223472141, -771.9450668034314, -643.0332631008433, -826.4183699089732, -841.1124731960809, -337.66250614540365, -823.8215371178517, -424.88448996526984, -974.9445862824572, -254.74234095042823, -464.2969871483255, -949.4732938194988, -656.3459953859269, -248.5157086024128, -29.406678487667314, -319.0563233631889, -865.383950778133, -58.36038366973059, -675.5881286175303, -22.288970612305814, -1434.7485765599768, -825.2766106575984, -590.261978226089, -460.8562535331758, -77.99167123411695, -1113.5346388673588, -838.7058330432319, -306.7592994728392, -203.23995151454167, -702.8837905798465, -719.3752028047171, -632.7678088315854, -1045.649015725935, -1045.6044396067252, -300.30975597730986, -781.4385143417244, -920.9692888497693, -959.4340689463137, -838.8667895204836, -657.5759321162939, -799.7849273770626, -232.16200414421508, -826.4717209214971, -24.782029070222755, -916.6806147134519, -1295.1784696699472, -801.5885241996837, -749.3712820625205, -441.75123515133953, -741.5568571887975, -997.2101428934956, -878.6052770913489, -376.46965341833646, -431.90402499728134, -666.440873748459, -612.7199732717406, -447.052912674646, -961.9497964793887, -621.409940336529, -720.2189878502265, -589.5039219285486, -861.9904060512744, -580.8618838251372, -866.5050445764169, -875.2172499835646, -938.3529547515831, -909.0538900148471, -534.2637408534479, -696.5641389020523, -657.5213520050584, -717.3084407580769, -335.3057599349979, -727.0299234031544, -919.7767037173438, -693.9300869367469, -1168.8019414593118, -1026.7743804517474, -454.3935761296725, -823.3876414371811, -734.5145145868969, -561.6794675456232, -802.3180887057688, -546.1848984936512, -961.3348829903878, -769.7724569780517, -834.1292094370197, -484.5878530726939, -395.724459630912, -1011.7876529282064, -825.4087078590035, -857.0388458787253, -342.34611136148123, -872.846382064238, -942.6912656327481, -628.1894933755301, -338.22396101352285, -1013.9906670736688, -962.7713600528436, -747.0256702529341, -646.496557562358, -848.8539558723636, -365.8395423021414, -918.5796651835531, -578.743718167018, -153.51448159921313, -930.7826329373563, -1145.5430601643582, -33.76814841752279, -317.6913851008433, -547.2560875983474, -961.6792985510809, -192.59123840881333, -1062.624033571662, -277.48969903262, -808.9240841271458, -835.9535774544092, -754.9207909647166, -885.4986905717675, -1069.6755165236113, -1094.8599871324145, -721.9297052046334, -782.7246019398252, -768.4460074350802, -575.7962911662555, -864.7292040989955, -385.01091722421074, -1038.0360784892944, -412.90699598125275, -828.5268456000676, -938.7683166912071, -873.3607068168474, -908.3705638652947, -71.82853764453994, -203.24487709573884, -888.700949825263, -1199.915563766902, -936.9606049692001, -786.5867901291306, -979.4180308427156, -670.832428359889, -834.6559957192156, -744.2943343203464, -527.5817384771825, -83.54756984215258, -645.9190369065112, -1181.4851716337955, -1092.3012870014475, -763.6898663177637, -983.3840704161843, -378.01065320305116, -1026.9622637542232, -831.361010031071, -876.3725907011051, -498.97467918146964, -784.149192786371, -559.6908495228228, -573.3842893046178, -1109.3966876781597, -1027.5420292011631, -401.0540655714209, -64.38525602005892, -753.018455508977, -535.6915650437211, -348.16151452750677, -87.97209311164892, -795.1355563488238, -624.9961052652357, -536.8398095262226, -391.20311790264117, -778.5930053364376, -821.3406694176296, -656.911878653103, -628.4302688533876, -425.7156853072061, -438.9498193137315, -914.5037728364942, -342.5797431958233, -751.3985527388942, -534.9061697909989, -928.1118336353145, -279.3370976334351, -845.0250684248645, -106.34409733529249, -648.4683602109045, -345.56445284231427, -1124.2896312678645, -557.1172318700189, -1184.3702524620662, -725.3526174353352, -486.212711116028, -1005.5152559189573, -1017.6474250864788, -1099.0008694186502, -976.6197449057182, -910.8907207004114, -521.9613523359621, -635.7130411445643, -464.6485026362718, -584.3380665996364, -633.5797114642328, -957.0327763605723, -1203.9995418126439, -613.8477945254924, -259.19924681333015, -524.7679576047254, -501.68695629842335, -35.4140744267488, -1082.5930200188698, -866.546704731361, -1297.3565390715064, -775.099318392261, -465.69101599631284, -785.475389463978, -256.30386268268876, -822.5460959363396, -31.777926591395634, -286.8126024400989, -873.6255737722505, -665.5419389891148, -975.6672289497423, -652.7284439358119, -701.3202249462581, -899.873515050838, -204.03820497884865, -1217.5913342826389, -603.6251509064598, -920.3386734089606, -24.38504975817548, -725.2741206477504, -881.8991689360133, -708.3761968638385, -728.7331821857429, -531.6395606492777, -620.2535376014969, -500.91978158100454, -1014.5863640900269, -703.3455649388916, -681.3983597618466, -601.6505758120239, -1279.5007638455947, -820.1576043966321, -389.9012229316454, -207.26903761075414, -742.1591769513714, -650.9440769613186, -893.5429361693954, -472.40669592299787, -811.5415809630613, -855.7465784632838, -881.5551420435692, -972.8230553868408, -910.4124745801557, -891.7685947798468, -381.6838162057152, -179.29089222016495, -902.245561941392, -859.4131543871368, -1017.8719241628012, -653.0732587624184, -988.5078375238747, -1228.5951002413872, -907.1840417116094, -352.3013094274263, -79.7096363656426, -193.3940611545569, -408.7181387237262, -705.3319670974413, -691.8375839907176, -464.5505236175067, -616.2686501549186, -626.7794422842752, -902.7979071273853, -856.5363922740436, -386.6198252419472, -1103.5237385442654, -1106.6476250180774, -17.21785497220013, -344.96177397529596, -1111.8671945135209, -990.692053495454, -412.41628643842273, -292.0133262072176, -590.6478165793042, -798.0504940088384, -736.8659969431382, -1187.6719426418479, -490.72884129859955, -1002.8075661793241, -624.3345470639279, -1162.3340615668642, -1262.146246437698, -488.9276221759791, -558.3184944228765, -668.8686015766657, -760.5265046661774, -130.7965347621735, -63.12786068992388, -596.630852977164, -882.6539028248803, -43.96963277679163, -740.7858743170589, -927.8707846248672, -72.18075781502203, -746.7981845025915, -100.71462794932042, -916.9538735544627, -616.4499590702359, -252.7425394108809, -769.7343540798224, -918.5755715288684, -1133.4499570021383, -49.35121609113103, -224.23270018885228, -533.6384297148048, -1027.8783081628505, -668.6778445608137, -833.9869491349822, -672.2634717633639, -875.3504888548462, -960.7830406605818, -548.4253072274071, -329.9554627568621, -78.15629803472358, -369.32678454757627, -904.0379946557545, -509.99306889518596, -131.91157212672232, -938.5989475161111, -908.3330394542829, -1118.8646872501943, -885.871557382239, -320.6967065226404, -1231.1891628574595, -1026.9048107947065, -629.5194231776696, -948.6310230052957, -353.4817063041003, -748.4579036333497, -1118.1829295396453, -306.01743511422177, -201.8764500175399, -633.8880155442538, -357.9331190702171, -572.7824763107524, -453.9000856707187, -27.566111908263554, -851.9350711210546, -343.462807716374, -1042.7228152388755, -872.7721930451114, -588.8381928718015, -586.4550719574771]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6765465270791406, "mean_inference_ms": 1.7838281623782748, "mean_action_processing_ms": 1.041253275711822, "mean_env_wait_ms": 11.155872235756592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747274398803711, "StateBufferConnector_ms": 0.012969493865966797, "ViewRequirementAgentConnector_ms": 0.5040199756622314}, "num_episodes": 20, "episode_return_max": -1739.4551127687957, "episode_return_min": -4826.944015764904, "episode_return_mean": -3349.6581096024584, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149410, "num_agent_steps_trained": 149410, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.95003237346097, "num_env_steps_trained_throughput_per_sec": 79.95003237346097, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 149410, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 149410, "timers": {"training_iteration_time_ms": 52117.659, "restore_workers_time_ms": 0.029, "training_step_time_ms": 52117.586, "sample_time_ms": 3527.441, "learn_time_ms": 48533.364, "learn_throughput": 82.418, "synch_weights_time_ms": 53.593}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 149410, "num_agent_steps_trained": 149410}, "done": false, "training_iteration": 8, "trial_id": "05c72_00000", "date": "2024-07-26_14-49-55", "timestamp": 1721985595, "time_this_iter_s": 50.04184341430664, "time_total_s": 417.0283536911011, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d280528670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 417.0283536911011, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 11.576056338028168, "ram_util_percent": 32.900000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 162.35060234284614, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.001, "total_loss": 5.439017801241832, "policy_loss": -0.002029462659056089, "vf_loss": 5.454101977316109, "vf_explained_var": 0.97947390871542, "kl": 0.01553071148131543, "entropy": 1.4607780521248912, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.6554054054054, "num_grad_updates_lifetime": 37410.5, "diff_num_grad_updates_vs_sampler_policy": 2219.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 168303, "num_agent_steps_trained": 168303}, "env_runners": {"episode_reward_max": -1439.1893552730935, "episode_reward_min": -4811.471733807839, "episode_reward_mean": -3352.214817082576, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1297.3565390715064}, "policy_reward_max": {"policy_0": -9.070414927008638}, "policy_reward_mean": {"policy_0": -670.4429634165151}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2534.5874381104622, -3755.073052645967, -4169.991023151548, -2940.963432453634, -4536.313035968302, -3376.2932884051447, -3596.009300971806, -3432.3057776583264, -3795.9417691597087, -3570.987086042639, -3727.163558051498, -2052.9861580766074, -3739.912185150554, -4554.688501372253, -3632.0184984138336, -3961.9334289546687, -3300.6505333016416, -4015.7875793713024, -3530.83480386109, -3983.407863722295, -3292.5716014963955, -3355.3964939797825, -2391.9568342969383, -3184.8884808360335, -2750.1792895066387, -3338.778722223505, -2781.7837735263975, -4419.098262018869, -4144.185728505304, -3843.598598873359, -1934.916029668721, -4487.286598210308, -2182.9158771145026, -3868.883410593177, -3845.4668786277466, -3068.667718391519, -3370.7448088606952, -3772.608526747745, -2966.321923615838, -4432.078831436904, -3214.4020195342578, -4795.232162402093, -1739.4551127687957, -3302.234107174806, -3470.5454360505337, -3151.950634629911, -3803.9650914717226, -4540.550043423791, -2181.637996117816, -3191.911047520761, -2453.0974028916307, -3123.853638112837, -3288.4142317623023, -3386.77777126306, -1993.4257182599597, -4172.364938125467, -4189.726126139229, -3008.422733849009, -2264.116864081005, -3434.251080829641, -2930.691240740439, -2771.1664220871176, -2581.639480757329, -2842.3700724475575, -3297.2319037133316, -3042.239478743921, -4421.853296929892, -3402.031660120904, -2621.5401170366968, -4043.955323454715, -4811.471733807839, -1439.1893552730935, -3075.6693864990198, -3749.05756213016, -3072.8292087620575, -3559.058274568317, -2734.6991146425685, -4157.99640541798, -2437.5770067329995, -3146.9445012503993, -3825.9182479018295, -3612.530613316452, -3836.493382555864, -2978.8620731571086, -2992.089651422208, -2803.1018174534906, -3379.6865707342927, -4314.206523144152, -2478.0332581591874, -4348.736115725215, -2621.959274957159, -3625.7494562157353, -2795.0374140741183, -3600.2137804626236, -3702.3310178617394, -3857.60982905191, -3047.2270649329325, -2783.800879036842, -3098.808133723109, -3033.3641994729896], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-376.46965341833646, -431.90402499728134, -666.440873748459, -612.7199732717406, -447.052912674646, -961.9497964793887, -621.409940336529, -720.2189878502265, -589.5039219285486, -861.9904060512744, -580.8618838251372, -866.5050445764169, -875.2172499835646, -938.3529547515831, -909.0538900148471, -534.2637408534479, -696.5641389020523, -657.5213520050584, -717.3084407580769, -335.3057599349979, -727.0299234031544, -919.7767037173438, -693.9300869367469, -1168.8019414593118, -1026.7743804517474, -454.3935761296725, -823.3876414371811, -734.5145145868969, -561.6794675456232, -802.3180887057688, -546.1848984936512, -961.3348829903878, -769.7724569780517, -834.1292094370197, -484.5878530726939, -395.724459630912, -1011.7876529282064, -825.4087078590035, -857.0388458787253, -342.34611136148123, -872.846382064238, -942.6912656327481, -628.1894933755301, -338.22396101352285, -1013.9906670736688, -962.7713600528436, -747.0256702529341, -646.496557562358, -848.8539558723636, -365.8395423021414, -918.5796651835531, -578.743718167018, -153.51448159921313, -930.7826329373563, -1145.5430601643582, -33.76814841752279, -317.6913851008433, -547.2560875983474, -961.6792985510809, -192.59123840881333, -1062.624033571662, -277.48969903262, -808.9240841271458, -835.9535774544092, -754.9207909647166, -885.4986905717675, -1069.6755165236113, -1094.8599871324145, -721.9297052046334, -782.7246019398252, -768.4460074350802, -575.7962911662555, -864.7292040989955, -385.01091722421074, -1038.0360784892944, -412.90699598125275, -828.5268456000676, -938.7683166912071, -873.3607068168474, -908.3705638652947, -71.82853764453994, -203.24487709573884, -888.700949825263, -1199.915563766902, -936.9606049692001, -786.5867901291306, -979.4180308427156, -670.832428359889, -834.6559957192156, -744.2943343203464, -527.5817384771825, -83.54756984215258, -645.9190369065112, -1181.4851716337955, -1092.3012870014475, -763.6898663177637, -983.3840704161843, -378.01065320305116, -1026.9622637542232, -831.361010031071, -876.3725907011051, -498.97467918146964, -784.149192786371, -559.6908495228228, -573.3842893046178, -1109.3966876781597, -1027.5420292011631, -401.0540655714209, -64.38525602005892, -753.018455508977, -535.6915650437211, -348.16151452750677, -87.97209311164892, -795.1355563488238, -624.9961052652357, -536.8398095262226, -391.20311790264117, -778.5930053364376, -821.3406694176296, -656.911878653103, -628.4302688533876, -425.7156853072061, -438.9498193137315, -914.5037728364942, -342.5797431958233, -751.3985527388942, -534.9061697909989, -928.1118336353145, -279.3370976334351, -845.0250684248645, -106.34409733529249, -648.4683602109045, -345.56445284231427, -1124.2896312678645, -557.1172318700189, -1184.3702524620662, -725.3526174353352, -486.212711116028, -1005.5152559189573, -1017.6474250864788, -1099.0008694186502, -976.6197449057182, -910.8907207004114, -521.9613523359621, -635.7130411445643, -464.6485026362718, -584.3380665996364, -633.5797114642328, -957.0327763605723, -1203.9995418126439, -613.8477945254924, -259.19924681333015, -524.7679576047254, -501.68695629842335, -35.4140744267488, -1082.5930200188698, -866.546704731361, -1297.3565390715064, -775.099318392261, -465.69101599631284, -785.475389463978, -256.30386268268876, -822.5460959363396, -31.777926591395634, -286.8126024400989, -873.6255737722505, -665.5419389891148, -975.6672289497423, -652.7284439358119, -701.3202249462581, -899.873515050838, -204.03820497884865, -1217.5913342826389, -603.6251509064598, -920.3386734089606, -24.38504975817548, -725.2741206477504, -881.8991689360133, -708.3761968638385, -728.7331821857429, -531.6395606492777, -620.2535376014969, -500.91978158100454, -1014.5863640900269, -703.3455649388916, -681.3983597618466, -601.6505758120239, -1279.5007638455947, -820.1576043966321, -389.9012229316454, -207.26903761075414, -742.1591769513714, -650.9440769613186, -893.5429361693954, -472.40669592299787, -811.5415809630613, -855.7465784632838, -881.5551420435692, -972.8230553868408, -910.4124745801557, -891.7685947798468, -381.6838162057152, -179.29089222016495, -902.245561941392, -859.4131543871368, -1017.8719241628012, -653.0732587624184, -988.5078375238747, -1228.5951002413872, -907.1840417116094, -352.3013094274263, -79.7096363656426, -193.3940611545569, -408.7181387237262, -705.3319670974413, -691.8375839907176, -464.5505236175067, -616.2686501549186, -626.7794422842752, -902.7979071273853, -856.5363922740436, -386.6198252419472, -1103.5237385442654, -1106.6476250180774, -17.21785497220013, -344.96177397529596, -1111.8671945135209, -990.692053495454, -412.41628643842273, -292.0133262072176, -590.6478165793042, -798.0504940088384, -736.8659969431382, -1187.6719426418479, -490.72884129859955, -1002.8075661793241, -624.3345470639279, -1162.3340615668642, -1262.146246437698, -488.9276221759791, -558.3184944228765, -668.8686015766657, -760.5265046661774, -130.7965347621735, -63.12786068992388, -596.630852977164, -882.6539028248803, -43.96963277679163, -740.7858743170589, -927.8707846248672, -72.18075781502203, -746.7981845025915, -100.71462794932042, -916.9538735544627, -616.4499590702359, -252.7425394108809, -769.7343540798224, -918.5755715288684, -1133.4499570021383, -49.35121609113103, -224.23270018885228, -533.6384297148048, -1027.8783081628505, -668.6778445608137, -833.9869491349822, -672.2634717633639, -875.3504888548462, -960.7830406605818, -548.4253072274071, -329.9554627568621, -78.15629803472358, -369.32678454757627, -904.0379946557545, -509.99306889518596, -131.91157212672232, -938.5989475161111, -908.3330394542829, -1118.8646872501943, -885.871557382239, -320.6967065226404, -1231.1891628574595, -1026.9048107947065, -629.5194231776696, -948.6310230052957, -353.4817063041003, -748.4579036333497, -1118.1829295396453, -306.01743511422177, -201.8764500175399, -633.8880155442538, -357.9331190702171, -572.7824763107524, -453.9000856707187, -27.566111908263554, -851.9350711210546, -343.462807716374, -1042.7228152388755, -872.7721930451114, -588.8381928718015, -586.4550719574771, -419.30583792834346, -1069.8046009473978, -611.1633499240538, -783.3737073132888, -47.04374462735431, -663.3324399595094, -885.1120788112999, -102.8031825506513, -429.3224165256149, -690.5963042400424, -570.6333702392858, -783.9882282086832, -757.3347463713933, -179.40090294231396, -290.2822329956516, -331.44880513032797, -993.4085235084398, -688.3326647081735, -463.47588949473317, -365.7041896058832, -550.3494153743198, -1014.0665149837048, -733.0379144916161, -782.6470400498946, -217.13101881379427, -736.6744075635314, -820.5288717968295, -958.374816204412, -386.2834056463266, -140.37797753282297, -958.007492744449, -1161.153639641362, -919.8191347811855, -739.2321380991705, -643.6408916637253, -695.6395996051922, -874.9230262944006, -825.8969153807138, -535.3554489773271, -470.2166698632651, -1246.2389334524353, -404.89916605111745, -323.63078614611953, -165.40229805754313, -481.3689333294825, -708.3829294545657, -621.8672522481609, -395.4869663442258, -1191.4155209211722, -1126.8026544865925, -1037.2850350156082, -1033.2126661689563, -845.6846402451614, -913.9589457590115, -981.3304466190976, -47.82464581544931, -1096.44931115521, -29.32975610993979, -192.90652584119204, -72.67911635130258, -266.493456892846, -769.5938214164619, -1200.7573853308315, -646.1263105320971, -192.69841232678357, -531.020753814879, -765.982770147042, -951.3068964041839, -797.6178173495744, -703.1293244144771, -1214.2296994882938, -337.1573846294436, -896.9094589083734, -175.37314691795095, -449.1595188179943, -647.6856975706419, -1085.5037340249753, -780.5054694979758, -586.7535577018914, -458.6098157728294, -392.3819807659093, -356.49682046027647, -846.210718330931, -952.7253022688448, -186.88429281660885, -992.6036935630318, -954.8043659974015, -793.7659060654864, -794.8343629535171, -621.9880768385382, -133.14719408338283, -928.7340239901603, -862.0264227744098, -218.15149667496704, -295.51786921008005, -213.67323390177103, -806.2279052782206, -875.7407207532161, -357.54257237950253, -893.7600689376895, -586.8699826046412, -1127.0984592373097, -397.63630447091765, -792.3753429487114, -921.9381586402491, -322.35983274546976, -1159.8996251372473, -533.4685548500438, -510.4502918982241, -1086.3523086854702, -560.2635741405466, -554.2275378083308, -973.2824920054327, -874.636915855359, -874.082862746194, -1067.7752164546696, -768.5103517685113, -200.4733817974795, -902.8641247510018, -39.238998385445186, -526.827872821334, -697.4585522559621, -724.0845204401484, -923.180718930228, -120.53798697453827, -950.2692345279702, -448.7719133879052, -307.2994515883432, -376.8765599490517, -719.8846580002195, -105.94001806539562, -496.2428765804919, -953.9510592426475, -912.136683159721, -911.415933686034, -923.1435106299559, -968.926043132977, -482.7184946269256, -1046.9267561657086, -892.4917185885822, -470.63343651164257, -99.22934033927048, -305.7423843122727, -646.3694986105178, -956.0585983854861, -1025.347805312853, -824.2266008080768, -863.2226567072178, -685.2974180557247, -950.6416348413425, -929.8078934891764, -355.0585552745759, -9.070414927008638, -754.1240652073925, -573.8983460590043, -874.4862784676872, -404.08566972255977, -699.2911888572678, -819.3017323774989, -828.5845867907219, -826.3805946620997, -614.9129248636297, -373.4112368029966, -693.2528605799748, -287.07979716541695, -699.9100284351285, -734.8535536389219, -496.1880838693048, -463.1176157231391, -1206.1444987961295, -282.83531901270317, -1013.0272613030724, -1130.617637940863, -881.8002166190273, -394.0505829860754, -633.6499701222722, -609.9011227231749, -882.6759288717352, -1048.2025731777878, -683.1802341569359, -902.3357462897825, -785.1044523254, -76.14812433082147, -596.8850773314458, -686.7536646554802, -59.44768927901292, -745.9804129075321, -662.8292138315035, -372.09457413112426, -943.4489888876694, -628.3685841342159, -462.81067030232236, -436.64656526713804, -946.3588489891885, -624.6234650302409, -675.1222655938986, -640.8524715553498, -993.7654818866417, -44.396031104738526, -679.2279493323632]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6717752320783905, "mean_inference_ms": 1.7780621855520067, "mean_action_processing_ms": 1.0190331729279152, "mean_env_wait_ms": 11.158029433125716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016197919845581055, "StateBufferConnector_ms": 0.012239456176757812, "ViewRequirementAgentConnector_ms": 0.4863300323486328}, "num_episodes": 40, "episode_return_max": -1439.1893552730935, "episode_return_min": -4811.471733807839, "episode_return_mean": -3352.214817082576, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168303, "num_agent_steps_trained": 168303, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.5466660951759, "num_env_steps_trained_throughput_per_sec": 67.5466660951759, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 168303, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168303, "timers": {"training_iteration_time_ms": 52906.624, "restore_workers_time_ms": 0.031, "training_step_time_ms": 52906.547, "sample_time_ms": 3517.356, "learn_time_ms": 49331.963, "learn_throughput": 81.083, "synch_weights_time_ms": 54.053}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 168303, "num_agent_steps_trained": 168303}, "done": false, "training_iteration": 9, "trial_id": "05c72_00000", "date": "2024-07-26_14-50-54", "timestamp": 1721985654, "time_this_iter_s": 59.23012161254883, "time_total_s": 476.2584753036499, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d28052a170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 476.2584753036499, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 10.707142857142857, "ram_util_percent": 32.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.54264861198612, "cur_kl_coeff": 0.1, "cur_lr": 0.0010000000000000002, "total_loss": 5.572868052291657, "policy_loss": -0.002258547133884874, "vf_loss": 5.5874561467426735, "vf_explained_var": 0.9729742122843228, "kl": 0.01672858316499614, "entropy": 1.4002403814787299, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.18791946308725, "num_grad_updates_lifetime": 41865.5, "diff_num_grad_updates_vs_sampler_policy": 2234.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 187254, "num_agent_steps_trained": 187254}, "env_runners": {"episode_reward_max": -1439.1893552730935, "episode_reward_min": -4811.471733807839, "episode_reward_mean": -3298.148150941771, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1326.8906998523094}, "policy_reward_max": {"policy_0": -4.291194708156312}, "policy_reward_mean": {"policy_0": -659.6296301883542}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3292.5716014963955, -3355.3964939797825, -2391.9568342969383, -3184.8884808360335, -2750.1792895066387, -3338.778722223505, -2781.7837735263975, -4419.098262018869, -4144.185728505304, -3843.598598873359, -1934.916029668721, -4487.286598210308, -2182.9158771145026, -3868.883410593177, -3845.4668786277466, -3068.667718391519, -3370.7448088606952, -3772.608526747745, -2966.321923615838, -4432.078831436904, -3214.4020195342578, -4795.232162402093, -1739.4551127687957, -3302.234107174806, -3470.5454360505337, -3151.950634629911, -3803.9650914717226, -4540.550043423791, -2181.637996117816, -3191.911047520761, -2453.0974028916307, -3123.853638112837, -3288.4142317623023, -3386.77777126306, -1993.4257182599597, -4172.364938125467, -4189.726126139229, -3008.422733849009, -2264.116864081005, -3434.251080829641, -2930.691240740439, -2771.1664220871176, -2581.639480757329, -2842.3700724475575, -3297.2319037133316, -3042.239478743921, -4421.853296929892, -3402.031660120904, -2621.5401170366968, -4043.955323454715, -4811.471733807839, -1439.1893552730935, -3075.6693864990198, -3749.05756213016, -3072.8292087620575, -3559.058274568317, -2734.6991146425685, -4157.99640541798, -2437.5770067329995, -3146.9445012503993, -3825.9182479018295, -3612.530613316452, -3836.493382555864, -2978.8620731571086, -2992.089651422208, -2803.1018174534906, -3379.6865707342927, -4314.206523144152, -2478.0332581591874, -4348.736115725215, -2621.959274957159, -3625.7494562157353, -2795.0374140741183, -3600.2137804626236, -3702.3310178617394, -3857.60982905191, -3047.2270649329325, -2783.800879036842, -3098.808133723109, -3033.3641994729896, -4791.378728936275, -2987.6188563117007, -3093.546745664367, -2764.294403022369, -2585.172352151005, -2364.8158344455337, -3332.51165756653, -3886.107953870257, -3817.212215107433, -2651.481265147997, -3346.4383643799742, -4213.302331019427, -2060.524961443456, -2945.4370092160752, -3239.52962861429, -2860.609875269437, -4208.8639247794545, -4760.924782255286, -3318.1099602385416, -3573.3008513233785], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-876.3725907011051, -498.97467918146964, -784.149192786371, -559.6908495228228, -573.3842893046178, -1109.3966876781597, -1027.5420292011631, -401.0540655714209, -64.38525602005892, -753.018455508977, -535.6915650437211, -348.16151452750677, -87.97209311164892, -795.1355563488238, -624.9961052652357, -536.8398095262226, -391.20311790264117, -778.5930053364376, -821.3406694176296, -656.911878653103, -628.4302688533876, -425.7156853072061, -438.9498193137315, -914.5037728364942, -342.5797431958233, -751.3985527388942, -534.9061697909989, -928.1118336353145, -279.3370976334351, -845.0250684248645, -106.34409733529249, -648.4683602109045, -345.56445284231427, -1124.2896312678645, -557.1172318700189, -1184.3702524620662, -725.3526174353352, -486.212711116028, -1005.5152559189573, -1017.6474250864788, -1099.0008694186502, -976.6197449057182, -910.8907207004114, -521.9613523359621, -635.7130411445643, -464.6485026362718, -584.3380665996364, -633.5797114642328, -957.0327763605723, -1203.9995418126439, -613.8477945254924, -259.19924681333015, -524.7679576047254, -501.68695629842335, -35.4140744267488, -1082.5930200188698, -866.546704731361, -1297.3565390715064, -775.099318392261, -465.69101599631284, -785.475389463978, -256.30386268268876, -822.5460959363396, -31.777926591395634, -286.8126024400989, -873.6255737722505, -665.5419389891148, -975.6672289497423, -652.7284439358119, -701.3202249462581, -899.873515050838, -204.03820497884865, -1217.5913342826389, -603.6251509064598, -920.3386734089606, -24.38504975817548, -725.2741206477504, -881.8991689360133, -708.3761968638385, -728.7331821857429, -531.6395606492777, -620.2535376014969, -500.91978158100454, -1014.5863640900269, -703.3455649388916, -681.3983597618466, -601.6505758120239, -1279.5007638455947, -820.1576043966321, -389.9012229316454, -207.26903761075414, -742.1591769513714, -650.9440769613186, -893.5429361693954, -472.40669592299787, -811.5415809630613, -855.7465784632838, -881.5551420435692, -972.8230553868408, -910.4124745801557, -891.7685947798468, -381.6838162057152, -179.29089222016495, -902.245561941392, -859.4131543871368, -1017.8719241628012, -653.0732587624184, -988.5078375238747, -1228.5951002413872, -907.1840417116094, -352.3013094274263, -79.7096363656426, -193.3940611545569, -408.7181387237262, -705.3319670974413, -691.8375839907176, -464.5505236175067, -616.2686501549186, -626.7794422842752, -902.7979071273853, -856.5363922740436, -386.6198252419472, -1103.5237385442654, -1106.6476250180774, -17.21785497220013, -344.96177397529596, -1111.8671945135209, -990.692053495454, -412.41628643842273, -292.0133262072176, -590.6478165793042, -798.0504940088384, -736.8659969431382, -1187.6719426418479, -490.72884129859955, -1002.8075661793241, -624.3345470639279, -1162.3340615668642, -1262.146246437698, -488.9276221759791, -558.3184944228765, -668.8686015766657, -760.5265046661774, -130.7965347621735, -63.12786068992388, -596.630852977164, -882.6539028248803, -43.96963277679163, -740.7858743170589, -927.8707846248672, -72.18075781502203, -746.7981845025915, -100.71462794932042, -916.9538735544627, -616.4499590702359, -252.7425394108809, -769.7343540798224, -918.5755715288684, -1133.4499570021383, -49.35121609113103, -224.23270018885228, -533.6384297148048, -1027.8783081628505, -668.6778445608137, -833.9869491349822, -672.2634717633639, -875.3504888548462, -960.7830406605818, -548.4253072274071, -329.9554627568621, -78.15629803472358, -369.32678454757627, -904.0379946557545, -509.99306889518596, -131.91157212672232, -938.5989475161111, -908.3330394542829, -1118.8646872501943, -885.871557382239, -320.6967065226404, -1231.1891628574595, -1026.9048107947065, -629.5194231776696, -948.6310230052957, -353.4817063041003, -748.4579036333497, -1118.1829295396453, -306.01743511422177, -201.8764500175399, -633.8880155442538, -357.9331190702171, -572.7824763107524, -453.9000856707187, -27.566111908263554, -851.9350711210546, -343.462807716374, -1042.7228152388755, -872.7721930451114, -588.8381928718015, -586.4550719574771, -419.30583792834346, -1069.8046009473978, -611.1633499240538, -783.3737073132888, -47.04374462735431, -663.3324399595094, -885.1120788112999, -102.8031825506513, -429.3224165256149, -690.5963042400424, -570.6333702392858, -783.9882282086832, -757.3347463713933, -179.40090294231396, -290.2822329956516, -331.44880513032797, -993.4085235084398, -688.3326647081735, -463.47588949473317, -365.7041896058832, -550.3494153743198, -1014.0665149837048, -733.0379144916161, -782.6470400498946, -217.13101881379427, -736.6744075635314, -820.5288717968295, -958.374816204412, -386.2834056463266, -140.37797753282297, -958.007492744449, -1161.153639641362, -919.8191347811855, -739.2321380991705, -643.6408916637253, -695.6395996051922, -874.9230262944006, -825.8969153807138, -535.3554489773271, -470.2166698632651, -1246.2389334524353, -404.89916605111745, -323.63078614611953, -165.40229805754313, -481.3689333294825, -708.3829294545657, -621.8672522481609, -395.4869663442258, -1191.4155209211722, -1126.8026544865925, -1037.2850350156082, -1033.2126661689563, -845.6846402451614, -913.9589457590115, -981.3304466190976, -47.82464581544931, -1096.44931115521, -29.32975610993979, -192.90652584119204, -72.67911635130258, -266.493456892846, -769.5938214164619, -1200.7573853308315, -646.1263105320971, -192.69841232678357, -531.020753814879, -765.982770147042, -951.3068964041839, -797.6178173495744, -703.1293244144771, -1214.2296994882938, -337.1573846294436, -896.9094589083734, -175.37314691795095, -449.1595188179943, -647.6856975706419, -1085.5037340249753, -780.5054694979758, -586.7535577018914, -458.6098157728294, -392.3819807659093, -356.49682046027647, -846.210718330931, -952.7253022688448, -186.88429281660885, -992.6036935630318, -954.8043659974015, -793.7659060654864, -794.8343629535171, -621.9880768385382, -133.14719408338283, -928.7340239901603, -862.0264227744098, -218.15149667496704, -295.51786921008005, -213.67323390177103, -806.2279052782206, -875.7407207532161, -357.54257237950253, -893.7600689376895, -586.8699826046412, -1127.0984592373097, -397.63630447091765, -792.3753429487114, -921.9381586402491, -322.35983274546976, -1159.8996251372473, -533.4685548500438, -510.4502918982241, -1086.3523086854702, -560.2635741405466, -554.2275378083308, -973.2824920054327, -874.636915855359, -874.082862746194, -1067.7752164546696, -768.5103517685113, -200.4733817974795, -902.8641247510018, -39.238998385445186, -526.827872821334, -697.4585522559621, -724.0845204401484, -923.180718930228, -120.53798697453827, -950.2692345279702, -448.7719133879052, -307.2994515883432, -376.8765599490517, -719.8846580002195, -105.94001806539562, -496.2428765804919, -953.9510592426475, -912.136683159721, -911.415933686034, -923.1435106299559, -968.926043132977, -482.7184946269256, -1046.9267561657086, -892.4917185885822, -470.63343651164257, -99.22934033927048, -305.7423843122727, -646.3694986105178, -956.0585983854861, -1025.347805312853, -824.2266008080768, -863.2226567072178, -685.2974180557247, -950.6416348413425, -929.8078934891764, -355.0585552745759, -9.070414927008638, -754.1240652073925, -573.8983460590043, -874.4862784676872, -404.08566972255977, -699.2911888572678, -819.3017323774989, -828.5845867907219, -826.3805946620997, -614.9129248636297, -373.4112368029966, -693.2528605799748, -287.07979716541695, -699.9100284351285, -734.8535536389219, -496.1880838693048, -463.1176157231391, -1206.1444987961295, -282.83531901270317, -1013.0272613030724, -1130.617637940863, -881.8002166190273, -394.0505829860754, -633.6499701222722, -609.9011227231749, -882.6759288717352, -1048.2025731777878, -683.1802341569359, -902.3357462897825, -785.1044523254, -76.14812433082147, -596.8850773314458, -686.7536646554802, -59.44768927901292, -745.9804129075321, -662.8292138315035, -372.09457413112426, -943.4489888876694, -628.3685841342159, -462.81067030232236, -436.64656526713804, -946.3588489891885, -624.6234650302409, -675.1222655938986, -640.8524715553498, -993.7654818866417, -44.396031104738526, -679.2279493323632, -386.68886923669595, -954.4708284708915, -1170.741487667282, -1064.2510498183938, -1215.2264937430102, -340.3728601358977, -316.79376006924684, -708.5233565422409, -641.3510669210038, -980.5778126433116, -668.4371025716074, -297.2622468736975, -524.5838531755601, -786.8529921030614, -816.4105509404395, -321.690440880538, -978.3482696309992, -783.6851372770782, -569.9788281298532, -110.59172710389892, -801.7048842861328, -1042.070178745036, -246.92771610262162, -490.1783783090569, -4.291194708156312, -361.7004167722715, -111.71162783223177, -387.33200858906133, -963.9663676379556, -540.1054136140126, -578.1860464908783, -1326.8906998523094, -760.8783962586479, -493.2083392427645, -173.3481757219286, -1036.1382415120515, -972.2714796519349, -871.7587199439001, -672.4592440561954, -333.4802687061806, -854.0110744625097, -798.7784140829132, -608.0393983669983, -912.8243315995467, -643.5589965954674, -275.99863044723645, -286.75674329271953, -584.9987566844095, -389.3448722153083, -1114.3822625083253, -472.25307874312455, -878.1783797099022, -576.8821621939966, -540.1319812738155, -878.9927624591372, -719.4984132186248, -869.7153644462935, -664.8503647629079, -984.4439684331232, -974.7942201584784, -793.0301212135936, -645.504186342497, -200.28586042199373, -96.47523061834167, -325.22956284702724, -345.17148390361194, -483.47999032579014, -1255.9935945473371, -35.22825963971651, -825.5636807996203, -1033.227328157649, -333.2775429605135, -731.5863584098649, -187.8918310835544, -953.5465680027115, -496.6496379901941, -520.9409025869954, -312.03188148369543, -1178.4182355942785, -352.5692176142766, -478.79335250707686, -1094.5206530230496, -914.5985767550692, -538.2123561038599, -1182.7389863903954, -1018.3254951683876, -787.9969169418813, -982.0392432649713, -1023.3569386571754, -949.2061882228733, -583.072131630898, -366.1359365821123, -814.6101297829551, -738.7620323188462, -815.5297299237317, -136.18379099617266, -581.7186131269491, -1031.3387633632083, -786.8702621579403, -1037.1894216791084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6728369275301065, "mean_inference_ms": 1.770077674856861, "mean_action_processing_ms": 0.9964605737338884, "mean_env_wait_ms": 11.128004498080893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016681194305419922, "StateBufferConnector_ms": 0.012522697448730469, "ViewRequirementAgentConnector_ms": 0.4996159076690674}, "num_episodes": 20, "episode_return_max": -1439.1893552730935, "episode_return_min": -4811.471733807839, "episode_return_mean": -3298.148150941771, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187254, "num_agent_steps_trained": 187254, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.14190643289831, "num_env_steps_trained_throughput_per_sec": 72.14190643289831, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 187254, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 187254, "timers": {"training_iteration_time_ms": 53160.59, "restore_workers_time_ms": 0.031, "training_step_time_ms": 53160.514, "sample_time_ms": 3515.542, "learn_time_ms": 49588.02, "learn_throughput": 80.665, "synch_weights_time_ms": 53.752}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 187254, "num_agent_steps_trained": 187254}, "done": false, "training_iteration": 10, "trial_id": "05c72_00000", "date": "2024-07-26_14-51-50", "timestamp": 1721985710, "time_this_iter_s": 55.45707297325134, "time_total_s": 531.7155482769012, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805a8ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 531.7155482769012, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 11.378481012658227, "ram_util_percent": 32.970886075949366}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 168.6701410942337, "cur_kl_coeff": 0.09999999999999998, "cur_lr": 0.001, "total_loss": 5.219307811081815, "policy_loss": -0.0032785366222794566, "vf_loss": 5.235826079321016, "vf_explained_var": 0.9794187441164134, "kl": 0.017554149115162475, "entropy": 1.4995144644291762, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.60544217687075, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 2204.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 206012, "num_agent_steps_trained": 206012}, "env_runners": {"episode_reward_max": -1439.1893552730935, "episode_reward_min": -4811.471733807839, "episode_reward_mean": -3316.1247275507553, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1351.129491146495}, "policy_reward_max": {"policy_0": -4.291194708156312}, "policy_reward_mean": {"policy_0": -663.2249455101511}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3214.4020195342578, -4795.232162402093, -1739.4551127687957, -3302.234107174806, -3470.5454360505337, -3151.950634629911, -3803.9650914717226, -4540.550043423791, -2181.637996117816, -3191.911047520761, -2453.0974028916307, -3123.853638112837, -3288.4142317623023, -3386.77777126306, -1993.4257182599597, -4172.364938125467, -4189.726126139229, -3008.422733849009, -2264.116864081005, -3434.251080829641, -2930.691240740439, -2771.1664220871176, -2581.639480757329, -2842.3700724475575, -3297.2319037133316, -3042.239478743921, -4421.853296929892, -3402.031660120904, -2621.5401170366968, -4043.955323454715, -4811.471733807839, -1439.1893552730935, -3075.6693864990198, -3749.05756213016, -3072.8292087620575, -3559.058274568317, -2734.6991146425685, -4157.99640541798, -2437.5770067329995, -3146.9445012503993, -3825.9182479018295, -3612.530613316452, -3836.493382555864, -2978.8620731571086, -2992.089651422208, -2803.1018174534906, -3379.6865707342927, -4314.206523144152, -2478.0332581591874, -4348.736115725215, -2621.959274957159, -3625.7494562157353, -2795.0374140741183, -3600.2137804626236, -3702.3310178617394, -3857.60982905191, -3047.2270649329325, -2783.800879036842, -3098.808133723109, -3033.3641994729896, -4791.378728936275, -2987.6188563117007, -3093.546745664367, -2764.294403022369, -2585.172352151005, -2364.8158344455337, -3332.51165756653, -3886.107953870257, -3817.212215107433, -2651.481265147997, -3346.4383643799742, -4213.302331019427, -2060.524961443456, -2945.4370092160752, -3239.52962861429, -2860.609875269437, -4208.8639247794545, -4760.924782255286, -3318.1099602385416, -3573.3008513233785, -3293.349550904832, -3899.643737274107, -3318.837430899642, -3476.3972503225723, -3510.1238589126847, -2420.1175750486254, -2910.1485235457953, -3643.392098440458, -3260.3848728542666, -3796.398819383254, -3283.452002004411, -3320.528395162598, -4654.6719361603655, -4114.867882604948, -4291.422771306998, -4062.350692901794, -2812.9257201161117, -3025.5132555497876, -3832.6012274123505, -2302.8584486232385], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-891.7685947798468, -381.6838162057152, -179.29089222016495, -902.245561941392, -859.4131543871368, -1017.8719241628012, -653.0732587624184, -988.5078375238747, -1228.5951002413872, -907.1840417116094, -352.3013094274263, -79.7096363656426, -193.3940611545569, -408.7181387237262, -705.3319670974413, -691.8375839907176, -464.5505236175067, -616.2686501549186, -626.7794422842752, -902.7979071273853, -856.5363922740436, -386.6198252419472, -1103.5237385442654, -1106.6476250180774, -17.21785497220013, -344.96177397529596, -1111.8671945135209, -990.692053495454, -412.41628643842273, -292.0133262072176, -590.6478165793042, -798.0504940088384, -736.8659969431382, -1187.6719426418479, -490.72884129859955, -1002.8075661793241, -624.3345470639279, -1162.3340615668642, -1262.146246437698, -488.9276221759791, -558.3184944228765, -668.8686015766657, -760.5265046661774, -130.7965347621735, -63.12786068992388, -596.630852977164, -882.6539028248803, -43.96963277679163, -740.7858743170589, -927.8707846248672, -72.18075781502203, -746.7981845025915, -100.71462794932042, -916.9538735544627, -616.4499590702359, -252.7425394108809, -769.7343540798224, -918.5755715288684, -1133.4499570021383, -49.35121609113103, -224.23270018885228, -533.6384297148048, -1027.8783081628505, -668.6778445608137, -833.9869491349822, -672.2634717633639, -875.3504888548462, -960.7830406605818, -548.4253072274071, -329.9554627568621, -78.15629803472358, -369.32678454757627, -904.0379946557545, -509.99306889518596, -131.91157212672232, -938.5989475161111, -908.3330394542829, -1118.8646872501943, -885.871557382239, -320.6967065226404, -1231.1891628574595, -1026.9048107947065, -629.5194231776696, -948.6310230052957, -353.4817063041003, -748.4579036333497, -1118.1829295396453, -306.01743511422177, -201.8764500175399, -633.8880155442538, -357.9331190702171, -572.7824763107524, -453.9000856707187, -27.566111908263554, -851.9350711210546, -343.462807716374, -1042.7228152388755, -872.7721930451114, -588.8381928718015, -586.4550719574771, -419.30583792834346, -1069.8046009473978, -611.1633499240538, -783.3737073132888, -47.04374462735431, -663.3324399595094, -885.1120788112999, -102.8031825506513, -429.3224165256149, -690.5963042400424, -570.6333702392858, -783.9882282086832, -757.3347463713933, -179.40090294231396, -290.2822329956516, -331.44880513032797, -993.4085235084398, -688.3326647081735, -463.47588949473317, -365.7041896058832, -550.3494153743198, -1014.0665149837048, -733.0379144916161, -782.6470400498946, -217.13101881379427, -736.6744075635314, -820.5288717968295, -958.374816204412, -386.2834056463266, -140.37797753282297, -958.007492744449, -1161.153639641362, -919.8191347811855, -739.2321380991705, -643.6408916637253, -695.6395996051922, -874.9230262944006, -825.8969153807138, -535.3554489773271, -470.2166698632651, -1246.2389334524353, -404.89916605111745, -323.63078614611953, -165.40229805754313, -481.3689333294825, -708.3829294545657, -621.8672522481609, -395.4869663442258, -1191.4155209211722, -1126.8026544865925, -1037.2850350156082, -1033.2126661689563, -845.6846402451614, -913.9589457590115, -981.3304466190976, -47.82464581544931, -1096.44931115521, -29.32975610993979, -192.90652584119204, -72.67911635130258, -266.493456892846, -769.5938214164619, -1200.7573853308315, -646.1263105320971, -192.69841232678357, -531.020753814879, -765.982770147042, -951.3068964041839, -797.6178173495744, -703.1293244144771, -1214.2296994882938, -337.1573846294436, -896.9094589083734, -175.37314691795095, -449.1595188179943, -647.6856975706419, -1085.5037340249753, -780.5054694979758, -586.7535577018914, -458.6098157728294, -392.3819807659093, -356.49682046027647, -846.210718330931, -952.7253022688448, -186.88429281660885, -992.6036935630318, -954.8043659974015, -793.7659060654864, -794.8343629535171, -621.9880768385382, -133.14719408338283, -928.7340239901603, -862.0264227744098, -218.15149667496704, -295.51786921008005, -213.67323390177103, -806.2279052782206, -875.7407207532161, -357.54257237950253, -893.7600689376895, -586.8699826046412, -1127.0984592373097, -397.63630447091765, -792.3753429487114, -921.9381586402491, -322.35983274546976, -1159.8996251372473, -533.4685548500438, -510.4502918982241, -1086.3523086854702, -560.2635741405466, -554.2275378083308, -973.2824920054327, -874.636915855359, -874.082862746194, -1067.7752164546696, -768.5103517685113, -200.4733817974795, -902.8641247510018, -39.238998385445186, -526.827872821334, -697.4585522559621, -724.0845204401484, -923.180718930228, -120.53798697453827, -950.2692345279702, -448.7719133879052, -307.2994515883432, -376.8765599490517, -719.8846580002195, -105.94001806539562, -496.2428765804919, -953.9510592426475, -912.136683159721, -911.415933686034, -923.1435106299559, -968.926043132977, -482.7184946269256, -1046.9267561657086, -892.4917185885822, -470.63343651164257, -99.22934033927048, -305.7423843122727, -646.3694986105178, -956.0585983854861, -1025.347805312853, -824.2266008080768, -863.2226567072178, -685.2974180557247, -950.6416348413425, -929.8078934891764, -355.0585552745759, -9.070414927008638, -754.1240652073925, -573.8983460590043, -874.4862784676872, -404.08566972255977, -699.2911888572678, -819.3017323774989, -828.5845867907219, -826.3805946620997, -614.9129248636297, -373.4112368029966, -693.2528605799748, -287.07979716541695, -699.9100284351285, -734.8535536389219, -496.1880838693048, -463.1176157231391, -1206.1444987961295, -282.83531901270317, -1013.0272613030724, -1130.617637940863, -881.8002166190273, -394.0505829860754, -633.6499701222722, -609.9011227231749, -882.6759288717352, -1048.2025731777878, -683.1802341569359, -902.3357462897825, -785.1044523254, -76.14812433082147, -596.8850773314458, -686.7536646554802, -59.44768927901292, -745.9804129075321, -662.8292138315035, -372.09457413112426, -943.4489888876694, -628.3685841342159, -462.81067030232236, -436.64656526713804, -946.3588489891885, -624.6234650302409, -675.1222655938986, -640.8524715553498, -993.7654818866417, -44.396031104738526, -679.2279493323632, -386.68886923669595, -954.4708284708915, -1170.741487667282, -1064.2510498183938, -1215.2264937430102, -340.3728601358977, -316.79376006924684, -708.5233565422409, -641.3510669210038, -980.5778126433116, -668.4371025716074, -297.2622468736975, -524.5838531755601, -786.8529921030614, -816.4105509404395, -321.690440880538, -978.3482696309992, -783.6851372770782, -569.9788281298532, -110.59172710389892, -801.7048842861328, -1042.070178745036, -246.92771610262162, -490.1783783090569, -4.291194708156312, -361.7004167722715, -111.71162783223177, -387.33200858906133, -963.9663676379556, -540.1054136140126, -578.1860464908783, -1326.8906998523094, -760.8783962586479, -493.2083392427645, -173.3481757219286, -1036.1382415120515, -972.2714796519349, -871.7587199439001, -672.4592440561954, -333.4802687061806, -854.0110744625097, -798.7784140829132, -608.0393983669983, -912.8243315995467, -643.5589965954674, -275.99863044723645, -286.75674329271953, -584.9987566844095, -389.3448722153083, -1114.3822625083253, -472.25307874312455, -878.1783797099022, -576.8821621939966, -540.1319812738155, -878.9927624591372, -719.4984132186248, -869.7153644462935, -664.8503647629079, -984.4439684331232, -974.7942201584784, -793.0301212135936, -645.504186342497, -200.28586042199373, -96.47523061834167, -325.22956284702724, -345.17148390361194, -483.47999032579014, -1255.9935945473371, -35.22825963971651, -825.5636807996203, -1033.227328157649, -333.2775429605135, -731.5863584098649, -187.8918310835544, -953.5465680027115, -496.6496379901941, -520.9409025869954, -312.03188148369543, -1178.4182355942785, -352.5692176142766, -478.79335250707686, -1094.5206530230496, -914.5985767550692, -538.2123561038599, -1182.7389863903954, -1018.3254951683876, -787.9969169418813, -982.0392432649713, -1023.3569386571754, -949.2061882228733, -583.072131630898, -366.1359365821123, -814.6101297829551, -738.7620323188462, -815.5297299237317, -136.18379099617266, -581.7186131269491, -1031.3387633632083, -786.8702621579403, -1037.1894216791084, -505.94089474131283, -351.6270999827168, -317.16605614489305, -767.4860088894125, -1351.129491146495, -1082.9702585168297, -741.3400478483496, -255.82374730411343, -740.1344802033489, -1079.37520340147, -678.1352930023832, -846.0614202092092, -1038.4310519065596, -115.61333363935364, -640.5963321421348, -607.3730355963648, -578.0696115475715, -1162.6076641949912, -220.57846464860498, -907.7684743350393, -63.20601393299582, -807.3289060569978, -1096.883867938425, -610.0522531988537, -932.6528177854101, -619.2043104946958, -596.9320152579483, -138.7551364873173, -283.09499971849124, -782.1311130901737, -922.5275319834914, -299.14547241785255, -988.9820571028283, -232.6194585932712, -466.8740034483502, -1057.9448238768055, -945.2255753880462, -1109.6883965407917, -148.89074689198907, -381.6425557428234, -658.319568626333, -151.31132020846604, -854.3973329763531, -1012.5668659946059, -583.7897850485067, -736.7132139284544, -1212.7598155188125, -409.22642141898837, -981.9252603108121, -455.77410820618167, -872.6343443892963, -620.7166482566557, -787.9017579515704, -409.5302553615857, -592.6689960453043, -323.7984913749126, -421.28370630131997, -992.6041788429748, -729.4798266945218, -853.3621919488718, -1000.2267274610476, -910.2532115797865, -1168.131281513756, -975.466565678185, -600.594149927595, -517.0885827384, -1047.1633132818474, -539.9595182685878, -1053.5551101719113, -957.1013581442005, -685.8672638949647, -599.5733708572392, -1060.8617802166127, -1060.9177427397158, -884.2026135984623, -892.9796796341253, -808.98720522429, -832.3654828720586, -879.1380698830017, -648.8802552883157, -1056.0967315923222, -407.4009365433788, -896.2876112051235, -326.7930347981087, -126.34740597718115, -507.91758319545784, -1030.3073429691583, -743.7996499430127, -612.3333976112561, -131.15528183090353, -832.6792691508778, -846.0571578516949, -456.02059704290957, -937.882170571197, -759.96203279567, -568.2294904230267, -410.3848108101482, -566.9177763034887, -49.465883789003485, -707.8604872975699]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6723582826685344, "mean_inference_ms": 1.7670199130694346, "mean_action_processing_ms": 0.9855902353107947, "mean_env_wait_ms": 11.12488244055359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017134904861450195, "StateBufferConnector_ms": 0.012622594833374023, "ViewRequirementAgentConnector_ms": 0.5015053749084473}, "num_episodes": 20, "episode_return_max": -1439.1893552730935, "episode_return_min": -4811.471733807839, "episode_return_mean": -3316.1247275507553, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206012, "num_agent_steps_trained": 206012, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 67.5451976008973, "num_env_steps_trained_throughput_per_sec": 67.5451976008973, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 206012, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 206012, "timers": {"training_iteration_time_ms": 55616.23, "restore_workers_time_ms": 0.031, "training_step_time_ms": 55616.154, "sample_time_ms": 3508.494, "learn_time_ms": 52048.671, "learn_throughput": 76.851, "synch_weights_time_ms": 55.744}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 206012, "num_agent_steps_trained": 206012}, "done": false, "training_iteration": 11, "trial_id": "05c72_00000", "date": "2024-07-26_14-52-49", "timestamp": 1721985769, "time_this_iter_s": 59.230284452438354, "time_total_s": 590.9458327293396, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d3c3b29ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 590.9458327293396, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 10.774999999999999, "ram_util_percent": 32.93690476190476}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 170.94344734844861, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.001, "total_loss": 5.221769668658575, "policy_loss": -0.0018887778166220062, "vf_loss": 5.238648274084469, "vf_explained_var": 0.9773394145407118, "kl": 0.019370130207814352, "entropy": 1.6926842003792255, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.78378378378379, "num_grad_updates_lifetime": 50730.5, "diff_num_grad_updates_vs_sampler_policy": 2219.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 224924, "num_agent_steps_trained": 224924}, "env_runners": {"episode_reward_max": -1410.0343595136253, "episode_reward_min": -4791.378728936275, "episode_reward_mean": -3374.4993038001207, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1464.5679978935095}, "policy_reward_max": {"policy_0": -4.291194708156312}, "policy_reward_mean": {"policy_0": -674.899860760024}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3825.9182479018295, -3612.530613316452, -3836.493382555864, -2978.8620731571086, -2992.089651422208, -2803.1018174534906, -3379.6865707342927, -4314.206523144152, -2478.0332581591874, -4348.736115725215, -2621.959274957159, -3625.7494562157353, -2795.0374140741183, -3600.2137804626236, -3702.3310178617394, -3857.60982905191, -3047.2270649329325, -2783.800879036842, -3098.808133723109, -3033.3641994729896, -4791.378728936275, -2987.6188563117007, -3093.546745664367, -2764.294403022369, -2585.172352151005, -2364.8158344455337, -3332.51165756653, -3886.107953870257, -3817.212215107433, -2651.481265147997, -3346.4383643799742, -4213.302331019427, -2060.524961443456, -2945.4370092160752, -3239.52962861429, -2860.609875269437, -4208.8639247794545, -4760.924782255286, -3318.1099602385416, -3573.3008513233785, -3293.349550904832, -3899.643737274107, -3318.837430899642, -3476.3972503225723, -3510.1238589126847, -2420.1175750486254, -2910.1485235457953, -3643.392098440458, -3260.3848728542666, -3796.398819383254, -3283.452002004411, -3320.528395162598, -4654.6719361603655, -4114.867882604948, -4291.422771306998, -4062.350692901794, -2812.9257201161117, -3025.5132555497876, -3832.6012274123505, -2302.8584486232385, -4026.4424770177566, -4187.115392040865, -3529.8887952789437, -3641.784523395331, -3215.757448441725, -4333.605561291679, -1410.0343595136253, -3521.605450145862, -3954.1910743396306, -3533.814471815817, -2490.5346832566534, -4342.39271665034, -2916.9240522430878, -4181.3866179642755, -3488.6974108919444, -4047.0471119009485, -3204.458305404955, -3524.875216772993, -3471.975255131047, -2703.739113791626, -2609.5086765760066, -3588.899447356661, -3277.397925255733, -2663.623939223193, -4473.971689052582, -2361.2809391535848, -2229.8704994640216, -4119.374562460537, -2929.8376998835865, -2799.5853235427835, -4337.133109738653, -3611.145677939175, -3100.537297608338, -3176.5502839358332, -4050.243121724794, -2644.354827874478, -3799.2081068369434, -2856.733810005958, -3594.2394203299496, -2733.236931209541], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-586.8699826046412, -1127.0984592373097, -397.63630447091765, -792.3753429487114, -921.9381586402491, -322.35983274546976, -1159.8996251372473, -533.4685548500438, -510.4502918982241, -1086.3523086854702, -560.2635741405466, -554.2275378083308, -973.2824920054327, -874.636915855359, -874.082862746194, -1067.7752164546696, -768.5103517685113, -200.4733817974795, -902.8641247510018, -39.238998385445186, -526.827872821334, -697.4585522559621, -724.0845204401484, -923.180718930228, -120.53798697453827, -950.2692345279702, -448.7719133879052, -307.2994515883432, -376.8765599490517, -719.8846580002195, -105.94001806539562, -496.2428765804919, -953.9510592426475, -912.136683159721, -911.415933686034, -923.1435106299559, -968.926043132977, -482.7184946269256, -1046.9267561657086, -892.4917185885822, -470.63343651164257, -99.22934033927048, -305.7423843122727, -646.3694986105178, -956.0585983854861, -1025.347805312853, -824.2266008080768, -863.2226567072178, -685.2974180557247, -950.6416348413425, -929.8078934891764, -355.0585552745759, -9.070414927008638, -754.1240652073925, -573.8983460590043, -874.4862784676872, -404.08566972255977, -699.2911888572678, -819.3017323774989, -828.5845867907219, -826.3805946620997, -614.9129248636297, -373.4112368029966, -693.2528605799748, -287.07979716541695, -699.9100284351285, -734.8535536389219, -496.1880838693048, -463.1176157231391, -1206.1444987961295, -282.83531901270317, -1013.0272613030724, -1130.617637940863, -881.8002166190273, -394.0505829860754, -633.6499701222722, -609.9011227231749, -882.6759288717352, -1048.2025731777878, -683.1802341569359, -902.3357462897825, -785.1044523254, -76.14812433082147, -596.8850773314458, -686.7536646554802, -59.44768927901292, -745.9804129075321, -662.8292138315035, -372.09457413112426, -943.4489888876694, -628.3685841342159, -462.81067030232236, -436.64656526713804, -946.3588489891885, -624.6234650302409, -675.1222655938986, -640.8524715553498, -993.7654818866417, -44.396031104738526, -679.2279493323632, -386.68886923669595, -954.4708284708915, -1170.741487667282, -1064.2510498183938, -1215.2264937430102, -340.3728601358977, -316.79376006924684, -708.5233565422409, -641.3510669210038, -980.5778126433116, -668.4371025716074, -297.2622468736975, -524.5838531755601, -786.8529921030614, -816.4105509404395, -321.690440880538, -978.3482696309992, -783.6851372770782, -569.9788281298532, -110.59172710389892, -801.7048842861328, -1042.070178745036, -246.92771610262162, -490.1783783090569, -4.291194708156312, -361.7004167722715, -111.71162783223177, -387.33200858906133, -963.9663676379556, -540.1054136140126, -578.1860464908783, -1326.8906998523094, -760.8783962586479, -493.2083392427645, -173.3481757219286, -1036.1382415120515, -972.2714796519349, -871.7587199439001, -672.4592440561954, -333.4802687061806, -854.0110744625097, -798.7784140829132, -608.0393983669983, -912.8243315995467, -643.5589965954674, -275.99863044723645, -286.75674329271953, -584.9987566844095, -389.3448722153083, -1114.3822625083253, -472.25307874312455, -878.1783797099022, -576.8821621939966, -540.1319812738155, -878.9927624591372, -719.4984132186248, -869.7153644462935, -664.8503647629079, -984.4439684331232, -974.7942201584784, -793.0301212135936, -645.504186342497, -200.28586042199373, -96.47523061834167, -325.22956284702724, -345.17148390361194, -483.47999032579014, -1255.9935945473371, -35.22825963971651, -825.5636807996203, -1033.227328157649, -333.2775429605135, -731.5863584098649, -187.8918310835544, -953.5465680027115, -496.6496379901941, -520.9409025869954, -312.03188148369543, -1178.4182355942785, -352.5692176142766, -478.79335250707686, -1094.5206530230496, -914.5985767550692, -538.2123561038599, -1182.7389863903954, -1018.3254951683876, -787.9969169418813, -982.0392432649713, -1023.3569386571754, -949.2061882228733, -583.072131630898, -366.1359365821123, -814.6101297829551, -738.7620323188462, -815.5297299237317, -136.18379099617266, -581.7186131269491, -1031.3387633632083, -786.8702621579403, -1037.1894216791084, -505.94089474131283, -351.6270999827168, -317.16605614489305, -767.4860088894125, -1351.129491146495, -1082.9702585168297, -741.3400478483496, -255.82374730411343, -740.1344802033489, -1079.37520340147, -678.1352930023832, -846.0614202092092, -1038.4310519065596, -115.61333363935364, -640.5963321421348, -607.3730355963648, -578.0696115475715, -1162.6076641949912, -220.57846464860498, -907.7684743350393, -63.20601393299582, -807.3289060569978, -1096.883867938425, -610.0522531988537, -932.6528177854101, -619.2043104946958, -596.9320152579483, -138.7551364873173, -283.09499971849124, -782.1311130901737, -922.5275319834914, -299.14547241785255, -988.9820571028283, -232.6194585932712, -466.8740034483502, -1057.9448238768055, -945.2255753880462, -1109.6883965407917, -148.89074689198907, -381.6425557428234, -658.319568626333, -151.31132020846604, -854.3973329763531, -1012.5668659946059, -583.7897850485067, -736.7132139284544, -1212.7598155188125, -409.22642141898837, -981.9252603108121, -455.77410820618167, -872.6343443892963, -620.7166482566557, -787.9017579515704, -409.5302553615857, -592.6689960453043, -323.7984913749126, -421.28370630131997, -992.6041788429748, -729.4798266945218, -853.3621919488718, -1000.2267274610476, -910.2532115797865, -1168.131281513756, -975.466565678185, -600.594149927595, -517.0885827384, -1047.1633132818474, -539.9595182685878, -1053.5551101719113, -957.1013581442005, -685.8672638949647, -599.5733708572392, -1060.8617802166127, -1060.9177427397158, -884.2026135984623, -892.9796796341253, -808.98720522429, -832.3654828720586, -879.1380698830017, -648.8802552883157, -1056.0967315923222, -407.4009365433788, -896.2876112051235, -326.7930347981087, -126.34740597718115, -507.91758319545784, -1030.3073429691583, -743.7996499430127, -612.3333976112561, -131.15528183090353, -832.6792691508778, -846.0571578516949, -456.02059704290957, -937.882170571197, -759.96203279567, -568.2294904230267, -410.3848108101482, -566.9177763034887, -49.465883789003485, -707.8604872975699, -379.97731318181724, -767.9131772609758, -1204.1644726619238, -342.70035728053074, -1331.6871566325106, -783.4759985890028, -776.0187460255898, -473.4849347691686, -1294.571847959684, -859.563864697418, -369.32703254008095, -930.5742237498829, -1277.2833152422236, -106.60732960832783, -846.0968941384288, -980.1528843050219, -751.50537375735, -939.3904851883774, -273.6459521980264, -697.0898279465541, -956.1649207706042, -751.18117010105, -286.39321448125577, -186.33767574524148, -1035.6804673435727, -817.455947026572, -988.0444808338007, -707.46067920647, -1298.977979819286, -521.6664744055511, -567.2617338485121, -379.0122380966361, -245.64069390937507, -20.047311333975593, -198.07238232512478, -375.2386324704937, -1354.2923794842447, -358.2868548928612, -198.96369432481544, -1234.8238889734482, -677.893941714643, -635.8407031177337, -600.8841465704255, -1169.0729263861256, -870.4993565507043, -109.96789417874017, -473.927688968639, -544.3750707507364, -1181.2266482987577, -1224.3171696189447, -227.38526381058978, -1003.2147086749508, -851.4571298555168, -272.30054764377013, -136.17703327182474, -923.9827280913948, -1352.4442710199346, -72.2950040754727, -871.3404129800105, -1122.330300483531, -440.29552116022813, -128.96625299171993, -1095.9438176397225, -535.1062363425982, -716.6122241088201, -1006.9614862935359, -1425.8881372721316, -245.246133782876, -563.3416904425887, -939.9491701731455, -65.6880755617354, -497.0993431686577, -1140.4212772100805, -628.7971223341107, -1156.6915926173606, -720.6936095165131, -610.116723102156, -648.0507324219021, -782.1430779258144, -1286.0429689345651, -36.5698680607116, -514.5151236276588, -702.6493909306157, -867.8333311849192, -1082.8905916010526, -600.4906252171093, -705.6688596330132, -641.3148425468879, -676.7634724602744, -900.637416915704, -1150.4442358845572, -530.5996287994357, -526.8579553453009, -748.9537463305049, -515.1196887712451, -1081.476147442704, -148.12862902970988, -368.5703887671285, -552.4070040176031, -553.1569445344792, -723.7784704575763, -16.448759828832774, -418.4386148004501, -831.1619217415788, -619.680909747569, -841.2162124091149, -769.8949007407598, -427.73696244194747, -781.5652798557236, -768.4860919091141, -569.8233316125886, -387.5519572171498, -764.2581791853111, -595.1522402568003, -960.6122169838828, -1167.2923941354334, -90.3229922214673, -403.3228974282704, -760.6580757946684, -242.02757964335433, -811.0608447308258, -1391.0815719101104, -647.1010140883545, -983.7803935382062, -640.9478647850865, -576.7860335684497, -208.9762556639899, -113.83578753756849, -1241.6257710234659, -220.05709136010975, -271.61069866938146, -609.0051748560138, -360.8013742461381, -603.768645301065, -384.6846063914249, -1212.92662102649, -697.7851368013123, -1189.2044411176178, -465.0777592216945, -554.3806042934233, -194.12240609305098, -808.2615413529317, -411.28911573383397, -1169.139516958817, -347.0251197449504, -43.267108772110916, -648.4697825376483, -366.87556979825774, -1051.8995598141992, -689.0733026205644, -1055.3082180032545, -1139.8926599722472, -744.8857609265995, -398.3623147796033, -998.6841560569512, -235.70048238316687, -1043.6975500619437, -689.8999189216551, -831.076344956903, -810.7713816155051, -661.5888396574674, -762.6721894962242, -587.3722833022116, -351.43036487409154, -737.4736202783445, -547.0395354043759, -185.3407606259855, -1464.5679978935095, -469.06339208288, -510.53859792908327, -965.479272610033, -670.2419292248161, -976.3001921869161, -452.3186138321108, -985.9031138709161, -628.7843041516031, -943.3923745585618, -656.6097635789524, -267.9803368521761, -147.5880487331868, -819.3120899906022, -860.0880896330854, -296.4546293087188, -577.7083110404596, -1245.6449868640796, -68.49802542810151, -680.798621864144, -838.2658253000985, -1039.5785285964325, -229.59280881718232, -976.8022119814555, -353.38486118388425, -453.5635482290069, -928.288862008195, -882.199936927405, -547.2442507183857, -457.91171225682206, -453.4143177131128, -629.574754100853, -645.0918964203706]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6750328900310854, "mean_inference_ms": 1.7681841318741314, "mean_action_processing_ms": 0.9784236046939614, "mean_env_wait_ms": 11.176706722942987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016794443130493164, "StateBufferConnector_ms": 0.012237310409545898, "ViewRequirementAgentConnector_ms": 0.48915696144104004}, "num_episodes": 40, "episode_return_max": -1410.0343595136253, "episode_return_min": -4791.378728936275, "episode_return_mean": -3374.4993038001207, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224924, "num_agent_steps_trained": 224924, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.813811235684, "num_env_steps_trained_throughput_per_sec": 74.813811235684, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 224924, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224924, "timers": {"training_iteration_time_ms": 55364.001, "restore_workers_time_ms": 0.031, "training_step_time_ms": 55363.923, "sample_time_ms": 3499.426, "learn_time_ms": 51806.646, "learn_throughput": 77.21, "synch_weights_time_ms": 54.656}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 224924, "num_agent_steps_trained": 224924}, "done": false, "training_iteration": 12, "trial_id": "05c72_00000", "date": "2024-07-26_14-53-43", "timestamp": 1721985823, "time_this_iter_s": 53.47733688354492, "time_total_s": 644.4231696128845, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d280529fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 644.4231696128845, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 11.164473684210527, "ram_util_percent": 32.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.54237412510903, "cur_kl_coeff": 0.1, "cur_lr": 0.001, "total_loss": 5.397379565686687, "policy_loss": -0.0017597895826129985, "vf_loss": 5.413059082501372, "vf_explained_var": 0.9711136764903583, "kl": 0.016035355756430534, "entropy": 1.5523265931807773, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.78873239436619, "num_grad_updates_lifetime": 55080.5, "diff_num_grad_updates_vs_sampler_policy": 2129.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 243070, "num_agent_steps_trained": 243070}, "env_runners": {"episode_reward_max": -1410.0343595136253, "episode_reward_min": -4791.378728936275, "episode_reward_mean": -3335.8419916261787, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1464.5679978935095}, "policy_reward_max": {"policy_0": -4.291194708156312}, "policy_reward_mean": {"policy_0": -667.1683983252357}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4791.378728936275, -2987.6188563117007, -3093.546745664367, -2764.294403022369, -2585.172352151005, -2364.8158344455337, -3332.51165756653, -3886.107953870257, -3817.212215107433, -2651.481265147997, -3346.4383643799742, -4213.302331019427, -2060.524961443456, -2945.4370092160752, -3239.52962861429, -2860.609875269437, -4208.8639247794545, -4760.924782255286, -3318.1099602385416, -3573.3008513233785, -3293.349550904832, -3899.643737274107, -3318.837430899642, -3476.3972503225723, -3510.1238589126847, -2420.1175750486254, -2910.1485235457953, -3643.392098440458, -3260.3848728542666, -3796.398819383254, -3283.452002004411, -3320.528395162598, -4654.6719361603655, -4114.867882604948, -4291.422771306998, -4062.350692901794, -2812.9257201161117, -3025.5132555497876, -3832.6012274123505, -2302.8584486232385, -4026.4424770177566, -4187.115392040865, -3529.8887952789437, -3641.784523395331, -3215.757448441725, -4333.605561291679, -1410.0343595136253, -3521.605450145862, -3954.1910743396306, -3533.814471815817, -2490.5346832566534, -4342.39271665034, -2916.9240522430878, -4181.3866179642755, -3488.6974108919444, -4047.0471119009485, -3204.458305404955, -3524.875216772993, -3471.975255131047, -2703.739113791626, -2609.5086765760066, -3588.899447356661, -3277.397925255733, -2663.623939223193, -4473.971689052582, -2361.2809391535848, -2229.8704994640216, -4119.374562460537, -2929.8376998835865, -2799.5853235427835, -4337.133109738653, -3611.145677939175, -3100.537297608338, -3176.5502839358332, -4050.243121724794, -2644.354827874478, -3799.2081068369434, -2856.733810005958, -3594.2394203299496, -2733.236931209541, -3888.159097181669, -3164.1531940312757, -2528.794136732097, -2739.2655280191134, -4105.610911709154, -3627.3841616713617, -3676.463846574695, -2742.1368584768293, -2527.476814387987, -3477.3748324365583, -2518.083684121302, -3160.3554724534147, -2567.6137444588553, -4323.1699834890405, -2517.04090239053, -2465.349436633686, -2966.6254142302832, -1914.3325458718818, -3519.05145082793, -4441.586070267071], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-386.68886923669595, -954.4708284708915, -1170.741487667282, -1064.2510498183938, -1215.2264937430102, -340.3728601358977, -316.79376006924684, -708.5233565422409, -641.3510669210038, -980.5778126433116, -668.4371025716074, -297.2622468736975, -524.5838531755601, -786.8529921030614, -816.4105509404395, -321.690440880538, -978.3482696309992, -783.6851372770782, -569.9788281298532, -110.59172710389892, -801.7048842861328, -1042.070178745036, -246.92771610262162, -490.1783783090569, -4.291194708156312, -361.7004167722715, -111.71162783223177, -387.33200858906133, -963.9663676379556, -540.1054136140126, -578.1860464908783, -1326.8906998523094, -760.8783962586479, -493.2083392427645, -173.3481757219286, -1036.1382415120515, -972.2714796519349, -871.7587199439001, -672.4592440561954, -333.4802687061806, -854.0110744625097, -798.7784140829132, -608.0393983669983, -912.8243315995467, -643.5589965954674, -275.99863044723645, -286.75674329271953, -584.9987566844095, -389.3448722153083, -1114.3822625083253, -472.25307874312455, -878.1783797099022, -576.8821621939966, -540.1319812738155, -878.9927624591372, -719.4984132186248, -869.7153644462935, -664.8503647629079, -984.4439684331232, -974.7942201584784, -793.0301212135936, -645.504186342497, -200.28586042199373, -96.47523061834167, -325.22956284702724, -345.17148390361194, -483.47999032579014, -1255.9935945473371, -35.22825963971651, -825.5636807996203, -1033.227328157649, -333.2775429605135, -731.5863584098649, -187.8918310835544, -953.5465680027115, -496.6496379901941, -520.9409025869954, -312.03188148369543, -1178.4182355942785, -352.5692176142766, -478.79335250707686, -1094.5206530230496, -914.5985767550692, -538.2123561038599, -1182.7389863903954, -1018.3254951683876, -787.9969169418813, -982.0392432649713, -1023.3569386571754, -949.2061882228733, -583.072131630898, -366.1359365821123, -814.6101297829551, -738.7620323188462, -815.5297299237317, -136.18379099617266, -581.7186131269491, -1031.3387633632083, -786.8702621579403, -1037.1894216791084, -505.94089474131283, -351.6270999827168, -317.16605614489305, -767.4860088894125, -1351.129491146495, -1082.9702585168297, -741.3400478483496, -255.82374730411343, -740.1344802033489, -1079.37520340147, -678.1352930023832, -846.0614202092092, -1038.4310519065596, -115.61333363935364, -640.5963321421348, -607.3730355963648, -578.0696115475715, -1162.6076641949912, -220.57846464860498, -907.7684743350393, -63.20601393299582, -807.3289060569978, -1096.883867938425, -610.0522531988537, -932.6528177854101, -619.2043104946958, -596.9320152579483, -138.7551364873173, -283.09499971849124, -782.1311130901737, -922.5275319834914, -299.14547241785255, -988.9820571028283, -232.6194585932712, -466.8740034483502, -1057.9448238768055, -945.2255753880462, -1109.6883965407917, -148.89074689198907, -381.6425557428234, -658.319568626333, -151.31132020846604, -854.3973329763531, -1012.5668659946059, -583.7897850485067, -736.7132139284544, -1212.7598155188125, -409.22642141898837, -981.9252603108121, -455.77410820618167, -872.6343443892963, -620.7166482566557, -787.9017579515704, -409.5302553615857, -592.6689960453043, -323.7984913749126, -421.28370630131997, -992.6041788429748, -729.4798266945218, -853.3621919488718, -1000.2267274610476, -910.2532115797865, -1168.131281513756, -975.466565678185, -600.594149927595, -517.0885827384, -1047.1633132818474, -539.9595182685878, -1053.5551101719113, -957.1013581442005, -685.8672638949647, -599.5733708572392, -1060.8617802166127, -1060.9177427397158, -884.2026135984623, -892.9796796341253, -808.98720522429, -832.3654828720586, -879.1380698830017, -648.8802552883157, -1056.0967315923222, -407.4009365433788, -896.2876112051235, -326.7930347981087, -126.34740597718115, -507.91758319545784, -1030.3073429691583, -743.7996499430127, -612.3333976112561, -131.15528183090353, -832.6792691508778, -846.0571578516949, -456.02059704290957, -937.882170571197, -759.96203279567, -568.2294904230267, -410.3848108101482, -566.9177763034887, -49.465883789003485, -707.8604872975699, -379.97731318181724, -767.9131772609758, -1204.1644726619238, -342.70035728053074, -1331.6871566325106, -783.4759985890028, -776.0187460255898, -473.4849347691686, -1294.571847959684, -859.563864697418, -369.32703254008095, -930.5742237498829, -1277.2833152422236, -106.60732960832783, -846.0968941384288, -980.1528843050219, -751.50537375735, -939.3904851883774, -273.6459521980264, -697.0898279465541, -956.1649207706042, -751.18117010105, -286.39321448125577, -186.33767574524148, -1035.6804673435727, -817.455947026572, -988.0444808338007, -707.46067920647, -1298.977979819286, -521.6664744055511, -567.2617338485121, -379.0122380966361, -245.64069390937507, -20.047311333975593, -198.07238232512478, -375.2386324704937, -1354.2923794842447, -358.2868548928612, -198.96369432481544, -1234.8238889734482, -677.893941714643, -635.8407031177337, -600.8841465704255, -1169.0729263861256, -870.4993565507043, -109.96789417874017, -473.927688968639, -544.3750707507364, -1181.2266482987577, -1224.3171696189447, -227.38526381058978, -1003.2147086749508, -851.4571298555168, -272.30054764377013, -136.17703327182474, -923.9827280913948, -1352.4442710199346, -72.2950040754727, -871.3404129800105, -1122.330300483531, -440.29552116022813, -128.96625299171993, -1095.9438176397225, -535.1062363425982, -716.6122241088201, -1006.9614862935359, -1425.8881372721316, -245.246133782876, -563.3416904425887, -939.9491701731455, -65.6880755617354, -497.0993431686577, -1140.4212772100805, -628.7971223341107, -1156.6915926173606, -720.6936095165131, -610.116723102156, -648.0507324219021, -782.1430779258144, -1286.0429689345651, -36.5698680607116, -514.5151236276588, -702.6493909306157, -867.8333311849192, -1082.8905916010526, -600.4906252171093, -705.6688596330132, -641.3148425468879, -676.7634724602744, -900.637416915704, -1150.4442358845572, -530.5996287994357, -526.8579553453009, -748.9537463305049, -515.1196887712451, -1081.476147442704, -148.12862902970988, -368.5703887671285, -552.4070040176031, -553.1569445344792, -723.7784704575763, -16.448759828832774, -418.4386148004501, -831.1619217415788, -619.680909747569, -841.2162124091149, -769.8949007407598, -427.73696244194747, -781.5652798557236, -768.4860919091141, -569.8233316125886, -387.5519572171498, -764.2581791853111, -595.1522402568003, -960.6122169838828, -1167.2923941354334, -90.3229922214673, -403.3228974282704, -760.6580757946684, -242.02757964335433, -811.0608447308258, -1391.0815719101104, -647.1010140883545, -983.7803935382062, -640.9478647850865, -576.7860335684497, -208.9762556639899, -113.83578753756849, -1241.6257710234659, -220.05709136010975, -271.61069866938146, -609.0051748560138, -360.8013742461381, -603.768645301065, -384.6846063914249, -1212.92662102649, -697.7851368013123, -1189.2044411176178, -465.0777592216945, -554.3806042934233, -194.12240609305098, -808.2615413529317, -411.28911573383397, -1169.139516958817, -347.0251197449504, -43.267108772110916, -648.4697825376483, -366.87556979825774, -1051.8995598141992, -689.0733026205644, -1055.3082180032545, -1139.8926599722472, -744.8857609265995, -398.3623147796033, -998.6841560569512, -235.70048238316687, -1043.6975500619437, -689.8999189216551, -831.076344956903, -810.7713816155051, -661.5888396574674, -762.6721894962242, -587.3722833022116, -351.43036487409154, -737.4736202783445, -547.0395354043759, -185.3407606259855, -1464.5679978935095, -469.06339208288, -510.53859792908327, -965.479272610033, -670.2419292248161, -976.3001921869161, -452.3186138321108, -985.9031138709161, -628.7843041516031, -943.3923745585618, -656.6097635789524, -267.9803368521761, -147.5880487331868, -819.3120899906022, -860.0880896330854, -296.4546293087188, -577.7083110404596, -1245.6449868640796, -68.49802542810151, -680.798621864144, -838.2658253000985, -1039.5785285964325, -229.59280881718232, -976.8022119814555, -353.38486118388425, -453.5635482290069, -928.288862008195, -882.199936927405, -547.2442507183857, -457.91171225682206, -453.4143177131128, -629.574754100853, -645.0918964203706, -749.767264423888, -552.8807272963824, -546.6404215171564, -1014.1839839729308, -1024.6866999713134, -388.20436611778916, -1024.8037361500426, -136.9531083000532, -1038.0410242604719, -576.1509592029199, -563.8813201059779, -572.7893068995617, -1087.1783649427464, -205.9035115920484, -99.04163319176298, -136.33543890187983, -850.3642667144184, -792.6061259111167, -759.809956323248, -200.14974016844795, -783.1507251577634, -811.7169019572672, -604.0365149679244, -742.4778518654887, -1164.2289177607133, -876.8973917172584, -140.30380254471248, -820.0978874953324, -890.9156492874997, -899.1694306265571, -900.5390269675503, -67.91750152926873, -671.9067472118205, -1100.1775827776107, -935.9229880884449, -1090.039044144866, -173.02527014943433, -459.20500470533824, -607.6296020971643, -412.237937380025, -966.3158760185232, -84.31242929289125, -1084.6985555551744, -93.26270665883077, -298.88724686256774, -885.0468947001583, -197.02666547887912, -1161.178486304894, -192.85361211297808, -1041.2691738396525, -77.69519276557831, -227.35574330397168, -784.6198661941748, -928.3130640675907, -500.0998177899877, -757.9749645649869, -841.3338564546423, -666.6270117735985, -503.55117724118276, -390.86846241900537, -148.46724890815528, -584.8101749333431, -558.1741153694062, -681.2439990859662, -594.9182061619877, -977.5674125266585, -1193.8139381185258, -689.7670681822696, -775.5887710689809, -686.4327935926066, -455.9525401385013, -603.274488318864, -445.2096056953877, -953.4359183466485, -59.16834989113065, -470.55953093289776, -258.0947967401959, -130.8062674859645, -1076.1111351410361, -529.7777063335927, -421.46030827574293, -591.6274350339314, -671.9882899027667, -912.6461928950547, -368.9031881227827, -350.15033430323666, -87.3480863832639, -247.27106940844905, -1083.388285241325, -146.17477053560498, -912.0573197290972, -251.99483068172555, -439.9941890687222, -1035.116293186249, -879.888818162138, -1315.7919607756887, -530.4090596695576, -697.1564940342795, -533.0878151801053, -1365.1407406074416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6730363418606748, "mean_inference_ms": 1.7595533044244152, "mean_action_processing_ms": 0.9626115301615683, "mean_env_wait_ms": 11.123845303894255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017337560653686523, "StateBufferConnector_ms": 0.01241302490234375, "ViewRequirementAgentConnector_ms": 0.49153828620910645}, "num_episodes": 20, "episode_return_max": -1410.0343595136253, "episode_return_min": -4791.378728936275, "episode_return_mean": -3335.8419916261787, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243070, "num_agent_steps_trained": 243070, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.1603312923423, "num_env_steps_trained_throughput_per_sec": 70.1603312923423, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 243070, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 243070, "timers": {"training_iteration_time_ms": 55744.35, "restore_workers_time_ms": 0.03, "training_step_time_ms": 55744.274, "sample_time_ms": 3514.738, "learn_time_ms": 52171.65, "learn_throughput": 76.67, "synch_weights_time_ms": 54.676}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 243070, "num_agent_steps_trained": 243070}, "done": false, "training_iteration": 13, "trial_id": "05c72_00000", "date": "2024-07-26_14-54-40", "timestamp": 1721985880, "time_this_iter_s": 57.02322578430176, "time_total_s": 701.4463953971863, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805a9360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 701.4463953971863, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 10.981481481481481, "ram_util_percent": 32.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 165.01328917879866, "cur_kl_coeff": 0.1, "cur_lr": 0.001, "total_loss": 5.1777462742852824, "policy_loss": -0.0033964171491004088, "vf_loss": 5.195726161138386, "vf_explained_var": 0.9715614559379875, "kl": 0.018553911606769075, "entropy": 1.6438865709812083, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.87234042553192, "num_grad_updates_lifetime": 59325.5, "diff_num_grad_updates_vs_sampler_policy": 2114.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 261100, "num_agent_steps_trained": 261100}, "env_runners": {"episode_reward_max": -1410.0343595136253, "episode_reward_min": -4654.6719361603655, "episode_reward_mean": -3261.294693213536, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1464.5679978935095}, "policy_reward_max": {"policy_0": -9.804503375765048}, "policy_reward_mean": {"policy_0": -652.2589386427072}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3293.349550904832, -3899.643737274107, -3318.837430899642, -3476.3972503225723, -3510.1238589126847, -2420.1175750486254, -2910.1485235457953, -3643.392098440458, -3260.3848728542666, -3796.398819383254, -3283.452002004411, -3320.528395162598, -4654.6719361603655, -4114.867882604948, -4291.422771306998, -4062.350692901794, -2812.9257201161117, -3025.5132555497876, -3832.6012274123505, -2302.8584486232385, -4026.4424770177566, -4187.115392040865, -3529.8887952789437, -3641.784523395331, -3215.757448441725, -4333.605561291679, -1410.0343595136253, -3521.605450145862, -3954.1910743396306, -3533.814471815817, -2490.5346832566534, -4342.39271665034, -2916.9240522430878, -4181.3866179642755, -3488.6974108919444, -4047.0471119009485, -3204.458305404955, -3524.875216772993, -3471.975255131047, -2703.739113791626, -2609.5086765760066, -3588.899447356661, -3277.397925255733, -2663.623939223193, -4473.971689052582, -2361.2809391535848, -2229.8704994640216, -4119.374562460537, -2929.8376998835865, -2799.5853235427835, -4337.133109738653, -3611.145677939175, -3100.537297608338, -3176.5502839358332, -4050.243121724794, -2644.354827874478, -3799.2081068369434, -2856.733810005958, -3594.2394203299496, -2733.236931209541, -3888.159097181669, -3164.1531940312757, -2528.794136732097, -2739.2655280191134, -4105.610911709154, -3627.3841616713617, -3676.463846574695, -2742.1368584768293, -2527.476814387987, -3477.3748324365583, -2518.083684121302, -3160.3554724534147, -2567.6137444588553, -4323.1699834890405, -2517.04090239053, -2465.349436633686, -2966.6254142302832, -1914.3325458718818, -3519.05145082793, -4441.586070267071, -3105.032767411486, -2971.90245157611, -2952.4480885077523, -4031.670609047992, -1847.7877319234906, -3576.8094181936262, -2862.017703076816, -3330.6351923192315, -3023.45321757006, -4077.528753883274, -2586.564129958416, -3035.9492220868533, -2276.6380996989296, -3465.4412942070103, -3402.177699605214, -2996.8031566778627, -1555.7411262197957, -3909.047595460758, -2081.0324050201334, -2257.7711970537434], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-505.94089474131283, -351.6270999827168, -317.16605614489305, -767.4860088894125, -1351.129491146495, -1082.9702585168297, -741.3400478483496, -255.82374730411343, -740.1344802033489, -1079.37520340147, -678.1352930023832, -846.0614202092092, -1038.4310519065596, -115.61333363935364, -640.5963321421348, -607.3730355963648, -578.0696115475715, -1162.6076641949912, -220.57846464860498, -907.7684743350393, -63.20601393299582, -807.3289060569978, -1096.883867938425, -610.0522531988537, -932.6528177854101, -619.2043104946958, -596.9320152579483, -138.7551364873173, -283.09499971849124, -782.1311130901737, -922.5275319834914, -299.14547241785255, -988.9820571028283, -232.6194585932712, -466.8740034483502, -1057.9448238768055, -945.2255753880462, -1109.6883965407917, -148.89074689198907, -381.6425557428234, -658.319568626333, -151.31132020846604, -854.3973329763531, -1012.5668659946059, -583.7897850485067, -736.7132139284544, -1212.7598155188125, -409.22642141898837, -981.9252603108121, -455.77410820618167, -872.6343443892963, -620.7166482566557, -787.9017579515704, -409.5302553615857, -592.6689960453043, -323.7984913749126, -421.28370630131997, -992.6041788429748, -729.4798266945218, -853.3621919488718, -1000.2267274610476, -910.2532115797865, -1168.131281513756, -975.466565678185, -600.594149927595, -517.0885827384, -1047.1633132818474, -539.9595182685878, -1053.5551101719113, -957.1013581442005, -685.8672638949647, -599.5733708572392, -1060.8617802166127, -1060.9177427397158, -884.2026135984623, -892.9796796341253, -808.98720522429, -832.3654828720586, -879.1380698830017, -648.8802552883157, -1056.0967315923222, -407.4009365433788, -896.2876112051235, -326.7930347981087, -126.34740597718115, -507.91758319545784, -1030.3073429691583, -743.7996499430127, -612.3333976112561, -131.15528183090353, -832.6792691508778, -846.0571578516949, -456.02059704290957, -937.882170571197, -759.96203279567, -568.2294904230267, -410.3848108101482, -566.9177763034887, -49.465883789003485, -707.8604872975699, -379.97731318181724, -767.9131772609758, -1204.1644726619238, -342.70035728053074, -1331.6871566325106, -783.4759985890028, -776.0187460255898, -473.4849347691686, -1294.571847959684, -859.563864697418, -369.32703254008095, -930.5742237498829, -1277.2833152422236, -106.60732960832783, -846.0968941384288, -980.1528843050219, -751.50537375735, -939.3904851883774, -273.6459521980264, -697.0898279465541, -956.1649207706042, -751.18117010105, -286.39321448125577, -186.33767574524148, -1035.6804673435727, -817.455947026572, -988.0444808338007, -707.46067920647, -1298.977979819286, -521.6664744055511, -567.2617338485121, -379.0122380966361, -245.64069390937507, -20.047311333975593, -198.07238232512478, -375.2386324704937, -1354.2923794842447, -358.2868548928612, -198.96369432481544, -1234.8238889734482, -677.893941714643, -635.8407031177337, -600.8841465704255, -1169.0729263861256, -870.4993565507043, -109.96789417874017, -473.927688968639, -544.3750707507364, -1181.2266482987577, -1224.3171696189447, -227.38526381058978, -1003.2147086749508, -851.4571298555168, -272.30054764377013, -136.17703327182474, -923.9827280913948, -1352.4442710199346, -72.2950040754727, -871.3404129800105, -1122.330300483531, -440.29552116022813, -128.96625299171993, -1095.9438176397225, -535.1062363425982, -716.6122241088201, -1006.9614862935359, -1425.8881372721316, -245.246133782876, -563.3416904425887, -939.9491701731455, -65.6880755617354, -497.0993431686577, -1140.4212772100805, -628.7971223341107, -1156.6915926173606, -720.6936095165131, -610.116723102156, -648.0507324219021, -782.1430779258144, -1286.0429689345651, -36.5698680607116, -514.5151236276588, -702.6493909306157, -867.8333311849192, -1082.8905916010526, -600.4906252171093, -705.6688596330132, -641.3148425468879, -676.7634724602744, -900.637416915704, -1150.4442358845572, -530.5996287994357, -526.8579553453009, -748.9537463305049, -515.1196887712451, -1081.476147442704, -148.12862902970988, -368.5703887671285, -552.4070040176031, -553.1569445344792, -723.7784704575763, -16.448759828832774, -418.4386148004501, -831.1619217415788, -619.680909747569, -841.2162124091149, -769.8949007407598, -427.73696244194747, -781.5652798557236, -768.4860919091141, -569.8233316125886, -387.5519572171498, -764.2581791853111, -595.1522402568003, -960.6122169838828, -1167.2923941354334, -90.3229922214673, -403.3228974282704, -760.6580757946684, -242.02757964335433, -811.0608447308258, -1391.0815719101104, -647.1010140883545, -983.7803935382062, -640.9478647850865, -576.7860335684497, -208.9762556639899, -113.83578753756849, -1241.6257710234659, -220.05709136010975, -271.61069866938146, -609.0051748560138, -360.8013742461381, -603.768645301065, -384.6846063914249, -1212.92662102649, -697.7851368013123, -1189.2044411176178, -465.0777592216945, -554.3806042934233, -194.12240609305098, -808.2615413529317, -411.28911573383397, -1169.139516958817, -347.0251197449504, -43.267108772110916, -648.4697825376483, -366.87556979825774, -1051.8995598141992, -689.0733026205644, -1055.3082180032545, -1139.8926599722472, -744.8857609265995, -398.3623147796033, -998.6841560569512, -235.70048238316687, -1043.6975500619437, -689.8999189216551, -831.076344956903, -810.7713816155051, -661.5888396574674, -762.6721894962242, -587.3722833022116, -351.43036487409154, -737.4736202783445, -547.0395354043759, -185.3407606259855, -1464.5679978935095, -469.06339208288, -510.53859792908327, -965.479272610033, -670.2419292248161, -976.3001921869161, -452.3186138321108, -985.9031138709161, -628.7843041516031, -943.3923745585618, -656.6097635789524, -267.9803368521761, -147.5880487331868, -819.3120899906022, -860.0880896330854, -296.4546293087188, -577.7083110404596, -1245.6449868640796, -68.49802542810151, -680.798621864144, -838.2658253000985, -1039.5785285964325, -229.59280881718232, -976.8022119814555, -353.38486118388425, -453.5635482290069, -928.288862008195, -882.199936927405, -547.2442507183857, -457.91171225682206, -453.4143177131128, -629.574754100853, -645.0918964203706, -749.767264423888, -552.8807272963824, -546.6404215171564, -1014.1839839729308, -1024.6866999713134, -388.20436611778916, -1024.8037361500426, -136.9531083000532, -1038.0410242604719, -576.1509592029199, -563.8813201059779, -572.7893068995617, -1087.1783649427464, -205.9035115920484, -99.04163319176298, -136.33543890187983, -850.3642667144184, -792.6061259111167, -759.809956323248, -200.14974016844795, -783.1507251577634, -811.7169019572672, -604.0365149679244, -742.4778518654887, -1164.2289177607133, -876.8973917172584, -140.30380254471248, -820.0978874953324, -890.9156492874997, -899.1694306265571, -900.5390269675503, -67.91750152926873, -671.9067472118205, -1100.1775827776107, -935.9229880884449, -1090.039044144866, -173.02527014943433, -459.20500470533824, -607.6296020971643, -412.237937380025, -966.3158760185232, -84.31242929289125, -1084.6985555551744, -93.26270665883077, -298.88724686256774, -885.0468947001583, -197.02666547887912, -1161.178486304894, -192.85361211297808, -1041.2691738396525, -77.69519276557831, -227.35574330397168, -784.6198661941748, -928.3130640675907, -500.0998177899877, -757.9749645649869, -841.3338564546423, -666.6270117735985, -503.55117724118276, -390.86846241900537, -148.46724890815528, -584.8101749333431, -558.1741153694062, -681.2439990859662, -594.9182061619877, -977.5674125266585, -1193.8139381185258, -689.7670681822696, -775.5887710689809, -686.4327935926066, -455.9525401385013, -603.274488318864, -445.2096056953877, -953.4359183466485, -59.16834989113065, -470.55953093289776, -258.0947967401959, -130.8062674859645, -1076.1111351410361, -529.7777063335927, -421.46030827574293, -591.6274350339314, -671.9882899027667, -912.6461928950547, -368.9031881227827, -350.15033430323666, -87.3480863832639, -247.27106940844905, -1083.388285241325, -146.17477053560498, -912.0573197290972, -251.99483068172555, -439.9941890687222, -1035.116293186249, -879.888818162138, -1315.7919607756887, -530.4090596695576, -697.1564940342795, -533.0878151801053, -1365.1407406074416, -493.3103550481532, -639.5569828691908, -1015.4894480681498, -946.8714780502285, -9.804503375765048, -368.8523627385023, -818.9151013450571, -249.331335272152, -654.4149352690296, -880.3887169513716, -642.5734354968159, -746.7239161394232, -680.6970566064377, -330.42675568268487, -552.0269245823921, -519.6761053071642, -899.543160168954, -965.0918555451728, -766.582684884069, -880.7768031426282, -798.2749527083083, -880.4475494685291, -79.20033534471, -78.52436656773276, -11.340527834210198, -927.6465868783345, -502.83152358996364, -1021.1661061384065, -632.3749346822797, -492.7902669046423, -869.5050420775394, -152.26932951577518, -208.63566291435035, -601.5152839304825, -1030.0923846386713, -293.83795691595617, -869.8541245608845, -425.6829619939921, -429.4653501003158, -1311.7947987480788, -619.27323221719, -787.8360002169912, -289.4507537360522, -582.3058896429425, -744.5873417568887, -563.1882260368255, -514.2470801992367, -1293.3270184149258, -799.6108579016005, -907.1555713306902, -264.2216750355099, -167.04615354876506, -262.8045967455674, -558.9800101177403, -1333.5116945108327, -356.66775030589037, -401.319923408033, -1043.478756082595, -600.8629881676594, -633.6198041226767, -509.09899245838614, -389.5557257862475, -62.224916850027604, -411.2049301885021, -904.5535344157659, -538.6695327855336, -888.3573751540199, -784.2006746300973, -966.8306046759031, -287.38310696145675, -1269.7071875306801, -812.8695700710539, -531.430610158313, -671.6526118792212, -116.51771996594252, -1067.9672338211906, -370.1702882410788, -570.947802294164, -500.328400792236, -487.3894315291952, -302.03933227936074, -404.8759298032892, -233.99479633123482, -183.5066089907276, -431.324458815184, -554.3113817920846, -673.3010361014466, -947.2703383861757, -518.961378184277, -1215.2034609967748, -104.9122473438231, -487.42519629381496, -75.65945899914385, -290.24145279446725, -1122.7940495888843, -242.42197213954708, -872.989249772911, -922.2245297841621, -121.05406897239898, -99.08137638472549]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6703836462951949, "mean_inference_ms": 1.7564907826522131, "mean_action_processing_ms": 0.9555202987072536, "mean_env_wait_ms": 11.112844528514556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017134904861450195, "StateBufferConnector_ms": 0.012219905853271484, "ViewRequirementAgentConnector_ms": 0.47971224784851074}, "num_episodes": 20, "episode_return_max": -1410.0343595136253, "episode_return_min": -4654.6719361603655, "episode_return_mean": -3261.294693213536, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 261100, "num_agent_steps_trained": 261100, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.19993612038523, "num_env_steps_trained_throughput_per_sec": 87.19993612038523, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 261100, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 261100, "timers": {"training_iteration_time_ms": 54775.818, "restore_workers_time_ms": 0.029, "training_step_time_ms": 54775.743, "sample_time_ms": 3504.574, "learn_time_ms": 51213.324, "learn_throughput": 78.105, "synch_weights_time_ms": 54.661}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 261100, "num_agent_steps_trained": 261100}, "done": false, "training_iteration": 14, "trial_id": "05c72_00000", "date": "2024-07-26_14-55-26", "timestamp": 1721985926, "time_this_iter_s": 45.88226914405823, "time_total_s": 747.3286645412445, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d28052a170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 747.3286645412445, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 11.792307692307693, "ram_util_percent": 32.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.7809500082608, "cur_kl_coeff": 0.09999999999999998, "cur_lr": 0.001, "total_loss": 5.101093113723842, "policy_loss": -0.003948895645263637, "vf_loss": 5.120908380760544, "vf_explained_var": 0.9730207262093994, "kl": 0.023232033638251496, "entropy": 1.8189572566131065, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.4, "num_grad_updates_lifetime": 63615.5, "diff_num_grad_updates_vs_sampler_policy": 2174.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 279573, "num_agent_steps_trained": 279573}, "env_runners": {"episode_reward_max": -1555.7411262197957, "episode_reward_min": -4760.069379141325, "episode_reward_mean": -3150.8424780053797, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1464.5679978935095}, "policy_reward_max": {"policy_0": -8.013128453356718}, "policy_reward_mean": {"policy_0": -630.168495601076}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2609.5086765760066, -3588.899447356661, -3277.397925255733, -2663.623939223193, -4473.971689052582, -2361.2809391535848, -2229.8704994640216, -4119.374562460537, -2929.8376998835865, -2799.5853235427835, -4337.133109738653, -3611.145677939175, -3100.537297608338, -3176.5502839358332, -4050.243121724794, -2644.354827874478, -3799.2081068369434, -2856.733810005958, -3594.2394203299496, -2733.236931209541, -3888.159097181669, -3164.1531940312757, -2528.794136732097, -2739.2655280191134, -4105.610911709154, -3627.3841616713617, -3676.463846574695, -2742.1368584768293, -2527.476814387987, -3477.3748324365583, -2518.083684121302, -3160.3554724534147, -2567.6137444588553, -4323.1699834890405, -2517.04090239053, -2465.349436633686, -2966.6254142302832, -1914.3325458718818, -3519.05145082793, -4441.586070267071, -3105.032767411486, -2971.90245157611, -2952.4480885077523, -4031.670609047992, -1847.7877319234906, -3576.8094181936262, -2862.017703076816, -3330.6351923192315, -3023.45321757006, -4077.528753883274, -2586.564129958416, -3035.9492220868533, -2276.6380996989296, -3465.4412942070103, -3402.177699605214, -2996.8031566778627, -1555.7411262197957, -3909.047595460758, -2081.0324050201334, -2257.7711970537434, -2677.100198307429, -2614.63561193794, -2030.2781077715017, -3142.035280747807, -1746.0637703721272, -3833.0834047662884, -3589.0102376085642, -2844.469344164148, -2780.394062563776, -4141.119809131007, -2197.1879892228912, -3118.213745177968, -3167.190872070999, -3342.3799358821348, -3390.511745093448, -4554.934396166179, -3080.8816042212757, -3899.8340624909965, -4760.069379141325, -3885.702195869341, -3003.7068195092015, -3182.2176107520518, -2590.9937710772742, -3144.3506715902613, -2116.8329042656965, -2766.9669719654066, -3524.170251490774, -2917.0837496636595, -3680.5542665248727, -3882.852066106156, -3171.190874518777, -3867.521171238181, -3426.768058059885, -2781.2956487617503, -4754.55704646073, -3932.980288013046, -2452.3008716466175, -2289.6207554387056, -2560.3292266426542, -3069.645789469462], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-723.7784704575763, -16.448759828832774, -418.4386148004501, -831.1619217415788, -619.680909747569, -841.2162124091149, -769.8949007407598, -427.73696244194747, -781.5652798557236, -768.4860919091141, -569.8233316125886, -387.5519572171498, -764.2581791853111, -595.1522402568003, -960.6122169838828, -1167.2923941354334, -90.3229922214673, -403.3228974282704, -760.6580757946684, -242.02757964335433, -811.0608447308258, -1391.0815719101104, -647.1010140883545, -983.7803935382062, -640.9478647850865, -576.7860335684497, -208.9762556639899, -113.83578753756849, -1241.6257710234659, -220.05709136010975, -271.61069866938146, -609.0051748560138, -360.8013742461381, -603.768645301065, -384.6846063914249, -1212.92662102649, -697.7851368013123, -1189.2044411176178, -465.0777592216945, -554.3806042934233, -194.12240609305098, -808.2615413529317, -411.28911573383397, -1169.139516958817, -347.0251197449504, -43.267108772110916, -648.4697825376483, -366.87556979825774, -1051.8995598141992, -689.0733026205644, -1055.3082180032545, -1139.8926599722472, -744.8857609265995, -398.3623147796033, -998.6841560569512, -235.70048238316687, -1043.6975500619437, -689.8999189216551, -831.076344956903, -810.7713816155051, -661.5888396574674, -762.6721894962242, -587.3722833022116, -351.43036487409154, -737.4736202783445, -547.0395354043759, -185.3407606259855, -1464.5679978935095, -469.06339208288, -510.53859792908327, -965.479272610033, -670.2419292248161, -976.3001921869161, -452.3186138321108, -985.9031138709161, -628.7843041516031, -943.3923745585618, -656.6097635789524, -267.9803368521761, -147.5880487331868, -819.3120899906022, -860.0880896330854, -296.4546293087188, -577.7083110404596, -1245.6449868640796, -68.49802542810151, -680.798621864144, -838.2658253000985, -1039.5785285964325, -229.59280881718232, -976.8022119814555, -353.38486118388425, -453.5635482290069, -928.288862008195, -882.199936927405, -547.2442507183857, -457.91171225682206, -453.4143177131128, -629.574754100853, -645.0918964203706, -749.767264423888, -552.8807272963824, -546.6404215171564, -1014.1839839729308, -1024.6866999713134, -388.20436611778916, -1024.8037361500426, -136.9531083000532, -1038.0410242604719, -576.1509592029199, -563.8813201059779, -572.7893068995617, -1087.1783649427464, -205.9035115920484, -99.04163319176298, -136.33543890187983, -850.3642667144184, -792.6061259111167, -759.809956323248, -200.14974016844795, -783.1507251577634, -811.7169019572672, -604.0365149679244, -742.4778518654887, -1164.2289177607133, -876.8973917172584, -140.30380254471248, -820.0978874953324, -890.9156492874997, -899.1694306265571, -900.5390269675503, -67.91750152926873, -671.9067472118205, -1100.1775827776107, -935.9229880884449, -1090.039044144866, -173.02527014943433, -459.20500470533824, -607.6296020971643, -412.237937380025, -966.3158760185232, -84.31242929289125, -1084.6985555551744, -93.26270665883077, -298.88724686256774, -885.0468947001583, -197.02666547887912, -1161.178486304894, -192.85361211297808, -1041.2691738396525, -77.69519276557831, -227.35574330397168, -784.6198661941748, -928.3130640675907, -500.0998177899877, -757.9749645649869, -841.3338564546423, -666.6270117735985, -503.55117724118276, -390.86846241900537, -148.46724890815528, -584.8101749333431, -558.1741153694062, -681.2439990859662, -594.9182061619877, -977.5674125266585, -1193.8139381185258, -689.7670681822696, -775.5887710689809, -686.4327935926066, -455.9525401385013, -603.274488318864, -445.2096056953877, -953.4359183466485, -59.16834989113065, -470.55953093289776, -258.0947967401959, -130.8062674859645, -1076.1111351410361, -529.7777063335927, -421.46030827574293, -591.6274350339314, -671.9882899027667, -912.6461928950547, -368.9031881227827, -350.15033430323666, -87.3480863832639, -247.27106940844905, -1083.388285241325, -146.17477053560498, -912.0573197290972, -251.99483068172555, -439.9941890687222, -1035.116293186249, -879.888818162138, -1315.7919607756887, -530.4090596695576, -697.1564940342795, -533.0878151801053, -1365.1407406074416, -493.3103550481532, -639.5569828691908, -1015.4894480681498, -946.8714780502285, -9.804503375765048, -368.8523627385023, -818.9151013450571, -249.331335272152, -654.4149352690296, -880.3887169513716, -642.5734354968159, -746.7239161394232, -680.6970566064377, -330.42675568268487, -552.0269245823921, -519.6761053071642, -899.543160168954, -965.0918555451728, -766.582684884069, -880.7768031426282, -798.2749527083083, -880.4475494685291, -79.20033534471, -78.52436656773276, -11.340527834210198, -927.6465868783345, -502.83152358996364, -1021.1661061384065, -632.3749346822797, -492.7902669046423, -869.5050420775394, -152.26932951577518, -208.63566291435035, -601.5152839304825, -1030.0923846386713, -293.83795691595617, -869.8541245608845, -425.6829619939921, -429.4653501003158, -1311.7947987480788, -619.27323221719, -787.8360002169912, -289.4507537360522, -582.3058896429425, -744.5873417568887, -563.1882260368255, -514.2470801992367, -1293.3270184149258, -799.6108579016005, -907.1555713306902, -264.2216750355099, -167.04615354876506, -262.8045967455674, -558.9800101177403, -1333.5116945108327, -356.66775030589037, -401.319923408033, -1043.478756082595, -600.8629881676594, -633.6198041226767, -509.09899245838614, -389.5557257862475, -62.224916850027604, -411.2049301885021, -904.5535344157659, -538.6695327855336, -888.3573751540199, -784.2006746300973, -966.8306046759031, -287.38310696145675, -1269.7071875306801, -812.8695700710539, -531.430610158313, -671.6526118792212, -116.51771996594252, -1067.9672338211906, -370.1702882410788, -570.947802294164, -500.328400792236, -487.3894315291952, -302.03933227936074, -404.8759298032892, -233.99479633123482, -183.5066089907276, -431.324458815184, -554.3113817920846, -673.3010361014466, -947.2703383861757, -518.961378184277, -1215.2034609967748, -104.9122473438231, -487.42519629381496, -75.65945899914385, -290.24145279446725, -1122.7940495888843, -242.42197213954708, -872.989249772911, -922.2245297841621, -121.05406897239898, -99.08137638472549, -768.6454142572323, -82.908258719924, -992.6506321017164, -81.58914282817771, -751.3067504003785, -628.8443335617684, -566.5396015415257, -524.6680107710471, -12.035684491075896, -882.5479815725238, -72.6002544590466, -490.8827171969006, -115.98326692715628, -85.72576054858573, -1265.0861086398131, -180.2540175397538, -1054.7428262455858, -733.7692954953219, -781.3451517873503, -391.9239896797926, -538.8623411047625, -103.02606950841727, -56.165147169860845, -86.21519691242521, -961.7950156766609, -444.82110706865853, -1117.5103004337757, -1307.2578372357616, -611.7471153305451, -351.74704469754585, -745.029915141185, -75.13846875601882, -1256.5566888668432, -638.7055685915731, -873.5795962529456, -981.521276207636, -172.99703227915893, -212.70020245458144, -365.5020361514368, -1111.7487970713337, -941.1564646738971, -87.5333154334379, -866.0273151536571, -683.3936040366384, -202.2833632661439, -659.2758558440888, -549.6573138844308, -828.1693518624883, -1023.5928811766227, -1080.4244063633796, -286.7914920345605, -92.63238755143121, -627.8923990903194, -961.5691161150423, -228.30259443153625, -638.9056175041902, -950.3848883080351, -704.301236635732, -783.2309821952573, -41.39102053475293, -895.4860523296995, -181.45288612457597, -287.92638367894955, -1291.1482025895148, -511.17734734826047, -868.1954306663412, -517.0560853130842, -362.9419464308544, -490.9555209901016, -1103.230952481755, -864.5076875283537, -384.06430129273804, -588.276661820829, -559.4993109845248, -994.1637834670012, -772.952861008554, -451.2966840293172, -1148.312601139493, -1285.2818432911565, -897.0904066976567, -404.10200623387317, -415.41391461020476, -999.2285924963469, -365.2566294527424, -896.8804614281072, -782.330584653487, -1346.7605406952339, -1016.7732107623001, -700.8823682054825, -53.08735817449118, -1021.9308732122215, -738.0778635951793, -733.1773188056204, -1298.3306706567712, -968.5526528715337, -468.81995817696094, -1324.8336121671157, -343.06068279946777, -1047.3593543024194, -701.628588423372, -767.5966748865053, -186.96574382457337, -498.15105013523544, -808.2028701114779, -742.7904805514083, -202.4250656358272, -1267.35389150149, -809.8093525779859, -8.013128453356718, -894.6161725833913, -543.0016572911557, -296.6758516095845, -277.6681745093892, -833.0199107828986, -640.6281768842463, -407.80921406397533, -1111.1433716418237, -839.976085808358, -568.6054416519728, -216.8165584241294, -895.1652628797074, -105.51170689445333, -106.97840247562887, -390.1031197835626, -619.0744122323448, -1174.451178437997, -186.6661328445805, -194.45398300625922, -561.2790413276375, -650.1166363489315, -803.1427013015763, -674.854331444534, -958.7202798953884, -229.75859325870306, -857.6943455905697, -356.75368911443866, -1199.6191632463033, -662.6392437208941, -92.28385943948498, -605.7877941425384, -994.9461265654634, -673.1787929968893, -869.5970886104594, -264.36513292137715, -878.4671254306827, -504.4079784276863, -757.6797736153394, -1274.2614032817821, -555.8387926338507, -790.6641181474969, -170.62389794172782, -978.4746405785387, -422.0521413160736, -698.4461624732752, -901.5940322091626, -884.4104511530581, -534.6167214037603, -771.7507686763955, -1435.062361802315, -241.6808682026536, -565.7390857282151, -758.3500885668939, -533.6950537520751, -1117.8571858823368, -451.1266441303664, -9.579407665027489, -1038.5921588438687, -893.8243049661561, -99.56392752507928, -739.7358497616186, -1289.1400103900007, -1071.5208856254717, -764.7918575632918, -676.4787787440603, -952.625514137904, -763.6942895326257, -868.790233374743, -907.3665825186956, -995.4032229282622, -397.7259596587203, -318.454076907669, -716.7626737336419, -513.835325566834, -194.89808609839423, -708.3507093400782, -831.4651363348991, -285.2802588938549, -573.7998934114459, -420.8921989268869, -178.18326787162033, -560.6979067889558, -413.80610705492546, -695.5789422235849, -662.9439558771054, -227.30231469808604, -714.6959360570531, -817.76914151906, -640.3622532216945, -838.9225118915525, -57.89594678010038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6667762893375055, "mean_inference_ms": 1.7580705159804668, "mean_action_processing_ms": 0.950364515036905, "mean_env_wait_ms": 11.135034694891965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01602339744567871, "StateBufferConnector_ms": 0.01148533821105957, "ViewRequirementAgentConnector_ms": 0.43854618072509766}, "num_episodes": 40, "episode_return_max": -1555.7411262197957, "episode_return_min": -4760.069379141325, "episode_return_mean": -3150.8424780053797, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279573, "num_agent_steps_trained": 279573, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.187407404014, "num_env_steps_trained_throughput_per_sec": 74.187407404014, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 279573, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 279573, "timers": {"training_iteration_time_ms": 54752.501, "restore_workers_time_ms": 0.029, "training_step_time_ms": 54752.428, "sample_time_ms": 3477.419, "learn_time_ms": 51214.662, "learn_throughput": 78.103, "synch_weights_time_ms": 57.181}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 279573, "num_agent_steps_trained": 279573}, "done": false, "training_iteration": 15, "trial_id": "05c72_00000", "date": "2024-07-26_14-56-20", "timestamp": 1721985980, "time_this_iter_s": 53.93057107925415, "time_total_s": 801.2592356204987, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805a8af0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 801.2592356204987, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 11.110526315789473, "ram_util_percent": 32.91578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.2808039052459, "cur_kl_coeff": 0.15000000000000002, "cur_lr": 0.001, "total_loss": 5.674131629905482, "policy_loss": 0.0016738454969706892, "vf_loss": 5.6865152418476415, "vf_explained_var": 0.9626761113090077, "kl": 0.02073563087232486, "entropy": 1.7167809491596002, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.13793103448276, "num_grad_updates_lifetime": 67965.5, "diff_num_grad_updates_vs_sampler_policy": 2174.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 298008, "num_agent_steps_trained": 298008}, "env_runners": {"episode_reward_max": -1555.7411262197957, "episode_reward_min": -4760.069379141325, "episode_reward_mean": -3134.773082218542, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1435.062361802315}, "policy_reward_max": {"policy_0": -7.195081564224313}, "policy_reward_mean": {"policy_0": -626.9546164437086}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3888.159097181669, -3164.1531940312757, -2528.794136732097, -2739.2655280191134, -4105.610911709154, -3627.3841616713617, -3676.463846574695, -2742.1368584768293, -2527.476814387987, -3477.3748324365583, -2518.083684121302, -3160.3554724534147, -2567.6137444588553, -4323.1699834890405, -2517.04090239053, -2465.349436633686, -2966.6254142302832, -1914.3325458718818, -3519.05145082793, -4441.586070267071, -3105.032767411486, -2971.90245157611, -2952.4480885077523, -4031.670609047992, -1847.7877319234906, -3576.8094181936262, -2862.017703076816, -3330.6351923192315, -3023.45321757006, -4077.528753883274, -2586.564129958416, -3035.9492220868533, -2276.6380996989296, -3465.4412942070103, -3402.177699605214, -2996.8031566778627, -1555.7411262197957, -3909.047595460758, -2081.0324050201334, -2257.7711970537434, -2677.100198307429, -2614.63561193794, -2030.2781077715017, -3142.035280747807, -1746.0637703721272, -3833.0834047662884, -3589.0102376085642, -2844.469344164148, -2780.394062563776, -4141.119809131007, -2197.1879892228912, -3118.213745177968, -3167.190872070999, -3342.3799358821348, -3390.511745093448, -4554.934396166179, -3080.8816042212757, -3899.8340624909965, -4760.069379141325, -3885.702195869341, -3003.7068195092015, -3182.2176107520518, -2590.9937710772742, -3144.3506715902613, -2116.8329042656965, -2766.9669719654066, -3524.170251490774, -2917.0837496636595, -3680.5542665248727, -3882.852066106156, -3171.190874518777, -3867.521171238181, -3426.768058059885, -2781.2956487617503, -4754.55704646073, -3932.980288013046, -2452.3008716466175, -2289.6207554387056, -2560.3292266426542, -3069.645789469462, -3292.7984763755103, -1971.5946031061403, -2865.610481076445, -4445.301337252248, -4684.575267842576, -3104.656518552747, -2718.2639737923823, -2605.046636815954, -2294.4627772958984, -2907.293155253178, -3005.6708679955004, -2662.8742776249283, -3330.2044253388417, -3593.0399466893414, -2839.6392254968764, -3712.053093267897, -2958.869317933623, -3131.3925479816003, -4130.627390454139, -3095.8193903428214], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-749.767264423888, -552.8807272963824, -546.6404215171564, -1014.1839839729308, -1024.6866999713134, -388.20436611778916, -1024.8037361500426, -136.9531083000532, -1038.0410242604719, -576.1509592029199, -563.8813201059779, -572.7893068995617, -1087.1783649427464, -205.9035115920484, -99.04163319176298, -136.33543890187983, -850.3642667144184, -792.6061259111167, -759.809956323248, -200.14974016844795, -783.1507251577634, -811.7169019572672, -604.0365149679244, -742.4778518654887, -1164.2289177607133, -876.8973917172584, -140.30380254471248, -820.0978874953324, -890.9156492874997, -899.1694306265571, -900.5390269675503, -67.91750152926873, -671.9067472118205, -1100.1775827776107, -935.9229880884449, -1090.039044144866, -173.02527014943433, -459.20500470533824, -607.6296020971643, -412.237937380025, -966.3158760185232, -84.31242929289125, -1084.6985555551744, -93.26270665883077, -298.88724686256774, -885.0468947001583, -197.02666547887912, -1161.178486304894, -192.85361211297808, -1041.2691738396525, -77.69519276557831, -227.35574330397168, -784.6198661941748, -928.3130640675907, -500.0998177899877, -757.9749645649869, -841.3338564546423, -666.6270117735985, -503.55117724118276, -390.86846241900537, -148.46724890815528, -584.8101749333431, -558.1741153694062, -681.2439990859662, -594.9182061619877, -977.5674125266585, -1193.8139381185258, -689.7670681822696, -775.5887710689809, -686.4327935926066, -455.9525401385013, -603.274488318864, -445.2096056953877, -953.4359183466485, -59.16834989113065, -470.55953093289776, -258.0947967401959, -130.8062674859645, -1076.1111351410361, -529.7777063335927, -421.46030827574293, -591.6274350339314, -671.9882899027667, -912.6461928950547, -368.9031881227827, -350.15033430323666, -87.3480863832639, -247.27106940844905, -1083.388285241325, -146.17477053560498, -912.0573197290972, -251.99483068172555, -439.9941890687222, -1035.116293186249, -879.888818162138, -1315.7919607756887, -530.4090596695576, -697.1564940342795, -533.0878151801053, -1365.1407406074416, -493.3103550481532, -639.5569828691908, -1015.4894480681498, -946.8714780502285, -9.804503375765048, -368.8523627385023, -818.9151013450571, -249.331335272152, -654.4149352690296, -880.3887169513716, -642.5734354968159, -746.7239161394232, -680.6970566064377, -330.42675568268487, -552.0269245823921, -519.6761053071642, -899.543160168954, -965.0918555451728, -766.582684884069, -880.7768031426282, -798.2749527083083, -880.4475494685291, -79.20033534471, -78.52436656773276, -11.340527834210198, -927.6465868783345, -502.83152358996364, -1021.1661061384065, -632.3749346822797, -492.7902669046423, -869.5050420775394, -152.26932951577518, -208.63566291435035, -601.5152839304825, -1030.0923846386713, -293.83795691595617, -869.8541245608845, -425.6829619939921, -429.4653501003158, -1311.7947987480788, -619.27323221719, -787.8360002169912, -289.4507537360522, -582.3058896429425, -744.5873417568887, -563.1882260368255, -514.2470801992367, -1293.3270184149258, -799.6108579016005, -907.1555713306902, -264.2216750355099, -167.04615354876506, -262.8045967455674, -558.9800101177403, -1333.5116945108327, -356.66775030589037, -401.319923408033, -1043.478756082595, -600.8629881676594, -633.6198041226767, -509.09899245838614, -389.5557257862475, -62.224916850027604, -411.2049301885021, -904.5535344157659, -538.6695327855336, -888.3573751540199, -784.2006746300973, -966.8306046759031, -287.38310696145675, -1269.7071875306801, -812.8695700710539, -531.430610158313, -671.6526118792212, -116.51771996594252, -1067.9672338211906, -370.1702882410788, -570.947802294164, -500.328400792236, -487.3894315291952, -302.03933227936074, -404.8759298032892, -233.99479633123482, -183.5066089907276, -431.324458815184, -554.3113817920846, -673.3010361014466, -947.2703383861757, -518.961378184277, -1215.2034609967748, -104.9122473438231, -487.42519629381496, -75.65945899914385, -290.24145279446725, -1122.7940495888843, -242.42197213954708, -872.989249772911, -922.2245297841621, -121.05406897239898, -99.08137638472549, -768.6454142572323, -82.908258719924, -992.6506321017164, -81.58914282817771, -751.3067504003785, -628.8443335617684, -566.5396015415257, -524.6680107710471, -12.035684491075896, -882.5479815725238, -72.6002544590466, -490.8827171969006, -115.98326692715628, -85.72576054858573, -1265.0861086398131, -180.2540175397538, -1054.7428262455858, -733.7692954953219, -781.3451517873503, -391.9239896797926, -538.8623411047625, -103.02606950841727, -56.165147169860845, -86.21519691242521, -961.7950156766609, -444.82110706865853, -1117.5103004337757, -1307.2578372357616, -611.7471153305451, -351.74704469754585, -745.029915141185, -75.13846875601882, -1256.5566888668432, -638.7055685915731, -873.5795962529456, -981.521276207636, -172.99703227915893, -212.70020245458144, -365.5020361514368, -1111.7487970713337, -941.1564646738971, -87.5333154334379, -866.0273151536571, -683.3936040366384, -202.2833632661439, -659.2758558440888, -549.6573138844308, -828.1693518624883, -1023.5928811766227, -1080.4244063633796, -286.7914920345605, -92.63238755143121, -627.8923990903194, -961.5691161150423, -228.30259443153625, -638.9056175041902, -950.3848883080351, -704.301236635732, -783.2309821952573, -41.39102053475293, -895.4860523296995, -181.45288612457597, -287.92638367894955, -1291.1482025895148, -511.17734734826047, -868.1954306663412, -517.0560853130842, -362.9419464308544, -490.9555209901016, -1103.230952481755, -864.5076875283537, -384.06430129273804, -588.276661820829, -559.4993109845248, -994.1637834670012, -772.952861008554, -451.2966840293172, -1148.312601139493, -1285.2818432911565, -897.0904066976567, -404.10200623387317, -415.41391461020476, -999.2285924963469, -365.2566294527424, -896.8804614281072, -782.330584653487, -1346.7605406952339, -1016.7732107623001, -700.8823682054825, -53.08735817449118, -1021.9308732122215, -738.0778635951793, -733.1773188056204, -1298.3306706567712, -968.5526528715337, -468.81995817696094, -1324.8336121671157, -343.06068279946777, -1047.3593543024194, -701.628588423372, -767.5966748865053, -186.96574382457337, -498.15105013523544, -808.2028701114779, -742.7904805514083, -202.4250656358272, -1267.35389150149, -809.8093525779859, -8.013128453356718, -894.6161725833913, -543.0016572911557, -296.6758516095845, -277.6681745093892, -833.0199107828986, -640.6281768842463, -407.80921406397533, -1111.1433716418237, -839.976085808358, -568.6054416519728, -216.8165584241294, -895.1652628797074, -105.51170689445333, -106.97840247562887, -390.1031197835626, -619.0744122323448, -1174.451178437997, -186.6661328445805, -194.45398300625922, -561.2790413276375, -650.1166363489315, -803.1427013015763, -674.854331444534, -958.7202798953884, -229.75859325870306, -857.6943455905697, -356.75368911443866, -1199.6191632463033, -662.6392437208941, -92.28385943948498, -605.7877941425384, -994.9461265654634, -673.1787929968893, -869.5970886104594, -264.36513292137715, -878.4671254306827, -504.4079784276863, -757.6797736153394, -1274.2614032817821, -555.8387926338507, -790.6641181474969, -170.62389794172782, -978.4746405785387, -422.0521413160736, -698.4461624732752, -901.5940322091626, -884.4104511530581, -534.6167214037603, -771.7507686763955, -1435.062361802315, -241.6808682026536, -565.7390857282151, -758.3500885668939, -533.6950537520751, -1117.8571858823368, -451.1266441303664, -9.579407665027489, -1038.5921588438687, -893.8243049661561, -99.56392752507928, -739.7358497616186, -1289.1400103900007, -1071.5208856254717, -764.7918575632918, -676.4787787440603, -952.625514137904, -763.6942895326257, -868.790233374743, -907.3665825186956, -995.4032229282622, -397.7259596587203, -318.454076907669, -716.7626737336419, -513.835325566834, -194.89808609839423, -708.3507093400782, -831.4651363348991, -285.2802588938549, -573.7998934114459, -420.8921989268869, -178.18326787162033, -560.6979067889558, -413.80610705492546, -695.5789422235849, -662.9439558771054, -227.30231469808604, -714.6959360570531, -817.76914151906, -640.3622532216945, -838.9225118915525, -57.89594678010038, -385.92031978450785, -978.3142255914186, -398.50284943580124, -1101.371599436274, -428.689482127513, -598.7851777123618, -101.31918857442618, -671.9015143591608, -417.4434173221152, -182.14530513807807, -286.9143329752036, -971.6452066427249, -528.7422925877108, -255.24547819931095, -823.0631706714979, -1246.2403381808247, -606.2586236593278, -750.9578348057793, -965.0172855715585, -876.827255034761, -815.6373376690551, -1035.2506796721943, -958.6002561311439, -872.3117047036295, -1002.7752896665606, -718.5107195729177, -940.4623497832607, -7.195081564224313, -842.4110055476285, -596.0773620847147, -635.8495474272358, -873.4483320400598, -382.06939430328237, -592.9492491531452, -233.94745086866251, -417.0199755020817, -922.5795281060489, -782.7752646063437, -200.10440470455978, -282.5674638969193, -277.33636398512493, -706.8376055191721, -448.49185273961666, -762.5014656769761, -99.29548937500797, -782.0635844641444, -313.08593857086925, -236.5528934125917, -701.5283574877777, -874.0623813177966, -422.7759901640904, -764.8118600105769, -1039.4054598504877, -412.9392215879132, -365.7383363824332, -946.4745424196343, -832.5911159842491, -114.58176262315995, -75.59815559551123, -693.6287010023748, -566.3889142551487, -804.5545505159293, -125.24670886180661, -832.4597805680135, -1001.5544711379404, -831.6485953641622, -974.7612650471518, -667.86635277674, -516.5190484462798, -602.2446850550073, -610.961256779976, -941.5145536117323, -557.2821937769143, -682.4621721179917, -47.41904921026122, -1349.702332082201, -769.1321558701748, -1055.8346987014802, -199.4767770605593, -337.907129553483, -840.8017625691759, -270.0555180885233, -948.3529246770039, -81.15905264340486, -818.5000599555138, -445.5621944333965, -245.63936652726113, -950.9403764902314, -376.61883872625003, -1112.6317718044595, -176.65130041286463, -1314.974704731209, -1312.980822852092, -536.010920055667, -790.0096424023062, -747.9482358290171, -415.97199721043717, -1017.4756596933275, -313.7025509322108, -600.7209466778298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6617336390686666, "mean_inference_ms": 1.7519596326146196, "mean_action_processing_ms": 0.9380212456200734, "mean_env_wait_ms": 11.077970438044229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01630878448486328, "StateBufferConnector_ms": 0.011675834655761719, "ViewRequirementAgentConnector_ms": 0.4445607662200928}, "num_episodes": 20, "episode_return_max": -1555.7411262197957, "episode_return_min": -4760.069379141325, "episode_return_mean": -3134.773082218542, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 298008, "num_agent_steps_trained": 298008, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.58382884738083, "num_env_steps_trained_throughput_per_sec": 71.58382884738083, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 298008, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 298008, "timers": {"training_iteration_time_ms": 54413.729, "restore_workers_time_ms": 0.029, "training_step_time_ms": 54413.655, "sample_time_ms": 3491.169, "learn_time_ms": 50863.151, "learn_throughput": 78.642, "synch_weights_time_ms": 56.225}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 298008, "num_agent_steps_trained": 298008}, "done": false, "training_iteration": 16, "trial_id": "05c72_00000", "date": "2024-07-26_14-57-16", "timestamp": 1721986036, "time_this_iter_s": 55.88782358169556, "time_total_s": 857.1470592021942, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805ab370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 857.1470592021942, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 11.211250000000001, "ram_util_percent": 32.99249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 166.69283657442546, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000007, "total_loss": 5.373472011607626, "policy_loss": -0.0021563982682140624, "vf_loss": 5.388671359059892, "vf_explained_var": 0.974145802207615, "kl": 0.018454187212102482, "entropy": 1.7195141605420965, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.15217391304348, "num_grad_updates_lifetime": 72210.5, "diff_num_grad_updates_vs_sampler_policy": 2069.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 315555, "num_agent_steps_trained": 315555}, "env_runners": {"episode_reward_max": -1555.7411262197957, "episode_reward_min": -4760.069379141325, "episode_reward_mean": -3134.4607986808614, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1435.062361802315}, "policy_reward_max": {"policy_0": -7.195081564224313}, "policy_reward_mean": {"policy_0": -626.8921597361723}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3105.032767411486, -2971.90245157611, -2952.4480885077523, -4031.670609047992, -1847.7877319234906, -3576.8094181936262, -2862.017703076816, -3330.6351923192315, -3023.45321757006, -4077.528753883274, -2586.564129958416, -3035.9492220868533, -2276.6380996989296, -3465.4412942070103, -3402.177699605214, -2996.8031566778627, -1555.7411262197957, -3909.047595460758, -2081.0324050201334, -2257.7711970537434, -2677.100198307429, -2614.63561193794, -2030.2781077715017, -3142.035280747807, -1746.0637703721272, -3833.0834047662884, -3589.0102376085642, -2844.469344164148, -2780.394062563776, -4141.119809131007, -2197.1879892228912, -3118.213745177968, -3167.190872070999, -3342.3799358821348, -3390.511745093448, -4554.934396166179, -3080.8816042212757, -3899.8340624909965, -4760.069379141325, -3885.702195869341, -3003.7068195092015, -3182.2176107520518, -2590.9937710772742, -3144.3506715902613, -2116.8329042656965, -2766.9669719654066, -3524.170251490774, -2917.0837496636595, -3680.5542665248727, -3882.852066106156, -3171.190874518777, -3867.521171238181, -3426.768058059885, -2781.2956487617503, -4754.55704646073, -3932.980288013046, -2452.3008716466175, -2289.6207554387056, -2560.3292266426542, -3069.645789469462, -3292.7984763755103, -1971.5946031061403, -2865.610481076445, -4445.301337252248, -4684.575267842576, -3104.656518552747, -2718.2639737923823, -2605.046636815954, -2294.4627772958984, -2907.293155253178, -3005.6708679955004, -2662.8742776249283, -3330.2044253388417, -3593.0399466893414, -2839.6392254968764, -3712.053093267897, -2958.869317933623, -3131.3925479816003, -4130.627390454139, -3095.8193903428214, -3631.863968866225, -3068.3195069848584, -3310.119767178393, -3038.856290857534, -3405.5799612449796, -3236.7706220126506, -2101.952428500359, -3046.408115495787, -2749.6788576892295, -2379.7131258592426, -2907.4776131293, -2901.0860165864397, -4625.437551919204, -2123.8595759511823, -3501.692212859846, -3070.055332365959, -3200.6838522116163, -3102.4292829528076, -4538.985564417893, -2897.830085113093], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-493.3103550481532, -639.5569828691908, -1015.4894480681498, -946.8714780502285, -9.804503375765048, -368.8523627385023, -818.9151013450571, -249.331335272152, -654.4149352690296, -880.3887169513716, -642.5734354968159, -746.7239161394232, -680.6970566064377, -330.42675568268487, -552.0269245823921, -519.6761053071642, -899.543160168954, -965.0918555451728, -766.582684884069, -880.7768031426282, -798.2749527083083, -880.4475494685291, -79.20033534471, -78.52436656773276, -11.340527834210198, -927.6465868783345, -502.83152358996364, -1021.1661061384065, -632.3749346822797, -492.7902669046423, -869.5050420775394, -152.26932951577518, -208.63566291435035, -601.5152839304825, -1030.0923846386713, -293.83795691595617, -869.8541245608845, -425.6829619939921, -429.4653501003158, -1311.7947987480788, -619.27323221719, -787.8360002169912, -289.4507537360522, -582.3058896429425, -744.5873417568887, -563.1882260368255, -514.2470801992367, -1293.3270184149258, -799.6108579016005, -907.1555713306902, -264.2216750355099, -167.04615354876506, -262.8045967455674, -558.9800101177403, -1333.5116945108327, -356.66775030589037, -401.319923408033, -1043.478756082595, -600.8629881676594, -633.6198041226767, -509.09899245838614, -389.5557257862475, -62.224916850027604, -411.2049301885021, -904.5535344157659, -538.6695327855336, -888.3573751540199, -784.2006746300973, -966.8306046759031, -287.38310696145675, -1269.7071875306801, -812.8695700710539, -531.430610158313, -671.6526118792212, -116.51771996594252, -1067.9672338211906, -370.1702882410788, -570.947802294164, -500.328400792236, -487.3894315291952, -302.03933227936074, -404.8759298032892, -233.99479633123482, -183.5066089907276, -431.324458815184, -554.3113817920846, -673.3010361014466, -947.2703383861757, -518.961378184277, -1215.2034609967748, -104.9122473438231, -487.42519629381496, -75.65945899914385, -290.24145279446725, -1122.7940495888843, -242.42197213954708, -872.989249772911, -922.2245297841621, -121.05406897239898, -99.08137638472549, -768.6454142572323, -82.908258719924, -992.6506321017164, -81.58914282817771, -751.3067504003785, -628.8443335617684, -566.5396015415257, -524.6680107710471, -12.035684491075896, -882.5479815725238, -72.6002544590466, -490.8827171969006, -115.98326692715628, -85.72576054858573, -1265.0861086398131, -180.2540175397538, -1054.7428262455858, -733.7692954953219, -781.3451517873503, -391.9239896797926, -538.8623411047625, -103.02606950841727, -56.165147169860845, -86.21519691242521, -961.7950156766609, -444.82110706865853, -1117.5103004337757, -1307.2578372357616, -611.7471153305451, -351.74704469754585, -745.029915141185, -75.13846875601882, -1256.5566888668432, -638.7055685915731, -873.5795962529456, -981.521276207636, -172.99703227915893, -212.70020245458144, -365.5020361514368, -1111.7487970713337, -941.1564646738971, -87.5333154334379, -866.0273151536571, -683.3936040366384, -202.2833632661439, -659.2758558440888, -549.6573138844308, -828.1693518624883, -1023.5928811766227, -1080.4244063633796, -286.7914920345605, -92.63238755143121, -627.8923990903194, -961.5691161150423, -228.30259443153625, -638.9056175041902, -950.3848883080351, -704.301236635732, -783.2309821952573, -41.39102053475293, -895.4860523296995, -181.45288612457597, -287.92638367894955, -1291.1482025895148, -511.17734734826047, -868.1954306663412, -517.0560853130842, -362.9419464308544, -490.9555209901016, -1103.230952481755, -864.5076875283537, -384.06430129273804, -588.276661820829, -559.4993109845248, -994.1637834670012, -772.952861008554, -451.2966840293172, -1148.312601139493, -1285.2818432911565, -897.0904066976567, -404.10200623387317, -415.41391461020476, -999.2285924963469, -365.2566294527424, -896.8804614281072, -782.330584653487, -1346.7605406952339, -1016.7732107623001, -700.8823682054825, -53.08735817449118, -1021.9308732122215, -738.0778635951793, -733.1773188056204, -1298.3306706567712, -968.5526528715337, -468.81995817696094, -1324.8336121671157, -343.06068279946777, -1047.3593543024194, -701.628588423372, -767.5966748865053, -186.96574382457337, -498.15105013523544, -808.2028701114779, -742.7904805514083, -202.4250656358272, -1267.35389150149, -809.8093525779859, -8.013128453356718, -894.6161725833913, -543.0016572911557, -296.6758516095845, -277.6681745093892, -833.0199107828986, -640.6281768842463, -407.80921406397533, -1111.1433716418237, -839.976085808358, -568.6054416519728, -216.8165584241294, -895.1652628797074, -105.51170689445333, -106.97840247562887, -390.1031197835626, -619.0744122323448, -1174.451178437997, -186.6661328445805, -194.45398300625922, -561.2790413276375, -650.1166363489315, -803.1427013015763, -674.854331444534, -958.7202798953884, -229.75859325870306, -857.6943455905697, -356.75368911443866, -1199.6191632463033, -662.6392437208941, -92.28385943948498, -605.7877941425384, -994.9461265654634, -673.1787929968893, -869.5970886104594, -264.36513292137715, -878.4671254306827, -504.4079784276863, -757.6797736153394, -1274.2614032817821, -555.8387926338507, -790.6641181474969, -170.62389794172782, -978.4746405785387, -422.0521413160736, -698.4461624732752, -901.5940322091626, -884.4104511530581, -534.6167214037603, -771.7507686763955, -1435.062361802315, -241.6808682026536, -565.7390857282151, -758.3500885668939, -533.6950537520751, -1117.8571858823368, -451.1266441303664, -9.579407665027489, -1038.5921588438687, -893.8243049661561, -99.56392752507928, -739.7358497616186, -1289.1400103900007, -1071.5208856254717, -764.7918575632918, -676.4787787440603, -952.625514137904, -763.6942895326257, -868.790233374743, -907.3665825186956, -995.4032229282622, -397.7259596587203, -318.454076907669, -716.7626737336419, -513.835325566834, -194.89808609839423, -708.3507093400782, -831.4651363348991, -285.2802588938549, -573.7998934114459, -420.8921989268869, -178.18326787162033, -560.6979067889558, -413.80610705492546, -695.5789422235849, -662.9439558771054, -227.30231469808604, -714.6959360570531, -817.76914151906, -640.3622532216945, -838.9225118915525, -57.89594678010038, -385.92031978450785, -978.3142255914186, -398.50284943580124, -1101.371599436274, -428.689482127513, -598.7851777123618, -101.31918857442618, -671.9015143591608, -417.4434173221152, -182.14530513807807, -286.9143329752036, -971.6452066427249, -528.7422925877108, -255.24547819931095, -823.0631706714979, -1246.2403381808247, -606.2586236593278, -750.9578348057793, -965.0172855715585, -876.827255034761, -815.6373376690551, -1035.2506796721943, -958.6002561311439, -872.3117047036295, -1002.7752896665606, -718.5107195729177, -940.4623497832607, -7.195081564224313, -842.4110055476285, -596.0773620847147, -635.8495474272358, -873.4483320400598, -382.06939430328237, -592.9492491531452, -233.94745086866251, -417.0199755020817, -922.5795281060489, -782.7752646063437, -200.10440470455978, -282.5674638969193, -277.33636398512493, -706.8376055191721, -448.49185273961666, -762.5014656769761, -99.29548937500797, -782.0635844641444, -313.08593857086925, -236.5528934125917, -701.5283574877777, -874.0623813177966, -422.7759901640904, -764.8118600105769, -1039.4054598504877, -412.9392215879132, -365.7383363824332, -946.4745424196343, -832.5911159842491, -114.58176262315995, -75.59815559551123, -693.6287010023748, -566.3889142551487, -804.5545505159293, -125.24670886180661, -832.4597805680135, -1001.5544711379404, -831.6485953641622, -974.7612650471518, -667.86635277674, -516.5190484462798, -602.2446850550073, -610.961256779976, -941.5145536117323, -557.2821937769143, -682.4621721179917, -47.41904921026122, -1349.702332082201, -769.1321558701748, -1055.8346987014802, -199.4767770605593, -337.907129553483, -840.8017625691759, -270.0555180885233, -948.3529246770039, -81.15905264340486, -818.5000599555138, -445.5621944333965, -245.63936652726113, -950.9403764902314, -376.61883872625003, -1112.6317718044595, -176.65130041286463, -1314.974704731209, -1312.980822852092, -536.010920055667, -790.0096424023062, -747.9482358290171, -415.97199721043717, -1017.4756596933275, -313.7025509322108, -600.7209466778298, -1143.3154945742647, -657.0177716872125, -806.2492826152417, -412.13473468292085, -613.1466853065846, -300.38657686088607, -464.7638838519537, -899.7383628145913, -720.5786530002587, -682.8520304571666, -905.5757024572986, -1138.2761485997637, -533.2091959896285, -234.18869045875715, -498.8700296729463, -256.96056142491926, -1003.5123949035267, -951.8413105394932, -35.21819246957841, -791.3238315200164, -553.1738365185176, -609.3578541009906, -647.4485906053493, -809.0095872451609, -786.5900927749593, -42.322005466254296, -874.9301195604587, -136.76660570773154, -1338.0523598005373, -844.6995314776674, -245.70133672413917, -567.9947712203368, -568.0362633120562, -328.1398794200917, -392.08017782373645, -485.08186919910594, -480.96998363872876, -770.3840605062964, -975.9120204382859, -334.06018171337047, -473.3781120536162, -730.8400963238239, -378.65431054194147, -1086.5959435632185, -80.21039520662607, -379.6071885094847, -855.212753168531, -244.40039147817063, -414.35204661599914, -486.1407460870608, -25.70308547594792, -1381.796424360822, -629.4180216556858, -386.92309026704976, -483.63699136978994, -615.9738368129422, -61.177375503616034, -973.6757119750462, -968.9593207890159, -281.2997715058193, -172.06287500215103, -1343.7304059222163, -944.0600143663631, -1029.3304296990102, -1136.2538269294648, -17.116798232193812, -551.4504040648663, -539.4486764761689, -177.21664227755508, -838.6270549003976, -278.0968892851098, -1172.0873529417136, -420.2495105216233, -847.6488985248807, -783.6095615865194, -398.7372576876518, -1281.8768066858831, -574.9423618756981, -614.2918746296721, -200.20703148705687, -413.72642892871045, -871.6752047717654, -135.5976956961023, -511.9199039220558, -1267.764618892983, -131.5770757544055, -386.1849555618143, -649.1576162160223, -758.788297853695, -1176.7213375668687, -1271.8898829032037, -842.8957122126228, -124.72026921042784, -1075.6303335618954, -1223.8493665297417, -358.02405737043074, -591.9782371063694, -1040.1893136682047, -845.4033020416155, -62.2351749264756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6578751447033915, "mean_inference_ms": 1.7503878501972532, "mean_action_processing_ms": 0.9327701758855705, "mean_env_wait_ms": 11.065715763926246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016376972198486328, "StateBufferConnector_ms": 0.011612176895141602, "ViewRequirementAgentConnector_ms": 0.4397008419036865}, "num_episodes": 20, "episode_return_max": -1555.7411262197957, "episode_return_min": -4760.069379141325, "episode_return_mean": -3134.4607986808614, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 315555, "num_agent_steps_trained": 315555, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.3506704328083, "num_env_steps_trained_throughput_per_sec": 76.3506704328083, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 315555, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 315555, "timers": {"training_iteration_time_ms": 54245.141, "restore_workers_time_ms": 0.029, "training_step_time_ms": 54245.067, "sample_time_ms": 3468.818, "learn_time_ms": 50715.154, "learn_throughput": 78.872, "synch_weights_time_ms": 57.953}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 315555, "num_agent_steps_trained": 315555}, "done": false, "training_iteration": 17, "trial_id": "05c72_00000", "date": "2024-07-26_14-58-08", "timestamp": 1721986088, "time_this_iter_s": 52.40181374549866, "time_total_s": 909.5488729476929, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d28052bac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 909.5488729476929, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 11.13108108108108, "ram_util_percent": 32.902702702702705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 180.48009910409309, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000002, "total_loss": 5.204446129194678, "policy_loss": -0.003090501518932822, "vf_loss": 5.220927905709776, "vf_explained_var": 0.9772841722181399, "kl": 0.018737787507542465, "entropy": 1.7607280972613593, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.1986301369863, "num_grad_updates_lifetime": 76470.5, "diff_num_grad_updates_vs_sampler_policy": 2189.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 334126, "num_agent_steps_trained": 334126}, "env_runners": {"episode_reward_max": -1079.008018894998, "episode_reward_min": -4754.55704646073, "episode_reward_mean": -3074.5015532818193, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1435.062361802315}, "policy_reward_max": {"policy_0": -6.097236312365169}, "policy_reward_mean": {"policy_0": -614.900310656364}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3003.7068195092015, -3182.2176107520518, -2590.9937710772742, -3144.3506715902613, -2116.8329042656965, -2766.9669719654066, -3524.170251490774, -2917.0837496636595, -3680.5542665248727, -3882.852066106156, -3171.190874518777, -3867.521171238181, -3426.768058059885, -2781.2956487617503, -4754.55704646073, -3932.980288013046, -2452.3008716466175, -2289.6207554387056, -2560.3292266426542, -3069.645789469462, -3292.7984763755103, -1971.5946031061403, -2865.610481076445, -4445.301337252248, -4684.575267842576, -3104.656518552747, -2718.2639737923823, -2605.046636815954, -2294.4627772958984, -2907.293155253178, -3005.6708679955004, -2662.8742776249283, -3330.2044253388417, -3593.0399466893414, -2839.6392254968764, -3712.053093267897, -2958.869317933623, -3131.3925479816003, -4130.627390454139, -3095.8193903428214, -3631.863968866225, -3068.3195069848584, -3310.119767178393, -3038.856290857534, -3405.5799612449796, -3236.7706220126506, -2101.952428500359, -3046.408115495787, -2749.6788576892295, -2379.7131258592426, -2907.4776131293, -2901.0860165864397, -4625.437551919204, -2123.8595759511823, -3501.692212859846, -3070.055332365959, -3200.6838522116163, -3102.4292829528076, -4538.985564417893, -2897.830085113093, -2324.0776490195917, -2389.3113335712032, -3516.8263824237824, -4459.351399612903, -2442.031951991847, -2850.2478632345224, -1845.3838754358212, -3101.884956601831, -3457.5132779177193, -3208.3031781408567, -1921.729659925911, -3398.5532208606774, -3793.523838777092, -1079.008018894998, -2999.7656645203406, -2748.3463076444536, -2929.3568133479985, -2820.839957372123, -3350.026995209818, -2544.155130887381, -2844.9070373230325, -3276.5298925125576, -1813.517388550631, -4510.276607539887, -2439.8483115875647, -3892.431560915245, -2760.383545700093, -2469.4395444739553, -1869.8597143185218, -2308.435784691743, -3053.1495863066298, -2972.7502354623894, -3967.801391177233, -3438.1921613462455, -2641.3758701548954, -4333.263771308426, -2412.2859935195193, -3583.5406360640827, -2764.5567566189, -3612.8398073391463], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-767.5966748865053, -186.96574382457337, -498.15105013523544, -808.2028701114779, -742.7904805514083, -202.4250656358272, -1267.35389150149, -809.8093525779859, -8.013128453356718, -894.6161725833913, -543.0016572911557, -296.6758516095845, -277.6681745093892, -833.0199107828986, -640.6281768842463, -407.80921406397533, -1111.1433716418237, -839.976085808358, -568.6054416519728, -216.8165584241294, -895.1652628797074, -105.51170689445333, -106.97840247562887, -390.1031197835626, -619.0744122323448, -1174.451178437997, -186.6661328445805, -194.45398300625922, -561.2790413276375, -650.1166363489315, -803.1427013015763, -674.854331444534, -958.7202798953884, -229.75859325870306, -857.6943455905697, -356.75368911443866, -1199.6191632463033, -662.6392437208941, -92.28385943948498, -605.7877941425384, -994.9461265654634, -673.1787929968893, -869.5970886104594, -264.36513292137715, -878.4671254306827, -504.4079784276863, -757.6797736153394, -1274.2614032817821, -555.8387926338507, -790.6641181474969, -170.62389794172782, -978.4746405785387, -422.0521413160736, -698.4461624732752, -901.5940322091626, -884.4104511530581, -534.6167214037603, -771.7507686763955, -1435.062361802315, -241.6808682026536, -565.7390857282151, -758.3500885668939, -533.6950537520751, -1117.8571858823368, -451.1266441303664, -9.579407665027489, -1038.5921588438687, -893.8243049661561, -99.56392752507928, -739.7358497616186, -1289.1400103900007, -1071.5208856254717, -764.7918575632918, -676.4787787440603, -952.625514137904, -763.6942895326257, -868.790233374743, -907.3665825186956, -995.4032229282622, -397.7259596587203, -318.454076907669, -716.7626737336419, -513.835325566834, -194.89808609839423, -708.3507093400782, -831.4651363348991, -285.2802588938549, -573.7998934114459, -420.8921989268869, -178.18326787162033, -560.6979067889558, -413.80610705492546, -695.5789422235849, -662.9439558771054, -227.30231469808604, -714.6959360570531, -817.76914151906, -640.3622532216945, -838.9225118915525, -57.89594678010038, -385.92031978450785, -978.3142255914186, -398.50284943580124, -1101.371599436274, -428.689482127513, -598.7851777123618, -101.31918857442618, -671.9015143591608, -417.4434173221152, -182.14530513807807, -286.9143329752036, -971.6452066427249, -528.7422925877108, -255.24547819931095, -823.0631706714979, -1246.2403381808247, -606.2586236593278, -750.9578348057793, -965.0172855715585, -876.827255034761, -815.6373376690551, -1035.2506796721943, -958.6002561311439, -872.3117047036295, -1002.7752896665606, -718.5107195729177, -940.4623497832607, -7.195081564224313, -842.4110055476285, -596.0773620847147, -635.8495474272358, -873.4483320400598, -382.06939430328237, -592.9492491531452, -233.94745086866251, -417.0199755020817, -922.5795281060489, -782.7752646063437, -200.10440470455978, -282.5674638969193, -277.33636398512493, -706.8376055191721, -448.49185273961666, -762.5014656769761, -99.29548937500797, -782.0635844641444, -313.08593857086925, -236.5528934125917, -701.5283574877777, -874.0623813177966, -422.7759901640904, -764.8118600105769, -1039.4054598504877, -412.9392215879132, -365.7383363824332, -946.4745424196343, -832.5911159842491, -114.58176262315995, -75.59815559551123, -693.6287010023748, -566.3889142551487, -804.5545505159293, -125.24670886180661, -832.4597805680135, -1001.5544711379404, -831.6485953641622, -974.7612650471518, -667.86635277674, -516.5190484462798, -602.2446850550073, -610.961256779976, -941.5145536117323, -557.2821937769143, -682.4621721179917, -47.41904921026122, -1349.702332082201, -769.1321558701748, -1055.8346987014802, -199.4767770605593, -337.907129553483, -840.8017625691759, -270.0555180885233, -948.3529246770039, -81.15905264340486, -818.5000599555138, -445.5621944333965, -245.63936652726113, -950.9403764902314, -376.61883872625003, -1112.6317718044595, -176.65130041286463, -1314.974704731209, -1312.980822852092, -536.010920055667, -790.0096424023062, -747.9482358290171, -415.97199721043717, -1017.4756596933275, -313.7025509322108, -600.7209466778298, -1143.3154945742647, -657.0177716872125, -806.2492826152417, -412.13473468292085, -613.1466853065846, -300.38657686088607, -464.7638838519537, -899.7383628145913, -720.5786530002587, -682.8520304571666, -905.5757024572986, -1138.2761485997637, -533.2091959896285, -234.18869045875715, -498.8700296729463, -256.96056142491926, -1003.5123949035267, -951.8413105394932, -35.21819246957841, -791.3238315200164, -553.1738365185176, -609.3578541009906, -647.4485906053493, -809.0095872451609, -786.5900927749593, -42.322005466254296, -874.9301195604587, -136.76660570773154, -1338.0523598005373, -844.6995314776674, -245.70133672413917, -567.9947712203368, -568.0362633120562, -328.1398794200917, -392.08017782373645, -485.08186919910594, -480.96998363872876, -770.3840605062964, -975.9120204382859, -334.06018171337047, -473.3781120536162, -730.8400963238239, -378.65431054194147, -1086.5959435632185, -80.21039520662607, -379.6071885094847, -855.212753168531, -244.40039147817063, -414.35204661599914, -486.1407460870608, -25.70308547594792, -1381.796424360822, -629.4180216556858, -386.92309026704976, -483.63699136978994, -615.9738368129422, -61.177375503616034, -973.6757119750462, -968.9593207890159, -281.2997715058193, -172.06287500215103, -1343.7304059222163, -944.0600143663631, -1029.3304296990102, -1136.2538269294648, -17.116798232193812, -551.4504040648663, -539.4486764761689, -177.21664227755508, -838.6270549003976, -278.0968892851098, -1172.0873529417136, -420.2495105216233, -847.6488985248807, -783.6095615865194, -398.7372576876518, -1281.8768066858831, -574.9423618756981, -614.2918746296721, -200.20703148705687, -413.72642892871045, -871.6752047717654, -135.5976956961023, -511.9199039220558, -1267.764618892983, -131.5770757544055, -386.1849555618143, -649.1576162160223, -758.788297853695, -1176.7213375668687, -1271.8898829032037, -842.8957122126228, -124.72026921042784, -1075.6303335618954, -1223.8493665297417, -358.02405737043074, -591.9782371063694, -1040.1893136682047, -845.4033020416155, -62.2351749264756, -740.8148665238923, -255.2342930946577, -463.16726200912836, -474.56334897985784, -390.2978784120554, -322.90646988286005, -832.5767173152823, -363.5708087598431, -674.6995389448853, -195.55779866833333, -973.519379556188, -660.6961425234945, -1101.987868548124, -327.0064345048468, -453.6165572911306, -800.5209945811259, -776.806108494679, -1374.075198758952, -589.6223454437079, -918.3267523344399, -658.5042848897624, -282.31451333359996, -881.9531670564204, -362.2039829898403, -257.05600372222455, -780.5158035337502, -23.543568654974283, -394.21338403078107, -1135.0124026136295, -516.9627044013881, -577.9197038937344, -954.1629812589176, -203.38464256907517, -56.449886623114594, -53.46666109097913, -247.27005387767258, -456.9292738526182, -964.6425412716271, -744.5760495004301, -688.467038099482, -980.2906031158848, -785.487259339456, -769.7828432873702, -787.7271330728887, -134.2254391021232, -348.39626096484653, -638.6088644560512, -829.4157478993827, -539.7993448206855, -852.0829599998905, -484.3896404533113, -992.2114170545102, -216.76890580240507, -145.0607114313884, -83.29898518429705, -40.67521493050607, -1305.8612529708494, -981.3788500334529, -388.4248544436617, -682.2130484822025, -1185.9384789195906, -286.59637089260065, -72.71031500809114, -1313.9112069436528, -934.3674670131593, -305.5004940205407, -140.93797612559112, -153.59021329369813, -404.9911630569083, -73.98817239826018, -483.1404395606096, -697.4746418983087, -135.11428231343268, -659.4757470207504, -1024.5605537272436, -933.3379520461983, -221.94317702796195, -662.9603384743249, -593.0748986109749, -337.02994148499107, -292.1249625716043, -260.60450141794445, -595.0753523422457, -1004.6342099874375, -776.917787028767, -127.51976817516923, -383.303813655424, -785.8263207145027, -774.7325784085476, -749.4574764184829, -94.5963140269985, -770.6039200075753, -1092.1339121227365, -1260.0992917020549, -132.59355735045108, -1015.1640571086397, -710.4839038764203, -33.59280752902051, -118.56832189556259, -666.3460404777366, -602.3793175507813, -290.1746304734544, -851.9064933253243, -350.83017515941805, -749.6164208140563, -454.79442250760417, -432.30536033731516, -570.438768340974, -1069.520277572798, -749.4710637538642, -1041.213214077034, -358.5766771966122, -10.171984256963404, -192.7267595792759, -210.82875344074606, -676.3406274501583, -999.6869365848252, -970.6643314119902, -505.3983176832654, -1358.1863944096476, -168.6685104186936, -613.6797572319298, -732.3879270740211, -756.5277165067708, -168.5844003561471, -636.7508213701207, -422.98422486112497, -1067.9552713588075, -1090.3102801461255, -674.4309631790637, -756.7728382398558, -78.57077971325582, -132.53050197728237, -1039.6026211621702, -752.9068046075279, -465.7970546845574, -274.9031331734354, -1104.0015934715718, -147.57200408797533, -477.16575905641366, -187.34670172654413, -529.9726838330488, -499.50565985849136, -79.2560538083957, -573.7786150920429, -661.4315521908395, -51.24448602481307, -620.6301950709184, -348.15729239186976, -626.9722590133049, -159.07055925268563, -742.0560035927793, -478.6837836871685, -958.7102878449111, -714.6289519290833, -388.73296101469305, -1355.2500906756843, -798.8933188804021, -405.6043970685311, -24.26946782307884, -1136.598121604721, -913.2677796090321, -492.1240350172704, -848.902731646346, -576.9087232998619, -783.1442381433083, -516.7496466085729, -761.0138449569113, -831.3930879724319, -545.891343665018, -305.3534545234373, -714.0445307009185, -831.1547944860313, -241.59431507422877, -549.2287753702805, -1038.3750606957806, -1118.92588994839, -539.989063009499, -904.719827314197, -731.2539303405675, -629.8059592962675, -289.2259665177805, -359.3192212457725, -44.07553848181018, -1089.859307977889, -309.0698234575028, -755.2635931061344, -1084.5013798173986, -559.0177270095463, -875.6881126735003, -859.7084711858754, -530.097762841129, -6.097236312365169, -143.25944754229192, -1225.393838737237, -260.70186042554286, -1389.9597768471444, -714.3925706969275, -376.20821936292043, -871.5773800066136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6536149443674752, "mean_inference_ms": 1.7524372438861813, "mean_action_processing_ms": 0.929322274107751, "mean_env_wait_ms": 11.07729926878819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015716552734375, "StateBufferConnector_ms": 0.011084318161010742, "ViewRequirementAgentConnector_ms": 0.42029523849487305}, "num_episodes": 40, "episode_return_max": -1079.008018894998, "episode_return_min": -4754.55704646073, "episode_return_mean": -3074.5015532818193, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 334126, "num_agent_steps_trained": 334126, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.91605019454192, "num_env_steps_trained_throughput_per_sec": 72.91605019454192, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 334126, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 334126, "timers": {"training_iteration_time_ms": 54727.777, "restore_workers_time_ms": 0.029, "training_step_time_ms": 54727.702, "sample_time_ms": 3446.308, "learn_time_ms": 51222.391, "learn_throughput": 78.091, "synch_weights_time_ms": 55.866}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 334126, "num_agent_steps_trained": 334126}, "done": false, "training_iteration": 18, "trial_id": "05c72_00000", "date": "2024-07-26_14-59-03", "timestamp": 1721986143, "time_this_iter_s": 54.86875867843628, "time_total_s": 964.4176316261292, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805a9a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 964.4176316261292, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 10.833333333333334, "ram_util_percent": 32.900000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 167.35585819244386, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 5.372499547402064, "policy_loss": -0.0008529494374358495, "vf_loss": 5.387061809471676, "vf_explained_var": 0.9766016512115796, "kl": 0.01704379441338548, "entropy": 1.7544165138119743, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38571428571429, "num_grad_updates_lifetime": 80760.5, "diff_num_grad_updates_vs_sampler_policy": 2099.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 351960, "num_agent_steps_trained": 351960}, "env_runners": {"episode_reward_max": -1079.008018894998, "episode_reward_min": -4684.575267842576, "episode_reward_mean": -3057.280286663636, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1426.5453169544385}, "policy_reward_max": {"policy_0": -6.097236312365169}, "policy_reward_mean": {"policy_0": -611.4560573327271}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3292.7984763755103, -1971.5946031061403, -2865.610481076445, -4445.301337252248, -4684.575267842576, -3104.656518552747, -2718.2639737923823, -2605.046636815954, -2294.4627772958984, -2907.293155253178, -3005.6708679955004, -2662.8742776249283, -3330.2044253388417, -3593.0399466893414, -2839.6392254968764, -3712.053093267897, -2958.869317933623, -3131.3925479816003, -4130.627390454139, -3095.8193903428214, -3631.863968866225, -3068.3195069848584, -3310.119767178393, -3038.856290857534, -3405.5799612449796, -3236.7706220126506, -2101.952428500359, -3046.408115495787, -2749.6788576892295, -2379.7131258592426, -2907.4776131293, -2901.0860165864397, -4625.437551919204, -2123.8595759511823, -3501.692212859846, -3070.055332365959, -3200.6838522116163, -3102.4292829528076, -4538.985564417893, -2897.830085113093, -2324.0776490195917, -2389.3113335712032, -3516.8263824237824, -4459.351399612903, -2442.031951991847, -2850.2478632345224, -1845.3838754358212, -3101.884956601831, -3457.5132779177193, -3208.3031781408567, -1921.729659925911, -3398.5532208606774, -3793.523838777092, -1079.008018894998, -2999.7656645203406, -2748.3463076444536, -2929.3568133479985, -2820.839957372123, -3350.026995209818, -2544.155130887381, -2844.9070373230325, -3276.5298925125576, -1813.517388550631, -4510.276607539887, -2439.8483115875647, -3892.431560915245, -2760.383545700093, -2469.4395444739553, -1869.8597143185218, -2308.435784691743, -3053.1495863066298, -2972.7502354623894, -3967.801391177233, -3438.1921613462455, -2641.3758701548954, -4333.263771308426, -2412.2859935195193, -3583.5406360640827, -2764.5567566189, -3612.8398073391463, -2611.7424089652914, -2002.8454607809167, -2810.761153712258, -2106.769012577546, -4602.328381221165, -2022.7862501619456, -2266.8330855968725, -3655.5496980133057, -3428.1395015970343, -3440.4561659387464, -3439.86748298057, -3661.534385823897, -3584.984619041312, -3662.2429562504067, -3541.043363255949, -2382.9494562180257, -3667.9731623406337, -2781.8027061706907, -3093.3464989551617, -2629.856401775033], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-385.92031978450785, -978.3142255914186, -398.50284943580124, -1101.371599436274, -428.689482127513, -598.7851777123618, -101.31918857442618, -671.9015143591608, -417.4434173221152, -182.14530513807807, -286.9143329752036, -971.6452066427249, -528.7422925877108, -255.24547819931095, -823.0631706714979, -1246.2403381808247, -606.2586236593278, -750.9578348057793, -965.0172855715585, -876.827255034761, -815.6373376690551, -1035.2506796721943, -958.6002561311439, -872.3117047036295, -1002.7752896665606, -718.5107195729177, -940.4623497832607, -7.195081564224313, -842.4110055476285, -596.0773620847147, -635.8495474272358, -873.4483320400598, -382.06939430328237, -592.9492491531452, -233.94745086866251, -417.0199755020817, -922.5795281060489, -782.7752646063437, -200.10440470455978, -282.5674638969193, -277.33636398512493, -706.8376055191721, -448.49185273961666, -762.5014656769761, -99.29548937500797, -782.0635844641444, -313.08593857086925, -236.5528934125917, -701.5283574877777, -874.0623813177966, -422.7759901640904, -764.8118600105769, -1039.4054598504877, -412.9392215879132, -365.7383363824332, -946.4745424196343, -832.5911159842491, -114.58176262315995, -75.59815559551123, -693.6287010023748, -566.3889142551487, -804.5545505159293, -125.24670886180661, -832.4597805680135, -1001.5544711379404, -831.6485953641622, -974.7612650471518, -667.86635277674, -516.5190484462798, -602.2446850550073, -610.961256779976, -941.5145536117323, -557.2821937769143, -682.4621721179917, -47.41904921026122, -1349.702332082201, -769.1321558701748, -1055.8346987014802, -199.4767770605593, -337.907129553483, -840.8017625691759, -270.0555180885233, -948.3529246770039, -81.15905264340486, -818.5000599555138, -445.5621944333965, -245.63936652726113, -950.9403764902314, -376.61883872625003, -1112.6317718044595, -176.65130041286463, -1314.974704731209, -1312.980822852092, -536.010920055667, -790.0096424023062, -747.9482358290171, -415.97199721043717, -1017.4756596933275, -313.7025509322108, -600.7209466778298, -1143.3154945742647, -657.0177716872125, -806.2492826152417, -412.13473468292085, -613.1466853065846, -300.38657686088607, -464.7638838519537, -899.7383628145913, -720.5786530002587, -682.8520304571666, -905.5757024572986, -1138.2761485997637, -533.2091959896285, -234.18869045875715, -498.8700296729463, -256.96056142491926, -1003.5123949035267, -951.8413105394932, -35.21819246957841, -791.3238315200164, -553.1738365185176, -609.3578541009906, -647.4485906053493, -809.0095872451609, -786.5900927749593, -42.322005466254296, -874.9301195604587, -136.76660570773154, -1338.0523598005373, -844.6995314776674, -245.70133672413917, -567.9947712203368, -568.0362633120562, -328.1398794200917, -392.08017782373645, -485.08186919910594, -480.96998363872876, -770.3840605062964, -975.9120204382859, -334.06018171337047, -473.3781120536162, -730.8400963238239, -378.65431054194147, -1086.5959435632185, -80.21039520662607, -379.6071885094847, -855.212753168531, -244.40039147817063, -414.35204661599914, -486.1407460870608, -25.70308547594792, -1381.796424360822, -629.4180216556858, -386.92309026704976, -483.63699136978994, -615.9738368129422, -61.177375503616034, -973.6757119750462, -968.9593207890159, -281.2997715058193, -172.06287500215103, -1343.7304059222163, -944.0600143663631, -1029.3304296990102, -1136.2538269294648, -17.116798232193812, -551.4504040648663, -539.4486764761689, -177.21664227755508, -838.6270549003976, -278.0968892851098, -1172.0873529417136, -420.2495105216233, -847.6488985248807, -783.6095615865194, -398.7372576876518, -1281.8768066858831, -574.9423618756981, -614.2918746296721, -200.20703148705687, -413.72642892871045, -871.6752047717654, -135.5976956961023, -511.9199039220558, -1267.764618892983, -131.5770757544055, -386.1849555618143, -649.1576162160223, -758.788297853695, -1176.7213375668687, -1271.8898829032037, -842.8957122126228, -124.72026921042784, -1075.6303335618954, -1223.8493665297417, -358.02405737043074, -591.9782371063694, -1040.1893136682047, -845.4033020416155, -62.2351749264756, -740.8148665238923, -255.2342930946577, -463.16726200912836, -474.56334897985784, -390.2978784120554, -322.90646988286005, -832.5767173152823, -363.5708087598431, -674.6995389448853, -195.55779866833333, -973.519379556188, -660.6961425234945, -1101.987868548124, -327.0064345048468, -453.6165572911306, -800.5209945811259, -776.806108494679, -1374.075198758952, -589.6223454437079, -918.3267523344399, -658.5042848897624, -282.31451333359996, -881.9531670564204, -362.2039829898403, -257.05600372222455, -780.5158035337502, -23.543568654974283, -394.21338403078107, -1135.0124026136295, -516.9627044013881, -577.9197038937344, -954.1629812589176, -203.38464256907517, -56.449886623114594, -53.46666109097913, -247.27005387767258, -456.9292738526182, -964.6425412716271, -744.5760495004301, -688.467038099482, -980.2906031158848, -785.487259339456, -769.7828432873702, -787.7271330728887, -134.2254391021232, -348.39626096484653, -638.6088644560512, -829.4157478993827, -539.7993448206855, -852.0829599998905, -484.3896404533113, -992.2114170545102, -216.76890580240507, -145.0607114313884, -83.29898518429705, -40.67521493050607, -1305.8612529708494, -981.3788500334529, -388.4248544436617, -682.2130484822025, -1185.9384789195906, -286.59637089260065, -72.71031500809114, -1313.9112069436528, -934.3674670131593, -305.5004940205407, -140.93797612559112, -153.59021329369813, -404.9911630569083, -73.98817239826018, -483.1404395606096, -697.4746418983087, -135.11428231343268, -659.4757470207504, -1024.5605537272436, -933.3379520461983, -221.94317702796195, -662.9603384743249, -593.0748986109749, -337.02994148499107, -292.1249625716043, -260.60450141794445, -595.0753523422457, -1004.6342099874375, -776.917787028767, -127.51976817516923, -383.303813655424, -785.8263207145027, -774.7325784085476, -749.4574764184829, -94.5963140269985, -770.6039200075753, -1092.1339121227365, -1260.0992917020549, -132.59355735045108, -1015.1640571086397, -710.4839038764203, -33.59280752902051, -118.56832189556259, -666.3460404777366, -602.3793175507813, -290.1746304734544, -851.9064933253243, -350.83017515941805, -749.6164208140563, -454.79442250760417, -432.30536033731516, -570.438768340974, -1069.520277572798, -749.4710637538642, -1041.213214077034, -358.5766771966122, -10.171984256963404, -192.7267595792759, -210.82875344074606, -676.3406274501583, -999.6869365848252, -970.6643314119902, -505.3983176832654, -1358.1863944096476, -168.6685104186936, -613.6797572319298, -732.3879270740211, -756.5277165067708, -168.5844003561471, -636.7508213701207, -422.98422486112497, -1067.9552713588075, -1090.3102801461255, -674.4309631790637, -756.7728382398558, -78.57077971325582, -132.53050197728237, -1039.6026211621702, -752.9068046075279, -465.7970546845574, -274.9031331734354, -1104.0015934715718, -147.57200408797533, -477.16575905641366, -187.34670172654413, -529.9726838330488, -499.50565985849136, -79.2560538083957, -573.7786150920429, -661.4315521908395, -51.24448602481307, -620.6301950709184, -348.15729239186976, -626.9722590133049, -159.07055925268563, -742.0560035927793, -478.6837836871685, -958.7102878449111, -714.6289519290833, -388.73296101469305, -1355.2500906756843, -798.8933188804021, -405.6043970685311, -24.26946782307884, -1136.598121604721, -913.2677796090321, -492.1240350172704, -848.902731646346, -576.9087232998619, -783.1442381433083, -516.7496466085729, -761.0138449569113, -831.3930879724319, -545.891343665018, -305.3534545234373, -714.0445307009185, -831.1547944860313, -241.59431507422877, -549.2287753702805, -1038.3750606957806, -1118.92588994839, -539.989063009499, -904.719827314197, -731.2539303405675, -629.8059592962675, -289.2259665177805, -359.3192212457725, -44.07553848181018, -1089.859307977889, -309.0698234575028, -755.2635931061344, -1084.5013798173986, -559.0177270095463, -875.6881126735003, -859.7084711858754, -530.097762841129, -6.097236312365169, -143.25944754229192, -1225.393838737237, -260.70186042554286, -1389.9597768471444, -714.3925706969275, -376.20821936292043, -871.5773800066136, -195.74375151693968, -1071.1390312734272, -288.84403715862345, -285.18972600815175, -770.8258630081472, -126.65314973567777, -672.5560366512742, -957.3430144937836, -60.37614266725073, -185.91711723292968, -239.21590471944037, -773.476005186157, -639.8186048500605, -939.3976860394075, -218.8529529171956, -126.4316113226687, -566.9886341536624, -298.8503043657499, -505.87127128214763, -608.6271914533205, -437.22104532006557, -1036.665370926777, -1180.489628348079, -735.360574203742, -1212.591762422503, -118.4770265355425, -563.0853385097937, -747.5592878398668, -520.8421259799628, -72.8224712967799, -420.8382641404753, -105.67306404719076, -858.3482434174238, -654.010780165751, -227.96273382603025, -342.5555119129982, -1226.3734044078567, -878.2020131971602, -1119.5516754669075, -88.86709302838236, -121.22564153279357, -1075.5092027765752, -746.2609470401649, -684.9269466337363, -800.2167636137638, -781.2242608770382, -367.7658105962249, -1109.6183555554057, -896.3087037483024, -285.5390351617745, -929.2434715364154, -473.5854666345345, -1222.8994343120798, -110.42242664531993, -703.71668385222, -803.4511624924388, -850.7830748871896, -348.75063416246957, -643.6970543023843, -1014.8524599794138, -951.9936905423527, -758.365110385609, -1098.9680495661048, -569.6164192382073, -206.04134930903618, -182.2963734085611, -452.951120900123, -657.1242812240455, -1426.5453169544385, -943.3258637632405, -17.760519098919755, -774.5703271412339, -1223.5230028149035, -369.07674256838146, -1156.1127716325125, -534.9801042923568, -1051.3633941521196, -281.4010134180121, -128.92214845250896, -386.2827959030279, -659.2342150337311, -948.0413219264617, -758.891134904818, -503.74140159223833, -798.0650888833836, -165.65764713118827, -910.0061411428717, -964.496818493122, -521.5783586539249, -220.06374074958242, -396.77783743588395, -874.3386098319276, -1033.4599345943814, -421.2692372919404, -367.50087980103, -939.5655153306395, -90.11904263227892, -742.1775063680335, -97.84918971170245, -760.1451477323815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6496375204212808, "mean_inference_ms": 1.74720488677657, "mean_action_processing_ms": 0.9195306755122822, "mean_env_wait_ms": 11.026745524607888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015827655792236328, "StateBufferConnector_ms": 0.011228561401367188, "ViewRequirementAgentConnector_ms": 0.4251983165740967}, "num_episodes": 20, "episode_return_max": -1079.008018894998, "episode_return_min": -4684.575267842576, "episode_return_mean": -3057.280286663636, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 351960, "num_agent_steps_trained": 351960, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.8121760993591, "num_env_steps_trained_throughput_per_sec": 83.8121760993591, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 351960, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 351960, "timers": {"training_iteration_time_ms": 53578.52, "restore_workers_time_ms": 0.027, "training_step_time_ms": 53578.45, "sample_time_ms": 3449.926, "learn_time_ms": 50068.845, "learn_throughput": 79.89, "synch_weights_time_ms": 56.496}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 351960, "num_agent_steps_trained": 351960}, "done": false, "training_iteration": 19, "trial_id": "05c72_00000", "date": "2024-07-26_14-59-51", "timestamp": 1721986191, "time_this_iter_s": 47.73624062538147, "time_total_s": 1012.1538722515106, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805abc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1012.1538722515106, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 11.717647058823529, "ram_util_percent": 32.900000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 178.83855435988482, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 5.244386883518275, "policy_loss": -0.0013674425640298675, "vf_loss": 5.2588146133750096, "vf_explained_var": 0.9814359253089802, "kl": 0.020008561254472427, "entropy": 1.7562211421482703, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.95588235294117, "num_grad_updates_lifetime": 84900.5, "diff_num_grad_updates_vs_sampler_policy": 2039.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 369362, "num_agent_steps_trained": 369362}, "env_runners": {"episode_reward_max": -1079.008018894998, "episode_reward_min": -4625.437551919204, "episode_reward_mean": -3052.519526627364, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1426.5453169544385}, "policy_reward_max": {"policy_0": -6.097236312365169}, "policy_reward_mean": {"policy_0": -610.5039053254729}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3631.863968866225, -3068.3195069848584, -3310.119767178393, -3038.856290857534, -3405.5799612449796, -3236.7706220126506, -2101.952428500359, -3046.408115495787, -2749.6788576892295, -2379.7131258592426, -2907.4776131293, -2901.0860165864397, -4625.437551919204, -2123.8595759511823, -3501.692212859846, -3070.055332365959, -3200.6838522116163, -3102.4292829528076, -4538.985564417893, -2897.830085113093, -2324.0776490195917, -2389.3113335712032, -3516.8263824237824, -4459.351399612903, -2442.031951991847, -2850.2478632345224, -1845.3838754358212, -3101.884956601831, -3457.5132779177193, -3208.3031781408567, -1921.729659925911, -3398.5532208606774, -3793.523838777092, -1079.008018894998, -2999.7656645203406, -2748.3463076444536, -2929.3568133479985, -2820.839957372123, -3350.026995209818, -2544.155130887381, -2844.9070373230325, -3276.5298925125576, -1813.517388550631, -4510.276607539887, -2439.8483115875647, -3892.431560915245, -2760.383545700093, -2469.4395444739553, -1869.8597143185218, -2308.435784691743, -3053.1495863066298, -2972.7502354623894, -3967.801391177233, -3438.1921613462455, -2641.3758701548954, -4333.263771308426, -2412.2859935195193, -3583.5406360640827, -2764.5567566189, -3612.8398073391463, -2611.7424089652914, -2002.8454607809167, -2810.761153712258, -2106.769012577546, -4602.328381221165, -2022.7862501619456, -2266.8330855968725, -3655.5496980133057, -3428.1395015970343, -3440.4561659387464, -3439.86748298057, -3661.534385823897, -3584.984619041312, -3662.2429562504067, -3541.043363255949, -2382.9494562180257, -3667.9731623406337, -2781.8027061706907, -3093.3464989551617, -2629.856401775033, -3303.9554976613545, -4277.038488272214, -2697.832924566906, -4133.766797749453, -2579.926758979754, -4573.3820836638715, -3509.9849540712935, -4192.596754716804, -3322.7060385245086, -1309.0402317983212, -3307.794195573516, -4273.988837132848, -2931.0879584071095, -3793.509581100071, -1949.8043958960552, -1926.3533809491855, -2585.3807168976055, -3735.703878072156, -1701.3405048706504, -2768.523727957882], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1143.3154945742647, -657.0177716872125, -806.2492826152417, -412.13473468292085, -613.1466853065846, -300.38657686088607, -464.7638838519537, -899.7383628145913, -720.5786530002587, -682.8520304571666, -905.5757024572986, -1138.2761485997637, -533.2091959896285, -234.18869045875715, -498.8700296729463, -256.96056142491926, -1003.5123949035267, -951.8413105394932, -35.21819246957841, -791.3238315200164, -553.1738365185176, -609.3578541009906, -647.4485906053493, -809.0095872451609, -786.5900927749593, -42.322005466254296, -874.9301195604587, -136.76660570773154, -1338.0523598005373, -844.6995314776674, -245.70133672413917, -567.9947712203368, -568.0362633120562, -328.1398794200917, -392.08017782373645, -485.08186919910594, -480.96998363872876, -770.3840605062964, -975.9120204382859, -334.06018171337047, -473.3781120536162, -730.8400963238239, -378.65431054194147, -1086.5959435632185, -80.21039520662607, -379.6071885094847, -855.212753168531, -244.40039147817063, -414.35204661599914, -486.1407460870608, -25.70308547594792, -1381.796424360822, -629.4180216556858, -386.92309026704976, -483.63699136978994, -615.9738368129422, -61.177375503616034, -973.6757119750462, -968.9593207890159, -281.2997715058193, -172.06287500215103, -1343.7304059222163, -944.0600143663631, -1029.3304296990102, -1136.2538269294648, -17.116798232193812, -551.4504040648663, -539.4486764761689, -177.21664227755508, -838.6270549003976, -278.0968892851098, -1172.0873529417136, -420.2495105216233, -847.6488985248807, -783.6095615865194, -398.7372576876518, -1281.8768066858831, -574.9423618756981, -614.2918746296721, -200.20703148705687, -413.72642892871045, -871.6752047717654, -135.5976956961023, -511.9199039220558, -1267.764618892983, -131.5770757544055, -386.1849555618143, -649.1576162160223, -758.788297853695, -1176.7213375668687, -1271.8898829032037, -842.8957122126228, -124.72026921042784, -1075.6303335618954, -1223.8493665297417, -358.02405737043074, -591.9782371063694, -1040.1893136682047, -845.4033020416155, -62.2351749264756, -740.8148665238923, -255.2342930946577, -463.16726200912836, -474.56334897985784, -390.2978784120554, -322.90646988286005, -832.5767173152823, -363.5708087598431, -674.6995389448853, -195.55779866833333, -973.519379556188, -660.6961425234945, -1101.987868548124, -327.0064345048468, -453.6165572911306, -800.5209945811259, -776.806108494679, -1374.075198758952, -589.6223454437079, -918.3267523344399, -658.5042848897624, -282.31451333359996, -881.9531670564204, -362.2039829898403, -257.05600372222455, -780.5158035337502, -23.543568654974283, -394.21338403078107, -1135.0124026136295, -516.9627044013881, -577.9197038937344, -954.1629812589176, -203.38464256907517, -56.449886623114594, -53.46666109097913, -247.27005387767258, -456.9292738526182, -964.6425412716271, -744.5760495004301, -688.467038099482, -980.2906031158848, -785.487259339456, -769.7828432873702, -787.7271330728887, -134.2254391021232, -348.39626096484653, -638.6088644560512, -829.4157478993827, -539.7993448206855, -852.0829599998905, -484.3896404533113, -992.2114170545102, -216.76890580240507, -145.0607114313884, -83.29898518429705, -40.67521493050607, -1305.8612529708494, -981.3788500334529, -388.4248544436617, -682.2130484822025, -1185.9384789195906, -286.59637089260065, -72.71031500809114, -1313.9112069436528, -934.3674670131593, -305.5004940205407, -140.93797612559112, -153.59021329369813, -404.9911630569083, -73.98817239826018, -483.1404395606096, -697.4746418983087, -135.11428231343268, -659.4757470207504, -1024.5605537272436, -933.3379520461983, -221.94317702796195, -662.9603384743249, -593.0748986109749, -337.02994148499107, -292.1249625716043, -260.60450141794445, -595.0753523422457, -1004.6342099874375, -776.917787028767, -127.51976817516923, -383.303813655424, -785.8263207145027, -774.7325784085476, -749.4574764184829, -94.5963140269985, -770.6039200075753, -1092.1339121227365, -1260.0992917020549, -132.59355735045108, -1015.1640571086397, -710.4839038764203, -33.59280752902051, -118.56832189556259, -666.3460404777366, -602.3793175507813, -290.1746304734544, -851.9064933253243, -350.83017515941805, -749.6164208140563, -454.79442250760417, -432.30536033731516, -570.438768340974, -1069.520277572798, -749.4710637538642, -1041.213214077034, -358.5766771966122, -10.171984256963404, -192.7267595792759, -210.82875344074606, -676.3406274501583, -999.6869365848252, -970.6643314119902, -505.3983176832654, -1358.1863944096476, -168.6685104186936, -613.6797572319298, -732.3879270740211, -756.5277165067708, -168.5844003561471, -636.7508213701207, -422.98422486112497, -1067.9552713588075, -1090.3102801461255, -674.4309631790637, -756.7728382398558, -78.57077971325582, -132.53050197728237, -1039.6026211621702, -752.9068046075279, -465.7970546845574, -274.9031331734354, -1104.0015934715718, -147.57200408797533, -477.16575905641366, -187.34670172654413, -529.9726838330488, -499.50565985849136, -79.2560538083957, -573.7786150920429, -661.4315521908395, -51.24448602481307, -620.6301950709184, -348.15729239186976, -626.9722590133049, -159.07055925268563, -742.0560035927793, -478.6837836871685, -958.7102878449111, -714.6289519290833, -388.73296101469305, -1355.2500906756843, -798.8933188804021, -405.6043970685311, -24.26946782307884, -1136.598121604721, -913.2677796090321, -492.1240350172704, -848.902731646346, -576.9087232998619, -783.1442381433083, -516.7496466085729, -761.0138449569113, -831.3930879724319, -545.891343665018, -305.3534545234373, -714.0445307009185, -831.1547944860313, -241.59431507422877, -549.2287753702805, -1038.3750606957806, -1118.92588994839, -539.989063009499, -904.719827314197, -731.2539303405675, -629.8059592962675, -289.2259665177805, -359.3192212457725, -44.07553848181018, -1089.859307977889, -309.0698234575028, -755.2635931061344, -1084.5013798173986, -559.0177270095463, -875.6881126735003, -859.7084711858754, -530.097762841129, -6.097236312365169, -143.25944754229192, -1225.393838737237, -260.70186042554286, -1389.9597768471444, -714.3925706969275, -376.20821936292043, -871.5773800066136, -195.74375151693968, -1071.1390312734272, -288.84403715862345, -285.18972600815175, -770.8258630081472, -126.65314973567777, -672.5560366512742, -957.3430144937836, -60.37614266725073, -185.91711723292968, -239.21590471944037, -773.476005186157, -639.8186048500605, -939.3976860394075, -218.8529529171956, -126.4316113226687, -566.9886341536624, -298.8503043657499, -505.87127128214763, -608.6271914533205, -437.22104532006557, -1036.665370926777, -1180.489628348079, -735.360574203742, -1212.591762422503, -118.4770265355425, -563.0853385097937, -747.5592878398668, -520.8421259799628, -72.8224712967799, -420.8382641404753, -105.67306404719076, -858.3482434174238, -654.010780165751, -227.96273382603025, -342.5555119129982, -1226.3734044078567, -878.2020131971602, -1119.5516754669075, -88.86709302838236, -121.22564153279357, -1075.5092027765752, -746.2609470401649, -684.9269466337363, -800.2167636137638, -781.2242608770382, -367.7658105962249, -1109.6183555554057, -896.3087037483024, -285.5390351617745, -929.2434715364154, -473.5854666345345, -1222.8994343120798, -110.42242664531993, -703.71668385222, -803.4511624924388, -850.7830748871896, -348.75063416246957, -643.6970543023843, -1014.8524599794138, -951.9936905423527, -758.365110385609, -1098.9680495661048, -569.6164192382073, -206.04134930903618, -182.2963734085611, -452.951120900123, -657.1242812240455, -1426.5453169544385, -943.3258637632405, -17.760519098919755, -774.5703271412339, -1223.5230028149035, -369.07674256838146, -1156.1127716325125, -534.9801042923568, -1051.3633941521196, -281.4010134180121, -128.92214845250896, -386.2827959030279, -659.2342150337311, -948.0413219264617, -758.891134904818, -503.74140159223833, -798.0650888833836, -165.65764713118827, -910.0061411428717, -964.496818493122, -521.5783586539249, -220.06374074958242, -396.77783743588395, -874.3386098319276, -1033.4599345943814, -421.2692372919404, -367.50087980103, -939.5655153306395, -90.11904263227892, -742.1775063680335, -97.84918971170245, -760.1451477323815, -1064.6387616493519, -752.2230117387562, -756.6098807627353, -649.9893513856717, -80.49449212483437, -909.6139650400445, -1074.824883922505, -879.8306796142431, -793.1822068579248, -619.5867528374957, -242.07336365232328, -357.01746871378333, -717.3086328856647, -753.978809258084, -627.4546500570508, -913.4315316714308, -593.2313996503793, -766.8729094747271, -782.9776495931346, -1077.2533073597806, -1215.5141132702154, -489.89157984508336, -55.64233236918578, -374.9086602638622, -443.97007323140735, -1259.800719242468, -1260.333359028415, -633.6192073805008, -751.4279066256431, -668.2008913868502, -722.9529353248266, -1108.1243491554358, -417.99315411571905, -449.1704509143734, -811.7440645609386, -1350.0431822838505, -723.2706366219303, -912.879353095129, -366.25880710756866, -840.1447756083188, -741.625725128, -53.69893901785315, -987.8373177560768, -309.07410337253367, -1230.4699532500433, -95.95683276939036, -185.42499749210904, -155.9436584897539, -127.96741742845956, -743.7473256186072, -163.3791377532153, -409.56059151193045, -1253.0031146407407, -612.2050553044724, -869.6462963631532, -574.3623070501646, -1253.8505621647141, -750.5555227314934, -333.4844884405691, -1361.7359567459077, -437.9272198917676, -684.5125259478896, -741.0104419801914, -674.3435065226142, -393.2942640646485, -590.0189613171136, -753.3273320400868, -691.157916482016, -1050.8890378594601, -708.1163334013963, -517.191971175518, -483.47642963391365, -318.8961921745571, -11.512545007608555, -618.7272579044588, -198.6317743052013, -739.7952154589635, -643.5365552066196, -261.55300760754136, -82.83682837085883, -893.4326572238946, -410.54906978273715, -481.415289640261, -194.76825543764525, -605.2154448130665, -1389.9719798576184, -659.8454981622953, -373.19219629926425, -1240.604426006434, -72.08977774653908, -240.6115119185826, -742.567310610311, -509.94994584794597, -66.78754709645077, -141.42418939736046, -892.4472381549782, -403.3429712846863, -1170.7018390938936, -45.79746018535297, -256.23421923897155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6456472473239183, "mean_inference_ms": 1.7456215337371666, "mean_action_processing_ms": 0.9150366038967555, "mean_env_wait_ms": 11.006444621615964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015912294387817383, "StateBufferConnector_ms": 0.01129913330078125, "ViewRequirementAgentConnector_ms": 0.42694735527038574}, "num_episodes": 20, "episode_return_max": -1079.008018894998, "episode_return_min": -4625.437551919204, "episode_return_mean": -3052.519526627364, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 369362, "num_agent_steps_trained": 369362, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.7826923934577, "num_env_steps_trained_throughput_per_sec": 73.7826923934577, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 369362, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 369362, "timers": {"training_iteration_time_ms": 53455.219, "restore_workers_time_ms": 0.027, "training_step_time_ms": 53455.148, "sample_time_ms": 3439.654, "learn_time_ms": 49955.257, "learn_throughput": 80.072, "synch_weights_time_ms": 57.079}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 369362, "num_agent_steps_trained": 369362}, "done": false, "training_iteration": 20, "trial_id": "05c72_00000", "date": "2024-07-26_15-00-45", "timestamp": 1721986245, "time_this_iter_s": 54.22576332092285, "time_total_s": 1066.3796355724335, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d3c3b29d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1066.3796355724335, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 11.136363636363637, "ram_util_percent": 32.91688311688312}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 196.96646598465142, "cur_kl_coeff": 0.3374999999999999, "cur_lr": 0.001, "total_loss": 5.264156067618008, "policy_loss": 0.001304380067613447, "vf_loss": 5.2753209329473565, "vf_explained_var": 0.9767960799836565, "kl": 0.017842052803835134, "entropy": 1.8490937758588242, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.22758620689655, "num_grad_updates_lifetime": 89115.5, "diff_num_grad_updates_vs_sampler_policy": 2174.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 387810, "num_agent_steps_trained": 387810}, "env_runners": {"episode_reward_max": -1309.0402317983212, "episode_reward_min": -4870.645841895779, "episode_reward_mean": -3068.731157033413, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1426.5453169544385}, "policy_reward_max": {"policy_0": 8.937985727080806}, "policy_reward_mean": {"policy_0": -613.7462314066827}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2844.9070373230325, -3276.5298925125576, -1813.517388550631, -4510.276607539887, -2439.8483115875647, -3892.431560915245, -2760.383545700093, -2469.4395444739553, -1869.8597143185218, -2308.435784691743, -3053.1495863066298, -2972.7502354623894, -3967.801391177233, -3438.1921613462455, -2641.3758701548954, -4333.263771308426, -2412.2859935195193, -3583.5406360640827, -2764.5567566189, -3612.8398073391463, -2611.7424089652914, -2002.8454607809167, -2810.761153712258, -2106.769012577546, -4602.328381221165, -2022.7862501619456, -2266.8330855968725, -3655.5496980133057, -3428.1395015970343, -3440.4561659387464, -3439.86748298057, -3661.534385823897, -3584.984619041312, -3662.2429562504067, -3541.043363255949, -2382.9494562180257, -3667.9731623406337, -2781.8027061706907, -3093.3464989551617, -2629.856401775033, -3303.9554976613545, -4277.038488272214, -2697.832924566906, -4133.766797749453, -2579.926758979754, -4573.3820836638715, -3509.9849540712935, -4192.596754716804, -3322.7060385245086, -1309.0402317983212, -3307.794195573516, -4273.988837132848, -2931.0879584071095, -3793.509581100071, -1949.8043958960552, -1926.3533809491855, -2585.3807168976055, -3735.703878072156, -1701.3405048706504, -2768.523727957882, -3603.5659263383072, -3565.7539674879013, -4191.404205883857, -3174.866378176587, -3172.5091382655596, -2565.7395494616135, -3003.103165101746, -3595.3883912730994, -3438.6180621484223, -4538.1029047763495, -3310.179211883859, -3350.595092597881, -3534.2775238561053, -4092.776517292154, -2257.7123827274863, -1947.2077267129534, -2186.030576373171, -4310.57097494069, -2841.981411132841, -3360.5110353849473, -3830.2293088100078, -4870.645841895779, -2730.0582221608, -2281.159732192113, -2728.389842048807, -2146.5469051511786, -2107.6052536546104, -4223.152595748911, -2094.306131189977, -2197.710666329938, -2487.651635495665, -1945.014118273248, -1733.7094967082892, -3229.312275573328, -2168.8665848797873, -3157.595693702252, -3062.0600869183263, -2370.2186250486225, -3513.6445431422376, -2721.428547452902], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-602.3793175507813, -290.1746304734544, -851.9064933253243, -350.83017515941805, -749.6164208140563, -454.79442250760417, -432.30536033731516, -570.438768340974, -1069.520277572798, -749.4710637538642, -1041.213214077034, -358.5766771966122, -10.171984256963404, -192.7267595792759, -210.82875344074606, -676.3406274501583, -999.6869365848252, -970.6643314119902, -505.3983176832654, -1358.1863944096476, -168.6685104186936, -613.6797572319298, -732.3879270740211, -756.5277165067708, -168.5844003561471, -636.7508213701207, -422.98422486112497, -1067.9552713588075, -1090.3102801461255, -674.4309631790637, -756.7728382398558, -78.57077971325582, -132.53050197728237, -1039.6026211621702, -752.9068046075279, -465.7970546845574, -274.9031331734354, -1104.0015934715718, -147.57200408797533, -477.16575905641366, -187.34670172654413, -529.9726838330488, -499.50565985849136, -79.2560538083957, -573.7786150920429, -661.4315521908395, -51.24448602481307, -620.6301950709184, -348.15729239186976, -626.9722590133049, -159.07055925268563, -742.0560035927793, -478.6837836871685, -958.7102878449111, -714.6289519290833, -388.73296101469305, -1355.2500906756843, -798.8933188804021, -405.6043970685311, -24.26946782307884, -1136.598121604721, -913.2677796090321, -492.1240350172704, -848.902731646346, -576.9087232998619, -783.1442381433083, -516.7496466085729, -761.0138449569113, -831.3930879724319, -545.891343665018, -305.3534545234373, -714.0445307009185, -831.1547944860313, -241.59431507422877, -549.2287753702805, -1038.3750606957806, -1118.92588994839, -539.989063009499, -904.719827314197, -731.2539303405675, -629.8059592962675, -289.2259665177805, -359.3192212457725, -44.07553848181018, -1089.859307977889, -309.0698234575028, -755.2635931061344, -1084.5013798173986, -559.0177270095463, -875.6881126735003, -859.7084711858754, -530.097762841129, -6.097236312365169, -143.25944754229192, -1225.393838737237, -260.70186042554286, -1389.9597768471444, -714.3925706969275, -376.20821936292043, -871.5773800066136, -195.74375151693968, -1071.1390312734272, -288.84403715862345, -285.18972600815175, -770.8258630081472, -126.65314973567777, -672.5560366512742, -957.3430144937836, -60.37614266725073, -185.91711723292968, -239.21590471944037, -773.476005186157, -639.8186048500605, -939.3976860394075, -218.8529529171956, -126.4316113226687, -566.9886341536624, -298.8503043657499, -505.87127128214763, -608.6271914533205, -437.22104532006557, -1036.665370926777, -1180.489628348079, -735.360574203742, -1212.591762422503, -118.4770265355425, -563.0853385097937, -747.5592878398668, -520.8421259799628, -72.8224712967799, -420.8382641404753, -105.67306404719076, -858.3482434174238, -654.010780165751, -227.96273382603025, -342.5555119129982, -1226.3734044078567, -878.2020131971602, -1119.5516754669075, -88.86709302838236, -121.22564153279357, -1075.5092027765752, -746.2609470401649, -684.9269466337363, -800.2167636137638, -781.2242608770382, -367.7658105962249, -1109.6183555554057, -896.3087037483024, -285.5390351617745, -929.2434715364154, -473.5854666345345, -1222.8994343120798, -110.42242664531993, -703.71668385222, -803.4511624924388, -850.7830748871896, -348.75063416246957, -643.6970543023843, -1014.8524599794138, -951.9936905423527, -758.365110385609, -1098.9680495661048, -569.6164192382073, -206.04134930903618, -182.2963734085611, -452.951120900123, -657.1242812240455, -1426.5453169544385, -943.3258637632405, -17.760519098919755, -774.5703271412339, -1223.5230028149035, -369.07674256838146, -1156.1127716325125, -534.9801042923568, -1051.3633941521196, -281.4010134180121, -128.92214845250896, -386.2827959030279, -659.2342150337311, -948.0413219264617, -758.891134904818, -503.74140159223833, -798.0650888833836, -165.65764713118827, -910.0061411428717, -964.496818493122, -521.5783586539249, -220.06374074958242, -396.77783743588395, -874.3386098319276, -1033.4599345943814, -421.2692372919404, -367.50087980103, -939.5655153306395, -90.11904263227892, -742.1775063680335, -97.84918971170245, -760.1451477323815, -1064.6387616493519, -752.2230117387562, -756.6098807627353, -649.9893513856717, -80.49449212483437, -909.6139650400445, -1074.824883922505, -879.8306796142431, -793.1822068579248, -619.5867528374957, -242.07336365232328, -357.01746871378333, -717.3086328856647, -753.978809258084, -627.4546500570508, -913.4315316714308, -593.2313996503793, -766.8729094747271, -782.9776495931346, -1077.2533073597806, -1215.5141132702154, -489.89157984508336, -55.64233236918578, -374.9086602638622, -443.97007323140735, -1259.800719242468, -1260.333359028415, -633.6192073805008, -751.4279066256431, -668.2008913868502, -722.9529353248266, -1108.1243491554358, -417.99315411571905, -449.1704509143734, -811.7440645609386, -1350.0431822838505, -723.2706366219303, -912.879353095129, -366.25880710756866, -840.1447756083188, -741.625725128, -53.69893901785315, -987.8373177560768, -309.07410337253367, -1230.4699532500433, -95.95683276939036, -185.42499749210904, -155.9436584897539, -127.96741742845956, -743.7473256186072, -163.3791377532153, -409.56059151193045, -1253.0031146407407, -612.2050553044724, -869.6462963631532, -574.3623070501646, -1253.8505621647141, -750.5555227314934, -333.4844884405691, -1361.7359567459077, -437.9272198917676, -684.5125259478896, -741.0104419801914, -674.3435065226142, -393.2942640646485, -590.0189613171136, -753.3273320400868, -691.157916482016, -1050.8890378594601, -708.1163334013963, -517.191971175518, -483.47642963391365, -318.8961921745571, -11.512545007608555, -618.7272579044588, -198.6317743052013, -739.7952154589635, -643.5365552066196, -261.55300760754136, -82.83682837085883, -893.4326572238946, -410.54906978273715, -481.415289640261, -194.76825543764525, -605.2154448130665, -1389.9719798576184, -659.8454981622953, -373.19219629926425, -1240.604426006434, -72.08977774653908, -240.6115119185826, -742.567310610311, -509.94994584794597, -66.78754709645077, -141.42418939736046, -892.4472381549782, -403.3429712846863, -1170.7018390938936, -45.79746018535297, -256.23421923897155, -874.5962578815711, -1140.9815983211097, -985.6965923843502, -292.0238875428207, -310.26759020845964, -918.2625323412761, -719.0222393467294, -373.9422066197327, -925.2840559442516, -629.2429332359114, -1121.0745962779251, -909.7931277853916, -576.1978063001226, -1157.0418881621847, -427.2967873582341, -791.7671429793502, -616.6861615359131, -418.1133443873188, -559.3765268686064, -788.9232024053963, -1131.1764410090902, -559.2646872622834, -676.5679028104939, -680.2437326404804, -125.25637454321425, -798.7653584761349, -12.220638581574363, -860.9024557946026, -368.2264399657588, -525.6246566435441, -502.2054811446371, -875.086123096833, -1062.509924761773, -83.59729730859682, -479.704338789906, -608.5266061231733, -454.3847847387343, -1317.581738561419, -535.7405825590394, -679.154679290734, -805.6206059756026, -189.58394915098023, -156.52138395637792, -1000.558874336976, -1286.3332487284856, -858.7601339904987, -984.4675833883877, -1055.02827271973, -740.0259153141433, -899.8209993635929, -426.1158684884067, -769.7663315227735, -766.2586904858218, -689.6784882909113, -658.3598330959467, -406.2932879362011, -848.2896630239118, -842.8566346427365, -796.0005217149813, -457.15498528005185, -376.14105993344333, -962.4443646502843, -254.54358325211612, -1193.0309152007137, -748.1176008195488, -269.92132544540954, -1372.9178007734913, -742.4346782366806, -728.611786319147, -978.8909265174248, -860.2179841474891, -23.48069973569617, -121.84979178811676, -1141.9691257358754, -110.19478132031067, -367.63214520081624, -897.9380974116112, -63.116145414125285, -153.0657785987212, -465.4555600876781, -1072.1541719469606, -157.07404459578285, -312.98109375116036, -48.67375147650321, -595.1475146027651, -819.8698771287997, -854.3866028748799, -890.8984972844679, -1168.1430961638055, -577.2729014887359, -958.400333326179, -25.4522307961302, -46.445212109820204, -1206.2206874492758, -605.462947451435, -167.74290918728306, -365.65832641523804, -444.18454304695445, -1164.9166737269722, -1218.008583008501, -629.4919978511788, -1211.771818209566, -660.7759605964877, -868.6248752973152, -459.56465685546067, -1194.6833095881234, -1326.3894809888827, -835.156531059361, -752.5417670386778, -761.8747532207356, -198.6084418568793, -820.6633849792972, -44.28194794461421, -1034.3675422120536, -632.1369051679554, -310.3316055771308, -979.6085794681611, -602.3956822321568, -174.8151770389817, -214.00868787568044, -405.1483230753692, -644.6536324976656, -852.48928436752, -55.213559385924135, -770.8850427223282, -607.9874181071013, -497.148025144861, -428.9697610440874, 8.937985727080806, -621.3796865822104, -475.4404165200105, -970.8396067557752, -62.72645129706559, -560.3342178819632, -38.2645611997957, -962.3871665536298, -627.0435212120364, -592.0168915243064, -735.503747427581, -1306.20126903136, -25.83649869496281, -1104.2397140237672, -177.22289220945285, -731.1376920019278, -55.86933425986594, -431.70394897273655, -119.40567497383554, -870.5108142084238, -537.8169598426322, -238.27326833230825, -45.515622257073616, -1320.4313453449633, -681.0104825830969, -164.961723681645, -275.7324616288854, -322.9029364252729, -614.6301612443594, -439.00468957878604, -150.22198563741696, -418.25434538741325, -319.8171397480992, -628.2719831187187, -159.15904062165555, -255.42638069864938, -371.0349525211669, -542.1688262121642, -1090.064632064102, -418.1052236579235, -306.0398535386579, -872.9337401004753, -348.6882708921904, -722.6042866618279, -503.81748185300273, -523.3901834124761, -70.36636206028919, -583.7569732208372, -170.10430748336006, -1003.686769119616, -672.5785445874055, -727.4690992910334, -457.7095503903525, -385.95591634675515, -232.18947978725808, -1147.628459558822, -838.5766808351392, -942.6884223595724, -22.167094588370748, -642.4956732425856, -590.4274421700779, -172.43999268801494, -966.8452476836948, -99.29252942789451, -737.265636027523, -1001.680013685064, -708.5611163180643, -278.07846512470337, -717.1188712477776, -751.7781790011553, -701.4669147692415, -272.98611731002444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6410085208562741, "mean_inference_ms": 1.746307751757232, "mean_action_processing_ms": 0.9119551471203411, "mean_env_wait_ms": 11.00301786241478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015425682067871094, "StateBufferConnector_ms": 0.010944366455078125, "ViewRequirementAgentConnector_ms": 0.4136974811553955}, "num_episodes": 40, "episode_return_max": -1309.0402317983212, "episode_return_min": -4870.645841895779, "episode_return_mean": -3068.731157033413, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 387810, "num_agent_steps_trained": 387810, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.88079181586119, "num_env_steps_trained_throughput_per_sec": 76.88079181586119, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 387810, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 387810, "timers": {"training_iteration_time_ms": 52736.118, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52736.048, "sample_time_ms": 3435.74, "learn_time_ms": 49240.495, "learn_throughput": 81.234, "synch_weights_time_ms": 56.656}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 387810, "num_agent_steps_trained": 387810}, "done": false, "training_iteration": 21, "trial_id": "05c72_00000", "date": "2024-07-26_15-01-37", "timestamp": 1721986297, "time_this_iter_s": 52.039748191833496, "time_total_s": 1118.419383764267, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805a9b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1118.419383764267, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 11.071621621621622, "ram_util_percent": 32.966216216216225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 184.11512062807037, "cur_kl_coeff": 0.3375, "cur_lr": 0.001, "total_loss": 5.189224976217243, "policy_loss": -0.0009861327518114356, "vf_loss": 5.202421274711269, "vf_explained_var": 0.9821186861241927, "kl": 0.014551419901774028, "entropy": 1.7121265162324681, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.67605633802818, "num_grad_updates_lifetime": 93420.5, "diff_num_grad_updates_vs_sampler_policy": 2129.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 405940, "num_agent_steps_trained": 405940}, "env_runners": {"episode_reward_max": -1309.0402317983212, "episode_reward_min": -4870.645841895779, "episode_reward_mean": -3098.8983611972467, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1426.5453169544385}, "policy_reward_max": {"policy_0": 8.937985727080806}, "policy_reward_mean": {"policy_0": -619.7796722394493}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2611.7424089652914, -2002.8454607809167, -2810.761153712258, -2106.769012577546, -4602.328381221165, -2022.7862501619456, -2266.8330855968725, -3655.5496980133057, -3428.1395015970343, -3440.4561659387464, -3439.86748298057, -3661.534385823897, -3584.984619041312, -3662.2429562504067, -3541.043363255949, -2382.9494562180257, -3667.9731623406337, -2781.8027061706907, -3093.3464989551617, -2629.856401775033, -3303.9554976613545, -4277.038488272214, -2697.832924566906, -4133.766797749453, -2579.926758979754, -4573.3820836638715, -3509.9849540712935, -4192.596754716804, -3322.7060385245086, -1309.0402317983212, -3307.794195573516, -4273.988837132848, -2931.0879584071095, -3793.509581100071, -1949.8043958960552, -1926.3533809491855, -2585.3807168976055, -3735.703878072156, -1701.3405048706504, -2768.523727957882, -3603.5659263383072, -3565.7539674879013, -4191.404205883857, -3174.866378176587, -3172.5091382655596, -2565.7395494616135, -3003.103165101746, -3595.3883912730994, -3438.6180621484223, -4538.1029047763495, -3310.179211883859, -3350.595092597881, -3534.2775238561053, -4092.776517292154, -2257.7123827274863, -1947.2077267129534, -2186.030576373171, -4310.57097494069, -2841.981411132841, -3360.5110353849473, -3830.2293088100078, -4870.645841895779, -2730.0582221608, -2281.159732192113, -2728.389842048807, -2146.5469051511786, -2107.6052536546104, -4223.152595748911, -2094.306131189977, -2197.710666329938, -2487.651635495665, -1945.014118273248, -1733.7094967082892, -3229.312275573328, -2168.8665848797873, -3157.595693702252, -3062.0600869183263, -2370.2186250486225, -3513.6445431422376, -2721.428547452902, -3424.1950659380914, -1835.081198083882, -3292.57667368503, -2929.9759446467315, -3537.747229076969, -3403.5384396898785, -3216.6413609565275, -3070.1652277528497, -3137.7239619277398, -3552.1725475015783, -3385.6102982754387, -3220.338040838953, -3032.7148397041665, -2228.0164080437144, -3246.0858860907833, -3972.767006013691, -3544.5980683637554, -3107.3728093186824, -3518.46068490387, -3326.3243224816506], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-195.74375151693968, -1071.1390312734272, -288.84403715862345, -285.18972600815175, -770.8258630081472, -126.65314973567777, -672.5560366512742, -957.3430144937836, -60.37614266725073, -185.91711723292968, -239.21590471944037, -773.476005186157, -639.8186048500605, -939.3976860394075, -218.8529529171956, -126.4316113226687, -566.9886341536624, -298.8503043657499, -505.87127128214763, -608.6271914533205, -437.22104532006557, -1036.665370926777, -1180.489628348079, -735.360574203742, -1212.591762422503, -118.4770265355425, -563.0853385097937, -747.5592878398668, -520.8421259799628, -72.8224712967799, -420.8382641404753, -105.67306404719076, -858.3482434174238, -654.010780165751, -227.96273382603025, -342.5555119129982, -1226.3734044078567, -878.2020131971602, -1119.5516754669075, -88.86709302838236, -121.22564153279357, -1075.5092027765752, -746.2609470401649, -684.9269466337363, -800.2167636137638, -781.2242608770382, -367.7658105962249, -1109.6183555554057, -896.3087037483024, -285.5390351617745, -929.2434715364154, -473.5854666345345, -1222.8994343120798, -110.42242664531993, -703.71668385222, -803.4511624924388, -850.7830748871896, -348.75063416246957, -643.6970543023843, -1014.8524599794138, -951.9936905423527, -758.365110385609, -1098.9680495661048, -569.6164192382073, -206.04134930903618, -182.2963734085611, -452.951120900123, -657.1242812240455, -1426.5453169544385, -943.3258637632405, -17.760519098919755, -774.5703271412339, -1223.5230028149035, -369.07674256838146, -1156.1127716325125, -534.9801042923568, -1051.3633941521196, -281.4010134180121, -128.92214845250896, -386.2827959030279, -659.2342150337311, -948.0413219264617, -758.891134904818, -503.74140159223833, -798.0650888833836, -165.65764713118827, -910.0061411428717, -964.496818493122, -521.5783586539249, -220.06374074958242, -396.77783743588395, -874.3386098319276, -1033.4599345943814, -421.2692372919404, -367.50087980103, -939.5655153306395, -90.11904263227892, -742.1775063680335, -97.84918971170245, -760.1451477323815, -1064.6387616493519, -752.2230117387562, -756.6098807627353, -649.9893513856717, -80.49449212483437, -909.6139650400445, -1074.824883922505, -879.8306796142431, -793.1822068579248, -619.5867528374957, -242.07336365232328, -357.01746871378333, -717.3086328856647, -753.978809258084, -627.4546500570508, -913.4315316714308, -593.2313996503793, -766.8729094747271, -782.9776495931346, -1077.2533073597806, -1215.5141132702154, -489.89157984508336, -55.64233236918578, -374.9086602638622, -443.97007323140735, -1259.800719242468, -1260.333359028415, -633.6192073805008, -751.4279066256431, -668.2008913868502, -722.9529353248266, -1108.1243491554358, -417.99315411571905, -449.1704509143734, -811.7440645609386, -1350.0431822838505, -723.2706366219303, -912.879353095129, -366.25880710756866, -840.1447756083188, -741.625725128, -53.69893901785315, -987.8373177560768, -309.07410337253367, -1230.4699532500433, -95.95683276939036, -185.42499749210904, -155.9436584897539, -127.96741742845956, -743.7473256186072, -163.3791377532153, -409.56059151193045, -1253.0031146407407, -612.2050553044724, -869.6462963631532, -574.3623070501646, -1253.8505621647141, -750.5555227314934, -333.4844884405691, -1361.7359567459077, -437.9272198917676, -684.5125259478896, -741.0104419801914, -674.3435065226142, -393.2942640646485, -590.0189613171136, -753.3273320400868, -691.157916482016, -1050.8890378594601, -708.1163334013963, -517.191971175518, -483.47642963391365, -318.8961921745571, -11.512545007608555, -618.7272579044588, -198.6317743052013, -739.7952154589635, -643.5365552066196, -261.55300760754136, -82.83682837085883, -893.4326572238946, -410.54906978273715, -481.415289640261, -194.76825543764525, -605.2154448130665, -1389.9719798576184, -659.8454981622953, -373.19219629926425, -1240.604426006434, -72.08977774653908, -240.6115119185826, -742.567310610311, -509.94994584794597, -66.78754709645077, -141.42418939736046, -892.4472381549782, -403.3429712846863, -1170.7018390938936, -45.79746018535297, -256.23421923897155, -874.5962578815711, -1140.9815983211097, -985.6965923843502, -292.0238875428207, -310.26759020845964, -918.2625323412761, -719.0222393467294, -373.9422066197327, -925.2840559442516, -629.2429332359114, -1121.0745962779251, -909.7931277853916, -576.1978063001226, -1157.0418881621847, -427.2967873582341, -791.7671429793502, -616.6861615359131, -418.1133443873188, -559.3765268686064, -788.9232024053963, -1131.1764410090902, -559.2646872622834, -676.5679028104939, -680.2437326404804, -125.25637454321425, -798.7653584761349, -12.220638581574363, -860.9024557946026, -368.2264399657588, -525.6246566435441, -502.2054811446371, -875.086123096833, -1062.509924761773, -83.59729730859682, -479.704338789906, -608.5266061231733, -454.3847847387343, -1317.581738561419, -535.7405825590394, -679.154679290734, -805.6206059756026, -189.58394915098023, -156.52138395637792, -1000.558874336976, -1286.3332487284856, -858.7601339904987, -984.4675833883877, -1055.02827271973, -740.0259153141433, -899.8209993635929, -426.1158684884067, -769.7663315227735, -766.2586904858218, -689.6784882909113, -658.3598330959467, -406.2932879362011, -848.2896630239118, -842.8566346427365, -796.0005217149813, -457.15498528005185, -376.14105993344333, -962.4443646502843, -254.54358325211612, -1193.0309152007137, -748.1176008195488, -269.92132544540954, -1372.9178007734913, -742.4346782366806, -728.611786319147, -978.8909265174248, -860.2179841474891, -23.48069973569617, -121.84979178811676, -1141.9691257358754, -110.19478132031067, -367.63214520081624, -897.9380974116112, -63.116145414125285, -153.0657785987212, -465.4555600876781, -1072.1541719469606, -157.07404459578285, -312.98109375116036, -48.67375147650321, -595.1475146027651, -819.8698771287997, -854.3866028748799, -890.8984972844679, -1168.1430961638055, -577.2729014887359, -958.400333326179, -25.4522307961302, -46.445212109820204, -1206.2206874492758, -605.462947451435, -167.74290918728306, -365.65832641523804, -444.18454304695445, -1164.9166737269722, -1218.008583008501, -629.4919978511788, -1211.771818209566, -660.7759605964877, -868.6248752973152, -459.56465685546067, -1194.6833095881234, -1326.3894809888827, -835.156531059361, -752.5417670386778, -761.8747532207356, -198.6084418568793, -820.6633849792972, -44.28194794461421, -1034.3675422120536, -632.1369051679554, -310.3316055771308, -979.6085794681611, -602.3956822321568, -174.8151770389817, -214.00868787568044, -405.1483230753692, -644.6536324976656, -852.48928436752, -55.213559385924135, -770.8850427223282, -607.9874181071013, -497.148025144861, -428.9697610440874, 8.937985727080806, -621.3796865822104, -475.4404165200105, -970.8396067557752, -62.72645129706559, -560.3342178819632, -38.2645611997957, -962.3871665536298, -627.0435212120364, -592.0168915243064, -735.503747427581, -1306.20126903136, -25.83649869496281, -1104.2397140237672, -177.22289220945285, -731.1376920019278, -55.86933425986594, -431.70394897273655, -119.40567497383554, -870.5108142084238, -537.8169598426322, -238.27326833230825, -45.515622257073616, -1320.4313453449633, -681.0104825830969, -164.961723681645, -275.7324616288854, -322.9029364252729, -614.6301612443594, -439.00468957878604, -150.22198563741696, -418.25434538741325, -319.8171397480992, -628.2719831187187, -159.15904062165555, -255.42638069864938, -371.0349525211669, -542.1688262121642, -1090.064632064102, -418.1052236579235, -306.0398535386579, -872.9337401004753, -348.6882708921904, -722.6042866618279, -503.81748185300273, -523.3901834124761, -70.36636206028919, -583.7569732208372, -170.10430748336006, -1003.686769119616, -672.5785445874055, -727.4690992910334, -457.7095503903525, -385.95591634675515, -232.18947978725808, -1147.628459558822, -838.5766808351392, -942.6884223595724, -22.167094588370748, -642.4956732425856, -590.4274421700779, -172.43999268801494, -966.8452476836948, -99.29252942789451, -737.265636027523, -1001.680013685064, -708.5611163180643, -278.07846512470337, -717.1188712477776, -751.7781790011553, -701.4669147692415, -272.98611731002444, -924.3675497781006, -1305.2034625435692, -101.63754476813196, -269.7081750043599, -823.2783338439277, -905.7087514790504, -148.83743955486236, -415.9820973636468, -57.451130951492104, -307.10177873482996, -660.9007347869614, -859.1601180491448, -724.7510624361527, -84.18785990728121, -963.5768985054929, -626.7840490423519, -144.01280138784728, -847.3607566296465, -950.6369737884423, -361.1813637984445, -1202.7616901875515, -670.1973515714478, -556.0523647586442, -570.785711536202, -537.9501110231174, -901.407266919987, -389.54321986100314, -612.6044341788324, -939.7244149015412, -560.2591038285138, -1328.5595617637578, -271.0337537248601, -649.3402027943916, -209.85270237496806, -757.8551402985494, -114.7889825008157, -708.5002273719424, -594.195041882967, -663.3919254447935, -989.2890505523332, -783.4676490096559, -66.05397604409808, -430.47488079699167, -700.6228188257254, -1157.1046372512694, -96.00317976522062, -1231.6883682566556, -655.9714782487641, -950.1054304503714, -618.4040907805636, -323.7465208775469, -1018.4403230522976, -1101.3475743545212, -920.948308214596, -21.12757177647754, -205.51544341534515, -1079.5204862228427, -315.7916441442034, -886.5944019857353, -732.9160650708268, -706.8449452870651, -344.32110420698456, -144.867047200377, -756.4542205873272, -1080.2275224224104, -696.6363474020166, -557.6527067164674, -158.8447837944682, -119.60675075495699, -695.2758193758027, -1159.9345886138638, -1127.0544872346802, -109.55376665870173, -22.75240425946919, -826.7906393240686, -709.9004673889592, -1352.7450744877465, -107.90875567055589, -1097.0526069424095, -705.1601015240238, -75.18859543062088, -680.5350860031438, -964.3395298699967, -1204.9048938073684, -619.6299632526265, -667.6879835785268, -585.9045099044376, -406.2283824804986, -860.082467972796, -587.4694653824246, -793.8680247202649, -60.33598823700846, -1070.2185714365019, -604.2743160147056, -989.7637844953937, -222.84685544939822, -847.9593293552098, -464.2615096751194, -580.4899943248606, -1210.7666336770594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.638296865269715, "mean_inference_ms": 1.7423076385534748, "mean_action_processing_ms": 0.9044359532334998, "mean_env_wait_ms": 10.961421427585751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015448570251464844, "StateBufferConnector_ms": 0.011181354522705078, "ViewRequirementAgentConnector_ms": 0.42467188835144043}, "num_episodes": 20, "episode_return_max": -1309.0402317983212, "episode_return_min": -4870.645841895779, "episode_return_mean": -3098.8983611972467, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 405940, "num_agent_steps_trained": 405940, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.86203762940312, "num_env_steps_trained_throughput_per_sec": 71.86203762940312, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 405940, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 405940, "timers": {"training_iteration_time_ms": 52955.733, "restore_workers_time_ms": 0.027, "training_step_time_ms": 52955.663, "sample_time_ms": 3441.874, "learn_time_ms": 49454.997, "learn_throughput": 80.882, "synch_weights_time_ms": 55.666}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 405940, "num_agent_steps_trained": 405940}, "done": false, "training_iteration": 22, "trial_id": "05c72_00000", "date": "2024-07-26_15-02-33", "timestamp": 1721986353, "time_this_iter_s": 55.67170715332031, "time_total_s": 1174.0910909175873, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805a8ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1174.0910909175873, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 11.020253164556964, "ram_util_percent": 32.986075949367084}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 186.0486644835055, "cur_kl_coeff": 0.3375, "cur_lr": 0.001, "total_loss": 4.989171262948507, "policy_loss": -0.0023475805017876992, "vf_loss": 5.004938688627654, "vf_explained_var": 0.9851210602631806, "kl": 0.01580549827911704, "entropy": 1.8754205667098927, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.2482269503546, "num_grad_updates_lifetime": 97665.5, "diff_num_grad_updates_vs_sampler_policy": 2114.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 423882, "num_agent_steps_trained": 423882}, "env_runners": {"episode_reward_max": -1309.0402317983212, "episode_reward_min": -4870.645841895779, "episode_reward_mean": -3160.3411615976775, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1430.1774670405102}, "policy_reward_max": {"policy_0": 8.937985727080806}, "policy_reward_mean": {"policy_0": -632.0682323195355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3303.9554976613545, -4277.038488272214, -2697.832924566906, -4133.766797749453, -2579.926758979754, -4573.3820836638715, -3509.9849540712935, -4192.596754716804, -3322.7060385245086, -1309.0402317983212, -3307.794195573516, -4273.988837132848, -2931.0879584071095, -3793.509581100071, -1949.8043958960552, -1926.3533809491855, -2585.3807168976055, -3735.703878072156, -1701.3405048706504, -2768.523727957882, -3603.5659263383072, -3565.7539674879013, -4191.404205883857, -3174.866378176587, -3172.5091382655596, -2565.7395494616135, -3003.103165101746, -3595.3883912730994, -3438.6180621484223, -4538.1029047763495, -3310.179211883859, -3350.595092597881, -3534.2775238561053, -4092.776517292154, -2257.7123827274863, -1947.2077267129534, -2186.030576373171, -4310.57097494069, -2841.981411132841, -3360.5110353849473, -3830.2293088100078, -4870.645841895779, -2730.0582221608, -2281.159732192113, -2728.389842048807, -2146.5469051511786, -2107.6052536546104, -4223.152595748911, -2094.306131189977, -2197.710666329938, -2487.651635495665, -1945.014118273248, -1733.7094967082892, -3229.312275573328, -2168.8665848797873, -3157.595693702252, -3062.0600869183263, -2370.2186250486225, -3513.6445431422376, -2721.428547452902, -3424.1950659380914, -1835.081198083882, -3292.57667368503, -2929.9759446467315, -3537.747229076969, -3403.5384396898785, -3216.6413609565275, -3070.1652277528497, -3137.7239619277398, -3552.1725475015783, -3385.6102982754387, -3220.338040838953, -3032.7148397041665, -2228.0164080437144, -3246.0858860907833, -3972.767006013691, -3544.5980683637554, -3107.3728093186824, -3518.46068490387, -3326.3243224816506, -4688.84542183037, -2175.4832501449314, -2656.2110456638115, -3457.7661837964897, -4099.080661304783, -4323.325665876726, -2006.1299458949857, -4414.122594256008, -3010.430450220639, -3924.976874971743, -2867.5037615929173, -2527.134672158115, -3386.5389695679223, -2807.325507347, -4252.686413717537, -2358.2544635462277, -3205.6766037282273, -3969.2083024304065, -4133.3622806335325, -3274.029122737506], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1064.6387616493519, -752.2230117387562, -756.6098807627353, -649.9893513856717, -80.49449212483437, -909.6139650400445, -1074.824883922505, -879.8306796142431, -793.1822068579248, -619.5867528374957, -242.07336365232328, -357.01746871378333, -717.3086328856647, -753.978809258084, -627.4546500570508, -913.4315316714308, -593.2313996503793, -766.8729094747271, -782.9776495931346, -1077.2533073597806, -1215.5141132702154, -489.89157984508336, -55.64233236918578, -374.9086602638622, -443.97007323140735, -1259.800719242468, -1260.333359028415, -633.6192073805008, -751.4279066256431, -668.2008913868502, -722.9529353248266, -1108.1243491554358, -417.99315411571905, -449.1704509143734, -811.7440645609386, -1350.0431822838505, -723.2706366219303, -912.879353095129, -366.25880710756866, -840.1447756083188, -741.625725128, -53.69893901785315, -987.8373177560768, -309.07410337253367, -1230.4699532500433, -95.95683276939036, -185.42499749210904, -155.9436584897539, -127.96741742845956, -743.7473256186072, -163.3791377532153, -409.56059151193045, -1253.0031146407407, -612.2050553044724, -869.6462963631532, -574.3623070501646, -1253.8505621647141, -750.5555227314934, -333.4844884405691, -1361.7359567459077, -437.9272198917676, -684.5125259478896, -741.0104419801914, -674.3435065226142, -393.2942640646485, -590.0189613171136, -753.3273320400868, -691.157916482016, -1050.8890378594601, -708.1163334013963, -517.191971175518, -483.47642963391365, -318.8961921745571, -11.512545007608555, -618.7272579044588, -198.6317743052013, -739.7952154589635, -643.5365552066196, -261.55300760754136, -82.83682837085883, -893.4326572238946, -410.54906978273715, -481.415289640261, -194.76825543764525, -605.2154448130665, -1389.9719798576184, -659.8454981622953, -373.19219629926425, -1240.604426006434, -72.08977774653908, -240.6115119185826, -742.567310610311, -509.94994584794597, -66.78754709645077, -141.42418939736046, -892.4472381549782, -403.3429712846863, -1170.7018390938936, -45.79746018535297, -256.23421923897155, -874.5962578815711, -1140.9815983211097, -985.6965923843502, -292.0238875428207, -310.26759020845964, -918.2625323412761, -719.0222393467294, -373.9422066197327, -925.2840559442516, -629.2429332359114, -1121.0745962779251, -909.7931277853916, -576.1978063001226, -1157.0418881621847, -427.2967873582341, -791.7671429793502, -616.6861615359131, -418.1133443873188, -559.3765268686064, -788.9232024053963, -1131.1764410090902, -559.2646872622834, -676.5679028104939, -680.2437326404804, -125.25637454321425, -798.7653584761349, -12.220638581574363, -860.9024557946026, -368.2264399657588, -525.6246566435441, -502.2054811446371, -875.086123096833, -1062.509924761773, -83.59729730859682, -479.704338789906, -608.5266061231733, -454.3847847387343, -1317.581738561419, -535.7405825590394, -679.154679290734, -805.6206059756026, -189.58394915098023, -156.52138395637792, -1000.558874336976, -1286.3332487284856, -858.7601339904987, -984.4675833883877, -1055.02827271973, -740.0259153141433, -899.8209993635929, -426.1158684884067, -769.7663315227735, -766.2586904858218, -689.6784882909113, -658.3598330959467, -406.2932879362011, -848.2896630239118, -842.8566346427365, -796.0005217149813, -457.15498528005185, -376.14105993344333, -962.4443646502843, -254.54358325211612, -1193.0309152007137, -748.1176008195488, -269.92132544540954, -1372.9178007734913, -742.4346782366806, -728.611786319147, -978.8909265174248, -860.2179841474891, -23.48069973569617, -121.84979178811676, -1141.9691257358754, -110.19478132031067, -367.63214520081624, -897.9380974116112, -63.116145414125285, -153.0657785987212, -465.4555600876781, -1072.1541719469606, -157.07404459578285, -312.98109375116036, -48.67375147650321, -595.1475146027651, -819.8698771287997, -854.3866028748799, -890.8984972844679, -1168.1430961638055, -577.2729014887359, -958.400333326179, -25.4522307961302, -46.445212109820204, -1206.2206874492758, -605.462947451435, -167.74290918728306, -365.65832641523804, -444.18454304695445, -1164.9166737269722, -1218.008583008501, -629.4919978511788, -1211.771818209566, -660.7759605964877, -868.6248752973152, -459.56465685546067, -1194.6833095881234, -1326.3894809888827, -835.156531059361, -752.5417670386778, -761.8747532207356, -198.6084418568793, -820.6633849792972, -44.28194794461421, -1034.3675422120536, -632.1369051679554, -310.3316055771308, -979.6085794681611, -602.3956822321568, -174.8151770389817, -214.00868787568044, -405.1483230753692, -644.6536324976656, -852.48928436752, -55.213559385924135, -770.8850427223282, -607.9874181071013, -497.148025144861, -428.9697610440874, 8.937985727080806, -621.3796865822104, -475.4404165200105, -970.8396067557752, -62.72645129706559, -560.3342178819632, -38.2645611997957, -962.3871665536298, -627.0435212120364, -592.0168915243064, -735.503747427581, -1306.20126903136, -25.83649869496281, -1104.2397140237672, -177.22289220945285, -731.1376920019278, -55.86933425986594, -431.70394897273655, -119.40567497383554, -870.5108142084238, -537.8169598426322, -238.27326833230825, -45.515622257073616, -1320.4313453449633, -681.0104825830969, -164.961723681645, -275.7324616288854, -322.9029364252729, -614.6301612443594, -439.00468957878604, -150.22198563741696, -418.25434538741325, -319.8171397480992, -628.2719831187187, -159.15904062165555, -255.42638069864938, -371.0349525211669, -542.1688262121642, -1090.064632064102, -418.1052236579235, -306.0398535386579, -872.9337401004753, -348.6882708921904, -722.6042866618279, -503.81748185300273, -523.3901834124761, -70.36636206028919, -583.7569732208372, -170.10430748336006, -1003.686769119616, -672.5785445874055, -727.4690992910334, -457.7095503903525, -385.95591634675515, -232.18947978725808, -1147.628459558822, -838.5766808351392, -942.6884223595724, -22.167094588370748, -642.4956732425856, -590.4274421700779, -172.43999268801494, -966.8452476836948, -99.29252942789451, -737.265636027523, -1001.680013685064, -708.5611163180643, -278.07846512470337, -717.1188712477776, -751.7781790011553, -701.4669147692415, -272.98611731002444, -924.3675497781006, -1305.2034625435692, -101.63754476813196, -269.7081750043599, -823.2783338439277, -905.7087514790504, -148.83743955486236, -415.9820973636468, -57.451130951492104, -307.10177873482996, -660.9007347869614, -859.1601180491448, -724.7510624361527, -84.18785990728121, -963.5768985054929, -626.7840490423519, -144.01280138784728, -847.3607566296465, -950.6369737884423, -361.1813637984445, -1202.7616901875515, -670.1973515714478, -556.0523647586442, -570.785711536202, -537.9501110231174, -901.407266919987, -389.54321986100314, -612.6044341788324, -939.7244149015412, -560.2591038285138, -1328.5595617637578, -271.0337537248601, -649.3402027943916, -209.85270237496806, -757.8551402985494, -114.7889825008157, -708.5002273719424, -594.195041882967, -663.3919254447935, -989.2890505523332, -783.4676490096559, -66.05397604409808, -430.47488079699167, -700.6228188257254, -1157.1046372512694, -96.00317976522062, -1231.6883682566556, -655.9714782487641, -950.1054304503714, -618.4040907805636, -323.7465208775469, -1018.4403230522976, -1101.3475743545212, -920.948308214596, -21.12757177647754, -205.51544341534515, -1079.5204862228427, -315.7916441442034, -886.5944019857353, -732.9160650708268, -706.8449452870651, -344.32110420698456, -144.867047200377, -756.4542205873272, -1080.2275224224104, -696.6363474020166, -557.6527067164674, -158.8447837944682, -119.60675075495699, -695.2758193758027, -1159.9345886138638, -1127.0544872346802, -109.55376665870173, -22.75240425946919, -826.7906393240686, -709.9004673889592, -1352.7450744877465, -107.90875567055589, -1097.0526069424095, -705.1601015240238, -75.18859543062088, -680.5350860031438, -964.3395298699967, -1204.9048938073684, -619.6299632526265, -667.6879835785268, -585.9045099044376, -406.2283824804986, -860.082467972796, -587.4694653824246, -793.8680247202649, -60.33598823700846, -1070.2185714365019, -604.2743160147056, -989.7637844953937, -222.84685544939822, -847.9593293552098, -464.2615096751194, -580.4899943248606, -1210.7666336770594, -814.3328774358458, -1032.85297893261, -937.1143562473736, -1040.730070893868, -863.815138320668, -726.2009109613088, -26.756564360847115, -626.3556650406365, -602.617176616985, -193.55293316515497, -624.9248969825027, -12.283287242534424, -1029.7870632169129, -83.54711389732074, -905.6686843245432, -1148.9932641743437, -695.0532943870464, -643.6721334000184, -569.5980279077836, -400.44946392729605, -892.6095835267992, -761.5117789723937, -467.1748963427096, -592.8304942596609, -1384.9539082032156, -1296.3647633355276, -274.7493853674387, -1430.1774670405102, -694.1158130688461, -627.9182370644029, -47.60080899595615, -1219.555401267534, -200.16299600386327, -66.67098702978376, -472.1397525978491, -1263.0338970559346, -260.60202231680097, -477.78454868376184, -1327.4918257415854, -1085.210300457927, -259.12476723179367, -716.7542904587568, -600.2828143302733, -815.4916545561715, -618.7769236436432, -582.2805921463038, -122.63621731314136, -1179.3552717846255, -1002.9185487214613, -1037.7862450062098, -1135.4555488934177, -869.716129017422, -169.43181525317854, -75.75665050531026, -617.1436179235889, -238.82702595260903, -233.16072027724775, -200.34656506711147, -792.4996103644255, -1062.3007504967234, -565.930376322105, -686.2425136005694, -959.2841560553837, -1157.324238503403, -17.757685086459546, -385.4318844961543, -865.4472882295448, -712.6323896492261, -108.79817837993116, -735.0157665921419, -1132.9981498524855, -811.266555269693, -997.4663987021403, -770.6509900951177, -540.304319798099, -262.8059165188093, -1271.985515688452, -109.50311467882361, -267.4819977112764, -446.47791894886745, -644.8557719687208, -751.0482320553702, -357.9063809744562, -100.29680623275016, -1351.5694124969316, -686.6949915473583, -631.7382158868737, -589.5506698837061, -801.413931191201, -1259.8104939212665, -699.4648474013989, -1295.1678529308467, -618.1535099769757, -718.6002433289293, -801.975826995384, -326.1841779105452, -1083.289343133891, -480.0277046073795, -523.7226587910139, -860.8052382946782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.635837505959408, "mean_inference_ms": 1.7405311887597064, "mean_action_processing_ms": 0.9012130458896513, "mean_env_wait_ms": 10.947490074403774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016141414642333984, "StateBufferConnector_ms": 0.011558055877685547, "ViewRequirementAgentConnector_ms": 0.44019651412963867}, "num_episodes": 20, "episode_return_max": -1309.0402317983212, "episode_return_min": -4870.645841895779, "episode_return_mean": -3160.3411615976775, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 423882, "num_agent_steps_trained": 423882, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.57774303462958, "num_env_steps_trained_throughput_per_sec": 77.57774303462958, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 423882, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 423882, "timers": {"training_iteration_time_ms": 52410.624, "restore_workers_time_ms": 0.028, "training_step_time_ms": 52410.552, "sample_time_ms": 3435.087, "learn_time_ms": 48917.233, "learn_throughput": 81.771, "synch_weights_time_ms": 55.086}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 423882, "num_agent_steps_trained": 423882}, "done": false, "training_iteration": 23, "trial_id": "05c72_00000", "date": "2024-07-26_15-03-25", "timestamp": 1721986405, "time_this_iter_s": 51.574146032333374, "time_total_s": 1225.6652369499207, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805ab520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1225.6652369499207, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 11.19864864864865, "ram_util_percent": 32.98108108108108}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 191.24277366494908, "cur_kl_coeff": 0.3375, "cur_lr": 0.001, "total_loss": 4.995733677949144, "policy_loss": 0.0007357208411856402, "vf_loss": 5.007414175702932, "vf_explained_var": 0.9815854166595029, "kl": 0.01752439842571968, "entropy": 1.8330707808055788, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.30281690140845, "num_grad_updates_lifetime": 101910.5, "diff_num_grad_updates_vs_sampler_policy": 2129.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 441959, "num_agent_steps_trained": 441959}, "env_runners": {"episode_reward_max": -858.9348164112799, "episode_reward_min": -4870.645841895779, "episode_reward_mean": -2993.898317965548, "episode_len_mean": 149.55, "episode_media": {}, "episodes_timesteps_total": 14955, "policy_reward_min": {"policy_0": -1430.1774670405102}, "policy_reward_max": {"policy_0": 8.937985727080806}, "policy_reward_mean": {"policy_0": -598.7796635931095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3830.2293088100078, -4870.645841895779, -2730.0582221608, -2281.159732192113, -2728.389842048807, -2146.5469051511786, -2107.6052536546104, -4223.152595748911, -2094.306131189977, -2197.710666329938, -2487.651635495665, -1945.014118273248, -1733.7094967082892, -3229.312275573328, -2168.8665848797873, -3157.595693702252, -3062.0600869183263, -2370.2186250486225, -3513.6445431422376, -2721.428547452902, -3424.1950659380914, -1835.081198083882, -3292.57667368503, -2929.9759446467315, -3537.747229076969, -3403.5384396898785, -3216.6413609565275, -3070.1652277528497, -3137.7239619277398, -3552.1725475015783, -3385.6102982754387, -3220.338040838953, -3032.7148397041665, -2228.0164080437144, -3246.0858860907833, -3972.767006013691, -3544.5980683637554, -3107.3728093186824, -3518.46068490387, -3326.3243224816506, -4688.84542183037, -2175.4832501449314, -2656.2110456638115, -3457.7661837964897, -4099.080661304783, -4323.325665876726, -2006.1299458949857, -4414.122594256008, -3010.430450220639, -3924.976874971743, -2867.5037615929173, -2527.134672158115, -3386.5389695679223, -2807.325507347, -4252.686413717537, -2358.2544635462277, -3205.6766037282273, -3969.2083024304065, -4133.3622806335325, -3274.029122737506, -4330.9375483953945, -3564.084605234907, -2078.390138201243, -2668.0871096454543, -3971.455753009473, -2375.3693385919687, -3658.8677424992247, -2616.0858717933424, -2488.9195960964344, -2411.3601188035177, -2097.6889397058962, -3472.633654613808, -2091.41480005758, -3673.315545383224, -2663.5977585119026, -3928.7759025505466, -3334.4543911159544, -2963.9176940678217, -3452.503040792409, -3590.7505573285976, -1851.7194335291877, -3353.6103952908556, -3148.178860107354, -2552.087305166084, -2867.585843212401, -2618.2007911071632, -2538.2864128133574, -2066.4747300961462, -858.9348164112799, -3195.3534510685813, -2236.197828883752, -2506.539903406562, -2344.909137112199, -3426.89623977759, -1638.857710783976, -3461.1518089572983, -2089.4554671985316, -2528.9727951411987, -2794.2663237608867, -2760.0381252410275], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-629.4919978511788, -1211.771818209566, -660.7759605964877, -868.6248752973152, -459.56465685546067, -1194.6833095881234, -1326.3894809888827, -835.156531059361, -752.5417670386778, -761.8747532207356, -198.6084418568793, -820.6633849792972, -44.28194794461421, -1034.3675422120536, -632.1369051679554, -310.3316055771308, -979.6085794681611, -602.3956822321568, -174.8151770389817, -214.00868787568044, -405.1483230753692, -644.6536324976656, -852.48928436752, -55.213559385924135, -770.8850427223282, -607.9874181071013, -497.148025144861, -428.9697610440874, 8.937985727080806, -621.3796865822104, -475.4404165200105, -970.8396067557752, -62.72645129706559, -560.3342178819632, -38.2645611997957, -962.3871665536298, -627.0435212120364, -592.0168915243064, -735.503747427581, -1306.20126903136, -25.83649869496281, -1104.2397140237672, -177.22289220945285, -731.1376920019278, -55.86933425986594, -431.70394897273655, -119.40567497383554, -870.5108142084238, -537.8169598426322, -238.27326833230825, -45.515622257073616, -1320.4313453449633, -681.0104825830969, -164.961723681645, -275.7324616288854, -322.9029364252729, -614.6301612443594, -439.00468957878604, -150.22198563741696, -418.25434538741325, -319.8171397480992, -628.2719831187187, -159.15904062165555, -255.42638069864938, -371.0349525211669, -542.1688262121642, -1090.064632064102, -418.1052236579235, -306.0398535386579, -872.9337401004753, -348.6882708921904, -722.6042866618279, -503.81748185300273, -523.3901834124761, -70.36636206028919, -583.7569732208372, -170.10430748336006, -1003.686769119616, -672.5785445874055, -727.4690992910334, -457.7095503903525, -385.95591634675515, -232.18947978725808, -1147.628459558822, -838.5766808351392, -942.6884223595724, -22.167094588370748, -642.4956732425856, -590.4274421700779, -172.43999268801494, -966.8452476836948, -99.29252942789451, -737.265636027523, -1001.680013685064, -708.5611163180643, -278.07846512470337, -717.1188712477776, -751.7781790011553, -701.4669147692415, -272.98611731002444, -924.3675497781006, -1305.2034625435692, -101.63754476813196, -269.7081750043599, -823.2783338439277, -905.7087514790504, -148.83743955486236, -415.9820973636468, -57.451130951492104, -307.10177873482996, -660.9007347869614, -859.1601180491448, -724.7510624361527, -84.18785990728121, -963.5768985054929, -626.7840490423519, -144.01280138784728, -847.3607566296465, -950.6369737884423, -361.1813637984445, -1202.7616901875515, -670.1973515714478, -556.0523647586442, -570.785711536202, -537.9501110231174, -901.407266919987, -389.54321986100314, -612.6044341788324, -939.7244149015412, -560.2591038285138, -1328.5595617637578, -271.0337537248601, -649.3402027943916, -209.85270237496806, -757.8551402985494, -114.7889825008157, -708.5002273719424, -594.195041882967, -663.3919254447935, -989.2890505523332, -783.4676490096559, -66.05397604409808, -430.47488079699167, -700.6228188257254, -1157.1046372512694, -96.00317976522062, -1231.6883682566556, -655.9714782487641, -950.1054304503714, -618.4040907805636, -323.7465208775469, -1018.4403230522976, -1101.3475743545212, -920.948308214596, -21.12757177647754, -205.51544341534515, -1079.5204862228427, -315.7916441442034, -886.5944019857353, -732.9160650708268, -706.8449452870651, -344.32110420698456, -144.867047200377, -756.4542205873272, -1080.2275224224104, -696.6363474020166, -557.6527067164674, -158.8447837944682, -119.60675075495699, -695.2758193758027, -1159.9345886138638, -1127.0544872346802, -109.55376665870173, -22.75240425946919, -826.7906393240686, -709.9004673889592, -1352.7450744877465, -107.90875567055589, -1097.0526069424095, -705.1601015240238, -75.18859543062088, -680.5350860031438, -964.3395298699967, -1204.9048938073684, -619.6299632526265, -667.6879835785268, -585.9045099044376, -406.2283824804986, -860.082467972796, -587.4694653824246, -793.8680247202649, -60.33598823700846, -1070.2185714365019, -604.2743160147056, -989.7637844953937, -222.84685544939822, -847.9593293552098, -464.2615096751194, -580.4899943248606, -1210.7666336770594, -814.3328774358458, -1032.85297893261, -937.1143562473736, -1040.730070893868, -863.815138320668, -726.2009109613088, -26.756564360847115, -626.3556650406365, -602.617176616985, -193.55293316515497, -624.9248969825027, -12.283287242534424, -1029.7870632169129, -83.54711389732074, -905.6686843245432, -1148.9932641743437, -695.0532943870464, -643.6721334000184, -569.5980279077836, -400.44946392729605, -892.6095835267992, -761.5117789723937, -467.1748963427096, -592.8304942596609, -1384.9539082032156, -1296.3647633355276, -274.7493853674387, -1430.1774670405102, -694.1158130688461, -627.9182370644029, -47.60080899595615, -1219.555401267534, -200.16299600386327, -66.67098702978376, -472.1397525978491, -1263.0338970559346, -260.60202231680097, -477.78454868376184, -1327.4918257415854, -1085.210300457927, -259.12476723179367, -716.7542904587568, -600.2828143302733, -815.4916545561715, -618.7769236436432, -582.2805921463038, -122.63621731314136, -1179.3552717846255, -1002.9185487214613, -1037.7862450062098, -1135.4555488934177, -869.716129017422, -169.43181525317854, -75.75665050531026, -617.1436179235889, -238.82702595260903, -233.16072027724775, -200.34656506711147, -792.4996103644255, -1062.3007504967234, -565.930376322105, -686.2425136005694, -959.2841560553837, -1157.324238503403, -17.757685086459546, -385.4318844961543, -865.4472882295448, -712.6323896492261, -108.79817837993116, -735.0157665921419, -1132.9981498524855, -811.266555269693, -997.4663987021403, -770.6509900951177, -540.304319798099, -262.8059165188093, -1271.985515688452, -109.50311467882361, -267.4819977112764, -446.47791894886745, -644.8557719687208, -751.0482320553702, -357.9063809744562, -100.29680623275016, -1351.5694124969316, -686.6949915473583, -631.7382158868737, -589.5506698837061, -801.413931191201, -1259.8104939212665, -699.4648474013989, -1295.1678529308467, -618.1535099769757, -718.6002433289293, -801.975826995384, -326.1841779105452, -1083.289343133891, -480.0277046073795, -523.7226587910139, -860.8052382946782, -585.678320372183, -1207.7493182458215, -836.451569996819, -561.2458320234035, -1139.8125077571685, -805.9985138805653, -738.414922109695, -310.35978174259947, -1075.63265351553, -633.6787339865137, -379.75199635917215, -280.8902376160592, -199.42947222274012, -379.6399199605872, -838.6785120426836, -287.52509938491625, -554.8522232964964, -197.24256664127356, -1004.6682333829356, -623.7989869398331, -788.200555803362, -465.3135225080394, -1056.4438538228333, -814.8476939681805, -846.6501269070585, -271.6865417629894, -934.4780994843918, -22.125226399389664, -738.697633552707, -408.38183739249087, -999.700069372932, -72.13453195993984, -243.18355158474287, -1274.8488458344827, -1069.0007437471272, -823.517148520151, -430.57963084803515, -680.5236030324762, -656.2983480972536, -25.167141295426752, -276.30340928016153, -302.2697939643681, -792.5715165405384, -861.5498856053955, -256.2249907059694, -918.4814389236051, -329.9062669784185, -60.907908823027086, -172.5653394218329, -929.4991646566332, -860.6795835965348, -95.16655415661423, -388.351087265627, -520.1707909510056, -233.32092373611468, -305.283820678283, -873.1943716283408, -1091.315291520639, -581.0314057563722, -621.8087650301738, -436.9036369530657, -12.306061103665284, -1015.8403933486491, -218.8667211228632, -407.4979875293376, -872.0093801079383, -1222.0117958035398, -453.6796143989782, -989.3308570528533, -136.28389801991003, -806.2412070184012, -1011.1886592507533, -333.022422483749, -112.02941491280691, -401.1160548461935, -819.6428573952119, -522.7667518735406, -689.3406429254716, -654.1571586579507, -1242.86849169837, -1131.8444858329408, -804.7952621170625, -359.2772046614897, -376.13826464300746, -662.3991738614551, -1125.2119430405187, -182.74450933806528, -1236.539222784087, -247.12280988570254, -172.29920901944791, -1037.5633294679938, -189.22145234218655, -528.8397798180143, -506.749776305365, -1190.128702858854, -482.46277916049917, -769.5253835392366, -854.3402777098034, -675.1681552496378, -809.25396166942, -219.71486443797073, -200.91568114343545, -505.4084096009173, -253.93836825302662, -671.7421100938379, -1259.7479616104463, -568.5534219900851, -207.1852403497799, -696.4794164712573, -621.6443548692907, -882.3740742124421, -83.53187066249197, -460.7012776287336, -1176.4841071827818, -545.0875304209048, -257.5746583425633, -301.29878215113075, -1249.9269045722097, -496.33083469410917, -246.95612540607425, -162.38874974668735, -936.2909454864943, -540.7567814357448, -628.042563082458, -600.1068034610145, -1004.7705231165497, -402.7921271363407, -340.529373990747, -762.5688812845208, -107.53988557900531, -390.60076365959975, -821.2237879905658, -687.0877308333661, -103.89743068774972, -535.4766996420773, -232.97335552390487, -540.6893950616058, -334.7622927199125, -749.4469662342642, -208.60272055645868, -149.04659921649323, -406.5771301975975, -92.84775252427924, -181.45716885821125, -29.006165614698112, -797.014192543669, -78.125921940983, -558.5247381865811, -1066.794270771122, -694.8943276262261, -214.89009608127844, -436.16178840475317, -392.90889370162927, -941.2501587282852, -250.98689196780668, -124.81906124905426, -212.11348784720067, -927.0594809859073, -872.8396133741899, -369.70825995020584, -82.96035206811385, -801.2355040631815, -477.22409969985716, -552.8199369357504, -430.66924434529665, -874.4716748201112, -1011.6235275210888, -309.30594557177693, -1201.9640450507084, -29.531046813907608, -248.39916991130232, -116.08953348847758, -64.33277226510307, -460.7835586054002, -749.2526765136924, -1155.4141862958384, -594.896277081942, -844.3442746513565, -68.24551081921582, -798.2515601089457, -67.0676783878366, -146.4147467407474, -722.7534026687038, -1072.45356858075, -80.76607082049445, -351.9167552426647, -558.2874661204188, -494.00320679493865, -332.33714969600885, -792.4282172871683, -167.74764824335927, -890.406870857518, -983.5029220506211, -442.69758417416966, -309.911298435219, -1045.8107232017207, -995.0051113316792, -95.26562075133295, -570.3102749169184, -53.64639503937697]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6334704646660145, "mean_inference_ms": 1.7402682145393715, "mean_action_processing_ms": 0.8991751146535387, "mean_env_wait_ms": 10.944916396497952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015384912490844727, "StateBufferConnector_ms": 0.011243104934692383, "ViewRequirementAgentConnector_ms": 0.4177663326263428}, "num_episodes": 40, "episode_return_max": -858.9348164112799, "episode_return_min": -4870.645841895779, "episode_return_mean": -2993.898317965548, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 441959, "num_agent_steps_trained": 441959, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 92.04578513583017, "num_env_steps_trained_throughput_per_sec": 92.04578513583017, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 441959, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 441959, "timers": {"training_iteration_time_ms": 52169.128, "restore_workers_time_ms": 0.029, "training_step_time_ms": 52169.054, "sample_time_ms": 3413.393, "learn_time_ms": 48697.564, "learn_throughput": 82.14, "synch_weights_time_ms": 54.866}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 441959, "num_agent_steps_trained": 441959}, "done": false, "training_iteration": 24, "trial_id": "05c72_00000", "date": "2024-07-26_15-04-08", "timestamp": 1721986448, "time_this_iter_s": 43.46957993507385, "time_total_s": 1269.1348168849945, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d28052a0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1269.1348168849945, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 11.829032258064519, "ram_util_percent": 33.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 150.0306591730048, "cur_kl_coeff": 0.33750000000000013, "cur_lr": 0.0010000000000000005, "total_loss": 5.352311693838913, "policy_loss": -0.002375866972145663, "vf_loss": 5.366978632330604, "vf_explained_var": 0.978777135984741, "kl": 0.01569895197483292, "entropy": 1.7589467184677032, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.92700729927007, "num_grad_updates_lifetime": 106095.5, "diff_num_grad_updates_vs_sampler_policy": 2054.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 459485, "num_agent_steps_trained": 459485}, "env_runners": {"episode_reward_max": -858.9348164112799, "episode_reward_min": -4688.84542183037, "episode_reward_mean": -2993.5403880974586, "episode_len_mean": 149.55, "episode_media": {}, "episodes_timesteps_total": 14955, "policy_reward_min": {"policy_0": -1481.6683862021382}, "policy_reward_max": {"policy_0": -8.133416773804583}, "policy_reward_mean": {"policy_0": -598.7080776194919}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3424.1950659380914, -1835.081198083882, -3292.57667368503, -2929.9759446467315, -3537.747229076969, -3403.5384396898785, -3216.6413609565275, -3070.1652277528497, -3137.7239619277398, -3552.1725475015783, -3385.6102982754387, -3220.338040838953, -3032.7148397041665, -2228.0164080437144, -3246.0858860907833, -3972.767006013691, -3544.5980683637554, -3107.3728093186824, -3518.46068490387, -3326.3243224816506, -4688.84542183037, -2175.4832501449314, -2656.2110456638115, -3457.7661837964897, -4099.080661304783, -4323.325665876726, -2006.1299458949857, -4414.122594256008, -3010.430450220639, -3924.976874971743, -2867.5037615929173, -2527.134672158115, -3386.5389695679223, -2807.325507347, -4252.686413717537, -2358.2544635462277, -3205.6766037282273, -3969.2083024304065, -4133.3622806335325, -3274.029122737506, -4330.9375483953945, -3564.084605234907, -2078.390138201243, -2668.0871096454543, -3971.455753009473, -2375.3693385919687, -3658.8677424992247, -2616.0858717933424, -2488.9195960964344, -2411.3601188035177, -2097.6889397058962, -3472.633654613808, -2091.41480005758, -3673.315545383224, -2663.5977585119026, -3928.7759025505466, -3334.4543911159544, -2963.9176940678217, -3452.503040792409, -3590.7505573285976, -1851.7194335291877, -3353.6103952908556, -3148.178860107354, -2552.087305166084, -2867.585843212401, -2618.2007911071632, -2538.2864128133574, -2066.4747300961462, -858.9348164112799, -3195.3534510685813, -2236.197828883752, -2506.539903406562, -2344.909137112199, -3426.89623977759, -1638.857710783976, -3461.1518089572983, -2089.4554671985316, -2528.9727951411987, -2794.2663237608867, -2760.0381252410275, -2271.7521738823016, -3667.5549134391736, -2023.6903336788537, -2263.194754824902, -3069.5081924590595, -2999.5067471030447, -3660.181373654206, -2159.2413628362588, -2366.4525664447087, -2280.7277154996436, -2611.207022612062, -2966.1671826282986, -2021.9647354805977, -2645.829497785504, -3359.594801995653, -2250.0134573515197, -2194.210292699368, -4175.665816888596, -3322.8259051927175, -3254.2242731114434], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-924.3675497781006, -1305.2034625435692, -101.63754476813196, -269.7081750043599, -823.2783338439277, -905.7087514790504, -148.83743955486236, -415.9820973636468, -57.451130951492104, -307.10177873482996, -660.9007347869614, -859.1601180491448, -724.7510624361527, -84.18785990728121, -963.5768985054929, -626.7840490423519, -144.01280138784728, -847.3607566296465, -950.6369737884423, -361.1813637984445, -1202.7616901875515, -670.1973515714478, -556.0523647586442, -570.785711536202, -537.9501110231174, -901.407266919987, -389.54321986100314, -612.6044341788324, -939.7244149015412, -560.2591038285138, -1328.5595617637578, -271.0337537248601, -649.3402027943916, -209.85270237496806, -757.8551402985494, -114.7889825008157, -708.5002273719424, -594.195041882967, -663.3919254447935, -989.2890505523332, -783.4676490096559, -66.05397604409808, -430.47488079699167, -700.6228188257254, -1157.1046372512694, -96.00317976522062, -1231.6883682566556, -655.9714782487641, -950.1054304503714, -618.4040907805636, -323.7465208775469, -1018.4403230522976, -1101.3475743545212, -920.948308214596, -21.12757177647754, -205.51544341534515, -1079.5204862228427, -315.7916441442034, -886.5944019857353, -732.9160650708268, -706.8449452870651, -344.32110420698456, -144.867047200377, -756.4542205873272, -1080.2275224224104, -696.6363474020166, -557.6527067164674, -158.8447837944682, -119.60675075495699, -695.2758193758027, -1159.9345886138638, -1127.0544872346802, -109.55376665870173, -22.75240425946919, -826.7906393240686, -709.9004673889592, -1352.7450744877465, -107.90875567055589, -1097.0526069424095, -705.1601015240238, -75.18859543062088, -680.5350860031438, -964.3395298699967, -1204.9048938073684, -619.6299632526265, -667.6879835785268, -585.9045099044376, -406.2283824804986, -860.082467972796, -587.4694653824246, -793.8680247202649, -60.33598823700846, -1070.2185714365019, -604.2743160147056, -989.7637844953937, -222.84685544939822, -847.9593293552098, -464.2615096751194, -580.4899943248606, -1210.7666336770594, -814.3328774358458, -1032.85297893261, -937.1143562473736, -1040.730070893868, -863.815138320668, -726.2009109613088, -26.756564360847115, -626.3556650406365, -602.617176616985, -193.55293316515497, -624.9248969825027, -12.283287242534424, -1029.7870632169129, -83.54711389732074, -905.6686843245432, -1148.9932641743437, -695.0532943870464, -643.6721334000184, -569.5980279077836, -400.44946392729605, -892.6095835267992, -761.5117789723937, -467.1748963427096, -592.8304942596609, -1384.9539082032156, -1296.3647633355276, -274.7493853674387, -1430.1774670405102, -694.1158130688461, -627.9182370644029, -47.60080899595615, -1219.555401267534, -200.16299600386327, -66.67098702978376, -472.1397525978491, -1263.0338970559346, -260.60202231680097, -477.78454868376184, -1327.4918257415854, -1085.210300457927, -259.12476723179367, -716.7542904587568, -600.2828143302733, -815.4916545561715, -618.7769236436432, -582.2805921463038, -122.63621731314136, -1179.3552717846255, -1002.9185487214613, -1037.7862450062098, -1135.4555488934177, -869.716129017422, -169.43181525317854, -75.75665050531026, -617.1436179235889, -238.82702595260903, -233.16072027724775, -200.34656506711147, -792.4996103644255, -1062.3007504967234, -565.930376322105, -686.2425136005694, -959.2841560553837, -1157.324238503403, -17.757685086459546, -385.4318844961543, -865.4472882295448, -712.6323896492261, -108.79817837993116, -735.0157665921419, -1132.9981498524855, -811.266555269693, -997.4663987021403, -770.6509900951177, -540.304319798099, -262.8059165188093, -1271.985515688452, -109.50311467882361, -267.4819977112764, -446.47791894886745, -644.8557719687208, -751.0482320553702, -357.9063809744562, -100.29680623275016, -1351.5694124969316, -686.6949915473583, -631.7382158868737, -589.5506698837061, -801.413931191201, -1259.8104939212665, -699.4648474013989, -1295.1678529308467, -618.1535099769757, -718.6002433289293, -801.975826995384, -326.1841779105452, -1083.289343133891, -480.0277046073795, -523.7226587910139, -860.8052382946782, -585.678320372183, -1207.7493182458215, -836.451569996819, -561.2458320234035, -1139.8125077571685, -805.9985138805653, -738.414922109695, -310.35978174259947, -1075.63265351553, -633.6787339865137, -379.75199635917215, -280.8902376160592, -199.42947222274012, -379.6399199605872, -838.6785120426836, -287.52509938491625, -554.8522232964964, -197.24256664127356, -1004.6682333829356, -623.7989869398331, -788.200555803362, -465.3135225080394, -1056.4438538228333, -814.8476939681805, -846.6501269070585, -271.6865417629894, -934.4780994843918, -22.125226399389664, -738.697633552707, -408.38183739249087, -999.700069372932, -72.13453195993984, -243.18355158474287, -1274.8488458344827, -1069.0007437471272, -823.517148520151, -430.57963084803515, -680.5236030324762, -656.2983480972536, -25.167141295426752, -276.30340928016153, -302.2697939643681, -792.5715165405384, -861.5498856053955, -256.2249907059694, -918.4814389236051, -329.9062669784185, -60.907908823027086, -172.5653394218329, -929.4991646566332, -860.6795835965348, -95.16655415661423, -388.351087265627, -520.1707909510056, -233.32092373611468, -305.283820678283, -873.1943716283408, -1091.315291520639, -581.0314057563722, -621.8087650301738, -436.9036369530657, -12.306061103665284, -1015.8403933486491, -218.8667211228632, -407.4979875293376, -872.0093801079383, -1222.0117958035398, -453.6796143989782, -989.3308570528533, -136.28389801991003, -806.2412070184012, -1011.1886592507533, -333.022422483749, -112.02941491280691, -401.1160548461935, -819.6428573952119, -522.7667518735406, -689.3406429254716, -654.1571586579507, -1242.86849169837, -1131.8444858329408, -804.7952621170625, -359.2772046614897, -376.13826464300746, -662.3991738614551, -1125.2119430405187, -182.74450933806528, -1236.539222784087, -247.12280988570254, -172.29920901944791, -1037.5633294679938, -189.22145234218655, -528.8397798180143, -506.749776305365, -1190.128702858854, -482.46277916049917, -769.5253835392366, -854.3402777098034, -675.1681552496378, -809.25396166942, -219.71486443797073, -200.91568114343545, -505.4084096009173, -253.93836825302662, -671.7421100938379, -1259.7479616104463, -568.5534219900851, -207.1852403497799, -696.4794164712573, -621.6443548692907, -882.3740742124421, -83.53187066249197, -460.7012776287336, -1176.4841071827818, -545.0875304209048, -257.5746583425633, -301.29878215113075, -1249.9269045722097, -496.33083469410917, -246.95612540607425, -162.38874974668735, -936.2909454864943, -540.7567814357448, -628.042563082458, -600.1068034610145, -1004.7705231165497, -402.7921271363407, -340.529373990747, -762.5688812845208, -107.53988557900531, -390.60076365959975, -821.2237879905658, -687.0877308333661, -103.89743068774972, -535.4766996420773, -232.97335552390487, -540.6893950616058, -334.7622927199125, -749.4469662342642, -208.60272055645868, -149.04659921649323, -406.5771301975975, -92.84775252427924, -181.45716885821125, -29.006165614698112, -797.014192543669, -78.125921940983, -558.5247381865811, -1066.794270771122, -694.8943276262261, -214.89009608127844, -436.16178840475317, -392.90889370162927, -941.2501587282852, -250.98689196780668, -124.81906124905426, -212.11348784720067, -927.0594809859073, -872.8396133741899, -369.70825995020584, -82.96035206811385, -801.2355040631815, -477.22409969985716, -552.8199369357504, -430.66924434529665, -874.4716748201112, -1011.6235275210888, -309.30594557177693, -1201.9640450507084, -29.531046813907608, -248.39916991130232, -116.08953348847758, -64.33277226510307, -460.7835586054002, -749.2526765136924, -1155.4141862958384, -594.896277081942, -844.3442746513565, -68.24551081921582, -798.2515601089457, -67.0676783878366, -146.4147467407474, -722.7534026687038, -1072.45356858075, -80.76607082049445, -351.9167552426647, -558.2874661204188, -494.00320679493865, -332.33714969600885, -792.4282172871683, -167.74764824335927, -890.406870857518, -983.5029220506211, -442.69758417416966, -309.911298435219, -1045.8107232017207, -995.0051113316792, -95.26562075133295, -570.3102749169184, -53.64639503937697, -8.133416773804583, -658.7565518207256, -615.3459147513922, -530.3289023228359, -459.1873882135425, -195.35831016031958, -1120.4080459825507, -940.4265195697049, -941.6129476521352, -469.7490900744629, -182.2561497974969, -464.27283522510174, -790.7640717141662, -574.7624895223111, -11.634787419777306, -363.06677803939294, -672.3285619306413, -451.63184798834, -745.6051921324832, -30.562374734045513, -414.03676735590136, -894.4728688569331, -932.5890251790148, -662.622384820012, -165.78714624719944, -968.8349553078874, -313.902987484193, -1054.4033869974235, -195.65192168677265, -466.71349562676767, -805.3927232809729, -747.963975049448, -492.1805969654669, -631.5365972045342, -983.1074811537812, -360.78126767796573, -595.0134632345778, -465.1382199417678, -498.49787019215233, -239.81054178979645, -711.5308458941453, -107.96811234732206, -754.7986951316906, -74.80115461593765, -717.3537584556125, -544.1450470153242, -28.32734268220407, -315.63317471537647, -25.849027550698587, -1366.7731235360413, -1198.1065980673811, -127.72397553719294, -526.1428526483144, -275.7336022421274, -483.49999411704715, -84.1482833697423, -774.480944042707, -1481.6683862021382, -377.9770316073825, -247.89253740632796, -431.41394539158733, -628.8785861256351, -569.4610916245832, -105.59429228917479, -286.61682004961676, -106.32350652936786, -766.7823327626943, -214.90464898454536, -566.7414738669919, -991.0775356419039, -98.06336734436057, -1227.8294054502717, -517.0517792351244, -677.5391532215432, -839.111096744356, -412.5116765221622, -832.8454128492039, -100.12794050784812, -428.6212116288466, -475.9072158434587, -538.7514874990512, -927.5160707560398, -11.511333361845994, -683.5158952002006, -32.915505882230434, -851.2393001331318, -744.9058601871991, -984.7659080257672, -834.4016331520904, -760.3531153904056, -950.5718348659647, -478.5503112942512, -827.9955453269533, -845.0018250950465, -220.70638861050327, -617.7577835042346, -261.1981962230007, -1412.4965090516273, -477.7005342952115, -485.0712500373714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6308005063407194, "mean_inference_ms": 1.7361045186322637, "mean_action_processing_ms": 0.8931058547477285, "mean_env_wait_ms": 10.909862662549742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015233516693115234, "StateBufferConnector_ms": 0.011481523513793945, "ViewRequirementAgentConnector_ms": 0.42925477027893066}, "num_episodes": 20, "episode_return_max": -858.9348164112799, "episode_return_min": -4688.84542183037, "episode_return_mean": -2993.5403880974586, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 459485, "num_agent_steps_trained": 459485, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.13677428176666, "num_env_steps_trained_throughput_per_sec": 74.13677428176666, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 459485, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 459485, "timers": {"training_iteration_time_ms": 52172.811, "restore_workers_time_ms": 0.029, "training_step_time_ms": 52172.736, "sample_time_ms": 3418.892, "learn_time_ms": 48698.496, "learn_throughput": 82.138, "synch_weights_time_ms": 52.104}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 459485, "num_agent_steps_trained": 459485}, "done": false, "training_iteration": 25, "trial_id": "05c72_00000", "date": "2024-07-26_15-05-02", "timestamp": 1721986502, "time_this_iter_s": 53.96571183204651, "time_total_s": 1323.100528717041, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d28052ab90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1323.100528717041, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 11.160526315789472, "ram_util_percent": 32.95131578947369}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 187.69111018987093, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000007, "total_loss": 5.060597526796774, "policy_loss": -0.002552529372688797, "vf_loss": 5.077630867704677, "vf_explained_var": 0.9829709442197413, "kl": 0.01577724872363455, "entropy": 1.9805629417516184, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.29710144927536, "num_grad_updates_lifetime": 110220.5, "diff_num_grad_updates_vs_sampler_policy": 2069.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 477052, "num_agent_steps_trained": 477052}, "env_runners": {"episode_reward_max": -858.9348164112799, "episode_reward_min": -4688.84542183037, "episode_reward_mean": -2962.4515939202847, "episode_len_mean": 149.55, "episode_media": {}, "episodes_timesteps_total": 14955, "policy_reward_min": {"policy_0": -1481.6683862021382}, "policy_reward_max": {"policy_0": -8.133416773804583}, "policy_reward_mean": {"policy_0": -592.490318784057}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4688.84542183037, -2175.4832501449314, -2656.2110456638115, -3457.7661837964897, -4099.080661304783, -4323.325665876726, -2006.1299458949857, -4414.122594256008, -3010.430450220639, -3924.976874971743, -2867.5037615929173, -2527.134672158115, -3386.5389695679223, -2807.325507347, -4252.686413717537, -2358.2544635462277, -3205.6766037282273, -3969.2083024304065, -4133.3622806335325, -3274.029122737506, -4330.9375483953945, -3564.084605234907, -2078.390138201243, -2668.0871096454543, -3971.455753009473, -2375.3693385919687, -3658.8677424992247, -2616.0858717933424, -2488.9195960964344, -2411.3601188035177, -2097.6889397058962, -3472.633654613808, -2091.41480005758, -3673.315545383224, -2663.5977585119026, -3928.7759025505466, -3334.4543911159544, -2963.9176940678217, -3452.503040792409, -3590.7505573285976, -1851.7194335291877, -3353.6103952908556, -3148.178860107354, -2552.087305166084, -2867.585843212401, -2618.2007911071632, -2538.2864128133574, -2066.4747300961462, -858.9348164112799, -3195.3534510685813, -2236.197828883752, -2506.539903406562, -2344.909137112199, -3426.89623977759, -1638.857710783976, -3461.1518089572983, -2089.4554671985316, -2528.9727951411987, -2794.2663237608867, -2760.0381252410275, -2271.7521738823016, -3667.5549134391736, -2023.6903336788537, -2263.194754824902, -3069.5081924590595, -2999.5067471030447, -3660.181373654206, -2159.2413628362588, -2366.4525664447087, -2280.7277154996436, -2611.207022612062, -2966.1671826282986, -2021.9647354805977, -2645.829497785504, -3359.594801995653, -2250.0134573515197, -2194.210292699368, -4175.665816888596, -3322.8259051927175, -3254.2242731114434, -2445.48333645876, -2221.2354588542157, -3746.378242308622, -3345.8107100587254, -3113.1531775404173, -2269.029662330639, -4403.830328523667, -3341.4330156752303, -2859.718727331709, -2768.3855268264297, -3706.446371533562, -2300.780189688461, -3878.3480656345323, -3429.520815392635, -2930.7243760345195, -3366.137333898884, -2216.024458025519, -2530.5834215261357, -3087.472423826144, -2912.7309541077398], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-814.3328774358458, -1032.85297893261, -937.1143562473736, -1040.730070893868, -863.815138320668, -726.2009109613088, -26.756564360847115, -626.3556650406365, -602.617176616985, -193.55293316515497, -624.9248969825027, -12.283287242534424, -1029.7870632169129, -83.54711389732074, -905.6686843245432, -1148.9932641743437, -695.0532943870464, -643.6721334000184, -569.5980279077836, -400.44946392729605, -892.6095835267992, -761.5117789723937, -467.1748963427096, -592.8304942596609, -1384.9539082032156, -1296.3647633355276, -274.7493853674387, -1430.1774670405102, -694.1158130688461, -627.9182370644029, -47.60080899595615, -1219.555401267534, -200.16299600386327, -66.67098702978376, -472.1397525978491, -1263.0338970559346, -260.60202231680097, -477.78454868376184, -1327.4918257415854, -1085.210300457927, -259.12476723179367, -716.7542904587568, -600.2828143302733, -815.4916545561715, -618.7769236436432, -582.2805921463038, -122.63621731314136, -1179.3552717846255, -1002.9185487214613, -1037.7862450062098, -1135.4555488934177, -869.716129017422, -169.43181525317854, -75.75665050531026, -617.1436179235889, -238.82702595260903, -233.16072027724775, -200.34656506711147, -792.4996103644255, -1062.3007504967234, -565.930376322105, -686.2425136005694, -959.2841560553837, -1157.324238503403, -17.757685086459546, -385.4318844961543, -865.4472882295448, -712.6323896492261, -108.79817837993116, -735.0157665921419, -1132.9981498524855, -811.266555269693, -997.4663987021403, -770.6509900951177, -540.304319798099, -262.8059165188093, -1271.985515688452, -109.50311467882361, -267.4819977112764, -446.47791894886745, -644.8557719687208, -751.0482320553702, -357.9063809744562, -100.29680623275016, -1351.5694124969316, -686.6949915473583, -631.7382158868737, -589.5506698837061, -801.413931191201, -1259.8104939212665, -699.4648474013989, -1295.1678529308467, -618.1535099769757, -718.6002433289293, -801.975826995384, -326.1841779105452, -1083.289343133891, -480.0277046073795, -523.7226587910139, -860.8052382946782, -585.678320372183, -1207.7493182458215, -836.451569996819, -561.2458320234035, -1139.8125077571685, -805.9985138805653, -738.414922109695, -310.35978174259947, -1075.63265351553, -633.6787339865137, -379.75199635917215, -280.8902376160592, -199.42947222274012, -379.6399199605872, -838.6785120426836, -287.52509938491625, -554.8522232964964, -197.24256664127356, -1004.6682333829356, -623.7989869398331, -788.200555803362, -465.3135225080394, -1056.4438538228333, -814.8476939681805, -846.6501269070585, -271.6865417629894, -934.4780994843918, -22.125226399389664, -738.697633552707, -408.38183739249087, -999.700069372932, -72.13453195993984, -243.18355158474287, -1274.8488458344827, -1069.0007437471272, -823.517148520151, -430.57963084803515, -680.5236030324762, -656.2983480972536, -25.167141295426752, -276.30340928016153, -302.2697939643681, -792.5715165405384, -861.5498856053955, -256.2249907059694, -918.4814389236051, -329.9062669784185, -60.907908823027086, -172.5653394218329, -929.4991646566332, -860.6795835965348, -95.16655415661423, -388.351087265627, -520.1707909510056, -233.32092373611468, -305.283820678283, -873.1943716283408, -1091.315291520639, -581.0314057563722, -621.8087650301738, -436.9036369530657, -12.306061103665284, -1015.8403933486491, -218.8667211228632, -407.4979875293376, -872.0093801079383, -1222.0117958035398, -453.6796143989782, -989.3308570528533, -136.28389801991003, -806.2412070184012, -1011.1886592507533, -333.022422483749, -112.02941491280691, -401.1160548461935, -819.6428573952119, -522.7667518735406, -689.3406429254716, -654.1571586579507, -1242.86849169837, -1131.8444858329408, -804.7952621170625, -359.2772046614897, -376.13826464300746, -662.3991738614551, -1125.2119430405187, -182.74450933806528, -1236.539222784087, -247.12280988570254, -172.29920901944791, -1037.5633294679938, -189.22145234218655, -528.8397798180143, -506.749776305365, -1190.128702858854, -482.46277916049917, -769.5253835392366, -854.3402777098034, -675.1681552496378, -809.25396166942, -219.71486443797073, -200.91568114343545, -505.4084096009173, -253.93836825302662, -671.7421100938379, -1259.7479616104463, -568.5534219900851, -207.1852403497799, -696.4794164712573, -621.6443548692907, -882.3740742124421, -83.53187066249197, -460.7012776287336, -1176.4841071827818, -545.0875304209048, -257.5746583425633, -301.29878215113075, -1249.9269045722097, -496.33083469410917, -246.95612540607425, -162.38874974668735, -936.2909454864943, -540.7567814357448, -628.042563082458, -600.1068034610145, -1004.7705231165497, -402.7921271363407, -340.529373990747, -762.5688812845208, -107.53988557900531, -390.60076365959975, -821.2237879905658, -687.0877308333661, -103.89743068774972, -535.4766996420773, -232.97335552390487, -540.6893950616058, -334.7622927199125, -749.4469662342642, -208.60272055645868, -149.04659921649323, -406.5771301975975, -92.84775252427924, -181.45716885821125, -29.006165614698112, -797.014192543669, -78.125921940983, -558.5247381865811, -1066.794270771122, -694.8943276262261, -214.89009608127844, -436.16178840475317, -392.90889370162927, -941.2501587282852, -250.98689196780668, -124.81906124905426, -212.11348784720067, -927.0594809859073, -872.8396133741899, -369.70825995020584, -82.96035206811385, -801.2355040631815, -477.22409969985716, -552.8199369357504, -430.66924434529665, -874.4716748201112, -1011.6235275210888, -309.30594557177693, -1201.9640450507084, -29.531046813907608, -248.39916991130232, -116.08953348847758, -64.33277226510307, -460.7835586054002, -749.2526765136924, -1155.4141862958384, -594.896277081942, -844.3442746513565, -68.24551081921582, -798.2515601089457, -67.0676783878366, -146.4147467407474, -722.7534026687038, -1072.45356858075, -80.76607082049445, -351.9167552426647, -558.2874661204188, -494.00320679493865, -332.33714969600885, -792.4282172871683, -167.74764824335927, -890.406870857518, -983.5029220506211, -442.69758417416966, -309.911298435219, -1045.8107232017207, -995.0051113316792, -95.26562075133295, -570.3102749169184, -53.64639503937697, -8.133416773804583, -658.7565518207256, -615.3459147513922, -530.3289023228359, -459.1873882135425, -195.35831016031958, -1120.4080459825507, -940.4265195697049, -941.6129476521352, -469.7490900744629, -182.2561497974969, -464.27283522510174, -790.7640717141662, -574.7624895223111, -11.634787419777306, -363.06677803939294, -672.3285619306413, -451.63184798834, -745.6051921324832, -30.562374734045513, -414.03676735590136, -894.4728688569331, -932.5890251790148, -662.622384820012, -165.78714624719944, -968.8349553078874, -313.902987484193, -1054.4033869974235, -195.65192168677265, -466.71349562676767, -805.3927232809729, -747.963975049448, -492.1805969654669, -631.5365972045342, -983.1074811537812, -360.78126767796573, -595.0134632345778, -465.1382199417678, -498.49787019215233, -239.81054178979645, -711.5308458941453, -107.96811234732206, -754.7986951316906, -74.80115461593765, -717.3537584556125, -544.1450470153242, -28.32734268220407, -315.63317471537647, -25.849027550698587, -1366.7731235360413, -1198.1065980673811, -127.72397553719294, -526.1428526483144, -275.7336022421274, -483.49999411704715, -84.1482833697423, -774.480944042707, -1481.6683862021382, -377.9770316073825, -247.89253740632796, -431.41394539158733, -628.8785861256351, -569.4610916245832, -105.59429228917479, -286.61682004961676, -106.32350652936786, -766.7823327626943, -214.90464898454536, -566.7414738669919, -991.0775356419039, -98.06336734436057, -1227.8294054502717, -517.0517792351244, -677.5391532215432, -839.111096744356, -412.5116765221622, -832.8454128492039, -100.12794050784812, -428.6212116288466, -475.9072158434587, -538.7514874990512, -927.5160707560398, -11.511333361845994, -683.5158952002006, -32.915505882230434, -851.2393001331318, -744.9058601871991, -984.7659080257672, -834.4016331520904, -760.3531153904056, -950.5718348659647, -478.5503112942512, -827.9955453269533, -845.0018250950465, -220.70638861050327, -617.7577835042346, -261.1981962230007, -1412.4965090516273, -477.7005342952115, -485.0712500373714, -765.0314027112241, -361.0256655264542, -145.08395183810455, -556.3104521315029, -618.0318642514769, -503.95216747909967, -738.2281534236189, -680.123876769459, -158.5500716603883, -140.38118952165038, -846.1038222158342, -1058.177749515731, -725.6547523506398, -707.5841516871739, -408.8577665392407, -204.40515566663018, -776.0225388943775, -836.681396270396, -634.6445602645572, -894.0570589627619, -838.7102665160673, -698.3673559848771, -167.44038101396023, -725.414163008657, -683.2210110168568, -370.1660685691069, -128.97939885690823, -714.9166894285344, -333.29832791035346, -721.6691775657372, -947.8674295396511, -1085.8996340501346, -434.8637675529315, -751.961024092499, -1183.23847328845, -1045.3380100730092, -1091.148674906353, -63.25476353147725, -548.374479730483, -593.3170874339032, -532.9815416427608, -253.1834746991621, -848.6405117917631, -1172.1691357502025, -52.74406344781961, -611.096970039332, -29.44813337413323, -746.9139801758054, -604.9181553992231, -776.0082878379388, -1013.1410292250183, -758.1300199267171, -1164.088926407675, -155.29364259401726, -615.7927533801347, -68.54978974845926, -160.22338618709855, -938.6035838596233, -163.41916340989647, -969.9842664833824, -772.8188426072105, -977.147866817883, -1201.7299282342578, -828.405017856471, -98.24641011870781, -1374.2368130115433, -896.1634616456726, -522.0652932769462, -565.6990850124207, -71.35616244605288, -709.3485026894662, -658.5003423590265, -231.6129263996737, -691.3376596712912, -639.9249449150602, -95.19002114888909, -962.7474344414964, -688.3164716281879, -646.44464229517, -973.4387643851428, -757.5653975016462, -155.06673162348523, -381.31178834627576, -401.0134699075198, -521.0670706465895, -63.36987312495537, -792.8555255493876, -608.539865326022, -510.20323731583113, -555.6149202099397, -993.891847139183, -862.0554242912963, -54.324935852179784, -437.7771107355634, -739.4231058079266, -1472.7934243208897, -811.2649306624814, -111.61972529624435, -8.803187303957163, -508.2496865241677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.628340954339543, "mean_inference_ms": 1.734816936615359, "mean_action_processing_ms": 0.8905198252925168, "mean_env_wait_ms": 10.897704487495245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015266180038452148, "StateBufferConnector_ms": 0.01146554946899414, "ViewRequirementAgentConnector_ms": 0.42591261863708496}, "num_episodes": 20, "episode_return_max": -858.9348164112799, "episode_return_min": -4688.84542183037, "episode_return_mean": -2962.4515939202847, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 477052, "num_agent_steps_trained": 477052, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.72217368577017, "num_env_steps_trained_throughput_per_sec": 72.72217368577017, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 477052, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 477052, "timers": {"training_iteration_time_ms": 52085.342, "restore_workers_time_ms": 0.028, "training_step_time_ms": 52085.268, "sample_time_ms": 3417.992, "learn_time_ms": 48612.948, "learn_throughput": 82.283, "synch_weights_time_ms": 51.086}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 477052, "num_agent_steps_trained": 477052}, "done": false, "training_iteration": 26, "trial_id": "05c72_00000", "date": "2024-07-26_15-05-57", "timestamp": 1721986557, "time_this_iter_s": 55.0150203704834, "time_total_s": 1378.1155490875244, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805a9b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1378.1155490875244, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 11.916666666666668, "ram_util_percent": 33.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 188.56155822572254, "cur_kl_coeff": 0.3375, "cur_lr": 0.0010000000000000005, "total_loss": 4.696262236152377, "policy_loss": -0.000344935086461538, "vf_loss": 4.711132862624668, "vf_explained_var": 0.9813799719157673, "kl": 0.01748404905837517, "entropy": 2.0426562710035414, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.85, "num_grad_updates_lifetime": 114390.5, "diff_num_grad_updates_vs_sampler_policy": 2099.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 494951, "num_agent_steps_trained": 494951}, "env_runners": {"episode_reward_max": -858.9348164112799, "episode_reward_min": -4534.5412728798365, "episode_reward_mean": -2934.0881096873914, "episode_len_mean": 149.55, "episode_media": {}, "episodes_timesteps_total": 14955, "policy_reward_min": {"policy_0": -1481.6683862021382}, "policy_reward_max": {"policy_0": -8.133416773804583}, "policy_reward_mean": {"policy_0": -586.8176219374783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1851.7194335291877, -3353.6103952908556, -3148.178860107354, -2552.087305166084, -2867.585843212401, -2618.2007911071632, -2538.2864128133574, -2066.4747300961462, -858.9348164112799, -3195.3534510685813, -2236.197828883752, -2506.539903406562, -2344.909137112199, -3426.89623977759, -1638.857710783976, -3461.1518089572983, -2089.4554671985316, -2528.9727951411987, -2794.2663237608867, -2760.0381252410275, -2271.7521738823016, -3667.5549134391736, -2023.6903336788537, -2263.194754824902, -3069.5081924590595, -2999.5067471030447, -3660.181373654206, -2159.2413628362588, -2366.4525664447087, -2280.7277154996436, -2611.207022612062, -2966.1671826282986, -2021.9647354805977, -2645.829497785504, -3359.594801995653, -2250.0134573515197, -2194.210292699368, -4175.665816888596, -3322.8259051927175, -3254.2242731114434, -2445.48333645876, -2221.2354588542157, -3746.378242308622, -3345.8107100587254, -3113.1531775404173, -2269.029662330639, -4403.830328523667, -3341.4330156752303, -2859.718727331709, -2768.3855268264297, -3706.446371533562, -2300.780189688461, -3878.3480656345323, -3429.520815392635, -2930.7243760345195, -3366.137333898884, -2216.024458025519, -2530.5834215261357, -3087.472423826144, -2912.7309541077398, -3726.4652512169946, -1485.8275543218192, -4302.9344292049645, -3946.2270843783417, -3568.6021536093463, -2213.9799178020826, -2610.3291741987036, -2379.413569940197, -2590.3326250184045, -3598.083795026076, -2993.274041869739, -3708.0348913813696, -4146.411494229789, -3655.646028586248, -3506.7850479044278, -3196.7257296839816, -4261.850851672587, -4008.513110403041, -4308.22028207999, -2931.5194057803383, -3384.505830755083, -3459.0524557902004, -2779.5368375716102, -4182.462737519706, -3148.17139260412, -2966.2961416917196, -3152.239723921896, -2593.7730766691357, -3602.241224797365, -4534.5412728798365, -2753.2910274537994, -2458.577605130292, -1392.3918450463145, -1495.4549236707894, -2018.8456104137333, -3854.3365164659517, -2895.5445165914753, -2287.3555613616495, -2763.5304384905653, -3273.028697395557], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-219.71486443797073, -200.91568114343545, -505.4084096009173, -253.93836825302662, -671.7421100938379, -1259.7479616104463, -568.5534219900851, -207.1852403497799, -696.4794164712573, -621.6443548692907, -882.3740742124421, -83.53187066249197, -460.7012776287336, -1176.4841071827818, -545.0875304209048, -257.5746583425633, -301.29878215113075, -1249.9269045722097, -496.33083469410917, -246.95612540607425, -162.38874974668735, -936.2909454864943, -540.7567814357448, -628.042563082458, -600.1068034610145, -1004.7705231165497, -402.7921271363407, -340.529373990747, -762.5688812845208, -107.53988557900531, -390.60076365959975, -821.2237879905658, -687.0877308333661, -103.89743068774972, -535.4766996420773, -232.97335552390487, -540.6893950616058, -334.7622927199125, -749.4469662342642, -208.60272055645868, -149.04659921649323, -406.5771301975975, -92.84775252427924, -181.45716885821125, -29.006165614698112, -797.014192543669, -78.125921940983, -558.5247381865811, -1066.794270771122, -694.8943276262261, -214.89009608127844, -436.16178840475317, -392.90889370162927, -941.2501587282852, -250.98689196780668, -124.81906124905426, -212.11348784720067, -927.0594809859073, -872.8396133741899, -369.70825995020584, -82.96035206811385, -801.2355040631815, -477.22409969985716, -552.8199369357504, -430.66924434529665, -874.4716748201112, -1011.6235275210888, -309.30594557177693, -1201.9640450507084, -29.531046813907608, -248.39916991130232, -116.08953348847758, -64.33277226510307, -460.7835586054002, -749.2526765136924, -1155.4141862958384, -594.896277081942, -844.3442746513565, -68.24551081921582, -798.2515601089457, -67.0676783878366, -146.4147467407474, -722.7534026687038, -1072.45356858075, -80.76607082049445, -351.9167552426647, -558.2874661204188, -494.00320679493865, -332.33714969600885, -792.4282172871683, -167.74764824335927, -890.406870857518, -983.5029220506211, -442.69758417416966, -309.911298435219, -1045.8107232017207, -995.0051113316792, -95.26562075133295, -570.3102749169184, -53.64639503937697, -8.133416773804583, -658.7565518207256, -615.3459147513922, -530.3289023228359, -459.1873882135425, -195.35831016031958, -1120.4080459825507, -940.4265195697049, -941.6129476521352, -469.7490900744629, -182.2561497974969, -464.27283522510174, -790.7640717141662, -574.7624895223111, -11.634787419777306, -363.06677803939294, -672.3285619306413, -451.63184798834, -745.6051921324832, -30.562374734045513, -414.03676735590136, -894.4728688569331, -932.5890251790148, -662.622384820012, -165.78714624719944, -968.8349553078874, -313.902987484193, -1054.4033869974235, -195.65192168677265, -466.71349562676767, -805.3927232809729, -747.963975049448, -492.1805969654669, -631.5365972045342, -983.1074811537812, -360.78126767796573, -595.0134632345778, -465.1382199417678, -498.49787019215233, -239.81054178979645, -711.5308458941453, -107.96811234732206, -754.7986951316906, -74.80115461593765, -717.3537584556125, -544.1450470153242, -28.32734268220407, -315.63317471537647, -25.849027550698587, -1366.7731235360413, -1198.1065980673811, -127.72397553719294, -526.1428526483144, -275.7336022421274, -483.49999411704715, -84.1482833697423, -774.480944042707, -1481.6683862021382, -377.9770316073825, -247.89253740632796, -431.41394539158733, -628.8785861256351, -569.4610916245832, -105.59429228917479, -286.61682004961676, -106.32350652936786, -766.7823327626943, -214.90464898454536, -566.7414738669919, -991.0775356419039, -98.06336734436057, -1227.8294054502717, -517.0517792351244, -677.5391532215432, -839.111096744356, -412.5116765221622, -832.8454128492039, -100.12794050784812, -428.6212116288466, -475.9072158434587, -538.7514874990512, -927.5160707560398, -11.511333361845994, -683.5158952002006, -32.915505882230434, -851.2393001331318, -744.9058601871991, -984.7659080257672, -834.4016331520904, -760.3531153904056, -950.5718348659647, -478.5503112942512, -827.9955453269533, -845.0018250950465, -220.70638861050327, -617.7577835042346, -261.1981962230007, -1412.4965090516273, -477.7005342952115, -485.0712500373714, -765.0314027112241, -361.0256655264542, -145.08395183810455, -556.3104521315029, -618.0318642514769, -503.95216747909967, -738.2281534236189, -680.123876769459, -158.5500716603883, -140.38118952165038, -846.1038222158342, -1058.177749515731, -725.6547523506398, -707.5841516871739, -408.8577665392407, -204.40515566663018, -776.0225388943775, -836.681396270396, -634.6445602645572, -894.0570589627619, -838.7102665160673, -698.3673559848771, -167.44038101396023, -725.414163008657, -683.2210110168568, -370.1660685691069, -128.97939885690823, -714.9166894285344, -333.29832791035346, -721.6691775657372, -947.8674295396511, -1085.8996340501346, -434.8637675529315, -751.961024092499, -1183.23847328845, -1045.3380100730092, -1091.148674906353, -63.25476353147725, -548.374479730483, -593.3170874339032, -532.9815416427608, -253.1834746991621, -848.6405117917631, -1172.1691357502025, -52.74406344781961, -611.096970039332, -29.44813337413323, -746.9139801758054, -604.9181553992231, -776.0082878379388, -1013.1410292250183, -758.1300199267171, -1164.088926407675, -155.29364259401726, -615.7927533801347, -68.54978974845926, -160.22338618709855, -938.6035838596233, -163.41916340989647, -969.9842664833824, -772.8188426072105, -977.147866817883, -1201.7299282342578, -828.405017856471, -98.24641011870781, -1374.2368130115433, -896.1634616456726, -522.0652932769462, -565.6990850124207, -71.35616244605288, -709.3485026894662, -658.5003423590265, -231.6129263996737, -691.3376596712912, -639.9249449150602, -95.19002114888909, -962.7474344414964, -688.3164716281879, -646.44464229517, -973.4387643851428, -757.5653975016462, -155.06673162348523, -381.31178834627576, -401.0134699075198, -521.0670706465895, -63.36987312495537, -792.8555255493876, -608.539865326022, -510.20323731583113, -555.6149202099397, -993.891847139183, -862.0554242912963, -54.324935852179784, -437.7771107355634, -739.4231058079266, -1472.7934243208897, -811.2649306624814, -111.61972529624435, -8.803187303957163, -508.2496865241677, -447.6973182307395, -882.3204816552062, -802.1507740884052, -306.5376888616836, -1287.758988380954, -26.48672013190254, -111.19384338411895, -229.70915792469702, -542.8892802359248, -575.5485526451749, -155.8896896498598, -457.0371187129927, -1181.6147773353096, -1296.3064330372815, -1212.0864104695231, -999.7109522662954, -1280.0486034522473, -606.7494905899746, -675.5086180050923, -384.20942006473075, -48.90909575516769, -601.8275618013682, -1270.8669818445194, -552.2800983235481, -1094.7184158847433, -614.0548069491152, -432.7860390318151, -425.5933605982949, -118.49164674640711, -623.0540644764505, -234.7477972897433, -522.9818841803971, -713.7907910742681, -866.4432925920499, -272.3654090622453, -916.0678470788665, -134.4611397416667, -92.73089592043644, -767.2503405015954, -468.9033466976287, -635.4960045584306, -797.9294151518891, -278.728498222233, -824.4946180706, -53.684089015248645, -163.25571997988138, -1121.0526438342786, -224.25267909743005, -996.5249633858787, -1092.9977887286068, -270.3595183911426, -572.4153078132999, -58.99342959888031, -1030.520263001825, -1060.985523064595, -682.2119137288001, -1055.2873411934825, -1258.6333412901795, -114.98045353313867, -596.9218416357742, -736.8979915064019, -653.2807573423478, -1419.2921138063525, -714.5228257360054, -622.4178058386816, -798.6264353545187, -435.90309105872467, -367.7476014895888, -859.6708612655168, -1193.6980394178986, -1135.3162025372706, -902.6525773205285, -1109.9553512520165, -104.01884335821848, -254.84207343639443, -730.6606569017536, -472.0907269646847, -510.27226541262064, -844.4350950244918, -639.2669853804282, -876.5755904397389, -1138.1292662317044, -572.3226131426368, -921.783650293737, -753.0397315647685, -417.58398419814546, -803.330473158436, -690.0712225959162, -1336.1377208658332, -761.3897095847117, -583.1671741076524, -823.9897520954576, -759.9907436608025, -1218.2272735448307, -922.8453386712445, -145.15921796549608, -810.9362572024453, -117.1765655476854, -1217.826780639302, -640.4205844254107, -801.9297252671358, -754.7071540168273, -534.617489455681, -1110.5195496441593, -182.7319123712814, -1076.9465924651931, -805.470689621921, -808.7847429011586, -295.8869715831097, -471.96345921881755, -911.9121442269254, -77.14197563672072, -260.0792658694199, -1257.9184402144222, -272.48501162412515, -634.4269583692387, -1220.5220967311704, -895.8216278983023, -856.0508823157559, -575.6411722052453, -590.7870002771847, -785.5627875044319, -915.8381041186124, -65.94601113495833, -790.037489568932, -42.055869708105455, -829.4647355017568, -508.75087731199625, -569.586718408397, -1016.4379407614668, -430.8745371365407, -434.233752109206, -817.0670450938117, -795.2628852663597, -674.8015043159771, -671.5172999444927, -380.4759724168349, -157.77205773712066, -1209.2327979357874, -174.77494863489667, -564.2960042103796, -386.0717174757543, -1321.5761946909395, -987.4891209170519, -342.8081875032378, -420.25360397554863, -1267.6330116972317, -1298.395488431069, -608.4923472927245, -939.7668214832634, -730.6012377460397, -256.62694977122595, -554.1415002478166, -862.5987810815939, -349.3225586071238, -1165.0840910591746, -612.747247620906, -254.38832710635904, -53.71923683923667, -372.6387025046156, -612.6725897249128, -35.186995695726424, -330.00398111205476, -355.866159891818, -58.66211862180306, -315.25018229574493, -57.28375079351155, -333.58138547769585, -716.1886915349096, -73.15091356892721, -303.3759747006694, -843.9830132640764, -480.2959564528749, -322.9049034962416, -68.2857624998694, -948.0887115483009, -874.2717814020991, -668.3483560191763, -795.6037974362946, -568.0238700600826, -1259.3103959570221, -144.60977647744627, -28.572303037400022, -703.2964360254598, -759.755605094145, -567.599700827707, -523.2068149552017, -190.7530327698146, -220.13589100713367, -785.660121801794, -241.914072800366, -1154.3786346194072, -556.0366791549048, -620.8913383436321, -190.30971357225366, -888.5424914895623, -1079.8656063877715, -479.33992107744973, -758.3746616467816, -66.90601679399127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.625388216006395, "mean_inference_ms": 1.7369400786622984, "mean_action_processing_ms": 0.889253564753748, "mean_env_wait_ms": 10.902147029164587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01494455337524414, "StateBufferConnector_ms": 0.011206388473510742, "ViewRequirementAgentConnector_ms": 0.41480541229248047}, "num_episodes": 40, "episode_return_max": -858.9348164112799, "episode_return_min": -4534.5412728798365, "episode_return_mean": -2934.0881096873914, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 494951, "num_agent_steps_trained": 494951, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.96077424522785, "num_env_steps_trained_throughput_per_sec": 72.96077424522785, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 494951, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 494951, "timers": {"training_iteration_time_ms": 52328.755, "restore_workers_time_ms": 0.028, "training_step_time_ms": 52328.682, "sample_time_ms": 3425.184, "learn_time_ms": 48850.052, "learn_throughput": 81.883, "synch_weights_time_ms": 50.248}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 494951, "num_agent_steps_trained": 494951}, "done": false, "training_iteration": 27, "trial_id": "05c72_00000", "date": "2024-07-26_15-06-52", "timestamp": 1721986612, "time_this_iter_s": 54.83635640144348, "time_total_s": 1432.951905488968, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e49d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1432.951905488968, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 10.997435897435897, "ram_util_percent": 32.97692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 165.25649833820484, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.097024620138568, "policy_loss": -0.0036733051725946378, "vf_loss": 5.115033469259003, "vf_explained_var": 0.9821377152719616, "kl": 0.015421483293125395, "entropy": 1.9540286090638903, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.9037037037037, "num_grad_updates_lifetime": 118515.5, "diff_num_grad_updates_vs_sampler_policy": 2024.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 512218, "num_agent_steps_trained": 512218}, "env_runners": {"episode_reward_max": -1161.5605924053953, "episode_reward_min": -4534.5412728798365, "episode_reward_mean": -3021.699633447277, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1481.6683862021382}, "policy_reward_max": {"policy_0": -8.133416773804583}, "policy_reward_mean": {"policy_0": -604.3399266894555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2271.7521738823016, -3667.5549134391736, -2023.6903336788537, -2263.194754824902, -3069.5081924590595, -2999.5067471030447, -3660.181373654206, -2159.2413628362588, -2366.4525664447087, -2280.7277154996436, -2611.207022612062, -2966.1671826282986, -2021.9647354805977, -2645.829497785504, -3359.594801995653, -2250.0134573515197, -2194.210292699368, -4175.665816888596, -3322.8259051927175, -3254.2242731114434, -2445.48333645876, -2221.2354588542157, -3746.378242308622, -3345.8107100587254, -3113.1531775404173, -2269.029662330639, -4403.830328523667, -3341.4330156752303, -2859.718727331709, -2768.3855268264297, -3706.446371533562, -2300.780189688461, -3878.3480656345323, -3429.520815392635, -2930.7243760345195, -3366.137333898884, -2216.024458025519, -2530.5834215261357, -3087.472423826144, -2912.7309541077398, -3726.4652512169946, -1485.8275543218192, -4302.9344292049645, -3946.2270843783417, -3568.6021536093463, -2213.9799178020826, -2610.3291741987036, -2379.413569940197, -2590.3326250184045, -3598.083795026076, -2993.274041869739, -3708.0348913813696, -4146.411494229789, -3655.646028586248, -3506.7850479044278, -3196.7257296839816, -4261.850851672587, -4008.513110403041, -4308.22028207999, -2931.5194057803383, -3384.505830755083, -3459.0524557902004, -2779.5368375716102, -4182.462737519706, -3148.17139260412, -2966.2961416917196, -3152.239723921896, -2593.7730766691357, -3602.241224797365, -4534.5412728798365, -2753.2910274537994, -2458.577605130292, -1392.3918450463145, -1495.4549236707894, -2018.8456104137333, -3854.3365164659517, -2895.5445165914753, -2287.3555613616495, -2763.5304384905653, -3273.028697395557, -2019.78258739404, -3298.840729615404, -1920.202992679502, -3631.8661736080803, -2590.138850637059, -3723.0707612923575, -2082.636482902567, -4511.415739382501, -2483.086585583951, -2955.4240006255377, -2719.601675774441, -3311.1836427066596, -3480.1666145245695, -3657.2756775409607, -3523.1304984185226, -2530.8479934818242, -2793.2356584619224, -1161.5605924053953, -3799.4423212615743, -3405.960176757187], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-8.133416773804583, -658.7565518207256, -615.3459147513922, -530.3289023228359, -459.1873882135425, -195.35831016031958, -1120.4080459825507, -940.4265195697049, -941.6129476521352, -469.7490900744629, -182.2561497974969, -464.27283522510174, -790.7640717141662, -574.7624895223111, -11.634787419777306, -363.06677803939294, -672.3285619306413, -451.63184798834, -745.6051921324832, -30.562374734045513, -414.03676735590136, -894.4728688569331, -932.5890251790148, -662.622384820012, -165.78714624719944, -968.8349553078874, -313.902987484193, -1054.4033869974235, -195.65192168677265, -466.71349562676767, -805.3927232809729, -747.963975049448, -492.1805969654669, -631.5365972045342, -983.1074811537812, -360.78126767796573, -595.0134632345778, -465.1382199417678, -498.49787019215233, -239.81054178979645, -711.5308458941453, -107.96811234732206, -754.7986951316906, -74.80115461593765, -717.3537584556125, -544.1450470153242, -28.32734268220407, -315.63317471537647, -25.849027550698587, -1366.7731235360413, -1198.1065980673811, -127.72397553719294, -526.1428526483144, -275.7336022421274, -483.49999411704715, -84.1482833697423, -774.480944042707, -1481.6683862021382, -377.9770316073825, -247.89253740632796, -431.41394539158733, -628.8785861256351, -569.4610916245832, -105.59429228917479, -286.61682004961676, -106.32350652936786, -766.7823327626943, -214.90464898454536, -566.7414738669919, -991.0775356419039, -98.06336734436057, -1227.8294054502717, -517.0517792351244, -677.5391532215432, -839.111096744356, -412.5116765221622, -832.8454128492039, -100.12794050784812, -428.6212116288466, -475.9072158434587, -538.7514874990512, -927.5160707560398, -11.511333361845994, -683.5158952002006, -32.915505882230434, -851.2393001331318, -744.9058601871991, -984.7659080257672, -834.4016331520904, -760.3531153904056, -950.5718348659647, -478.5503112942512, -827.9955453269533, -845.0018250950465, -220.70638861050327, -617.7577835042346, -261.1981962230007, -1412.4965090516273, -477.7005342952115, -485.0712500373714, -765.0314027112241, -361.0256655264542, -145.08395183810455, -556.3104521315029, -618.0318642514769, -503.95216747909967, -738.2281534236189, -680.123876769459, -158.5500716603883, -140.38118952165038, -846.1038222158342, -1058.177749515731, -725.6547523506398, -707.5841516871739, -408.8577665392407, -204.40515566663018, -776.0225388943775, -836.681396270396, -634.6445602645572, -894.0570589627619, -838.7102665160673, -698.3673559848771, -167.44038101396023, -725.414163008657, -683.2210110168568, -370.1660685691069, -128.97939885690823, -714.9166894285344, -333.29832791035346, -721.6691775657372, -947.8674295396511, -1085.8996340501346, -434.8637675529315, -751.961024092499, -1183.23847328845, -1045.3380100730092, -1091.148674906353, -63.25476353147725, -548.374479730483, -593.3170874339032, -532.9815416427608, -253.1834746991621, -848.6405117917631, -1172.1691357502025, -52.74406344781961, -611.096970039332, -29.44813337413323, -746.9139801758054, -604.9181553992231, -776.0082878379388, -1013.1410292250183, -758.1300199267171, -1164.088926407675, -155.29364259401726, -615.7927533801347, -68.54978974845926, -160.22338618709855, -938.6035838596233, -163.41916340989647, -969.9842664833824, -772.8188426072105, -977.147866817883, -1201.7299282342578, -828.405017856471, -98.24641011870781, -1374.2368130115433, -896.1634616456726, -522.0652932769462, -565.6990850124207, -71.35616244605288, -709.3485026894662, -658.5003423590265, -231.6129263996737, -691.3376596712912, -639.9249449150602, -95.19002114888909, -962.7474344414964, -688.3164716281879, -646.44464229517, -973.4387643851428, -757.5653975016462, -155.06673162348523, -381.31178834627576, -401.0134699075198, -521.0670706465895, -63.36987312495537, -792.8555255493876, -608.539865326022, -510.20323731583113, -555.6149202099397, -993.891847139183, -862.0554242912963, -54.324935852179784, -437.7771107355634, -739.4231058079266, -1472.7934243208897, -811.2649306624814, -111.61972529624435, -8.803187303957163, -508.2496865241677, -447.6973182307395, -882.3204816552062, -802.1507740884052, -306.5376888616836, -1287.758988380954, -26.48672013190254, -111.19384338411895, -229.70915792469702, -542.8892802359248, -575.5485526451749, -155.8896896498598, -457.0371187129927, -1181.6147773353096, -1296.3064330372815, -1212.0864104695231, -999.7109522662954, -1280.0486034522473, -606.7494905899746, -675.5086180050923, -384.20942006473075, -48.90909575516769, -601.8275618013682, -1270.8669818445194, -552.2800983235481, -1094.7184158847433, -614.0548069491152, -432.7860390318151, -425.5933605982949, -118.49164674640711, -623.0540644764505, -234.7477972897433, -522.9818841803971, -713.7907910742681, -866.4432925920499, -272.3654090622453, -916.0678470788665, -134.4611397416667, -92.73089592043644, -767.2503405015954, -468.9033466976287, -635.4960045584306, -797.9294151518891, -278.728498222233, -824.4946180706, -53.684089015248645, -163.25571997988138, -1121.0526438342786, -224.25267909743005, -996.5249633858787, -1092.9977887286068, -270.3595183911426, -572.4153078132999, -58.99342959888031, -1030.520263001825, -1060.985523064595, -682.2119137288001, -1055.2873411934825, -1258.6333412901795, -114.98045353313867, -596.9218416357742, -736.8979915064019, -653.2807573423478, -1419.2921138063525, -714.5228257360054, -622.4178058386816, -798.6264353545187, -435.90309105872467, -367.7476014895888, -859.6708612655168, -1193.6980394178986, -1135.3162025372706, -902.6525773205285, -1109.9553512520165, -104.01884335821848, -254.84207343639443, -730.6606569017536, -472.0907269646847, -510.27226541262064, -844.4350950244918, -639.2669853804282, -876.5755904397389, -1138.1292662317044, -572.3226131426368, -921.783650293737, -753.0397315647685, -417.58398419814546, -803.330473158436, -690.0712225959162, -1336.1377208658332, -761.3897095847117, -583.1671741076524, -823.9897520954576, -759.9907436608025, -1218.2272735448307, -922.8453386712445, -145.15921796549608, -810.9362572024453, -117.1765655476854, -1217.826780639302, -640.4205844254107, -801.9297252671358, -754.7071540168273, -534.617489455681, -1110.5195496441593, -182.7319123712814, -1076.9465924651931, -805.470689621921, -808.7847429011586, -295.8869715831097, -471.96345921881755, -911.9121442269254, -77.14197563672072, -260.0792658694199, -1257.9184402144222, -272.48501162412515, -634.4269583692387, -1220.5220967311704, -895.8216278983023, -856.0508823157559, -575.6411722052453, -590.7870002771847, -785.5627875044319, -915.8381041186124, -65.94601113495833, -790.037489568932, -42.055869708105455, -829.4647355017568, -508.75087731199625, -569.586718408397, -1016.4379407614668, -430.8745371365407, -434.233752109206, -817.0670450938117, -795.2628852663597, -674.8015043159771, -671.5172999444927, -380.4759724168349, -157.77205773712066, -1209.2327979357874, -174.77494863489667, -564.2960042103796, -386.0717174757543, -1321.5761946909395, -987.4891209170519, -342.8081875032378, -420.25360397554863, -1267.6330116972317, -1298.395488431069, -608.4923472927245, -939.7668214832634, -730.6012377460397, -256.62694977122595, -554.1415002478166, -862.5987810815939, -349.3225586071238, -1165.0840910591746, -612.747247620906, -254.38832710635904, -53.71923683923667, -372.6387025046156, -612.6725897249128, -35.186995695726424, -330.00398111205476, -355.866159891818, -58.66211862180306, -315.25018229574493, -57.28375079351155, -333.58138547769585, -716.1886915349096, -73.15091356892721, -303.3759747006694, -843.9830132640764, -480.2959564528749, -322.9049034962416, -68.2857624998694, -948.0887115483009, -874.2717814020991, -668.3483560191763, -795.6037974362946, -568.0238700600826, -1259.3103959570221, -144.60977647744627, -28.572303037400022, -703.2964360254598, -759.755605094145, -567.599700827707, -523.2068149552017, -190.7530327698146, -220.13589100713367, -785.660121801794, -241.914072800366, -1154.3786346194072, -556.0366791549048, -620.8913383436321, -190.30971357225366, -888.5424914895623, -1079.8656063877715, -479.33992107744973, -758.3746616467816, -66.90601679399127, -348.79492836366364, -298.40499812173243, -874.0478470220179, -347.50787479761914, -151.02693908900713, -1065.0321231211585, -136.35313072606098, -614.3074603685911, -698.553307533427, -784.5947078661666, -108.59617337885788, -651.2285203103559, -694.8812635906337, -203.83220557010534, -261.6648298295484, -46.25382947630829, -528.3731095067783, -547.8825781598489, -1246.8928886542342, -1262.46376781091, -651.29561993958, -63.43507536421968, -74.91842440637268, -773.5986031276049, -1026.8911277992815, -158.63075353567052, -1000.9341821446918, -921.9627675158486, -482.7222316610742, -1158.8208264350762, -704.173203453709, -968.837917322943, -185.46850976957313, -129.01256840745097, -95.14428394889268, -884.8061556413174, -616.2144970506495, -1023.4376434057092, -639.4262666733564, -1347.5311766114746, -39.47452031786916, -339.6454226646688, -1402.6870872847453, -17.375438844581602, -683.9041164720857, -817.7624614931094, -611.5261903248195, -501.3527618951996, -710.6453916025822, -314.1371953098268, -280.4063016742943, -1104.1748070618164, -230.95612169030574, -552.9139391378757, -551.1505062101478, -603.0536310957721, -875.332748492187, -388.8187432365931, -491.5990335989942, -952.3794862831137, -392.0956629231168, -704.6869582659461, -1421.7746559288648, -237.14725219886284, -724.4620852077812, -160.74629815484175, -345.0213263747066, -726.9241611030765, -1128.729430244229, -1295.8544616641086, -941.7341791297531, -504.4071596416349, -762.4982749224889, -1271.009970450479, -43.480914274168526, -185.2657529130229, -109.99779398097719, -248.1245302200051, -840.1124851816821, -1147.3474311861378, -1044.544060993156, -111.67545029193194, -49.8881287289207, -1210.4108190147251, -376.71719943318783, -67.04291775375647, -44.5755340027699, -708.4832600843803, -323.3520392995371, -18.106841264952102, -787.6443254293594, -431.8149566274412, -653.9606539275599, -1052.9570145313485, -873.0653707458641, -734.1052089011041, -1346.0351586012641, -82.5359606260845, -589.98290223225, -653.3009463964864]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.622622793787981, "mean_inference_ms": 1.7343829943992015, "mean_action_processing_ms": 0.8844057122596353, "mean_env_wait_ms": 10.879308638958872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01524662971496582, "StateBufferConnector_ms": 0.01123809814453125, "ViewRequirementAgentConnector_ms": 0.41950368881225586}, "num_episodes": 20, "episode_return_max": -1161.5605924053953, "episode_return_min": -4534.5412728798365, "episode_return_mean": -3021.699633447277, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512218, "num_agent_steps_trained": 512218, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 93.2874466055514, "num_env_steps_trained_throughput_per_sec": 93.2874466055514, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 512218, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512218, "timers": {"training_iteration_time_ms": 51130.817, "restore_workers_time_ms": 0.027, "training_step_time_ms": 51130.745, "sample_time_ms": 3441.571, "learn_time_ms": 47634.166, "learn_throughput": 83.973, "synch_weights_time_ms": 51.792}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 512218, "num_agent_steps_trained": 512218}, "done": false, "training_iteration": 28, "trial_id": "05c72_00000", "date": "2024-07-26_15-07-35", "timestamp": 1721986655, "time_this_iter_s": 42.88918995857239, "time_total_s": 1475.8410954475403, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805abf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1475.8410954475403, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 13.979032258064514, "ram_util_percent": 33.27903225806452}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 205.84559379718922, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.859948201120636, "policy_loss": -0.0005805087321794327, "vf_loss": 4.875362988224736, "vf_explained_var": 0.9859101300327866, "kl": 0.017264102791798196, "entropy": 2.0660914067574487, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.85925925925926, "num_grad_updates_lifetime": 122565.5, "diff_num_grad_updates_vs_sampler_policy": 2024.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 529479, "num_agent_steps_trained": 529479}, "env_runners": {"episode_reward_max": -1133.8081132747582, "episode_reward_min": -4534.5412728798365, "episode_reward_mean": -3108.042545420687, "episode_len_mean": 149.74, "episode_media": {}, "episodes_timesteps_total": 14974, "policy_reward_min": {"policy_0": -1472.7934243208897}, "policy_reward_max": {"policy_0": -8.803187303957163}, "policy_reward_mean": {"policy_0": -621.6085090841374}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2445.48333645876, -2221.2354588542157, -3746.378242308622, -3345.8107100587254, -3113.1531775404173, -2269.029662330639, -4403.830328523667, -3341.4330156752303, -2859.718727331709, -2768.3855268264297, -3706.446371533562, -2300.780189688461, -3878.3480656345323, -3429.520815392635, -2930.7243760345195, -3366.137333898884, -2216.024458025519, -2530.5834215261357, -3087.472423826144, -2912.7309541077398, -3726.4652512169946, -1485.8275543218192, -4302.9344292049645, -3946.2270843783417, -3568.6021536093463, -2213.9799178020826, -2610.3291741987036, -2379.413569940197, -2590.3326250184045, -3598.083795026076, -2993.274041869739, -3708.0348913813696, -4146.411494229789, -3655.646028586248, -3506.7850479044278, -3196.7257296839816, -4261.850851672587, -4008.513110403041, -4308.22028207999, -2931.5194057803383, -3384.505830755083, -3459.0524557902004, -2779.5368375716102, -4182.462737519706, -3148.17139260412, -2966.2961416917196, -3152.239723921896, -2593.7730766691357, -3602.241224797365, -4534.5412728798365, -2753.2910274537994, -2458.577605130292, -1392.3918450463145, -1495.4549236707894, -2018.8456104137333, -3854.3365164659517, -2895.5445165914753, -2287.3555613616495, -2763.5304384905653, -3273.028697395557, -2019.78258739404, -3298.840729615404, -1920.202992679502, -3631.8661736080803, -2590.138850637059, -3723.0707612923575, -2082.636482902567, -4511.415739382501, -2483.086585583951, -2955.4240006255377, -2719.601675774441, -3311.1836427066596, -3480.1666145245695, -3657.2756775409607, -3523.1304984185226, -2530.8479934818242, -2793.2356584619224, -1161.5605924053953, -3799.4423212615743, -3405.960176757187, -2237.669991670685, -3030.885559177718, -3704.119442845277, -3414.8852084297487, -3649.367149550509, -3444.527278822551, -3907.412200606986, -1133.8081132747582, -4408.352045239628, -3706.9797503958093, -2729.507027359917, -2160.5089293316323, -3165.8396899661416, -3436.9704266452086, -3946.2852606194624, -2945.1953412092166, -3513.14695318139, -2585.057956722191, -3456.121182171379, -3621.1648096886124], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-765.0314027112241, -361.0256655264542, -145.08395183810455, -556.3104521315029, -618.0318642514769, -503.95216747909967, -738.2281534236189, -680.123876769459, -158.5500716603883, -140.38118952165038, -846.1038222158342, -1058.177749515731, -725.6547523506398, -707.5841516871739, -408.8577665392407, -204.40515566663018, -776.0225388943775, -836.681396270396, -634.6445602645572, -894.0570589627619, -838.7102665160673, -698.3673559848771, -167.44038101396023, -725.414163008657, -683.2210110168568, -370.1660685691069, -128.97939885690823, -714.9166894285344, -333.29832791035346, -721.6691775657372, -947.8674295396511, -1085.8996340501346, -434.8637675529315, -751.961024092499, -1183.23847328845, -1045.3380100730092, -1091.148674906353, -63.25476353147725, -548.374479730483, -593.3170874339032, -532.9815416427608, -253.1834746991621, -848.6405117917631, -1172.1691357502025, -52.74406344781961, -611.096970039332, -29.44813337413323, -746.9139801758054, -604.9181553992231, -776.0082878379388, -1013.1410292250183, -758.1300199267171, -1164.088926407675, -155.29364259401726, -615.7927533801347, -68.54978974845926, -160.22338618709855, -938.6035838596233, -163.41916340989647, -969.9842664833824, -772.8188426072105, -977.147866817883, -1201.7299282342578, -828.405017856471, -98.24641011870781, -1374.2368130115433, -896.1634616456726, -522.0652932769462, -565.6990850124207, -71.35616244605288, -709.3485026894662, -658.5003423590265, -231.6129263996737, -691.3376596712912, -639.9249449150602, -95.19002114888909, -962.7474344414964, -688.3164716281879, -646.44464229517, -973.4387643851428, -757.5653975016462, -155.06673162348523, -381.31178834627576, -401.0134699075198, -521.0670706465895, -63.36987312495537, -792.8555255493876, -608.539865326022, -510.20323731583113, -555.6149202099397, -993.891847139183, -862.0554242912963, -54.324935852179784, -437.7771107355634, -739.4231058079266, -1472.7934243208897, -811.2649306624814, -111.61972529624435, -8.803187303957163, -508.2496865241677, -447.6973182307395, -882.3204816552062, -802.1507740884052, -306.5376888616836, -1287.758988380954, -26.48672013190254, -111.19384338411895, -229.70915792469702, -542.8892802359248, -575.5485526451749, -155.8896896498598, -457.0371187129927, -1181.6147773353096, -1296.3064330372815, -1212.0864104695231, -999.7109522662954, -1280.0486034522473, -606.7494905899746, -675.5086180050923, -384.20942006473075, -48.90909575516769, -601.8275618013682, -1270.8669818445194, -552.2800983235481, -1094.7184158847433, -614.0548069491152, -432.7860390318151, -425.5933605982949, -118.49164674640711, -623.0540644764505, -234.7477972897433, -522.9818841803971, -713.7907910742681, -866.4432925920499, -272.3654090622453, -916.0678470788665, -134.4611397416667, -92.73089592043644, -767.2503405015954, -468.9033466976287, -635.4960045584306, -797.9294151518891, -278.728498222233, -824.4946180706, -53.684089015248645, -163.25571997988138, -1121.0526438342786, -224.25267909743005, -996.5249633858787, -1092.9977887286068, -270.3595183911426, -572.4153078132999, -58.99342959888031, -1030.520263001825, -1060.985523064595, -682.2119137288001, -1055.2873411934825, -1258.6333412901795, -114.98045353313867, -596.9218416357742, -736.8979915064019, -653.2807573423478, -1419.2921138063525, -714.5228257360054, -622.4178058386816, -798.6264353545187, -435.90309105872467, -367.7476014895888, -859.6708612655168, -1193.6980394178986, -1135.3162025372706, -902.6525773205285, -1109.9553512520165, -104.01884335821848, -254.84207343639443, -730.6606569017536, -472.0907269646847, -510.27226541262064, -844.4350950244918, -639.2669853804282, -876.5755904397389, -1138.1292662317044, -572.3226131426368, -921.783650293737, -753.0397315647685, -417.58398419814546, -803.330473158436, -690.0712225959162, -1336.1377208658332, -761.3897095847117, -583.1671741076524, -823.9897520954576, -759.9907436608025, -1218.2272735448307, -922.8453386712445, -145.15921796549608, -810.9362572024453, -117.1765655476854, -1217.826780639302, -640.4205844254107, -801.9297252671358, -754.7071540168273, -534.617489455681, -1110.5195496441593, -182.7319123712814, -1076.9465924651931, -805.470689621921, -808.7847429011586, -295.8869715831097, -471.96345921881755, -911.9121442269254, -77.14197563672072, -260.0792658694199, -1257.9184402144222, -272.48501162412515, -634.4269583692387, -1220.5220967311704, -895.8216278983023, -856.0508823157559, -575.6411722052453, -590.7870002771847, -785.5627875044319, -915.8381041186124, -65.94601113495833, -790.037489568932, -42.055869708105455, -829.4647355017568, -508.75087731199625, -569.586718408397, -1016.4379407614668, -430.8745371365407, -434.233752109206, -817.0670450938117, -795.2628852663597, -674.8015043159771, -671.5172999444927, -380.4759724168349, -157.77205773712066, -1209.2327979357874, -174.77494863489667, -564.2960042103796, -386.0717174757543, -1321.5761946909395, -987.4891209170519, -342.8081875032378, -420.25360397554863, -1267.6330116972317, -1298.395488431069, -608.4923472927245, -939.7668214832634, -730.6012377460397, -256.62694977122595, -554.1415002478166, -862.5987810815939, -349.3225586071238, -1165.0840910591746, -612.747247620906, -254.38832710635904, -53.71923683923667, -372.6387025046156, -612.6725897249128, -35.186995695726424, -330.00398111205476, -355.866159891818, -58.66211862180306, -315.25018229574493, -57.28375079351155, -333.58138547769585, -716.1886915349096, -73.15091356892721, -303.3759747006694, -843.9830132640764, -480.2959564528749, -322.9049034962416, -68.2857624998694, -948.0887115483009, -874.2717814020991, -668.3483560191763, -795.6037974362946, -568.0238700600826, -1259.3103959570221, -144.60977647744627, -28.572303037400022, -703.2964360254598, -759.755605094145, -567.599700827707, -523.2068149552017, -190.7530327698146, -220.13589100713367, -785.660121801794, -241.914072800366, -1154.3786346194072, -556.0366791549048, -620.8913383436321, -190.30971357225366, -888.5424914895623, -1079.8656063877715, -479.33992107744973, -758.3746616467816, -66.90601679399127, -348.79492836366364, -298.40499812173243, -874.0478470220179, -347.50787479761914, -151.02693908900713, -1065.0321231211585, -136.35313072606098, -614.3074603685911, -698.553307533427, -784.5947078661666, -108.59617337885788, -651.2285203103559, -694.8812635906337, -203.83220557010534, -261.6648298295484, -46.25382947630829, -528.3731095067783, -547.8825781598489, -1246.8928886542342, -1262.46376781091, -651.29561993958, -63.43507536421968, -74.91842440637268, -773.5986031276049, -1026.8911277992815, -158.63075353567052, -1000.9341821446918, -921.9627675158486, -482.7222316610742, -1158.8208264350762, -704.173203453709, -968.837917322943, -185.46850976957313, -129.01256840745097, -95.14428394889268, -884.8061556413174, -616.2144970506495, -1023.4376434057092, -639.4262666733564, -1347.5311766114746, -39.47452031786916, -339.6454226646688, -1402.6870872847453, -17.375438844581602, -683.9041164720857, -817.7624614931094, -611.5261903248195, -501.3527618951996, -710.6453916025822, -314.1371953098268, -280.4063016742943, -1104.1748070618164, -230.95612169030574, -552.9139391378757, -551.1505062101478, -603.0536310957721, -875.332748492187, -388.8187432365931, -491.5990335989942, -952.3794862831137, -392.0956629231168, -704.6869582659461, -1421.7746559288648, -237.14725219886284, -724.4620852077812, -160.74629815484175, -345.0213263747066, -726.9241611030765, -1128.729430244229, -1295.8544616641086, -941.7341791297531, -504.4071596416349, -762.4982749224889, -1271.009970450479, -43.480914274168526, -185.2657529130229, -109.99779398097719, -248.1245302200051, -840.1124851816821, -1147.3474311861378, -1044.544060993156, -111.67545029193194, -49.8881287289207, -1210.4108190147251, -376.71719943318783, -67.04291775375647, -44.5755340027699, -708.4832600843803, -323.3520392995371, -18.106841264952102, -787.6443254293594, -431.8149566274412, -653.9606539275599, -1052.9570145313485, -873.0653707458641, -734.1052089011041, -1346.0351586012641, -82.5359606260845, -589.98290223225, -653.3009463964864, -675.1165329903555, -231.27110947979534, -540.0112453884822, -86.8205959004917, -704.4505079115605, -1123.509940407238, -154.82987776883976, -207.5319533855516, -504.3237545831754, -1040.690033032913, -914.2604526808209, -676.2657123714126, -1169.062510687903, -899.5623999820062, -44.96836712313488, -474.07330258602605, -583.8426764756291, -294.27304511080547, -1066.0157847840567, -996.6803994732257, -488.94605248429883, -295.4861298463657, -749.1281543150872, -1153.2137967236054, -962.5930161811539, -1312.6989829722618, -519.1958867673076, -317.6988952744892, -248.42971809970646, -1046.5037957087873, -1369.8274309660299, -1021.8432946620468, -780.0102924837511, -677.0904583907451, -58.640724104412776, -126.49853248216729, -467.6923584402191, -296.0867807803804, -68.08881606958462, -175.44162550240708, -296.93213477120474, -1164.8575059524742, -678.4372202161948, -1347.4124411711402, -920.7127431286158, -1238.3081681260746, -910.8861081474345, -261.75588536232414, -1131.5203047032494, -164.50928405672903, -1252.690941835231, -428.55567373562866, -231.60893845799282, -740.4437052650791, -76.2077680659854, -668.537666059167, -863.509449467108, -181.0544723921031, -100.23835457235484, -347.16898684090046, -1264.9715078051565, -359.10115147970146, -930.694359660743, -511.2556463356424, -99.81702468490289, -664.9472042358818, -913.3460084663171, -643.280729933282, -1099.0749781692996, -116.3215058404258, -784.3849180323729, -1253.678623058902, -440.43854515062804, -864.1898032301964, -603.5933711473626, -17.734151113728686, -559.8638582572678, -667.4965384121853, -1048.2921882670112, -651.8086051590229, -1045.5353845332756, -803.3827703958714, -482.3969565222982, -575.0206573634612, -606.8111843664861, -321.54366521263285, -898.8293331936313, -664.530751254669, -242.413875176922, -457.7403318843341, -893.246664081823, -476.3664656652944, -696.2403239203277, -1084.9518620751423, -305.3158664287936, -582.787334406698, -632.96242808466, -1022.7931321925117, -688.541144617672, -694.0807703870686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6207847900053516, "mean_inference_ms": 1.7343997403892792, "mean_action_processing_ms": 0.882465258545781, "mean_env_wait_ms": 10.875224402302287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015826940536499023, "StateBufferConnector_ms": 0.011622905731201172, "ViewRequirementAgentConnector_ms": 0.43422818183898926}, "num_episodes": 20, "episode_return_max": -1133.8081132747582, "episode_return_min": -4534.5412728798365, "episode_return_mean": -3108.042545420687, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 529479, "num_agent_steps_trained": 529479, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.78242324387242, "num_env_steps_trained_throughput_per_sec": 77.78242324387242, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 529479, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 529479, "timers": {"training_iteration_time_ms": 51500.79, "restore_workers_time_ms": 0.027, "training_step_time_ms": 51500.719, "sample_time_ms": 3428.522, "learn_time_ms": 48017.111, "learn_throughput": 83.304, "synch_weights_time_ms": 51.939}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 529479, "num_agent_steps_trained": 529479}, "done": false, "training_iteration": 29, "trial_id": "05c72_00000", "date": "2024-07-26_15-08-26", "timestamp": 1721986706, "time_this_iter_s": 51.43483901023865, "time_total_s": 1527.275934457779, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805ab520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1527.275934457779, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 12.93972602739726, "ram_util_percent": 33.106849315068494}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 204.24182885444029, "cur_kl_coeff": 0.3374999999999999, "cur_lr": 0.001, "total_loss": 4.552346857827286, "policy_loss": -0.00400091554980254, "vf_loss": 4.572209681806894, "vf_explained_var": 0.9852742104146672, "kl": 0.015833821329823427, "entropy": 2.120582621179778, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.8344827586207, "num_grad_updates_lifetime": 126765.5, "diff_num_grad_updates_vs_sampler_policy": 2174.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 548015, "num_agent_steps_trained": 548015}, "env_runners": {"episode_reward_max": -1133.8081132747582, "episode_reward_min": -4534.5412728798365, "episode_reward_mean": -3069.3173646060673, "episode_len_mean": 149.74, "episode_media": {}, "episodes_timesteps_total": 14974, "policy_reward_min": {"policy_0": -1424.2850799047685}, "policy_reward_max": {"policy_0": -0.3972758683100436}, "policy_reward_mean": {"policy_0": -613.8634729212137}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3384.505830755083, -3459.0524557902004, -2779.5368375716102, -4182.462737519706, -3148.17139260412, -2966.2961416917196, -3152.239723921896, -2593.7730766691357, -3602.241224797365, -4534.5412728798365, -2753.2910274537994, -2458.577605130292, -1392.3918450463145, -1495.4549236707894, -2018.8456104137333, -3854.3365164659517, -2895.5445165914753, -2287.3555613616495, -2763.5304384905653, -3273.028697395557, -2019.78258739404, -3298.840729615404, -1920.202992679502, -3631.8661736080803, -2590.138850637059, -3723.0707612923575, -2082.636482902567, -4511.415739382501, -2483.086585583951, -2955.4240006255377, -2719.601675774441, -3311.1836427066596, -3480.1666145245695, -3657.2756775409607, -3523.1304984185226, -2530.8479934818242, -2793.2356584619224, -1161.5605924053953, -3799.4423212615743, -3405.960176757187, -2237.669991670685, -3030.885559177718, -3704.119442845277, -3414.8852084297487, -3649.367149550509, -3444.527278822551, -3907.412200606986, -1133.8081132747582, -4408.352045239628, -3706.9797503958093, -2729.507027359917, -2160.5089293316323, -3165.8396899661416, -3436.9704266452086, -3946.2852606194624, -2945.1953412092166, -3513.14695318139, -2585.057956722191, -3456.121182171379, -3621.1648096886124, -1889.7880544506306, -3120.663386246253, -2803.657117426218, -2112.9755262495046, -2968.1513729390967, -4411.735311603575, -4084.667557547173, -3118.231966399578, -1606.2520513136794, -2719.8254639143697, -4259.842207676498, -3313.9620449475165, -2338.9444447751853, -3672.809812620198, -3754.348065897475, -2442.0578153709234, -3652.597598866178, -3294.8839249172674, -4132.568894625159, -3073.8054601624676, -3284.0341396162985, -4263.553549878794, -3729.169350707446, -3373.0379446991415, -3277.3728822616636, -2985.445024306483, -2279.5303400485145, -3251.408938812587, -2853.6539587965167, -2330.6542345100124, -2129.952023219795, -3089.2958662407564, -3315.642754006203, -3724.691980736236, -3593.8837220401488, -3233.449173608867, -1190.6541508653247, -4269.671800612776, -2094.8559318924845, -3098.1591076141003], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-801.9297252671358, -754.7071540168273, -534.617489455681, -1110.5195496441593, -182.7319123712814, -1076.9465924651931, -805.470689621921, -808.7847429011586, -295.8869715831097, -471.96345921881755, -911.9121442269254, -77.14197563672072, -260.0792658694199, -1257.9184402144222, -272.48501162412515, -634.4269583692387, -1220.5220967311704, -895.8216278983023, -856.0508823157559, -575.6411722052453, -590.7870002771847, -785.5627875044319, -915.8381041186124, -65.94601113495833, -790.037489568932, -42.055869708105455, -829.4647355017568, -508.75087731199625, -569.586718408397, -1016.4379407614668, -430.8745371365407, -434.233752109206, -817.0670450938117, -795.2628852663597, -674.8015043159771, -671.5172999444927, -380.4759724168349, -157.77205773712066, -1209.2327979357874, -174.77494863489667, -564.2960042103796, -386.0717174757543, -1321.5761946909395, -987.4891209170519, -342.8081875032378, -420.25360397554863, -1267.6330116972317, -1298.395488431069, -608.4923472927245, -939.7668214832634, -730.6012377460397, -256.62694977122595, -554.1415002478166, -862.5987810815939, -349.3225586071238, -1165.0840910591746, -612.747247620906, -254.38832710635904, -53.71923683923667, -372.6387025046156, -612.6725897249128, -35.186995695726424, -330.00398111205476, -355.866159891818, -58.66211862180306, -315.25018229574493, -57.28375079351155, -333.58138547769585, -716.1886915349096, -73.15091356892721, -303.3759747006694, -843.9830132640764, -480.2959564528749, -322.9049034962416, -68.2857624998694, -948.0887115483009, -874.2717814020991, -668.3483560191763, -795.6037974362946, -568.0238700600826, -1259.3103959570221, -144.60977647744627, -28.572303037400022, -703.2964360254598, -759.755605094145, -567.599700827707, -523.2068149552017, -190.7530327698146, -220.13589100713367, -785.660121801794, -241.914072800366, -1154.3786346194072, -556.0366791549048, -620.8913383436321, -190.30971357225366, -888.5424914895623, -1079.8656063877715, -479.33992107744973, -758.3746616467816, -66.90601679399127, -348.79492836366364, -298.40499812173243, -874.0478470220179, -347.50787479761914, -151.02693908900713, -1065.0321231211585, -136.35313072606098, -614.3074603685911, -698.553307533427, -784.5947078661666, -108.59617337885788, -651.2285203103559, -694.8812635906337, -203.83220557010534, -261.6648298295484, -46.25382947630829, -528.3731095067783, -547.8825781598489, -1246.8928886542342, -1262.46376781091, -651.29561993958, -63.43507536421968, -74.91842440637268, -773.5986031276049, -1026.8911277992815, -158.63075353567052, -1000.9341821446918, -921.9627675158486, -482.7222316610742, -1158.8208264350762, -704.173203453709, -968.837917322943, -185.46850976957313, -129.01256840745097, -95.14428394889268, -884.8061556413174, -616.2144970506495, -1023.4376434057092, -639.4262666733564, -1347.5311766114746, -39.47452031786916, -339.6454226646688, -1402.6870872847453, -17.375438844581602, -683.9041164720857, -817.7624614931094, -611.5261903248195, -501.3527618951996, -710.6453916025822, -314.1371953098268, -280.4063016742943, -1104.1748070618164, -230.95612169030574, -552.9139391378757, -551.1505062101478, -603.0536310957721, -875.332748492187, -388.8187432365931, -491.5990335989942, -952.3794862831137, -392.0956629231168, -704.6869582659461, -1421.7746559288648, -237.14725219886284, -724.4620852077812, -160.74629815484175, -345.0213263747066, -726.9241611030765, -1128.729430244229, -1295.8544616641086, -941.7341791297531, -504.4071596416349, -762.4982749224889, -1271.009970450479, -43.480914274168526, -185.2657529130229, -109.99779398097719, -248.1245302200051, -840.1124851816821, -1147.3474311861378, -1044.544060993156, -111.67545029193194, -49.8881287289207, -1210.4108190147251, -376.71719943318783, -67.04291775375647, -44.5755340027699, -708.4832600843803, -323.3520392995371, -18.106841264952102, -787.6443254293594, -431.8149566274412, -653.9606539275599, -1052.9570145313485, -873.0653707458641, -734.1052089011041, -1346.0351586012641, -82.5359606260845, -589.98290223225, -653.3009463964864, -675.1165329903555, -231.27110947979534, -540.0112453884822, -86.8205959004917, -704.4505079115605, -1123.509940407238, -154.82987776883976, -207.5319533855516, -504.3237545831754, -1040.690033032913, -914.2604526808209, -676.2657123714126, -1169.062510687903, -899.5623999820062, -44.96836712313488, -474.07330258602605, -583.8426764756291, -294.27304511080547, -1066.0157847840567, -996.6803994732257, -488.94605248429883, -295.4861298463657, -749.1281543150872, -1153.2137967236054, -962.5930161811539, -1312.6989829722618, -519.1958867673076, -317.6988952744892, -248.42971809970646, -1046.5037957087873, -1369.8274309660299, -1021.8432946620468, -780.0102924837511, -677.0904583907451, -58.640724104412776, -126.49853248216729, -467.6923584402191, -296.0867807803804, -68.08881606958462, -175.44162550240708, -296.93213477120474, -1164.8575059524742, -678.4372202161948, -1347.4124411711402, -920.7127431286158, -1238.3081681260746, -910.8861081474345, -261.75588536232414, -1131.5203047032494, -164.50928405672903, -1252.690941835231, -428.55567373562866, -231.60893845799282, -740.4437052650791, -76.2077680659854, -668.537666059167, -863.509449467108, -181.0544723921031, -100.23835457235484, -347.16898684090046, -1264.9715078051565, -359.10115147970146, -930.694359660743, -511.2556463356424, -99.81702468490289, -664.9472042358818, -913.3460084663171, -643.280729933282, -1099.0749781692996, -116.3215058404258, -784.3849180323729, -1253.678623058902, -440.43854515062804, -864.1898032301964, -603.5933711473626, -17.734151113728686, -559.8638582572678, -667.4965384121853, -1048.2921882670112, -651.8086051590229, -1045.5353845332756, -803.3827703958714, -482.3969565222982, -575.0206573634612, -606.8111843664861, -321.54366521263285, -898.8293331936313, -664.530751254669, -242.413875176922, -457.7403318843341, -893.246664081823, -476.3664656652944, -696.2403239203277, -1084.9518620751423, -305.3158664287936, -582.787334406698, -632.96242808466, -1022.7931321925117, -688.541144617672, -694.0807703870686, -112.77323982970175, -379.76709824515467, -1182.003938855263, -187.3756685689758, -27.868108951534996, -687.3735151288192, -16.61224520741028, -606.7497765673471, -1000.0664379295919, -809.8614114130837, -139.37814080118383, -537.3731148539588, -1102.567938029835, -937.2682211801908, -87.06970256104893, -494.1258483400841, -404.14619490234435, -494.9813123952843, -532.5175239090478, -187.20464670274256, -972.4299381323315, -477.3206827998881, -897.3227628849322, -553.4038909310483, -67.67409819090071, -1041.0027880911048, -1017.0667845525589, -1397.2747641527612, -843.1232514837848, -113.26772332336793, -722.9093758838818, -1305.9599157236507, -845.3620859981941, -1038.5044179701235, -171.93176197132365, -1322.9535985188938, -11.433790660705219, -318.50443303762376, -306.16847984020814, -1159.17166434215, -516.9884062538886, -161.6547539490081, -120.46676102051734, -148.3757983841053, -658.7663317061606, -17.0400684702034, -604.7094926248955, -682.4963198644031, -573.4015367282952, -842.1780462265737, -507.64143801567093, -128.407386140177, -1424.2850799047685, -1260.0583436601407, -939.449959955736, -835.396038139337, -782.4047557572139, -111.67496613506191, -837.6032686195161, -746.8830162963833, -53.8608228210125, -42.6169491928421, -645.0186164004671, -1280.1612143648902, -317.2868419959743, -793.630528453614, -1051.4917773677948, -477.912073069951, -825.8600892627879, -523.9153444660503, -720.2045302448456, -206.37939376313903, -1362.654437528809, -1027.9991676047882, -437.11053675589403, -238.8815855941133, -394.0758125919718, -1069.1300107650252, -255.17653033634798, -484.79387608346383, -715.3874914735741, -574.8243652833382, -468.0937914979504, -1214.186062459175, -680.1058881521406, -485.04759574755656, -792.8553811836684, -146.14561254227021, -1139.7424552683597, -731.0928801754105, -668.278743237154, -1299.4152467666609, -407.45264738343485, -762.1264452582967, -995.2958119796162, -255.4931551426761, -595.8230666430063, -1004.2058175783864, -0.3972758683100436, -1217.8861449300844, -753.8379014486617, -605.6515281330478, -632.2003982501145, -214.65351755219191, -1077.690794232278, -836.6076920128844, -1017.1618866107657, -562.4152315243113, -427.9055450275583, -1419.463194703271, -1395.4962009634307, -283.10441387486526, -1240.3373036892838, -765.8111639925011, -44.420268187365174, -1167.6091089644056, -309.98060076908075, -506.84335869165153, -745.0311128017544, -643.5737634722476, -889.9604035198571, -254.48157968465287, -775.159232599651, -573.1980597511829, -784.5736067063175, -381.82887754530515, -1139.4121649602484, -208.94582456152634, -1227.245894639495, -28.012262599908688, -212.3594354636747, -235.42739702386848, -1059.8662191613425, -742.2958111075244, -29.581477292104413, -635.3596567583727, -45.55048724162732, -120.59479471524153, -1248.2813533435674, -1201.6226467537763, -924.6252911025114, -1267.864610922638, -535.7838778362858, -103.31844778798636, -22.06173114709553, -465.3293013633409, -610.4980294326292, -243.8112921670259, -926.0713434725504, -84.94426807446581, -805.4292306870917, -158.82717075635034, -778.2144136791584, -44.66716231862586, -342.81404577856915, -589.9340076348985, -570.1286337493992, -64.05556670589985, -767.3572162923368, -1097.8204418582216, -1128.0815016316565, -642.30905634089, -224.10264035770913, -541.8023197167081, -779.3472359592375, -1059.497331042989, -796.6308338814774, -614.8794720215521, -38.85919563467383, -1214.825148155545, -409.12299382272295, -515.4275876295544, -1131.6145946362021, -816.0531819103434, -721.6653640413269, -800.5541075086437, -990.689020050235, -493.19983750131996, -195.29333364501503, -753.7128749036491, -187.70517273836268, -79.78046330771146, -678.6812104237924, -206.79840935790068, -37.68889503755919, -490.1711553880554, -1353.9300562523445, -781.732569105322, -472.09382809246387, -1171.74419177459, -207.62506824309435, -1191.0682159844105, -65.90403361688996, -340.49962314512726, -289.758990902962, -1042.1649645640775, -510.01443030390624, -955.1848384270144, -194.00945521364608, -396.78541910545897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6197103198091596, "mean_inference_ms": 1.7372821138504937, "mean_action_processing_ms": 0.8814497669752748, "mean_env_wait_ms": 10.882773918391155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015053033828735352, "StateBufferConnector_ms": 0.011224031448364258, "ViewRequirementAgentConnector_ms": 0.41638851165771484}, "num_episodes": 40, "episode_return_max": -1133.8081132747582, "episode_return_min": -4534.5412728798365, "episode_return_mean": -3069.3173646060673, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 548015, "num_agent_steps_trained": 548015, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.07166648455453, "num_env_steps_trained_throughput_per_sec": 78.07166648455453, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 548015, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 548015, "timers": {"training_iteration_time_ms": 51202.962, "restore_workers_time_ms": 0.027, "training_step_time_ms": 51202.891, "sample_time_ms": 3421.694, "learn_time_ms": 47724.466, "learn_throughput": 83.814, "synch_weights_time_ms": 53.56}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 548015, "num_agent_steps_trained": 548015}, "done": false, "training_iteration": 30, "trial_id": "05c72_00000", "date": "2024-07-26_15-09-18", "timestamp": 1721986758, "time_this_iter_s": 51.24588704109192, "time_total_s": 1578.5218214988708, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e5480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1578.5218214988708, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 13.909722222222221, "ram_util_percent": 32.044444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 169.78740038527198, "cur_kl_coeff": 0.33749999999999997, "cur_lr": 0.001, "total_loss": 5.140442982142344, "policy_loss": -0.002523367624623497, "vf_loss": 5.156817256876361, "vf_explained_var": 0.9835553460743599, "kl": 0.01743370436897473, "entropy": 1.9734778901358028, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.31468531468532, "num_grad_updates_lifetime": 131085.5, "diff_num_grad_updates_vs_sampler_policy": 2144.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 566221, "num_agent_steps_trained": 566221}, "env_runners": {"episode_reward_max": -1133.8081132747582, "episode_reward_min": -4511.415739382501, "episode_reward_mean": -3099.3884742508235, "episode_len_mean": 149.74, "episode_media": {}, "episodes_timesteps_total": 14974, "policy_reward_min": {"policy_0": -1437.329979656808}, "policy_reward_max": {"policy_0": -0.3972758683100436}, "policy_reward_mean": {"policy_0": -619.8776948501647}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2019.78258739404, -3298.840729615404, -1920.202992679502, -3631.8661736080803, -2590.138850637059, -3723.0707612923575, -2082.636482902567, -4511.415739382501, -2483.086585583951, -2955.4240006255377, -2719.601675774441, -3311.1836427066596, -3480.1666145245695, -3657.2756775409607, -3523.1304984185226, -2530.8479934818242, -2793.2356584619224, -1161.5605924053953, -3799.4423212615743, -3405.960176757187, -2237.669991670685, -3030.885559177718, -3704.119442845277, -3414.8852084297487, -3649.367149550509, -3444.527278822551, -3907.412200606986, -1133.8081132747582, -4408.352045239628, -3706.9797503958093, -2729.507027359917, -2160.5089293316323, -3165.8396899661416, -3436.9704266452086, -3946.2852606194624, -2945.1953412092166, -3513.14695318139, -2585.057956722191, -3456.121182171379, -3621.1648096886124, -1889.7880544506306, -3120.663386246253, -2803.657117426218, -2112.9755262495046, -2968.1513729390967, -4411.735311603575, -4084.667557547173, -3118.231966399578, -1606.2520513136794, -2719.8254639143697, -4259.842207676498, -3313.9620449475165, -2338.9444447751853, -3672.809812620198, -3754.348065897475, -2442.0578153709234, -3652.597598866178, -3294.8839249172674, -4132.568894625159, -3073.8054601624676, -3284.0341396162985, -4263.553549878794, -3729.169350707446, -3373.0379446991415, -3277.3728822616636, -2985.445024306483, -2279.5303400485145, -3251.408938812587, -2853.6539587965167, -2330.6542345100124, -2129.952023219795, -3089.2958662407564, -3315.642754006203, -3724.691980736236, -3593.8837220401488, -3233.449173608867, -1190.6541508653247, -4269.671800612776, -2094.8559318924845, -3098.1591076141003, -2612.2398121746305, -2621.8446788855076, -3189.1416679241365, -3326.8669592311394, -2520.0693293545237, -4090.53201604083, -3897.3525759738886, -3882.617196735531, -2733.277727960293, -3138.2911688298723, -3557.141080011089, -3532.128694408572, -3204.211494391132, -2982.401478808507, -1643.9344403675034, -3028.1103539431856, -3051.313338417169, -3214.597869668411, -3422.0559099491825, -2354.1606076213016], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-348.79492836366364, -298.40499812173243, -874.0478470220179, -347.50787479761914, -151.02693908900713, -1065.0321231211585, -136.35313072606098, -614.3074603685911, -698.553307533427, -784.5947078661666, -108.59617337885788, -651.2285203103559, -694.8812635906337, -203.83220557010534, -261.6648298295484, -46.25382947630829, -528.3731095067783, -547.8825781598489, -1246.8928886542342, -1262.46376781091, -651.29561993958, -63.43507536421968, -74.91842440637268, -773.5986031276049, -1026.8911277992815, -158.63075353567052, -1000.9341821446918, -921.9627675158486, -482.7222316610742, -1158.8208264350762, -704.173203453709, -968.837917322943, -185.46850976957313, -129.01256840745097, -95.14428394889268, -884.8061556413174, -616.2144970506495, -1023.4376434057092, -639.4262666733564, -1347.5311766114746, -39.47452031786916, -339.6454226646688, -1402.6870872847453, -17.375438844581602, -683.9041164720857, -817.7624614931094, -611.5261903248195, -501.3527618951996, -710.6453916025822, -314.1371953098268, -280.4063016742943, -1104.1748070618164, -230.95612169030574, -552.9139391378757, -551.1505062101478, -603.0536310957721, -875.332748492187, -388.8187432365931, -491.5990335989942, -952.3794862831137, -392.0956629231168, -704.6869582659461, -1421.7746559288648, -237.14725219886284, -724.4620852077812, -160.74629815484175, -345.0213263747066, -726.9241611030765, -1128.729430244229, -1295.8544616641086, -941.7341791297531, -504.4071596416349, -762.4982749224889, -1271.009970450479, -43.480914274168526, -185.2657529130229, -109.99779398097719, -248.1245302200051, -840.1124851816821, -1147.3474311861378, -1044.544060993156, -111.67545029193194, -49.8881287289207, -1210.4108190147251, -376.71719943318783, -67.04291775375647, -44.5755340027699, -708.4832600843803, -323.3520392995371, -18.106841264952102, -787.6443254293594, -431.8149566274412, -653.9606539275599, -1052.9570145313485, -873.0653707458641, -734.1052089011041, -1346.0351586012641, -82.5359606260845, -589.98290223225, -653.3009463964864, -675.1165329903555, -231.27110947979534, -540.0112453884822, -86.8205959004917, -704.4505079115605, -1123.509940407238, -154.82987776883976, -207.5319533855516, -504.3237545831754, -1040.690033032913, -914.2604526808209, -676.2657123714126, -1169.062510687903, -899.5623999820062, -44.96836712313488, -474.07330258602605, -583.8426764756291, -294.27304511080547, -1066.0157847840567, -996.6803994732257, -488.94605248429883, -295.4861298463657, -749.1281543150872, -1153.2137967236054, -962.5930161811539, -1312.6989829722618, -519.1958867673076, -317.6988952744892, -248.42971809970646, -1046.5037957087873, -1369.8274309660299, -1021.8432946620468, -780.0102924837511, -677.0904583907451, -58.640724104412776, -126.49853248216729, -467.6923584402191, -296.0867807803804, -68.08881606958462, -175.44162550240708, -296.93213477120474, -1164.8575059524742, -678.4372202161948, -1347.4124411711402, -920.7127431286158, -1238.3081681260746, -910.8861081474345, -261.75588536232414, -1131.5203047032494, -164.50928405672903, -1252.690941835231, -428.55567373562866, -231.60893845799282, -740.4437052650791, -76.2077680659854, -668.537666059167, -863.509449467108, -181.0544723921031, -100.23835457235484, -347.16898684090046, -1264.9715078051565, -359.10115147970146, -930.694359660743, -511.2556463356424, -99.81702468490289, -664.9472042358818, -913.3460084663171, -643.280729933282, -1099.0749781692996, -116.3215058404258, -784.3849180323729, -1253.678623058902, -440.43854515062804, -864.1898032301964, -603.5933711473626, -17.734151113728686, -559.8638582572678, -667.4965384121853, -1048.2921882670112, -651.8086051590229, -1045.5353845332756, -803.3827703958714, -482.3969565222982, -575.0206573634612, -606.8111843664861, -321.54366521263285, -898.8293331936313, -664.530751254669, -242.413875176922, -457.7403318843341, -893.246664081823, -476.3664656652944, -696.2403239203277, -1084.9518620751423, -305.3158664287936, -582.787334406698, -632.96242808466, -1022.7931321925117, -688.541144617672, -694.0807703870686, -112.77323982970175, -379.76709824515467, -1182.003938855263, -187.3756685689758, -27.868108951534996, -687.3735151288192, -16.61224520741028, -606.7497765673471, -1000.0664379295919, -809.8614114130837, -139.37814080118383, -537.3731148539588, -1102.567938029835, -937.2682211801908, -87.06970256104893, -494.1258483400841, -404.14619490234435, -494.9813123952843, -532.5175239090478, -187.20464670274256, -972.4299381323315, -477.3206827998881, -897.3227628849322, -553.4038909310483, -67.67409819090071, -1041.0027880911048, -1017.0667845525589, -1397.2747641527612, -843.1232514837848, -113.26772332336793, -722.9093758838818, -1305.9599157236507, -845.3620859981941, -1038.5044179701235, -171.93176197132365, -1322.9535985188938, -11.433790660705219, -318.50443303762376, -306.16847984020814, -1159.17166434215, -516.9884062538886, -161.6547539490081, -120.46676102051734, -148.3757983841053, -658.7663317061606, -17.0400684702034, -604.7094926248955, -682.4963198644031, -573.4015367282952, -842.1780462265737, -507.64143801567093, -128.407386140177, -1424.2850799047685, -1260.0583436601407, -939.449959955736, -835.396038139337, -782.4047557572139, -111.67496613506191, -837.6032686195161, -746.8830162963833, -53.8608228210125, -42.6169491928421, -645.0186164004671, -1280.1612143648902, -317.2868419959743, -793.630528453614, -1051.4917773677948, -477.912073069951, -825.8600892627879, -523.9153444660503, -720.2045302448456, -206.37939376313903, -1362.654437528809, -1027.9991676047882, -437.11053675589403, -238.8815855941133, -394.0758125919718, -1069.1300107650252, -255.17653033634798, -484.79387608346383, -715.3874914735741, -574.8243652833382, -468.0937914979504, -1214.186062459175, -680.1058881521406, -485.04759574755656, -792.8553811836684, -146.14561254227021, -1139.7424552683597, -731.0928801754105, -668.278743237154, -1299.4152467666609, -407.45264738343485, -762.1264452582967, -995.2958119796162, -255.4931551426761, -595.8230666430063, -1004.2058175783864, -0.3972758683100436, -1217.8861449300844, -753.8379014486617, -605.6515281330478, -632.2003982501145, -214.65351755219191, -1077.690794232278, -836.6076920128844, -1017.1618866107657, -562.4152315243113, -427.9055450275583, -1419.463194703271, -1395.4962009634307, -283.10441387486526, -1240.3373036892838, -765.8111639925011, -44.420268187365174, -1167.6091089644056, -309.98060076908075, -506.84335869165153, -745.0311128017544, -643.5737634722476, -889.9604035198571, -254.48157968465287, -775.159232599651, -573.1980597511829, -784.5736067063175, -381.82887754530515, -1139.4121649602484, -208.94582456152634, -1227.245894639495, -28.012262599908688, -212.3594354636747, -235.42739702386848, -1059.8662191613425, -742.2958111075244, -29.581477292104413, -635.3596567583727, -45.55048724162732, -120.59479471524153, -1248.2813533435674, -1201.6226467537763, -924.6252911025114, -1267.864610922638, -535.7838778362858, -103.31844778798636, -22.06173114709553, -465.3293013633409, -610.4980294326292, -243.8112921670259, -926.0713434725504, -84.94426807446581, -805.4292306870917, -158.82717075635034, -778.2144136791584, -44.66716231862586, -342.81404577856915, -589.9340076348985, -570.1286337493992, -64.05556670589985, -767.3572162923368, -1097.8204418582216, -1128.0815016316565, -642.30905634089, -224.10264035770913, -541.8023197167081, -779.3472359592375, -1059.497331042989, -796.6308338814774, -614.8794720215521, -38.85919563467383, -1214.825148155545, -409.12299382272295, -515.4275876295544, -1131.6145946362021, -816.0531819103434, -721.6653640413269, -800.5541075086437, -990.689020050235, -493.19983750131996, -195.29333364501503, -753.7128749036491, -187.70517273836268, -79.78046330771146, -678.6812104237924, -206.79840935790068, -37.68889503755919, -490.1711553880554, -1353.9300562523445, -781.732569105322, -472.09382809246387, -1171.74419177459, -207.62506824309435, -1191.0682159844105, -65.90403361688996, -340.49962314512726, -289.758990902962, -1042.1649645640775, -510.01443030390624, -955.1848384270144, -194.00945521364608, -396.78541910545897, -125.975186610605, -92.48306342599713, -1262.6651048835815, -1059.864062502472, -71.25239475197361, -278.5600735458899, -412.98066951929314, -885.8926058992615, -960.1609934444376, -84.25033647662686, -69.04730301692241, -13.697733420902088, -1393.4210897633866, -592.6057681530754, -1120.3697735698506, -269.6283512841584, -616.3107813267765, -1219.052178269241, -591.7904871666835, -630.0851611842784, -432.1939847152566, -365.7824729860017, -839.9426195151831, -533.398487854385, -348.7517642836979, -1240.1758574732353, -197.1500157528425, -1270.4369047860237, -490.95469587536905, -891.814542153362, -817.121627248991, -919.9008429685274, -684.5613277739011, -442.98733232616536, -1032.7814456562978, -811.0239901289822, -710.2026582734312, -1075.2908859154347, -714.3256464602063, -571.7740159574757, -482.83770462832877, -622.5402948321505, -755.7543840498103, -546.9433379898877, -325.2020064601151, -662.0737366354338, -498.2698172962889, -1255.2464258201471, -245.90834858757293, -476.79284049042917, -755.2512340162299, -784.663181128685, -838.439122970943, -729.2084639648882, -449.5790779303461, -671.8082067798548, -469.80166811617914, -1069.557388626419, -699.3557559355934, -621.6056749505266, -953.1474779932526, -966.7483917000961, -652.7585336862703, -187.37239999760783, -444.18469101390474, -588.1130063393441, -1276.925193358486, -171.19350647994088, -418.19959176321055, -527.9701808675256, -107.93411193849605, -207.2472561032931, -749.9519972746872, -144.95245057561482, -433.84862447541127, -618.9879572543593, -974.0001739983662, -717.775304732862, -345.98890082959986, -371.3580171279966, -57.00016179622511, -206.2532958522366, -929.1753101210808, -1377.7814163701778, -481.10315427744735, -821.3683303730264, -474.5853089277017, -500.6533208096509, -858.2403299231768, -559.7505796348541, -13.83874048632876, -570.3199583211599, -908.1645638741727, -492.40266761071314, -1437.329979656808, -1008.2311488026023, -95.71315444412393, -238.8771097212227, -269.0212642321254, -742.3179304212274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6180501549584423, "mean_inference_ms": 1.7348942166857488, "mean_action_processing_ms": 0.8773418650759875, "mean_env_wait_ms": 10.864068577751869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01530599594116211, "StateBufferConnector_ms": 0.011395454406738281, "ViewRequirementAgentConnector_ms": 0.426800012588501}, "num_episodes": 20, "episode_return_max": -1133.8081132747582, "episode_return_min": -4511.415739382501, "episode_return_mean": -3099.3884742508235, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 566221, "num_agent_steps_trained": 566221, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.82075371031706, "num_env_steps_trained_throughput_per_sec": 74.82075371031706, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 566221, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 566221, "timers": {"training_iteration_time_ms": 51346.212, "restore_workers_time_ms": 0.026, "training_step_time_ms": 51346.143, "sample_time_ms": 3434.05, "learn_time_ms": 47855.447, "learn_throughput": 83.585, "synch_weights_time_ms": 53.502}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 566221, "num_agent_steps_trained": 566221}, "done": false, "training_iteration": 31, "trial_id": "05c72_00000", "date": "2024-07-26_15-10-11", "timestamp": 1721986811, "time_this_iter_s": 53.47136425971985, "time_total_s": 1631.9931857585907, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d28052a0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1631.9931857585907, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 14.290909090909095, "ram_util_percent": 32.157142857142865}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 190.63618999944484, "cur_kl_coeff": 0.3375, "cur_lr": 0.0010000000000000005, "total_loss": 4.544346796080124, "policy_loss": -0.00010935337660540598, "vf_loss": 4.561248838870716, "vf_explained_var": 0.9862551120978609, "kl": 0.017305997459375683, "entropy": 2.2633459807366365, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.66666666666667, "num_grad_updates_lifetime": 135165.5, "diff_num_grad_updates_vs_sampler_policy": 1934.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 582690, "num_agent_steps_trained": 582690}, "env_runners": {"episode_reward_max": -1133.8081132747582, "episode_reward_min": -5160.975581327425, "episode_reward_mean": -3082.381278083226, "episode_len_mean": 149.64, "episode_media": {}, "episodes_timesteps_total": 14964, "policy_reward_min": {"policy_0": -1437.329979656808}, "policy_reward_max": {"policy_0": -0.3972758683100436}, "policy_reward_mean": {"policy_0": -616.4762556166453}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2237.669991670685, -3030.885559177718, -3704.119442845277, -3414.8852084297487, -3649.367149550509, -3444.527278822551, -3907.412200606986, -1133.8081132747582, -4408.352045239628, -3706.9797503958093, -2729.507027359917, -2160.5089293316323, -3165.8396899661416, -3436.9704266452086, -3946.2852606194624, -2945.1953412092166, -3513.14695318139, -2585.057956722191, -3456.121182171379, -3621.1648096886124, -1889.7880544506306, -3120.663386246253, -2803.657117426218, -2112.9755262495046, -2968.1513729390967, -4411.735311603575, -4084.667557547173, -3118.231966399578, -1606.2520513136794, -2719.8254639143697, -4259.842207676498, -3313.9620449475165, -2338.9444447751853, -3672.809812620198, -3754.348065897475, -2442.0578153709234, -3652.597598866178, -3294.8839249172674, -4132.568894625159, -3073.8054601624676, -3284.0341396162985, -4263.553549878794, -3729.169350707446, -3373.0379446991415, -3277.3728822616636, -2985.445024306483, -2279.5303400485145, -3251.408938812587, -2853.6539587965167, -2330.6542345100124, -2129.952023219795, -3089.2958662407564, -3315.642754006203, -3724.691980736236, -3593.8837220401488, -3233.449173608867, -1190.6541508653247, -4269.671800612776, -2094.8559318924845, -3098.1591076141003, -2612.2398121746305, -2621.8446788855076, -3189.1416679241365, -3326.8669592311394, -2520.0693293545237, -4090.53201604083, -3897.3525759738886, -3882.617196735531, -2733.277727960293, -3138.2911688298723, -3557.141080011089, -3532.128694408572, -3204.211494391132, -2982.401478808507, -1643.9344403675034, -3028.1103539431856, -3051.313338417169, -3214.597869668411, -3422.0559099491825, -2354.1606076213016, -2161.5093790583437, -3000.782613700695, -4421.759237366733, -2926.163181839848, -4236.389905667763, -2853.0912185470906, -1916.0216050161687, -1349.4734333039323, -2729.5321061603227, -2923.0859708979733, -2707.932887212673, -3541.4065768074715, -3230.147692573738, -3416.0034237856617, -1454.598685522833, -5160.975581327425, -1994.9989485416418, -2100.8972965888097, -2744.8752560486932, -3028.505138326518], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-675.1165329903555, -231.27110947979534, -540.0112453884822, -86.8205959004917, -704.4505079115605, -1123.509940407238, -154.82987776883976, -207.5319533855516, -504.3237545831754, -1040.690033032913, -914.2604526808209, -676.2657123714126, -1169.062510687903, -899.5623999820062, -44.96836712313488, -474.07330258602605, -583.8426764756291, -294.27304511080547, -1066.0157847840567, -996.6803994732257, -488.94605248429883, -295.4861298463657, -749.1281543150872, -1153.2137967236054, -962.5930161811539, -1312.6989829722618, -519.1958867673076, -317.6988952744892, -248.42971809970646, -1046.5037957087873, -1369.8274309660299, -1021.8432946620468, -780.0102924837511, -677.0904583907451, -58.640724104412776, -126.49853248216729, -467.6923584402191, -296.0867807803804, -68.08881606958462, -175.44162550240708, -296.93213477120474, -1164.8575059524742, -678.4372202161948, -1347.4124411711402, -920.7127431286158, -1238.3081681260746, -910.8861081474345, -261.75588536232414, -1131.5203047032494, -164.50928405672903, -1252.690941835231, -428.55567373562866, -231.60893845799282, -740.4437052650791, -76.2077680659854, -668.537666059167, -863.509449467108, -181.0544723921031, -100.23835457235484, -347.16898684090046, -1264.9715078051565, -359.10115147970146, -930.694359660743, -511.2556463356424, -99.81702468490289, -664.9472042358818, -913.3460084663171, -643.280729933282, -1099.0749781692996, -116.3215058404258, -784.3849180323729, -1253.678623058902, -440.43854515062804, -864.1898032301964, -603.5933711473626, -17.734151113728686, -559.8638582572678, -667.4965384121853, -1048.2921882670112, -651.8086051590229, -1045.5353845332756, -803.3827703958714, -482.3969565222982, -575.0206573634612, -606.8111843664861, -321.54366521263285, -898.8293331936313, -664.530751254669, -242.413875176922, -457.7403318843341, -893.246664081823, -476.3664656652944, -696.2403239203277, -1084.9518620751423, -305.3158664287936, -582.787334406698, -632.96242808466, -1022.7931321925117, -688.541144617672, -694.0807703870686, -112.77323982970175, -379.76709824515467, -1182.003938855263, -187.3756685689758, -27.868108951534996, -687.3735151288192, -16.61224520741028, -606.7497765673471, -1000.0664379295919, -809.8614114130837, -139.37814080118383, -537.3731148539588, -1102.567938029835, -937.2682211801908, -87.06970256104893, -494.1258483400841, -404.14619490234435, -494.9813123952843, -532.5175239090478, -187.20464670274256, -972.4299381323315, -477.3206827998881, -897.3227628849322, -553.4038909310483, -67.67409819090071, -1041.0027880911048, -1017.0667845525589, -1397.2747641527612, -843.1232514837848, -113.26772332336793, -722.9093758838818, -1305.9599157236507, -845.3620859981941, -1038.5044179701235, -171.93176197132365, -1322.9535985188938, -11.433790660705219, -318.50443303762376, -306.16847984020814, -1159.17166434215, -516.9884062538886, -161.6547539490081, -120.46676102051734, -148.3757983841053, -658.7663317061606, -17.0400684702034, -604.7094926248955, -682.4963198644031, -573.4015367282952, -842.1780462265737, -507.64143801567093, -128.407386140177, -1424.2850799047685, -1260.0583436601407, -939.449959955736, -835.396038139337, -782.4047557572139, -111.67496613506191, -837.6032686195161, -746.8830162963833, -53.8608228210125, -42.6169491928421, -645.0186164004671, -1280.1612143648902, -317.2868419959743, -793.630528453614, -1051.4917773677948, -477.912073069951, -825.8600892627879, -523.9153444660503, -720.2045302448456, -206.37939376313903, -1362.654437528809, -1027.9991676047882, -437.11053675589403, -238.8815855941133, -394.0758125919718, -1069.1300107650252, -255.17653033634798, -484.79387608346383, -715.3874914735741, -574.8243652833382, -468.0937914979504, -1214.186062459175, -680.1058881521406, -485.04759574755656, -792.8553811836684, -146.14561254227021, -1139.7424552683597, -731.0928801754105, -668.278743237154, -1299.4152467666609, -407.45264738343485, -762.1264452582967, -995.2958119796162, -255.4931551426761, -595.8230666430063, -1004.2058175783864, -0.3972758683100436, -1217.8861449300844, -753.8379014486617, -605.6515281330478, -632.2003982501145, -214.65351755219191, -1077.690794232278, -836.6076920128844, -1017.1618866107657, -562.4152315243113, -427.9055450275583, -1419.463194703271, -1395.4962009634307, -283.10441387486526, -1240.3373036892838, -765.8111639925011, -44.420268187365174, -1167.6091089644056, -309.98060076908075, -506.84335869165153, -745.0311128017544, -643.5737634722476, -889.9604035198571, -254.48157968465287, -775.159232599651, -573.1980597511829, -784.5736067063175, -381.82887754530515, -1139.4121649602484, -208.94582456152634, -1227.245894639495, -28.012262599908688, -212.3594354636747, -235.42739702386848, -1059.8662191613425, -742.2958111075244, -29.581477292104413, -635.3596567583727, -45.55048724162732, -120.59479471524153, -1248.2813533435674, -1201.6226467537763, -924.6252911025114, -1267.864610922638, -535.7838778362858, -103.31844778798636, -22.06173114709553, -465.3293013633409, -610.4980294326292, -243.8112921670259, -926.0713434725504, -84.94426807446581, -805.4292306870917, -158.82717075635034, -778.2144136791584, -44.66716231862586, -342.81404577856915, -589.9340076348985, -570.1286337493992, -64.05556670589985, -767.3572162923368, -1097.8204418582216, -1128.0815016316565, -642.30905634089, -224.10264035770913, -541.8023197167081, -779.3472359592375, -1059.497331042989, -796.6308338814774, -614.8794720215521, -38.85919563467383, -1214.825148155545, -409.12299382272295, -515.4275876295544, -1131.6145946362021, -816.0531819103434, -721.6653640413269, -800.5541075086437, -990.689020050235, -493.19983750131996, -195.29333364501503, -753.7128749036491, -187.70517273836268, -79.78046330771146, -678.6812104237924, -206.79840935790068, -37.68889503755919, -490.1711553880554, -1353.9300562523445, -781.732569105322, -472.09382809246387, -1171.74419177459, -207.62506824309435, -1191.0682159844105, -65.90403361688996, -340.49962314512726, -289.758990902962, -1042.1649645640775, -510.01443030390624, -955.1848384270144, -194.00945521364608, -396.78541910545897, -125.975186610605, -92.48306342599713, -1262.6651048835815, -1059.864062502472, -71.25239475197361, -278.5600735458899, -412.98066951929314, -885.8926058992615, -960.1609934444376, -84.25033647662686, -69.04730301692241, -13.697733420902088, -1393.4210897633866, -592.6057681530754, -1120.3697735698506, -269.6283512841584, -616.3107813267765, -1219.052178269241, -591.7904871666835, -630.0851611842784, -432.1939847152566, -365.7824729860017, -839.9426195151831, -533.398487854385, -348.7517642836979, -1240.1758574732353, -197.1500157528425, -1270.4369047860237, -490.95469587536905, -891.814542153362, -817.121627248991, -919.9008429685274, -684.5613277739011, -442.98733232616536, -1032.7814456562978, -811.0239901289822, -710.2026582734312, -1075.2908859154347, -714.3256464602063, -571.7740159574757, -482.83770462832877, -622.5402948321505, -755.7543840498103, -546.9433379898877, -325.2020064601151, -662.0737366354338, -498.2698172962889, -1255.2464258201471, -245.90834858757293, -476.79284049042917, -755.2512340162299, -784.663181128685, -838.439122970943, -729.2084639648882, -449.5790779303461, -671.8082067798548, -469.80166811617914, -1069.557388626419, -699.3557559355934, -621.6056749505266, -953.1474779932526, -966.7483917000961, -652.7585336862703, -187.37239999760783, -444.18469101390474, -588.1130063393441, -1276.925193358486, -171.19350647994088, -418.19959176321055, -527.9701808675256, -107.93411193849605, -207.2472561032931, -749.9519972746872, -144.95245057561482, -433.84862447541127, -618.9879572543593, -974.0001739983662, -717.775304732862, -345.98890082959986, -371.3580171279966, -57.00016179622511, -206.2532958522366, -929.1753101210808, -1377.7814163701778, -481.10315427744735, -821.3683303730264, -474.5853089277017, -500.6533208096509, -858.2403299231768, -559.7505796348541, -13.83874048632876, -570.3199583211599, -908.1645638741727, -492.40266761071314, -1437.329979656808, -1008.2311488026023, -95.71315444412393, -238.8771097212227, -269.0212642321254, -742.3179304212274, -84.86631904723681, -922.9870577736178, -754.3167524882633, -44.96350042679342, -354.3757493224331, -137.9860833935836, -562.4592988609347, -282.32812622313907, -1114.0985197960918, -903.9105854269459, -707.0906990125775, -1118.7052175797699, -507.71903407364056, -1336.6271581661151, -751.61712853463, -340.67474598500644, -1300.3789987843973, -696.6100050079293, -414.1916535707377, -174.3077784917751, -924.2637359855207, -657.1437738199356, -998.1378953574555, -396.74187762797317, -1260.1026228768785, -700.8228495406352, -445.3179432360418, -672.4749338469305, -161.22840367467347, -873.2470882488128, -238.0941724181712, -174.11003739336996, -474.74971230178653, -92.53608696750749, -936.5315959353347, -324.1638771387755, -569.6871746013722, -30.670847589808957, -227.5882580779952, -197.36327589598025, -285.72909581458026, -481.29603432867776, -613.8633772279288, -988.2564634761882, -360.38713531294735, -46.78396044720911, -395.0011248940131, -930.1415359449502, -1053.9081152964538, -497.25123431534615, -848.4525505226297, -406.97216529839073, -309.53299533373036, -1047.6735525126253, -95.30162354529614, -313.2706219615549, -1123.6486782630345, -112.90060151024797, -1301.1588169597055, -690.4278581129315, -798.1875854974403, -1128.023045059487, -705.0934794933047, -124.6324778508224, -474.2111046726814, -642.4913832587613, -1227.8071293639944, -366.902936742413, -773.0667912705741, -405.73518314991776, -452.92706859189224, -222.58721414319479, -545.0210011538685, -116.6099638166456, -117.45343781723268, -1130.032054731988, -957.2904958692842, -910.7867958320195, -949.1982155429876, -1213.6680193511506, -325.72287612422355, -1136.7956124832792, -258.709680771059, -134.31318784599821, -139.45759131708132, -647.4054300103658, -325.787481579862, -660.1389337508058, -416.828377043989, -50.737074203785944, -729.4815807100396, -336.729738214078, -163.277454438906, -495.22868317907415, -1020.157799506594, -1054.5822617743793, -522.4774397322586, -594.430307840826, -93.56403439778032, -763.4510945812787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6169254784606486, "mean_inference_ms": 1.7348561247939545, "mean_action_processing_ms": 0.875672004385916, "mean_env_wait_ms": 10.859867783262539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01501011848449707, "StateBufferConnector_ms": 0.011296749114990234, "ViewRequirementAgentConnector_ms": 0.42076969146728516}, "num_episodes": 20, "episode_return_max": -1133.8081132747582, "episode_return_min": -5160.975581327425, "episode_return_mean": -3082.381278083226, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 582690, "num_agent_steps_trained": 582690, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 86.73843662456319, "num_env_steps_trained_throughput_per_sec": 86.73843662456319, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 582690, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 582690, "timers": {"training_iteration_time_ms": 50391.557, "restore_workers_time_ms": 0.025, "training_step_time_ms": 50391.488, "sample_time_ms": 3423.342, "learn_time_ms": 46910.262, "learn_throughput": 85.269, "synch_weights_time_ms": 54.751}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 582690, "num_agent_steps_trained": 582690}, "done": false, "training_iteration": 32, "trial_id": "05c72_00000", "date": "2024-07-26_15-10-57", "timestamp": 1721986857, "time_this_iter_s": 46.12540102005005, "time_total_s": 1678.1185867786407, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805abb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1678.1185867786407, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 12.719999999999997, "ram_util_percent": 32.233846153846166}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 170.9401374251754, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.003198885490865, "policy_loss": 0.0012050483258510076, "vf_loss": 5.016937891612818, "vf_explained_var": 0.9826574044315903, "kl": 0.019496135624918948, "entropy": 2.152400788054054, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.11111111111111, "num_grad_updates_lifetime": 139125.5, "diff_num_grad_updates_vs_sampler_policy": 2024.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 599850, "num_agent_steps_trained": 599850}, "env_runners": {"episode_reward_max": -846.6102952183403, "episode_reward_min": -5160.975581327425, "episode_reward_mean": -2807.1338317720465, "episode_len_mean": 149.54, "episode_media": {}, "episodes_timesteps_total": 14954, "policy_reward_min": {"policy_0": -1521.2723548944587}, "policy_reward_max": {"policy_0": -2.075901374179056}, "policy_reward_mean": {"policy_0": -561.4267663544093}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3284.0341396162985, -4263.553549878794, -3729.169350707446, -3373.0379446991415, -3277.3728822616636, -2985.445024306483, -2279.5303400485145, -3251.408938812587, -2853.6539587965167, -2330.6542345100124, -2129.952023219795, -3089.2958662407564, -3315.642754006203, -3724.691980736236, -3593.8837220401488, -3233.449173608867, -1190.6541508653247, -4269.671800612776, -2094.8559318924845, -3098.1591076141003, -2612.2398121746305, -2621.8446788855076, -3189.1416679241365, -3326.8669592311394, -2520.0693293545237, -4090.53201604083, -3897.3525759738886, -3882.617196735531, -2733.277727960293, -3138.2911688298723, -3557.141080011089, -3532.128694408572, -3204.211494391132, -2982.401478808507, -1643.9344403675034, -3028.1103539431856, -3051.313338417169, -3214.597869668411, -3422.0559099491825, -2354.1606076213016, -2161.5093790583437, -3000.782613700695, -4421.759237366733, -2926.163181839848, -4236.389905667763, -2853.0912185470906, -1916.0216050161687, -1349.4734333039323, -2729.5321061603227, -2923.0859708979733, -2707.932887212673, -3541.4065768074715, -3230.147692573738, -3416.0034237856617, -1454.598685522833, -5160.975581327425, -1994.9989485416418, -2100.8972965888097, -2744.8752560486932, -3028.505138326518, -2876.4463091055727, -2476.683903861568, -2786.862204528606, -2070.640355145814, -3099.49140614835, -2811.6605307897216, -1479.2538979756155, -2759.4937068268564, -1923.3401971509036, -3474.8460831875145, -1715.5525333358628, -846.6102952183403, -2481.663947024207, -2428.7226675099464, -1919.211830294173, -2187.86114463177, -2598.9868383167045, -2810.119708208721, -1129.6833201571196, -1776.094480543686, -3259.450206157849, -2312.4852043033015, -3637.1121463370428, -2928.0499885899912, -3058.931535165381, -2585.7649302567866, -2310.6559206063894, -3607.475825042761, -2884.7290867770394, -2434.852420157845, -2055.5656450791685, -2358.358560192267, -2018.817126576634, -3417.468736214672, -2866.6104528495785, -2453.503883364277, -4047.6249791361993, -1584.5230860904378, -2438.5296339300894, -1531.0930369509892], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-753.8379014486617, -605.6515281330478, -632.2003982501145, -214.65351755219191, -1077.690794232278, -836.6076920128844, -1017.1618866107657, -562.4152315243113, -427.9055450275583, -1419.463194703271, -1395.4962009634307, -283.10441387486526, -1240.3373036892838, -765.8111639925011, -44.420268187365174, -1167.6091089644056, -309.98060076908075, -506.84335869165153, -745.0311128017544, -643.5737634722476, -889.9604035198571, -254.48157968465287, -775.159232599651, -573.1980597511829, -784.5736067063175, -381.82887754530515, -1139.4121649602484, -208.94582456152634, -1227.245894639495, -28.012262599908688, -212.3594354636747, -235.42739702386848, -1059.8662191613425, -742.2958111075244, -29.581477292104413, -635.3596567583727, -45.55048724162732, -120.59479471524153, -1248.2813533435674, -1201.6226467537763, -924.6252911025114, -1267.864610922638, -535.7838778362858, -103.31844778798636, -22.06173114709553, -465.3293013633409, -610.4980294326292, -243.8112921670259, -926.0713434725504, -84.94426807446581, -805.4292306870917, -158.82717075635034, -778.2144136791584, -44.66716231862586, -342.81404577856915, -589.9340076348985, -570.1286337493992, -64.05556670589985, -767.3572162923368, -1097.8204418582216, -1128.0815016316565, -642.30905634089, -224.10264035770913, -541.8023197167081, -779.3472359592375, -1059.497331042989, -796.6308338814774, -614.8794720215521, -38.85919563467383, -1214.825148155545, -409.12299382272295, -515.4275876295544, -1131.6145946362021, -816.0531819103434, -721.6653640413269, -800.5541075086437, -990.689020050235, -493.19983750131996, -195.29333364501503, -753.7128749036491, -187.70517273836268, -79.78046330771146, -678.6812104237924, -206.79840935790068, -37.68889503755919, -490.1711553880554, -1353.9300562523445, -781.732569105322, -472.09382809246387, -1171.74419177459, -207.62506824309435, -1191.0682159844105, -65.90403361688996, -340.49962314512726, -289.758990902962, -1042.1649645640775, -510.01443030390624, -955.1848384270144, -194.00945521364608, -396.78541910545897, -125.975186610605, -92.48306342599713, -1262.6651048835815, -1059.864062502472, -71.25239475197361, -278.5600735458899, -412.98066951929314, -885.8926058992615, -960.1609934444376, -84.25033647662686, -69.04730301692241, -13.697733420902088, -1393.4210897633866, -592.6057681530754, -1120.3697735698506, -269.6283512841584, -616.3107813267765, -1219.052178269241, -591.7904871666835, -630.0851611842784, -432.1939847152566, -365.7824729860017, -839.9426195151831, -533.398487854385, -348.7517642836979, -1240.1758574732353, -197.1500157528425, -1270.4369047860237, -490.95469587536905, -891.814542153362, -817.121627248991, -919.9008429685274, -684.5613277739011, -442.98733232616536, -1032.7814456562978, -811.0239901289822, -710.2026582734312, -1075.2908859154347, -714.3256464602063, -571.7740159574757, -482.83770462832877, -622.5402948321505, -755.7543840498103, -546.9433379898877, -325.2020064601151, -662.0737366354338, -498.2698172962889, -1255.2464258201471, -245.90834858757293, -476.79284049042917, -755.2512340162299, -784.663181128685, -838.439122970943, -729.2084639648882, -449.5790779303461, -671.8082067798548, -469.80166811617914, -1069.557388626419, -699.3557559355934, -621.6056749505266, -953.1474779932526, -966.7483917000961, -652.7585336862703, -187.37239999760783, -444.18469101390474, -588.1130063393441, -1276.925193358486, -171.19350647994088, -418.19959176321055, -527.9701808675256, -107.93411193849605, -207.2472561032931, -749.9519972746872, -144.95245057561482, -433.84862447541127, -618.9879572543593, -974.0001739983662, -717.775304732862, -345.98890082959986, -371.3580171279966, -57.00016179622511, -206.2532958522366, -929.1753101210808, -1377.7814163701778, -481.10315427744735, -821.3683303730264, -474.5853089277017, -500.6533208096509, -858.2403299231768, -559.7505796348541, -13.83874048632876, -570.3199583211599, -908.1645638741727, -492.40266761071314, -1437.329979656808, -1008.2311488026023, -95.71315444412393, -238.8771097212227, -269.0212642321254, -742.3179304212274, -84.86631904723681, -922.9870577736178, -754.3167524882633, -44.96350042679342, -354.3757493224331, -137.9860833935836, -562.4592988609347, -282.32812622313907, -1114.0985197960918, -903.9105854269459, -707.0906990125775, -1118.7052175797699, -507.71903407364056, -1336.6271581661151, -751.61712853463, -340.67474598500644, -1300.3789987843973, -696.6100050079293, -414.1916535707377, -174.3077784917751, -924.2637359855207, -657.1437738199356, -998.1378953574555, -396.74187762797317, -1260.1026228768785, -700.8228495406352, -445.3179432360418, -672.4749338469305, -161.22840367467347, -873.2470882488128, -238.0941724181712, -174.11003739336996, -474.74971230178653, -92.53608696750749, -936.5315959353347, -324.1638771387755, -569.6871746013722, -30.670847589808957, -227.5882580779952, -197.36327589598025, -285.72909581458026, -481.29603432867776, -613.8633772279288, -988.2564634761882, -360.38713531294735, -46.78396044720911, -395.0011248940131, -930.1415359449502, -1053.9081152964538, -497.25123431534615, -848.4525505226297, -406.97216529839073, -309.53299533373036, -1047.6735525126253, -95.30162354529614, -313.2706219615549, -1123.6486782630345, -112.90060151024797, -1301.1588169597055, -690.4278581129315, -798.1875854974403, -1128.023045059487, -705.0934794933047, -124.6324778508224, -474.2111046726814, -642.4913832587613, -1227.8071293639944, -366.902936742413, -773.0667912705741, -405.73518314991776, -452.92706859189224, -222.58721414319479, -545.0210011538685, -116.6099638166456, -117.45343781723268, -1130.032054731988, -957.2904958692842, -910.7867958320195, -949.1982155429876, -1213.6680193511506, -325.72287612422355, -1136.7956124832792, -258.709680771059, -134.31318784599821, -139.45759131708132, -647.4054300103658, -325.787481579862, -660.1389337508058, -416.828377043989, -50.737074203785944, -729.4815807100396, -336.729738214078, -163.277454438906, -495.22868317907415, -1020.157799506594, -1054.5822617743793, -522.4774397322586, -594.430307840826, -93.56403439778032, -763.4510945812787, -72.21063647533992, -841.4112342308182, -1241.708340610136, -691.2348196658089, -29.881278123470835, -893.7765335387996, -121.47996609991453, -76.07479637975742, -497.1120590168453, -888.2405488262482, -647.9670786935405, -539.5744973179004, -251.15656332674985, -1070.37587762378, -277.78818756663384, -56.20276101254845, -456.48600159571544, -880.9110169171267, -90.93816598365495, -586.1024096367668, -573.5935563050261, -100.39673218365246, -1077.6436420480222, -22.614456183109112, -1325.2430194285398, -359.91462738112386, -74.07106171742774, -1316.8941279402602, -365.4466315843007, -695.3340821666086, -347.87273955126966, -192.46370399376914, -87.3596076857757, -380.1782714742223, -471.3795752705786, -344.6570910752766, -1162.2993431698626, -936.2418247781789, -141.29833110144708, -174.99711670209075, -458.24741914238245, -70.26891485867837, -69.77904857956548, -259.6311546222944, -1065.4136599479828, -43.393383743238715, -1323.0101797183272, -1203.1300942100052, -293.8810962191461, -611.4313292968001, -44.59645556666285, -469.6080872488974, -301.52699007892306, -243.4359943495652, -656.3850060918163, -254.05511265219272, -154.54124087301926, -89.63173706854518, -241.61303481732713, -106.76916980725628, -404.7092187362351, -234.30333438630547, -53.499486485157455, -526.2112719549149, -1262.940635461594, -52.44453179140897, -460.0354280637582, -716.6588088473296, -821.5504299887776, -378.0334688186698, -154.16854346868277, -341.6717204594037, -605.10473039752, -6.484633961686758, -811.7822020068775, -288.52367041248215, -1076.8027622349996, -193.43886852263006, -65.00397194548155, -564.0918715161762, -52.08493277107814, -504.01303397656307, -1120.5331761984687, -862.7691672842291, -59.586528086365604, -275.80703177059434, -680.2636447294101, -305.90276035304635, -1029.7930805356132, -518.3531908200554, -237.52560237071464, -214.0457560231739, -4.670581708931742, -547.2144588183914, -126.22692123590791, -724.0034089668849, -156.02736699597716, -353.3854147032384, -279.6202265479935, -263.058063329591, -583.2349319587045, -390.83617000019586, -180.51581993787903, -1133.7837995963766, -971.079484664693, -153.08649468960232, -172.54855323008383, -657.3927921568782, -796.3168244397827, -533.1405397869556, -540.6375080189124, -1521.2723548944587, -516.7500336033286, -628.1145136403516, -430.33773617998946, -503.70530329626894, -330.77990139553987, -975.69676974111, -720.2561743297675, -397.611839827303, -899.0627942682091, -1326.9968980633228, -330.65894574479427, -216.86759988541417, -285.3452972036384, -158.82013966484507, -1081.5551496404496, -293.5575580188322, -851.7621913141536, -200.0698916185071, -345.15108495620217, -99.99832036554126, -1273.8573831075405, -472.87242646262206, -118.77670571448289, -730.8672242598412, -733.7440068792865, -988.1203475669246, -310.5204354199158, -844.2238109167957, -809.6949473928862, -764.1292209814741, -470.88691925236304, -168.06894786351378, -671.9490512868032, -215.96689117809134, -1020.4868185765158, -421.78534054255005, -740.1730415928353, -36.440328267853886, -137.11164475353291, -1041.1042724749957, -761.5882119039377, -80.03800235038143, -35.723513596322434, -993.9136589334851, -173.70283334028315, -2.845093473638789, -897.141513128497, -290.75546131636247, -140.56446662007522, -420.9827333453538, -184.59977370769982, -1064.5820872863417, -208.0880656171646, -994.3769029993125, -446.90578536695176, -340.463407604843, -972.930668466314, -662.7919717772486, -586.7003536419784, -1024.9067373972375, -313.83227593501863, -917.9948346477894, -23.17625122755379, -175.1967044042702, -321.72815218002404, -441.6252305129857, -1376.0646112706083, -138.88918499638842, -1327.829542230307, -950.5759750844934, -455.24561861829875, -1196.2935072000628, -117.68033600303363, -280.51556225399463, -233.23091093138837, -566.127273541084, -2.075901374179056, -502.5734379897926, -138.04788889455003, -590.6177361857532, -570.8675708592398, -672.3132077770106, -466.6832302135386, -311.67681508231294, -440.7432109078406, -439.6896234290247, -162.56257720274783, -176.42081032906435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6150734326832574, "mean_inference_ms": 1.7365505357913493, "mean_action_processing_ms": 0.8746303356242692, "mean_env_wait_ms": 10.860337748366701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013757467269897461, "StateBufferConnector_ms": 0.010146379470825195, "ViewRequirementAgentConnector_ms": 0.36743927001953125}, "num_episodes": 40, "episode_return_max": -846.6102952183403, "episode_return_min": -5160.975581327425, "episode_return_mean": -2807.1338317720465, "episodes_this_iter": 40}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 599850, "num_agent_steps_trained": 599850, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.5670884410572, "num_env_steps_trained_throughput_per_sec": 89.5670884410572, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 599850, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 599850, "timers": {"training_iteration_time_ms": 49701.364, "restore_workers_time_ms": 0.025, "training_step_time_ms": 49701.297, "sample_time_ms": 3389.789, "learn_time_ms": 46254.631, "learn_throughput": 86.478, "synch_weights_time_ms": 53.804}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 599850, "num_agent_steps_trained": 599850}, "done": false, "training_iteration": 33, "trial_id": "05c72_00000", "date": "2024-07-26_15-11-42", "timestamp": 1721986902, "time_this_iter_s": 44.6701934337616, "time_total_s": 1722.7887802124023, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e5c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1722.7887802124023, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 14.931746031746032, "ram_util_percent": 32.76984126984128}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 173.85175509222287, "cur_kl_coeff": 0.33750000000000013, "cur_lr": 0.0010000000000000005, "total_loss": 5.187946264495073, "policy_loss": -0.0014932575735735112, "vf_loss": 5.205010732014974, "vf_explained_var": 0.9797410542121674, "kl": 0.017539161864227364, "entropy": 2.1490675625303624, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.22900763358778, "num_grad_updates_lifetime": 143115.5, "diff_num_grad_updates_vs_sampler_policy": 1964.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 616517, "num_agent_steps_trained": 616517}, "env_runners": {"episode_reward_max": -846.6102952183403, "episode_reward_min": -5160.975581327425, "episode_reward_mean": -2728.1649698356005, "episode_len_mean": 149.32, "episode_media": {}, "episodes_timesteps_total": 14932, "policy_reward_min": {"policy_0": -1521.2723548944587}, "policy_reward_max": {"policy_0": -2.075901374179056}, "policy_reward_mean": {"policy_0": -545.6329939671201}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2612.2398121746305, -2621.8446788855076, -3189.1416679241365, -3326.8669592311394, -2520.0693293545237, -4090.53201604083, -3897.3525759738886, -3882.617196735531, -2733.277727960293, -3138.2911688298723, -3557.141080011089, -3532.128694408572, -3204.211494391132, -2982.401478808507, -1643.9344403675034, -3028.1103539431856, -3051.313338417169, -3214.597869668411, -3422.0559099491825, -2354.1606076213016, -2161.5093790583437, -3000.782613700695, -4421.759237366733, -2926.163181839848, -4236.389905667763, -2853.0912185470906, -1916.0216050161687, -1349.4734333039323, -2729.5321061603227, -2923.0859708979733, -2707.932887212673, -3541.4065768074715, -3230.147692573738, -3416.0034237856617, -1454.598685522833, -5160.975581327425, -1994.9989485416418, -2100.8972965888097, -2744.8752560486932, -3028.505138326518, -2876.4463091055727, -2476.683903861568, -2786.862204528606, -2070.640355145814, -3099.49140614835, -2811.6605307897216, -1479.2538979756155, -2759.4937068268564, -1923.3401971509036, -3474.8460831875145, -1715.5525333358628, -846.6102952183403, -2481.663947024207, -2428.7226675099464, -1919.211830294173, -2187.86114463177, -2598.9868383167045, -2810.119708208721, -1129.6833201571196, -1776.094480543686, -3259.450206157849, -2312.4852043033015, -3637.1121463370428, -2928.0499885899912, -3058.931535165381, -2585.7649302567866, -2310.6559206063894, -3607.475825042761, -2884.7290867770394, -2434.852420157845, -2055.5656450791685, -2358.358560192267, -2018.817126576634, -3417.468736214672, -2866.6104528495785, -2453.503883364277, -4047.6249791361993, -1584.5230860904378, -2438.5296339300894, -1531.0930369509892, -3602.9060711050633, -2113.972696485754, -1571.4970642186672, -2583.3619712256204, -994.8120629768202, -2661.5963066817867, -1826.664120810313, -2427.304562963788, -4097.545090643092, -3166.9768901271395, -3612.3215288209053, -4442.650514604115, -2215.106321657228, -1422.3651113169424, -2239.8597894636187, -3585.482954469469, -3052.807455659284, -2554.777899120074, -3302.4467045475403, -1996.7755639323111], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-125.975186610605, -92.48306342599713, -1262.6651048835815, -1059.864062502472, -71.25239475197361, -278.5600735458899, -412.98066951929314, -885.8926058992615, -960.1609934444376, -84.25033647662686, -69.04730301692241, -13.697733420902088, -1393.4210897633866, -592.6057681530754, -1120.3697735698506, -269.6283512841584, -616.3107813267765, -1219.052178269241, -591.7904871666835, -630.0851611842784, -432.1939847152566, -365.7824729860017, -839.9426195151831, -533.398487854385, -348.7517642836979, -1240.1758574732353, -197.1500157528425, -1270.4369047860237, -490.95469587536905, -891.814542153362, -817.121627248991, -919.9008429685274, -684.5613277739011, -442.98733232616536, -1032.7814456562978, -811.0239901289822, -710.2026582734312, -1075.2908859154347, -714.3256464602063, -571.7740159574757, -482.83770462832877, -622.5402948321505, -755.7543840498103, -546.9433379898877, -325.2020064601151, -662.0737366354338, -498.2698172962889, -1255.2464258201471, -245.90834858757293, -476.79284049042917, -755.2512340162299, -784.663181128685, -838.439122970943, -729.2084639648882, -449.5790779303461, -671.8082067798548, -469.80166811617914, -1069.557388626419, -699.3557559355934, -621.6056749505266, -953.1474779932526, -966.7483917000961, -652.7585336862703, -187.37239999760783, -444.18469101390474, -588.1130063393441, -1276.925193358486, -171.19350647994088, -418.19959176321055, -527.9701808675256, -107.93411193849605, -207.2472561032931, -749.9519972746872, -144.95245057561482, -433.84862447541127, -618.9879572543593, -974.0001739983662, -717.775304732862, -345.98890082959986, -371.3580171279966, -57.00016179622511, -206.2532958522366, -929.1753101210808, -1377.7814163701778, -481.10315427744735, -821.3683303730264, -474.5853089277017, -500.6533208096509, -858.2403299231768, -559.7505796348541, -13.83874048632876, -570.3199583211599, -908.1645638741727, -492.40266761071314, -1437.329979656808, -1008.2311488026023, -95.71315444412393, -238.8771097212227, -269.0212642321254, -742.3179304212274, -84.86631904723681, -922.9870577736178, -754.3167524882633, -44.96350042679342, -354.3757493224331, -137.9860833935836, -562.4592988609347, -282.32812622313907, -1114.0985197960918, -903.9105854269459, -707.0906990125775, -1118.7052175797699, -507.71903407364056, -1336.6271581661151, -751.61712853463, -340.67474598500644, -1300.3789987843973, -696.6100050079293, -414.1916535707377, -174.3077784917751, -924.2637359855207, -657.1437738199356, -998.1378953574555, -396.74187762797317, -1260.1026228768785, -700.8228495406352, -445.3179432360418, -672.4749338469305, -161.22840367467347, -873.2470882488128, -238.0941724181712, -174.11003739336996, -474.74971230178653, -92.53608696750749, -936.5315959353347, -324.1638771387755, -569.6871746013722, -30.670847589808957, -227.5882580779952, -197.36327589598025, -285.72909581458026, -481.29603432867776, -613.8633772279288, -988.2564634761882, -360.38713531294735, -46.78396044720911, -395.0011248940131, -930.1415359449502, -1053.9081152964538, -497.25123431534615, -848.4525505226297, -406.97216529839073, -309.53299533373036, -1047.6735525126253, -95.30162354529614, -313.2706219615549, -1123.6486782630345, -112.90060151024797, -1301.1588169597055, -690.4278581129315, -798.1875854974403, -1128.023045059487, -705.0934794933047, -124.6324778508224, -474.2111046726814, -642.4913832587613, -1227.8071293639944, -366.902936742413, -773.0667912705741, -405.73518314991776, -452.92706859189224, -222.58721414319479, -545.0210011538685, -116.6099638166456, -117.45343781723268, -1130.032054731988, -957.2904958692842, -910.7867958320195, -949.1982155429876, -1213.6680193511506, -325.72287612422355, -1136.7956124832792, -258.709680771059, -134.31318784599821, -139.45759131708132, -647.4054300103658, -325.787481579862, -660.1389337508058, -416.828377043989, -50.737074203785944, -729.4815807100396, -336.729738214078, -163.277454438906, -495.22868317907415, -1020.157799506594, -1054.5822617743793, -522.4774397322586, -594.430307840826, -93.56403439778032, -763.4510945812787, -72.21063647533992, -841.4112342308182, -1241.708340610136, -691.2348196658089, -29.881278123470835, -893.7765335387996, -121.47996609991453, -76.07479637975742, -497.1120590168453, -888.2405488262482, -647.9670786935405, -539.5744973179004, -251.15656332674985, -1070.37587762378, -277.78818756663384, -56.20276101254845, -456.48600159571544, -880.9110169171267, -90.93816598365495, -586.1024096367668, -573.5935563050261, -100.39673218365246, -1077.6436420480222, -22.614456183109112, -1325.2430194285398, -359.91462738112386, -74.07106171742774, -1316.8941279402602, -365.4466315843007, -695.3340821666086, -347.87273955126966, -192.46370399376914, -87.3596076857757, -380.1782714742223, -471.3795752705786, -344.6570910752766, -1162.2993431698626, -936.2418247781789, -141.29833110144708, -174.99711670209075, -458.24741914238245, -70.26891485867837, -69.77904857956548, -259.6311546222944, -1065.4136599479828, -43.393383743238715, -1323.0101797183272, -1203.1300942100052, -293.8810962191461, -611.4313292968001, -44.59645556666285, -469.6080872488974, -301.52699007892306, -243.4359943495652, -656.3850060918163, -254.05511265219272, -154.54124087301926, -89.63173706854518, -241.61303481732713, -106.76916980725628, -404.7092187362351, -234.30333438630547, -53.499486485157455, -526.2112719549149, -1262.940635461594, -52.44453179140897, -460.0354280637582, -716.6588088473296, -821.5504299887776, -378.0334688186698, -154.16854346868277, -341.6717204594037, -605.10473039752, -6.484633961686758, -811.7822020068775, -288.52367041248215, -1076.8027622349996, -193.43886852263006, -65.00397194548155, -564.0918715161762, -52.08493277107814, -504.01303397656307, -1120.5331761984687, -862.7691672842291, -59.586528086365604, -275.80703177059434, -680.2636447294101, -305.90276035304635, -1029.7930805356132, -518.3531908200554, -237.52560237071464, -214.0457560231739, -4.670581708931742, -547.2144588183914, -126.22692123590791, -724.0034089668849, -156.02736699597716, -353.3854147032384, -279.6202265479935, -263.058063329591, -583.2349319587045, -390.83617000019586, -180.51581993787903, -1133.7837995963766, -971.079484664693, -153.08649468960232, -172.54855323008383, -657.3927921568782, -796.3168244397827, -533.1405397869556, -540.6375080189124, -1521.2723548944587, -516.7500336033286, -628.1145136403516, -430.33773617998946, -503.70530329626894, -330.77990139553987, -975.69676974111, -720.2561743297675, -397.611839827303, -899.0627942682091, -1326.9968980633228, -330.65894574479427, -216.86759988541417, -285.3452972036384, -158.82013966484507, -1081.5551496404496, -293.5575580188322, -851.7621913141536, -200.0698916185071, -345.15108495620217, -99.99832036554126, -1273.8573831075405, -472.87242646262206, -118.77670571448289, -730.8672242598412, -733.7440068792865, -988.1203475669246, -310.5204354199158, -844.2238109167957, -809.6949473928862, -764.1292209814741, -470.88691925236304, -168.06894786351378, -671.9490512868032, -215.96689117809134, -1020.4868185765158, -421.78534054255005, -740.1730415928353, -36.440328267853886, -137.11164475353291, -1041.1042724749957, -761.5882119039377, -80.03800235038143, -35.723513596322434, -993.9136589334851, -173.70283334028315, -2.845093473638789, -897.141513128497, -290.75546131636247, -140.56446662007522, -420.9827333453538, -184.59977370769982, -1064.5820872863417, -208.0880656171646, -994.3769029993125, -446.90578536695176, -340.463407604843, -972.930668466314, -662.7919717772486, -586.7003536419784, -1024.9067373972375, -313.83227593501863, -917.9948346477894, -23.17625122755379, -175.1967044042702, -321.72815218002404, -441.6252305129857, -1376.0646112706083, -138.88918499638842, -1327.829542230307, -950.5759750844934, -455.24561861829875, -1196.2935072000628, -117.68033600303363, -280.51556225399463, -233.23091093138837, -566.127273541084, -2.075901374179056, -502.5734379897926, -138.04788889455003, -590.6177361857532, -570.8675708592398, -672.3132077770106, -466.6832302135386, -311.67681508231294, -440.7432109078406, -439.6896234290247, -162.56257720274783, -176.42081032906435, -1046.3983835218705, -689.8930103534125, -186.63707906028847, -817.6234723215181, -862.3541258479703, -495.7602709703686, -517.8444181184872, -48.01125546622974, -704.8217667986808, -347.5349851319896, -113.48618489384882, -203.11566490705644, -5.860265071863212, -687.1816119682113, -561.8533373776877, -117.26237582457536, -483.4253617638546, -99.13238403395054, -957.5059810871038, -926.0358685161376, -139.46865556018432, -200.76598835228117, -456.0347131152194, -94.10640137031572, -104.43630457881929, -523.4661801326981, -50.581977412695494, -199.21408023202463, -978.1450844007192, -910.188984503648, -378.18566570934695, -98.67238808174082, -154.0480562745491, -625.9623255051699, -569.7956852395083, -571.6435291574181, -1131.178934233719, -85.93315206235802, -356.50471328008445, -282.0442342302087, -1320.1648243117122, -1018.8035274805038, -1019.4550755327089, -347.68116911725787, -391.44049420090715, -668.9635576036487, -827.1915525062973, -638.0901031132854, -299.14450193184877, -733.5871749720576, -421.83825708459693, -64.5096442195283, -1007.747993173449, -1183.499632902297, -934.7260014410327, -1078.5318831615737, -1280.2626955775186, -420.6318949130221, -1358.4397156381617, -304.784325313836, -801.7717390976376, -571.3461662454055, -757.5879123717291, -38.043779866410844, -46.35672407604245, -142.33305934430481, -87.21508581536469, -325.0133155991885, -858.9430691716974, -8.860581386388414, -1150.6436844330055, -80.46440399474564, -139.2333317662023, -37.521969416784344, -831.9963998528788, -918.9788188665889, -699.9173026774384, -812.6445117831773, -24.279768097769686, -1129.662553044496, -710.755295851256, -1147.1449096293313, -146.24818926347544, -708.6043264275442, -340.0547344876745, -65.49454222330972, -764.6881549088145, -771.9241627378552, -800.1828343232655, -152.48820492682856, -668.3971343267783, -281.5764579599457, -285.46112050515825, -922.1261172419094, -1144.8858745137445, -1391.2274323085421, -257.1782129665511, -116.52181603890523, -124.34585044344696, -107.50225217486587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6113748913729302, "mean_inference_ms": 1.7329387457853311, "mean_action_processing_ms": 0.8698615449242483, "mean_env_wait_ms": 10.8269697542208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013779640197753906, "StateBufferConnector_ms": 0.01008749008178711, "ViewRequirementAgentConnector_ms": 0.3599402904510498}, "num_episodes": 20, "episode_return_max": -846.6102952183403, "episode_return_min": -5160.975581327425, "episode_return_mean": -2728.1649698356005, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616517, "num_agent_steps_trained": 616517, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.53762205346604, "num_env_steps_trained_throughput_per_sec": 80.53762205346604, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 616517, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 616517, "timers": {"training_iteration_time_ms": 50322.323, "restore_workers_time_ms": 0.023, "training_step_time_ms": 50322.26, "sample_time_ms": 3402.29, "learn_time_ms": 46862.473, "learn_throughput": 85.356, "synch_weights_time_ms": 54.493}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 616517, "num_agent_steps_trained": 616517}, "done": false, "training_iteration": 34, "trial_id": "05c72_00000", "date": "2024-07-26_15-12-32", "timestamp": 1721986952, "time_this_iter_s": 49.676701068878174, "time_total_s": 1772.4654812812805, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d3c3b28c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1772.4654812812805, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 13.30985915492958, "ram_util_percent": 32.853521126760576}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 159.33730662392708, "cur_kl_coeff": 0.3375, "cur_lr": 0.0010000000000000005, "total_loss": 4.76988153371392, "policy_loss": -0.0013318725790616693, "vf_loss": 4.7877462762886855, "vf_explained_var": 0.9760064016324913, "kl": 0.017153362296184752, "entropy": 2.2322130299353784, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.34108527131782, "num_grad_updates_lifetime": 147015.5, "diff_num_grad_updates_vs_sampler_policy": 1934.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 632944, "num_agent_steps_trained": 632944}, "env_runners": {"episode_reward_max": -846.6102952183403, "episode_reward_min": -5160.975581327425, "episode_reward_mean": -2648.6965337757465, "episode_len_mean": 148.82, "episode_media": {}, "episodes_timesteps_total": 14882, "policy_reward_min": {"policy_0": -1521.2723548944587}, "policy_reward_max": {"policy_0": -2.075901374179056}, "policy_reward_mean": {"policy_0": -529.7393067551491}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.782613700695, -4421.759237366733, -2926.163181839848, -4236.389905667763, -2853.0912185470906, -1916.0216050161687, -1349.4734333039323, -2729.5321061603227, -2923.0859708979733, -2707.932887212673, -3541.4065768074715, -3230.147692573738, -3416.0034237856617, -1454.598685522833, -5160.975581327425, -1994.9989485416418, -2100.8972965888097, -2744.8752560486932, -3028.505138326518, -2876.4463091055727, -2476.683903861568, -2786.862204528606, -2070.640355145814, -3099.49140614835, -2811.6605307897216, -1479.2538979756155, -2759.4937068268564, -1923.3401971509036, -3474.8460831875145, -1715.5525333358628, -846.6102952183403, -2481.663947024207, -2428.7226675099464, -1919.211830294173, -2187.86114463177, -2598.9868383167045, -2810.119708208721, -1129.6833201571196, -1776.094480543686, -3259.450206157849, -2312.4852043033015, -3637.1121463370428, -2928.0499885899912, -3058.931535165381, -2585.7649302567866, -2310.6559206063894, -3607.475825042761, -2884.7290867770394, -2434.852420157845, -2055.5656450791685, -2358.358560192267, -2018.817126576634, -3417.468736214672, -2866.6104528495785, -2453.503883364277, -4047.6249791361993, -1584.5230860904378, -2438.5296339300894, -1531.0930369509892, -3602.9060711050633, -2113.972696485754, -1571.4970642186672, -2583.3619712256204, -994.8120629768202, -2661.5963066817867, -1826.664120810313, -2427.304562963788, -4097.545090643092, -3166.9768901271395, -3612.3215288209053, -4442.650514604115, -2215.106321657228, -1422.3651113169424, -2239.8597894636187, -3585.482954469469, -3052.807455659284, -2554.777899120074, -3302.4467045475403, -1996.7755639323111, -1988.946304686014, -3559.101050277585, -1982.470476387902, -1863.699290586001, -2574.1814854649497, -4576.641584515395, -1042.7638039759586, -2469.1460042223985, -4079.48500710795, -2785.1820438501113, -3357.9589815125337, -2832.50804680336, -3008.8847708362778, -2644.792928511858, -2224.233605929112, -2495.591949958838, -2958.174593857076, -3213.7360451092545, -2104.599518958828, -2215.432363937614, -2239.4243172802776], "episode_lengths": [150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-137.9860833935836, -562.4592988609347, -282.32812622313907, -1114.0985197960918, -903.9105854269459, -707.0906990125775, -1118.7052175797699, -507.71903407364056, -1336.6271581661151, -751.61712853463, -340.67474598500644, -1300.3789987843973, -696.6100050079293, -414.1916535707377, -174.3077784917751, -924.2637359855207, -657.1437738199356, -998.1378953574555, -396.74187762797317, -1260.1026228768785, -700.8228495406352, -445.3179432360418, -672.4749338469305, -161.22840367467347, -873.2470882488128, -238.0941724181712, -174.11003739336996, -474.74971230178653, -92.53608696750749, -936.5315959353347, -324.1638771387755, -569.6871746013722, -30.670847589808957, -227.5882580779952, -197.36327589598025, -285.72909581458026, -481.29603432867776, -613.8633772279288, -988.2564634761882, -360.38713531294735, -46.78396044720911, -395.0011248940131, -930.1415359449502, -1053.9081152964538, -497.25123431534615, -848.4525505226297, -406.97216529839073, -309.53299533373036, -1047.6735525126253, -95.30162354529614, -313.2706219615549, -1123.6486782630345, -112.90060151024797, -1301.1588169597055, -690.4278581129315, -798.1875854974403, -1128.023045059487, -705.0934794933047, -124.6324778508224, -474.2111046726814, -642.4913832587613, -1227.8071293639944, -366.902936742413, -773.0667912705741, -405.73518314991776, -452.92706859189224, -222.58721414319479, -545.0210011538685, -116.6099638166456, -117.45343781723268, -1130.032054731988, -957.2904958692842, -910.7867958320195, -949.1982155429876, -1213.6680193511506, -325.72287612422355, -1136.7956124832792, -258.709680771059, -134.31318784599821, -139.45759131708132, -647.4054300103658, -325.787481579862, -660.1389337508058, -416.828377043989, -50.737074203785944, -729.4815807100396, -336.729738214078, -163.277454438906, -495.22868317907415, -1020.157799506594, -1054.5822617743793, -522.4774397322586, -594.430307840826, -93.56403439778032, -763.4510945812787, -72.21063647533992, -841.4112342308182, -1241.708340610136, -691.2348196658089, -29.881278123470835, -893.7765335387996, -121.47996609991453, -76.07479637975742, -497.1120590168453, -888.2405488262482, -647.9670786935405, -539.5744973179004, -251.15656332674985, -1070.37587762378, -277.78818756663384, -56.20276101254845, -456.48600159571544, -880.9110169171267, -90.93816598365495, -586.1024096367668, -573.5935563050261, -100.39673218365246, -1077.6436420480222, -22.614456183109112, -1325.2430194285398, -359.91462738112386, -74.07106171742774, -1316.8941279402602, -365.4466315843007, -695.3340821666086, -347.87273955126966, -192.46370399376914, -87.3596076857757, -380.1782714742223, -471.3795752705786, -344.6570910752766, -1162.2993431698626, -936.2418247781789, -141.29833110144708, -174.99711670209075, -458.24741914238245, -70.26891485867837, -69.77904857956548, -259.6311546222944, -1065.4136599479828, -43.393383743238715, -1323.0101797183272, -1203.1300942100052, -293.8810962191461, -611.4313292968001, -44.59645556666285, -469.6080872488974, -301.52699007892306, -243.4359943495652, -656.3850060918163, -254.05511265219272, -154.54124087301926, -89.63173706854518, -241.61303481732713, -106.76916980725628, -404.7092187362351, -234.30333438630547, -53.499486485157455, -526.2112719549149, -1262.940635461594, -52.44453179140897, -460.0354280637582, -716.6588088473296, -821.5504299887776, -378.0334688186698, -154.16854346868277, -341.6717204594037, -605.10473039752, -6.484633961686758, -811.7822020068775, -288.52367041248215, -1076.8027622349996, -193.43886852263006, -65.00397194548155, -564.0918715161762, -52.08493277107814, -504.01303397656307, -1120.5331761984687, -862.7691672842291, -59.586528086365604, -275.80703177059434, -680.2636447294101, -305.90276035304635, -1029.7930805356132, -518.3531908200554, -237.52560237071464, -214.0457560231739, -4.670581708931742, -547.2144588183914, -126.22692123590791, -724.0034089668849, -156.02736699597716, -353.3854147032384, -279.6202265479935, -263.058063329591, -583.2349319587045, -390.83617000019586, -180.51581993787903, -1133.7837995963766, -971.079484664693, -153.08649468960232, -172.54855323008383, -657.3927921568782, -796.3168244397827, -533.1405397869556, -540.6375080189124, -1521.2723548944587, -516.7500336033286, -628.1145136403516, -430.33773617998946, -503.70530329626894, -330.77990139553987, -975.69676974111, -720.2561743297675, -397.611839827303, -899.0627942682091, -1326.9968980633228, -330.65894574479427, -216.86759988541417, -285.3452972036384, -158.82013966484507, -1081.5551496404496, -293.5575580188322, -851.7621913141536, -200.0698916185071, -345.15108495620217, -99.99832036554126, -1273.8573831075405, -472.87242646262206, -118.77670571448289, -730.8672242598412, -733.7440068792865, -988.1203475669246, -310.5204354199158, -844.2238109167957, -809.6949473928862, -764.1292209814741, -470.88691925236304, -168.06894786351378, -671.9490512868032, -215.96689117809134, -1020.4868185765158, -421.78534054255005, -740.1730415928353, -36.440328267853886, -137.11164475353291, -1041.1042724749957, -761.5882119039377, -80.03800235038143, -35.723513596322434, -993.9136589334851, -173.70283334028315, -2.845093473638789, -897.141513128497, -290.75546131636247, -140.56446662007522, -420.9827333453538, -184.59977370769982, -1064.5820872863417, -208.0880656171646, -994.3769029993125, -446.90578536695176, -340.463407604843, -972.930668466314, -662.7919717772486, -586.7003536419784, -1024.9067373972375, -313.83227593501863, -917.9948346477894, -23.17625122755379, -175.1967044042702, -321.72815218002404, -441.6252305129857, -1376.0646112706083, -138.88918499638842, -1327.829542230307, -950.5759750844934, -455.24561861829875, -1196.2935072000628, -117.68033600303363, -280.51556225399463, -233.23091093138837, -566.127273541084, -2.075901374179056, -502.5734379897926, -138.04788889455003, -590.6177361857532, -570.8675708592398, -672.3132077770106, -466.6832302135386, -311.67681508231294, -440.7432109078406, -439.6896234290247, -162.56257720274783, -176.42081032906435, -1046.3983835218705, -689.8930103534125, -186.63707906028847, -817.6234723215181, -862.3541258479703, -495.7602709703686, -517.8444181184872, -48.01125546622974, -704.8217667986808, -347.5349851319896, -113.48618489384882, -203.11566490705644, -5.860265071863212, -687.1816119682113, -561.8533373776877, -117.26237582457536, -483.4253617638546, -99.13238403395054, -957.5059810871038, -926.0358685161376, -139.46865556018432, -200.76598835228117, -456.0347131152194, -94.10640137031572, -104.43630457881929, -523.4661801326981, -50.581977412695494, -199.21408023202463, -978.1450844007192, -910.188984503648, -378.18566570934695, -98.67238808174082, -154.0480562745491, -625.9623255051699, -569.7956852395083, -571.6435291574181, -1131.178934233719, -85.93315206235802, -356.50471328008445, -282.0442342302087, -1320.1648243117122, -1018.8035274805038, -1019.4550755327089, -347.68116911725787, -391.44049420090715, -668.9635576036487, -827.1915525062973, -638.0901031132854, -299.14450193184877, -733.5871749720576, -421.83825708459693, -64.5096442195283, -1007.747993173449, -1183.499632902297, -934.7260014410327, -1078.5318831615737, -1280.2626955775186, -420.6318949130221, -1358.4397156381617, -304.784325313836, -801.7717390976376, -571.3461662454055, -757.5879123717291, -38.043779866410844, -46.35672407604245, -142.33305934430481, -87.21508581536469, -325.0133155991885, -858.9430691716974, -8.860581386388414, -1150.6436844330055, -80.46440399474564, -139.2333317662023, -37.521969416784344, -831.9963998528788, -918.9788188665889, -699.9173026774384, -812.6445117831773, -24.279768097769686, -1129.662553044496, -710.755295851256, -1147.1449096293313, -146.24818926347544, -708.6043264275442, -340.0547344876745, -65.49454222330972, -764.6881549088145, -771.9241627378552, -800.1828343232655, -152.48820492682856, -668.3971343267783, -281.5764579599457, -285.46112050515825, -922.1261172419094, -1144.8858745137445, -1391.2274323085421, -257.1782129665511, -116.52181603890523, -124.34585044344696, -107.50225217486587, -575.7893038059252, -673.7852091976697, -570.8477474015943, -84.989147002632, -83.53489727819324, -655.271424548817, -991.6652327137061, -526.445625210243, -1134.3759617275653, -251.34280607725435, -693.902832960085, -402.7117730866204, -348.3812272028901, -118.46050660664861, -419.01413653165895, -226.2677530851906, -253.52043074881385, -762.1302996644903, -430.3727036672324, -191.4081034202753, -287.30841666548326, -244.60579802200786, -67.19382556532284, -1260.157827050302, -714.9156181618348, -527.2502027531692, -910.2703035528529, -1227.6969583440298, -541.3749706104037, -1370.0491492549393, -51.778247840474336, -117.49767531379133, -405.09375112629107, -253.595103591747, -214.7990261036554, -63.123203130634586, -655.1584353025954, -320.12106004767907, -516.828585301238, -913.9147204402553, -1216.3010325181615, -502.90209092600395, -366.42760527632004, -728.6774009482789, -1265.1768774391894, -383.89882088659743, -1125.6134402252258, -61.03730101995754, -220.346597227618, -994.2858844907093, -152.8671357433328, -1220.3374318427295, -495.6820846857325, -1160.43837043781, -328.63395880292654, -140.03326072346613, -237.74336990707735, -614.6182156742678, -598.7494373910315, -1241.3637631075187, -494.3309354626226, -1321.4175244288863, -504.51573490253077, -51.95131962532551, -636.6692564169139, -453.64345050311806, -1020.4696613488862, -280.4623738568875, -185.49811226905405, -704.7193305339127, -980.2664340752963, -358.7920928363145, -755.5481400058293, -90.10755673873038, -39.519382272940895, -685.6693700655393, -494.4245745483489, -601.2613322857197, -422.4628076093497, -291.77386544987763, -537.2919475608595, -160.48529705327627, -1275.403425076578, -477.8633971293819, -507.1305270369818, -587.917835860873, -896.0478311473616, -70.08771200912823, -1318.2839838294142, -341.398682262476, -748.0475111160956, -647.4583126349651, -17.951914733250604, -575.459390126387, -115.68239034813097, -449.21747403545766, -197.07519797323036, -504.5175580305531, -409.8349445997832, -654.78718929859, -196.826082883199, -619.639298948003, -594.2956586756803, -748.7696599678626, -79.8936168055324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6081352265095472, "mean_inference_ms": 1.731862799042072, "mean_action_processing_ms": 0.8669613488025908, "mean_env_wait_ms": 10.808293856473238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013054847717285156, "StateBufferConnector_ms": 0.009539365768432617, "ViewRequirementAgentConnector_ms": 0.32951951026916504}, "num_episodes": 21, "episode_return_max": -846.6102952183403, "episode_return_min": -5160.975581327425, "episode_return_mean": -2648.6965337757465, "episodes_this_iter": 21}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632944, "num_agent_steps_trained": 632944, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.23270993904647, "num_env_steps_trained_throughput_per_sec": 85.23270993904647, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 632944, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 632944, "timers": {"training_iteration_time_ms": 49619.924, "restore_workers_time_ms": 0.022, "training_step_time_ms": 49619.862, "sample_time_ms": 3379.229, "learn_time_ms": 46182.591, "learn_throughput": 86.613, "synch_weights_time_ms": 55.123}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 632944, "num_agent_steps_trained": 632944}, "done": false, "training_iteration": 35, "trial_id": "05c72_00000", "date": "2024-07-26_15-13-19", "timestamp": 1721986999, "time_this_iter_s": 46.939520597457886, "time_total_s": 1819.4050018787384, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805a8e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1819.4050018787384, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 12.426865671641792, "ram_util_percent": 32.900000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.86025268861619, "cur_kl_coeff": 0.3374999999999999, "cur_lr": 0.001, "total_loss": 5.004385609571961, "policy_loss": -0.0010014036582547358, "vf_loss": 5.022169828195682, "vf_explained_var": 0.9782587052761823, "kl": 0.018003401708864105, "entropy": 2.285896914608177, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.60689655172413, "num_grad_updates_lifetime": 151125.5, "diff_num_grad_updates_vs_sampler_policy": 2174.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 651447, "num_agent_steps_trained": 651447}, "env_runners": {"episode_reward_max": -994.8120629768202, "episode_reward_min": -5184.233823926187, "episode_reward_mean": -2692.661852846581, "episode_len_mean": 149.28, "episode_media": {}, "episodes_timesteps_total": 14928, "policy_reward_min": {"policy_0": -1521.2723548944587}, "policy_reward_max": {"policy_0": -2.075901374179056}, "policy_reward_mean": {"policy_0": -538.5323705693162}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3259.450206157849, -2312.4852043033015, -3637.1121463370428, -2928.0499885899912, -3058.931535165381, -2585.7649302567866, -2310.6559206063894, -3607.475825042761, -2884.7290867770394, -2434.852420157845, -2055.5656450791685, -2358.358560192267, -2018.817126576634, -3417.468736214672, -2866.6104528495785, -2453.503883364277, -4047.6249791361993, -1584.5230860904378, -2438.5296339300894, -1531.0930369509892, -3602.9060711050633, -2113.972696485754, -1571.4970642186672, -2583.3619712256204, -994.8120629768202, -2661.5963066817867, -1826.664120810313, -2427.304562963788, -4097.545090643092, -3166.9768901271395, -3612.3215288209053, -4442.650514604115, -2215.106321657228, -1422.3651113169424, -2239.8597894636187, -3585.482954469469, -3052.807455659284, -2554.777899120074, -3302.4467045475403, -1996.7755639323111, -1988.946304686014, -3559.101050277585, -1982.470476387902, -1863.699290586001, -2574.1814854649497, -4576.641584515395, -1042.7638039759586, -2469.1460042223985, -4079.48500710795, -2785.1820438501113, -3357.9589815125337, -2832.50804680336, -3008.8847708362778, -2644.792928511858, -2224.233605929112, -2495.591949958838, -2958.174593857076, -3213.7360451092545, -2104.599518958828, -2215.432363937614, -2239.4243172802776, -2145.4242393200143, -4411.813867046678, -2953.537421402141, -2126.16081483724, -2162.239058756788, -3546.9612956102546, -5184.233823926187, -4343.512560927285, -3537.7312579187055, -2488.1239400307354, -1720.8522096102472, -4066.3874450592043, -2301.0185359323305, -2399.131360447051, -2328.1041958912347, -1605.0824576851217, -2883.8717500634634, -1300.053371007336, -2653.6973193266776, -2671.5710085510887, -1344.6545202207424, -2680.545690368288, -1653.812468292639, -3003.3732188910826, -2265.009627066409, -2801.2923192800854, -2210.7374841286437, -3996.513441758102, -2394.183951523475, -1546.073887563656, -3785.9014440023057, -2505.117341283737, -2888.9684218867546, -1384.1612076004376, -2879.019078895667, -2577.934260768343, -3895.13488362577, -1555.3497751914333, -3589.107070583228], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-583.2349319587045, -390.83617000019586, -180.51581993787903, -1133.7837995963766, -971.079484664693, -153.08649468960232, -172.54855323008383, -657.3927921568782, -796.3168244397827, -533.1405397869556, -540.6375080189124, -1521.2723548944587, -516.7500336033286, -628.1145136403516, -430.33773617998946, -503.70530329626894, -330.77990139553987, -975.69676974111, -720.2561743297675, -397.611839827303, -899.0627942682091, -1326.9968980633228, -330.65894574479427, -216.86759988541417, -285.3452972036384, -158.82013966484507, -1081.5551496404496, -293.5575580188322, -851.7621913141536, -200.0698916185071, -345.15108495620217, -99.99832036554126, -1273.8573831075405, -472.87242646262206, -118.77670571448289, -730.8672242598412, -733.7440068792865, -988.1203475669246, -310.5204354199158, -844.2238109167957, -809.6949473928862, -764.1292209814741, -470.88691925236304, -168.06894786351378, -671.9490512868032, -215.96689117809134, -1020.4868185765158, -421.78534054255005, -740.1730415928353, -36.440328267853886, -137.11164475353291, -1041.1042724749957, -761.5882119039377, -80.03800235038143, -35.723513596322434, -993.9136589334851, -173.70283334028315, -2.845093473638789, -897.141513128497, -290.75546131636247, -140.56446662007522, -420.9827333453538, -184.59977370769982, -1064.5820872863417, -208.0880656171646, -994.3769029993125, -446.90578536695176, -340.463407604843, -972.930668466314, -662.7919717772486, -586.7003536419784, -1024.9067373972375, -313.83227593501863, -917.9948346477894, -23.17625122755379, -175.1967044042702, -321.72815218002404, -441.6252305129857, -1376.0646112706083, -138.88918499638842, -1327.829542230307, -950.5759750844934, -455.24561861829875, -1196.2935072000628, -117.68033600303363, -280.51556225399463, -233.23091093138837, -566.127273541084, -2.075901374179056, -502.5734379897926, -138.04788889455003, -590.6177361857532, -570.8675708592398, -672.3132077770106, -466.6832302135386, -311.67681508231294, -440.7432109078406, -439.6896234290247, -162.56257720274783, -176.42081032906435, -1046.3983835218705, -689.8930103534125, -186.63707906028847, -817.6234723215181, -862.3541258479703, -495.7602709703686, -517.8444181184872, -48.01125546622974, -704.8217667986808, -347.5349851319896, -113.48618489384882, -203.11566490705644, -5.860265071863212, -687.1816119682113, -561.8533373776877, -117.26237582457536, -483.4253617638546, -99.13238403395054, -957.5059810871038, -926.0358685161376, -139.46865556018432, -200.76598835228117, -456.0347131152194, -94.10640137031572, -104.43630457881929, -523.4661801326981, -50.581977412695494, -199.21408023202463, -978.1450844007192, -910.188984503648, -378.18566570934695, -98.67238808174082, -154.0480562745491, -625.9623255051699, -569.7956852395083, -571.6435291574181, -1131.178934233719, -85.93315206235802, -356.50471328008445, -282.0442342302087, -1320.1648243117122, -1018.8035274805038, -1019.4550755327089, -347.68116911725787, -391.44049420090715, -668.9635576036487, -827.1915525062973, -638.0901031132854, -299.14450193184877, -733.5871749720576, -421.83825708459693, -64.5096442195283, -1007.747993173449, -1183.499632902297, -934.7260014410327, -1078.5318831615737, -1280.2626955775186, -420.6318949130221, -1358.4397156381617, -304.784325313836, -801.7717390976376, -571.3461662454055, -757.5879123717291, -38.043779866410844, -46.35672407604245, -142.33305934430481, -87.21508581536469, -325.0133155991885, -858.9430691716974, -8.860581386388414, -1150.6436844330055, -80.46440399474564, -139.2333317662023, -37.521969416784344, -831.9963998528788, -918.9788188665889, -699.9173026774384, -812.6445117831773, -24.279768097769686, -1129.662553044496, -710.755295851256, -1147.1449096293313, -146.24818926347544, -708.6043264275442, -340.0547344876745, -65.49454222330972, -764.6881549088145, -771.9241627378552, -800.1828343232655, -152.48820492682856, -668.3971343267783, -281.5764579599457, -285.46112050515825, -922.1261172419094, -1144.8858745137445, -1391.2274323085421, -257.1782129665511, -116.52181603890523, -124.34585044344696, -107.50225217486587, -575.7893038059252, -673.7852091976697, -570.8477474015943, -84.989147002632, -83.53489727819324, -655.271424548817, -991.6652327137061, -526.445625210243, -1134.3759617275653, -251.34280607725435, -693.902832960085, -402.7117730866204, -348.3812272028901, -118.46050660664861, -419.01413653165895, -226.2677530851906, -253.52043074881385, -762.1302996644903, -430.3727036672324, -191.4081034202753, -287.30841666548326, -244.60579802200786, -67.19382556532284, -1260.157827050302, -714.9156181618348, -527.2502027531692, -910.2703035528529, -1227.6969583440298, -541.3749706104037, -1370.0491492549393, -51.778247840474336, -117.49767531379133, -405.09375112629107, -253.595103591747, -214.7990261036554, -63.123203130634586, -655.1584353025954, -320.12106004767907, -516.828585301238, -913.9147204402553, -1216.3010325181615, -502.90209092600395, -366.42760527632004, -728.6774009482789, -1265.1768774391894, -383.89882088659743, -1125.6134402252258, -61.03730101995754, -220.346597227618, -994.2858844907093, -152.8671357433328, -1220.3374318427295, -495.6820846857325, -1160.43837043781, -328.63395880292654, -140.03326072346613, -237.74336990707735, -614.6182156742678, -598.7494373910315, -1241.3637631075187, -494.3309354626226, -1321.4175244288863, -504.51573490253077, -51.95131962532551, -636.6692564169139, -453.64345050311806, -1020.4696613488862, -280.4623738568875, -185.49811226905405, -704.7193305339127, -980.2664340752963, -358.7920928363145, -755.5481400058293, -90.10755673873038, -39.519382272940895, -685.6693700655393, -494.4245745483489, -601.2613322857197, -422.4628076093497, -291.77386544987763, -537.2919475608595, -160.48529705327627, -1275.403425076578, -477.8633971293819, -507.1305270369818, -587.917835860873, -896.0478311473616, -70.08771200912823, -1318.2839838294142, -341.398682262476, -748.0475111160956, -647.4583126349651, -17.951914733250604, -575.459390126387, -115.68239034813097, -449.21747403545766, -197.07519797323036, -504.5175580305531, -409.8349445997832, -654.78718929859, -196.826082883199, -619.639298948003, -594.2956586756803, -748.7696599678626, -79.8936168055324, -1451.789888644129, -350.5011070904606, -104.54213117222547, -116.42960378146074, -122.16150863174045, -1066.6256230217602, -422.7513952878417, -769.8999781677354, -1280.3945067359605, -872.142363833378, -757.5473183073412, -796.0530353076259, -131.31006757583884, -687.6173984643889, -581.0096017469452, -192.51531216489235, -732.6287728179982, -150.16456308210692, -245.9855840681217, -804.8665827041209, -407.33475925165294, -134.28869225355825, -1219.7763894536674, -278.28598319744003, -122.55323460046748, -1150.575946212999, -722.5195302034958, -673.6095994237212, -788.2739688456594, -211.98225092437877, -1460.4894838440105, -865.9340963122702, -692.3904949263299, -1388.1826967503982, -777.2370520931735, -1308.8840590746586, -589.7241328741316, -1129.1548878669146, -509.0206399333772, -806.7288411782041, -1011.1055821870629, -676.7205103549607, -253.18715791675876, -759.5175104841645, -837.2004969757594, -364.0500503032068, -800.6535738247009, -265.3621011900547, -596.2782017262867, -461.7800129864897, -425.31716112779407, -149.63688272090656, -354.7750258635817, -391.7035012496084, -399.4196386483566, -1208.2770702819232, -117.31432162242925, -859.6090806114388, -1222.0880594716864, -659.0989130717293, -483.68541110990833, -1027.3994319358071, -193.05718970825657, -55.303589580815704, -541.5729135975433, -670.1407875723859, -270.1135784162127, -188.39650104720445, -81.62532995482918, -1188.8551634564196, -456.14562274662313, -405.5535041286723, -242.5097356135869, -1129.9744401744717, -93.9208932278813, -555.1082526076455, -48.048541143680374, -539.1102826593703, -82.48276156501001, -380.33261970941476, -640.4525449913073, -1136.133000756404, -936.4947884347192, -111.94626346010979, -58.84515242092061, -225.09969244351115, -15.665182895262282, -32.22496425361488, -707.3194063710797, -319.74412504386936, -603.9607432165333, -83.23080645784542, -969.8686615052561, -318.5514531062117, -678.0856550408317, -1358.6086688449834, -259.6681513142478, -638.3144661478568, -138.94386620508106, -276.0358560389211, -130.6626254267022, -136.63698258704986, -846.3831330046941, -21.36341198013542, -209.60836722216152, -450.49224302929, -345.6866790627285, -786.3125465104227, -452.7189625959165, -645.33525916993, -443.5019074756135, -533.3180822592518, -449.8709592989251, -154.2414352037626, -72.88008405508624, -477.3859103397469, -224.07200381572238, -789.0178817858257, -995.1047538990522, -517.792669050731, -865.5852599985295, -835.7995729216451, -265.2774157207229, -150.40064939871746, -147.9467290267919, -95.32342491114392, -790.6790573160488, -237.3423886343505, -657.2265186150103, -1020.7209298035301, -453.10781985038005, -340.80140497253234, -337.29763538339654, -7.705945171013943, -1071.8246787513203, -1174.4001660832346, -405.0519971280751, -808.2059661123128, -750.2193578758565, -858.6359545586216, -485.22353107900807, -108.82305564353045, -1179.8820924438826, -128.18814345149676, -492.06712890555394, -661.5884185460338, -94.29662391733285, -530.752036677286, -155.91583710906843, -103.52097131393337, -690.1668848428333, -709.7193865572766, -623.8135513225551, -1268.0465278214424, -494.1550934581975, -280.0180499399952, -386.49107461963683, -1029.7199799494094, -300.09886139845275, -508.7893753762451, -355.50396963536764, -1134.748086664989, -386.27302016601743, -444.68255461496346, -567.7607908054165, -116.74461954526312, -385.14477179339974, -665.5473561439228, -73.06942278976796, -143.6550373280841, -1321.9633186528356, -215.8141116680962, -235.55577044565342, -49.21269811142936, -1056.4731800176503, -231.1627978993198, -299.50479817753455, -683.8207379162427, -780.5702680899659, -582.875658685281, -234.36086643873793, -1013.1344429091816, -1033.5707035932717, -1165.9503401953907, -448.11853048919124, -263.02816453750677, -172.2426183551583, -186.0291406053365, -505.9198888525439, -428.129962840889, -715.5103818202075, -1195.516984220873, -344.4307136819295, -469.8347724381034, -863.8142184221152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.604580527895623, "mean_inference_ms": 1.7330838526071233, "mean_action_processing_ms": 0.8661297271871671, "mean_env_wait_ms": 10.80492463874607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013055801391601562, "StateBufferConnector_ms": 0.009386301040649414, "ViewRequirementAgentConnector_ms": 0.32523584365844727}, "num_episodes": 39, "episode_return_max": -994.8120629768202, "episode_return_min": -5184.233823926187, "episode_return_mean": -2692.661852846581, "episodes_this_iter": 39}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 651447, "num_agent_steps_trained": 651447, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.67459749946369, "num_env_steps_trained_throughput_per_sec": 79.67459749946369, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 651447, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 651447, "timers": {"training_iteration_time_ms": 49139.959, "restore_workers_time_ms": 0.022, "training_step_time_ms": 49139.898, "sample_time_ms": 3356.959, "learn_time_ms": 45724.162, "learn_throughput": 87.481, "synch_weights_time_ms": 55.814}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 651447, "num_agent_steps_trained": 651447}, "done": false, "training_iteration": 36, "trial_id": "05c72_00000", "date": "2024-07-26_15-14-09", "timestamp": 1721987049, "time_this_iter_s": 50.21395969390869, "time_total_s": 1869.618961572647, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e65f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1869.618961572647, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 11.249295774647887, "ram_util_percent": 32.23521126760562}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 169.15871441436536, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.951804156134827, "policy_loss": -0.0031651412852983355, "vf_loss": 4.9711633982080405, "vf_explained_var": 0.9816638254607567, "kl": 0.01655033269072201, "entropy": 2.1779833484779703, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.15151515151516, "num_grad_updates_lifetime": 155280.5, "diff_num_grad_updates_vs_sampler_policy": 1979.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 668231, "num_agent_steps_trained": 668231}, "env_runners": {"episode_reward_max": -994.8120629768202, "episode_reward_min": -5184.233823926187, "episode_reward_mean": -2680.385564739768, "episode_len_mean": 149.04, "episode_media": {}, "episodes_timesteps_total": 14904, "policy_reward_min": {"policy_0": -1460.4894838440105}, "policy_reward_max": {"policy_0": -2.0307539855114696}, "policy_reward_mean": {"policy_0": -536.0771129479537}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3602.9060711050633, -2113.972696485754, -1571.4970642186672, -2583.3619712256204, -994.8120629768202, -2661.5963066817867, -1826.664120810313, -2427.304562963788, -4097.545090643092, -3166.9768901271395, -3612.3215288209053, -4442.650514604115, -2215.106321657228, -1422.3651113169424, -2239.8597894636187, -3585.482954469469, -3052.807455659284, -2554.777899120074, -3302.4467045475403, -1996.7755639323111, -1988.946304686014, -3559.101050277585, -1982.470476387902, -1863.699290586001, -2574.1814854649497, -4576.641584515395, -1042.7638039759586, -2469.1460042223985, -4079.48500710795, -2785.1820438501113, -3357.9589815125337, -2832.50804680336, -3008.8847708362778, -2644.792928511858, -2224.233605929112, -2495.591949958838, -2958.174593857076, -3213.7360451092545, -2104.599518958828, -2215.432363937614, -2239.4243172802776, -2145.4242393200143, -4411.813867046678, -2953.537421402141, -2126.16081483724, -2162.239058756788, -3546.9612956102546, -5184.233823926187, -4343.512560927285, -3537.7312579187055, -2488.1239400307354, -1720.8522096102472, -4066.3874450592043, -2301.0185359323305, -2399.131360447051, -2328.1041958912347, -1605.0824576851217, -2883.8717500634634, -1300.053371007336, -2653.6973193266776, -2671.5710085510887, -1344.6545202207424, -2680.545690368288, -1653.812468292639, -3003.3732188910826, -2265.009627066409, -2801.2923192800854, -2210.7374841286437, -3996.513441758102, -2394.183951523475, -1546.073887563656, -3785.9014440023057, -2505.117341283737, -2888.9684218867546, -1384.1612076004376, -2879.019078895667, -2577.934260768343, -3895.13488362577, -1555.3497751914333, -3589.107070583228, -2066.7865983306338, -4002.260727453224, -3058.3368239568513, -1287.335527701916, -3583.9217963073947, -3008.8282623645355, -3218.0282733038543, -2451.0698343437552, -2047.6543580483437, -2975.6621599775494, -2655.9759676369263, -1641.482829547673, -4059.230646874447, -3853.9125403844505, -1607.3943043647548, -2983.035243402575, -2486.9820567991446, -1434.0245856125669, -2381.8904445943444, -1760.1606120924537], "episode_lengths": [150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1046.3983835218705, -689.8930103534125, -186.63707906028847, -817.6234723215181, -862.3541258479703, -495.7602709703686, -517.8444181184872, -48.01125546622974, -704.8217667986808, -347.5349851319896, -113.48618489384882, -203.11566490705644, -5.860265071863212, -687.1816119682113, -561.8533373776877, -117.26237582457536, -483.4253617638546, -99.13238403395054, -957.5059810871038, -926.0358685161376, -139.46865556018432, -200.76598835228117, -456.0347131152194, -94.10640137031572, -104.43630457881929, -523.4661801326981, -50.581977412695494, -199.21408023202463, -978.1450844007192, -910.188984503648, -378.18566570934695, -98.67238808174082, -154.0480562745491, -625.9623255051699, -569.7956852395083, -571.6435291574181, -1131.178934233719, -85.93315206235802, -356.50471328008445, -282.0442342302087, -1320.1648243117122, -1018.8035274805038, -1019.4550755327089, -347.68116911725787, -391.44049420090715, -668.9635576036487, -827.1915525062973, -638.0901031132854, -299.14450193184877, -733.5871749720576, -421.83825708459693, -64.5096442195283, -1007.747993173449, -1183.499632902297, -934.7260014410327, -1078.5318831615737, -1280.2626955775186, -420.6318949130221, -1358.4397156381617, -304.784325313836, -801.7717390976376, -571.3461662454055, -757.5879123717291, -38.043779866410844, -46.35672407604245, -142.33305934430481, -87.21508581536469, -325.0133155991885, -858.9430691716974, -8.860581386388414, -1150.6436844330055, -80.46440399474564, -139.2333317662023, -37.521969416784344, -831.9963998528788, -918.9788188665889, -699.9173026774384, -812.6445117831773, -24.279768097769686, -1129.662553044496, -710.755295851256, -1147.1449096293313, -146.24818926347544, -708.6043264275442, -340.0547344876745, -65.49454222330972, -764.6881549088145, -771.9241627378552, -800.1828343232655, -152.48820492682856, -668.3971343267783, -281.5764579599457, -285.46112050515825, -922.1261172419094, -1144.8858745137445, -1391.2274323085421, -257.1782129665511, -116.52181603890523, -124.34585044344696, -107.50225217486587, -575.7893038059252, -673.7852091976697, -570.8477474015943, -84.989147002632, -83.53489727819324, -655.271424548817, -991.6652327137061, -526.445625210243, -1134.3759617275653, -251.34280607725435, -693.902832960085, -402.7117730866204, -348.3812272028901, -118.46050660664861, -419.01413653165895, -226.2677530851906, -253.52043074881385, -762.1302996644903, -430.3727036672324, -191.4081034202753, -287.30841666548326, -244.60579802200786, -67.19382556532284, -1260.157827050302, -714.9156181618348, -527.2502027531692, -910.2703035528529, -1227.6969583440298, -541.3749706104037, -1370.0491492549393, -51.778247840474336, -117.49767531379133, -405.09375112629107, -253.595103591747, -214.7990261036554, -63.123203130634586, -655.1584353025954, -320.12106004767907, -516.828585301238, -913.9147204402553, -1216.3010325181615, -502.90209092600395, -366.42760527632004, -728.6774009482789, -1265.1768774391894, -383.89882088659743, -1125.6134402252258, -61.03730101995754, -220.346597227618, -994.2858844907093, -152.8671357433328, -1220.3374318427295, -495.6820846857325, -1160.43837043781, -328.63395880292654, -140.03326072346613, -237.74336990707735, -614.6182156742678, -598.7494373910315, -1241.3637631075187, -494.3309354626226, -1321.4175244288863, -504.51573490253077, -51.95131962532551, -636.6692564169139, -453.64345050311806, -1020.4696613488862, -280.4623738568875, -185.49811226905405, -704.7193305339127, -980.2664340752963, -358.7920928363145, -755.5481400058293, -90.10755673873038, -39.519382272940895, -685.6693700655393, -494.4245745483489, -601.2613322857197, -422.4628076093497, -291.77386544987763, -537.2919475608595, -160.48529705327627, -1275.403425076578, -477.8633971293819, -507.1305270369818, -587.917835860873, -896.0478311473616, -70.08771200912823, -1318.2839838294142, -341.398682262476, -748.0475111160956, -647.4583126349651, -17.951914733250604, -575.459390126387, -115.68239034813097, -449.21747403545766, -197.07519797323036, -504.5175580305531, -409.8349445997832, -654.78718929859, -196.826082883199, -619.639298948003, -594.2956586756803, -748.7696599678626, -79.8936168055324, -1451.789888644129, -350.5011070904606, -104.54213117222547, -116.42960378146074, -122.16150863174045, -1066.6256230217602, -422.7513952878417, -769.8999781677354, -1280.3945067359605, -872.142363833378, -757.5473183073412, -796.0530353076259, -131.31006757583884, -687.6173984643889, -581.0096017469452, -192.51531216489235, -732.6287728179982, -150.16456308210692, -245.9855840681217, -804.8665827041209, -407.33475925165294, -134.28869225355825, -1219.7763894536674, -278.28598319744003, -122.55323460046748, -1150.575946212999, -722.5195302034958, -673.6095994237212, -788.2739688456594, -211.98225092437877, -1460.4894838440105, -865.9340963122702, -692.3904949263299, -1388.1826967503982, -777.2370520931735, -1308.8840590746586, -589.7241328741316, -1129.1548878669146, -509.0206399333772, -806.7288411782041, -1011.1055821870629, -676.7205103549607, -253.18715791675876, -759.5175104841645, -837.2004969757594, -364.0500503032068, -800.6535738247009, -265.3621011900547, -596.2782017262867, -461.7800129864897, -425.31716112779407, -149.63688272090656, -354.7750258635817, -391.7035012496084, -399.4196386483566, -1208.2770702819232, -117.31432162242925, -859.6090806114388, -1222.0880594716864, -659.0989130717293, -483.68541110990833, -1027.3994319358071, -193.05718970825657, -55.303589580815704, -541.5729135975433, -670.1407875723859, -270.1135784162127, -188.39650104720445, -81.62532995482918, -1188.8551634564196, -456.14562274662313, -405.5535041286723, -242.5097356135869, -1129.9744401744717, -93.9208932278813, -555.1082526076455, -48.048541143680374, -539.1102826593703, -82.48276156501001, -380.33261970941476, -640.4525449913073, -1136.133000756404, -936.4947884347192, -111.94626346010979, -58.84515242092061, -225.09969244351115, -15.665182895262282, -32.22496425361488, -707.3194063710797, -319.74412504386936, -603.9607432165333, -83.23080645784542, -969.8686615052561, -318.5514531062117, -678.0856550408317, -1358.6086688449834, -259.6681513142478, -638.3144661478568, -138.94386620508106, -276.0358560389211, -130.6626254267022, -136.63698258704986, -846.3831330046941, -21.36341198013542, -209.60836722216152, -450.49224302929, -345.6866790627285, -786.3125465104227, -452.7189625959165, -645.33525916993, -443.5019074756135, -533.3180822592518, -449.8709592989251, -154.2414352037626, -72.88008405508624, -477.3859103397469, -224.07200381572238, -789.0178817858257, -995.1047538990522, -517.792669050731, -865.5852599985295, -835.7995729216451, -265.2774157207229, -150.40064939871746, -147.9467290267919, -95.32342491114392, -790.6790573160488, -237.3423886343505, -657.2265186150103, -1020.7209298035301, -453.10781985038005, -340.80140497253234, -337.29763538339654, -7.705945171013943, -1071.8246787513203, -1174.4001660832346, -405.0519971280751, -808.2059661123128, -750.2193578758565, -858.6359545586216, -485.22353107900807, -108.82305564353045, -1179.8820924438826, -128.18814345149676, -492.06712890555394, -661.5884185460338, -94.29662391733285, -530.752036677286, -155.91583710906843, -103.52097131393337, -690.1668848428333, -709.7193865572766, -623.8135513225551, -1268.0465278214424, -494.1550934581975, -280.0180499399952, -386.49107461963683, -1029.7199799494094, -300.09886139845275, -508.7893753762451, -355.50396963536764, -1134.748086664989, -386.27302016601743, -444.68255461496346, -567.7607908054165, -116.74461954526312, -385.14477179339974, -665.5473561439228, -73.06942278976796, -143.6550373280841, -1321.9633186528356, -215.8141116680962, -235.55577044565342, -49.21269811142936, -1056.4731800176503, -231.1627978993198, -299.50479817753455, -683.8207379162427, -780.5702680899659, -582.875658685281, -234.36086643873793, -1013.1344429091816, -1033.5707035932717, -1165.9503401953907, -448.11853048919124, -263.02816453750677, -172.2426183551583, -186.0291406053365, -505.9198888525439, -428.129962840889, -715.5103818202075, -1195.516984220873, -344.4307136819295, -469.8347724381034, -863.8142184221152, -89.0084892614202, -926.033351874893, -514.9725384643966, -241.47472502124222, -295.29749370867995, -795.8350515662515, -1220.715976614018, -876.670990216025, -756.4825405434585, -352.55616851346855, -253.38443002134468, -944.2773054818022, -630.3512220353266, -125.96957115362092, -1104.3542952647547, -537.5932540073451, -26.102670839179847, -2.0307539855114696, -320.44430122091484, -401.16454764896537, -546.3515183337161, -822.2737436870334, -1054.828276739504, -298.1631315491784, -862.3051259979595, -947.9816732959922, -47.56586395518424, -1139.4569687171243, -778.2419591084142, -95.58179728781899, -913.2678362243169, -551.4764700580424, -129.40469961908929, -1130.1831413573611, -493.6961260450454, -330.09692680222463, -47.23347148267845, -79.55447543261147, -947.8683443339692, -1046.3166162922719, -422.9069762794587, -350.3802711977041, -437.40303675698726, -66.86933458137067, -770.0947392328221, -804.5545182393819, -764.3820867094926, -36.74375341419751, -50.7546039537303, -1319.2271976607462, -812.2995685485473, -304.2705446482616, -711.0337691463795, -390.8105435314571, -437.56154176228074, -976.5137687785855, -292.61159223745005, -213.46666466656595, -33.14971613943707, -125.74108772563392, -994.698243487486, -352.22509817644533, -1154.1223233274281, -516.5909837358874, -1041.5939981471981, -88.8292659750264, -954.7099889062404, -1099.6910974539517, -349.6801598716917, -1361.0020281775414, -30.114498187867778, -217.5188630549729, -464.9729400359709, -823.9368823624529, -70.85112072348949, -358.80661311391003, -669.0385394864984, -817.7523214284605, -393.09608683378605, -744.3416825399206, -148.05308526415436, -1198.1343425881848, -505.21091884629413, -321.8156520880953, -313.768058012415, -31.02712524414747, -940.4205034053608, -140.80548867642034, -10.214024955335056, -311.55744333130394, -642.0519468177921, -219.9270117893373, -454.8753946731851, -413.9230722885503, -651.113019025478, -63.52760842824401, -116.21452316624206, -351.3299134671937, -589.5507149591252, -639.5378520716497]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6004489945541822, "mean_inference_ms": 1.7294590088292292, "mean_action_processing_ms": 0.8613744478946382, "mean_env_wait_ms": 10.76776534410382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013138055801391602, "StateBufferConnector_ms": 0.009477853775024414, "ViewRequirementAgentConnector_ms": 0.3262019157409668}, "num_episodes": 20, "episode_return_max": -994.8120629768202, "episode_return_min": -5184.233823926187, "episode_return_mean": -2680.385564739768, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 668231, "num_agent_steps_trained": 668231, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.76568722768373, "num_env_steps_trained_throughput_per_sec": 81.76568722768373, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 668231, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 668231, "timers": {"training_iteration_time_ms": 48549.589, "restore_workers_time_ms": 0.022, "training_step_time_ms": 48549.527, "sample_time_ms": 3347.382, "learn_time_ms": 45142.635, "learn_throughput": 88.608, "synch_weights_time_ms": 56.554}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 668231, "num_agent_steps_trained": 668231}, "done": false, "training_iteration": 37, "trial_id": "05c72_00000", "date": "2024-07-26_15-14-58", "timestamp": 1721987098, "time_this_iter_s": 48.93018460273743, "time_total_s": 1918.5491461753845, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e4ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1918.5491461753845, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 12.58550724637681, "ram_util_percent": 32.24202898550724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 185.32228346817365, "cur_kl_coeff": 0.33750000000000013, "cur_lr": 0.0010000000000000005, "total_loss": 4.583636153441955, "policy_loss": -0.0029870841096516143, "vf_loss": 4.605184776910389, "vf_explained_var": 0.985678089650836, "kl": 0.016804993908373794, "entropy": 2.4233215921101072, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.69465648854961, "num_grad_updates_lifetime": 159225.5, "diff_num_grad_updates_vs_sampler_policy": 1964.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 684959, "num_agent_steps_trained": 684959}, "env_runners": {"episode_reward_max": -1042.7638039759586, "episode_reward_min": -5184.233823926187, "episode_reward_mean": -2721.220500629599, "episode_len_mean": 149.26, "episode_media": {}, "episodes_timesteps_total": 14926, "policy_reward_min": {"policy_0": -1460.4894838440105}, "policy_reward_max": {"policy_0": -2.0307539855114696}, "policy_reward_mean": {"policy_0": -544.2441001259195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3559.101050277585, -1982.470476387902, -1863.699290586001, -2574.1814854649497, -4576.641584515395, -1042.7638039759586, -2469.1460042223985, -4079.48500710795, -2785.1820438501113, -3357.9589815125337, -2832.50804680336, -3008.8847708362778, -2644.792928511858, -2224.233605929112, -2495.591949958838, -2958.174593857076, -3213.7360451092545, -2104.599518958828, -2215.432363937614, -2239.4243172802776, -2145.4242393200143, -4411.813867046678, -2953.537421402141, -2126.16081483724, -2162.239058756788, -3546.9612956102546, -5184.233823926187, -4343.512560927285, -3537.7312579187055, -2488.1239400307354, -1720.8522096102472, -4066.3874450592043, -2301.0185359323305, -2399.131360447051, -2328.1041958912347, -1605.0824576851217, -2883.8717500634634, -1300.053371007336, -2653.6973193266776, -2671.5710085510887, -1344.6545202207424, -2680.545690368288, -1653.812468292639, -3003.3732188910826, -2265.009627066409, -2801.2923192800854, -2210.7374841286437, -3996.513441758102, -2394.183951523475, -1546.073887563656, -3785.9014440023057, -2505.117341283737, -2888.9684218867546, -1384.1612076004376, -2879.019078895667, -2577.934260768343, -3895.13488362577, -1555.3497751914333, -3589.107070583228, -2066.7865983306338, -4002.260727453224, -3058.3368239568513, -1287.335527701916, -3583.9217963073947, -3008.8282623645355, -3218.0282733038543, -2451.0698343437552, -2047.6543580483437, -2975.6621599775494, -2655.9759676369263, -1641.482829547673, -4059.230646874447, -3853.9125403844505, -1607.3943043647548, -2983.035243402575, -2486.9820567991446, -1434.0245856125669, -2381.8904445943444, -1760.1606120924537, -2226.8970774539107, -2979.095510113587, -4669.881429619178, -1662.5312600923612, -3111.485733233132, -3154.7701654923553, -1696.52647087423, -2244.6129616254275, -3102.5012881252464, -2676.0819748606123, -2419.692655475672, -3671.6823984221583, -2952.6030772590116, -2747.968799460816, -3098.846071174467, -3899.343034193726, -1915.2783210872965, -3220.01560843842, -3947.0750155238056, -2304.9429562595074, -1841.838765713649], "episode_lengths": [150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-655.271424548817, -991.6652327137061, -526.445625210243, -1134.3759617275653, -251.34280607725435, -693.902832960085, -402.7117730866204, -348.3812272028901, -118.46050660664861, -419.01413653165895, -226.2677530851906, -253.52043074881385, -762.1302996644903, -430.3727036672324, -191.4081034202753, -287.30841666548326, -244.60579802200786, -67.19382556532284, -1260.157827050302, -714.9156181618348, -527.2502027531692, -910.2703035528529, -1227.6969583440298, -541.3749706104037, -1370.0491492549393, -51.778247840474336, -117.49767531379133, -405.09375112629107, -253.595103591747, -214.7990261036554, -63.123203130634586, -655.1584353025954, -320.12106004767907, -516.828585301238, -913.9147204402553, -1216.3010325181615, -502.90209092600395, -366.42760527632004, -728.6774009482789, -1265.1768774391894, -383.89882088659743, -1125.6134402252258, -61.03730101995754, -220.346597227618, -994.2858844907093, -152.8671357433328, -1220.3374318427295, -495.6820846857325, -1160.43837043781, -328.63395880292654, -140.03326072346613, -237.74336990707735, -614.6182156742678, -598.7494373910315, -1241.3637631075187, -494.3309354626226, -1321.4175244288863, -504.51573490253077, -51.95131962532551, -636.6692564169139, -453.64345050311806, -1020.4696613488862, -280.4623738568875, -185.49811226905405, -704.7193305339127, -980.2664340752963, -358.7920928363145, -755.5481400058293, -90.10755673873038, -39.519382272940895, -685.6693700655393, -494.4245745483489, -601.2613322857197, -422.4628076093497, -291.77386544987763, -537.2919475608595, -160.48529705327627, -1275.403425076578, -477.8633971293819, -507.1305270369818, -587.917835860873, -896.0478311473616, -70.08771200912823, -1318.2839838294142, -341.398682262476, -748.0475111160956, -647.4583126349651, -17.951914733250604, -575.459390126387, -115.68239034813097, -449.21747403545766, -197.07519797323036, -504.5175580305531, -409.8349445997832, -654.78718929859, -196.826082883199, -619.639298948003, -594.2956586756803, -748.7696599678626, -79.8936168055324, -1451.789888644129, -350.5011070904606, -104.54213117222547, -116.42960378146074, -122.16150863174045, -1066.6256230217602, -422.7513952878417, -769.8999781677354, -1280.3945067359605, -872.142363833378, -757.5473183073412, -796.0530353076259, -131.31006757583884, -687.6173984643889, -581.0096017469452, -192.51531216489235, -732.6287728179982, -150.16456308210692, -245.9855840681217, -804.8665827041209, -407.33475925165294, -134.28869225355825, -1219.7763894536674, -278.28598319744003, -122.55323460046748, -1150.575946212999, -722.5195302034958, -673.6095994237212, -788.2739688456594, -211.98225092437877, -1460.4894838440105, -865.9340963122702, -692.3904949263299, -1388.1826967503982, -777.2370520931735, -1308.8840590746586, -589.7241328741316, -1129.1548878669146, -509.0206399333772, -806.7288411782041, -1011.1055821870629, -676.7205103549607, -253.18715791675876, -759.5175104841645, -837.2004969757594, -364.0500503032068, -800.6535738247009, -265.3621011900547, -596.2782017262867, -461.7800129864897, -425.31716112779407, -149.63688272090656, -354.7750258635817, -391.7035012496084, -399.4196386483566, -1208.2770702819232, -117.31432162242925, -859.6090806114388, -1222.0880594716864, -659.0989130717293, -483.68541110990833, -1027.3994319358071, -193.05718970825657, -55.303589580815704, -541.5729135975433, -670.1407875723859, -270.1135784162127, -188.39650104720445, -81.62532995482918, -1188.8551634564196, -456.14562274662313, -405.5535041286723, -242.5097356135869, -1129.9744401744717, -93.9208932278813, -555.1082526076455, -48.048541143680374, -539.1102826593703, -82.48276156501001, -380.33261970941476, -640.4525449913073, -1136.133000756404, -936.4947884347192, -111.94626346010979, -58.84515242092061, -225.09969244351115, -15.665182895262282, -32.22496425361488, -707.3194063710797, -319.74412504386936, -603.9607432165333, -83.23080645784542, -969.8686615052561, -318.5514531062117, -678.0856550408317, -1358.6086688449834, -259.6681513142478, -638.3144661478568, -138.94386620508106, -276.0358560389211, -130.6626254267022, -136.63698258704986, -846.3831330046941, -21.36341198013542, -209.60836722216152, -450.49224302929, -345.6866790627285, -786.3125465104227, -452.7189625959165, -645.33525916993, -443.5019074756135, -533.3180822592518, -449.8709592989251, -154.2414352037626, -72.88008405508624, -477.3859103397469, -224.07200381572238, -789.0178817858257, -995.1047538990522, -517.792669050731, -865.5852599985295, -835.7995729216451, -265.2774157207229, -150.40064939871746, -147.9467290267919, -95.32342491114392, -790.6790573160488, -237.3423886343505, -657.2265186150103, -1020.7209298035301, -453.10781985038005, -340.80140497253234, -337.29763538339654, -7.705945171013943, -1071.8246787513203, -1174.4001660832346, -405.0519971280751, -808.2059661123128, -750.2193578758565, -858.6359545586216, -485.22353107900807, -108.82305564353045, -1179.8820924438826, -128.18814345149676, -492.06712890555394, -661.5884185460338, -94.29662391733285, -530.752036677286, -155.91583710906843, -103.52097131393337, -690.1668848428333, -709.7193865572766, -623.8135513225551, -1268.0465278214424, -494.1550934581975, -280.0180499399952, -386.49107461963683, -1029.7199799494094, -300.09886139845275, -508.7893753762451, -355.50396963536764, -1134.748086664989, -386.27302016601743, -444.68255461496346, -567.7607908054165, -116.74461954526312, -385.14477179339974, -665.5473561439228, -73.06942278976796, -143.6550373280841, -1321.9633186528356, -215.8141116680962, -235.55577044565342, -49.21269811142936, -1056.4731800176503, -231.1627978993198, -299.50479817753455, -683.8207379162427, -780.5702680899659, -582.875658685281, -234.36086643873793, -1013.1344429091816, -1033.5707035932717, -1165.9503401953907, -448.11853048919124, -263.02816453750677, -172.2426183551583, -186.0291406053365, -505.9198888525439, -428.129962840889, -715.5103818202075, -1195.516984220873, -344.4307136819295, -469.8347724381034, -863.8142184221152, -89.0084892614202, -926.033351874893, -514.9725384643966, -241.47472502124222, -295.29749370867995, -795.8350515662515, -1220.715976614018, -876.670990216025, -756.4825405434585, -352.55616851346855, -253.38443002134468, -944.2773054818022, -630.3512220353266, -125.96957115362092, -1104.3542952647547, -537.5932540073451, -26.102670839179847, -2.0307539855114696, -320.44430122091484, -401.16454764896537, -546.3515183337161, -822.2737436870334, -1054.828276739504, -298.1631315491784, -862.3051259979595, -947.9816732959922, -47.56586395518424, -1139.4569687171243, -778.2419591084142, -95.58179728781899, -913.2678362243169, -551.4764700580424, -129.40469961908929, -1130.1831413573611, -493.6961260450454, -330.09692680222463, -47.23347148267845, -79.55447543261147, -947.8683443339692, -1046.3166162922719, -422.9069762794587, -350.3802711977041, -437.40303675698726, -66.86933458137067, -770.0947392328221, -804.5545182393819, -764.3820867094926, -36.74375341419751, -50.7546039537303, -1319.2271976607462, -812.2995685485473, -304.2705446482616, -711.0337691463795, -390.8105435314571, -437.56154176228074, -976.5137687785855, -292.61159223745005, -213.46666466656595, -33.14971613943707, -125.74108772563392, -994.698243487486, -352.22509817644533, -1154.1223233274281, -516.5909837358874, -1041.5939981471981, -88.8292659750264, -954.7099889062404, -1099.6910974539517, -349.6801598716917, -1361.0020281775414, -30.114498187867778, -217.5188630549729, -464.9729400359709, -823.9368823624529, -70.85112072348949, -358.80661311391003, -669.0385394864984, -817.7523214284605, -393.09608683378605, -744.3416825399206, -148.05308526415436, -1198.1343425881848, -505.21091884629413, -321.8156520880953, -313.768058012415, -31.02712524414747, -940.4205034053608, -140.80548867642034, -10.214024955335056, -311.55744333130394, -642.0519468177921, -219.9270117893373, -454.8753946731851, -413.9230722885503, -651.113019025478, -63.52760842824401, -116.21452316624206, -351.3299134671937, -589.5507149591252, -639.5378520716497, -470.8737720214005, -543.2224945629722, -132.55118459027827, -249.06679757306125, -831.1828287061958, -508.5802687069014, -923.2168336196099, -785.5756714372324, -759.4542231086538, -2.2685132411866284, -321.3857152304395, -1386.0537476640077, -777.6834260090396, -1011.5331852445341, -1173.2253554711538, -952.371248103716, -143.53967582782528, -288.72766747535115, -54.831823829174525, -223.06084485629364, -158.39333800032261, -791.6254870565235, -133.30290687808903, -755.2729464682478, -1272.8910548299507, -333.2412430296178, -806.712656135216, -626.2128227895107, -953.0316995448544, -435.5717439931553, -1163.178860241422, -185.79445347886013, -73.51012134534996, -193.88391931107367, -80.15911649752555, -817.8258525162985, -347.27733808119484, -700.776951714687, -19.144608797187516, -359.58821051605935, -87.67315848473284, -1249.7325581094547, -161.5195269355069, -667.1098501624544, -936.4661944330988, -546.8809985346473, -648.522623565954, -522.9337056518779, -124.608838470762, -833.1358086373699, -997.9212745713684, -141.6984547277799, -898.5054035315568, -211.43882760140258, -170.1286950435648, -972.6563392698741, -293.2651678374136, -1025.8132787260872, -360.7864862604636, -1019.1611263283235, -1365.197089989283, -34.899994072900554, -573.0576788248303, -558.9305592160288, -420.51775515596614, -1206.98069867015, -82.33840899267702, -402.3691271004859, -277.90090320636705, -778.3796614911369, -545.8884244752738, -818.5715276583699, -544.9867121564243, -33.58628083774644, -1155.8131260466507, -488.88795842654974, -1331.3070331371373, -511.65752074615847, -1138.4262495269595, -429.064272356924, -70.3733258500092, -988.6692772181215, -197.85312015130873, -315.03137372193214, -343.3512241459261, -112.35668520277488, -725.2272675547039, -867.6607859954695, -919.7145357508639, -595.056333934605, -998.8324255756932, -504.6455941105005, -514.2495952942735, -1152.3184352441663, -777.0289652991709, -62.366564746198286, -131.1077680753753, -989.7633740975463, -432.81749815643775, -688.8877511839466, -527.555074015216, -208.3252340363486, -164.17844160471267, -573.1069283476345, -368.67308770973796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5987111125596762, "mean_inference_ms": 1.7290068650027204, "mean_action_processing_ms": 0.8591235022992221, "mean_env_wait_ms": 10.75556355505261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013248682022094727, "StateBufferConnector_ms": 0.009656667709350586, "ViewRequirementAgentConnector_ms": 0.3330347537994385}, "num_episodes": 21, "episode_return_max": -1042.7638039759586, "episode_return_min": -5184.233823926187, "episode_return_mean": -2721.220500629599, "episodes_this_iter": 21}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684959, "num_agent_steps_trained": 684959, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 86.97677310434717, "num_env_steps_trained_throughput_per_sec": 86.97677310434717, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 684959, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 684959, "timers": {"training_iteration_time_ms": 48860.695, "restore_workers_time_ms": 0.022, "training_step_time_ms": 48860.633, "sample_time_ms": 3340.417, "learn_time_ms": 45460.141, "learn_throughput": 87.989, "synch_weights_time_ms": 57.142}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 684959, "num_agent_steps_trained": 684959}, "done": false, "training_iteration": 38, "trial_id": "05c72_00000", "date": "2024-07-26_15-15-44", "timestamp": 1721987144, "time_this_iter_s": 45.99926233291626, "time_total_s": 1964.5484085083008, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d3c3b28c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1964.5484085083008, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 14.365151515151513, "ram_util_percent": 31.349999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.48611798772106, "cur_kl_coeff": 0.33749999999999997, "cur_lr": 0.001, "total_loss": 4.667319966631907, "policy_loss": -0.0031855024684099825, "vf_loss": 4.687764486449736, "vf_explained_var": 0.9868727577505289, "kl": 0.018502482404329824, "entropy": 2.3503597384249724, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.54166666666667, "num_grad_updates_lifetime": 163350.5, "diff_num_grad_updates_vs_sampler_policy": 2159.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 703325, "num_agent_steps_trained": 703325}, "env_runners": {"episode_reward_max": -1255.6334339600085, "episode_reward_min": -4669.881429619178, "episode_reward_mean": -2691.417621428525, "episode_len_mean": 149.42, "episode_media": {}, "episodes_timesteps_total": 14942, "policy_reward_min": {"policy_0": -1505.4969322009997}, "policy_reward_max": {"policy_0": 1.3408777846518412}, "policy_reward_mean": {"policy_0": -538.283524285705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2671.5710085510887, -1344.6545202207424, -2680.545690368288, -1653.812468292639, -3003.3732188910826, -2265.009627066409, -2801.2923192800854, -2210.7374841286437, -3996.513441758102, -2394.183951523475, -1546.073887563656, -3785.9014440023057, -2505.117341283737, -2888.9684218867546, -1384.1612076004376, -2879.019078895667, -2577.934260768343, -3895.13488362577, -1555.3497751914333, -3589.107070583228, -2066.7865983306338, -4002.260727453224, -3058.3368239568513, -1287.335527701916, -3583.9217963073947, -3008.8282623645355, -3218.0282733038543, -2451.0698343437552, -2047.6543580483437, -2975.6621599775494, -2655.9759676369263, -1641.482829547673, -4059.230646874447, -3853.9125403844505, -1607.3943043647548, -2983.035243402575, -2486.9820567991446, -1434.0245856125669, -2381.8904445943444, -1760.1606120924537, -2226.8970774539107, -2979.095510113587, -4669.881429619178, -1662.5312600923612, -3111.485733233132, -3154.7701654923553, -1696.52647087423, -2244.6129616254275, -3102.5012881252464, -2676.0819748606123, -2419.692655475672, -3671.6823984221583, -2952.6030772590116, -2747.968799460816, -3098.846071174467, -3899.343034193726, -1915.2783210872965, -3220.01560843842, -3947.0750155238056, -2304.9429562595074, -1841.838765713649, -1742.0271135083442, -3696.595641370964, -2685.03686363767, -2679.8107065738063, -2574.415614314113, -3766.8988929463108, -2321.055649970609, -3616.551403165397, -3280.7536881866226, -2391.724274692958, -1377.7334564403566, -2954.5935736631013, -3236.0400823597515, -2239.315730224762, -2572.3767663312933, -1990.2618963392824, -1301.5354946128268, -3290.500416885586, -3322.598303561198, -1255.6334339600085, -1815.1991256725917, -2725.472925405409, -4055.2685679141505, -3318.437475220937, -3237.5891675717016, -3069.5217792159274, -2010.735700799411, -3114.017254934061, -2451.821302305856, -2138.003046197066, -2083.3757123128776, -3579.762149958667, -3077.2608061771266, -2533.6982865522355, -2298.1261941682124, -3387.8789594871837, -3474.315687831112, -3095.9335250341733, -1643.7802042709616], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1358.6086688449834, -259.6681513142478, -638.3144661478568, -138.94386620508106, -276.0358560389211, -130.6626254267022, -136.63698258704986, -846.3831330046941, -21.36341198013542, -209.60836722216152, -450.49224302929, -345.6866790627285, -786.3125465104227, -452.7189625959165, -645.33525916993, -443.5019074756135, -533.3180822592518, -449.8709592989251, -154.2414352037626, -72.88008405508624, -477.3859103397469, -224.07200381572238, -789.0178817858257, -995.1047538990522, -517.792669050731, -865.5852599985295, -835.7995729216451, -265.2774157207229, -150.40064939871746, -147.9467290267919, -95.32342491114392, -790.6790573160488, -237.3423886343505, -657.2265186150103, -1020.7209298035301, -453.10781985038005, -340.80140497253234, -337.29763538339654, -7.705945171013943, -1071.8246787513203, -1174.4001660832346, -405.0519971280751, -808.2059661123128, -750.2193578758565, -858.6359545586216, -485.22353107900807, -108.82305564353045, -1179.8820924438826, -128.18814345149676, -492.06712890555394, -661.5884185460338, -94.29662391733285, -530.752036677286, -155.91583710906843, -103.52097131393337, -690.1668848428333, -709.7193865572766, -623.8135513225551, -1268.0465278214424, -494.1550934581975, -280.0180499399952, -386.49107461963683, -1029.7199799494094, -300.09886139845275, -508.7893753762451, -355.50396963536764, -1134.748086664989, -386.27302016601743, -444.68255461496346, -567.7607908054165, -116.74461954526312, -385.14477179339974, -665.5473561439228, -73.06942278976796, -143.6550373280841, -1321.9633186528356, -215.8141116680962, -235.55577044565342, -49.21269811142936, -1056.4731800176503, -231.1627978993198, -299.50479817753455, -683.8207379162427, -780.5702680899659, -582.875658685281, -234.36086643873793, -1013.1344429091816, -1033.5707035932717, -1165.9503401953907, -448.11853048919124, -263.02816453750677, -172.2426183551583, -186.0291406053365, -505.9198888525439, -428.129962840889, -715.5103818202075, -1195.516984220873, -344.4307136819295, -469.8347724381034, -863.8142184221152, -89.0084892614202, -926.033351874893, -514.9725384643966, -241.47472502124222, -295.29749370867995, -795.8350515662515, -1220.715976614018, -876.670990216025, -756.4825405434585, -352.55616851346855, -253.38443002134468, -944.2773054818022, -630.3512220353266, -125.96957115362092, -1104.3542952647547, -537.5932540073451, -26.102670839179847, -2.0307539855114696, -320.44430122091484, -401.16454764896537, -546.3515183337161, -822.2737436870334, -1054.828276739504, -298.1631315491784, -862.3051259979595, -947.9816732959922, -47.56586395518424, -1139.4569687171243, -778.2419591084142, -95.58179728781899, -913.2678362243169, -551.4764700580424, -129.40469961908929, -1130.1831413573611, -493.6961260450454, -330.09692680222463, -47.23347148267845, -79.55447543261147, -947.8683443339692, -1046.3166162922719, -422.9069762794587, -350.3802711977041, -437.40303675698726, -66.86933458137067, -770.0947392328221, -804.5545182393819, -764.3820867094926, -36.74375341419751, -50.7546039537303, -1319.2271976607462, -812.2995685485473, -304.2705446482616, -711.0337691463795, -390.8105435314571, -437.56154176228074, -976.5137687785855, -292.61159223745005, -213.46666466656595, -33.14971613943707, -125.74108772563392, -994.698243487486, -352.22509817644533, -1154.1223233274281, -516.5909837358874, -1041.5939981471981, -88.8292659750264, -954.7099889062404, -1099.6910974539517, -349.6801598716917, -1361.0020281775414, -30.114498187867778, -217.5188630549729, -464.9729400359709, -823.9368823624529, -70.85112072348949, -358.80661311391003, -669.0385394864984, -817.7523214284605, -393.09608683378605, -744.3416825399206, -148.05308526415436, -1198.1343425881848, -505.21091884629413, -321.8156520880953, -313.768058012415, -31.02712524414747, -940.4205034053608, -140.80548867642034, -10.214024955335056, -311.55744333130394, -642.0519468177921, -219.9270117893373, -454.8753946731851, -413.9230722885503, -651.113019025478, -63.52760842824401, -116.21452316624206, -351.3299134671937, -589.5507149591252, -639.5378520716497, -470.8737720214005, -543.2224945629722, -132.55118459027827, -249.06679757306125, -831.1828287061958, -508.5802687069014, -923.2168336196099, -785.5756714372324, -759.4542231086538, -2.2685132411866284, -321.3857152304395, -1386.0537476640077, -777.6834260090396, -1011.5331852445341, -1173.2253554711538, -952.371248103716, -143.53967582782528, -288.72766747535115, -54.831823829174525, -223.06084485629364, -158.39333800032261, -791.6254870565235, -133.30290687808903, -755.2729464682478, -1272.8910548299507, -333.2412430296178, -806.712656135216, -626.2128227895107, -953.0316995448544, -435.5717439931553, -1163.178860241422, -185.79445347886013, -73.51012134534996, -193.88391931107367, -80.15911649752555, -817.8258525162985, -347.27733808119484, -700.776951714687, -19.144608797187516, -359.58821051605935, -87.67315848473284, -1249.7325581094547, -161.5195269355069, -667.1098501624544, -936.4661944330988, -546.8809985346473, -648.522623565954, -522.9337056518779, -124.608838470762, -833.1358086373699, -997.9212745713684, -141.6984547277799, -898.5054035315568, -211.43882760140258, -170.1286950435648, -972.6563392698741, -293.2651678374136, -1025.8132787260872, -360.7864862604636, -1019.1611263283235, -1365.197089989283, -34.899994072900554, -573.0576788248303, -558.9305592160288, -420.51775515596614, -1206.98069867015, -82.33840899267702, -402.3691271004859, -277.90090320636705, -778.3796614911369, -545.8884244752738, -818.5715276583699, -544.9867121564243, -33.58628083774644, -1155.8131260466507, -488.88795842654974, -1331.3070331371373, -511.65752074615847, -1138.4262495269595, -429.064272356924, -70.3733258500092, -988.6692772181215, -197.85312015130873, -315.03137372193214, -343.3512241459261, -112.35668520277488, -725.2272675547039, -867.6607859954695, -919.7145357508639, -595.056333934605, -998.8324255756932, -504.6455941105005, -514.2495952942735, -1152.3184352441663, -777.0289652991709, -62.366564746198286, -131.1077680753753, -989.7633740975463, -432.81749815643775, -688.8877511839466, -527.555074015216, -208.3252340363486, -164.17844160471267, -573.1069283476345, -368.67308770973796, -627.7933284164562, -135.32409564932834, -124.9379569414949, -717.6706812953284, -136.30105120573623, -403.3588974127549, -1131.6257339278297, -345.38829730416546, -660.6290846432646, -1155.5936280829492, -1182.498952309876, -46.69654759702054, -105.22056200604203, -408.1229848949219, -942.4978168298094, -98.67401531251754, -675.705261618512, -1505.4969322009997, -175.7344967494569, -224.20000069232145, -246.64317177614305, -518.8386852177313, -666.7793299614041, -485.04134817890554, -657.1130791799288, -348.94620967679447, -278.9542938535051, -413.4381203573972, -1324.6830147696965, -1400.877254288921, -558.341750038555, -76.75960959300626, -68.41614701900816, -518.378163770725, -1099.1599795493153, -61.25862165722484, -1046.0165806589048, -513.8871500943108, -1247.8629258274475, -747.5261249275102, -142.82203992939426, -712.0026516657219, -479.6719143392157, -865.7056478665406, -1080.5514343857517, -30.406573516248063, -102.08931630543172, -844.7868890923296, -1363.706022192569, -50.735473586376386, -472.1275985505421, -471.9604754336523, -178.2922168367836, -80.05404180523959, -175.29912381413942, -470.6507211860678, -448.22135128195436, -741.7872948575848, -242.2215789149222, -1051.7126274225718, -794.256534935051, -107.0351112050166, -890.4458745363911, -950.2048379241326, -494.09772375915946, -862.41199952577, -263.1009384753218, -578.8801005322143, -399.7190975414571, -135.2035941500001, -951.3102570209419, -274.18116289571003, -552.4899452506762, -315.5372839966322, -478.85811716733303, -1055.4369911350723, -426.54390953400116, -404.03509099654315, -19.526951231837792, -84.71895344182954, 1.3408777846518412, -248.31038394152114, -467.46592159690994, -422.721701841891, -164.37836501715688, -320.59123698109073, -832.1685787358381, -1178.0726645626512, -525.6091128689682, -434.0588237370375, -1028.8746377052107, -549.9595071434856, -931.9349909037335, -572.8963533762883, -238.9328144324812, -191.9811649766153, -260.4840732353251, -210.06273707318098, -69.7032105479828, -523.4022481269046, -120.087501616013, -89.04196078193684, -486.303211743571, -81.22507499774706, -1038.5413765333224, -1101.1319611546307, -419.2127634415989, -39.87122639964476, -123.12297886220445, -1042.1339955473306, -454.16835164315324, -926.8772208881038, -798.7435131221142, -647.1197403407921, -1228.3597419199862, -811.0969584787341, -706.6303653008036, -408.09528435458657, -953.3690279025491, -439.2458391842639, -659.7056049924761, -986.7277767236874, -731.0051572042113, -360.0978509668905, -500.05277768444427, -1109.4832453078113, -789.7429124589454, -416.71876896304724, -695.3199967498113, -58.256855736314066, -219.85236776473272, -962.8966073496126, -89.21668997976606, -64.63714598277254, -674.132889722527, -265.5760750471746, -967.5107163039513, -552.8516608480721, -260.4329197176818, -1067.6458830171832, -225.8140818670689, -872.7564495914141, -1191.4646140061184, -73.63662048402212, -88.1495363572331, -580.6923873279122, -820.8666312542259, -692.643003104723, -26.925300403251974, -16.87572410695459, -424.104582260207, -336.2970995448169, -61.4447556144183, -987.7084228899735, -273.82085200346205, -751.2974677940211, -971.0300196681875, -390.1835145536602, -1069.6403772044189, -397.61077073838186, -172.00609894518533, -292.2208998663826, -1229.2747088011838, -996.8046263242126, -386.9544722401645, -105.24972971914231, -158.59784404725335, -842.9269153977372, -1272.6842814295949, -154.2395159585063, -625.5235783959037, -317.8121787032346, -218.29568191491182, -146.11805222208994, -990.3767029320722, -826.3151981464274, -1079.3775692058582, -49.762797778403325, -173.79755209440268, -1258.6258422620933, -823.0497120048407, -632.3246692740385, -1075.625451014099, -584.4961431333957, -358.8197124047381, -280.41730191390604, -587.4648810781183, -409.6725857640245, -1195.227751204642, -623.1510050734861, -242.99229728769828, -238.62885682057725, -528.3544401909915, -215.557084364213, -418.24752560748266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5969085376423837, "mean_inference_ms": 1.7311491871264377, "mean_action_processing_ms": 0.8586419085227623, "mean_env_wait_ms": 10.757108958940162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013471126556396484, "StateBufferConnector_ms": 0.010591745376586914, "ViewRequirementAgentConnector_ms": 0.33364367485046387}, "num_episodes": 39, "episode_return_max": -1255.6334339600085, "episode_return_min": -4669.881429619178, "episode_return_mean": -2691.417621428525, "episodes_this_iter": 39}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 703325, "num_agent_steps_trained": 703325, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 91.58793273853968, "num_env_steps_trained_throughput_per_sec": 91.58793273853968, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 703325, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 703325, "timers": {"training_iteration_time_ms": 48085.533, "restore_workers_time_ms": 0.022, "training_step_time_ms": 48085.471, "sample_time_ms": 3339.702, "learn_time_ms": 44687.518, "learn_throughput": 89.51, "synch_weights_time_ms": 55.288}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 703325, "num_agent_steps_trained": 703325}, "done": false, "training_iteration": 39, "trial_id": "05c72_00000", "date": "2024-07-26_15-16-28", "timestamp": 1721987188, "time_this_iter_s": 43.686057806015015, "time_total_s": 2008.2344663143158, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e4af0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2008.2344663143158, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 13.525806451612903, "ram_util_percent": 31.190322580645162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.40394688364285, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000002, "total_loss": 4.79385786667392, "policy_loss": -0.0037607324812375937, "vf_loss": 4.81533753705855, "vf_explained_var": 0.9850887396145815, "kl": 0.016136871295885848, "entropy": 2.3165141782950407, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.68656716417911, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 2009.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 720435, "num_agent_steps_trained": 720435}, "env_runners": {"episode_reward_max": -1255.6334339600085, "episode_reward_min": -4669.881429619178, "episode_reward_mean": -2756.049139348339, "episode_len_mean": 149.07, "episode_media": {}, "episodes_timesteps_total": 14907, "policy_reward_min": {"policy_0": -1505.4969322009997}, "policy_reward_max": {"policy_0": 1.3408777846518412}, "policy_reward_mean": {"policy_0": -551.209827869668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2066.7865983306338, -4002.260727453224, -3058.3368239568513, -1287.335527701916, -3583.9217963073947, -3008.8282623645355, -3218.0282733038543, -2451.0698343437552, -2047.6543580483437, -2975.6621599775494, -2655.9759676369263, -1641.482829547673, -4059.230646874447, -3853.9125403844505, -1607.3943043647548, -2983.035243402575, -2486.9820567991446, -1434.0245856125669, -2381.8904445943444, -1760.1606120924537, -2226.8970774539107, -2979.095510113587, -4669.881429619178, -1662.5312600923612, -3111.485733233132, -3154.7701654923553, -1696.52647087423, -2244.6129616254275, -3102.5012881252464, -2676.0819748606123, -2419.692655475672, -3671.6823984221583, -2952.6030772590116, -2747.968799460816, -3098.846071174467, -3899.343034193726, -1915.2783210872965, -3220.01560843842, -3947.0750155238056, -2304.9429562595074, -1841.838765713649, -1742.0271135083442, -3696.595641370964, -2685.03686363767, -2679.8107065738063, -2574.415614314113, -3766.8988929463108, -2321.055649970609, -3616.551403165397, -3280.7536881866226, -2391.724274692958, -1377.7334564403566, -2954.5935736631013, -3236.0400823597515, -2239.315730224762, -2572.3767663312933, -1990.2618963392824, -1301.5354946128268, -3290.500416885586, -3322.598303561198, -1255.6334339600085, -1815.1991256725917, -2725.472925405409, -4055.2685679141505, -3318.437475220937, -3237.5891675717016, -3069.5217792159274, -2010.735700799411, -3114.017254934061, -2451.821302305856, -2138.003046197066, -2083.3757123128776, -3579.762149958667, -3077.2608061771266, -2533.6982865522355, -2298.1261941682124, -3387.8789594871837, -3474.315687831112, -3095.9335250341733, -1643.7802042709616, -2602.689262836653, -2658.141559722932, -1265.5562347424807, -3268.9853914425876, -3057.2214303442397, -3018.438925829188, -4087.251370536542, -2909.380232678107, -2785.6875967866004, -2452.762769651662, -1891.2588638419104, -2804.6771622536403, -3242.341697092249, -2368.075670500763, -4589.924090991595, -1835.3001908473734, -2397.1686581074155, -3265.315403395497, -3193.287448011052, -4398.1489338508145], "episode_lengths": [150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-89.0084892614202, -926.033351874893, -514.9725384643966, -241.47472502124222, -295.29749370867995, -795.8350515662515, -1220.715976614018, -876.670990216025, -756.4825405434585, -352.55616851346855, -253.38443002134468, -944.2773054818022, -630.3512220353266, -125.96957115362092, -1104.3542952647547, -537.5932540073451, -26.102670839179847, -2.0307539855114696, -320.44430122091484, -401.16454764896537, -546.3515183337161, -822.2737436870334, -1054.828276739504, -298.1631315491784, -862.3051259979595, -947.9816732959922, -47.56586395518424, -1139.4569687171243, -778.2419591084142, -95.58179728781899, -913.2678362243169, -551.4764700580424, -129.40469961908929, -1130.1831413573611, -493.6961260450454, -330.09692680222463, -47.23347148267845, -79.55447543261147, -947.8683443339692, -1046.3166162922719, -422.9069762794587, -350.3802711977041, -437.40303675698726, -66.86933458137067, -770.0947392328221, -804.5545182393819, -764.3820867094926, -36.74375341419751, -50.7546039537303, -1319.2271976607462, -812.2995685485473, -304.2705446482616, -711.0337691463795, -390.8105435314571, -437.56154176228074, -976.5137687785855, -292.61159223745005, -213.46666466656595, -33.14971613943707, -125.74108772563392, -994.698243487486, -352.22509817644533, -1154.1223233274281, -516.5909837358874, -1041.5939981471981, -88.8292659750264, -954.7099889062404, -1099.6910974539517, -349.6801598716917, -1361.0020281775414, -30.114498187867778, -217.5188630549729, -464.9729400359709, -823.9368823624529, -70.85112072348949, -358.80661311391003, -669.0385394864984, -817.7523214284605, -393.09608683378605, -744.3416825399206, -148.05308526415436, -1198.1343425881848, -505.21091884629413, -321.8156520880953, -313.768058012415, -31.02712524414747, -940.4205034053608, -140.80548867642034, -10.214024955335056, -311.55744333130394, -642.0519468177921, -219.9270117893373, -454.8753946731851, -413.9230722885503, -651.113019025478, -63.52760842824401, -116.21452316624206, -351.3299134671937, -589.5507149591252, -639.5378520716497, -470.8737720214005, -543.2224945629722, -132.55118459027827, -249.06679757306125, -831.1828287061958, -508.5802687069014, -923.2168336196099, -785.5756714372324, -759.4542231086538, -2.2685132411866284, -321.3857152304395, -1386.0537476640077, -777.6834260090396, -1011.5331852445341, -1173.2253554711538, -952.371248103716, -143.53967582782528, -288.72766747535115, -54.831823829174525, -223.06084485629364, -158.39333800032261, -791.6254870565235, -133.30290687808903, -755.2729464682478, -1272.8910548299507, -333.2412430296178, -806.712656135216, -626.2128227895107, -953.0316995448544, -435.5717439931553, -1163.178860241422, -185.79445347886013, -73.51012134534996, -193.88391931107367, -80.15911649752555, -817.8258525162985, -347.27733808119484, -700.776951714687, -19.144608797187516, -359.58821051605935, -87.67315848473284, -1249.7325581094547, -161.5195269355069, -667.1098501624544, -936.4661944330988, -546.8809985346473, -648.522623565954, -522.9337056518779, -124.608838470762, -833.1358086373699, -997.9212745713684, -141.6984547277799, -898.5054035315568, -211.43882760140258, -170.1286950435648, -972.6563392698741, -293.2651678374136, -1025.8132787260872, -360.7864862604636, -1019.1611263283235, -1365.197089989283, -34.899994072900554, -573.0576788248303, -558.9305592160288, -420.51775515596614, -1206.98069867015, -82.33840899267702, -402.3691271004859, -277.90090320636705, -778.3796614911369, -545.8884244752738, -818.5715276583699, -544.9867121564243, -33.58628083774644, -1155.8131260466507, -488.88795842654974, -1331.3070331371373, -511.65752074615847, -1138.4262495269595, -429.064272356924, -70.3733258500092, -988.6692772181215, -197.85312015130873, -315.03137372193214, -343.3512241459261, -112.35668520277488, -725.2272675547039, -867.6607859954695, -919.7145357508639, -595.056333934605, -998.8324255756932, -504.6455941105005, -514.2495952942735, -1152.3184352441663, -777.0289652991709, -62.366564746198286, -131.1077680753753, -989.7633740975463, -432.81749815643775, -688.8877511839466, -527.555074015216, -208.3252340363486, -164.17844160471267, -573.1069283476345, -368.67308770973796, -627.7933284164562, -135.32409564932834, -124.9379569414949, -717.6706812953284, -136.30105120573623, -403.3588974127549, -1131.6257339278297, -345.38829730416546, -660.6290846432646, -1155.5936280829492, -1182.498952309876, -46.69654759702054, -105.22056200604203, -408.1229848949219, -942.4978168298094, -98.67401531251754, -675.705261618512, -1505.4969322009997, -175.7344967494569, -224.20000069232145, -246.64317177614305, -518.8386852177313, -666.7793299614041, -485.04134817890554, -657.1130791799288, -348.94620967679447, -278.9542938535051, -413.4381203573972, -1324.6830147696965, -1400.877254288921, -558.341750038555, -76.75960959300626, -68.41614701900816, -518.378163770725, -1099.1599795493153, -61.25862165722484, -1046.0165806589048, -513.8871500943108, -1247.8629258274475, -747.5261249275102, -142.82203992939426, -712.0026516657219, -479.6719143392157, -865.7056478665406, -1080.5514343857517, -30.406573516248063, -102.08931630543172, -844.7868890923296, -1363.706022192569, -50.735473586376386, -472.1275985505421, -471.9604754336523, -178.2922168367836, -80.05404180523959, -175.29912381413942, -470.6507211860678, -448.22135128195436, -741.7872948575848, -242.2215789149222, -1051.7126274225718, -794.256534935051, -107.0351112050166, -890.4458745363911, -950.2048379241326, -494.09772375915946, -862.41199952577, -263.1009384753218, -578.8801005322143, -399.7190975414571, -135.2035941500001, -951.3102570209419, -274.18116289571003, -552.4899452506762, -315.5372839966322, -478.85811716733303, -1055.4369911350723, -426.54390953400116, -404.03509099654315, -19.526951231837792, -84.71895344182954, 1.3408777846518412, -248.31038394152114, -467.46592159690994, -422.721701841891, -164.37836501715688, -320.59123698109073, -832.1685787358381, -1178.0726645626512, -525.6091128689682, -434.0588237370375, -1028.8746377052107, -549.9595071434856, -931.9349909037335, -572.8963533762883, -238.9328144324812, -191.9811649766153, -260.4840732353251, -210.06273707318098, -69.7032105479828, -523.4022481269046, -120.087501616013, -89.04196078193684, -486.303211743571, -81.22507499774706, -1038.5413765333224, -1101.1319611546307, -419.2127634415989, -39.87122639964476, -123.12297886220445, -1042.1339955473306, -454.16835164315324, -926.8772208881038, -798.7435131221142, -647.1197403407921, -1228.3597419199862, -811.0969584787341, -706.6303653008036, -408.09528435458657, -953.3690279025491, -439.2458391842639, -659.7056049924761, -986.7277767236874, -731.0051572042113, -360.0978509668905, -500.05277768444427, -1109.4832453078113, -789.7429124589454, -416.71876896304724, -695.3199967498113, -58.256855736314066, -219.85236776473272, -962.8966073496126, -89.21668997976606, -64.63714598277254, -674.132889722527, -265.5760750471746, -967.5107163039513, -552.8516608480721, -260.4329197176818, -1067.6458830171832, -225.8140818670689, -872.7564495914141, -1191.4646140061184, -73.63662048402212, -88.1495363572331, -580.6923873279122, -820.8666312542259, -692.643003104723, -26.925300403251974, -16.87572410695459, -424.104582260207, -336.2970995448169, -61.4447556144183, -987.7084228899735, -273.82085200346205, -751.2974677940211, -971.0300196681875, -390.1835145536602, -1069.6403772044189, -397.61077073838186, -172.00609894518533, -292.2208998663826, -1229.2747088011838, -996.8046263242126, -386.9544722401645, -105.24972971914231, -158.59784404725335, -842.9269153977372, -1272.6842814295949, -154.2395159585063, -625.5235783959037, -317.8121787032346, -218.29568191491182, -146.11805222208994, -990.3767029320722, -826.3151981464274, -1079.3775692058582, -49.762797778403325, -173.79755209440268, -1258.6258422620933, -823.0497120048407, -632.3246692740385, -1075.625451014099, -584.4961431333957, -358.8197124047381, -280.41730191390604, -587.4648810781183, -409.6725857640245, -1195.227751204642, -623.1510050734861, -242.99229728769828, -238.62885682057725, -528.3544401909915, -215.557084364213, -418.24752560748266, -330.7085083769471, -167.09204864742262, -667.2851266166153, -399.7900660297813, -1037.813513165888, -199.31640945572366, -857.5184029021572, -90.90028272426639, -337.98542306451844, -1172.4210415762643, -179.3797282373163, -86.14619430227881, -367.81931556659896, -274.8829356405786, -357.32806099570786, -185.0760029140796, -925.9520682374008, -122.85279953854602, -816.9161475748729, -1218.1883731776888, -848.8208441992924, -510.703264631745, -798.1822938476287, -689.2259743643135, -210.2890533012607, -1276.6047773256448, -809.9037644126528, -535.705893416307, -324.4210580726643, -71.80343260191849, -1075.302522803276, -545.2343731779005, -654.557846277591, -1162.9067013511442, -649.2499269266283, -963.6125329341511, -195.4701614795742, -510.82449308938016, -247.18580362618238, -992.2872415488214, -244.08838999802845, -492.97221358953743, -730.5751319818163, -692.9488376571519, -625.1030235600688, -99.63694694798183, -761.3163453426366, -295.6501819181328, -151.27720374032907, -1144.8820917025807, -154.3787282765195, -264.31434647497366, -732.889762541178, -118.05569764020932, -621.6203289090292, -281.67204429546035, -241.43974218908534, -1002.3103654723376, -1155.0053342919853, -124.24967600477054, -998.7330898281335, -352.58176233349764, -517.2089235399088, -31.71512349779604, -1342.1027978929108, -919.4683888630391, -21.898929029260284, -49.81380829835657, -934.3090139968356, -442.58553031327097, -237.90797914494985, -1109.3778387946518, -1013.1462853811051, -992.7022832611957, -1236.7897044096917, -240.35052471005616, -783.8923287445323, -687.0926144185037, -108.56263574921186, -15.402087225069467, -327.1272554630896, -365.39898598430983, -465.23584836063173, -505.36336850349187, -734.0431997958902, -1124.1268151230747, -1178.3792918240033, -41.668031143864816, -41.79241809715641, -879.3488472074001, -964.323026078858, -430.2904148514404, -899.1692609074317, -367.6525505279055, -531.852195645414, -1084.478518809392, -1293.2700003881528, -690.5856563473488, -899.6867159215835, -430.12804238433375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5945772709594732, "mean_inference_ms": 1.7288354062129891, "mean_action_processing_ms": 0.8547944568618233, "mean_env_wait_ms": 10.730154258778805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014308452606201172, "StateBufferConnector_ms": 0.010967493057250977, "ViewRequirementAgentConnector_ms": 0.3476722240447998}, "num_episodes": 20, "episode_return_max": -1255.6334339600085, "episode_return_min": -4669.881429619178, "episode_return_mean": -2756.049139348339, "episodes_this_iter": 20}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720435, "num_agent_steps_trained": 720435, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 90.88770673971639, "num_env_steps_trained_throughput_per_sec": 90.88770673971639, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 720435, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720435, "timers": {"training_iteration_time_ms": 47363.071, "restore_workers_time_ms": 0.023, "training_step_time_ms": 47363.008, "sample_time_ms": 3342.756, "learn_time_ms": 43964.148, "learn_throughput": 90.983, "synch_weights_time_ms": 53.211}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 720435, "num_agent_steps_trained": 720435}, "done": false, "training_iteration": 40, "trial_id": "05c72_00000", "date": "2024-07-26_15-17-12", "timestamp": 1721987232, "time_this_iter_s": 44.019832611083984, "time_total_s": 2052.2542989254, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e4c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2052.2542989254, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 14.750000000000002, "ram_util_percent": 30.54193548387097}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 186.8001066075643, "cur_kl_coeff": 0.3375, "cur_lr": 0.0010000000000000005, "total_loss": 4.725790550804138, "policy_loss": -0.0004092596221715212, "vf_loss": 4.743992373085022, "vf_explained_var": 0.9788698408285776, "kl": 0.018458799193706365, "entropy": 2.4022399318059287, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.904, "num_grad_updates_lifetime": 171405.5, "diff_num_grad_updates_vs_sampler_policy": 1874.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 736423, "num_agent_steps_trained": 736423}, "env_runners": {"episode_reward_max": -1226.2099982400912, "episode_reward_min": -4684.197435349102, "episode_reward_mean": -2773.0506264093683, "episode_len_mean": 149.31, "episode_media": {}, "episodes_timesteps_total": 14931, "policy_reward_min": {"policy_0": -1505.4969322009997}, "policy_reward_max": {"policy_0": 1.3408777846518412}, "policy_reward_mean": {"policy_0": -554.6101252818738}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2979.095510113587, -4669.881429619178, -1662.5312600923612, -3111.485733233132, -3154.7701654923553, -1696.52647087423, -2244.6129616254275, -3102.5012881252464, -2676.0819748606123, -2419.692655475672, -3671.6823984221583, -2952.6030772590116, -2747.968799460816, -3098.846071174467, -3899.343034193726, -1915.2783210872965, -3220.01560843842, -3947.0750155238056, -2304.9429562595074, -1841.838765713649, -1742.0271135083442, -3696.595641370964, -2685.03686363767, -2679.8107065738063, -2574.415614314113, -3766.8988929463108, -2321.055649970609, -3616.551403165397, -3280.7536881866226, -2391.724274692958, -1377.7334564403566, -2954.5935736631013, -3236.0400823597515, -2239.315730224762, -2572.3767663312933, -1990.2618963392824, -1301.5354946128268, -3290.500416885586, -3322.598303561198, -1255.6334339600085, -1815.1991256725917, -2725.472925405409, -4055.2685679141505, -3318.437475220937, -3237.5891675717016, -3069.5217792159274, -2010.735700799411, -3114.017254934061, -2451.821302305856, -2138.003046197066, -2083.3757123128776, -3579.762149958667, -3077.2608061771266, -2533.6982865522355, -2298.1261941682124, -3387.8789594871837, -3474.315687831112, -3095.9335250341733, -1643.7802042709616, -2602.689262836653, -2658.141559722932, -1265.5562347424807, -3268.9853914425876, -3057.2214303442397, -3018.438925829188, -4087.251370536542, -2909.380232678107, -2785.6875967866004, -2452.762769651662, -1891.2588638419104, -2804.6771622536403, -3242.341697092249, -2368.075670500763, -4589.924090991595, -1835.3001908473734, -2397.1686581074155, -3265.315403395497, -3193.287448011052, -4398.1489338508145, -1226.2099982400912, -2898.94215987455, -2844.1157527424593, -2300.7028309477278, -3652.4046606774964, -2483.920267227887, -2421.918762781236, -2278.5154467561633, -1639.0136429705515, -4684.197435349102, -3956.193084424282, -3484.417616709584, -2632.311075974537, -2471.5659670432906, -2766.122074791551, -2220.7272152057585, -2317.8810874475134, -2395.2848012983277, -2287.364770298678, -2453.850907704677, -3075.3598181888233], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-508.5802687069014, -923.2168336196099, -785.5756714372324, -759.4542231086538, -2.2685132411866284, -321.3857152304395, -1386.0537476640077, -777.6834260090396, -1011.5331852445341, -1173.2253554711538, -952.371248103716, -143.53967582782528, -288.72766747535115, -54.831823829174525, -223.06084485629364, -158.39333800032261, -791.6254870565235, -133.30290687808903, -755.2729464682478, -1272.8910548299507, -333.2412430296178, -806.712656135216, -626.2128227895107, -953.0316995448544, -435.5717439931553, -1163.178860241422, -185.79445347886013, -73.51012134534996, -193.88391931107367, -80.15911649752555, -817.8258525162985, -347.27733808119484, -700.776951714687, -19.144608797187516, -359.58821051605935, -87.67315848473284, -1249.7325581094547, -161.5195269355069, -667.1098501624544, -936.4661944330988, -546.8809985346473, -648.522623565954, -522.9337056518779, -124.608838470762, -833.1358086373699, -997.9212745713684, -141.6984547277799, -898.5054035315568, -211.43882760140258, -170.1286950435648, -972.6563392698741, -293.2651678374136, -1025.8132787260872, -360.7864862604636, -1019.1611263283235, -1365.197089989283, -34.899994072900554, -573.0576788248303, -558.9305592160288, -420.51775515596614, -1206.98069867015, -82.33840899267702, -402.3691271004859, -277.90090320636705, -778.3796614911369, -545.8884244752738, -818.5715276583699, -544.9867121564243, -33.58628083774644, -1155.8131260466507, -488.88795842654974, -1331.3070331371373, -511.65752074615847, -1138.4262495269595, -429.064272356924, -70.3733258500092, -988.6692772181215, -197.85312015130873, -315.03137372193214, -343.3512241459261, -112.35668520277488, -725.2272675547039, -867.6607859954695, -919.7145357508639, -595.056333934605, -998.8324255756932, -504.6455941105005, -514.2495952942735, -1152.3184352441663, -777.0289652991709, -62.366564746198286, -131.1077680753753, -989.7633740975463, -432.81749815643775, -688.8877511839466, -527.555074015216, -208.3252340363486, -164.17844160471267, -573.1069283476345, -368.67308770973796, -627.7933284164562, -135.32409564932834, -124.9379569414949, -717.6706812953284, -136.30105120573623, -403.3588974127549, -1131.6257339278297, -345.38829730416546, -660.6290846432646, -1155.5936280829492, -1182.498952309876, -46.69654759702054, -105.22056200604203, -408.1229848949219, -942.4978168298094, -98.67401531251754, -675.705261618512, -1505.4969322009997, -175.7344967494569, -224.20000069232145, -246.64317177614305, -518.8386852177313, -666.7793299614041, -485.04134817890554, -657.1130791799288, -348.94620967679447, -278.9542938535051, -413.4381203573972, -1324.6830147696965, -1400.877254288921, -558.341750038555, -76.75960959300626, -68.41614701900816, -518.378163770725, -1099.1599795493153, -61.25862165722484, -1046.0165806589048, -513.8871500943108, -1247.8629258274475, -747.5261249275102, -142.82203992939426, -712.0026516657219, -479.6719143392157, -865.7056478665406, -1080.5514343857517, -30.406573516248063, -102.08931630543172, -844.7868890923296, -1363.706022192569, -50.735473586376386, -472.1275985505421, -471.9604754336523, -178.2922168367836, -80.05404180523959, -175.29912381413942, -470.6507211860678, -448.22135128195436, -741.7872948575848, -242.2215789149222, -1051.7126274225718, -794.256534935051, -107.0351112050166, -890.4458745363911, -950.2048379241326, -494.09772375915946, -862.41199952577, -263.1009384753218, -578.8801005322143, -399.7190975414571, -135.2035941500001, -951.3102570209419, -274.18116289571003, -552.4899452506762, -315.5372839966322, -478.85811716733303, -1055.4369911350723, -426.54390953400116, -404.03509099654315, -19.526951231837792, -84.71895344182954, 1.3408777846518412, -248.31038394152114, -467.46592159690994, -422.721701841891, -164.37836501715688, -320.59123698109073, -832.1685787358381, -1178.0726645626512, -525.6091128689682, -434.0588237370375, -1028.8746377052107, -549.9595071434856, -931.9349909037335, -572.8963533762883, -238.9328144324812, -191.9811649766153, -260.4840732353251, -210.06273707318098, -69.7032105479828, -523.4022481269046, -120.087501616013, -89.04196078193684, -486.303211743571, -81.22507499774706, -1038.5413765333224, -1101.1319611546307, -419.2127634415989, -39.87122639964476, -123.12297886220445, -1042.1339955473306, -454.16835164315324, -926.8772208881038, -798.7435131221142, -647.1197403407921, -1228.3597419199862, -811.0969584787341, -706.6303653008036, -408.09528435458657, -953.3690279025491, -439.2458391842639, -659.7056049924761, -986.7277767236874, -731.0051572042113, -360.0978509668905, -500.05277768444427, -1109.4832453078113, -789.7429124589454, -416.71876896304724, -695.3199967498113, -58.256855736314066, -219.85236776473272, -962.8966073496126, -89.21668997976606, -64.63714598277254, -674.132889722527, -265.5760750471746, -967.5107163039513, -552.8516608480721, -260.4329197176818, -1067.6458830171832, -225.8140818670689, -872.7564495914141, -1191.4646140061184, -73.63662048402212, -88.1495363572331, -580.6923873279122, -820.8666312542259, -692.643003104723, -26.925300403251974, -16.87572410695459, -424.104582260207, -336.2970995448169, -61.4447556144183, -987.7084228899735, -273.82085200346205, -751.2974677940211, -971.0300196681875, -390.1835145536602, -1069.6403772044189, -397.61077073838186, -172.00609894518533, -292.2208998663826, -1229.2747088011838, -996.8046263242126, -386.9544722401645, -105.24972971914231, -158.59784404725335, -842.9269153977372, -1272.6842814295949, -154.2395159585063, -625.5235783959037, -317.8121787032346, -218.29568191491182, -146.11805222208994, -990.3767029320722, -826.3151981464274, -1079.3775692058582, -49.762797778403325, -173.79755209440268, -1258.6258422620933, -823.0497120048407, -632.3246692740385, -1075.625451014099, -584.4961431333957, -358.8197124047381, -280.41730191390604, -587.4648810781183, -409.6725857640245, -1195.227751204642, -623.1510050734861, -242.99229728769828, -238.62885682057725, -528.3544401909915, -215.557084364213, -418.24752560748266, -330.7085083769471, -167.09204864742262, -667.2851266166153, -399.7900660297813, -1037.813513165888, -199.31640945572366, -857.5184029021572, -90.90028272426639, -337.98542306451844, -1172.4210415762643, -179.3797282373163, -86.14619430227881, -367.81931556659896, -274.8829356405786, -357.32806099570786, -185.0760029140796, -925.9520682374008, -122.85279953854602, -816.9161475748729, -1218.1883731776888, -848.8208441992924, -510.703264631745, -798.1822938476287, -689.2259743643135, -210.2890533012607, -1276.6047773256448, -809.9037644126528, -535.705893416307, -324.4210580726643, -71.80343260191849, -1075.302522803276, -545.2343731779005, -654.557846277591, -1162.9067013511442, -649.2499269266283, -963.6125329341511, -195.4701614795742, -510.82449308938016, -247.18580362618238, -992.2872415488214, -244.08838999802845, -492.97221358953743, -730.5751319818163, -692.9488376571519, -625.1030235600688, -99.63694694798183, -761.3163453426366, -295.6501819181328, -151.27720374032907, -1144.8820917025807, -154.3787282765195, -264.31434647497366, -732.889762541178, -118.05569764020932, -621.6203289090292, -281.67204429546035, -241.43974218908534, -1002.3103654723376, -1155.0053342919853, -124.24967600477054, -998.7330898281335, -352.58176233349764, -517.2089235399088, -31.71512349779604, -1342.1027978929108, -919.4683888630391, -21.898929029260284, -49.81380829835657, -934.3090139968356, -442.58553031327097, -237.90797914494985, -1109.3778387946518, -1013.1462853811051, -992.7022832611957, -1236.7897044096917, -240.35052471005616, -783.8923287445323, -687.0926144185037, -108.56263574921186, -15.402087225069467, -327.1272554630896, -365.39898598430983, -465.23584836063173, -505.36336850349187, -734.0431997958902, -1124.1268151230747, -1178.3792918240033, -41.668031143864816, -41.79241809715641, -879.3488472074001, -964.323026078858, -430.2904148514404, -899.1692609074317, -367.6525505279055, -531.852195645414, -1084.478518809392, -1293.2700003881528, -690.5856563473488, -899.6867159215835, -430.12804238433375, -51.34875629380645, -255.9508807486114, -235.76394787056952, -45.29176065334132, -637.8546526737608, -25.737819901374344, -1153.4359302763307, -610.7804217894933, -268.3989989734529, -840.5889889338993, -696.6622755781406, -513.5219572017902, -122.6904930924002, -628.8010333959269, -882.4399934742031, -548.0315326728545, -48.00534986781438, -283.76924414229643, -215.5487673011074, -1205.3479369636548, -252.3130672972882, -50.29333037287837, -1248.550953195287, -1146.6981928623295, -954.5491169497109, -88.15819169131098, -80.59151126487141, -635.2603119489612, -773.0946336013772, -906.8156187213684, -218.98969720852986, -331.5262191084436, -1098.8057250594989, -90.09597181214025, -682.5011495926237, -877.2266636367289, -1113.6759864212, -77.34268195426375, -98.63393391400443, -111.63618082996501, -868.2751548894579, -365.3331124756613, -37.82707521962977, -185.72953377434808, -181.8487666114554, -748.3113846969447, -986.9627918153058, -737.5397682817508, -852.6247238553228, -1358.7587666997792, -1226.3736858342188, -1102.0051255816618, -13.549774705468025, -481.6809305654859, -1132.5835677374464, -313.17829500511505, -1341.7616420822828, -207.6202033592293, -923.6297632146889, -698.2277130482687, -61.30021835199696, -121.68680041776601, -1039.6100004328057, -236.2929694538826, -1173.421087318086, -448.2425329373356, -57.58432934512654, -969.5963853945955, -650.5985505366615, -345.5441688295704, -605.0617779029966, -122.917922333641, -160.4050089259698, -635.2675834795696, -1242.4697821493758, -997.9405690936662, -85.3628916393867, -738.2595672313965, -381.66319907967477, -17.50098816163355, -463.35415174572927, -1027.0423677222893, -9.312242214145225, -694.8215929590402, -123.3507328063085, -303.9368895388438, -1006.006986307306, -615.9939380328565, -246.07809388151142, -223.26889353781002, -495.0685771941985, -603.085626112158, -106.45261124497267, -965.699138615565, -117.05881713178024, -92.72759214282974, -93.95449669542451, -783.156139825252, -1224.3847611110566, -259.62791793011337, -217.37467434288718, -586.7063548600454, -856.7869381159005, -1228.602739265991, -185.8891116040006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5946018221418317, "mean_inference_ms": 1.7301731382549883, "mean_action_processing_ms": 0.8531259586564194, "mean_env_wait_ms": 10.725324318945404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015079259872436523, "StateBufferConnector_ms": 0.011472463607788086, "ViewRequirementAgentConnector_ms": 0.3625977039337158}, "num_episodes": 21, "episode_return_max": -1226.2099982400912, "episode_return_min": -4684.197435349102, "episode_return_mean": -2773.0506264093683, "episodes_this_iter": 21}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736423, "num_agent_steps_trained": 736423, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 102.6028196728971, "num_env_steps_trained_throughput_per_sec": 102.6028196728971, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 736423, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736423, "timers": {"training_iteration_time_ms": 45915.489, "restore_workers_time_ms": 0.023, "training_step_time_ms": 45915.425, "sample_time_ms": 3325.604, "learn_time_ms": 42533.102, "learn_throughput": 94.044, "synch_weights_time_ms": 53.828}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 736423, "num_agent_steps_trained": 736423}, "done": false, "training_iteration": 41, "trial_id": "05c72_00000", "date": "2024-07-26_15-17-51", "timestamp": 1721987271, "time_this_iter_s": 38.99515652656555, "time_total_s": 2091.2494554519653, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805ab520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2091.2494554519653, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.607142857142858, "ram_util_percent": 29.862499999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 161.4262017580668, "cur_kl_coeff": 0.33749999999999997, "cur_lr": 0.001, "total_loss": 4.963459698465136, "policy_loss": -0.0035476899907613793, "vf_loss": 4.982985246128506, "vf_explained_var": 0.9781025341616737, "kl": 0.01901303579068432, "entropy": 2.2394756119251253, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.48666666666666, "num_grad_updates_lifetime": 175530.5, "diff_num_grad_updates_vs_sampler_policy": 2249.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 755546, "num_agent_steps_trained": 755546}, "env_runners": {"episode_reward_max": -876.5735809464552, "episode_reward_min": -4684.197435349102, "episode_reward_mean": -2679.0831736038986, "episode_len_mean": 148.95, "episode_media": {}, "episodes_timesteps_total": 14895, "policy_reward_min": {"policy_0": -1542.993177654162}, "policy_reward_max": {"policy_0": -4.790689005659377}, "policy_reward_mean": {"policy_0": -535.8166347207797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1255.6334339600085, -1815.1991256725917, -2725.472925405409, -4055.2685679141505, -3318.437475220937, -3237.5891675717016, -3069.5217792159274, -2010.735700799411, -3114.017254934061, -2451.821302305856, -2138.003046197066, -2083.3757123128776, -3579.762149958667, -3077.2608061771266, -2533.6982865522355, -2298.1261941682124, -3387.8789594871837, -3474.315687831112, -3095.9335250341733, -1643.7802042709616, -2602.689262836653, -2658.141559722932, -1265.5562347424807, -3268.9853914425876, -3057.2214303442397, -3018.438925829188, -4087.251370536542, -2909.380232678107, -2785.6875967866004, -2452.762769651662, -1891.2588638419104, -2804.6771622536403, -3242.341697092249, -2368.075670500763, -4589.924090991595, -1835.3001908473734, -2397.1686581074155, -3265.315403395497, -3193.287448011052, -4398.1489338508145, -1226.2099982400912, -2898.94215987455, -2844.1157527424593, -2300.7028309477278, -3652.4046606774964, -2483.920267227887, -2421.918762781236, -2278.5154467561633, -1639.0136429705515, -4684.197435349102, -3956.193084424282, -3484.417616709584, -2632.311075974537, -2471.5659670432906, -2766.122074791551, -2220.7272152057585, -2317.8810874475134, -2395.2848012983277, -2287.364770298678, -2453.850907704677, -3075.3598181888233, -2657.9729476231646, -3542.18639956332, -3247.634228162553, -1742.500049904509, -2759.706116814578, -2158.231981900153, -2819.9635620710897, -2860.936317806583, -3343.473403836201, -3835.389699273494, -1485.39969994736, -3904.058273071745, -1480.7038190287399, -2076.5862944867617, -2440.9387891956403, -2521.1327880268427, -1147.7234281996682, -2794.909762168897, -2775.496171745715, -1917.1912455639983, -1910.8559123780246, -876.5735809464552, -4683.261476662898, -2376.6080584323568, -2990.130264736453, -2990.594690659365, -1814.9766229158565, -1911.2167916933395, -1939.3083943002416, -2528.122450297421, -2458.930437782014, -1131.504514993123, -3129.9674387151613, -2184.1012208661186, -2678.7071240289197, -2537.503305634608, -3113.914104557285, -3292.2314936073485, -2899.2109236845768], "episode_lengths": [116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-191.9811649766153, -260.4840732353251, -210.06273707318098, -69.7032105479828, -523.4022481269046, -120.087501616013, -89.04196078193684, -486.303211743571, -81.22507499774706, -1038.5413765333224, -1101.1319611546307, -419.2127634415989, -39.87122639964476, -123.12297886220445, -1042.1339955473306, -454.16835164315324, -926.8772208881038, -798.7435131221142, -647.1197403407921, -1228.3597419199862, -811.0969584787341, -706.6303653008036, -408.09528435458657, -953.3690279025491, -439.2458391842639, -659.7056049924761, -986.7277767236874, -731.0051572042113, -360.0978509668905, -500.05277768444427, -1109.4832453078113, -789.7429124589454, -416.71876896304724, -695.3199967498113, -58.256855736314066, -219.85236776473272, -962.8966073496126, -89.21668997976606, -64.63714598277254, -674.132889722527, -265.5760750471746, -967.5107163039513, -552.8516608480721, -260.4329197176818, -1067.6458830171832, -225.8140818670689, -872.7564495914141, -1191.4646140061184, -73.63662048402212, -88.1495363572331, -580.6923873279122, -820.8666312542259, -692.643003104723, -26.925300403251974, -16.87572410695459, -424.104582260207, -336.2970995448169, -61.4447556144183, -987.7084228899735, -273.82085200346205, -751.2974677940211, -971.0300196681875, -390.1835145536602, -1069.6403772044189, -397.61077073838186, -172.00609894518533, -292.2208998663826, -1229.2747088011838, -996.8046263242126, -386.9544722401645, -105.24972971914231, -158.59784404725335, -842.9269153977372, -1272.6842814295949, -154.2395159585063, -625.5235783959037, -317.8121787032346, -218.29568191491182, -146.11805222208994, -990.3767029320722, -826.3151981464274, -1079.3775692058582, -49.762797778403325, -173.79755209440268, -1258.6258422620933, -823.0497120048407, -632.3246692740385, -1075.625451014099, -584.4961431333957, -358.8197124047381, -280.41730191390604, -587.4648810781183, -409.6725857640245, -1195.227751204642, -623.1510050734861, -242.99229728769828, -238.62885682057725, -528.3544401909915, -215.557084364213, -418.24752560748266, -330.7085083769471, -167.09204864742262, -667.2851266166153, -399.7900660297813, -1037.813513165888, -199.31640945572366, -857.5184029021572, -90.90028272426639, -337.98542306451844, -1172.4210415762643, -179.3797282373163, -86.14619430227881, -367.81931556659896, -274.8829356405786, -357.32806099570786, -185.0760029140796, -925.9520682374008, -122.85279953854602, -816.9161475748729, -1218.1883731776888, -848.8208441992924, -510.703264631745, -798.1822938476287, -689.2259743643135, -210.2890533012607, -1276.6047773256448, -809.9037644126528, -535.705893416307, -324.4210580726643, -71.80343260191849, -1075.302522803276, -545.2343731779005, -654.557846277591, -1162.9067013511442, -649.2499269266283, -963.6125329341511, -195.4701614795742, -510.82449308938016, -247.18580362618238, -992.2872415488214, -244.08838999802845, -492.97221358953743, -730.5751319818163, -692.9488376571519, -625.1030235600688, -99.63694694798183, -761.3163453426366, -295.6501819181328, -151.27720374032907, -1144.8820917025807, -154.3787282765195, -264.31434647497366, -732.889762541178, -118.05569764020932, -621.6203289090292, -281.67204429546035, -241.43974218908534, -1002.3103654723376, -1155.0053342919853, -124.24967600477054, -998.7330898281335, -352.58176233349764, -517.2089235399088, -31.71512349779604, -1342.1027978929108, -919.4683888630391, -21.898929029260284, -49.81380829835657, -934.3090139968356, -442.58553031327097, -237.90797914494985, -1109.3778387946518, -1013.1462853811051, -992.7022832611957, -1236.7897044096917, -240.35052471005616, -783.8923287445323, -687.0926144185037, -108.56263574921186, -15.402087225069467, -327.1272554630896, -365.39898598430983, -465.23584836063173, -505.36336850349187, -734.0431997958902, -1124.1268151230747, -1178.3792918240033, -41.668031143864816, -41.79241809715641, -879.3488472074001, -964.323026078858, -430.2904148514404, -899.1692609074317, -367.6525505279055, -531.852195645414, -1084.478518809392, -1293.2700003881528, -690.5856563473488, -899.6867159215835, -430.12804238433375, -51.34875629380645, -255.9508807486114, -235.76394787056952, -45.29176065334132, -637.8546526737608, -25.737819901374344, -1153.4359302763307, -610.7804217894933, -268.3989989734529, -840.5889889338993, -696.6622755781406, -513.5219572017902, -122.6904930924002, -628.8010333959269, -882.4399934742031, -548.0315326728545, -48.00534986781438, -283.76924414229643, -215.5487673011074, -1205.3479369636548, -252.3130672972882, -50.29333037287837, -1248.550953195287, -1146.6981928623295, -954.5491169497109, -88.15819169131098, -80.59151126487141, -635.2603119489612, -773.0946336013772, -906.8156187213684, -218.98969720852986, -331.5262191084436, -1098.8057250594989, -90.09597181214025, -682.5011495926237, -877.2266636367289, -1113.6759864212, -77.34268195426375, -98.63393391400443, -111.63618082996501, -868.2751548894579, -365.3331124756613, -37.82707521962977, -185.72953377434808, -181.8487666114554, -748.3113846969447, -986.9627918153058, -737.5397682817508, -852.6247238553228, -1358.7587666997792, -1226.3736858342188, -1102.0051255816618, -13.549774705468025, -481.6809305654859, -1132.5835677374464, -313.17829500511505, -1341.7616420822828, -207.6202033592293, -923.6297632146889, -698.2277130482687, -61.30021835199696, -121.68680041776601, -1039.6100004328057, -236.2929694538826, -1173.421087318086, -448.2425329373356, -57.58432934512654, -969.5963853945955, -650.5985505366615, -345.5441688295704, -605.0617779029966, -122.917922333641, -160.4050089259698, -635.2675834795696, -1242.4697821493758, -997.9405690936662, -85.3628916393867, -738.2595672313965, -381.66319907967477, -17.50098816163355, -463.35415174572927, -1027.0423677222893, -9.312242214145225, -694.8215929590402, -123.3507328063085, -303.9368895388438, -1006.006986307306, -615.9939380328565, -246.07809388151142, -223.26889353781002, -495.0685771941985, -603.085626112158, -106.45261124497267, -965.699138615565, -117.05881713178024, -92.72759214282974, -93.95449669542451, -783.156139825252, -1224.3847611110566, -259.62791793011337, -217.37467434288718, -586.7063548600454, -856.7869381159005, -1228.602739265991, -185.8891116040006, -823.4350312160487, -178.65532145674342, -554.7816550752964, -235.53228340030103, -865.5686564747735, -521.7126154583752, -653.4496450083785, -926.2510694134153, -564.8217329577028, -875.9513367254481, -335.4820015796397, -420.27368535549914, -491.72822051250165, -1164.6502662694438, -835.5000544454666, -380.1295632677181, -361.2281872078121, -90.53699577537262, -630.0319028813686, -280.57340077223625, -917.0089081577264, -560.522852267368, -519.4417681456141, -323.67168639329276, -439.0609018505775, -376.4395401569147, -388.84642435548096, -794.1284803401395, -474.9125900770829, -123.90494697053558, -583.4079640072929, -699.2480838920278, -863.6085442231191, -251.2002036891403, -422.49876625951316, -346.13636756302566, -422.3374681718289, -721.9795858346255, -240.3854735709793, -1130.097422666125, -1184.5397660553422, -592.7176054868714, -687.7227034508174, -477.5977355661155, -400.89559327705655, -681.0574358650255, -1071.1797978715913, -647.7390329324851, -543.2555593213265, -892.1578732830699, -246.67582829134378, -229.81267081962747, -507.34372267506143, -481.61474689414126, -19.952731267186294, -846.6510177035021, -479.7599939701516, -677.7209248810884, -782.4695571062239, -1117.456779410777, -210.5701923447692, -410.77293970147286, -51.80312925345652, -197.01992456006917, -610.5376331689722, -417.8355031712143, -293.433356308988, -433.00791185024843, -183.42054024964145, -748.8889829066713, -46.24119523338371, -1021.0345014092034, -39.83591879515955, -619.2227619914195, -714.6044117664733, -617.4573190477053, -787.5486783213307, -789.7773934526093, -227.88671090575852, -98.46268629943917, -301.15654293163635, -26.96203684244385, -138.36079380018526, -622.5749585282617, -58.66909609714161, -856.2384344301042, -192.77032859700378, -123.25712007319022, -79.65070141443515, -1542.993177654162, -361.8053157112867, -141.61999382987426, -406.18900155954066, -686.6339279454992, -1179.2479326995126, -37.601035396478004, -188.2608038352781, -10.102885588352056, -1128.2086779172157, -553.0178428266756, -610.6429158391096, -277.9829883099005, -563.3434179708751, -240.2607062458821, -218.62588401225653, -187.71803014349175, -4.790689005659377, -144.7457482166316, -381.6518480305185, -157.66726555015453, -1076.3117758752921, -1508.9096875034345, -618.9459425281763, -774.7788221412239, -704.3152486147721, -178.77128343706883, -49.71262169985463, -635.2215415557107, -350.1007563477509, -1162.801855391971, -351.93325491249686, -831.199597327693, -1276.7131466025273, -136.18353398463333, -394.10073190910333, -416.27944334441673, -1280.3047234851454, -1087.230034425263, -86.66632609166712, -120.11416331286881, -664.3091409153649, -405.8378616680379, -81.01423020131122, -434.85788387154446, -228.95750625959826, -527.0580184540125, -374.10790799781375, -325.91807176166566, -390.5667555202889, -293.5660379595591, -485.8141189121973, -207.70863318478996, -351.6077542505693, -490.26863149428664, -403.9092564583975, -169.24168709795944, -1037.9266376541214, -427.1388840119605, -55.865643702890196, -837.9495978304901, -758.8361917779871, -566.9247235398665, -196.3425789957232, -875.5843145577287, -61.242628910708355, -143.05336448980188, -125.40049202255601, -39.131765951485946, -775.7535160252135, -48.165376504065314, -439.44676892492555, -821.5284436476206, -671.4141795978849, -888.7486726990373, -308.82937384569465, -1046.8223965938412, -567.9537448097662, -215.4011590399894, -117.10823945672998, -236.81568096579088, -201.45108809420873, -941.9007611690926, -115.19692546017873, -750.9479310339788, -669.2104182714635, -674.1298735925807, -850.9060962691716, -125.379398195313, -54.39383376306387, -832.694103814479, -434.78293682299574, -980.75600267734, -1321.8217368124053, -297.3421312236127, -79.2112970209302, -876.4506733878442, -448.6838354108395, -708.5546332097272, -386.2484494054839, -872.2939021934533, -564.35330859197, -1035.1795786521743, -73.93881085229371, -143.80646367761787, -1081.9327619105188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5951271053303986, "mean_inference_ms": 1.7341644442641755, "mean_action_processing_ms": 0.8534727756700258, "mean_env_wait_ms": 10.73890694335439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014876127243041992, "StateBufferConnector_ms": 0.010260343551635742, "ViewRequirementAgentConnector_ms": 0.3517169952392578}, "num_episodes": 39, "episode_return_max": -876.5735809464552, "episode_return_min": -4684.197435349102, "episode_return_mean": -2679.0831736038986, "episodes_this_iter": 39}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 755546, "num_agent_steps_trained": 755546, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.96160645580709, "num_env_steps_trained_throughput_per_sec": 76.96160645580709, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 755546, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 755546, "timers": {"training_iteration_time_ms": 46501.32, "restore_workers_time_ms": 0.024, "training_step_time_ms": 46501.255, "sample_time_ms": 3327.38, "learn_time_ms": 43115.688, "learn_throughput": 92.774, "synch_weights_time_ms": 55.205}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 755546, "num_agent_steps_trained": 755546}, "done": false, "training_iteration": 42, "trial_id": "05c72_00000", "date": "2024-07-26_15-18-43", "timestamp": 1721987323, "time_this_iter_s": 51.98609924316406, "time_total_s": 2143.2355546951294, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e6320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2143.2355546951294, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 11.850000000000001, "ram_util_percent": 30.050000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 171.30515441796717, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.687237379612067, "policy_loss": -0.005758642938871605, "vf_loss": 4.710502243103125, "vf_explained_var": 0.9897828085453082, "kl": 0.016868313059542114, "entropy": 2.319927838276594, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.76153846153846, "num_grad_updates_lifetime": 179730.5, "diff_num_grad_updates_vs_sampler_policy": 1949.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 772155, "num_agent_steps_trained": 772155}, "env_runners": {"episode_reward_max": -121.47465553914968, "episode_reward_min": -4867.803934058282, "episode_reward_mean": -2671.8052175373123, "episode_len_mean": 147.95, "episode_media": {}, "episodes_timesteps_total": 14795, "policy_reward_min": {"policy_0": -1542.993177654162}, "policy_reward_max": {"policy_0": 7.14921038071359}, "policy_reward_mean": {"policy_0": -534.3610435074623}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2658.141559722932, -1265.5562347424807, -3268.9853914425876, -3057.2214303442397, -3018.438925829188, -4087.251370536542, -2909.380232678107, -2785.6875967866004, -2452.762769651662, -1891.2588638419104, -2804.6771622536403, -3242.341697092249, -2368.075670500763, -4589.924090991595, -1835.3001908473734, -2397.1686581074155, -3265.315403395497, -3193.287448011052, -4398.1489338508145, -1226.2099982400912, -2898.94215987455, -2844.1157527424593, -2300.7028309477278, -3652.4046606774964, -2483.920267227887, -2421.918762781236, -2278.5154467561633, -1639.0136429705515, -4684.197435349102, -3956.193084424282, -3484.417616709584, -2632.311075974537, -2471.5659670432906, -2766.122074791551, -2220.7272152057585, -2317.8810874475134, -2395.2848012983277, -2287.364770298678, -2453.850907704677, -3075.3598181888233, -2657.9729476231646, -3542.18639956332, -3247.634228162553, -1742.500049904509, -2759.706116814578, -2158.231981900153, -2819.9635620710897, -2860.936317806583, -3343.473403836201, -3835.389699273494, -1485.39969994736, -3904.058273071745, -1480.7038190287399, -2076.5862944867617, -2440.9387891956403, -2521.1327880268427, -1147.7234281996682, -2794.909762168897, -2775.496171745715, -1917.1912455639983, -1910.8559123780246, -876.5735809464552, -4683.261476662898, -2376.6080584323568, -2990.130264736453, -2990.594690659365, -1814.9766229158565, -1911.2167916933395, -1939.3083943002416, -2528.122450297421, -2458.930437782014, -1131.504514993123, -3129.9674387151613, -2184.1012208661186, -2678.7071240289197, -2537.503305634608, -3113.914104557285, -3292.2314936073485, -2899.2109236845768, -3413.2303716332995, -1644.7185960095806, -121.47465553914968, -3320.875210226786, -2586.6712844752087, -1364.7257773915258, -3933.221977623119, -2587.633517220257, -3374.203927389313, -1648.532362284778, -2542.4797594459546, -1675.0462447662942, -4096.541411231591, -3163.139541179643, -3257.6744934093203, -4867.803934058282, -3897.770691065966, -2158.8899684592243, -3824.217491591253, -875.7756439917376, -1886.098102175429], "episode_lengths": [150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150], "policy_policy_0_reward": [-199.31640945572366, -857.5184029021572, -90.90028272426639, -337.98542306451844, -1172.4210415762643, -179.3797282373163, -86.14619430227881, -367.81931556659896, -274.8829356405786, -357.32806099570786, -185.0760029140796, -925.9520682374008, -122.85279953854602, -816.9161475748729, -1218.1883731776888, -848.8208441992924, -510.703264631745, -798.1822938476287, -689.2259743643135, -210.2890533012607, -1276.6047773256448, -809.9037644126528, -535.705893416307, -324.4210580726643, -71.80343260191849, -1075.302522803276, -545.2343731779005, -654.557846277591, -1162.9067013511442, -649.2499269266283, -963.6125329341511, -195.4701614795742, -510.82449308938016, -247.18580362618238, -992.2872415488214, -244.08838999802845, -492.97221358953743, -730.5751319818163, -692.9488376571519, -625.1030235600688, -99.63694694798183, -761.3163453426366, -295.6501819181328, -151.27720374032907, -1144.8820917025807, -154.3787282765195, -264.31434647497366, -732.889762541178, -118.05569764020932, -621.6203289090292, -281.67204429546035, -241.43974218908534, -1002.3103654723376, -1155.0053342919853, -124.24967600477054, -998.7330898281335, -352.58176233349764, -517.2089235399088, -31.71512349779604, -1342.1027978929108, -919.4683888630391, -21.898929029260284, -49.81380829835657, -934.3090139968356, -442.58553031327097, -237.90797914494985, -1109.3778387946518, -1013.1462853811051, -992.7022832611957, -1236.7897044096917, -240.35052471005616, -783.8923287445323, -687.0926144185037, -108.56263574921186, -15.402087225069467, -327.1272554630896, -365.39898598430983, -465.23584836063173, -505.36336850349187, -734.0431997958902, -1124.1268151230747, -1178.3792918240033, -41.668031143864816, -41.79241809715641, -879.3488472074001, -964.323026078858, -430.2904148514404, -899.1692609074317, -367.6525505279055, -531.852195645414, -1084.478518809392, -1293.2700003881528, -690.5856563473488, -899.6867159215835, -430.12804238433375, -51.34875629380645, -255.9508807486114, -235.76394787056952, -45.29176065334132, -637.8546526737608, -25.737819901374344, -1153.4359302763307, -610.7804217894933, -268.3989989734529, -840.5889889338993, -696.6622755781406, -513.5219572017902, -122.6904930924002, -628.8010333959269, -882.4399934742031, -548.0315326728545, -48.00534986781438, -283.76924414229643, -215.5487673011074, -1205.3479369636548, -252.3130672972882, -50.29333037287837, -1248.550953195287, -1146.6981928623295, -954.5491169497109, -88.15819169131098, -80.59151126487141, -635.2603119489612, -773.0946336013772, -906.8156187213684, -218.98969720852986, -331.5262191084436, -1098.8057250594989, -90.09597181214025, -682.5011495926237, -877.2266636367289, -1113.6759864212, -77.34268195426375, -98.63393391400443, -111.63618082996501, -868.2751548894579, -365.3331124756613, -37.82707521962977, -185.72953377434808, -181.8487666114554, -748.3113846969447, -986.9627918153058, -737.5397682817508, -852.6247238553228, -1358.7587666997792, -1226.3736858342188, -1102.0051255816618, -13.549774705468025, -481.6809305654859, -1132.5835677374464, -313.17829500511505, -1341.7616420822828, -207.6202033592293, -923.6297632146889, -698.2277130482687, -61.30021835199696, -121.68680041776601, -1039.6100004328057, -236.2929694538826, -1173.421087318086, -448.2425329373356, -57.58432934512654, -969.5963853945955, -650.5985505366615, -345.5441688295704, -605.0617779029966, -122.917922333641, -160.4050089259698, -635.2675834795696, -1242.4697821493758, -997.9405690936662, -85.3628916393867, -738.2595672313965, -381.66319907967477, -17.50098816163355, -463.35415174572927, -1027.0423677222893, -9.312242214145225, -694.8215929590402, -123.3507328063085, -303.9368895388438, -1006.006986307306, -615.9939380328565, -246.07809388151142, -223.26889353781002, -495.0685771941985, -603.085626112158, -106.45261124497267, -965.699138615565, -117.05881713178024, -92.72759214282974, -93.95449669542451, -783.156139825252, -1224.3847611110566, -259.62791793011337, -217.37467434288718, -586.7063548600454, -856.7869381159005, -1228.602739265991, -185.8891116040006, -823.4350312160487, -178.65532145674342, -554.7816550752964, -235.53228340030103, -865.5686564747735, -521.7126154583752, -653.4496450083785, -926.2510694134153, -564.8217329577028, -875.9513367254481, -335.4820015796397, -420.27368535549914, -491.72822051250165, -1164.6502662694438, -835.5000544454666, -380.1295632677181, -361.2281872078121, -90.53699577537262, -630.0319028813686, -280.57340077223625, -917.0089081577264, -560.522852267368, -519.4417681456141, -323.67168639329276, -439.0609018505775, -376.4395401569147, -388.84642435548096, -794.1284803401395, -474.9125900770829, -123.90494697053558, -583.4079640072929, -699.2480838920278, -863.6085442231191, -251.2002036891403, -422.49876625951316, -346.13636756302566, -422.3374681718289, -721.9795858346255, -240.3854735709793, -1130.097422666125, -1184.5397660553422, -592.7176054868714, -687.7227034508174, -477.5977355661155, -400.89559327705655, -681.0574358650255, -1071.1797978715913, -647.7390329324851, -543.2555593213265, -892.1578732830699, -246.67582829134378, -229.81267081962747, -507.34372267506143, -481.61474689414126, -19.952731267186294, -846.6510177035021, -479.7599939701516, -677.7209248810884, -782.4695571062239, -1117.456779410777, -210.5701923447692, -410.77293970147286, -51.80312925345652, -197.01992456006917, -610.5376331689722, -417.8355031712143, -293.433356308988, -433.00791185024843, -183.42054024964145, -748.8889829066713, -46.24119523338371, -1021.0345014092034, -39.83591879515955, -619.2227619914195, -714.6044117664733, -617.4573190477053, -787.5486783213307, -789.7773934526093, -227.88671090575852, -98.46268629943917, -301.15654293163635, -26.96203684244385, -138.36079380018526, -622.5749585282617, -58.66909609714161, -856.2384344301042, -192.77032859700378, -123.25712007319022, -79.65070141443515, -1542.993177654162, -361.8053157112867, -141.61999382987426, -406.18900155954066, -686.6339279454992, -1179.2479326995126, -37.601035396478004, -188.2608038352781, -10.102885588352056, -1128.2086779172157, -553.0178428266756, -610.6429158391096, -277.9829883099005, -563.3434179708751, -240.2607062458821, -218.62588401225653, -187.71803014349175, -4.790689005659377, -144.7457482166316, -381.6518480305185, -157.66726555015453, -1076.3117758752921, -1508.9096875034345, -618.9459425281763, -774.7788221412239, -704.3152486147721, -178.77128343706883, -49.71262169985463, -635.2215415557107, -350.1007563477509, -1162.801855391971, -351.93325491249686, -831.199597327693, -1276.7131466025273, -136.18353398463333, -394.10073190910333, -416.27944334441673, -1280.3047234851454, -1087.230034425263, -86.66632609166712, -120.11416331286881, -664.3091409153649, -405.8378616680379, -81.01423020131122, -434.85788387154446, -228.95750625959826, -527.0580184540125, -374.10790799781375, -325.91807176166566, -390.5667555202889, -293.5660379595591, -485.8141189121973, -207.70863318478996, -351.6077542505693, -490.26863149428664, -403.9092564583975, -169.24168709795944, -1037.9266376541214, -427.1388840119605, -55.865643702890196, -837.9495978304901, -758.8361917779871, -566.9247235398665, -196.3425789957232, -875.5843145577287, -61.242628910708355, -143.05336448980188, -125.40049202255601, -39.131765951485946, -775.7535160252135, -48.165376504065314, -439.44676892492555, -821.5284436476206, -671.4141795978849, -888.7486726990373, -308.82937384569465, -1046.8223965938412, -567.9537448097662, -215.4011590399894, -117.10823945672998, -236.81568096579088, -201.45108809420873, -941.9007611690926, -115.19692546017873, -750.9479310339788, -669.2104182714635, -674.1298735925807, -850.9060962691716, -125.379398195313, -54.39383376306387, -832.694103814479, -434.78293682299574, -980.75600267734, -1321.8217368124053, -297.3421312236127, -79.2112970209302, -876.4506733878442, -448.6838354108395, -708.5546332097272, -386.2484494054839, -872.2939021934533, -564.35330859197, -1035.1795786521743, -73.93881085229371, -143.80646367761787, -1081.9327619105188, -63.13451659525461, -974.1524986704244, -1111.2628001789137, -574.8527492302164, -689.82780695849, -567.3183823341152, -295.6630575203212, -71.67114293909057, -475.99115108069253, -234.074862135361, -24.95290849682902, -31.31465137975054, -17.541354215644493, -42.389635264310854, -5.276106182614839, -372.04488564208896, -20.800664078173288, -1043.3738649550621, -857.4101959373824, -1027.245599614078, -404.4599275574978, -459.6341370460915, -800.7872673268203, -523.2878705455828, -398.50208199921855, -74.13415380552149, -383.69016651219204, -801.7089899461405, -70.22912992527513, -34.96333720239548, -1186.1934095618549, -661.9661396091738, -514.1578959238745, -1288.120426611589, -282.7841059166272, -230.12179329337803, -1233.1477830688375, -22.763404169558424, -68.89233990902217, -1032.7081967794609, -799.3997738128779, -1383.4454352756704, -963.8999922409805, -17.039251255126477, -210.41947480465458, -120.00955553271068, -120.89651955461507, -677.0886822388717, -648.851954815697, -81.68565014288433, -969.9972578653234, -1024.6895749709122, -14.554160203118267, -31.037422968728077, -502.20134343787254, -363.8120851802099, -305.024266330947, -214.20469815537197, -270.58566412453183, -521.419530975232, -957.8371842026465, -406.4216637418861, -833.572046012571, -501.9679699804446, -1396.7425472940467, -54.586021411556885, -747.7977327506891, -810.8297659663743, -820.3982988962823, -729.5277221547424, -542.3069630362631, -280.43781320036743, -854.1834952574326, -700.6794634644059, -880.0667584508525, -892.8170551977394, -1401.1679735578202, -572.6302779051844, -579.7159130034909, -1421.4727143940436, -583.4474406091105, -227.4237218582963, -1131.9300067668885, -813.423596728451, -1141.5459251032196, -68.76757651196831, -199.25056478385468, -1172.6630840474631, -675.79275770933, -42.41598540660709, -183.2594729299635, -640.6172264048136, -1160.8015313965109, -959.4280290750787, -880.1112317848842, 7.14921038071359, -33.088428231951504, -263.48276659088714, -64.9291016456645, -521.4245579039485, -527.1004528758217, -107.466453540954, -79.78855273277235, -431.4161711119818, -740.3264719139005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.593547379503176, "mean_inference_ms": 1.7324405531454632, "mean_action_processing_ms": 0.8498280674861993, "mean_env_wait_ms": 10.71274532988461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014926910400390625, "StateBufferConnector_ms": 0.010401010513305664, "ViewRequirementAgentConnector_ms": 0.3560450077056885}, "num_episodes": 21, "episode_return_max": -121.47465553914968, "episode_return_min": -4867.803934058282, "episode_return_mean": -2671.8052175373123, "episodes_this_iter": 21}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 772155, "num_agent_steps_trained": 772155, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 99.93153137248, "num_env_steps_trained_throughput_per_sec": 99.93153137248, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 772155, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 772155, "timers": {"training_iteration_time_ms": 46038.135, "restore_workers_time_ms": 0.024, "training_step_time_ms": 46038.069, "sample_time_ms": 3362.282, "learn_time_ms": 42616.871, "learn_throughput": 93.86, "synch_weights_time_ms": 55.94}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 772155, "num_agent_steps_trained": 772155}, "done": false, "training_iteration": 43, "trial_id": "05c72_00000", "date": "2024-07-26_15-19-23", "timestamp": 1721987363, "time_this_iter_s": 40.03751993179321, "time_total_s": 2183.2730746269226, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e53f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2183.2730746269226, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 12.86315789473684, "ram_util_percent": 29.971929824561403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 176.32576544501563, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.629955431367412, "policy_loss": -0.00032158612151338595, "vf_loss": 4.647561190886931, "vf_explained_var": 0.9837039057955598, "kl": 0.019118821247148025, "entropy": 2.3736780422805537, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.47727272727273, "num_grad_updates_lifetime": 183660.5, "diff_num_grad_updates_vs_sampler_policy": 1979.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 788982, "num_agent_steps_trained": 788982}, "env_runners": {"episode_reward_max": -121.47465553914968, "episode_reward_min": -4867.803934058282, "episode_reward_mean": -2600.7012493442235, "episode_len_mean": 147.5, "episode_media": {}, "episodes_timesteps_total": 14750, "policy_reward_min": {"policy_0": -1542.993177654162}, "policy_reward_max": {"policy_0": 7.14921038071359}, "policy_reward_mean": {"policy_0": -520.1402498688445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3652.4046606774964, -2483.920267227887, -2421.918762781236, -2278.5154467561633, -1639.0136429705515, -4684.197435349102, -3956.193084424282, -3484.417616709584, -2632.311075974537, -2471.5659670432906, -2766.122074791551, -2220.7272152057585, -2317.8810874475134, -2395.2848012983277, -2287.364770298678, -2453.850907704677, -3075.3598181888233, -2657.9729476231646, -3542.18639956332, -3247.634228162553, -1742.500049904509, -2759.706116814578, -2158.231981900153, -2819.9635620710897, -2860.936317806583, -3343.473403836201, -3835.389699273494, -1485.39969994736, -3904.058273071745, -1480.7038190287399, -2076.5862944867617, -2440.9387891956403, -2521.1327880268427, -1147.7234281996682, -2794.909762168897, -2775.496171745715, -1917.1912455639983, -1910.8559123780246, -876.5735809464552, -4683.261476662898, -2376.6080584323568, -2990.130264736453, -2990.594690659365, -1814.9766229158565, -1911.2167916933395, -1939.3083943002416, -2528.122450297421, -2458.930437782014, -1131.504514993123, -3129.9674387151613, -2184.1012208661186, -2678.7071240289197, -2537.503305634608, -3113.914104557285, -3292.2314936073485, -2899.2109236845768, -3413.2303716332995, -1644.7185960095806, -121.47465553914968, -3320.875210226786, -2586.6712844752087, -1364.7257773915258, -3933.221977623119, -2587.633517220257, -3374.203927389313, -1648.532362284778, -2542.4797594459546, -1675.0462447662942, -4096.541411231591, -3163.139541179643, -3257.6744934093203, -4867.803934058282, -3897.770691065966, -2158.8899684592243, -3824.217491591253, -875.7756439917376, -1886.098102175429, -1684.071035611311, -2975.778420781899, -2174.381873378599, -2878.8383885742096, -1678.4993273790485, -1621.849335420065, -1907.8099067482583, -2021.5385905862813, -3594.889555831096, -3179.311357203646, -3552.9061107254643, -3743.714561070379, -3510.901268713739, -1065.0285666397765, -2821.740080645936, -508.6669061652376, -3225.158384361216, -2092.087539614529, -3211.3976521990994, -2365.860454858822, -3963.9820497110713, -1242.8158044030085, -2627.270382499877], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 121, 150], "policy_policy_0_reward": [-252.3130672972882, -50.29333037287837, -1248.550953195287, -1146.6981928623295, -954.5491169497109, -88.15819169131098, -80.59151126487141, -635.2603119489612, -773.0946336013772, -906.8156187213684, -218.98969720852986, -331.5262191084436, -1098.8057250594989, -90.09597181214025, -682.5011495926237, -877.2266636367289, -1113.6759864212, -77.34268195426375, -98.63393391400443, -111.63618082996501, -868.2751548894579, -365.3331124756613, -37.82707521962977, -185.72953377434808, -181.8487666114554, -748.3113846969447, -986.9627918153058, -737.5397682817508, -852.6247238553228, -1358.7587666997792, -1226.3736858342188, -1102.0051255816618, -13.549774705468025, -481.6809305654859, -1132.5835677374464, -313.17829500511505, -1341.7616420822828, -207.6202033592293, -923.6297632146889, -698.2277130482687, -61.30021835199696, -121.68680041776601, -1039.6100004328057, -236.2929694538826, -1173.421087318086, -448.2425329373356, -57.58432934512654, -969.5963853945955, -650.5985505366615, -345.5441688295704, -605.0617779029966, -122.917922333641, -160.4050089259698, -635.2675834795696, -1242.4697821493758, -997.9405690936662, -85.3628916393867, -738.2595672313965, -381.66319907967477, -17.50098816163355, -463.35415174572927, -1027.0423677222893, -9.312242214145225, -694.8215929590402, -123.3507328063085, -303.9368895388438, -1006.006986307306, -615.9939380328565, -246.07809388151142, -223.26889353781002, -495.0685771941985, -603.085626112158, -106.45261124497267, -965.699138615565, -117.05881713178024, -92.72759214282974, -93.95449669542451, -783.156139825252, -1224.3847611110566, -259.62791793011337, -217.37467434288718, -586.7063548600454, -856.7869381159005, -1228.602739265991, -185.8891116040006, -823.4350312160487, -178.65532145674342, -554.7816550752964, -235.53228340030103, -865.5686564747735, -521.7126154583752, -653.4496450083785, -926.2510694134153, -564.8217329577028, -875.9513367254481, -335.4820015796397, -420.27368535549914, -491.72822051250165, -1164.6502662694438, -835.5000544454666, -380.1295632677181, -361.2281872078121, -90.53699577537262, -630.0319028813686, -280.57340077223625, -917.0089081577264, -560.522852267368, -519.4417681456141, -323.67168639329276, -439.0609018505775, -376.4395401569147, -388.84642435548096, -794.1284803401395, -474.9125900770829, -123.90494697053558, -583.4079640072929, -699.2480838920278, -863.6085442231191, -251.2002036891403, -422.49876625951316, -346.13636756302566, -422.3374681718289, -721.9795858346255, -240.3854735709793, -1130.097422666125, -1184.5397660553422, -592.7176054868714, -687.7227034508174, -477.5977355661155, -400.89559327705655, -681.0574358650255, -1071.1797978715913, -647.7390329324851, -543.2555593213265, -892.1578732830699, -246.67582829134378, -229.81267081962747, -507.34372267506143, -481.61474689414126, -19.952731267186294, -846.6510177035021, -479.7599939701516, -677.7209248810884, -782.4695571062239, -1117.456779410777, -210.5701923447692, -410.77293970147286, -51.80312925345652, -197.01992456006917, -610.5376331689722, -417.8355031712143, -293.433356308988, -433.00791185024843, -183.42054024964145, -748.8889829066713, -46.24119523338371, -1021.0345014092034, -39.83591879515955, -619.2227619914195, -714.6044117664733, -617.4573190477053, -787.5486783213307, -789.7773934526093, -227.88671090575852, -98.46268629943917, -301.15654293163635, -26.96203684244385, -138.36079380018526, -622.5749585282617, -58.66909609714161, -856.2384344301042, -192.77032859700378, -123.25712007319022, -79.65070141443515, -1542.993177654162, -361.8053157112867, -141.61999382987426, -406.18900155954066, -686.6339279454992, -1179.2479326995126, -37.601035396478004, -188.2608038352781, -10.102885588352056, -1128.2086779172157, -553.0178428266756, -610.6429158391096, -277.9829883099005, -563.3434179708751, -240.2607062458821, -218.62588401225653, -187.71803014349175, -4.790689005659377, -144.7457482166316, -381.6518480305185, -157.66726555015453, -1076.3117758752921, -1508.9096875034345, -618.9459425281763, -774.7788221412239, -704.3152486147721, -178.77128343706883, -49.71262169985463, -635.2215415557107, -350.1007563477509, -1162.801855391971, -351.93325491249686, -831.199597327693, -1276.7131466025273, -136.18353398463333, -394.10073190910333, -416.27944334441673, -1280.3047234851454, -1087.230034425263, -86.66632609166712, -120.11416331286881, -664.3091409153649, -405.8378616680379, -81.01423020131122, -434.85788387154446, -228.95750625959826, -527.0580184540125, -374.10790799781375, -325.91807176166566, -390.5667555202889, -293.5660379595591, -485.8141189121973, -207.70863318478996, -351.6077542505693, -490.26863149428664, -403.9092564583975, -169.24168709795944, -1037.9266376541214, -427.1388840119605, -55.865643702890196, -837.9495978304901, -758.8361917779871, -566.9247235398665, -196.3425789957232, -875.5843145577287, -61.242628910708355, -143.05336448980188, -125.40049202255601, -39.131765951485946, -775.7535160252135, -48.165376504065314, -439.44676892492555, -821.5284436476206, -671.4141795978849, -888.7486726990373, -308.82937384569465, -1046.8223965938412, -567.9537448097662, -215.4011590399894, -117.10823945672998, -236.81568096579088, -201.45108809420873, -941.9007611690926, -115.19692546017873, -750.9479310339788, -669.2104182714635, -674.1298735925807, -850.9060962691716, -125.379398195313, -54.39383376306387, -832.694103814479, -434.78293682299574, -980.75600267734, -1321.8217368124053, -297.3421312236127, -79.2112970209302, -876.4506733878442, -448.6838354108395, -708.5546332097272, -386.2484494054839, -872.2939021934533, -564.35330859197, -1035.1795786521743, -73.93881085229371, -143.80646367761787, -1081.9327619105188, -63.13451659525461, -974.1524986704244, -1111.2628001789137, -574.8527492302164, -689.82780695849, -567.3183823341152, -295.6630575203212, -71.67114293909057, -475.99115108069253, -234.074862135361, -24.95290849682902, -31.31465137975054, -17.541354215644493, -42.389635264310854, -5.276106182614839, -372.04488564208896, -20.800664078173288, -1043.3738649550621, -857.4101959373824, -1027.245599614078, -404.4599275574978, -459.6341370460915, -800.7872673268203, -523.2878705455828, -398.50208199921855, -74.13415380552149, -383.69016651219204, -801.7089899461405, -70.22912992527513, -34.96333720239548, -1186.1934095618549, -661.9661396091738, -514.1578959238745, -1288.120426611589, -282.7841059166272, -230.12179329337803, -1233.1477830688375, -22.763404169558424, -68.89233990902217, -1032.7081967794609, -799.3997738128779, -1383.4454352756704, -963.8999922409805, -17.039251255126477, -210.41947480465458, -120.00955553271068, -120.89651955461507, -677.0886822388717, -648.851954815697, -81.68565014288433, -969.9972578653234, -1024.6895749709122, -14.554160203118267, -31.037422968728077, -502.20134343787254, -363.8120851802099, -305.024266330947, -214.20469815537197, -270.58566412453183, -521.419530975232, -957.8371842026465, -406.4216637418861, -833.572046012571, -501.9679699804446, -1396.7425472940467, -54.586021411556885, -747.7977327506891, -810.8297659663743, -820.3982988962823, -729.5277221547424, -542.3069630362631, -280.43781320036743, -854.1834952574326, -700.6794634644059, -880.0667584508525, -892.8170551977394, -1401.1679735578202, -572.6302779051844, -579.7159130034909, -1421.4727143940436, -583.4474406091105, -227.4237218582963, -1131.9300067668885, -813.423596728451, -1141.5459251032196, -68.76757651196831, -199.25056478385468, -1172.6630840474631, -675.79275770933, -42.41598540660709, -183.2594729299635, -640.6172264048136, -1160.8015313965109, -959.4280290750787, -880.1112317848842, 7.14921038071359, -33.088428231951504, -263.48276659088714, -64.9291016456645, -521.4245579039485, -527.1004528758217, -107.466453540954, -79.78855273277235, -431.4161711119818, -740.3264719139005, -13.351380039046074, -190.55088848960708, -160.80631564882358, -1014.9911030352138, -304.3713483986212, -685.824994013441, -193.2072276925068, -585.3733604276052, -910.7018140168456, -600.6710246315009, -765.3957332108813, -448.2348623159905, -859.6930748715233, -9.837062279484353, -91.22114070071933, -554.7430769126154, -84.3440448527816, -984.5002356126801, -1234.463640350525, -20.787390845609885, -698.2763994725732, -170.4776437117537, -233.58103667238643, -239.26398425757426, -336.90026326475936, -395.1836670064325, -94.68740074812801, -597.3855594959164, -63.197687453109374, -471.39502071648025, -100.62905177743681, -118.46947182591528, -446.5626686304613, -1184.4748630346219, -57.673851479821586, -86.52526390693062, -458.3070796622615, -366.76594781353225, -1018.0810632477878, -91.85923595576823, -32.1618089561256, -1057.9765559795849, -1272.638121246257, -1176.5562848289874, -55.556784820140734, -633.7755564323403, -214.06748260934435, -963.2535051727704, -684.2046588742302, -684.010154114959, -1125.393563053721, -349.102824288576, -743.1124349186865, -868.8503169246787, -466.44697153979973, -846.824761557791, -446.7692247859857, -1076.8809362017123, -1141.01529839742, -232.22434012747078, -530.3827393562325, -564.3074611439826, -1022.2500787472669, -1080.5225660171957, -313.4384234490607, -229.32986633465168, -25.798701571400546, -170.19309482619923, -528.3966895610597, -111.31021434646458, -119.04095430154948, -562.3448056394328, -1059.0152455529026, -643.3308637490835, -438.00821140296745, -66.74666098671898, -22.316273699560643, -255.22280049158226, -85.97314517685206, -78.40802581052303, -335.44439325059517, -876.9749802928164, -538.4684873719344, -1238.166866646304, -236.10365679956558, -13.624508827376928, -796.15979446269, -710.9288110950254, -100.91040821604453, -470.4640170133932, -991.921019634093, -296.17355044173433, -845.002571136769, -481.3586960369209, -596.9418149495807, -895.8392642728076, -278.84806326130627, -212.6527277515324, -270.6879422732172, -707.8324572999584, -1372.230944849908, -1263.1070722005827, -1024.5459460568566, -89.32947817201809, -214.76860843170655, -40.450609513636564, -278.780921169408, -303.4091617701531, -332.54801478295064, -287.62709716686004, -809.1311245634043, -527.0639053165271, -100.51932619409678, -961.6027148319905, -228.953311593855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5931819292783767, "mean_inference_ms": 1.7334866688795407, "mean_action_processing_ms": 0.848211813132381, "mean_env_wait_ms": 10.7031988028295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014470577239990234, "StateBufferConnector_ms": 0.01024317741394043, "ViewRequirementAgentConnector_ms": 0.351107120513916}, "num_episodes": 23, "episode_return_max": -121.47465553914968, "episode_return_min": -4867.803934058282, "episode_return_mean": -2600.7012493442235, "episodes_this_iter": 23}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 788982, "num_agent_steps_trained": 788982, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.05471603486569, "num_env_steps_trained_throughput_per_sec": 84.05471603486569, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 788982, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 788982, "timers": {"training_iteration_time_ms": 45830.317, "restore_workers_time_ms": 0.025, "training_step_time_ms": 45830.25, "sample_time_ms": 3343.505, "learn_time_ms": 42427.531, "learn_throughput": 94.278, "synch_weights_time_ms": 56.227}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 788982, "num_agent_steps_trained": 788982}, "done": false, "training_iteration": 44, "trial_id": "05c72_00000", "date": "2024-07-26_15-20-11", "timestamp": 1721987411, "time_this_iter_s": 47.59853982925415, "time_total_s": 2230.8716144561768, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d3c3b29ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2230.8716144561768, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 12.600000000000001, "ram_util_percent": 29.907462686567168}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 148.16616418870518, "cur_kl_coeff": 0.3375, "cur_lr": 0.0010000000000000005, "total_loss": 4.99060718224203, "policy_loss": -0.0036436359881595387, "vf_loss": 5.0104601097907375, "vf_explained_var": 0.9790841247823885, "kl": 0.018970359787925613, "entropy": 2.2611795158123225, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.46762589928058, "num_grad_updates_lifetime": 187725.5, "diff_num_grad_updates_vs_sampler_policy": 2084.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 806700, "num_agent_steps_trained": 806700}, "env_runners": {"episode_reward_max": -121.47465553914968, "episode_reward_min": -4867.803934058282, "episode_reward_mean": -2546.3401392293777, "episode_len_mean": 147.7, "episode_media": {}, "episodes_timesteps_total": 14770, "policy_reward_min": {"policy_0": -1508.9096875034345}, "policy_reward_max": {"policy_0": 7.14921038071359}, "policy_reward_mean": {"policy_0": -509.26802784587545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1917.1912455639983, -1910.8559123780246, -876.5735809464552, -4683.261476662898, -2376.6080584323568, -2990.130264736453, -2990.594690659365, -1814.9766229158565, -1911.2167916933395, -1939.3083943002416, -2528.122450297421, -2458.930437782014, -1131.504514993123, -3129.9674387151613, -2184.1012208661186, -2678.7071240289197, -2537.503305634608, -3113.914104557285, -3292.2314936073485, -2899.2109236845768, -3413.2303716332995, -1644.7185960095806, -121.47465553914968, -3320.875210226786, -2586.6712844752087, -1364.7257773915258, -3933.221977623119, -2587.633517220257, -3374.203927389313, -1648.532362284778, -2542.4797594459546, -1675.0462447662942, -4096.541411231591, -3163.139541179643, -3257.6744934093203, -4867.803934058282, -3897.770691065966, -2158.8899684592243, -3824.217491591253, -875.7756439917376, -1886.098102175429, -1684.071035611311, -2975.778420781899, -2174.381873378599, -2878.8383885742096, -1678.4993273790485, -1621.849335420065, -1907.8099067482583, -2021.5385905862813, -3594.889555831096, -3179.311357203646, -3552.9061107254643, -3743.714561070379, -3510.901268713739, -1065.0285666397765, -2821.740080645936, -508.6669061652376, -3225.158384361216, -2092.087539614529, -3211.3976521990994, -2365.860454858822, -3963.9820497110713, -1242.8158044030085, -2627.270382499877, -3055.770928920636, -2490.7914866930023, -2766.484512428427, -1805.8221638335299, -2475.6264191715304, -3512.239838472928, -2884.4895735160194, -3302.217138540623, -2792.9453178908, -1482.1279544076751, -1832.2592211248639, -1595.299678813594, -3833.94901828667, -2707.36403001754, -2678.567402888224, -3518.6588934358197, -3811.825522810738, -1210.011716259184, -1539.2422858835448, -1832.4991548929956, -1526.0355908264232, -3305.538447425492, -2093.197875410623, -2749.0100881111234, -2599.810616999616, -2835.565192098092, -2647.2117089555545, -3104.32388502019, -1884.9314060325253, -2865.2818901200194, -2122.573325013757, -3435.355923900161, -3387.615293337978, -2079.6524164908747, -2065.0872812687285, -1550.4981568924272], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-37.601035396478004, -188.2608038352781, -10.102885588352056, -1128.2086779172157, -553.0178428266756, -610.6429158391096, -277.9829883099005, -563.3434179708751, -240.2607062458821, -218.62588401225653, -187.71803014349175, -4.790689005659377, -144.7457482166316, -381.6518480305185, -157.66726555015453, -1076.3117758752921, -1508.9096875034345, -618.9459425281763, -774.7788221412239, -704.3152486147721, -178.77128343706883, -49.71262169985463, -635.2215415557107, -350.1007563477509, -1162.801855391971, -351.93325491249686, -831.199597327693, -1276.7131466025273, -136.18353398463333, -394.10073190910333, -416.27944334441673, -1280.3047234851454, -1087.230034425263, -86.66632609166712, -120.11416331286881, -664.3091409153649, -405.8378616680379, -81.01423020131122, -434.85788387154446, -228.95750625959826, -527.0580184540125, -374.10790799781375, -325.91807176166566, -390.5667555202889, -293.5660379595591, -485.8141189121973, -207.70863318478996, -351.6077542505693, -490.26863149428664, -403.9092564583975, -169.24168709795944, -1037.9266376541214, -427.1388840119605, -55.865643702890196, -837.9495978304901, -758.8361917779871, -566.9247235398665, -196.3425789957232, -875.5843145577287, -61.242628910708355, -143.05336448980188, -125.40049202255601, -39.131765951485946, -775.7535160252135, -48.165376504065314, -439.44676892492555, -821.5284436476206, -671.4141795978849, -888.7486726990373, -308.82937384569465, -1046.8223965938412, -567.9537448097662, -215.4011590399894, -117.10823945672998, -236.81568096579088, -201.45108809420873, -941.9007611690926, -115.19692546017873, -750.9479310339788, -669.2104182714635, -674.1298735925807, -850.9060962691716, -125.379398195313, -54.39383376306387, -832.694103814479, -434.78293682299574, -980.75600267734, -1321.8217368124053, -297.3421312236127, -79.2112970209302, -876.4506733878442, -448.6838354108395, -708.5546332097272, -386.2484494054839, -872.2939021934533, -564.35330859197, -1035.1795786521743, -73.93881085229371, -143.80646367761787, -1081.9327619105188, -63.13451659525461, -974.1524986704244, -1111.2628001789137, -574.8527492302164, -689.82780695849, -567.3183823341152, -295.6630575203212, -71.67114293909057, -475.99115108069253, -234.074862135361, -24.95290849682902, -31.31465137975054, -17.541354215644493, -42.389635264310854, -5.276106182614839, -372.04488564208896, -20.800664078173288, -1043.3738649550621, -857.4101959373824, -1027.245599614078, -404.4599275574978, -459.6341370460915, -800.7872673268203, -523.2878705455828, -398.50208199921855, -74.13415380552149, -383.69016651219204, -801.7089899461405, -70.22912992527513, -34.96333720239548, -1186.1934095618549, -661.9661396091738, -514.1578959238745, -1288.120426611589, -282.7841059166272, -230.12179329337803, -1233.1477830688375, -22.763404169558424, -68.89233990902217, -1032.7081967794609, -799.3997738128779, -1383.4454352756704, -963.8999922409805, -17.039251255126477, -210.41947480465458, -120.00955553271068, -120.89651955461507, -677.0886822388717, -648.851954815697, -81.68565014288433, -969.9972578653234, -1024.6895749709122, -14.554160203118267, -31.037422968728077, -502.20134343787254, -363.8120851802099, -305.024266330947, -214.20469815537197, -270.58566412453183, -521.419530975232, -957.8371842026465, -406.4216637418861, -833.572046012571, -501.9679699804446, -1396.7425472940467, -54.586021411556885, -747.7977327506891, -810.8297659663743, -820.3982988962823, -729.5277221547424, -542.3069630362631, -280.43781320036743, -854.1834952574326, -700.6794634644059, -880.0667584508525, -892.8170551977394, -1401.1679735578202, -572.6302779051844, -579.7159130034909, -1421.4727143940436, -583.4474406091105, -227.4237218582963, -1131.9300067668885, -813.423596728451, -1141.5459251032196, -68.76757651196831, -199.25056478385468, -1172.6630840474631, -675.79275770933, -42.41598540660709, -183.2594729299635, -640.6172264048136, -1160.8015313965109, -959.4280290750787, -880.1112317848842, 7.14921038071359, -33.088428231951504, -263.48276659088714, -64.9291016456645, -521.4245579039485, -527.1004528758217, -107.466453540954, -79.78855273277235, -431.4161711119818, -740.3264719139005, -13.351380039046074, -190.55088848960708, -160.80631564882358, -1014.9911030352138, -304.3713483986212, -685.824994013441, -193.2072276925068, -585.3733604276052, -910.7018140168456, -600.6710246315009, -765.3957332108813, -448.2348623159905, -859.6930748715233, -9.837062279484353, -91.22114070071933, -554.7430769126154, -84.3440448527816, -984.5002356126801, -1234.463640350525, -20.787390845609885, -698.2763994725732, -170.4776437117537, -233.58103667238643, -239.26398425757426, -336.90026326475936, -395.1836670064325, -94.68740074812801, -597.3855594959164, -63.197687453109374, -471.39502071648025, -100.62905177743681, -118.46947182591528, -446.5626686304613, -1184.4748630346219, -57.673851479821586, -86.52526390693062, -458.3070796622615, -366.76594781353225, -1018.0810632477878, -91.85923595576823, -32.1618089561256, -1057.9765559795849, -1272.638121246257, -1176.5562848289874, -55.556784820140734, -633.7755564323403, -214.06748260934435, -963.2535051727704, -684.2046588742302, -684.010154114959, -1125.393563053721, -349.102824288576, -743.1124349186865, -868.8503169246787, -466.44697153979973, -846.824761557791, -446.7692247859857, -1076.8809362017123, -1141.01529839742, -232.22434012747078, -530.3827393562325, -564.3074611439826, -1022.2500787472669, -1080.5225660171957, -313.4384234490607, -229.32986633465168, -25.798701571400546, -170.19309482619923, -528.3966895610597, -111.31021434646458, -119.04095430154948, -562.3448056394328, -1059.0152455529026, -643.3308637490835, -438.00821140296745, -66.74666098671898, -22.316273699560643, -255.22280049158226, -85.97314517685206, -78.40802581052303, -335.44439325059517, -876.9749802928164, -538.4684873719344, -1238.166866646304, -236.10365679956558, -13.624508827376928, -796.15979446269, -710.9288110950254, -100.91040821604453, -470.4640170133932, -991.921019634093, -296.17355044173433, -845.002571136769, -481.3586960369209, -596.9418149495807, -895.8392642728076, -278.84806326130627, -212.6527277515324, -270.6879422732172, -707.8324572999584, -1372.230944849908, -1263.1070722005827, -1024.5459460568566, -89.32947817201809, -214.76860843170655, -40.450609513636564, -278.780921169408, -303.4091617701531, -332.54801478295064, -287.62709716686004, -809.1311245634043, -527.0639053165271, -100.51932619409678, -961.6027148319905, -228.953311593855, -139.33567973039519, -643.4982471157101, -1366.1266332489402, -228.5399151692347, -678.2704536563583, -683.2568972635463, -1075.345589134122, -106.07581679104675, -162.18241762328068, -463.9307658810058, -641.4439739727806, -131.7214978945018, -630.5665239649943, -345.97578308467, -1016.7767335114827, -291.8470768516485, -112.3321998233338, -238.700248562703, -949.2945343890273, -213.6481042068154, -212.08750636649995, -239.93006479528853, -1196.7267768137615, -113.39798472620284, -713.4840864697773, -168.85175694305534, -908.3216441428364, -752.5034935951772, -1001.9909262693459, -680.5720175225158, -121.7247801837464, -767.1339401790317, -1203.060746747075, -774.2858502812935, -18.28425612487522, -778.3120715959888, -731.9776349745738, -858.1370594913624, -370.5706197535101, -563.2197527251847, -448.565433292655, -852.964928894422, -824.520071639485, -600.176013223893, -66.7188708403458, -400.74557227911123, -74.55720161327751, -54.98362003185474, -284.4859920830216, -667.3555684004095, -658.4854251316962, -59.38987823622162, -399.3764747681305, -691.1648399054067, -23.842603083409156, -20.714192055655822, -403.1916957481206, -89.46718494885457, -104.658607059677, -977.2679990012856, -631.1078841465171, -797.5991385729576, -1185.0396955538379, -1183.8185273499412, -36.38377266341653, -354.36697789080466, -448.19508985079983, -847.6707630330341, -871.7903642774651, -185.34083496543417, -506.2751127446399, -446.37940978383824, -151.0650132813015, -774.8334977214605, -800.0143693569863, -722.0825720957941, -790.0585525583824, -1157.4922550737392, -402.67585134205837, -446.3496623658448, -556.4325241126176, -1224.1006517369972, -724.3151728226534, -1190.4119232518353, -116.56525088663436, -656.0817099027087, -24.375341456044566, -264.5198152181269, -44.22473003013622, -220.81011965216717, -52.11084758638128, -248.42164200522546, -465.48845830072946, -87.79025436226559, -685.4310836289443, -58.57169956451467, -236.26662201830564, -205.58451185663503, -666.7706794949705, -665.3056419585697, -79.47314150099784, -156.8026782014427, -175.76741388554763, -900.9351735813345, -213.05718365710032, -638.3566996876427, -39.275944334735215, -571.2635207274329, -594.5708578468119, -1462.0714248288666, -419.90913867017713, -381.0184979485202, -71.73336365121502, -639.1869462294824, -581.3499289112272, -141.7794136825152, -155.0998899529743, -889.2160005493797, -550.4405496433938, -1012.4742342828631, -985.9795606737366, -676.3779040884928, -483.55655436565974, -204.51651879318229, -249.38007907854515, -1060.759216787748, -742.3074345110955, -257.36879811009396, -767.5760881068821, -7.553654582271275, -281.5991546438915, -1148.46553346591, -781.4392374703087, -57.5072821250673, -378.2005012503781, -581.2652169156355, -727.1668237972608, -350.03024406470587, -1130.402917638777, -315.45868260381184, -571.0651124688409, -200.06247631995618, -644.5325782106487, -75.82723057569936, -393.44400845737886, -1345.2923637809831, -490.5234632162288, -52.60553136218763, -841.0223144625468, -135.8382172980747, -457.87979802539945, -671.764874415498, -612.0489646971666, -311.82531805616156, -69.05436981953127, -963.3010104980872, -141.0446796738461, -682.2944746212733, -918.0829763897699, -730.6327827171879, -595.7066371309454, -663.9253971672797, -979.8988119375892, -377.11295092479793, -770.9714961773625, -412.6172854079094, -16.679780995273326, -16.706662986552928, -894.4998093399915, -739.1488777611469, -502.59784414263714, -1094.3149048479222, -4.805607141858922, -296.1755529871489, -167.1933721491611, -7.019234851020088, -78.49514308214492, -212.94371465586264, -664.233370042244, -587.8066942611558]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5911920983888819, "mean_inference_ms": 1.7341619229427028, "mean_action_processing_ms": 0.8475814207922968, "mean_env_wait_ms": 10.699179516229032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013994932174682617, "StateBufferConnector_ms": 0.009775400161743164, "ViewRequirementAgentConnector_ms": 0.33444738388061523}, "num_episodes": 36, "episode_return_max": -121.47465553914968, "episode_return_min": -4867.803934058282, "episode_return_mean": -2546.3401392293777, "episodes_this_iter": 36}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 806700, "num_agent_steps_trained": 806700, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 95.37899792648149, "num_env_steps_trained_throughput_per_sec": 95.37899792648149, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 806700, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 806700, "timers": {"training_iteration_time_ms": 45331.079, "restore_workers_time_ms": 0.026, "training_step_time_ms": 45331.009, "sample_time_ms": 3336.563, "learn_time_ms": 41936.69, "learn_throughput": 95.382, "synch_weights_time_ms": 54.767}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 806700, "num_agent_steps_trained": 806700}, "done": false, "training_iteration": 45, "trial_id": "05c72_00000", "date": "2024-07-26_15-20-53", "timestamp": 1721987453, "time_this_iter_s": 41.94828271865845, "time_total_s": 2272.819897174835, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e67a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2272.819897174835, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 13.406666666666666, "ram_util_percent": 29.87333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 159.7949946893894, "cur_kl_coeff": 0.3375, "cur_lr": 0.0010000000000000005, "total_loss": 4.8924241377093685, "policy_loss": -0.0028184349598719205, "vf_loss": 4.91175895045278, "vf_explained_var": 0.9880571587757239, "kl": 0.018950095310541308, "entropy": 2.291202802898348, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.27131782945736, "num_grad_updates_lifetime": 191745.5, "diff_num_grad_updates_vs_sampler_policy": 1934.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 823118, "num_agent_steps_trained": 823118}, "env_runners": {"episode_reward_max": -121.47465553914968, "episode_reward_min": -4867.803934058282, "episode_reward_mean": -2555.147020358972, "episode_len_mean": 147.86, "episode_media": {}, "episodes_timesteps_total": 14786, "policy_reward_min": {"policy_0": -1497.238011214206}, "policy_reward_max": {"policy_0": 7.14921038071359}, "policy_reward_mean": {"policy_0": -511.0294040717943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1644.7185960095806, -121.47465553914968, -3320.875210226786, -2586.6712844752087, -1364.7257773915258, -3933.221977623119, -2587.633517220257, -3374.203927389313, -1648.532362284778, -2542.4797594459546, -1675.0462447662942, -4096.541411231591, -3163.139541179643, -3257.6744934093203, -4867.803934058282, -3897.770691065966, -2158.8899684592243, -3824.217491591253, -875.7756439917376, -1886.098102175429, -1684.071035611311, -2975.778420781899, -2174.381873378599, -2878.8383885742096, -1678.4993273790485, -1621.849335420065, -1907.8099067482583, -2021.5385905862813, -3594.889555831096, -3179.311357203646, -3552.9061107254643, -3743.714561070379, -3510.901268713739, -1065.0285666397765, -2821.740080645936, -508.6669061652376, -3225.158384361216, -2092.087539614529, -3211.3976521990994, -2365.860454858822, -3963.9820497110713, -1242.8158044030085, -2627.270382499877, -3055.770928920636, -2490.7914866930023, -2766.484512428427, -1805.8221638335299, -2475.6264191715304, -3512.239838472928, -2884.4895735160194, -3302.217138540623, -2792.9453178908, -1482.1279544076751, -1832.2592211248639, -1595.299678813594, -3833.94901828667, -2707.36403001754, -2678.567402888224, -3518.6588934358197, -3811.825522810738, -1210.011716259184, -1539.2422858835448, -1832.4991548929956, -1526.0355908264232, -3305.538447425492, -2093.197875410623, -2749.0100881111234, -2599.810616999616, -2835.565192098092, -2647.2117089555545, -3104.32388502019, -1884.9314060325253, -2865.2818901200194, -2122.573325013757, -3435.355923900161, -3387.615293337978, -2079.6524164908747, -2065.0872812687285, -1550.4981568924272, -2425.689486793648, -3899.9750133438893, -2356.3486402545745, -1921.2041468425625, -2153.624131746284, -2029.708667761362, -3400.704370152404, -1903.6065040846224, -1663.3492103575134, -721.0150322615489, -2034.1646490916646, -2014.7183728969462, -2662.8366521483126, -2922.8074945760686, -4437.31939604822, -1724.738091954179, -2770.6326608740355, -3229.275908814668, -2781.13878345327, -1948.6820940874036, -4657.289229505082], "episode_lengths": [150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-567.3183823341152, -295.6630575203212, -71.67114293909057, -475.99115108069253, -234.074862135361, -24.95290849682902, -31.31465137975054, -17.541354215644493, -42.389635264310854, -5.276106182614839, -372.04488564208896, -20.800664078173288, -1043.3738649550621, -857.4101959373824, -1027.245599614078, -404.4599275574978, -459.6341370460915, -800.7872673268203, -523.2878705455828, -398.50208199921855, -74.13415380552149, -383.69016651219204, -801.7089899461405, -70.22912992527513, -34.96333720239548, -1186.1934095618549, -661.9661396091738, -514.1578959238745, -1288.120426611589, -282.7841059166272, -230.12179329337803, -1233.1477830688375, -22.763404169558424, -68.89233990902217, -1032.7081967794609, -799.3997738128779, -1383.4454352756704, -963.8999922409805, -17.039251255126477, -210.41947480465458, -120.00955553271068, -120.89651955461507, -677.0886822388717, -648.851954815697, -81.68565014288433, -969.9972578653234, -1024.6895749709122, -14.554160203118267, -31.037422968728077, -502.20134343787254, -363.8120851802099, -305.024266330947, -214.20469815537197, -270.58566412453183, -521.419530975232, -957.8371842026465, -406.4216637418861, -833.572046012571, -501.9679699804446, -1396.7425472940467, -54.586021411556885, -747.7977327506891, -810.8297659663743, -820.3982988962823, -729.5277221547424, -542.3069630362631, -280.43781320036743, -854.1834952574326, -700.6794634644059, -880.0667584508525, -892.8170551977394, -1401.1679735578202, -572.6302779051844, -579.7159130034909, -1421.4727143940436, -583.4474406091105, -227.4237218582963, -1131.9300067668885, -813.423596728451, -1141.5459251032196, -68.76757651196831, -199.25056478385468, -1172.6630840474631, -675.79275770933, -42.41598540660709, -183.2594729299635, -640.6172264048136, -1160.8015313965109, -959.4280290750787, -880.1112317848842, 7.14921038071359, -33.088428231951504, -263.48276659088714, -64.9291016456645, -521.4245579039485, -527.1004528758217, -107.466453540954, -79.78855273277235, -431.4161711119818, -740.3264719139005, -13.351380039046074, -190.55088848960708, -160.80631564882358, -1014.9911030352138, -304.3713483986212, -685.824994013441, -193.2072276925068, -585.3733604276052, -910.7018140168456, -600.6710246315009, -765.3957332108813, -448.2348623159905, -859.6930748715233, -9.837062279484353, -91.22114070071933, -554.7430769126154, -84.3440448527816, -984.5002356126801, -1234.463640350525, -20.787390845609885, -698.2763994725732, -170.4776437117537, -233.58103667238643, -239.26398425757426, -336.90026326475936, -395.1836670064325, -94.68740074812801, -597.3855594959164, -63.197687453109374, -471.39502071648025, -100.62905177743681, -118.46947182591528, -446.5626686304613, -1184.4748630346219, -57.673851479821586, -86.52526390693062, -458.3070796622615, -366.76594781353225, -1018.0810632477878, -91.85923595576823, -32.1618089561256, -1057.9765559795849, -1272.638121246257, -1176.5562848289874, -55.556784820140734, -633.7755564323403, -214.06748260934435, -963.2535051727704, -684.2046588742302, -684.010154114959, -1125.393563053721, -349.102824288576, -743.1124349186865, -868.8503169246787, -466.44697153979973, -846.824761557791, -446.7692247859857, -1076.8809362017123, -1141.01529839742, -232.22434012747078, -530.3827393562325, -564.3074611439826, -1022.2500787472669, -1080.5225660171957, -313.4384234490607, -229.32986633465168, -25.798701571400546, -170.19309482619923, -528.3966895610597, -111.31021434646458, -119.04095430154948, -562.3448056394328, -1059.0152455529026, -643.3308637490835, -438.00821140296745, -66.74666098671898, -22.316273699560643, -255.22280049158226, -85.97314517685206, -78.40802581052303, -335.44439325059517, -876.9749802928164, -538.4684873719344, -1238.166866646304, -236.10365679956558, -13.624508827376928, -796.15979446269, -710.9288110950254, -100.91040821604453, -470.4640170133932, -991.921019634093, -296.17355044173433, -845.002571136769, -481.3586960369209, -596.9418149495807, -895.8392642728076, -278.84806326130627, -212.6527277515324, -270.6879422732172, -707.8324572999584, -1372.230944849908, -1263.1070722005827, -1024.5459460568566, -89.32947817201809, -214.76860843170655, -40.450609513636564, -278.780921169408, -303.4091617701531, -332.54801478295064, -287.62709716686004, -809.1311245634043, -527.0639053165271, -100.51932619409678, -961.6027148319905, -228.953311593855, -139.33567973039519, -643.4982471157101, -1366.1266332489402, -228.5399151692347, -678.2704536563583, -683.2568972635463, -1075.345589134122, -106.07581679104675, -162.18241762328068, -463.9307658810058, -641.4439739727806, -131.7214978945018, -630.5665239649943, -345.97578308467, -1016.7767335114827, -291.8470768516485, -112.3321998233338, -238.700248562703, -949.2945343890273, -213.6481042068154, -212.08750636649995, -239.93006479528853, -1196.7267768137615, -113.39798472620284, -713.4840864697773, -168.85175694305534, -908.3216441428364, -752.5034935951772, -1001.9909262693459, -680.5720175225158, -121.7247801837464, -767.1339401790317, -1203.060746747075, -774.2858502812935, -18.28425612487522, -778.3120715959888, -731.9776349745738, -858.1370594913624, -370.5706197535101, -563.2197527251847, -448.565433292655, -852.964928894422, -824.520071639485, -600.176013223893, -66.7188708403458, -400.74557227911123, -74.55720161327751, -54.98362003185474, -284.4859920830216, -667.3555684004095, -658.4854251316962, -59.38987823622162, -399.3764747681305, -691.1648399054067, -23.842603083409156, -20.714192055655822, -403.1916957481206, -89.46718494885457, -104.658607059677, -977.2679990012856, -631.1078841465171, -797.5991385729576, -1185.0396955538379, -1183.8185273499412, -36.38377266341653, -354.36697789080466, -448.19508985079983, -847.6707630330341, -871.7903642774651, -185.34083496543417, -506.2751127446399, -446.37940978383824, -151.0650132813015, -774.8334977214605, -800.0143693569863, -722.0825720957941, -790.0585525583824, -1157.4922550737392, -402.67585134205837, -446.3496623658448, -556.4325241126176, -1224.1006517369972, -724.3151728226534, -1190.4119232518353, -116.56525088663436, -656.0817099027087, -24.375341456044566, -264.5198152181269, -44.22473003013622, -220.81011965216717, -52.11084758638128, -248.42164200522546, -465.48845830072946, -87.79025436226559, -685.4310836289443, -58.57169956451467, -236.26662201830564, -205.58451185663503, -666.7706794949705, -665.3056419585697, -79.47314150099784, -156.8026782014427, -175.76741388554763, -900.9351735813345, -213.05718365710032, -638.3566996876427, -39.275944334735215, -571.2635207274329, -594.5708578468119, -1462.0714248288666, -419.90913867017713, -381.0184979485202, -71.73336365121502, -639.1869462294824, -581.3499289112272, -141.7794136825152, -155.0998899529743, -889.2160005493797, -550.4405496433938, -1012.4742342828631, -985.9795606737366, -676.3779040884928, -483.55655436565974, -204.51651879318229, -249.38007907854515, -1060.759216787748, -742.3074345110955, -257.36879811009396, -767.5760881068821, -7.553654582271275, -281.5991546438915, -1148.46553346591, -781.4392374703087, -57.5072821250673, -378.2005012503781, -581.2652169156355, -727.1668237972608, -350.03024406470587, -1130.402917638777, -315.45868260381184, -571.0651124688409, -200.06247631995618, -644.5325782106487, -75.82723057569936, -393.44400845737886, -1345.2923637809831, -490.5234632162288, -52.60553136218763, -841.0223144625468, -135.8382172980747, -457.87979802539945, -671.764874415498, -612.0489646971666, -311.82531805616156, -69.05436981953127, -963.3010104980872, -141.0446796738461, -682.2944746212733, -918.0829763897699, -730.6327827171879, -595.7066371309454, -663.9253971672797, -979.8988119375892, -377.11295092479793, -770.9714961773625, -412.6172854079094, -16.679780995273326, -16.706662986552928, -894.4998093399915, -739.1488777611469, -502.59784414263714, -1094.3149048479222, -4.805607141858922, -296.1755529871489, -167.1933721491611, -7.019234851020088, -78.49514308214492, -212.94371465586264, -664.233370042244, -587.8066942611558, -1363.7927767443184, -99.14871989887374, -201.75703042497324, -535.4870141218881, -225.50394560359484, -618.9626601567276, -1248.0312600165282, -1307.8905315139084, -232.81671357778038, -492.27384807894424, -383.77195641521257, -686.6448748128018, -259.19823880933524, -1022.2686804611668, -4.464889756057176, -80.0160922703742, -540.0192442838526, -653.2642977862553, -405.24886364891444, -242.6556488531676, -113.77454736622414, -1448.8241522754074, -442.7506594207268, -87.2941963570319, -60.98057632689379, -370.68403444306546, -31.229419025499364, -215.13145372263168, -149.23697368974305, -1263.4267868804225, -659.1867694667039, -1299.7719742065315, -396.08883307956, -399.16608188713815, -646.4907115124734, -70.36169708943203, -176.46458101121095, -715.2535877520263, -570.5488618302772, -370.9777764016731, -72.01276633430157, -858.5501781060142, -370.131205722062, -212.45299819649617, -150.20206199863887, -451.7311358333746, -34.27045544074975, -41.42499788554441, -125.40870109616296, -68.17974200571791, -788.240968414689, -89.87139506505056, -753.293420442869, -170.86794645815476, -231.89091871090116, -53.301207149131976, -695.7441545716769, -984.8674126432516, -22.477707288547222, -258.3278912443399, -9.684804859085625, -465.35848588145427, -1497.238011214206, -384.86914995361934, -305.68620023994737, -913.5076764984805, -109.23648249074972, -285.12482506479034, -795.1785990137614, -819.7599115082857, -1247.6461883353388, -1189.5086612234481, -1060.819581435748, -570.877225496588, -368.4677395570919, -92.36933931866064, -134.46322180320757, -412.01313670317626, -931.7750819909002, -154.11731213823603, -790.3803291055192, -17.928324437180624, -46.33217368136836, -870.7307930366297, -1045.261040613339, -935.2166628826607, -812.7161844881265, -153.01973786435335, -802.2210748865896, -526.102248692939, -796.3064197657953, -577.5811006099738, -64.92369317704568, -168.93667099522332, -1173.3908989052366, -1.2899109504833288, -703.0002412854952, -450.4289461421951, -592.571808877334, -201.39118683189398, -985.7630046033561, -599.422911735524, -720.73887739138, -1335.7969059724453, -1015.5675298023817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5887587848099636, "mean_inference_ms": 1.7313886524578512, "mean_action_processing_ms": 0.8441529445909335, "mean_env_wait_ms": 10.67121257105605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013890504837036133, "StateBufferConnector_ms": 0.00973200798034668, "ViewRequirementAgentConnector_ms": 0.33248376846313477}, "num_episodes": 21, "episode_return_max": -121.47465553914968, "episode_return_min": -4867.803934058282, "episode_return_mean": -2555.147020358972, "episodes_this_iter": 21}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 823118, "num_agent_steps_trained": 823118, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.54231872448557, "num_env_steps_trained_throughput_per_sec": 85.54231872448557, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 823118, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 823118, "timers": {"training_iteration_time_ms": 44986.706, "restore_workers_time_ms": 0.026, "training_step_time_ms": 44986.637, "sample_time_ms": 3353.941, "learn_time_ms": 41574.498, "learn_throughput": 96.213, "synch_weights_time_ms": 55.289}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 823118, "num_agent_steps_trained": 823118}, "done": false, "training_iteration": 46, "trial_id": "05c72_00000", "date": "2024-07-26_15-21-40", "timestamp": 1721987500, "time_this_iter_s": 46.7717342376709, "time_total_s": 2319.591631412506, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e7f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2319.591631412506, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 13.163636363636364, "ram_util_percent": 29.96212121212121}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 168.98806091180452, "cur_kl_coeff": 0.3375, "cur_lr": 0.0010000000000000005, "total_loss": 4.912835272461253, "policy_loss": 0.0012721022831045034, "vf_loss": 4.928725288511862, "vf_explained_var": 0.9777720009325702, "kl": 0.019975073704885882, "entropy": 2.390370057134357, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.29457364341086, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 1934.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 839539, "num_agent_steps_trained": 839539}, "env_runners": {"episode_reward_max": -508.6669061652376, "episode_reward_min": -4657.289229505082, "episode_reward_mean": -2564.8150789798515, "episode_len_mean": 148.92, "episode_media": {}, "episodes_timesteps_total": 14892, "policy_reward_min": {"policy_0": -1497.238011214206}, "policy_reward_max": {"policy_0": -1.2899109504833288}, "policy_reward_mean": {"policy_0": -512.9630157959704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1678.4993273790485, -1621.849335420065, -1907.8099067482583, -2021.5385905862813, -3594.889555831096, -3179.311357203646, -3552.9061107254643, -3743.714561070379, -3510.901268713739, -1065.0285666397765, -2821.740080645936, -508.6669061652376, -3225.158384361216, -2092.087539614529, -3211.3976521990994, -2365.860454858822, -3963.9820497110713, -1242.8158044030085, -2627.270382499877, -3055.770928920636, -2490.7914866930023, -2766.484512428427, -1805.8221638335299, -2475.6264191715304, -3512.239838472928, -2884.4895735160194, -3302.217138540623, -2792.9453178908, -1482.1279544076751, -1832.2592211248639, -1595.299678813594, -3833.94901828667, -2707.36403001754, -2678.567402888224, -3518.6588934358197, -3811.825522810738, -1210.011716259184, -1539.2422858835448, -1832.4991548929956, -1526.0355908264232, -3305.538447425492, -2093.197875410623, -2749.0100881111234, -2599.810616999616, -2835.565192098092, -2647.2117089555545, -3104.32388502019, -1884.9314060325253, -2865.2818901200194, -2122.573325013757, -3435.355923900161, -3387.615293337978, -2079.6524164908747, -2065.0872812687285, -1550.4981568924272, -2425.689486793648, -3899.9750133438893, -2356.3486402545745, -1921.2041468425625, -2153.624131746284, -2029.708667761362, -3400.704370152404, -1903.6065040846224, -1663.3492103575134, -721.0150322615489, -2034.1646490916646, -2014.7183728969462, -2662.8366521483126, -2922.8074945760686, -4437.31939604822, -1724.738091954179, -2770.6326608740355, -3229.275908814668, -2781.13878345327, -1948.6820940874036, -4657.289229505082, -2216.682490729555, -1802.864700159149, -3220.198222086848, -3476.160040468346, -1037.7025301905906, -3593.231262940809, -2315.1487002683016, -4525.250219094848, -2035.9826605234532, -2064.417872666856, -3326.1860588770032, -1983.8885128881084, -4047.428360935167, -3197.375373590652, -2339.83121359487, -1697.8452406625124, -3564.5835861883297, -3656.3181979446254, -1576.2577441492265, -1469.3903103794114, -2338.3659202853037, -2394.5156477797655, -3313.2084289840877, -2314.5368745805977], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-698.2763994725732, -170.4776437117537, -233.58103667238643, -239.26398425757426, -336.90026326475936, -395.1836670064325, -94.68740074812801, -597.3855594959164, -63.197687453109374, -471.39502071648025, -100.62905177743681, -118.46947182591528, -446.5626686304613, -1184.4748630346219, -57.673851479821586, -86.52526390693062, -458.3070796622615, -366.76594781353225, -1018.0810632477878, -91.85923595576823, -32.1618089561256, -1057.9765559795849, -1272.638121246257, -1176.5562848289874, -55.556784820140734, -633.7755564323403, -214.06748260934435, -963.2535051727704, -684.2046588742302, -684.010154114959, -1125.393563053721, -349.102824288576, -743.1124349186865, -868.8503169246787, -466.44697153979973, -846.824761557791, -446.7692247859857, -1076.8809362017123, -1141.01529839742, -232.22434012747078, -530.3827393562325, -564.3074611439826, -1022.2500787472669, -1080.5225660171957, -313.4384234490607, -229.32986633465168, -25.798701571400546, -170.19309482619923, -528.3966895610597, -111.31021434646458, -119.04095430154948, -562.3448056394328, -1059.0152455529026, -643.3308637490835, -438.00821140296745, -66.74666098671898, -22.316273699560643, -255.22280049158226, -85.97314517685206, -78.40802581052303, -335.44439325059517, -876.9749802928164, -538.4684873719344, -1238.166866646304, -236.10365679956558, -13.624508827376928, -796.15979446269, -710.9288110950254, -100.91040821604453, -470.4640170133932, -991.921019634093, -296.17355044173433, -845.002571136769, -481.3586960369209, -596.9418149495807, -895.8392642728076, -278.84806326130627, -212.6527277515324, -270.6879422732172, -707.8324572999584, -1372.230944849908, -1263.1070722005827, -1024.5459460568566, -89.32947817201809, -214.76860843170655, -40.450609513636564, -278.780921169408, -303.4091617701531, -332.54801478295064, -287.62709716686004, -809.1311245634043, -527.0639053165271, -100.51932619409678, -961.6027148319905, -228.953311593855, -139.33567973039519, -643.4982471157101, -1366.1266332489402, -228.5399151692347, -678.2704536563583, -683.2568972635463, -1075.345589134122, -106.07581679104675, -162.18241762328068, -463.9307658810058, -641.4439739727806, -131.7214978945018, -630.5665239649943, -345.97578308467, -1016.7767335114827, -291.8470768516485, -112.3321998233338, -238.700248562703, -949.2945343890273, -213.6481042068154, -212.08750636649995, -239.93006479528853, -1196.7267768137615, -113.39798472620284, -713.4840864697773, -168.85175694305534, -908.3216441428364, -752.5034935951772, -1001.9909262693459, -680.5720175225158, -121.7247801837464, -767.1339401790317, -1203.060746747075, -774.2858502812935, -18.28425612487522, -778.3120715959888, -731.9776349745738, -858.1370594913624, -370.5706197535101, -563.2197527251847, -448.565433292655, -852.964928894422, -824.520071639485, -600.176013223893, -66.7188708403458, -400.74557227911123, -74.55720161327751, -54.98362003185474, -284.4859920830216, -667.3555684004095, -658.4854251316962, -59.38987823622162, -399.3764747681305, -691.1648399054067, -23.842603083409156, -20.714192055655822, -403.1916957481206, -89.46718494885457, -104.658607059677, -977.2679990012856, -631.1078841465171, -797.5991385729576, -1185.0396955538379, -1183.8185273499412, -36.38377266341653, -354.36697789080466, -448.19508985079983, -847.6707630330341, -871.7903642774651, -185.34083496543417, -506.2751127446399, -446.37940978383824, -151.0650132813015, -774.8334977214605, -800.0143693569863, -722.0825720957941, -790.0585525583824, -1157.4922550737392, -402.67585134205837, -446.3496623658448, -556.4325241126176, -1224.1006517369972, -724.3151728226534, -1190.4119232518353, -116.56525088663436, -656.0817099027087, -24.375341456044566, -264.5198152181269, -44.22473003013622, -220.81011965216717, -52.11084758638128, -248.42164200522546, -465.48845830072946, -87.79025436226559, -685.4310836289443, -58.57169956451467, -236.26662201830564, -205.58451185663503, -666.7706794949705, -665.3056419585697, -79.47314150099784, -156.8026782014427, -175.76741388554763, -900.9351735813345, -213.05718365710032, -638.3566996876427, -39.275944334735215, -571.2635207274329, -594.5708578468119, -1462.0714248288666, -419.90913867017713, -381.0184979485202, -71.73336365121502, -639.1869462294824, -581.3499289112272, -141.7794136825152, -155.0998899529743, -889.2160005493797, -550.4405496433938, -1012.4742342828631, -985.9795606737366, -676.3779040884928, -483.55655436565974, -204.51651879318229, -249.38007907854515, -1060.759216787748, -742.3074345110955, -257.36879811009396, -767.5760881068821, -7.553654582271275, -281.5991546438915, -1148.46553346591, -781.4392374703087, -57.5072821250673, -378.2005012503781, -581.2652169156355, -727.1668237972608, -350.03024406470587, -1130.402917638777, -315.45868260381184, -571.0651124688409, -200.06247631995618, -644.5325782106487, -75.82723057569936, -393.44400845737886, -1345.2923637809831, -490.5234632162288, -52.60553136218763, -841.0223144625468, -135.8382172980747, -457.87979802539945, -671.764874415498, -612.0489646971666, -311.82531805616156, -69.05436981953127, -963.3010104980872, -141.0446796738461, -682.2944746212733, -918.0829763897699, -730.6327827171879, -595.7066371309454, -663.9253971672797, -979.8988119375892, -377.11295092479793, -770.9714961773625, -412.6172854079094, -16.679780995273326, -16.706662986552928, -894.4998093399915, -739.1488777611469, -502.59784414263714, -1094.3149048479222, -4.805607141858922, -296.1755529871489, -167.1933721491611, -7.019234851020088, -78.49514308214492, -212.94371465586264, -664.233370042244, -587.8066942611558, -1363.7927767443184, -99.14871989887374, -201.75703042497324, -535.4870141218881, -225.50394560359484, -618.9626601567276, -1248.0312600165282, -1307.8905315139084, -232.81671357778038, -492.27384807894424, -383.77195641521257, -686.6448748128018, -259.19823880933524, -1022.2686804611668, -4.464889756057176, -80.0160922703742, -540.0192442838526, -653.2642977862553, -405.24886364891444, -242.6556488531676, -113.77454736622414, -1448.8241522754074, -442.7506594207268, -87.2941963570319, -60.98057632689379, -370.68403444306546, -31.229419025499364, -215.13145372263168, -149.23697368974305, -1263.4267868804225, -659.1867694667039, -1299.7719742065315, -396.08883307956, -399.16608188713815, -646.4907115124734, -70.36169708943203, -176.46458101121095, -715.2535877520263, -570.5488618302772, -370.9777764016731, -72.01276633430157, -858.5501781060142, -370.131205722062, -212.45299819649617, -150.20206199863887, -451.7311358333746, -34.27045544074975, -41.42499788554441, -125.40870109616296, -68.17974200571791, -788.240968414689, -89.87139506505056, -753.293420442869, -170.86794645815476, -231.89091871090116, -53.301207149131976, -695.7441545716769, -984.8674126432516, -22.477707288547222, -258.3278912443399, -9.684804859085625, -465.35848588145427, -1497.238011214206, -384.86914995361934, -305.68620023994737, -913.5076764984805, -109.23648249074972, -285.12482506479034, -795.1785990137614, -819.7599115082857, -1247.6461883353388, -1189.5086612234481, -1060.819581435748, -570.877225496588, -368.4677395570919, -92.36933931866064, -134.46322180320757, -412.01313670317626, -931.7750819909002, -154.11731213823603, -790.3803291055192, -17.928324437180624, -46.33217368136836, -870.7307930366297, -1045.261040613339, -935.2166628826607, -812.7161844881265, -153.01973786435335, -802.2210748865896, -526.102248692939, -796.3064197657953, -577.5811006099738, -64.92369317704568, -168.93667099522332, -1173.3908989052366, -1.2899109504833288, -703.0002412854952, -450.4289461421951, -592.571808877334, -201.39118683189398, -985.7630046033561, -599.422911735524, -720.73887739138, -1335.7969059724453, -1015.5675298023817, -887.0664976476336, -1032.2463365657775, -95.17862826954676, -100.99288222588163, -101.19814602071641, -616.438921530896, -405.57538045263715, -123.19465156519043, -495.0283374994747, -162.6274091109513, -1339.3538883061149, -586.7433584868894, -607.2155928785367, -432.97512007917334, -253.91026233613368, -736.9072896635298, -916.8223188686947, -931.9403825602977, -712.6251160372346, -177.86493333858695, -533.6506913972224, -122.80275800194717, -124.5229633296582, -127.76649662780781, -128.95962083395503, -1131.2852266596983, -999.2817611918915, -357.7401173908003, -378.7064624861363, -726.2176952122874, -583.6217558550242, -104.29702293963446, -1146.2379673555588, -262.75112488318985, -218.24082923489362, -647.7577809735968, -735.6691613225377, -1032.8061411768988, -659.3511331612559, -1449.6660024605576, -312.35475073506575, -13.834933106115102, -899.2983167790305, -377.4375762934826, -433.0570836097591, -471.0942387826644, -399.95963070056234, -438.5708884169934, -319.4101551766667, -435.3829595899666, -534.2750596060821, -70.70937524314209, -887.8030204546214, -919.5244582734194, -913.8741452997356, -318.22317727548375, -444.30149943267, -785.7899447011204, -413.6598380874723, -21.914053391362383, -870.2797514677749, -539.9530772357987, -966.7044152714349, -1319.0959009646215, -351.3952159955382, -299.68834558078294, -385.47192501110203, -1228.0494896177606, -715.2878353989497, -568.8777779820568, -257.9436007530694, -101.30977702047994, -56.83080555501868, -1393.9408739385565, -529.8061563277469, -868.0320244215052, -9.252621065598504, -52.29899888217187, -68.07769161177308, -700.1839046814616, -1332.5835941297498, -172.1849638351138, -1098.7396426595894, -653.0211847632887, -308.05420080058786, -752.2764740098056, -521.6241013572377, -382.1101729513895, -1285.4861592423595, -714.8212903838325, -760.4818870087055, -450.09294081361793, -26.015476826707705, -209.0438593986329, -130.62358010156169, -275.17833553505716, -431.5636138884226, -96.0408735520478, -49.29573561442795, -617.3117517894557, -155.74572586110764, -272.27910441764186, -1087.1805406553465, -255.28099687587112, -567.8795524753355, -277.98290222062826, -624.3392752455566, -841.3483310999618, -237.25705019014535, -413.58808902347374, -298.0758435742322, -1050.7034866382837, -963.6058281888751, -573.0867674995583, -427.73650308313944, -260.6575634767904, -972.3979015212963, -127.67502065146186, -265.6704189865419, -688.1359699445101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5868506862060539, "mean_inference_ms": 1.7312723190973578, "mean_action_processing_ms": 0.8418802692376146, "mean_env_wait_ms": 10.652866141596139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013200521469116211, "StateBufferConnector_ms": 0.009345054626464844, "ViewRequirementAgentConnector_ms": 0.31855106353759766}, "num_episodes": 24, "episode_return_max": -508.6669061652376, "episode_return_min": -4657.289229505082, "episode_return_mean": -2564.8150789798515, "episodes_this_iter": 24}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 839539, "num_agent_steps_trained": 839539, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 122.19171785920507, "num_env_steps_trained_throughput_per_sec": 122.19171785920507, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 839539, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 839539, "timers": {"training_iteration_time_ms": 43368.223, "restore_workers_time_ms": 0.026, "training_step_time_ms": 43368.153, "sample_time_ms": 3355.244, "learn_time_ms": 39956.357, "learn_throughput": 100.109, "synch_weights_time_ms": 53.669}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 839539, "num_agent_steps_trained": 839539}, "done": false, "training_iteration": 47, "trial_id": "05c72_00000", "date": "2024-07-26_15-22-12", "timestamp": 1721987532, "time_this_iter_s": 32.74589133262634, "time_total_s": 2352.3375227451324, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e4ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2352.3375227451324, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 15.13404255319149, "ram_util_percent": 30.304255319148936}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.43633090154222, "cur_kl_coeff": 0.33749999999999997, "cur_lr": 0.0010000000000000002, "total_loss": 4.893795707508853, "policy_loss": -5.8691184989019346e-05, "vf_loss": 4.909741172289739, "vf_explained_var": 0.9795595966517653, "kl": 0.01993882654970469, "entropy": 2.2616123127338548, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.3082191780822, "num_grad_updates_lifetime": 199740.5, "diff_num_grad_updates_vs_sampler_policy": 2189.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 858126, "num_agent_steps_trained": 858126}, "env_runners": {"episode_reward_max": -721.0150322615489, "episode_reward_min": -4657.289229505082, "episode_reward_mean": -2564.5737479059626, "episode_len_mean": 149.46, "episode_media": {}, "episodes_timesteps_total": 14946, "policy_reward_min": {"policy_0": -1497.238011214206}, "policy_reward_max": {"policy_0": -1.2899109504833288}, "policy_reward_mean": {"policy_0": -512.9147495811926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3811.825522810738, -1210.011716259184, -1539.2422858835448, -1832.4991548929956, -1526.0355908264232, -3305.538447425492, -2093.197875410623, -2749.0100881111234, -2599.810616999616, -2835.565192098092, -2647.2117089555545, -3104.32388502019, -1884.9314060325253, -2865.2818901200194, -2122.573325013757, -3435.355923900161, -3387.615293337978, -2079.6524164908747, -2065.0872812687285, -1550.4981568924272, -2425.689486793648, -3899.9750133438893, -2356.3486402545745, -1921.2041468425625, -2153.624131746284, -2029.708667761362, -3400.704370152404, -1903.6065040846224, -1663.3492103575134, -721.0150322615489, -2034.1646490916646, -2014.7183728969462, -2662.8366521483126, -2922.8074945760686, -4437.31939604822, -1724.738091954179, -2770.6326608740355, -3229.275908814668, -2781.13878345327, -1948.6820940874036, -4657.289229505082, -2216.682490729555, -1802.864700159149, -3220.198222086848, -3476.160040468346, -1037.7025301905906, -3593.231262940809, -2315.1487002683016, -4525.250219094848, -2035.9826605234532, -2064.417872666856, -3326.1860588770032, -1983.8885128881084, -4047.428360935167, -3197.375373590652, -2339.83121359487, -1697.8452406625124, -3564.5835861883297, -3656.3181979446254, -1576.2577441492265, -1469.3903103794114, -2338.3659202853037, -2394.5156477797655, -3313.2084289840877, -2314.5368745805977, -3049.130328009164, -742.9477126142785, -1697.2665134791926, -2415.24695755486, -3920.291403040469, -1793.033744126266, -3725.013014782547, -2505.981750712292, -3402.6828975410544, -2269.5867730791583, -3137.0901056481243, -1593.5194519621953, -2379.453277745756, -2976.256152665625, -3770.0198812016165, -1600.7636367859425, -3078.7466754461393, -3834.719415889752, -2041.4421794742789, -2227.7142081436523, -1845.5767614765605, -2952.758438402616, -2048.5926260722404, -2149.486994868059, -2727.6744935048405, -2902.4757264879945, -1853.0400780962254, -2651.61002424255, -3352.2315369272396, -2417.7949976179993, -2132.0424037555613, -2565.820204487668, -3363.474005732814, -1602.8930923639118, -3919.5308418909076], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-556.4325241126176, -1224.1006517369972, -724.3151728226534, -1190.4119232518353, -116.56525088663436, -656.0817099027087, -24.375341456044566, -264.5198152181269, -44.22473003013622, -220.81011965216717, -52.11084758638128, -248.42164200522546, -465.48845830072946, -87.79025436226559, -685.4310836289443, -58.57169956451467, -236.26662201830564, -205.58451185663503, -666.7706794949705, -665.3056419585697, -79.47314150099784, -156.8026782014427, -175.76741388554763, -900.9351735813345, -213.05718365710032, -638.3566996876427, -39.275944334735215, -571.2635207274329, -594.5708578468119, -1462.0714248288666, -419.90913867017713, -381.0184979485202, -71.73336365121502, -639.1869462294824, -581.3499289112272, -141.7794136825152, -155.0998899529743, -889.2160005493797, -550.4405496433938, -1012.4742342828631, -985.9795606737366, -676.3779040884928, -483.55655436565974, -204.51651879318229, -249.38007907854515, -1060.759216787748, -742.3074345110955, -257.36879811009396, -767.5760881068821, -7.553654582271275, -281.5991546438915, -1148.46553346591, -781.4392374703087, -57.5072821250673, -378.2005012503781, -581.2652169156355, -727.1668237972608, -350.03024406470587, -1130.402917638777, -315.45868260381184, -571.0651124688409, -200.06247631995618, -644.5325782106487, -75.82723057569936, -393.44400845737886, -1345.2923637809831, -490.5234632162288, -52.60553136218763, -841.0223144625468, -135.8382172980747, -457.87979802539945, -671.764874415498, -612.0489646971666, -311.82531805616156, -69.05436981953127, -963.3010104980872, -141.0446796738461, -682.2944746212733, -918.0829763897699, -730.6327827171879, -595.7066371309454, -663.9253971672797, -979.8988119375892, -377.11295092479793, -770.9714961773625, -412.6172854079094, -16.679780995273326, -16.706662986552928, -894.4998093399915, -739.1488777611469, -502.59784414263714, -1094.3149048479222, -4.805607141858922, -296.1755529871489, -167.1933721491611, -7.019234851020088, -78.49514308214492, -212.94371465586264, -664.233370042244, -587.8066942611558, -1363.7927767443184, -99.14871989887374, -201.75703042497324, -535.4870141218881, -225.50394560359484, -618.9626601567276, -1248.0312600165282, -1307.8905315139084, -232.81671357778038, -492.27384807894424, -383.77195641521257, -686.6448748128018, -259.19823880933524, -1022.2686804611668, -4.464889756057176, -80.0160922703742, -540.0192442838526, -653.2642977862553, -405.24886364891444, -242.6556488531676, -113.77454736622414, -1448.8241522754074, -442.7506594207268, -87.2941963570319, -60.98057632689379, -370.68403444306546, -31.229419025499364, -215.13145372263168, -149.23697368974305, -1263.4267868804225, -659.1867694667039, -1299.7719742065315, -396.08883307956, -399.16608188713815, -646.4907115124734, -70.36169708943203, -176.46458101121095, -715.2535877520263, -570.5488618302772, -370.9777764016731, -72.01276633430157, -858.5501781060142, -370.131205722062, -212.45299819649617, -150.20206199863887, -451.7311358333746, -34.27045544074975, -41.42499788554441, -125.40870109616296, -68.17974200571791, -788.240968414689, -89.87139506505056, -753.293420442869, -170.86794645815476, -231.89091871090116, -53.301207149131976, -695.7441545716769, -984.8674126432516, -22.477707288547222, -258.3278912443399, -9.684804859085625, -465.35848588145427, -1497.238011214206, -384.86914995361934, -305.68620023994737, -913.5076764984805, -109.23648249074972, -285.12482506479034, -795.1785990137614, -819.7599115082857, -1247.6461883353388, -1189.5086612234481, -1060.819581435748, -570.877225496588, -368.4677395570919, -92.36933931866064, -134.46322180320757, -412.01313670317626, -931.7750819909002, -154.11731213823603, -790.3803291055192, -17.928324437180624, -46.33217368136836, -870.7307930366297, -1045.261040613339, -935.2166628826607, -812.7161844881265, -153.01973786435335, -802.2210748865896, -526.102248692939, -796.3064197657953, -577.5811006099738, -64.92369317704568, -168.93667099522332, -1173.3908989052366, -1.2899109504833288, -703.0002412854952, -450.4289461421951, -592.571808877334, -201.39118683189398, -985.7630046033561, -599.422911735524, -720.73887739138, -1335.7969059724453, -1015.5675298023817, -887.0664976476336, -1032.2463365657775, -95.17862826954676, -100.99288222588163, -101.19814602071641, -616.438921530896, -405.57538045263715, -123.19465156519043, -495.0283374994747, -162.6274091109513, -1339.3538883061149, -586.7433584868894, -607.2155928785367, -432.97512007917334, -253.91026233613368, -736.9072896635298, -916.8223188686947, -931.9403825602977, -712.6251160372346, -177.86493333858695, -533.6506913972224, -122.80275800194717, -124.5229633296582, -127.76649662780781, -128.95962083395503, -1131.2852266596983, -999.2817611918915, -357.7401173908003, -378.7064624861363, -726.2176952122874, -583.6217558550242, -104.29702293963446, -1146.2379673555588, -262.75112488318985, -218.24082923489362, -647.7577809735968, -735.6691613225377, -1032.8061411768988, -659.3511331612559, -1449.6660024605576, -312.35475073506575, -13.834933106115102, -899.2983167790305, -377.4375762934826, -433.0570836097591, -471.0942387826644, -399.95963070056234, -438.5708884169934, -319.4101551766667, -435.3829595899666, -534.2750596060821, -70.70937524314209, -887.8030204546214, -919.5244582734194, -913.8741452997356, -318.22317727548375, -444.30149943267, -785.7899447011204, -413.6598380874723, -21.914053391362383, -870.2797514677749, -539.9530772357987, -966.7044152714349, -1319.0959009646215, -351.3952159955382, -299.68834558078294, -385.47192501110203, -1228.0494896177606, -715.2878353989497, -568.8777779820568, -257.9436007530694, -101.30977702047994, -56.83080555501868, -1393.9408739385565, -529.8061563277469, -868.0320244215052, -9.252621065598504, -52.29899888217187, -68.07769161177308, -700.1839046814616, -1332.5835941297498, -172.1849638351138, -1098.7396426595894, -653.0211847632887, -308.05420080058786, -752.2764740098056, -521.6241013572377, -382.1101729513895, -1285.4861592423595, -714.8212903838325, -760.4818870087055, -450.09294081361793, -26.015476826707705, -209.0438593986329, -130.62358010156169, -275.17833553505716, -431.5636138884226, -96.0408735520478, -49.29573561442795, -617.3117517894557, -155.74572586110764, -272.27910441764186, -1087.1805406553465, -255.28099687587112, -567.8795524753355, -277.98290222062826, -624.3392752455566, -841.3483310999618, -237.25705019014535, -413.58808902347374, -298.0758435742322, -1050.7034866382837, -963.6058281888751, -573.0867674995583, -427.73650308313944, -260.6575634767904, -972.3979015212963, -127.67502065146186, -265.6704189865419, -688.1359699445101, -1048.3813761924566, -638.9766252379476, -211.69886442197014, -1047.1190727777125, -102.95438937907589, -49.157396125526525, -38.894032597707245, -280.12334083092645, -340.2490599037465, -34.52388315637132, -499.9298410308921, -1083.2460179235345, -35.83992830764775, -48.49704099009596, -29.75368522702171, -488.1942189618567, -466.68238891484003, -1087.3873687974224, -88.97897748822587, -284.00400339251365, -989.3574841681241, -1005.3241495926183, -502.7006443743295, -947.8999290770472, -475.00919582834575, -244.5916129612323, -247.73652895842648, -596.9086970305898, -431.7051586549113, -272.09174652110664, -83.87774810041402, -493.33293927007344, -1399.5561369434581, -1379.9158375149443, -368.33035295365687, -311.12505579447, -1096.0743232058364, -591.4392722698956, -409.8176926609216, -97.52540678116955, -682.1167251317318, -110.42877632881293, -856.1524486315672, -927.269905740146, -826.7150417087904, -1357.5563788133716, -104.03342512590186, -129.81050784695867, -469.8058117924985, -208.38064950042758, -1351.0677477067682, -837.4837153546649, -434.0577744229973, -433.17743895680917, -81.30342920688368, -131.89224260909708, -277.26283223739455, -284.19134473668544, -230.18066115103795, -669.9923712279792, -713.9874494270613, -389.90978716855705, -428.94298361370403, -723.5395332158303, -123.07352432060452, -685.9679199299522, -1274.656882988762, -434.7915563072101, -73.29076537649705, -507.549028063205, -1122.7871520735378, -233.42451268212653, -1418.0942189865375, -836.2119293666503, -159.50206809276364, -313.47950035821566, -162.81151426978343, -299.94242235682395, -161.36608106186867, -663.1641187392506, -513.33723420668, -628.9530838198989, -448.747787627656, -742.6611737842712, -745.0473960076331, -457.39239757948053, -531.9252261526766, -742.9318926551166, -1479.6828109017702, -622.7870886007083, -917.0910294330653, -391.600020844732, -191.20140481200556, -353.906406213024, -187.6433181714513, -218.32435235785834, -245.01513105575089, -668.0224586153582, -382.12347871425175, -714.2287874004361, -740.2793432530163, -85.72901345356277, -967.2607516030603, -8.948732046047525, -43.35892112087394, -89.79636261598746, -35.224306607204376, -1032.2652928886864, -1088.6637271901247, -706.8087491006145, -647.4944573523233, -235.84192312448073, -814.9090978257881, -306.8708381191634, -43.47630965048536, -693.9505266315883, -645.1023021193889, -319.5825353761895, -62.80658612019483, -428.04504462069326, -480.0995818996677, -482.46541241606633, -566.8629341603154, -484.38176026225767, -713.8648047665306, -4.939275291428803, -323.4710647139697, -1377.1003154228504, -1051.2797493353798, -145.68532172436713, -479.63543038675397, -275.90849598994356, -118.69738658278436, -885.3906025851236, -93.40816255161752, -973.0005937417629, -734.0734681161982, -167.77332164985629, -142.7911799246998, -633.9714608100361, -814.7640070095915, -509.7876521725774, -1124.302162708267, -842.0770273813106, -61.30068765549039, -214.3930948168797, -91.56496188140179, -635.3566982369973, -1352.4489933568586, -124.03124932586128, -246.17764220625594, -264.36547498027795, -217.35008946842802, -553.9208099822832, -850.2283871183186, -310.4481280440529, -435.33581577224703, -647.4288646637478, -666.8390430854433, -505.76835292217754, -467.37086286840764, -860.5826221130089, -947.633558395905, -849.5935803332159, -238.29338202227663, -358.6703480154053, -534.6963639591999, -567.6455394558418, -39.61046955501714, -102.27037137844768, -520.2964310842923, -1218.6963180091695, -453.09450892425974, -1235.3807079610583, -492.0628759121281]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5819122960867904, "mean_inference_ms": 1.7307793922920456, "mean_action_processing_ms": 0.8413507590479682, "mean_env_wait_ms": 10.641432721572214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012784481048583984, "StateBufferConnector_ms": 0.009115934371948242, "ViewRequirementAgentConnector_ms": 0.3089289665222168}, "num_episodes": 35, "episode_return_max": -721.0150322615489, "episode_return_min": -4657.289229505082, "episode_return_mean": -2564.5737479059626, "episodes_this_iter": 35}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 858126, "num_agent_steps_trained": 858126, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.08189391055815, "num_env_steps_trained_throughput_per_sec": 72.08189391055815, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 858126, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 858126, "timers": {"training_iteration_time_ms": 44318.537, "restore_workers_time_ms": 0.026, "training_step_time_ms": 44318.468, "sample_time_ms": 3331.267, "learn_time_ms": 40931.003, "learn_throughput": 97.725, "synch_weights_time_ms": 53.292}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 858126, "num_agent_steps_trained": 858126}, "done": false, "training_iteration": 48, "trial_id": "05c72_00000", "date": "2024-07-26_15-23-08", "timestamp": 1721987588, "time_this_iter_s": 55.50284433364868, "time_total_s": 2407.840367078781, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d28052a290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2407.840367078781, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 11.635443037974682, "ram_util_percent": 30.31898734177214}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 169.87931636848836, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.992934167565721, "policy_loss": -0.002270309955018074, "vf_loss": 5.011022838317987, "vf_explained_var": 0.9817463668458389, "kl": 0.020138588151703423, "entropy": 2.2615140337534627, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.11363636363636, "num_grad_updates_lifetime": 203910.5, "diff_num_grad_updates_vs_sampler_policy": 1979.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 874905, "num_agent_steps_trained": 874905}, "env_runners": {"episode_reward_max": -721.0150322615489, "episode_reward_min": -4657.289229505082, "episode_reward_mean": -2655.193456429661, "episode_len_mean": 149.3, "episode_media": {}, "episodes_timesteps_total": 14930, "policy_reward_min": {"policy_0": -1497.238011214206}, "policy_reward_max": {"policy_0": -1.2899109504833288}, "policy_reward_mean": {"policy_0": -531.0386912859323}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3899.9750133438893, -2356.3486402545745, -1921.2041468425625, -2153.624131746284, -2029.708667761362, -3400.704370152404, -1903.6065040846224, -1663.3492103575134, -721.0150322615489, -2034.1646490916646, -2014.7183728969462, -2662.8366521483126, -2922.8074945760686, -4437.31939604822, -1724.738091954179, -2770.6326608740355, -3229.275908814668, -2781.13878345327, -1948.6820940874036, -4657.289229505082, -2216.682490729555, -1802.864700159149, -3220.198222086848, -3476.160040468346, -1037.7025301905906, -3593.231262940809, -2315.1487002683016, -4525.250219094848, -2035.9826605234532, -2064.417872666856, -3326.1860588770032, -1983.8885128881084, -4047.428360935167, -3197.375373590652, -2339.83121359487, -1697.8452406625124, -3564.5835861883297, -3656.3181979446254, -1576.2577441492265, -1469.3903103794114, -2338.3659202853037, -2394.5156477797655, -3313.2084289840877, -2314.5368745805977, -3049.130328009164, -742.9477126142785, -1697.2665134791926, -2415.24695755486, -3920.291403040469, -1793.033744126266, -3725.013014782547, -2505.981750712292, -3402.6828975410544, -2269.5867730791583, -3137.0901056481243, -1593.5194519621953, -2379.453277745756, -2976.256152665625, -3770.0198812016165, -1600.7636367859425, -3078.7466754461393, -3834.719415889752, -2041.4421794742789, -2227.7142081436523, -1845.5767614765605, -2952.758438402616, -2048.5926260722404, -2149.486994868059, -2727.6744935048405, -2902.4757264879945, -1853.0400780962254, -2651.61002424255, -3352.2315369272396, -2417.7949976179993, -2132.0424037555613, -2565.820204487668, -3363.474005732814, -1602.8930923639118, -3919.5308418909076, -1625.928583264062, -4616.299393680566, -2012.5259540940408, -1344.4693853010526, -4009.4960988975645, -2441.318512130572, -3287.7121787400583, -2591.4219565204717, -2275.5279109976414, -1919.572674377739, -2877.4112147567307, -2531.3879371492626, -3313.8470365681846, -3230.1529467332134, -1352.5858768851836, -3826.5593250219354, -3093.8363518206224, -2834.0479651284977, -2713.812127708863, -4371.714991919166, -3863.299695218082], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-618.9626601567276, -1248.0312600165282, -1307.8905315139084, -232.81671357778038, -492.27384807894424, -383.77195641521257, -686.6448748128018, -259.19823880933524, -1022.2686804611668, -4.464889756057176, -80.0160922703742, -540.0192442838526, -653.2642977862553, -405.24886364891444, -242.6556488531676, -113.77454736622414, -1448.8241522754074, -442.7506594207268, -87.2941963570319, -60.98057632689379, -370.68403444306546, -31.229419025499364, -215.13145372263168, -149.23697368974305, -1263.4267868804225, -659.1867694667039, -1299.7719742065315, -396.08883307956, -399.16608188713815, -646.4907115124734, -70.36169708943203, -176.46458101121095, -715.2535877520263, -570.5488618302772, -370.9777764016731, -72.01276633430157, -858.5501781060142, -370.131205722062, -212.45299819649617, -150.20206199863887, -451.7311358333746, -34.27045544074975, -41.42499788554441, -125.40870109616296, -68.17974200571791, -788.240968414689, -89.87139506505056, -753.293420442869, -170.86794645815476, -231.89091871090116, -53.301207149131976, -695.7441545716769, -984.8674126432516, -22.477707288547222, -258.3278912443399, -9.684804859085625, -465.35848588145427, -1497.238011214206, -384.86914995361934, -305.68620023994737, -913.5076764984805, -109.23648249074972, -285.12482506479034, -795.1785990137614, -819.7599115082857, -1247.6461883353388, -1189.5086612234481, -1060.819581435748, -570.877225496588, -368.4677395570919, -92.36933931866064, -134.46322180320757, -412.01313670317626, -931.7750819909002, -154.11731213823603, -790.3803291055192, -17.928324437180624, -46.33217368136836, -870.7307930366297, -1045.261040613339, -935.2166628826607, -812.7161844881265, -153.01973786435335, -802.2210748865896, -526.102248692939, -796.3064197657953, -577.5811006099738, -64.92369317704568, -168.93667099522332, -1173.3908989052366, -1.2899109504833288, -703.0002412854952, -450.4289461421951, -592.571808877334, -201.39118683189398, -985.7630046033561, -599.422911735524, -720.73887739138, -1335.7969059724453, -1015.5675298023817, -887.0664976476336, -1032.2463365657775, -95.17862826954676, -100.99288222588163, -101.19814602071641, -616.438921530896, -405.57538045263715, -123.19465156519043, -495.0283374994747, -162.6274091109513, -1339.3538883061149, -586.7433584868894, -607.2155928785367, -432.97512007917334, -253.91026233613368, -736.9072896635298, -916.8223188686947, -931.9403825602977, -712.6251160372346, -177.86493333858695, -533.6506913972224, -122.80275800194717, -124.5229633296582, -127.76649662780781, -128.95962083395503, -1131.2852266596983, -999.2817611918915, -357.7401173908003, -378.7064624861363, -726.2176952122874, -583.6217558550242, -104.29702293963446, -1146.2379673555588, -262.75112488318985, -218.24082923489362, -647.7577809735968, -735.6691613225377, -1032.8061411768988, -659.3511331612559, -1449.6660024605576, -312.35475073506575, -13.834933106115102, -899.2983167790305, -377.4375762934826, -433.0570836097591, -471.0942387826644, -399.95963070056234, -438.5708884169934, -319.4101551766667, -435.3829595899666, -534.2750596060821, -70.70937524314209, -887.8030204546214, -919.5244582734194, -913.8741452997356, -318.22317727548375, -444.30149943267, -785.7899447011204, -413.6598380874723, -21.914053391362383, -870.2797514677749, -539.9530772357987, -966.7044152714349, -1319.0959009646215, -351.3952159955382, -299.68834558078294, -385.47192501110203, -1228.0494896177606, -715.2878353989497, -568.8777779820568, -257.9436007530694, -101.30977702047994, -56.83080555501868, -1393.9408739385565, -529.8061563277469, -868.0320244215052, -9.252621065598504, -52.29899888217187, -68.07769161177308, -700.1839046814616, -1332.5835941297498, -172.1849638351138, -1098.7396426595894, -653.0211847632887, -308.05420080058786, -752.2764740098056, -521.6241013572377, -382.1101729513895, -1285.4861592423595, -714.8212903838325, -760.4818870087055, -450.09294081361793, -26.015476826707705, -209.0438593986329, -130.62358010156169, -275.17833553505716, -431.5636138884226, -96.0408735520478, -49.29573561442795, -617.3117517894557, -155.74572586110764, -272.27910441764186, -1087.1805406553465, -255.28099687587112, -567.8795524753355, -277.98290222062826, -624.3392752455566, -841.3483310999618, -237.25705019014535, -413.58808902347374, -298.0758435742322, -1050.7034866382837, -963.6058281888751, -573.0867674995583, -427.73650308313944, -260.6575634767904, -972.3979015212963, -127.67502065146186, -265.6704189865419, -688.1359699445101, -1048.3813761924566, -638.9766252379476, -211.69886442197014, -1047.1190727777125, -102.95438937907589, -49.157396125526525, -38.894032597707245, -280.12334083092645, -340.2490599037465, -34.52388315637132, -499.9298410308921, -1083.2460179235345, -35.83992830764775, -48.49704099009596, -29.75368522702171, -488.1942189618567, -466.68238891484003, -1087.3873687974224, -88.97897748822587, -284.00400339251365, -989.3574841681241, -1005.3241495926183, -502.7006443743295, -947.8999290770472, -475.00919582834575, -244.5916129612323, -247.73652895842648, -596.9086970305898, -431.7051586549113, -272.09174652110664, -83.87774810041402, -493.33293927007344, -1399.5561369434581, -1379.9158375149443, -368.33035295365687, -311.12505579447, -1096.0743232058364, -591.4392722698956, -409.8176926609216, -97.52540678116955, -682.1167251317318, -110.42877632881293, -856.1524486315672, -927.269905740146, -826.7150417087904, -1357.5563788133716, -104.03342512590186, -129.81050784695867, -469.8058117924985, -208.38064950042758, -1351.0677477067682, -837.4837153546649, -434.0577744229973, -433.17743895680917, -81.30342920688368, -131.89224260909708, -277.26283223739455, -284.19134473668544, -230.18066115103795, -669.9923712279792, -713.9874494270613, -389.90978716855705, -428.94298361370403, -723.5395332158303, -123.07352432060452, -685.9679199299522, -1274.656882988762, -434.7915563072101, -73.29076537649705, -507.549028063205, -1122.7871520735378, -233.42451268212653, -1418.0942189865375, -836.2119293666503, -159.50206809276364, -313.47950035821566, -162.81151426978343, -299.94242235682395, -161.36608106186867, -663.1641187392506, -513.33723420668, -628.9530838198989, -448.747787627656, -742.6611737842712, -745.0473960076331, -457.39239757948053, -531.9252261526766, -742.9318926551166, -1479.6828109017702, -622.7870886007083, -917.0910294330653, -391.600020844732, -191.20140481200556, -353.906406213024, -187.6433181714513, -218.32435235785834, -245.01513105575089, -668.0224586153582, -382.12347871425175, -714.2287874004361, -740.2793432530163, -85.72901345356277, -967.2607516030603, -8.948732046047525, -43.35892112087394, -89.79636261598746, -35.224306607204376, -1032.2652928886864, -1088.6637271901247, -706.8087491006145, -647.4944573523233, -235.84192312448073, -814.9090978257881, -306.8708381191634, -43.47630965048536, -693.9505266315883, -645.1023021193889, -319.5825353761895, -62.80658612019483, -428.04504462069326, -480.0995818996677, -482.46541241606633, -566.8629341603154, -484.38176026225767, -713.8648047665306, -4.939275291428803, -323.4710647139697, -1377.1003154228504, -1051.2797493353798, -145.68532172436713, -479.63543038675397, -275.90849598994356, -118.69738658278436, -885.3906025851236, -93.40816255161752, -973.0005937417629, -734.0734681161982, -167.77332164985629, -142.7911799246998, -633.9714608100361, -814.7640070095915, -509.7876521725774, -1124.302162708267, -842.0770273813106, -61.30068765549039, -214.3930948168797, -91.56496188140179, -635.3566982369973, -1352.4489933568586, -124.03124932586128, -246.17764220625594, -264.36547498027795, -217.35008946842802, -553.9208099822832, -850.2283871183186, -310.4481280440529, -435.33581577224703, -647.4288646637478, -666.8390430854433, -505.76835292217754, -467.37086286840764, -860.5826221130089, -947.633558395905, -849.5935803332159, -238.29338202227663, -358.6703480154053, -534.6963639591999, -567.6455394558418, -39.61046955501714, -102.27037137844768, -520.2964310842923, -1218.6963180091695, -453.09450892425974, -1235.3807079610583, -492.0628759121281, -321.50860654647073, -195.75042782417077, -510.35796516051005, -355.46048723186044, -242.85109650105144, -1310.7600059512827, -827.8649811419886, -1305.88498265057, -251.34959283580892, -920.4398311009165, -859.8193651409147, -439.7105508029513, -86.16573435703931, -330.8142387183881, -296.01606507474725, -227.4114141627731, -213.0597019134811, -618.5969664652189, -128.76018392985392, -156.64111882972537, -1077.094987942474, -750.6664045358054, -909.5812969117372, -707.8856733200212, -564.2677361875252, -235.46250622227404, -483.2090885141919, -898.4867777566492, -568.9615094454037, -255.19863019205212, -1153.5854324704258, -265.14813068917266, -735.9562738374773, -881.4110054853801, -251.61133625760687, -407.8620226588963, -692.4313624097105, -1180.5579503552146, -107.64458438023743, -202.92603671641686, -572.0611469377028, -196.1311443573848, -688.8616530034598, -730.9230226721882, -87.55094402690473, -455.6477203909204, -82.03617623400987, -557.2091683874804, -368.0371612940269, -456.64244807130217, -151.49000759524577, -416.1965619175572, -900.1057318330915, -42.955915971790674, -1366.6629974390496, -503.01529175983336, -164.47126816759635, -725.7375527956497, -506.47927268127336, -631.6845517449106, -1085.8718466696826, -436.5207953827602, -677.9181343908602, -324.4132611100954, -789.1229990147867, -730.4255407560078, -1113.8695702804425, -79.87486991178189, -1232.8387966257415, -73.14416915924146, -164.61163235971088, -604.2707344673694, -1.6256798131125696, -513.9606028385859, -68.11722740640529, -721.5464138091722, -791.7494636843353, -1455.4459788740594, -387.0790457408798, -470.73842291348245, -1061.1592713366238, -242.1619674663335, -1063.488646249393, -9.675137530709112, -717.3513292375666, -748.3033204812356, -987.2757825405071, -203.86258292314446, -518.1881124681285, -376.4181667154822, -667.8127090213253, -287.5888376960731, -1063.2008783309484, -110.07173834489907, -585.137964315617, -1203.818711051385, -906.1769410692762, -850.1253863309278, -738.1988785342409, -673.3950749333412, -422.8826550092532, -517.2597386361869, -752.5500963587907, -1223.4509642317096, -947.1562409821411]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.581282941560228, "mean_inference_ms": 1.729185592080641, "mean_action_processing_ms": 0.8386222739199765, "mean_env_wait_ms": 10.622967673719968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013375282287597656, "StateBufferConnector_ms": 0.009429693222045898, "ViewRequirementAgentConnector_ms": 0.32210350036621094}, "num_episodes": 21, "episode_return_max": -721.0150322615489, "episode_return_min": -4657.289229505082, "episode_return_mean": -2655.193456429661, "episodes_this_iter": 21}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 874905, "num_agent_steps_trained": 874905, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.99113489895029, "num_env_steps_trained_throughput_per_sec": 80.99113489895029, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 874905, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 874905, "timers": {"training_iteration_time_ms": 44889.962, "restore_workers_time_ms": 0.027, "training_step_time_ms": 44889.892, "sample_time_ms": 3344.204, "learn_time_ms": 41489.088, "learn_throughput": 96.411, "synch_weights_time_ms": 53.739}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 874905, "num_agent_steps_trained": 874905}, "done": false, "training_iteration": 49, "trial_id": "05c72_00000", "date": "2024-07-26_15-23-57", "timestamp": 1721987637, "time_this_iter_s": 49.39771223068237, "time_total_s": 2457.2380793094635, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00dcf70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2457.2380793094635, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 12.214285714285714, "ram_util_percent": 30.199999999999992}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.46391872197242, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000002, "total_loss": 4.806932359666967, "policy_loss": -0.0025933118314662978, "vf_loss": 4.824854616086874, "vf_explained_var": 0.984111009975571, "kl": 0.016321581867853624, "entropy": 2.3591752785058757, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.55223880597015, "num_grad_updates_lifetime": 207900.5, "diff_num_grad_updates_vs_sampler_policy": 2009.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 891997, "num_agent_steps_trained": 891997}, "env_runners": {"episode_reward_max": -389.4896194642285, "episode_reward_min": -4616.299393680566, "episode_reward_mean": -2643.603063152455, "episode_len_mean": 148.21, "episode_media": {}, "episodes_timesteps_total": 14821, "policy_reward_min": {"policy_0": -1479.6828109017702}, "policy_reward_max": {"policy_0": -1.6256798131125696}, "policy_reward_mean": {"policy_0": -528.7206126304911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3593.231262940809, -2315.1487002683016, -4525.250219094848, -2035.9826605234532, -2064.417872666856, -3326.1860588770032, -1983.8885128881084, -4047.428360935167, -3197.375373590652, -2339.83121359487, -1697.8452406625124, -3564.5835861883297, -3656.3181979446254, -1576.2577441492265, -1469.3903103794114, -2338.3659202853037, -2394.5156477797655, -3313.2084289840877, -2314.5368745805977, -3049.130328009164, -742.9477126142785, -1697.2665134791926, -2415.24695755486, -3920.291403040469, -1793.033744126266, -3725.013014782547, -2505.981750712292, -3402.6828975410544, -2269.5867730791583, -3137.0901056481243, -1593.5194519621953, -2379.453277745756, -2976.256152665625, -3770.0198812016165, -1600.7636367859425, -3078.7466754461393, -3834.719415889752, -2041.4421794742789, -2227.7142081436523, -1845.5767614765605, -2952.758438402616, -2048.5926260722404, -2149.486994868059, -2727.6744935048405, -2902.4757264879945, -1853.0400780962254, -2651.61002424255, -3352.2315369272396, -2417.7949976179993, -2132.0424037555613, -2565.820204487668, -3363.474005732814, -1602.8930923639118, -3919.5308418909076, -1625.928583264062, -4616.299393680566, -2012.5259540940408, -1344.4693853010526, -4009.4960988975645, -2441.318512130572, -3287.7121787400583, -2591.4219565204717, -2275.5279109976414, -1919.572674377739, -2877.4112147567307, -2531.3879371492626, -3313.8470365681846, -3230.1529467332134, -1352.5858768851836, -3826.5593250219354, -3093.8363518206224, -2834.0479651284977, -2713.812127708863, -4371.714991919166, -3863.299695218082, -3687.795716998271, -389.4896194642285, -3195.115633597098, -2107.2660343834673, -2774.88828750001, -1902.6245457408527, -1083.9261327107592, -3607.2215777331776, -3985.1992948230923, -2937.6850209471568, -3196.0472556150175, -2342.756070490604, -2592.932259007146, -1187.6094641345965, -3289.978569616054, -2866.068325300115, -2572.787379493907, -2529.2204150440184, -1730.9888288799675, -2716.9482928183006, -1035.1458041996902, -1407.3378769803821, -2385.1123193153203, -3410.8545763143006, -2892.708405061014], "episode_lengths": [150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1131.2852266596983, -999.2817611918915, -357.7401173908003, -378.7064624861363, -726.2176952122874, -583.6217558550242, -104.29702293963446, -1146.2379673555588, -262.75112488318985, -218.24082923489362, -647.7577809735968, -735.6691613225377, -1032.8061411768988, -659.3511331612559, -1449.6660024605576, -312.35475073506575, -13.834933106115102, -899.2983167790305, -377.4375762934826, -433.0570836097591, -471.0942387826644, -399.95963070056234, -438.5708884169934, -319.4101551766667, -435.3829595899666, -534.2750596060821, -70.70937524314209, -887.8030204546214, -919.5244582734194, -913.8741452997356, -318.22317727548375, -444.30149943267, -785.7899447011204, -413.6598380874723, -21.914053391362383, -870.2797514677749, -539.9530772357987, -966.7044152714349, -1319.0959009646215, -351.3952159955382, -299.68834558078294, -385.47192501110203, -1228.0494896177606, -715.2878353989497, -568.8777779820568, -257.9436007530694, -101.30977702047994, -56.83080555501868, -1393.9408739385565, -529.8061563277469, -868.0320244215052, -9.252621065598504, -52.29899888217187, -68.07769161177308, -700.1839046814616, -1332.5835941297498, -172.1849638351138, -1098.7396426595894, -653.0211847632887, -308.05420080058786, -752.2764740098056, -521.6241013572377, -382.1101729513895, -1285.4861592423595, -714.8212903838325, -760.4818870087055, -450.09294081361793, -26.015476826707705, -209.0438593986329, -130.62358010156169, -275.17833553505716, -431.5636138884226, -96.0408735520478, -49.29573561442795, -617.3117517894557, -155.74572586110764, -272.27910441764186, -1087.1805406553465, -255.28099687587112, -567.8795524753355, -277.98290222062826, -624.3392752455566, -841.3483310999618, -237.25705019014535, -413.58808902347374, -298.0758435742322, -1050.7034866382837, -963.6058281888751, -573.0867674995583, -427.73650308313944, -260.6575634767904, -972.3979015212963, -127.67502065146186, -265.6704189865419, -688.1359699445101, -1048.3813761924566, -638.9766252379476, -211.69886442197014, -1047.1190727777125, -102.95438937907589, -49.157396125526525, -38.894032597707245, -280.12334083092645, -340.2490599037465, -34.52388315637132, -499.9298410308921, -1083.2460179235345, -35.83992830764775, -48.49704099009596, -29.75368522702171, -488.1942189618567, -466.68238891484003, -1087.3873687974224, -88.97897748822587, -284.00400339251365, -989.3574841681241, -1005.3241495926183, -502.7006443743295, -947.8999290770472, -475.00919582834575, -244.5916129612323, -247.73652895842648, -596.9086970305898, -431.7051586549113, -272.09174652110664, -83.87774810041402, -493.33293927007344, -1399.5561369434581, -1379.9158375149443, -368.33035295365687, -311.12505579447, -1096.0743232058364, -591.4392722698956, -409.8176926609216, -97.52540678116955, -682.1167251317318, -110.42877632881293, -856.1524486315672, -927.269905740146, -826.7150417087904, -1357.5563788133716, -104.03342512590186, -129.81050784695867, -469.8058117924985, -208.38064950042758, -1351.0677477067682, -837.4837153546649, -434.0577744229973, -433.17743895680917, -81.30342920688368, -131.89224260909708, -277.26283223739455, -284.19134473668544, -230.18066115103795, -669.9923712279792, -713.9874494270613, -389.90978716855705, -428.94298361370403, -723.5395332158303, -123.07352432060452, -685.9679199299522, -1274.656882988762, -434.7915563072101, -73.29076537649705, -507.549028063205, -1122.7871520735378, -233.42451268212653, -1418.0942189865375, -836.2119293666503, -159.50206809276364, -313.47950035821566, -162.81151426978343, -299.94242235682395, -161.36608106186867, -663.1641187392506, -513.33723420668, -628.9530838198989, -448.747787627656, -742.6611737842712, -745.0473960076331, -457.39239757948053, -531.9252261526766, -742.9318926551166, -1479.6828109017702, -622.7870886007083, -917.0910294330653, -391.600020844732, -191.20140481200556, -353.906406213024, -187.6433181714513, -218.32435235785834, -245.01513105575089, -668.0224586153582, -382.12347871425175, -714.2287874004361, -740.2793432530163, -85.72901345356277, -967.2607516030603, -8.948732046047525, -43.35892112087394, -89.79636261598746, -35.224306607204376, -1032.2652928886864, -1088.6637271901247, -706.8087491006145, -647.4944573523233, -235.84192312448073, -814.9090978257881, -306.8708381191634, -43.47630965048536, -693.9505266315883, -645.1023021193889, -319.5825353761895, -62.80658612019483, -428.04504462069326, -480.0995818996677, -482.46541241606633, -566.8629341603154, -484.38176026225767, -713.8648047665306, -4.939275291428803, -323.4710647139697, -1377.1003154228504, -1051.2797493353798, -145.68532172436713, -479.63543038675397, -275.90849598994356, -118.69738658278436, -885.3906025851236, -93.40816255161752, -973.0005937417629, -734.0734681161982, -167.77332164985629, -142.7911799246998, -633.9714608100361, -814.7640070095915, -509.7876521725774, -1124.302162708267, -842.0770273813106, -61.30068765549039, -214.3930948168797, -91.56496188140179, -635.3566982369973, -1352.4489933568586, -124.03124932586128, -246.17764220625594, -264.36547498027795, -217.35008946842802, -553.9208099822832, -850.2283871183186, -310.4481280440529, -435.33581577224703, -647.4288646637478, -666.8390430854433, -505.76835292217754, -467.37086286840764, -860.5826221130089, -947.633558395905, -849.5935803332159, -238.29338202227663, -358.6703480154053, -534.6963639591999, -567.6455394558418, -39.61046955501714, -102.27037137844768, -520.2964310842923, -1218.6963180091695, -453.09450892425974, -1235.3807079610583, -492.0628759121281, -321.50860654647073, -195.75042782417077, -510.35796516051005, -355.46048723186044, -242.85109650105144, -1310.7600059512827, -827.8649811419886, -1305.88498265057, -251.34959283580892, -920.4398311009165, -859.8193651409147, -439.7105508029513, -86.16573435703931, -330.8142387183881, -296.01606507474725, -227.4114141627731, -213.0597019134811, -618.5969664652189, -128.76018392985392, -156.64111882972537, -1077.094987942474, -750.6664045358054, -909.5812969117372, -707.8856733200212, -564.2677361875252, -235.46250622227404, -483.2090885141919, -898.4867777566492, -568.9615094454037, -255.19863019205212, -1153.5854324704258, -265.14813068917266, -735.9562738374773, -881.4110054853801, -251.61133625760687, -407.8620226588963, -692.4313624097105, -1180.5579503552146, -107.64458438023743, -202.92603671641686, -572.0611469377028, -196.1311443573848, -688.8616530034598, -730.9230226721882, -87.55094402690473, -455.6477203909204, -82.03617623400987, -557.2091683874804, -368.0371612940269, -456.64244807130217, -151.49000759524577, -416.1965619175572, -900.1057318330915, -42.955915971790674, -1366.6629974390496, -503.01529175983336, -164.47126816759635, -725.7375527956497, -506.47927268127336, -631.6845517449106, -1085.8718466696826, -436.5207953827602, -677.9181343908602, -324.4132611100954, -789.1229990147867, -730.4255407560078, -1113.8695702804425, -79.87486991178189, -1232.8387966257415, -73.14416915924146, -164.61163235971088, -604.2707344673694, -1.6256798131125696, -513.9606028385859, -68.11722740640529, -721.5464138091722, -791.7494636843353, -1455.4459788740594, -387.0790457408798, -470.73842291348245, -1061.1592713366238, -242.1619674663335, -1063.488646249393, -9.675137530709112, -717.3513292375666, -748.3033204812356, -987.2757825405071, -203.86258292314446, -518.1881124681285, -376.4181667154822, -667.8127090213253, -287.5888376960731, -1063.2008783309484, -110.07173834489907, -585.137964315617, -1203.818711051385, -906.1769410692762, -850.1253863309278, -738.1988785342409, -673.3950749333412, -422.8826550092532, -517.2597386361869, -752.5500963587907, -1223.4509642317096, -947.1562409821411, -704.9694435698098, -916.4268845425198, -523.3497408147533, -761.437582972595, -781.6120650985924, -160.41616045518205, -93.21676178830857, -26.349185673359806, -68.91553135949758, -40.59198018788048, -754.6868634396621, -391.58951412795466, -695.6739462682451, -830.5249309266319, -522.6403788346017, -287.78046494301555, -9.080320054043336, -259.59694258750704, -846.8100434017224, -703.9982633971775, -358.5761007017246, -662.0343350449523, -774.3842887119825, -80.40641006599506, -899.4871529753565, -103.43184575958627, -35.26826442562671, -131.1666148181506, -1290.7513896308947, -342.0064311065935, -19.4012239646294, -255.37851240588878, -435.7945862023012, -336.0346467339972, -37.31716340394156, -555.9309381654357, -1202.0139258311249, -526.8018162130044, -1061.9062282897469, -260.56866923386923, -458.6664672116759, -595.6432331817939, -1083.0762058543921, -1152.6769462032207, -695.1364423720088, -122.26608621239885, -393.7022721738202, -254.19256675152903, -1119.16873494101, -1048.3553608683944, -901.231537688563, -270.2774476944182, -400.6058888938824, -573.7046449881366, -1050.2277363500205, -512.6607150846411, -391.2644340162928, -988.5925300719473, -337.6380269812414, -112.60036433647743, -767.1055405341934, -57.67449933765903, -577.2965553053868, -177.7612999043961, -1013.0943639255116, -100.48247704238713, -262.565476884469, -107.69922872359552, -288.70239582219506, -428.1598856619488, -305.6710304947417, -899.4257012960603, -1286.3812826235976, -240.9925932426294, -557.5079619590257, -558.0448981835905, -969.9732197993102, -304.8809255926608, -776.6718625900617, -256.4974191344885, -110.4718418820989, -554.2410712068086, -575.9978125114495, -591.8654336647465, -740.2112202288067, -141.64613276349206, -516.196704992914, -289.35425217819784, -133.98054179898242, -1448.0427833104295, -33.430791255331755, -868.8438832891171, -105.9166564877339, -212.86680123859864, -509.93069660918593, -658.5682514674463, -790.6232590351084, -330.65888360145664, -803.144004305973, -133.95389440831636, -207.64869959070583, -46.52857916408297, -372.3055484031401, -183.17343855718016, -225.48953848458055, -116.65076412913598, -501.1314027924793, -431.7632784321367, -70.40937013855387, -287.3830614880769, -834.2984629499135, -68.28063222419274, -150.6435766289279, -635.2734714337735, -696.6161760785128, -204.407476969902, -646.7401029462254, -1294.6701198024846, -361.54462075399, -903.4922558416946, -76.81434188522104, -829.834400343235, -298.45558522452933, -912.531355861677, -775.0727217463531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5798736646464726, "mean_inference_ms": 1.7294510507025773, "mean_action_processing_ms": 0.8370720781952737, "mean_env_wait_ms": 10.611066592563132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013521909713745117, "StateBufferConnector_ms": 0.009572267532348633, "ViewRequirementAgentConnector_ms": 0.3306117057800293}, "num_episodes": 25, "episode_return_max": -389.4896194642285, "episode_return_min": -4616.299393680566, "episode_return_mean": -2643.603063152455, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 891997, "num_agent_steps_trained": 891997, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.85621769911901, "num_env_steps_trained_throughput_per_sec": 81.85621769911901, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 891997, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 891997, "timers": {"training_iteration_time_ms": 45375.544, "restore_workers_time_ms": 0.026, "training_step_time_ms": 45375.474, "sample_time_ms": 3346.981, "learn_time_ms": 41970.676, "learn_throughput": 95.305, "synch_weights_time_ms": 54.828}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 891997, "num_agent_steps_trained": 891997}, "done": false, "training_iteration": 50, "trial_id": "05c72_00000", "date": "2024-07-26_15-24-46", "timestamp": 1721987686, "time_this_iter_s": 48.87855410575867, "time_total_s": 2506.116633415222, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e6830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2506.116633415222, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 13.434782608695652, "ram_util_percent": 30.511594202898547}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 147.08078307878404, "cur_kl_coeff": 0.50625, "cur_lr": 0.0010000000000000005, "total_loss": 4.850375236386345, "policy_loss": -0.0002429918179820691, "vf_loss": 4.865172855683736, "vf_explained_var": 0.9834158526431946, "kl": 0.016451057710912122, "entropy": 2.2882966758239838, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65714285714286, "num_grad_updates_lifetime": 212010.5, "diff_num_grad_updates_vs_sampler_policy": 2099.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 909869, "num_agent_steps_trained": 909869}, "env_runners": {"episode_reward_max": -389.4896194642285, "episode_reward_min": -4616.299393680566, "episode_reward_mean": -2593.479294529975, "episode_len_mean": 148.08, "episode_media": {}, "episodes_timesteps_total": 14808, "policy_reward_min": {"policy_0": -1479.6828109017702}, "policy_reward_max": {"policy_0": -1.6256798131125696}, "policy_reward_mean": {"policy_0": -518.695858905995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3078.7466754461393, -3834.719415889752, -2041.4421794742789, -2227.7142081436523, -1845.5767614765605, -2952.758438402616, -2048.5926260722404, -2149.486994868059, -2727.6744935048405, -2902.4757264879945, -1853.0400780962254, -2651.61002424255, -3352.2315369272396, -2417.7949976179993, -2132.0424037555613, -2565.820204487668, -3363.474005732814, -1602.8930923639118, -3919.5308418909076, -1625.928583264062, -4616.299393680566, -2012.5259540940408, -1344.4693853010526, -4009.4960988975645, -2441.318512130572, -3287.7121787400583, -2591.4219565204717, -2275.5279109976414, -1919.572674377739, -2877.4112147567307, -2531.3879371492626, -3313.8470365681846, -3230.1529467332134, -1352.5858768851836, -3826.5593250219354, -3093.8363518206224, -2834.0479651284977, -2713.812127708863, -4371.714991919166, -3863.299695218082, -3687.795716998271, -389.4896194642285, -3195.115633597098, -2107.2660343834673, -2774.88828750001, -1902.6245457408527, -1083.9261327107592, -3607.2215777331776, -3985.1992948230923, -2937.6850209471568, -3196.0472556150175, -2342.756070490604, -2592.932259007146, -1187.6094641345965, -3289.978569616054, -2866.068325300115, -2572.787379493907, -2529.2204150440184, -1730.9888288799675, -2716.9482928183006, -1035.1458041996902, -1407.3378769803821, -2385.1123193153203, -3410.8545763143006, -2892.708405061014, -3299.176446264174, -1446.5466416904335, -3026.575376463223, -2858.677926754434, -2620.5680952265593, -2156.338260990175, -2640.4963526679226, -1575.6235432828114, -1286.3927157043884, -2303.397317547537, -3294.751440699008, -1394.454317051684, -3516.261358877723, -1613.7565264732177, -4229.123781477336, -1750.0512799337287, -2296.9505295202134, -3896.4543593382205, -1367.3202182028476, -2051.101224237675, -3350.2470675877003, -979.2654695585398, -2288.658184434674, -2178.305540576323, -4550.835596766598, -2613.9340303012164, -3026.3249797635494, -1756.1679497578332, -4125.614657160881, -994.8928102485556, -3288.997932985021, -3056.490136857624, -984.193643296643, -3711.3220794908, -2190.401133845165], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 114, 150, 150], "policy_policy_0_reward": [-513.33723420668, -628.9530838198989, -448.747787627656, -742.6611737842712, -745.0473960076331, -457.39239757948053, -531.9252261526766, -742.9318926551166, -1479.6828109017702, -622.7870886007083, -917.0910294330653, -391.600020844732, -191.20140481200556, -353.906406213024, -187.6433181714513, -218.32435235785834, -245.01513105575089, -668.0224586153582, -382.12347871425175, -714.2287874004361, -740.2793432530163, -85.72901345356277, -967.2607516030603, -8.948732046047525, -43.35892112087394, -89.79636261598746, -35.224306607204376, -1032.2652928886864, -1088.6637271901247, -706.8087491006145, -647.4944573523233, -235.84192312448073, -814.9090978257881, -306.8708381191634, -43.47630965048536, -693.9505266315883, -645.1023021193889, -319.5825353761895, -62.80658612019483, -428.04504462069326, -480.0995818996677, -482.46541241606633, -566.8629341603154, -484.38176026225767, -713.8648047665306, -4.939275291428803, -323.4710647139697, -1377.1003154228504, -1051.2797493353798, -145.68532172436713, -479.63543038675397, -275.90849598994356, -118.69738658278436, -885.3906025851236, -93.40816255161752, -973.0005937417629, -734.0734681161982, -167.77332164985629, -142.7911799246998, -633.9714608100361, -814.7640070095915, -509.7876521725774, -1124.302162708267, -842.0770273813106, -61.30068765549039, -214.3930948168797, -91.56496188140179, -635.3566982369973, -1352.4489933568586, -124.03124932586128, -246.17764220625594, -264.36547498027795, -217.35008946842802, -553.9208099822832, -850.2283871183186, -310.4481280440529, -435.33581577224703, -647.4288646637478, -666.8390430854433, -505.76835292217754, -467.37086286840764, -860.5826221130089, -947.633558395905, -849.5935803332159, -238.29338202227663, -358.6703480154053, -534.6963639591999, -567.6455394558418, -39.61046955501714, -102.27037137844768, -520.2964310842923, -1218.6963180091695, -453.09450892425974, -1235.3807079610583, -492.0628759121281, -321.50860654647073, -195.75042782417077, -510.35796516051005, -355.46048723186044, -242.85109650105144, -1310.7600059512827, -827.8649811419886, -1305.88498265057, -251.34959283580892, -920.4398311009165, -859.8193651409147, -439.7105508029513, -86.16573435703931, -330.8142387183881, -296.01606507474725, -227.4114141627731, -213.0597019134811, -618.5969664652189, -128.76018392985392, -156.64111882972537, -1077.094987942474, -750.6664045358054, -909.5812969117372, -707.8856733200212, -564.2677361875252, -235.46250622227404, -483.2090885141919, -898.4867777566492, -568.9615094454037, -255.19863019205212, -1153.5854324704258, -265.14813068917266, -735.9562738374773, -881.4110054853801, -251.61133625760687, -407.8620226588963, -692.4313624097105, -1180.5579503552146, -107.64458438023743, -202.92603671641686, -572.0611469377028, -196.1311443573848, -688.8616530034598, -730.9230226721882, -87.55094402690473, -455.6477203909204, -82.03617623400987, -557.2091683874804, -368.0371612940269, -456.64244807130217, -151.49000759524577, -416.1965619175572, -900.1057318330915, -42.955915971790674, -1366.6629974390496, -503.01529175983336, -164.47126816759635, -725.7375527956497, -506.47927268127336, -631.6845517449106, -1085.8718466696826, -436.5207953827602, -677.9181343908602, -324.4132611100954, -789.1229990147867, -730.4255407560078, -1113.8695702804425, -79.87486991178189, -1232.8387966257415, -73.14416915924146, -164.61163235971088, -604.2707344673694, -1.6256798131125696, -513.9606028385859, -68.11722740640529, -721.5464138091722, -791.7494636843353, -1455.4459788740594, -387.0790457408798, -470.73842291348245, -1061.1592713366238, -242.1619674663335, -1063.488646249393, -9.675137530709112, -717.3513292375666, -748.3033204812356, -987.2757825405071, -203.86258292314446, -518.1881124681285, -376.4181667154822, -667.8127090213253, -287.5888376960731, -1063.2008783309484, -110.07173834489907, -585.137964315617, -1203.818711051385, -906.1769410692762, -850.1253863309278, -738.1988785342409, -673.3950749333412, -422.8826550092532, -517.2597386361869, -752.5500963587907, -1223.4509642317096, -947.1562409821411, -704.9694435698098, -916.4268845425198, -523.3497408147533, -761.437582972595, -781.6120650985924, -160.41616045518205, -93.21676178830857, -26.349185673359806, -68.91553135949758, -40.59198018788048, -754.6868634396621, -391.58951412795466, -695.6739462682451, -830.5249309266319, -522.6403788346017, -287.78046494301555, -9.080320054043336, -259.59694258750704, -846.8100434017224, -703.9982633971775, -358.5761007017246, -662.0343350449523, -774.3842887119825, -80.40641006599506, -899.4871529753565, -103.43184575958627, -35.26826442562671, -131.1666148181506, -1290.7513896308947, -342.0064311065935, -19.4012239646294, -255.37851240588878, -435.7945862023012, -336.0346467339972, -37.31716340394156, -555.9309381654357, -1202.0139258311249, -526.8018162130044, -1061.9062282897469, -260.56866923386923, -458.6664672116759, -595.6432331817939, -1083.0762058543921, -1152.6769462032207, -695.1364423720088, -122.26608621239885, -393.7022721738202, -254.19256675152903, -1119.16873494101, -1048.3553608683944, -901.231537688563, -270.2774476944182, -400.6058888938824, -573.7046449881366, -1050.2277363500205, -512.6607150846411, -391.2644340162928, -988.5925300719473, -337.6380269812414, -112.60036433647743, -767.1055405341934, -57.67449933765903, -577.2965553053868, -177.7612999043961, -1013.0943639255116, -100.48247704238713, -262.565476884469, -107.69922872359552, -288.70239582219506, -428.1598856619488, -305.6710304947417, -899.4257012960603, -1286.3812826235976, -240.9925932426294, -557.5079619590257, -558.0448981835905, -969.9732197993102, -304.8809255926608, -776.6718625900617, -256.4974191344885, -110.4718418820989, -554.2410712068086, -575.9978125114495, -591.8654336647465, -740.2112202288067, -141.64613276349206, -516.196704992914, -289.35425217819784, -133.98054179898242, -1448.0427833104295, -33.430791255331755, -868.8438832891171, -105.9166564877339, -212.86680123859864, -509.93069660918593, -658.5682514674463, -790.6232590351084, -330.65888360145664, -803.144004305973, -133.95389440831636, -207.64869959070583, -46.52857916408297, -372.3055484031401, -183.17343855718016, -225.48953848458055, -116.65076412913598, -501.1314027924793, -431.7632784321367, -70.40937013855387, -287.3830614880769, -834.2984629499135, -68.28063222419274, -150.6435766289279, -635.2734714337735, -696.6161760785128, -204.407476969902, -646.7401029462254, -1294.6701198024846, -361.54462075399, -903.4922558416946, -76.81434188522104, -829.834400343235, -298.45558522452933, -912.531355861677, -775.0727217463531, -101.29266458147605, -1149.5773891028737, -892.9654704695841, -397.4356815948632, -757.9052405153725, -95.16399463721002, -822.7341486249305, -450.273522796258, -48.624094968659506, -29.75088066337618, -389.7147225823834, -623.0405556536283, -729.6563135501876, -1251.5504923491947, -32.6132923278282, -1146.8749865495452, -891.9812427135718, -178.00689349940484, -564.8856040214811, -76.92919997043315, -741.998870027108, -72.23238039034264, -306.9981334698599, -764.5832484735378, -734.7554628657138, -320.21743840122394, -8.845397863600528, -418.4617740467165, -530.1049173067601, -878.7087333718725, -75.11637977404206, -103.35411126986733, -958.1475667763098, -1197.2018796409297, -306.67641520677313, -95.18473720697169, -38.42930492285545, -88.89378133360614, -835.4119911639295, -517.7037286554483, -362.37644705705094, -334.373338227911, -88.13379915613991, -331.5472649654462, -169.96186629783992, -59.2540622493566, -1304.8781803787547, -301.7721037198391, -294.2008196866836, -343.29215151290117, -696.9814796478069, -339.58490980637606, -1026.5581715901037, -987.3968351244067, -244.23004453031297, -26.478609865178086, -61.34203066650145, -532.5947006573564, -425.1616106517976, -348.87736521085156, -1071.990296966973, -889.1503382615753, -216.03035297888715, -408.70786545152924, -930.3825052187615, -725.431765967894, -81.38670423991786, -123.98820068003353, -92.25601621129886, -590.6938393740734, -813.9753549231441, -577.3970721435223, -912.1912764482934, -1277.988486632384, -647.5715913299914, -168.50915749596854, -356.4375258881975, -170.87803454062782, -9.457191572233267, -1044.7693704367018, -1375.499293669395, -254.50392955937997, -225.6703399454048, -176.5245641779789, -264.75240216805634, -316.34112474893783, -1216.5210080240174, -986.1329199139742, -793.3386041454337, -584.1207025058557, -232.6906883689302, -663.2556892790733, -360.3823429294219, -44.643892033374435, -66.34760559204803, -609.4162170057716, -48.37387373631021, -142.94658762220448, -567.2904611685141, -683.0740847048729, -951.833046253561, -728.904736985031, -895.9104591949342, -657.9650541643086, -115.63377098986409, -563.4370297479923, -8.439310517936978, -13.800913728753489, -38.748386009145406, -354.83982955471157, -872.7336058124147, -45.10041594306299, -179.1449111866677, -932.8508957208694, -258.82835577165895, -48.44907394024329, -625.6145492949618, -286.1465454882317, -1045.7490105742527, -172.3463612786343, -1022.9816388948817, -1363.7799244248704, -726.9461690480485, -1068.6542237675135, -368.4736406312863, -68.12093879621791, -615.8960080185734, -550.3209047467776, -845.7114336110961, -533.8847451285498, -1053.03929707456, -999.0146243987245, -225.84024407843336, -55.16011849711311, -693.2706957147186, -69.9629221290675, -453.406834246485, -479.2132054188092, -620.9657358693248, -132.61925209414574, -926.9822185052998, -59.12222435727569, -1188.3496076564645, -690.6145411472107, -1260.5460654946298, -67.32010244172778, -239.3301860286726, -354.08973146048857, -143.0505228473275, -191.1022674703388, -1328.0055722499242, -644.9595256148301, -1029.6613882058668, -133.01709614916163, -153.3543507652389, -768.1801025981, -600.750699569222, -591.4952260027327, -637.9064310511699, -458.15767763640144, -73.29054024778648, -339.8793204242152, -185.168474821506, -316.5661715102944, -69.28913629284159, -898.9435306760471, -1142.47916057374, -1126.7115098745653, -422.11768546615826, -121.0701929002898, -446.91954367445453, -117.68744956702982, -646.7114313515742, -697.9667599153462, -281.11594933676054]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5788471691366843, "mean_inference_ms": 1.7308183661549794, "mean_action_processing_ms": 0.8374619293751668, "mean_env_wait_ms": 10.61616411071063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014257669448852539, "StateBufferConnector_ms": 0.010303735733032227, "ViewRequirementAgentConnector_ms": 0.3534860610961914}, "num_episodes": 35, "episode_return_max": -389.4896194642285, "episode_return_min": -4616.299393680566, "episode_return_mean": -2593.479294529975, "episodes_this_iter": 35}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 909869, "num_agent_steps_trained": 909869, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.74650792250617, "num_env_steps_trained_throughput_per_sec": 88.74650792250617, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 909869, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 909869, "timers": {"training_iteration_time_ms": 45984.235, "restore_workers_time_ms": 0.027, "training_step_time_ms": 45984.163, "sample_time_ms": 3340.576, "learn_time_ms": 42585.614, "learn_throughput": 93.928, "synch_weights_time_ms": 54.975}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 909869, "num_agent_steps_trained": 909869}, "done": false, "training_iteration": 51, "trial_id": "05c72_00000", "date": "2024-07-26_15-25-31", "timestamp": 1721987731, "time_this_iter_s": 45.08270978927612, "time_total_s": 2551.1993432044983, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e7c70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2551.1993432044983, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 13.8828125, "ram_util_percent": 30.731249999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 164.5504544796088, "cur_kl_coeff": 0.50625, "cur_lr": 0.0010000000000000005, "total_loss": 4.743632704783709, "policy_loss": -0.0013769886487474043, "vf_loss": 4.759100816800044, "vf_explained_var": 0.9844741304715474, "kl": 0.018270497175343244, "entropy": 2.334057580049221, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.62307692307692, "num_grad_updates_lifetime": 216060.5, "diff_num_grad_updates_vs_sampler_policy": 1949.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 926460, "num_agent_steps_trained": 926460}, "env_runners": {"episode_reward_max": -389.4896194642285, "episode_reward_min": -4550.835596766598, "episode_reward_mean": -2573.741226682575, "episode_len_mean": 147.84, "episode_media": {}, "episodes_timesteps_total": 14784, "policy_reward_min": {"policy_0": -1455.4459788740594}, "policy_reward_max": {"policy_0": -1.6256798131125696}, "policy_reward_mean": {"policy_0": -514.748245336515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2012.5259540940408, -1344.4693853010526, -4009.4960988975645, -2441.318512130572, -3287.7121787400583, -2591.4219565204717, -2275.5279109976414, -1919.572674377739, -2877.4112147567307, -2531.3879371492626, -3313.8470365681846, -3230.1529467332134, -1352.5858768851836, -3826.5593250219354, -3093.8363518206224, -2834.0479651284977, -2713.812127708863, -4371.714991919166, -3863.299695218082, -3687.795716998271, -389.4896194642285, -3195.115633597098, -2107.2660343834673, -2774.88828750001, -1902.6245457408527, -1083.9261327107592, -3607.2215777331776, -3985.1992948230923, -2937.6850209471568, -3196.0472556150175, -2342.756070490604, -2592.932259007146, -1187.6094641345965, -3289.978569616054, -2866.068325300115, -2572.787379493907, -2529.2204150440184, -1730.9888288799675, -2716.9482928183006, -1035.1458041996902, -1407.3378769803821, -2385.1123193153203, -3410.8545763143006, -2892.708405061014, -3299.176446264174, -1446.5466416904335, -3026.575376463223, -2858.677926754434, -2620.5680952265593, -2156.338260990175, -2640.4963526679226, -1575.6235432828114, -1286.3927157043884, -2303.397317547537, -3294.751440699008, -1394.454317051684, -3516.261358877723, -1613.7565264732177, -4229.123781477336, -1750.0512799337287, -2296.9505295202134, -3896.4543593382205, -1367.3202182028476, -2051.101224237675, -3350.2470675877003, -979.2654695585398, -2288.658184434674, -2178.305540576323, -4550.835596766598, -2613.9340303012164, -3026.3249797635494, -1756.1679497578332, -4125.614657160881, -994.8928102485556, -3288.997932985021, -3056.490136857624, -984.193643296643, -3711.3220794908, -2190.401133845165, -2473.9824784462758, -2273.765038150638, -1570.017699339898, -2342.4973017763723, -3711.803352218344, -3352.8976798084477, -4416.334439376995, -1205.4497719193596, -2449.478852114103, -2535.821233839255, -2035.9170171389417, -1925.0554188627425, -4226.139470211598, -3855.6878628353365, -1947.746137260771, -1468.6592257475727, -2889.9756581245833, -2262.1539934911566, -1358.211963157321, -2797.934479422356, -2836.516823843548], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 134, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-859.8193651409147, -439.7105508029513, -86.16573435703931, -330.8142387183881, -296.01606507474725, -227.4114141627731, -213.0597019134811, -618.5969664652189, -128.76018392985392, -156.64111882972537, -1077.094987942474, -750.6664045358054, -909.5812969117372, -707.8856733200212, -564.2677361875252, -235.46250622227404, -483.2090885141919, -898.4867777566492, -568.9615094454037, -255.19863019205212, -1153.5854324704258, -265.14813068917266, -735.9562738374773, -881.4110054853801, -251.61133625760687, -407.8620226588963, -692.4313624097105, -1180.5579503552146, -107.64458438023743, -202.92603671641686, -572.0611469377028, -196.1311443573848, -688.8616530034598, -730.9230226721882, -87.55094402690473, -455.6477203909204, -82.03617623400987, -557.2091683874804, -368.0371612940269, -456.64244807130217, -151.49000759524577, -416.1965619175572, -900.1057318330915, -42.955915971790674, -1366.6629974390496, -503.01529175983336, -164.47126816759635, -725.7375527956497, -506.47927268127336, -631.6845517449106, -1085.8718466696826, -436.5207953827602, -677.9181343908602, -324.4132611100954, -789.1229990147867, -730.4255407560078, -1113.8695702804425, -79.87486991178189, -1232.8387966257415, -73.14416915924146, -164.61163235971088, -604.2707344673694, -1.6256798131125696, -513.9606028385859, -68.11722740640529, -721.5464138091722, -791.7494636843353, -1455.4459788740594, -387.0790457408798, -470.73842291348245, -1061.1592713366238, -242.1619674663335, -1063.488646249393, -9.675137530709112, -717.3513292375666, -748.3033204812356, -987.2757825405071, -203.86258292314446, -518.1881124681285, -376.4181667154822, -667.8127090213253, -287.5888376960731, -1063.2008783309484, -110.07173834489907, -585.137964315617, -1203.818711051385, -906.1769410692762, -850.1253863309278, -738.1988785342409, -673.3950749333412, -422.8826550092532, -517.2597386361869, -752.5500963587907, -1223.4509642317096, -947.1562409821411, -704.9694435698098, -916.4268845425198, -523.3497408147533, -761.437582972595, -781.6120650985924, -160.41616045518205, -93.21676178830857, -26.349185673359806, -68.91553135949758, -40.59198018788048, -754.6868634396621, -391.58951412795466, -695.6739462682451, -830.5249309266319, -522.6403788346017, -287.78046494301555, -9.080320054043336, -259.59694258750704, -846.8100434017224, -703.9982633971775, -358.5761007017246, -662.0343350449523, -774.3842887119825, -80.40641006599506, -899.4871529753565, -103.43184575958627, -35.26826442562671, -131.1666148181506, -1290.7513896308947, -342.0064311065935, -19.4012239646294, -255.37851240588878, -435.7945862023012, -336.0346467339972, -37.31716340394156, -555.9309381654357, -1202.0139258311249, -526.8018162130044, -1061.9062282897469, -260.56866923386923, -458.6664672116759, -595.6432331817939, -1083.0762058543921, -1152.6769462032207, -695.1364423720088, -122.26608621239885, -393.7022721738202, -254.19256675152903, -1119.16873494101, -1048.3553608683944, -901.231537688563, -270.2774476944182, -400.6058888938824, -573.7046449881366, -1050.2277363500205, -512.6607150846411, -391.2644340162928, -988.5925300719473, -337.6380269812414, -112.60036433647743, -767.1055405341934, -57.67449933765903, -577.2965553053868, -177.7612999043961, -1013.0943639255116, -100.48247704238713, -262.565476884469, -107.69922872359552, -288.70239582219506, -428.1598856619488, -305.6710304947417, -899.4257012960603, -1286.3812826235976, -240.9925932426294, -557.5079619590257, -558.0448981835905, -969.9732197993102, -304.8809255926608, -776.6718625900617, -256.4974191344885, -110.4718418820989, -554.2410712068086, -575.9978125114495, -591.8654336647465, -740.2112202288067, -141.64613276349206, -516.196704992914, -289.35425217819784, -133.98054179898242, -1448.0427833104295, -33.430791255331755, -868.8438832891171, -105.9166564877339, -212.86680123859864, -509.93069660918593, -658.5682514674463, -790.6232590351084, -330.65888360145664, -803.144004305973, -133.95389440831636, -207.64869959070583, -46.52857916408297, -372.3055484031401, -183.17343855718016, -225.48953848458055, -116.65076412913598, -501.1314027924793, -431.7632784321367, -70.40937013855387, -287.3830614880769, -834.2984629499135, -68.28063222419274, -150.6435766289279, -635.2734714337735, -696.6161760785128, -204.407476969902, -646.7401029462254, -1294.6701198024846, -361.54462075399, -903.4922558416946, -76.81434188522104, -829.834400343235, -298.45558522452933, -912.531355861677, -775.0727217463531, -101.29266458147605, -1149.5773891028737, -892.9654704695841, -397.4356815948632, -757.9052405153725, -95.16399463721002, -822.7341486249305, -450.273522796258, -48.624094968659506, -29.75088066337618, -389.7147225823834, -623.0405556536283, -729.6563135501876, -1251.5504923491947, -32.6132923278282, -1146.8749865495452, -891.9812427135718, -178.00689349940484, -564.8856040214811, -76.92919997043315, -741.998870027108, -72.23238039034264, -306.9981334698599, -764.5832484735378, -734.7554628657138, -320.21743840122394, -8.845397863600528, -418.4617740467165, -530.1049173067601, -878.7087333718725, -75.11637977404206, -103.35411126986733, -958.1475667763098, -1197.2018796409297, -306.67641520677313, -95.18473720697169, -38.42930492285545, -88.89378133360614, -835.4119911639295, -517.7037286554483, -362.37644705705094, -334.373338227911, -88.13379915613991, -331.5472649654462, -169.96186629783992, -59.2540622493566, -1304.8781803787547, -301.7721037198391, -294.2008196866836, -343.29215151290117, -696.9814796478069, -339.58490980637606, -1026.5581715901037, -987.3968351244067, -244.23004453031297, -26.478609865178086, -61.34203066650145, -532.5947006573564, -425.1616106517976, -348.87736521085156, -1071.990296966973, -889.1503382615753, -216.03035297888715, -408.70786545152924, -930.3825052187615, -725.431765967894, -81.38670423991786, -123.98820068003353, -92.25601621129886, -590.6938393740734, -813.9753549231441, -577.3970721435223, -912.1912764482934, -1277.988486632384, -647.5715913299914, -168.50915749596854, -356.4375258881975, -170.87803454062782, -9.457191572233267, -1044.7693704367018, -1375.499293669395, -254.50392955937997, -225.6703399454048, -176.5245641779789, -264.75240216805634, -316.34112474893783, -1216.5210080240174, -986.1329199139742, -793.3386041454337, -584.1207025058557, -232.6906883689302, -663.2556892790733, -360.3823429294219, -44.643892033374435, -66.34760559204803, -609.4162170057716, -48.37387373631021, -142.94658762220448, -567.2904611685141, -683.0740847048729, -951.833046253561, -728.904736985031, -895.9104591949342, -657.9650541643086, -115.63377098986409, -563.4370297479923, -8.439310517936978, -13.800913728753489, -38.748386009145406, -354.83982955471157, -872.7336058124147, -45.10041594306299, -179.1449111866677, -932.8508957208694, -258.82835577165895, -48.44907394024329, -625.6145492949618, -286.1465454882317, -1045.7490105742527, -172.3463612786343, -1022.9816388948817, -1363.7799244248704, -726.9461690480485, -1068.6542237675135, -368.4736406312863, -68.12093879621791, -615.8960080185734, -550.3209047467776, -845.7114336110961, -533.8847451285498, -1053.03929707456, -999.0146243987245, -225.84024407843336, -55.16011849711311, -693.2706957147186, -69.9629221290675, -453.406834246485, -479.2132054188092, -620.9657358693248, -132.61925209414574, -926.9822185052998, -59.12222435727569, -1188.3496076564645, -690.6145411472107, -1260.5460654946298, -67.32010244172778, -239.3301860286726, -354.08973146048857, -143.0505228473275, -191.1022674703388, -1328.0055722499242, -644.9595256148301, -1029.6613882058668, -133.01709614916163, -153.3543507652389, -768.1801025981, -600.750699569222, -591.4952260027327, -637.9064310511699, -458.15767763640144, -73.29054024778648, -339.8793204242152, -185.168474821506, -316.5661715102944, -69.28913629284159, -898.9435306760471, -1142.47916057374, -1126.7115098745653, -422.11768546615826, -121.0701929002898, -446.91954367445453, -117.68744956702982, -646.7114313515742, -697.9667599153462, -281.11594933676054, -489.6395492659452, -1023.3210616766489, -236.9767513248628, -172.17709052002004, -551.8680256588001, -1027.1807548517465, -349.7369102677864, -2.9019969120064975, -739.3775104523405, -154.56786566675817, -225.05648370267366, -311.09460700487426, -742.4009269000978, -274.8992456618774, -16.566436070374376, -123.21470226036206, -566.504494193224, -724.7287175502785, -295.32829207144164, -632.7210957010682, -664.8335617412358, -975.6474881993115, -569.3888252993659, -1366.1261150838775, -135.80736189455317, -857.4402509721735, -509.5763786355609, -986.7082517730621, -484.3529107813062, -514.8198876463421, -1179.3214840008322, -1232.6490582908034, -32.64461162217364, -1342.8923881121002, -628.8268973510808, -421.6228119525562, -372.63159887462785, -77.93590997880989, -298.773636218834, -34.48581489453214, -275.4125177887694, -555.0943829193762, -256.6685677912332, -1057.3188300398256, -304.9845535748987, -741.9337073145045, -486.28931770913016, -43.89222047732678, -875.9707295421088, -387.7352587961844, -210.6708977148024, -581.9795251978699, -162.96735916843656, -992.2298978920176, -88.06933716581534, -50.16332035504296, -384.1814103053844, -1205.6061346294955, -49.8836958136911, -235.22085775912808, -396.19969866695544, -824.891321773279, -883.8628852707542, -880.3341305341622, -1240.851433966446, -889.7697646065567, -13.178941461017923, -736.4084795604363, -1042.8106128677323, -1173.520064339592, -653.8607727066832, -343.7290956676338, -275.8549812044247, -425.49564846728543, -248.80563921474447, -180.1061836813327, -679.6673237902382, -311.47853896205936, -93.8462462805882, -203.5609330333542, -649.4578967581577, -688.7224579690221, -528.2724155088838, -134.88180752248496, -888.6410803660333, -1008.4671772244957, -622.138096170202, -357.75524520260086, -107.7811172406907, -166.01235765316923, -405.5898187186553, -173.03559522429939, -299.4543383413403, -96.00819896348496, -384.12401190954233, -565.690396998026, -464.06275715766435, -876.6598466027262, -466.0861302275683, -425.4353484363746, -199.68859159430806, -627.9106153202453, -348.0222377294258, -1400.1144581128506, -260.78092108671615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.579659536939021, "mean_inference_ms": 1.7299077273417731, "mean_action_processing_ms": 0.8348735051542627, "mean_env_wait_ms": 10.598106184085488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014641761779785156, "StateBufferConnector_ms": 0.010499238967895508, "ViewRequirementAgentConnector_ms": 0.3612949848175049}, "num_episodes": 21, "episode_return_max": -389.4896194642285, "episode_return_min": -4550.835596766598, "episode_return_mean": -2573.741226682575, "episodes_this_iter": 21}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 926460, "num_agent_steps_trained": 926460, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.82917800310375, "num_env_steps_trained_throughput_per_sec": 81.82917800310375, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 926460, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 926460, "timers": {"training_iteration_time_ms": 45675.07, "restore_workers_time_ms": 0.027, "training_step_time_ms": 45674.999, "sample_time_ms": 3337.674, "learn_time_ms": 42281.687, "learn_throughput": 94.604, "synch_weights_time_ms": 52.728}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 926460, "num_agent_steps_trained": 926460}, "done": false, "training_iteration": 52, "trial_id": "05c72_00000", "date": "2024-07-26_15-26-20", "timestamp": 1721987780, "time_this_iter_s": 48.89175057411194, "time_total_s": 2600.0910937786102, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00dd7e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2600.0910937786102, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 12.269999999999998, "ram_util_percent": 30.642857142857128}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 173.7351423772176, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.560331769688924, "policy_loss": 0.00045659284194310505, "vf_loss": 4.57707030804952, "vf_explained_var": 0.9854793937047323, "kl": 0.015541067749479165, "entropy": 2.5062793169021607, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.536, "num_grad_updates_lifetime": 219885.5, "diff_num_grad_updates_vs_sampler_policy": 1874.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 942402, "num_agent_steps_trained": 942402}, "env_runners": {"episode_reward_max": -956.0395222364714, "episode_reward_min": -4823.207279052291, "episode_reward_mean": -2561.8749343319396, "episode_len_mean": 148.06, "episode_media": {}, "episodes_timesteps_total": 14806, "policy_reward_min": {"policy_0": -1475.3600355251483}, "policy_reward_max": {"policy_0": -2.9019969120064975}, "policy_reward_mean": {"policy_0": -512.3749868663879}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1083.9261327107592, -3607.2215777331776, -3985.1992948230923, -2937.6850209471568, -3196.0472556150175, -2342.756070490604, -2592.932259007146, -1187.6094641345965, -3289.978569616054, -2866.068325300115, -2572.787379493907, -2529.2204150440184, -1730.9888288799675, -2716.9482928183006, -1035.1458041996902, -1407.3378769803821, -2385.1123193153203, -3410.8545763143006, -2892.708405061014, -3299.176446264174, -1446.5466416904335, -3026.575376463223, -2858.677926754434, -2620.5680952265593, -2156.338260990175, -2640.4963526679226, -1575.6235432828114, -1286.3927157043884, -2303.397317547537, -3294.751440699008, -1394.454317051684, -3516.261358877723, -1613.7565264732177, -4229.123781477336, -1750.0512799337287, -2296.9505295202134, -3896.4543593382205, -1367.3202182028476, -2051.101224237675, -3350.2470675877003, -979.2654695585398, -2288.658184434674, -2178.305540576323, -4550.835596766598, -2613.9340303012164, -3026.3249797635494, -1756.1679497578332, -4125.614657160881, -994.8928102485556, -3288.997932985021, -3056.490136857624, -984.193643296643, -3711.3220794908, -2190.401133845165, -2473.9824784462758, -2273.765038150638, -1570.017699339898, -2342.4973017763723, -3711.803352218344, -3352.8976798084477, -4416.334439376995, -1205.4497719193596, -2449.478852114103, -2535.821233839255, -2035.9170171389417, -1925.0554188627425, -4226.139470211598, -3855.6878628353365, -1947.746137260771, -1468.6592257475727, -2889.9756581245833, -2262.1539934911566, -1358.211963157321, -2797.934479422356, -2836.516823843548, -2301.982052745904, -2987.2563895240255, -3284.681054375516, -3043.7752103917, -2691.5288949722244, -3476.7000513447706, -2346.998643708979, -3523.607289662117, -2476.3420462942076, -2311.243875695051, -2512.0543111845313, -3431.237837669416, -2732.155725228503, -2539.540434749466, -2827.295493529886, -956.0395222364714, -1774.064012066804, -1518.4765131382846, -2321.0036827918248, -1691.7941521508656, -2894.5728545826555, -1899.8994816505226, -1691.6086188667064, -4823.207279052291, -4704.185314976556], "episode_lengths": [128, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-19.4012239646294, -255.37851240588878, -435.7945862023012, -336.0346467339972, -37.31716340394156, -555.9309381654357, -1202.0139258311249, -526.8018162130044, -1061.9062282897469, -260.56866923386923, -458.6664672116759, -595.6432331817939, -1083.0762058543921, -1152.6769462032207, -695.1364423720088, -122.26608621239885, -393.7022721738202, -254.19256675152903, -1119.16873494101, -1048.3553608683944, -901.231537688563, -270.2774476944182, -400.6058888938824, -573.7046449881366, -1050.2277363500205, -512.6607150846411, -391.2644340162928, -988.5925300719473, -337.6380269812414, -112.60036433647743, -767.1055405341934, -57.67449933765903, -577.2965553053868, -177.7612999043961, -1013.0943639255116, -100.48247704238713, -262.565476884469, -107.69922872359552, -288.70239582219506, -428.1598856619488, -305.6710304947417, -899.4257012960603, -1286.3812826235976, -240.9925932426294, -557.5079619590257, -558.0448981835905, -969.9732197993102, -304.8809255926608, -776.6718625900617, -256.4974191344885, -110.4718418820989, -554.2410712068086, -575.9978125114495, -591.8654336647465, -740.2112202288067, -141.64613276349206, -516.196704992914, -289.35425217819784, -133.98054179898242, -1448.0427833104295, -33.430791255331755, -868.8438832891171, -105.9166564877339, -212.86680123859864, -509.93069660918593, -658.5682514674463, -790.6232590351084, -330.65888360145664, -803.144004305973, -133.95389440831636, -207.64869959070583, -46.52857916408297, -372.3055484031401, -183.17343855718016, -225.48953848458055, -116.65076412913598, -501.1314027924793, -431.7632784321367, -70.40937013855387, -287.3830614880769, -834.2984629499135, -68.28063222419274, -150.6435766289279, -635.2734714337735, -696.6161760785128, -204.407476969902, -646.7401029462254, -1294.6701198024846, -361.54462075399, -903.4922558416946, -76.81434188522104, -829.834400343235, -298.45558522452933, -912.531355861677, -775.0727217463531, -101.29266458147605, -1149.5773891028737, -892.9654704695841, -397.4356815948632, -757.9052405153725, -95.16399463721002, -822.7341486249305, -450.273522796258, -48.624094968659506, -29.75088066337618, -389.7147225823834, -623.0405556536283, -729.6563135501876, -1251.5504923491947, -32.6132923278282, -1146.8749865495452, -891.9812427135718, -178.00689349940484, -564.8856040214811, -76.92919997043315, -741.998870027108, -72.23238039034264, -306.9981334698599, -764.5832484735378, -734.7554628657138, -320.21743840122394, -8.845397863600528, -418.4617740467165, -530.1049173067601, -878.7087333718725, -75.11637977404206, -103.35411126986733, -958.1475667763098, -1197.2018796409297, -306.67641520677313, -95.18473720697169, -38.42930492285545, -88.89378133360614, -835.4119911639295, -517.7037286554483, -362.37644705705094, -334.373338227911, -88.13379915613991, -331.5472649654462, -169.96186629783992, -59.2540622493566, -1304.8781803787547, -301.7721037198391, -294.2008196866836, -343.29215151290117, -696.9814796478069, -339.58490980637606, -1026.5581715901037, -987.3968351244067, -244.23004453031297, -26.478609865178086, -61.34203066650145, -532.5947006573564, -425.1616106517976, -348.87736521085156, -1071.990296966973, -889.1503382615753, -216.03035297888715, -408.70786545152924, -930.3825052187615, -725.431765967894, -81.38670423991786, -123.98820068003353, -92.25601621129886, -590.6938393740734, -813.9753549231441, -577.3970721435223, -912.1912764482934, -1277.988486632384, -647.5715913299914, -168.50915749596854, -356.4375258881975, -170.87803454062782, -9.457191572233267, -1044.7693704367018, -1375.499293669395, -254.50392955937997, -225.6703399454048, -176.5245641779789, -264.75240216805634, -316.34112474893783, -1216.5210080240174, -986.1329199139742, -793.3386041454337, -584.1207025058557, -232.6906883689302, -663.2556892790733, -360.3823429294219, -44.643892033374435, -66.34760559204803, -609.4162170057716, -48.37387373631021, -142.94658762220448, -567.2904611685141, -683.0740847048729, -951.833046253561, -728.904736985031, -895.9104591949342, -657.9650541643086, -115.63377098986409, -563.4370297479923, -8.439310517936978, -13.800913728753489, -38.748386009145406, -354.83982955471157, -872.7336058124147, -45.10041594306299, -179.1449111866677, -932.8508957208694, -258.82835577165895, -48.44907394024329, -625.6145492949618, -286.1465454882317, -1045.7490105742527, -172.3463612786343, -1022.9816388948817, -1363.7799244248704, -726.9461690480485, -1068.6542237675135, -368.4736406312863, -68.12093879621791, -615.8960080185734, -550.3209047467776, -845.7114336110961, -533.8847451285498, -1053.03929707456, -999.0146243987245, -225.84024407843336, -55.16011849711311, -693.2706957147186, -69.9629221290675, -453.406834246485, -479.2132054188092, -620.9657358693248, -132.61925209414574, -926.9822185052998, -59.12222435727569, -1188.3496076564645, -690.6145411472107, -1260.5460654946298, -67.32010244172778, -239.3301860286726, -354.08973146048857, -143.0505228473275, -191.1022674703388, -1328.0055722499242, -644.9595256148301, -1029.6613882058668, -133.01709614916163, -153.3543507652389, -768.1801025981, -600.750699569222, -591.4952260027327, -637.9064310511699, -458.15767763640144, -73.29054024778648, -339.8793204242152, -185.168474821506, -316.5661715102944, -69.28913629284159, -898.9435306760471, -1142.47916057374, -1126.7115098745653, -422.11768546615826, -121.0701929002898, -446.91954367445453, -117.68744956702982, -646.7114313515742, -697.9667599153462, -281.11594933676054, -489.6395492659452, -1023.3210616766489, -236.9767513248628, -172.17709052002004, -551.8680256588001, -1027.1807548517465, -349.7369102677864, -2.9019969120064975, -739.3775104523405, -154.56786566675817, -225.05648370267366, -311.09460700487426, -742.4009269000978, -274.8992456618774, -16.566436070374376, -123.21470226036206, -566.504494193224, -724.7287175502785, -295.32829207144164, -632.7210957010682, -664.8335617412358, -975.6474881993115, -569.3888252993659, -1366.1261150838775, -135.80736189455317, -857.4402509721735, -509.5763786355609, -986.7082517730621, -484.3529107813062, -514.8198876463421, -1179.3214840008322, -1232.6490582908034, -32.64461162217364, -1342.8923881121002, -628.8268973510808, -421.6228119525562, -372.63159887462785, -77.93590997880989, -298.773636218834, -34.48581489453214, -275.4125177887694, -555.0943829193762, -256.6685677912332, -1057.3188300398256, -304.9845535748987, -741.9337073145045, -486.28931770913016, -43.89222047732678, -875.9707295421088, -387.7352587961844, -210.6708977148024, -581.9795251978699, -162.96735916843656, -992.2298978920176, -88.06933716581534, -50.16332035504296, -384.1814103053844, -1205.6061346294955, -49.8836958136911, -235.22085775912808, -396.19969866695544, -824.891321773279, -883.8628852707542, -880.3341305341622, -1240.851433966446, -889.7697646065567, -13.178941461017923, -736.4084795604363, -1042.8106128677323, -1173.520064339592, -653.8607727066832, -343.7290956676338, -275.8549812044247, -425.49564846728543, -248.80563921474447, -180.1061836813327, -679.6673237902382, -311.47853896205936, -93.8462462805882, -203.5609330333542, -649.4578967581577, -688.7224579690221, -528.2724155088838, -134.88180752248496, -888.6410803660333, -1008.4671772244957, -622.138096170202, -357.75524520260086, -107.7811172406907, -166.01235765316923, -405.5898187186553, -173.03559522429939, -299.4543383413403, -96.00819896348496, -384.12401190954233, -565.690396998026, -464.06275715766435, -876.6598466027262, -466.0861302275683, -425.4353484363746, -199.68859159430806, -627.9106153202453, -348.0222377294258, -1400.1144581128506, -260.78092108671615, -966.0271979066817, -234.987842213828, -188.50822926477258, -749.8230289149727, -162.63575444565137, -1392.8535898276236, -186.97400531183473, -461.7678948190669, -227.86734446917777, -717.7935550963217, -1301.0966431500883, -404.2533431363777, -424.77011067579974, -929.0745177188306, -225.4864396944194, -741.0290035101956, -1143.291942812223, -21.176821451148637, -216.1963523845873, -922.0810902335492, -182.94533568275804, -1168.7267364365994, -464.00211254485123, -185.64381957488942, -690.2108907331283, -727.8330431453093, -938.4758583138321, -643.7687178801438, -901.0471471577116, -265.5752848477706, -513.1363759853523, -924.0209782095452, -665.571843511609, -50.68030819520384, -193.58913780727, -137.12441220461437, -1047.088667958075, -724.2361558480062, -680.0801103881098, -935.0779432633103, -436.7670190921381, -396.2707884903182, -1187.8921829123797, -134.0516631395018, -321.3603926598694, -126.96837765215174, -141.45096172005557, -1412.7324323534078, -308.1226474662364, -321.9694565031984, -46.73480644242094, -827.0531365250689, -692.5812487547856, -223.44487247796317, -722.2402469842924, -566.110492305258, -305.35630986206866, -1338.962829960705, -350.622563137974, -870.1856424034106, -288.8095537170325, -1174.9698935688866, -308.40298574352704, -828.7063563556792, -131.26693584337826, -112.99873435794667, -341.16407675504587, -93.20699485423162, -831.8826532739454, -1160.287975508298, -887.1461470995786, -1269.9214558628705, -564.1395246250421, -64.28295438403529, -41.805411558360184, -324.57332612684615, -54.621702519674706, -388.2241478390489, -155.17685294065612, -33.443492810245196, -876.71757158253, -313.63290604860697, -28.440720198021914, -11.501480589299252, -543.7713336483458, -599.7976881702953, -64.25009430578295, -113.85985004856634, -490.888709486086, -249.68017112755453, -514.1039680862759, -356.92528775273473, -374.022785691284, -586.4136457815953, -489.5379954799367, -804.2419368661263, -15.1615113577413, -565.2589631491439, -64.16961350931969, -242.96212726853452, -1130.6300834565116, -317.7245769843807, -764.8100990220853, -551.9518835797693, -129.45621153990828, -181.46524113348735, -17.037767946859525, -781.4708202463573, -29.164548045032838, -890.7611042787854, -892.7888541444978, -45.43607101650301, -113.50900714272943, -569.161679812009, -70.71300675096788, -1424.319959742902, -1417.1101119109749, -565.104169280978, -378.8602486879016, -1037.8127894295396, -697.7411508760689, -1475.3600355251483, -974.487281579532, -1302.604922171141, -253.99192482466424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5786240777903355, "mean_inference_ms": 1.7307926412817582, "mean_action_processing_ms": 0.8338521614989287, "mean_env_wait_ms": 10.591628780021606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014346837997436523, "StateBufferConnector_ms": 0.010277032852172852, "ViewRequirementAgentConnector_ms": 0.3519399166107178}, "num_episodes": 25, "episode_return_max": -956.0395222364714, "episode_return_min": -4823.207279052291, "episode_return_mean": -2561.8749343319396, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 942402, "num_agent_steps_trained": 942402, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 101.16775525275314, "num_env_steps_trained_throughput_per_sec": 101.16775525275314, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 942402, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 942402, "timers": {"training_iteration_time_ms": 45626.16, "restore_workers_time_ms": 0.027, "training_step_time_ms": 45626.087, "sample_time_ms": 3313.243, "learn_time_ms": 42256.663, "learn_throughput": 94.66, "synch_weights_time_ms": 53.245}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 942402, "num_agent_steps_trained": 942402}, "done": false, "training_iteration": 53, "trial_id": "05c72_00000", "date": "2024-07-26_15-27-00", "timestamp": 1721987820, "time_this_iter_s": 39.54966592788696, "time_total_s": 2639.640759706497, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e52d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2639.640759706497, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 13.294642857142858, "ram_util_percent": 30.778571428571436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 184.65111992115877, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 0.001, "total_loss": 4.699062469594873, "policy_loss": -0.004349992162169985, "vf_loss": 4.7196709342013685, "vf_explained_var": 0.987609261125664, "kl": 0.01578759156558726, "entropy": 2.425093806925274, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.89115646258503, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 2204.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 961202, "num_agent_steps_trained": 961202}, "env_runners": {"episode_reward_max": -956.0395222364714, "episode_reward_min": -4990.684892637792, "episode_reward_mean": -2634.8507151417343, "episode_len_mean": 148.39, "episode_media": {}, "episodes_timesteps_total": 14839, "policy_reward_min": {"policy_0": -1561.972438973898}, "policy_reward_max": {"policy_0": -2.9019969120064975}, "policy_reward_mean": {"policy_0": -526.9701430283468}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1750.0512799337287, -2296.9505295202134, -3896.4543593382205, -1367.3202182028476, -2051.101224237675, -3350.2470675877003, -979.2654695585398, -2288.658184434674, -2178.305540576323, -4550.835596766598, -2613.9340303012164, -3026.3249797635494, -1756.1679497578332, -4125.614657160881, -994.8928102485556, -3288.997932985021, -3056.490136857624, -984.193643296643, -3711.3220794908, -2190.401133845165, -2473.9824784462758, -2273.765038150638, -1570.017699339898, -2342.4973017763723, -3711.803352218344, -3352.8976798084477, -4416.334439376995, -1205.4497719193596, -2449.478852114103, -2535.821233839255, -2035.9170171389417, -1925.0554188627425, -4226.139470211598, -3855.6878628353365, -1947.746137260771, -1468.6592257475727, -2889.9756581245833, -2262.1539934911566, -1358.211963157321, -2797.934479422356, -2836.516823843548, -2301.982052745904, -2987.2563895240255, -3284.681054375516, -3043.7752103917, -2691.5288949722244, -3476.7000513447706, -2346.998643708979, -3523.607289662117, -2476.3420462942076, -2311.243875695051, -2512.0543111845313, -3431.237837669416, -2732.155725228503, -2539.540434749466, -2827.295493529886, -956.0395222364714, -1774.064012066804, -1518.4765131382846, -2321.0036827918248, -1691.7941521508656, -2894.5728545826555, -1899.8994816505226, -1691.6086188667064, -4823.207279052291, -4704.185314976556, -2928.274616696297, -2616.9225842045307, -1036.5684540880072, -3654.772469964938, -2212.781486382476, -2799.862342087235, -1578.3160002510397, -3339.602087869399, -3209.3440463760007, -2557.685868859671, -2914.400983571836, -2880.046305970692, -3712.3594650282485, -3421.7812523007733, -1533.8185080206656, -4301.407623638231, -2639.8784890057423, -2977.6326227711993, -4990.684892637792, -3181.4043570625413, -997.2885642921844, -4219.126582032148, -1540.7133940025078, -3584.979308182639, -4070.2903865776407, -1499.7710620028079, -1736.702198319788, -1972.0475071872074, -2647.366158994212, -2144.9712378845757, -1963.6742483714745, -2754.495076598054, -2312.7451355467856, -2398.5307338553744], "episode_lengths": [150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 134, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-168.50915749596854, -356.4375258881975, -170.87803454062782, -9.457191572233267, -1044.7693704367018, -1375.499293669395, -254.50392955937997, -225.6703399454048, -176.5245641779789, -264.75240216805634, -316.34112474893783, -1216.5210080240174, -986.1329199139742, -793.3386041454337, -584.1207025058557, -232.6906883689302, -663.2556892790733, -360.3823429294219, -44.643892033374435, -66.34760559204803, -609.4162170057716, -48.37387373631021, -142.94658762220448, -567.2904611685141, -683.0740847048729, -951.833046253561, -728.904736985031, -895.9104591949342, -657.9650541643086, -115.63377098986409, -563.4370297479923, -8.439310517936978, -13.800913728753489, -38.748386009145406, -354.83982955471157, -872.7336058124147, -45.10041594306299, -179.1449111866677, -932.8508957208694, -258.82835577165895, -48.44907394024329, -625.6145492949618, -286.1465454882317, -1045.7490105742527, -172.3463612786343, -1022.9816388948817, -1363.7799244248704, -726.9461690480485, -1068.6542237675135, -368.4736406312863, -68.12093879621791, -615.8960080185734, -550.3209047467776, -845.7114336110961, -533.8847451285498, -1053.03929707456, -999.0146243987245, -225.84024407843336, -55.16011849711311, -693.2706957147186, -69.9629221290675, -453.406834246485, -479.2132054188092, -620.9657358693248, -132.61925209414574, -926.9822185052998, -59.12222435727569, -1188.3496076564645, -690.6145411472107, -1260.5460654946298, -67.32010244172778, -239.3301860286726, -354.08973146048857, -143.0505228473275, -191.1022674703388, -1328.0055722499242, -644.9595256148301, -1029.6613882058668, -133.01709614916163, -153.3543507652389, -768.1801025981, -600.750699569222, -591.4952260027327, -637.9064310511699, -458.15767763640144, -73.29054024778648, -339.8793204242152, -185.168474821506, -316.5661715102944, -69.28913629284159, -898.9435306760471, -1142.47916057374, -1126.7115098745653, -422.11768546615826, -121.0701929002898, -446.91954367445453, -117.68744956702982, -646.7114313515742, -697.9667599153462, -281.11594933676054, -489.6395492659452, -1023.3210616766489, -236.9767513248628, -172.17709052002004, -551.8680256588001, -1027.1807548517465, -349.7369102677864, -2.9019969120064975, -739.3775104523405, -154.56786566675817, -225.05648370267366, -311.09460700487426, -742.4009269000978, -274.8992456618774, -16.566436070374376, -123.21470226036206, -566.504494193224, -724.7287175502785, -295.32829207144164, -632.7210957010682, -664.8335617412358, -975.6474881993115, -569.3888252993659, -1366.1261150838775, -135.80736189455317, -857.4402509721735, -509.5763786355609, -986.7082517730621, -484.3529107813062, -514.8198876463421, -1179.3214840008322, -1232.6490582908034, -32.64461162217364, -1342.8923881121002, -628.8268973510808, -421.6228119525562, -372.63159887462785, -77.93590997880989, -298.773636218834, -34.48581489453214, -275.4125177887694, -555.0943829193762, -256.6685677912332, -1057.3188300398256, -304.9845535748987, -741.9337073145045, -486.28931770913016, -43.89222047732678, -875.9707295421088, -387.7352587961844, -210.6708977148024, -581.9795251978699, -162.96735916843656, -992.2298978920176, -88.06933716581534, -50.16332035504296, -384.1814103053844, -1205.6061346294955, -49.8836958136911, -235.22085775912808, -396.19969866695544, -824.891321773279, -883.8628852707542, -880.3341305341622, -1240.851433966446, -889.7697646065567, -13.178941461017923, -736.4084795604363, -1042.8106128677323, -1173.520064339592, -653.8607727066832, -343.7290956676338, -275.8549812044247, -425.49564846728543, -248.80563921474447, -180.1061836813327, -679.6673237902382, -311.47853896205936, -93.8462462805882, -203.5609330333542, -649.4578967581577, -688.7224579690221, -528.2724155088838, -134.88180752248496, -888.6410803660333, -1008.4671772244957, -622.138096170202, -357.75524520260086, -107.7811172406907, -166.01235765316923, -405.5898187186553, -173.03559522429939, -299.4543383413403, -96.00819896348496, -384.12401190954233, -565.690396998026, -464.06275715766435, -876.6598466027262, -466.0861302275683, -425.4353484363746, -199.68859159430806, -627.9106153202453, -348.0222377294258, -1400.1144581128506, -260.78092108671615, -966.0271979066817, -234.987842213828, -188.50822926477258, -749.8230289149727, -162.63575444565137, -1392.8535898276236, -186.97400531183473, -461.7678948190669, -227.86734446917777, -717.7935550963217, -1301.0966431500883, -404.2533431363777, -424.77011067579974, -929.0745177188306, -225.4864396944194, -741.0290035101956, -1143.291942812223, -21.176821451148637, -216.1963523845873, -922.0810902335492, -182.94533568275804, -1168.7267364365994, -464.00211254485123, -185.64381957488942, -690.2108907331283, -727.8330431453093, -938.4758583138321, -643.7687178801438, -901.0471471577116, -265.5752848477706, -513.1363759853523, -924.0209782095452, -665.571843511609, -50.68030819520384, -193.58913780727, -137.12441220461437, -1047.088667958075, -724.2361558480062, -680.0801103881098, -935.0779432633103, -436.7670190921381, -396.2707884903182, -1187.8921829123797, -134.0516631395018, -321.3603926598694, -126.96837765215174, -141.45096172005557, -1412.7324323534078, -308.1226474662364, -321.9694565031984, -46.73480644242094, -827.0531365250689, -692.5812487547856, -223.44487247796317, -722.2402469842924, -566.110492305258, -305.35630986206866, -1338.962829960705, -350.622563137974, -870.1856424034106, -288.8095537170325, -1174.9698935688866, -308.40298574352704, -828.7063563556792, -131.26693584337826, -112.99873435794667, -341.16407675504587, -93.20699485423162, -831.8826532739454, -1160.287975508298, -887.1461470995786, -1269.9214558628705, -564.1395246250421, -64.28295438403529, -41.805411558360184, -324.57332612684615, -54.621702519674706, -388.2241478390489, -155.17685294065612, -33.443492810245196, -876.71757158253, -313.63290604860697, -28.440720198021914, -11.501480589299252, -543.7713336483458, -599.7976881702953, -64.25009430578295, -113.85985004856634, -490.888709486086, -249.68017112755453, -514.1039680862759, -356.92528775273473, -374.022785691284, -586.4136457815953, -489.5379954799367, -804.2419368661263, -15.1615113577413, -565.2589631491439, -64.16961350931969, -242.96212726853452, -1130.6300834565116, -317.7245769843807, -764.8100990220853, -551.9518835797693, -129.45621153990828, -181.46524113348735, -17.037767946859525, -781.4708202463573, -29.164548045032838, -890.7611042787854, -892.7888541444978, -45.43607101650301, -113.50900714272943, -569.161679812009, -70.71300675096788, -1424.319959742902, -1417.1101119109749, -565.104169280978, -378.8602486879016, -1037.8127894295396, -697.7411508760689, -1475.3600355251483, -974.487281579532, -1302.604922171141, -253.99192482466424, -346.89864652543116, -103.68197934582498, -1488.3761643393977, -469.81230932097, -519.5055171646715, -238.7762789036471, -117.2287436888613, -863.2634224529537, -347.3520221977354, -1050.3021169613341, -41.90051355860368, -260.98932362905856, -175.7969953632882, -93.88004744511518, -464.00157409194145, -304.77347025849326, -883.4847192709298, -766.0758342611557, -1561.972438973898, -138.4660072004576, -1071.4990791225277, -33.69544400699524, -363.05654535007466, -55.07264283810204, -689.4577750647748, -672.65522885693, -968.445254559945, -197.56127744514902, -614.4440972781741, -346.75648394703546, -142.48683281174965, -665.462982987019, -295.45142568714596, -196.94361616388494, -277.9711426012393, -714.7697018325074, -899.6185503825509, -108.36248951096388, -661.8907420010526, -954.9606041423264, -998.245218207177, -793.2850489765765, -753.7617971480074, -36.06581822030152, -627.9861638239364, -486.3217455313088, -308.3404741621275, -90.45421768688624, -463.2981150403735, -1209.2713164389775, -636.3144882701177, -1246.2385945981516, -333.82405400412176, -188.38398071963394, -509.6398659798105, -1077.5076527444353, -80.26516022292357, -235.45166439516512, -113.48854122889522, -1373.3332873792733, -722.8140046541763, -382.3873737021572, -546.7846270755355, -741.6912202815574, -1318.6822393148223, -212.8171083577481, -297.37460404169906, -453.69312956407833, -1340.066498106129, -1117.829912231119, -240.80136169686295, -94.67100116158825, -478.6103905905506, -574.3311555481146, -145.4045990235486, -1348.6239845199732, -834.7964992921607, -442.5090416929947, -1296.2251206406474, -379.25297749245414, -35.65593337084833, -629.2483448259184, -386.88593638237336, -1178.9352792844934, -409.1529951421082, -11.458732932794124, -253.2089124717345, -18.69324158495316, -1468.6172198293232, -1225.6545159523946, -606.4930797102533, -1087.4279369999967, -1299.3253094028096, -1223.9169477347034, -773.5216187900277, -54.34886307328062, -264.0547986890556, -672.631878089386, -979.0829947010839, -1211.2858225097343, -45.51957282500428, -215.45478776362575, -226.15507044577808, -371.9789417874045, -138.18019147037253, -1023.069465921316, -1222.3506836573135, -772.3146790517839, -758.5546477666272, -442.8371056351043, -221.77200139122434, -61.63253417989809, -534.0131678083301, -661.7444892704007, -61.55120135265371, -968.5208344554649, -672.3901758371587, -1037.7068224051434, -20.817759671706305, -885.5437158131668, -721.7837140289016, -492.9261218024475, -1212.799488233745, -820.9291029578646, -821.85195955468, -32.40803014002363, -700.3701178135834, -51.4537925157634, -22.44877347607732, -693.0903480573594, -41.14517758370998, -102.08557978515931, -321.28481083059523, -1125.6600421353812, -146.5265879849429, -153.17869414353527, -795.029442014711, -680.8139468451973, -72.78442555218983, -270.24099863157323, -569.445268248252, -195.15072311398313, -221.48524034517746, -728.7800029109156, -932.5049243758828, -227.8742936986377, -701.6301177118702, -314.2303924893869, -700.7648654603723, -200.47156852430638, -279.91874693261764, -963.4357236045698, -232.44978818968306, -75.36286652370471, -412.50712312089945, -541.0059231467383, -373.3202570873354, -284.56131473303697, -343.10954027200626, -1212.4980413589385, -738.1057498805768, -114.9885596745578, -1299.070629529379, -92.05025647262154, -68.52993998964911, -673.4190447957135, -59.723532928517514, -608.367021797345, -457.24800755170435, -599.7731267820918]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5763379536944575, "mean_inference_ms": 1.7309199513958098, "mean_action_processing_ms": 0.8333270098403592, "mean_env_wait_ms": 10.58652197286694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014241218566894531, "StateBufferConnector_ms": 0.010340213775634766, "ViewRequirementAgentConnector_ms": 0.35419702529907227}, "num_episodes": 34, "episode_return_max": -956.0395222364714, "episode_return_min": -4990.684892637792, "episode_return_mean": -2634.8507151417343, "episodes_this_iter": 34}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 961202, "num_agent_steps_trained": 961202, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.38007029788767, "num_env_steps_trained_throughput_per_sec": 72.38007029788767, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 961202, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 961202, "timers": {"training_iteration_time_ms": 46393.738, "restore_workers_time_ms": 0.026, "training_step_time_ms": 46393.667, "sample_time_ms": 3347.195, "learn_time_ms": 42991.897, "learn_throughput": 93.041, "synch_weights_time_ms": 51.662}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 961202, "num_agent_steps_trained": 961202}, "done": false, "training_iteration": 54, "trial_id": "05c72_00000", "date": "2024-07-26_15-27-55", "timestamp": 1721987875, "time_this_iter_s": 55.27515959739685, "time_total_s": 2694.915919303894, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00dd480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2694.915919303894, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 11.43076923076923, "ram_util_percent": 30.610256410256405}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 150.8684707364343, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 5.073547094388116, "policy_loss": -0.0037260513817507805, "vf_loss": 5.093007424421478, "vf_explained_var": 0.9816513657868655, "kl": 0.015886695563487117, "entropy": 2.3776916190496364, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.45112781954887, "num_grad_updates_lifetime": 228165.5, "diff_num_grad_updates_vs_sampler_policy": 1994.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 978153, "num_agent_steps_trained": 978153}, "env_runners": {"episode_reward_max": -956.0395222364714, "episode_reward_min": -4990.684892637792, "episode_reward_mean": -2687.8967952693624, "episode_len_mean": 149.06, "episode_media": {}, "episodes_timesteps_total": 14906, "policy_reward_min": {"policy_0": -1561.972438973898}, "policy_reward_max": {"policy_0": -2.6424890666931065}, "policy_reward_mean": {"policy_0": -537.5793590538725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2273.765038150638, -1570.017699339898, -2342.4973017763723, -3711.803352218344, -3352.8976798084477, -4416.334439376995, -1205.4497719193596, -2449.478852114103, -2535.821233839255, -2035.9170171389417, -1925.0554188627425, -4226.139470211598, -3855.6878628353365, -1947.746137260771, -1468.6592257475727, -2889.9756581245833, -2262.1539934911566, -1358.211963157321, -2797.934479422356, -2836.516823843548, -2301.982052745904, -2987.2563895240255, -3284.681054375516, -3043.7752103917, -2691.5288949722244, -3476.7000513447706, -2346.998643708979, -3523.607289662117, -2476.3420462942076, -2311.243875695051, -2512.0543111845313, -3431.237837669416, -2732.155725228503, -2539.540434749466, -2827.295493529886, -956.0395222364714, -1774.064012066804, -1518.4765131382846, -2321.0036827918248, -1691.7941521508656, -2894.5728545826555, -1899.8994816505226, -1691.6086188667064, -4823.207279052291, -4704.185314976556, -2928.274616696297, -2616.9225842045307, -1036.5684540880072, -3654.772469964938, -2212.781486382476, -2799.862342087235, -1578.3160002510397, -3339.602087869399, -3209.3440463760007, -2557.685868859671, -2914.400983571836, -2880.046305970692, -3712.3594650282485, -3421.7812523007733, -1533.8185080206656, -4301.407623638231, -2639.8784890057423, -2977.6326227711993, -4990.684892637792, -3181.4043570625413, -997.2885642921844, -4219.126582032148, -1540.7133940025078, -3584.979308182639, -4070.2903865776407, -1499.7710620028079, -1736.702198319788, -1972.0475071872074, -2647.366158994212, -2144.9712378845757, -1963.6742483714745, -2754.495076598054, -2312.7451355467856, -2398.5307338553744, -3614.8548592425523, -4295.466417372461, -2637.4982267285172, -2278.9786741757516, -2504.960971033079, -2612.186870039417, -3027.452544874834, -3037.410731704339, -3673.3364994167446, -1689.685541862616, -3340.9981894918405, -2835.848577467483, -1786.127167671841, -2912.945798793458, -4028.2594022516073, -2353.5127868946397, -2140.092544176846, -2843.4151544358633, -2593.4236897267515, -2012.2767990015968, -2017.3878687106778], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1027.1807548517465, -349.7369102677864, -2.9019969120064975, -739.3775104523405, -154.56786566675817, -225.05648370267366, -311.09460700487426, -742.4009269000978, -274.8992456618774, -16.566436070374376, -123.21470226036206, -566.504494193224, -724.7287175502785, -295.32829207144164, -632.7210957010682, -664.8335617412358, -975.6474881993115, -569.3888252993659, -1366.1261150838775, -135.80736189455317, -857.4402509721735, -509.5763786355609, -986.7082517730621, -484.3529107813062, -514.8198876463421, -1179.3214840008322, -1232.6490582908034, -32.64461162217364, -1342.8923881121002, -628.8268973510808, -421.6228119525562, -372.63159887462785, -77.93590997880989, -298.773636218834, -34.48581489453214, -275.4125177887694, -555.0943829193762, -256.6685677912332, -1057.3188300398256, -304.9845535748987, -741.9337073145045, -486.28931770913016, -43.89222047732678, -875.9707295421088, -387.7352587961844, -210.6708977148024, -581.9795251978699, -162.96735916843656, -992.2298978920176, -88.06933716581534, -50.16332035504296, -384.1814103053844, -1205.6061346294955, -49.8836958136911, -235.22085775912808, -396.19969866695544, -824.891321773279, -883.8628852707542, -880.3341305341622, -1240.851433966446, -889.7697646065567, -13.178941461017923, -736.4084795604363, -1042.8106128677323, -1173.520064339592, -653.8607727066832, -343.7290956676338, -275.8549812044247, -425.49564846728543, -248.80563921474447, -180.1061836813327, -679.6673237902382, -311.47853896205936, -93.8462462805882, -203.5609330333542, -649.4578967581577, -688.7224579690221, -528.2724155088838, -134.88180752248496, -888.6410803660333, -1008.4671772244957, -622.138096170202, -357.75524520260086, -107.7811172406907, -166.01235765316923, -405.5898187186553, -173.03559522429939, -299.4543383413403, -96.00819896348496, -384.12401190954233, -565.690396998026, -464.06275715766435, -876.6598466027262, -466.0861302275683, -425.4353484363746, -199.68859159430806, -627.9106153202453, -348.0222377294258, -1400.1144581128506, -260.78092108671615, -966.0271979066817, -234.987842213828, -188.50822926477258, -749.8230289149727, -162.63575444565137, -1392.8535898276236, -186.97400531183473, -461.7678948190669, -227.86734446917777, -717.7935550963217, -1301.0966431500883, -404.2533431363777, -424.77011067579974, -929.0745177188306, -225.4864396944194, -741.0290035101956, -1143.291942812223, -21.176821451148637, -216.1963523845873, -922.0810902335492, -182.94533568275804, -1168.7267364365994, -464.00211254485123, -185.64381957488942, -690.2108907331283, -727.8330431453093, -938.4758583138321, -643.7687178801438, -901.0471471577116, -265.5752848477706, -513.1363759853523, -924.0209782095452, -665.571843511609, -50.68030819520384, -193.58913780727, -137.12441220461437, -1047.088667958075, -724.2361558480062, -680.0801103881098, -935.0779432633103, -436.7670190921381, -396.2707884903182, -1187.8921829123797, -134.0516631395018, -321.3603926598694, -126.96837765215174, -141.45096172005557, -1412.7324323534078, -308.1226474662364, -321.9694565031984, -46.73480644242094, -827.0531365250689, -692.5812487547856, -223.44487247796317, -722.2402469842924, -566.110492305258, -305.35630986206866, -1338.962829960705, -350.622563137974, -870.1856424034106, -288.8095537170325, -1174.9698935688866, -308.40298574352704, -828.7063563556792, -131.26693584337826, -112.99873435794667, -341.16407675504587, -93.20699485423162, -831.8826532739454, -1160.287975508298, -887.1461470995786, -1269.9214558628705, -564.1395246250421, -64.28295438403529, -41.805411558360184, -324.57332612684615, -54.621702519674706, -388.2241478390489, -155.17685294065612, -33.443492810245196, -876.71757158253, -313.63290604860697, -28.440720198021914, -11.501480589299252, -543.7713336483458, -599.7976881702953, -64.25009430578295, -113.85985004856634, -490.888709486086, -249.68017112755453, -514.1039680862759, -356.92528775273473, -374.022785691284, -586.4136457815953, -489.5379954799367, -804.2419368661263, -15.1615113577413, -565.2589631491439, -64.16961350931969, -242.96212726853452, -1130.6300834565116, -317.7245769843807, -764.8100990220853, -551.9518835797693, -129.45621153990828, -181.46524113348735, -17.037767946859525, -781.4708202463573, -29.164548045032838, -890.7611042787854, -892.7888541444978, -45.43607101650301, -113.50900714272943, -569.161679812009, -70.71300675096788, -1424.319959742902, -1417.1101119109749, -565.104169280978, -378.8602486879016, -1037.8127894295396, -697.7411508760689, -1475.3600355251483, -974.487281579532, -1302.604922171141, -253.99192482466424, -346.89864652543116, -103.68197934582498, -1488.3761643393977, -469.81230932097, -519.5055171646715, -238.7762789036471, -117.2287436888613, -863.2634224529537, -347.3520221977354, -1050.3021169613341, -41.90051355860368, -260.98932362905856, -175.7969953632882, -93.88004744511518, -464.00157409194145, -304.77347025849326, -883.4847192709298, -766.0758342611557, -1561.972438973898, -138.4660072004576, -1071.4990791225277, -33.69544400699524, -363.05654535007466, -55.07264283810204, -689.4577750647748, -672.65522885693, -968.445254559945, -197.56127744514902, -614.4440972781741, -346.75648394703546, -142.48683281174965, -665.462982987019, -295.45142568714596, -196.94361616388494, -277.9711426012393, -714.7697018325074, -899.6185503825509, -108.36248951096388, -661.8907420010526, -954.9606041423264, -998.245218207177, -793.2850489765765, -753.7617971480074, -36.06581822030152, -627.9861638239364, -486.3217455313088, -308.3404741621275, -90.45421768688624, -463.2981150403735, -1209.2713164389775, -636.3144882701177, -1246.2385945981516, -333.82405400412176, -188.38398071963394, -509.6398659798105, -1077.5076527444353, -80.26516022292357, -235.45166439516512, -113.48854122889522, -1373.3332873792733, -722.8140046541763, -382.3873737021572, -546.7846270755355, -741.6912202815574, -1318.6822393148223, -212.8171083577481, -297.37460404169906, -453.69312956407833, -1340.066498106129, -1117.829912231119, -240.80136169686295, -94.67100116158825, -478.6103905905506, -574.3311555481146, -145.4045990235486, -1348.6239845199732, -834.7964992921607, -442.5090416929947, -1296.2251206406474, -379.25297749245414, -35.65593337084833, -629.2483448259184, -386.88593638237336, -1178.9352792844934, -409.1529951421082, -11.458732932794124, -253.2089124717345, -18.69324158495316, -1468.6172198293232, -1225.6545159523946, -606.4930797102533, -1087.4279369999967, -1299.3253094028096, -1223.9169477347034, -773.5216187900277, -54.34886307328062, -264.0547986890556, -672.631878089386, -979.0829947010839, -1211.2858225097343, -45.51957282500428, -215.45478776362575, -226.15507044577808, -371.9789417874045, -138.18019147037253, -1023.069465921316, -1222.3506836573135, -772.3146790517839, -758.5546477666272, -442.8371056351043, -221.77200139122434, -61.63253417989809, -534.0131678083301, -661.7444892704007, -61.55120135265371, -968.5208344554649, -672.3901758371587, -1037.7068224051434, -20.817759671706305, -885.5437158131668, -721.7837140289016, -492.9261218024475, -1212.799488233745, -820.9291029578646, -821.85195955468, -32.40803014002363, -700.3701178135834, -51.4537925157634, -22.44877347607732, -693.0903480573594, -41.14517758370998, -102.08557978515931, -321.28481083059523, -1125.6600421353812, -146.5265879849429, -153.17869414353527, -795.029442014711, -680.8139468451973, -72.78442555218983, -270.24099863157323, -569.445268248252, -195.15072311398313, -221.48524034517746, -728.7800029109156, -932.5049243758828, -227.8742936986377, -701.6301177118702, -314.2303924893869, -700.7648654603723, -200.47156852430638, -279.91874693261764, -963.4357236045698, -232.44978818968306, -75.36286652370471, -412.50712312089945, -541.0059231467383, -373.3202570873354, -284.56131473303697, -343.10954027200626, -1212.4980413589385, -738.1057498805768, -114.9885596745578, -1299.070629529379, -92.05025647262154, -68.52993998964911, -673.4190447957135, -59.723532928517514, -608.367021797345, -457.24800755170435, -599.7731267820918, -744.3182944538727, -264.39345770165033, -724.2367769192798, -818.3388252641382, -1063.5675049036133, -1446.8660211370873, -538.7589942612577, -635.3950881748457, -346.0429630523331, -1328.4033507469383, -508.58959241008466, -76.54955790036792, -471.4679327391678, -999.1235200906034, -581.7676235882936, -910.3619606088029, -506.97957220046266, -221.87934781028665, -559.1357315998032, -80.62206195639736, -275.6867652223206, -237.32325479592112, -985.9660772196677, -471.6762242983657, -534.3086494968053, -313.4432404953039, -290.04292599631293, -1395.178956114225, -476.33902596755644, -137.18272146602064, -595.5706003005998, -483.8693232569615, -1075.1156779101002, -436.75847159272377, -436.1384718144446, -857.2334353512397, -1008.5365214365995, -19.52900116849909, -649.5236594796432, -502.5881142683553, -115.32777264594942, -863.6718984929278, -993.5904398463368, -819.923406927009, -880.8229815045214, -329.76932757206663, -282.7804211791808, -338.23812509463, -433.43233115552937, -305.4653368612098, -662.4528569483024, -107.87953261149757, -976.5327668227607, -539.8361383011942, -1054.296894808085, -65.43978912261846, -247.34673153589247, -862.6775392160063, -1014.3074659996529, -646.0770515933118, -136.6128920897921, -146.8273576398746, -472.61534241898, -258.43221797480857, -771.6393575483871, -553.6846421819781, -472.98799370056764, -804.7919338662412, -908.91057006596, -172.5706589787146, -979.1443063826292, -738.2922402562338, -83.73241721839737, -912.6605338516132, -1314.4299045427301, -720.940470258818, -627.1571063487074, -667.4360182272426, -220.44202676476814, -117.53716529510287, -1384.134167617164, -184.97584610930204, -441.376543872146, -126.96349751154105, -2.6424890666931065, -585.4581271932083, -797.797655689077, -960.493396845608, -118.29218650063196, -381.3737882073397, -625.6707910382755, -429.06336038127637, -1148.7492256974365, -266.53042131355136, -123.40989129621195, -547.0742386156244, -199.29041526398194, -467.3946296773021, -232.23547485041576, -566.2820405942724, -833.2988751467742, -481.15576226295906, -68.675754920938, -101.915827713197, -532.3416486668109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.577517801879127, "mean_inference_ms": 1.7297959735162458, "mean_action_processing_ms": 0.8310088264924719, "mean_env_wait_ms": 10.573109061925772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014500617980957031, "StateBufferConnector_ms": 0.010385513305664062, "ViewRequirementAgentConnector_ms": 0.35990285873413086}, "num_episodes": 21, "episode_return_max": -956.0395222364714, "episode_return_min": -4990.684892637792, "episode_return_mean": -2687.8967952693624, "episodes_this_iter": 21}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 978153, "num_agent_steps_trained": 978153, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.55219323723497, "num_env_steps_trained_throughput_per_sec": 81.55219323723497, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 978153, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 978153, "timers": {"training_iteration_time_ms": 47104.776, "restore_workers_time_ms": 0.026, "training_step_time_ms": 47104.708, "sample_time_ms": 3368.981, "learn_time_ms": 43680.492, "learn_throughput": 91.574, "synch_weights_time_ms": 52.327}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 978153, "num_agent_steps_trained": 978153}, "done": false, "training_iteration": 55, "trial_id": "05c72_00000", "date": "2024-07-26_15-28-44", "timestamp": 1721987924, "time_this_iter_s": 49.058135986328125, "time_total_s": 2743.974055290222, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00de560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2743.974055290222, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 14.032857142857145, "ram_util_percent": 30.81571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 189.01253569969765, "cur_kl_coeff": 0.50625, "cur_lr": 0.0010000000000000005, "total_loss": 4.560158321612921, "policy_loss": -0.0032259695827722167, "vf_loss": 4.581239636861361, "vf_explained_var": 0.987265272843532, "kl": 0.016030643502554783, "entropy": 2.597085881477747, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.93846153846154, "num_grad_updates_lifetime": 232110.5, "diff_num_grad_updates_vs_sampler_policy": 1949.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 994785, "num_agent_steps_trained": 994785}, "env_runners": {"episode_reward_max": -693.2525251995556, "episode_reward_min": -4990.684892637792, "episode_reward_mean": -2665.6480191334003, "episode_len_mean": 148.9, "episode_media": {}, "episodes_timesteps_total": 14890, "policy_reward_min": {"policy_0": -1561.972438973898}, "policy_reward_max": {"policy_0": -2.6424890666931065}, "policy_reward_mean": {"policy_0": -533.1296038266801}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2346.998643708979, -3523.607289662117, -2476.3420462942076, -2311.243875695051, -2512.0543111845313, -3431.237837669416, -2732.155725228503, -2539.540434749466, -2827.295493529886, -956.0395222364714, -1774.064012066804, -1518.4765131382846, -2321.0036827918248, -1691.7941521508656, -2894.5728545826555, -1899.8994816505226, -1691.6086188667064, -4823.207279052291, -4704.185314976556, -2928.274616696297, -2616.9225842045307, -1036.5684540880072, -3654.772469964938, -2212.781486382476, -2799.862342087235, -1578.3160002510397, -3339.602087869399, -3209.3440463760007, -2557.685868859671, -2914.400983571836, -2880.046305970692, -3712.3594650282485, -3421.7812523007733, -1533.8185080206656, -4301.407623638231, -2639.8784890057423, -2977.6326227711993, -4990.684892637792, -3181.4043570625413, -997.2885642921844, -4219.126582032148, -1540.7133940025078, -3584.979308182639, -4070.2903865776407, -1499.7710620028079, -1736.702198319788, -1972.0475071872074, -2647.366158994212, -2144.9712378845757, -1963.6742483714745, -2754.495076598054, -2312.7451355467856, -2398.5307338553744, -3614.8548592425523, -4295.466417372461, -2637.4982267285172, -2278.9786741757516, -2504.960971033079, -2612.186870039417, -3027.452544874834, -3037.410731704339, -3673.3364994167446, -1689.685541862616, -3340.9981894918405, -2835.848577467483, -1786.127167671841, -2912.945798793458, -4028.2594022516073, -2353.5127868946397, -2140.092544176846, -2843.4151544358633, -2593.4236897267515, -2012.2767990015968, -2017.3878687106778, -3226.3931640007067, -2132.4536173746774, -3268.532874682112, -3041.5991403891953, -3426.0582638251476, -2811.046702397744, -3018.135139571989, -2096.5766075141887, -2628.31977400432, -3779.221439350393, -3335.7019760563817, -3064.8530884117763, -2665.7667415172186, -2581.9824949374843, -2340.425072038109, -1944.7351556237659, -2077.8953741490222, -1799.7108358932753, -1710.2718128089575, -3108.0816854216405, -2726.8000744102546, -2696.0799911435483, -3523.621608996243, -1903.6622911804516, -1421.9320074991085, -693.2525251995556], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94], "policy_policy_0_reward": [-513.1363759853523, -924.0209782095452, -665.571843511609, -50.68030819520384, -193.58913780727, -137.12441220461437, -1047.088667958075, -724.2361558480062, -680.0801103881098, -935.0779432633103, -436.7670190921381, -396.2707884903182, -1187.8921829123797, -134.0516631395018, -321.3603926598694, -126.96837765215174, -141.45096172005557, -1412.7324323534078, -308.1226474662364, -321.9694565031984, -46.73480644242094, -827.0531365250689, -692.5812487547856, -223.44487247796317, -722.2402469842924, -566.110492305258, -305.35630986206866, -1338.962829960705, -350.622563137974, -870.1856424034106, -288.8095537170325, -1174.9698935688866, -308.40298574352704, -828.7063563556792, -131.26693584337826, -112.99873435794667, -341.16407675504587, -93.20699485423162, -831.8826532739454, -1160.287975508298, -887.1461470995786, -1269.9214558628705, -564.1395246250421, -64.28295438403529, -41.805411558360184, -324.57332612684615, -54.621702519674706, -388.2241478390489, -155.17685294065612, -33.443492810245196, -876.71757158253, -313.63290604860697, -28.440720198021914, -11.501480589299252, -543.7713336483458, -599.7976881702953, -64.25009430578295, -113.85985004856634, -490.888709486086, -249.68017112755453, -514.1039680862759, -356.92528775273473, -374.022785691284, -586.4136457815953, -489.5379954799367, -804.2419368661263, -15.1615113577413, -565.2589631491439, -64.16961350931969, -242.96212726853452, -1130.6300834565116, -317.7245769843807, -764.8100990220853, -551.9518835797693, -129.45621153990828, -181.46524113348735, -17.037767946859525, -781.4708202463573, -29.164548045032838, -890.7611042787854, -892.7888541444978, -45.43607101650301, -113.50900714272943, -569.161679812009, -70.71300675096788, -1424.319959742902, -1417.1101119109749, -565.104169280978, -378.8602486879016, -1037.8127894295396, -697.7411508760689, -1475.3600355251483, -974.487281579532, -1302.604922171141, -253.99192482466424, -346.89864652543116, -103.68197934582498, -1488.3761643393977, -469.81230932097, -519.5055171646715, -238.7762789036471, -117.2287436888613, -863.2634224529537, -347.3520221977354, -1050.3021169613341, -41.90051355860368, -260.98932362905856, -175.7969953632882, -93.88004744511518, -464.00157409194145, -304.77347025849326, -883.4847192709298, -766.0758342611557, -1561.972438973898, -138.4660072004576, -1071.4990791225277, -33.69544400699524, -363.05654535007466, -55.07264283810204, -689.4577750647748, -672.65522885693, -968.445254559945, -197.56127744514902, -614.4440972781741, -346.75648394703546, -142.48683281174965, -665.462982987019, -295.45142568714596, -196.94361616388494, -277.9711426012393, -714.7697018325074, -899.6185503825509, -108.36248951096388, -661.8907420010526, -954.9606041423264, -998.245218207177, -793.2850489765765, -753.7617971480074, -36.06581822030152, -627.9861638239364, -486.3217455313088, -308.3404741621275, -90.45421768688624, -463.2981150403735, -1209.2713164389775, -636.3144882701177, -1246.2385945981516, -333.82405400412176, -188.38398071963394, -509.6398659798105, -1077.5076527444353, -80.26516022292357, -235.45166439516512, -113.48854122889522, -1373.3332873792733, -722.8140046541763, -382.3873737021572, -546.7846270755355, -741.6912202815574, -1318.6822393148223, -212.8171083577481, -297.37460404169906, -453.69312956407833, -1340.066498106129, -1117.829912231119, -240.80136169686295, -94.67100116158825, -478.6103905905506, -574.3311555481146, -145.4045990235486, -1348.6239845199732, -834.7964992921607, -442.5090416929947, -1296.2251206406474, -379.25297749245414, -35.65593337084833, -629.2483448259184, -386.88593638237336, -1178.9352792844934, -409.1529951421082, -11.458732932794124, -253.2089124717345, -18.69324158495316, -1468.6172198293232, -1225.6545159523946, -606.4930797102533, -1087.4279369999967, -1299.3253094028096, -1223.9169477347034, -773.5216187900277, -54.34886307328062, -264.0547986890556, -672.631878089386, -979.0829947010839, -1211.2858225097343, -45.51957282500428, -215.45478776362575, -226.15507044577808, -371.9789417874045, -138.18019147037253, -1023.069465921316, -1222.3506836573135, -772.3146790517839, -758.5546477666272, -442.8371056351043, -221.77200139122434, -61.63253417989809, -534.0131678083301, -661.7444892704007, -61.55120135265371, -968.5208344554649, -672.3901758371587, -1037.7068224051434, -20.817759671706305, -885.5437158131668, -721.7837140289016, -492.9261218024475, -1212.799488233745, -820.9291029578646, -821.85195955468, -32.40803014002363, -700.3701178135834, -51.4537925157634, -22.44877347607732, -693.0903480573594, -41.14517758370998, -102.08557978515931, -321.28481083059523, -1125.6600421353812, -146.5265879849429, -153.17869414353527, -795.029442014711, -680.8139468451973, -72.78442555218983, -270.24099863157323, -569.445268248252, -195.15072311398313, -221.48524034517746, -728.7800029109156, -932.5049243758828, -227.8742936986377, -701.6301177118702, -314.2303924893869, -700.7648654603723, -200.47156852430638, -279.91874693261764, -963.4357236045698, -232.44978818968306, -75.36286652370471, -412.50712312089945, -541.0059231467383, -373.3202570873354, -284.56131473303697, -343.10954027200626, -1212.4980413589385, -738.1057498805768, -114.9885596745578, -1299.070629529379, -92.05025647262154, -68.52993998964911, -673.4190447957135, -59.723532928517514, -608.367021797345, -457.24800755170435, -599.7731267820918, -744.3182944538727, -264.39345770165033, -724.2367769192798, -818.3388252641382, -1063.5675049036133, -1446.8660211370873, -538.7589942612577, -635.3950881748457, -346.0429630523331, -1328.4033507469383, -508.58959241008466, -76.54955790036792, -471.4679327391678, -999.1235200906034, -581.7676235882936, -910.3619606088029, -506.97957220046266, -221.87934781028665, -559.1357315998032, -80.62206195639736, -275.6867652223206, -237.32325479592112, -985.9660772196677, -471.6762242983657, -534.3086494968053, -313.4432404953039, -290.04292599631293, -1395.178956114225, -476.33902596755644, -137.18272146602064, -595.5706003005998, -483.8693232569615, -1075.1156779101002, -436.75847159272377, -436.1384718144446, -857.2334353512397, -1008.5365214365995, -19.52900116849909, -649.5236594796432, -502.5881142683553, -115.32777264594942, -863.6718984929278, -993.5904398463368, -819.923406927009, -880.8229815045214, -329.76932757206663, -282.7804211791808, -338.23812509463, -433.43233115552937, -305.4653368612098, -662.4528569483024, -107.87953261149757, -976.5327668227607, -539.8361383011942, -1054.296894808085, -65.43978912261846, -247.34673153589247, -862.6775392160063, -1014.3074659996529, -646.0770515933118, -136.6128920897921, -146.8273576398746, -472.61534241898, -258.43221797480857, -771.6393575483871, -553.6846421819781, -472.98799370056764, -804.7919338662412, -908.91057006596, -172.5706589787146, -979.1443063826292, -738.2922402562338, -83.73241721839737, -912.6605338516132, -1314.4299045427301, -720.940470258818, -627.1571063487074, -667.4360182272426, -220.44202676476814, -117.53716529510287, -1384.134167617164, -184.97584610930204, -441.376543872146, -126.96349751154105, -2.6424890666931065, -585.4581271932083, -797.797655689077, -960.493396845608, -118.29218650063196, -381.3737882073397, -625.6707910382755, -429.06336038127637, -1148.7492256974365, -266.53042131355136, -123.40989129621195, -547.0742386156244, -199.29041526398194, -467.3946296773021, -232.23547485041576, -566.2820405942724, -833.2988751467742, -481.15576226295906, -68.675754920938, -101.915827713197, -532.3416486668109, -679.4114971322315, -217.7166859406917, -1042.4087170704145, -530.4142347835291, -756.4420290738402, -128.90140492130845, -1013.033377960851, -299.9126221648036, -641.8311286526524, -48.77508367506227, -1257.6091461675574, -758.3537054466764, -224.71241744674248, -565.7835701102966, -462.074035510837, -452.58817079051397, -1283.4244469717419, -511.58739829484506, -612.2169520925223, -181.78217223957367, -473.6289182725071, -1036.1693513374705, -683.0897596070912, -625.0608978166845, -608.1093367913965, -401.145438060224, -757.0373618801651, -631.2999199065513, -515.6250342167805, -505.9389483340256, -802.256737722923, -295.4783708996255, -165.7477976647585, -549.5451800418666, -1205.1070532428146, -573.8506704043228, -432.0078884462845, -177.20839705778042, -116.5983933573376, -796.9112582484624, -1286.309815053873, -356.0272432941963, -725.4638383212364, -51.988284011725874, -208.53059332328837, -616.1257210856196, -1031.9752673009098, -1114.5220978733894, -49.51160045710038, -967.0867526333735, -182.9686630397071, -884.3394479892062, -1024.1917341260419, -86.969707106477, -1157.2324237949472, -1528.653961944682, -56.04775166690273, -1148.5787451076928, -210.89281807046672, -120.67981162203056, -650.1860597866719, -43.13959716868003, -1148.4760757378033, -422.68322659781006, -401.2817822262567, -38.20225060052533, -361.45348435373046, -104.41478501097214, -1073.7736878285582, -1004.1382871436954, -135.36085655482745, -106.76095940976046, -80.27698310535614, -1122.620361351143, -895.4059116170226, -763.2553336790137, -29.596717738126237, -167.3900575332184, -571.952717440416, -412.54032923299496, -113.4505562506463, -385.63944898336376, -69.32678459758864, -128.11002782203627, -1381.3685564953869, -983.7700741644868, -173.10492027849813, -447.0202687949703, -22.96972299027331, -172.84584966504744, -368.6835539551549, -246.41343160691613, -490.03541793575744, -145.14185225558649, -459.997557055541, -240.35469246180753, -444.9809900459434, -1133.353167012629, -534.9773667635021, -754.4154691377591, -617.943373122407, -144.44017905013536, -222.02308933576114, -953.456161914479, -788.9372709874754, -60.14422404664733, -94.31116202124454, -1234.087643452172, -196.26410903036572, -1111.2728525931204, -83.06431816865751, -343.77771096184273, -1117.2691265270503, -944.383429426583, -1035.127023912105, -480.6291527870324, -796.7204303679798, -362.03074481263644, -161.43806581488298, -102.84389739791726, -685.4125609691454, -215.19733370532973, -353.0704054133123, -10.6738717961255, -157.57783561519616, -113.01234452606366, -225.88245176763073, -121.97947083555948, -28.648754779264728, -203.72950329103625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.575340081817853, "mean_inference_ms": 1.7300967312408624, "mean_action_processing_ms": 0.8300693320565133, "mean_env_wait_ms": 10.567266951226664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014158487319946289, "StateBufferConnector_ms": 0.01013040542602539, "ViewRequirementAgentConnector_ms": 0.34868335723876953}, "num_episodes": 26, "episode_return_max": -693.2525251995556, "episode_return_min": -4990.684892637792, "episode_return_mean": -2665.6480191334003, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 994785, "num_agent_steps_trained": 994785, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.05113116912196, "num_env_steps_trained_throughput_per_sec": 82.05113116912196, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 994785, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 994785, "timers": {"training_iteration_time_ms": 47303.737, "restore_workers_time_ms": 0.026, "training_step_time_ms": 47303.668, "sample_time_ms": 3341.98, "learn_time_ms": 43906.624, "learn_throughput": 91.102, "synch_weights_time_ms": 52.128}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 994785, "num_agent_steps_trained": 994785}, "done": false, "training_iteration": 56, "trial_id": "05c72_00000", "date": "2024-07-26_15-29-33", "timestamp": 1721987973, "time_this_iter_s": 48.759602785110474, "time_total_s": 2792.7336580753326, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e53f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2792.7336580753326, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 13.005797101449275, "ram_util_percent": 30.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 152.7757197450189, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.762350974129696, "policy_loss": -0.0018168637850869665, "vf_loss": 4.779673879403694, "vf_explained_var": 0.985640754886702, "kl": 0.017578345767619526, "entropy": 2.440508526943478, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.20588235294117, "num_grad_updates_lifetime": 236100.5, "diff_num_grad_updates_vs_sampler_policy": 2039.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 1012085, "num_agent_steps_trained": 1012085}, "env_runners": {"episode_reward_max": -693.2525251995556, "episode_reward_min": -4990.684892637792, "episode_reward_mean": -2651.244722485482, "episode_len_mean": 149.04, "episode_media": {}, "episodes_timesteps_total": 14904, "policy_reward_min": {"policy_0": -1528.653961944682}, "policy_reward_max": {"policy_0": -2.6424890666931065}, "policy_reward_mean": {"policy_0": -530.2489444970963}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1533.8185080206656, -4301.407623638231, -2639.8784890057423, -2977.6326227711993, -4990.684892637792, -3181.4043570625413, -997.2885642921844, -4219.126582032148, -1540.7133940025078, -3584.979308182639, -4070.2903865776407, -1499.7710620028079, -1736.702198319788, -1972.0475071872074, -2647.366158994212, -2144.9712378845757, -1963.6742483714745, -2754.495076598054, -2312.7451355467856, -2398.5307338553744, -3614.8548592425523, -4295.466417372461, -2637.4982267285172, -2278.9786741757516, -2504.960971033079, -2612.186870039417, -3027.452544874834, -3037.410731704339, -3673.3364994167446, -1689.685541862616, -3340.9981894918405, -2835.848577467483, -1786.127167671841, -2912.945798793458, -4028.2594022516073, -2353.5127868946397, -2140.092544176846, -2843.4151544358633, -2593.4236897267515, -2012.2767990015968, -2017.3878687106778, -3226.3931640007067, -2132.4536173746774, -3268.532874682112, -3041.5991403891953, -3426.0582638251476, -2811.046702397744, -3018.135139571989, -2096.5766075141887, -2628.31977400432, -3779.221439350393, -3335.7019760563817, -3064.8530884117763, -2665.7667415172186, -2581.9824949374843, -2340.425072038109, -1944.7351556237659, -2077.8953741490222, -1799.7108358932753, -1710.2718128089575, -3108.0816854216405, -2726.8000744102546, -2696.0799911435483, -3523.621608996243, -1903.6622911804516, -1421.9320074991085, -693.2525251995556, -2798.9693363788247, -2361.7887072780645, -1593.6863214774708, -1301.4793706219734, -3215.5510506876417, -3243.6252336328967, -2564.1233229467193, -1763.2567324005522, -3255.1276363268953, -1672.3924926971447, -2469.0693311611567, -2292.3698714652746, -3146.4922115680456, -3003.680979503739, -1828.5090459264832, -3250.781243156137, -1354.8685296446622, -2129.973664108001, -2811.190275492123, -3102.30482576202, -3791.853416267669, -2506.811952917038, -2279.4594415492998, -2703.683155160142, -4698.0688288298525, -2645.234222109332, -2111.6118144785573, -4111.236434949529, -2009.9363551907506, -2226.067348380238, -2163.8492440203013, -2186.84659782574, -3803.816394180179], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-240.80136169686295, -94.67100116158825, -478.6103905905506, -574.3311555481146, -145.4045990235486, -1348.6239845199732, -834.7964992921607, -442.5090416929947, -1296.2251206406474, -379.25297749245414, -35.65593337084833, -629.2483448259184, -386.88593638237336, -1178.9352792844934, -409.1529951421082, -11.458732932794124, -253.2089124717345, -18.69324158495316, -1468.6172198293232, -1225.6545159523946, -606.4930797102533, -1087.4279369999967, -1299.3253094028096, -1223.9169477347034, -773.5216187900277, -54.34886307328062, -264.0547986890556, -672.631878089386, -979.0829947010839, -1211.2858225097343, -45.51957282500428, -215.45478776362575, -226.15507044577808, -371.9789417874045, -138.18019147037253, -1023.069465921316, -1222.3506836573135, -772.3146790517839, -758.5546477666272, -442.8371056351043, -221.77200139122434, -61.63253417989809, -534.0131678083301, -661.7444892704007, -61.55120135265371, -968.5208344554649, -672.3901758371587, -1037.7068224051434, -20.817759671706305, -885.5437158131668, -721.7837140289016, -492.9261218024475, -1212.799488233745, -820.9291029578646, -821.85195955468, -32.40803014002363, -700.3701178135834, -51.4537925157634, -22.44877347607732, -693.0903480573594, -41.14517758370998, -102.08557978515931, -321.28481083059523, -1125.6600421353812, -146.5265879849429, -153.17869414353527, -795.029442014711, -680.8139468451973, -72.78442555218983, -270.24099863157323, -569.445268248252, -195.15072311398313, -221.48524034517746, -728.7800029109156, -932.5049243758828, -227.8742936986377, -701.6301177118702, -314.2303924893869, -700.7648654603723, -200.47156852430638, -279.91874693261764, -963.4357236045698, -232.44978818968306, -75.36286652370471, -412.50712312089945, -541.0059231467383, -373.3202570873354, -284.56131473303697, -343.10954027200626, -1212.4980413589385, -738.1057498805768, -114.9885596745578, -1299.070629529379, -92.05025647262154, -68.52993998964911, -673.4190447957135, -59.723532928517514, -608.367021797345, -457.24800755170435, -599.7731267820918, -744.3182944538727, -264.39345770165033, -724.2367769192798, -818.3388252641382, -1063.5675049036133, -1446.8660211370873, -538.7589942612577, -635.3950881748457, -346.0429630523331, -1328.4033507469383, -508.58959241008466, -76.54955790036792, -471.4679327391678, -999.1235200906034, -581.7676235882936, -910.3619606088029, -506.97957220046266, -221.87934781028665, -559.1357315998032, -80.62206195639736, -275.6867652223206, -237.32325479592112, -985.9660772196677, -471.6762242983657, -534.3086494968053, -313.4432404953039, -290.04292599631293, -1395.178956114225, -476.33902596755644, -137.18272146602064, -595.5706003005998, -483.8693232569615, -1075.1156779101002, -436.75847159272377, -436.1384718144446, -857.2334353512397, -1008.5365214365995, -19.52900116849909, -649.5236594796432, -502.5881142683553, -115.32777264594942, -863.6718984929278, -993.5904398463368, -819.923406927009, -880.8229815045214, -329.76932757206663, -282.7804211791808, -338.23812509463, -433.43233115552937, -305.4653368612098, -662.4528569483024, -107.87953261149757, -976.5327668227607, -539.8361383011942, -1054.296894808085, -65.43978912261846, -247.34673153589247, -862.6775392160063, -1014.3074659996529, -646.0770515933118, -136.6128920897921, -146.8273576398746, -472.61534241898, -258.43221797480857, -771.6393575483871, -553.6846421819781, -472.98799370056764, -804.7919338662412, -908.91057006596, -172.5706589787146, -979.1443063826292, -738.2922402562338, -83.73241721839737, -912.6605338516132, -1314.4299045427301, -720.940470258818, -627.1571063487074, -667.4360182272426, -220.44202676476814, -117.53716529510287, -1384.134167617164, -184.97584610930204, -441.376543872146, -126.96349751154105, -2.6424890666931065, -585.4581271932083, -797.797655689077, -960.493396845608, -118.29218650063196, -381.3737882073397, -625.6707910382755, -429.06336038127637, -1148.7492256974365, -266.53042131355136, -123.40989129621195, -547.0742386156244, -199.29041526398194, -467.3946296773021, -232.23547485041576, -566.2820405942724, -833.2988751467742, -481.15576226295906, -68.675754920938, -101.915827713197, -532.3416486668109, -679.4114971322315, -217.7166859406917, -1042.4087170704145, -530.4142347835291, -756.4420290738402, -128.90140492130845, -1013.033377960851, -299.9126221648036, -641.8311286526524, -48.77508367506227, -1257.6091461675574, -758.3537054466764, -224.71241744674248, -565.7835701102966, -462.074035510837, -452.58817079051397, -1283.4244469717419, -511.58739829484506, -612.2169520925223, -181.78217223957367, -473.6289182725071, -1036.1693513374705, -683.0897596070912, -625.0608978166845, -608.1093367913965, -401.145438060224, -757.0373618801651, -631.2999199065513, -515.6250342167805, -505.9389483340256, -802.256737722923, -295.4783708996255, -165.7477976647585, -549.5451800418666, -1205.1070532428146, -573.8506704043228, -432.0078884462845, -177.20839705778042, -116.5983933573376, -796.9112582484624, -1286.309815053873, -356.0272432941963, -725.4638383212364, -51.988284011725874, -208.53059332328837, -616.1257210856196, -1031.9752673009098, -1114.5220978733894, -49.51160045710038, -967.0867526333735, -182.9686630397071, -884.3394479892062, -1024.1917341260419, -86.969707106477, -1157.2324237949472, -1528.653961944682, -56.04775166690273, -1148.5787451076928, -210.89281807046672, -120.67981162203056, -650.1860597866719, -43.13959716868003, -1148.4760757378033, -422.68322659781006, -401.2817822262567, -38.20225060052533, -361.45348435373046, -104.41478501097214, -1073.7736878285582, -1004.1382871436954, -135.36085655482745, -106.76095940976046, -80.27698310535614, -1122.620361351143, -895.4059116170226, -763.2553336790137, -29.596717738126237, -167.3900575332184, -571.952717440416, -412.54032923299496, -113.4505562506463, -385.63944898336376, -69.32678459758864, -128.11002782203627, -1381.3685564953869, -983.7700741644868, -173.10492027849813, -447.0202687949703, -22.96972299027331, -172.84584966504744, -368.6835539551549, -246.41343160691613, -490.03541793575744, -145.14185225558649, -459.997557055541, -240.35469246180753, -444.9809900459434, -1133.353167012629, -534.9773667635021, -754.4154691377591, -617.943373122407, -144.44017905013536, -222.02308933576114, -953.456161914479, -788.9372709874754, -60.14422404664733, -94.31116202124454, -1234.087643452172, -196.26410903036572, -1111.2728525931204, -83.06431816865751, -343.77771096184273, -1117.2691265270503, -944.383429426583, -1035.127023912105, -480.6291527870324, -796.7204303679798, -362.03074481263644, -161.43806581488298, -102.84389739791726, -685.4125609691454, -215.19733370532973, -353.0704054133123, -10.6738717961255, -157.57783561519616, -113.01234452606366, -225.88245176763073, -121.97947083555948, -28.648754779264728, -203.72950329103625, -494.06201699670083, -1154.3201769076886, -358.8716662101141, -439.59291359746, -352.12256266685785, -417.98853239729266, -206.7913257393302, -15.762948274346282, -751.480083002823, -969.7658178642715, -552.9618744915167, -111.5021522355979, -821.1649292083258, -66.94218916560149, -41.11517637642819, -440.37272679178176, -146.6185064824262, -241.69000132663558, -258.4520194024385, -214.3461166186927, -565.0239229078373, -339.85739248109195, -1447.5976861437007, -365.4134582979322, -497.6585908570786, -109.64124248852295, -1224.2032352777837, -581.355613936963, -180.07150540940324, -1148.3536365202212, -621.691916623945, -558.8728295453035, -306.60363513615084, -528.5183624350071, -548.4365792063136, -70.08968404323957, -200.4302358907805, -50.93530251638275, -445.2063799861527, -996.5951299639956, -1091.6996982322012, -1160.8092116459468, -169.0096883102369, -29.399295812760307, -804.209742325748, -839.3420672564995, -360.64169265574435, -183.14792526496993, -11.486840883665767, -277.7739666362666, -721.9290124258555, -680.3810849712438, -181.2758817709116, -237.85169273266212, -647.631659260485, -1263.9733137425007, -128.5744753808613, -90.91664350045671, -305.1223433204623, -503.783095520991, -487.6242233654189, -537.1072247954872, -1053.3735526534772, -952.9662129975806, -115.42099775608507, -238.24376640278078, -882.3451197827202, -139.82701554336845, -1265.8094087836207, -477.4556689912492, -660.990036719211, -51.14303707732125, -427.78451026705875, -79.78734622817426, -608.8041156347166, -1224.4044266220374, -343.5890354667985, -609.9212275729163, -16.244914635626888, -1056.6216388587566, -134.07392041125289, -105.61233941122721, -129.07690306984736, -21.149939375484937, -964.9554273768518, -167.1132135840265, -383.02531505257036, -215.28259610569947, -1269.9061225480962, -94.64641681760875, -791.3600380082197, -123.54310673041459, -512.7441934997308, -839.7394995355141, -543.8034377182456, -69.8929355131814, -603.7026191769147, -1098.105503790077, -1279.3549587498624, -51.24880853198682, -987.7248314500171, -465.75176700903256, -1089.0154223142692, -630.8573002845377, -618.5040952098186, -647.256617587737, -96.1556106158477, -1319.6403889630726, -49.780218462872064, -393.97911728750705, -726.8128953274345, -60.637314039886455, -29.28354086656865, -657.1877859836329, -805.5379053317779, -353.87880491889825, -1115.5144910500628, -902.2239736508141, -190.2359470617147, -141.82993847865288, -1465.7550019068972, -583.4827030816543, -742.15492847764, -1262.7850748884262, -643.8911204752287, -863.5844217182722, -978.2862026532463, -423.5778662417129, -164.9213082643718, -214.86442323173046, -398.0055190469393, -849.9102949715758, -793.4416163626976, -55.19240600233704, -15.061978095007916, -641.8382368190322, -545.0558037535028, -1107.623734388346, -1113.6197080395586, -703.0989519490948, -117.59866328932713, -942.088950715397, -146.01278631717946, -24.566730618944295, -779.6692242499031, -716.1846734013866, -758.8062868647339, -99.93052144507055, -227.9691699946833, -423.1766966743644, -40.51420958101862, -561.4753864352373, -138.59530277663006, -960.4924286021762, -462.77191662524064, -478.96212768764605, -53.68571611550161, -932.5492553949933, -61.311279510848166, -660.3382191167499, -696.4727410597619, -490.22667996310656, -695.5173701690546, -1169.954976090021, -751.6446268982316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5737848294321284, "mean_inference_ms": 1.7304106966045851, "mean_action_processing_ms": 0.8296217655597298, "mean_env_wait_ms": 10.561612612427512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014951705932617188, "StateBufferConnector_ms": 0.010452508926391602, "ViewRequirementAgentConnector_ms": 0.3578159809112549}, "num_episodes": 33, "episode_return_max": -693.2525251995556, "episode_return_min": -4990.684892637792, "episode_return_mean": -2651.244722485482, "episodes_this_iter": 33}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1012085, "num_agent_steps_trained": 1012085, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.01469172895916, "num_env_steps_trained_throughput_per_sec": 89.01469172895916, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 1012085, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1012085, "timers": {"training_iteration_time_ms": 48523.833, "restore_workers_time_ms": 0.026, "training_step_time_ms": 48523.764, "sample_time_ms": 3343.13, "learn_time_ms": 45123.532, "learn_throughput": 88.646, "synch_weights_time_ms": 54.023}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 1012085, "num_agent_steps_trained": 1012085}, "done": false, "training_iteration": 57, "trial_id": "05c72_00000", "date": "2024-07-26_15-30-18", "timestamp": 1721988018, "time_this_iter_s": 44.94787096977234, "time_total_s": 2837.681529045105, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00ddea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2837.681529045105, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 13.343749999999998, "ram_util_percent": 30.954687500000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.82269846550142, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.588878169685903, "policy_loss": -0.0012096943098562534, "vf_loss": 4.6058057406333965, "vf_explained_var": 0.9856802716399684, "kl": 0.016701166359784147, "entropy": 2.417283808733478, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.8409090909091, "num_grad_updates_lifetime": 240120.5, "diff_num_grad_updates_vs_sampler_policy": 1979.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 1028960, "num_agent_steps_trained": 1028960}, "env_runners": {"episode_reward_max": -693.2525251995556, "episode_reward_min": -4698.0688288298525, "episode_reward_mean": -2682.4035953937405, "episode_len_mean": 149.04, "episode_media": {}, "episodes_timesteps_total": 14904, "policy_reward_min": {"policy_0": -1528.653961944682}, "policy_reward_max": {"policy_0": -2.6424890666931065}, "policy_reward_mean": {"policy_0": -536.4807190787483}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4295.466417372461, -2637.4982267285172, -2278.9786741757516, -2504.960971033079, -2612.186870039417, -3027.452544874834, -3037.410731704339, -3673.3364994167446, -1689.685541862616, -3340.9981894918405, -2835.848577467483, -1786.127167671841, -2912.945798793458, -4028.2594022516073, -2353.5127868946397, -2140.092544176846, -2843.4151544358633, -2593.4236897267515, -2012.2767990015968, -2017.3878687106778, -3226.3931640007067, -2132.4536173746774, -3268.532874682112, -3041.5991403891953, -3426.0582638251476, -2811.046702397744, -3018.135139571989, -2096.5766075141887, -2628.31977400432, -3779.221439350393, -3335.7019760563817, -3064.8530884117763, -2665.7667415172186, -2581.9824949374843, -2340.425072038109, -1944.7351556237659, -2077.8953741490222, -1799.7108358932753, -1710.2718128089575, -3108.0816854216405, -2726.8000744102546, -2696.0799911435483, -3523.621608996243, -1903.6622911804516, -1421.9320074991085, -693.2525251995556, -2798.9693363788247, -2361.7887072780645, -1593.6863214774708, -1301.4793706219734, -3215.5510506876417, -3243.6252336328967, -2564.1233229467193, -1763.2567324005522, -3255.1276363268953, -1672.3924926971447, -2469.0693311611567, -2292.3698714652746, -3146.4922115680456, -3003.680979503739, -1828.5090459264832, -3250.781243156137, -1354.8685296446622, -2129.973664108001, -2811.190275492123, -3102.30482576202, -3791.853416267669, -2506.811952917038, -2279.4594415492998, -2703.683155160142, -4698.0688288298525, -2645.234222109332, -2111.6118144785573, -4111.236434949529, -2009.9363551907506, -2226.067348380238, -2163.8492440203013, -2186.84659782574, -3803.816394180179, -2237.943630916701, -1764.6659946824561, -3007.6460235743934, -3480.145727598788, -3193.466556249999, -3316.087011604341, -4276.915274766668, -4329.314987390111, -3752.2488938246897, -2561.3824160597865, -1734.9272143306644, -1919.9685352262595, -1859.4658894558293, -1353.9264778480208, -3021.2481372154334, -2962.4057114993907, -2296.0699797529037, -3175.8976788086093, -2804.42403256239, -3273.0339796826256, -3877.0860840019554], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1446.8660211370873, -538.7589942612577, -635.3950881748457, -346.0429630523331, -1328.4033507469383, -508.58959241008466, -76.54955790036792, -471.4679327391678, -999.1235200906034, -581.7676235882936, -910.3619606088029, -506.97957220046266, -221.87934781028665, -559.1357315998032, -80.62206195639736, -275.6867652223206, -237.32325479592112, -985.9660772196677, -471.6762242983657, -534.3086494968053, -313.4432404953039, -290.04292599631293, -1395.178956114225, -476.33902596755644, -137.18272146602064, -595.5706003005998, -483.8693232569615, -1075.1156779101002, -436.75847159272377, -436.1384718144446, -857.2334353512397, -1008.5365214365995, -19.52900116849909, -649.5236594796432, -502.5881142683553, -115.32777264594942, -863.6718984929278, -993.5904398463368, -819.923406927009, -880.8229815045214, -329.76932757206663, -282.7804211791808, -338.23812509463, -433.43233115552937, -305.4653368612098, -662.4528569483024, -107.87953261149757, -976.5327668227607, -539.8361383011942, -1054.296894808085, -65.43978912261846, -247.34673153589247, -862.6775392160063, -1014.3074659996529, -646.0770515933118, -136.6128920897921, -146.8273576398746, -472.61534241898, -258.43221797480857, -771.6393575483871, -553.6846421819781, -472.98799370056764, -804.7919338662412, -908.91057006596, -172.5706589787146, -979.1443063826292, -738.2922402562338, -83.73241721839737, -912.6605338516132, -1314.4299045427301, -720.940470258818, -627.1571063487074, -667.4360182272426, -220.44202676476814, -117.53716529510287, -1384.134167617164, -184.97584610930204, -441.376543872146, -126.96349751154105, -2.6424890666931065, -585.4581271932083, -797.797655689077, -960.493396845608, -118.29218650063196, -381.3737882073397, -625.6707910382755, -429.06336038127637, -1148.7492256974365, -266.53042131355136, -123.40989129621195, -547.0742386156244, -199.29041526398194, -467.3946296773021, -232.23547485041576, -566.2820405942724, -833.2988751467742, -481.15576226295906, -68.675754920938, -101.915827713197, -532.3416486668109, -679.4114971322315, -217.7166859406917, -1042.4087170704145, -530.4142347835291, -756.4420290738402, -128.90140492130845, -1013.033377960851, -299.9126221648036, -641.8311286526524, -48.77508367506227, -1257.6091461675574, -758.3537054466764, -224.71241744674248, -565.7835701102966, -462.074035510837, -452.58817079051397, -1283.4244469717419, -511.58739829484506, -612.2169520925223, -181.78217223957367, -473.6289182725071, -1036.1693513374705, -683.0897596070912, -625.0608978166845, -608.1093367913965, -401.145438060224, -757.0373618801651, -631.2999199065513, -515.6250342167805, -505.9389483340256, -802.256737722923, -295.4783708996255, -165.7477976647585, -549.5451800418666, -1205.1070532428146, -573.8506704043228, -432.0078884462845, -177.20839705778042, -116.5983933573376, -796.9112582484624, -1286.309815053873, -356.0272432941963, -725.4638383212364, -51.988284011725874, -208.53059332328837, -616.1257210856196, -1031.9752673009098, -1114.5220978733894, -49.51160045710038, -967.0867526333735, -182.9686630397071, -884.3394479892062, -1024.1917341260419, -86.969707106477, -1157.2324237949472, -1528.653961944682, -56.04775166690273, -1148.5787451076928, -210.89281807046672, -120.67981162203056, -650.1860597866719, -43.13959716868003, -1148.4760757378033, -422.68322659781006, -401.2817822262567, -38.20225060052533, -361.45348435373046, -104.41478501097214, -1073.7736878285582, -1004.1382871436954, -135.36085655482745, -106.76095940976046, -80.27698310535614, -1122.620361351143, -895.4059116170226, -763.2553336790137, -29.596717738126237, -167.3900575332184, -571.952717440416, -412.54032923299496, -113.4505562506463, -385.63944898336376, -69.32678459758864, -128.11002782203627, -1381.3685564953869, -983.7700741644868, -173.10492027849813, -447.0202687949703, -22.96972299027331, -172.84584966504744, -368.6835539551549, -246.41343160691613, -490.03541793575744, -145.14185225558649, -459.997557055541, -240.35469246180753, -444.9809900459434, -1133.353167012629, -534.9773667635021, -754.4154691377591, -617.943373122407, -144.44017905013536, -222.02308933576114, -953.456161914479, -788.9372709874754, -60.14422404664733, -94.31116202124454, -1234.087643452172, -196.26410903036572, -1111.2728525931204, -83.06431816865751, -343.77771096184273, -1117.2691265270503, -944.383429426583, -1035.127023912105, -480.6291527870324, -796.7204303679798, -362.03074481263644, -161.43806581488298, -102.84389739791726, -685.4125609691454, -215.19733370532973, -353.0704054133123, -10.6738717961255, -157.57783561519616, -113.01234452606366, -225.88245176763073, -121.97947083555948, -28.648754779264728, -203.72950329103625, -494.06201699670083, -1154.3201769076886, -358.8716662101141, -439.59291359746, -352.12256266685785, -417.98853239729266, -206.7913257393302, -15.762948274346282, -751.480083002823, -969.7658178642715, -552.9618744915167, -111.5021522355979, -821.1649292083258, -66.94218916560149, -41.11517637642819, -440.37272679178176, -146.6185064824262, -241.69000132663558, -258.4520194024385, -214.3461166186927, -565.0239229078373, -339.85739248109195, -1447.5976861437007, -365.4134582979322, -497.6585908570786, -109.64124248852295, -1224.2032352777837, -581.355613936963, -180.07150540940324, -1148.3536365202212, -621.691916623945, -558.8728295453035, -306.60363513615084, -528.5183624350071, -548.4365792063136, -70.08968404323957, -200.4302358907805, -50.93530251638275, -445.2063799861527, -996.5951299639956, -1091.6996982322012, -1160.8092116459468, -169.0096883102369, -29.399295812760307, -804.209742325748, -839.3420672564995, -360.64169265574435, -183.14792526496993, -11.486840883665767, -277.7739666362666, -721.9290124258555, -680.3810849712438, -181.2758817709116, -237.85169273266212, -647.631659260485, -1263.9733137425007, -128.5744753808613, -90.91664350045671, -305.1223433204623, -503.783095520991, -487.6242233654189, -537.1072247954872, -1053.3735526534772, -952.9662129975806, -115.42099775608507, -238.24376640278078, -882.3451197827202, -139.82701554336845, -1265.8094087836207, -477.4556689912492, -660.990036719211, -51.14303707732125, -427.78451026705875, -79.78734622817426, -608.8041156347166, -1224.4044266220374, -343.5890354667985, -609.9212275729163, -16.244914635626888, -1056.6216388587566, -134.07392041125289, -105.61233941122721, -129.07690306984736, -21.149939375484937, -964.9554273768518, -167.1132135840265, -383.02531505257036, -215.28259610569947, -1269.9061225480962, -94.64641681760875, -791.3600380082197, -123.54310673041459, -512.7441934997308, -839.7394995355141, -543.8034377182456, -69.8929355131814, -603.7026191769147, -1098.105503790077, -1279.3549587498624, -51.24880853198682, -987.7248314500171, -465.75176700903256, -1089.0154223142692, -630.8573002845377, -618.5040952098186, -647.256617587737, -96.1556106158477, -1319.6403889630726, -49.780218462872064, -393.97911728750705, -726.8128953274345, -60.637314039886455, -29.28354086656865, -657.1877859836329, -805.5379053317779, -353.87880491889825, -1115.5144910500628, -902.2239736508141, -190.2359470617147, -141.82993847865288, -1465.7550019068972, -583.4827030816543, -742.15492847764, -1262.7850748884262, -643.8911204752287, -863.5844217182722, -978.2862026532463, -423.5778662417129, -164.9213082643718, -214.86442323173046, -398.0055190469393, -849.9102949715758, -793.4416163626976, -55.19240600233704, -15.061978095007916, -641.8382368190322, -545.0558037535028, -1107.623734388346, -1113.6197080395586, -703.0989519490948, -117.59866328932713, -942.088950715397, -146.01278631717946, -24.566730618944295, -779.6692242499031, -716.1846734013866, -758.8062868647339, -99.93052144507055, -227.9691699946833, -423.1766966743644, -40.51420958101862, -561.4753864352373, -138.59530277663006, -960.4924286021762, -462.77191662524064, -478.96212768764605, -53.68571611550161, -932.5492553949933, -61.311279510848166, -660.3382191167499, -696.4727410597619, -490.22667996310656, -695.5173701690546, -1169.954976090021, -751.6446268982316, -85.409489893599, -570.6545492437378, -298.4694999934399, -504.090831140504, -779.3192606454207, -156.01492985612794, -51.42645062351381, -93.74332165783042, -744.4957616164768, -718.9855309285068, -566.3459702955108, -766.4981745196473, -513.9749471929586, -427.45073148469606, -733.3762000815763, -983.4993585774663, -60.79697045772347, -283.4285689778938, -1129.747068037398, -1022.6737615483087, -711.663350471598, -289.8489923729876, -487.983079847588, -482.37660550416456, -1221.5945280536578, -651.2530184804893, -721.6348179448452, -275.3194186105553, -846.575271853176, -821.304484715277, -1184.0876207208998, -280.0394876345052, -522.6340588497964, -1149.3941416883465, -1140.7599658731192, -1197.8115647236891, -35.527516491469484, -1346.0056493727743, -287.90872746743776, -1462.0615293347414, -1056.2255971540537, -15.38129694566647, -448.33036678554794, -1415.2747203553492, -817.0369125840756, -617.9751952356095, -317.57496000237285, -384.0135999311515, -734.7611928973103, -507.05746799334275, -44.944281086601414, -160.3706775867849, -37.62561680699147, -1414.212894284414, -77.77374456587218, -190.7343054736392, -447.73320539698017, -606.487371620221, -133.91408060941748, -541.0995721260023, -286.45961489695884, -376.31714278383157, -581.7393144334462, -215.18034421604045, -399.76947312555154, -219.41664559926252, -108.88352055691108, -147.25393065839185, -28.3854807727564, -849.9869002607002, -1169.4094672666934, -334.3572096584187, -605.1845516523231, -254.5262978587967, -657.7706107792, -913.3519390871344, -54.979022286903515, -147.30707824563729, -998.2019120028756, -848.5657598768386, -869.9316006331344, -482.6251101826825, -670.8725502674637, -197.61599745244297, -75.02472121718174, -659.60884487012, -802.2995469211876, -107.17146963761012, -1453.0425983534592, -153.77521902623153, -134.73854269100093, -1121.5167336574998, -190.60965979785095, -759.1089767938536, -598.450119622182, -657.6511525403581, -319.8391608985654, -1068.1433291061621, -582.8053164140846, -644.595020723456, -1207.6481490085719, -60.75649647973437, -964.2204095380545, -614.6156812476106, -1029.845347727985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5753469669911526, "mean_inference_ms": 1.7302887901138269, "mean_action_processing_ms": 0.8280579586281419, "mean_env_wait_ms": 10.556415342185046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015114068984985352, "StateBufferConnector_ms": 0.010418176651000977, "ViewRequirementAgentConnector_ms": 0.3640458583831787}, "num_episodes": 21, "episode_return_max": -693.2525251995556, "episode_return_min": -4698.0688288298525, "episode_return_mean": -2682.4035953937405, "episodes_this_iter": 21}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1028960, "num_agent_steps_trained": 1028960, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 101.56565709612711, "num_env_steps_trained_throughput_per_sec": 101.56565709612711, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 1028960, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1028960, "timers": {"training_iteration_time_ms": 46912.929, "restore_workers_time_ms": 0.026, "training_step_time_ms": 46912.859, "sample_time_ms": 3344.266, "learn_time_ms": 43513.235, "learn_throughput": 91.926, "synch_weights_time_ms": 52.336}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 1028960, "num_agent_steps_trained": 1028960}, "done": false, "training_iteration": 58, "trial_id": "05c72_00000", "date": "2024-07-26_15-30-58", "timestamp": 1721988058, "time_this_iter_s": 39.395015478134155, "time_total_s": 2877.076544523239, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00dedd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2877.076544523239, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 13.007142857142856, "ram_util_percent": 30.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 173.30884870300292, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.527586658159891, "policy_loss": 0.00047459428798562537, "vf_loss": 4.54283287041982, "vf_explained_var": 0.9824421287377675, "kl": 0.019148249339684845, "entropy": 2.541460603396098, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.728, "num_grad_updates_lifetime": 243975.5, "diff_num_grad_updates_vs_sampler_policy": 1874.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 1044926, "num_agent_steps_trained": 1044926}, "env_runners": {"episode_reward_max": -693.2525251995556, "episode_reward_min": -4698.0688288298525, "episode_reward_mean": -2621.3689652030193, "episode_len_mean": 149.04, "episode_media": {}, "episodes_timesteps_total": 14904, "policy_reward_min": {"policy_0": -1528.653961944682}, "policy_reward_max": {"policy_0": -10.6738717961255}, "policy_reward_mean": {"policy_0": -524.2737930406039}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2096.5766075141887, -2628.31977400432, -3779.221439350393, -3335.7019760563817, -3064.8530884117763, -2665.7667415172186, -2581.9824949374843, -2340.425072038109, -1944.7351556237659, -2077.8953741490222, -1799.7108358932753, -1710.2718128089575, -3108.0816854216405, -2726.8000744102546, -2696.0799911435483, -3523.621608996243, -1903.6622911804516, -1421.9320074991085, -693.2525251995556, -2798.9693363788247, -2361.7887072780645, -1593.6863214774708, -1301.4793706219734, -3215.5510506876417, -3243.6252336328967, -2564.1233229467193, -1763.2567324005522, -3255.1276363268953, -1672.3924926971447, -2469.0693311611567, -2292.3698714652746, -3146.4922115680456, -3003.680979503739, -1828.5090459264832, -3250.781243156137, -1354.8685296446622, -2129.973664108001, -2811.190275492123, -3102.30482576202, -3791.853416267669, -2506.811952917038, -2279.4594415492998, -2703.683155160142, -4698.0688288298525, -2645.234222109332, -2111.6118144785573, -4111.236434949529, -2009.9363551907506, -2226.067348380238, -2163.8492440203013, -2186.84659782574, -3803.816394180179, -2237.943630916701, -1764.6659946824561, -3007.6460235743934, -3480.145727598788, -3193.466556249999, -3316.087011604341, -4276.915274766668, -4329.314987390111, -3752.2488938246897, -2561.3824160597865, -1734.9272143306644, -1919.9685352262595, -1859.4658894558293, -1353.9264778480208, -3021.2481372154334, -2962.4057114993907, -2296.0699797529037, -3175.8976788086093, -2804.42403256239, -3273.0339796826256, -3877.0860840019554, -1560.793533406201, -2784.160095965817, -3214.4709337581776, -3296.5774955031975, -1335.3468658101192, -2348.6844568161314, -2170.3543407274055, -3139.8698664344984, -2845.9016075237455, -2333.723877220016, -4123.592727473496, -1946.5542124070325, -1453.4263926559993, -1270.0204240038638, -2697.097698126646, -1763.911724824404, -1999.0566171070063, -1802.0609726092687, -2633.3822679720793, -2605.3380060484546, -2672.9078757201355, -2607.7976781886787, -3457.885590600499, -3847.420178992672, -2216.6319085426558, -3619.035667465396, -3696.01732309617], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-573.8506704043228, -432.0078884462845, -177.20839705778042, -116.5983933573376, -796.9112582484624, -1286.309815053873, -356.0272432941963, -725.4638383212364, -51.988284011725874, -208.53059332328837, -616.1257210856196, -1031.9752673009098, -1114.5220978733894, -49.51160045710038, -967.0867526333735, -182.9686630397071, -884.3394479892062, -1024.1917341260419, -86.969707106477, -1157.2324237949472, -1528.653961944682, -56.04775166690273, -1148.5787451076928, -210.89281807046672, -120.67981162203056, -650.1860597866719, -43.13959716868003, -1148.4760757378033, -422.68322659781006, -401.2817822262567, -38.20225060052533, -361.45348435373046, -104.41478501097214, -1073.7736878285582, -1004.1382871436954, -135.36085655482745, -106.76095940976046, -80.27698310535614, -1122.620361351143, -895.4059116170226, -763.2553336790137, -29.596717738126237, -167.3900575332184, -571.952717440416, -412.54032923299496, -113.4505562506463, -385.63944898336376, -69.32678459758864, -128.11002782203627, -1381.3685564953869, -983.7700741644868, -173.10492027849813, -447.0202687949703, -22.96972299027331, -172.84584966504744, -368.6835539551549, -246.41343160691613, -490.03541793575744, -145.14185225558649, -459.997557055541, -240.35469246180753, -444.9809900459434, -1133.353167012629, -534.9773667635021, -754.4154691377591, -617.943373122407, -144.44017905013536, -222.02308933576114, -953.456161914479, -788.9372709874754, -60.14422404664733, -94.31116202124454, -1234.087643452172, -196.26410903036572, -1111.2728525931204, -83.06431816865751, -343.77771096184273, -1117.2691265270503, -944.383429426583, -1035.127023912105, -480.6291527870324, -796.7204303679798, -362.03074481263644, -161.43806581488298, -102.84389739791726, -685.4125609691454, -215.19733370532973, -353.0704054133123, -10.6738717961255, -157.57783561519616, -113.01234452606366, -225.88245176763073, -121.97947083555948, -28.648754779264728, -203.72950329103625, -494.06201699670083, -1154.3201769076886, -358.8716662101141, -439.59291359746, -352.12256266685785, -417.98853239729266, -206.7913257393302, -15.762948274346282, -751.480083002823, -969.7658178642715, -552.9618744915167, -111.5021522355979, -821.1649292083258, -66.94218916560149, -41.11517637642819, -440.37272679178176, -146.6185064824262, -241.69000132663558, -258.4520194024385, -214.3461166186927, -565.0239229078373, -339.85739248109195, -1447.5976861437007, -365.4134582979322, -497.6585908570786, -109.64124248852295, -1224.2032352777837, -581.355613936963, -180.07150540940324, -1148.3536365202212, -621.691916623945, -558.8728295453035, -306.60363513615084, -528.5183624350071, -548.4365792063136, -70.08968404323957, -200.4302358907805, -50.93530251638275, -445.2063799861527, -996.5951299639956, -1091.6996982322012, -1160.8092116459468, -169.0096883102369, -29.399295812760307, -804.209742325748, -839.3420672564995, -360.64169265574435, -183.14792526496993, -11.486840883665767, -277.7739666362666, -721.9290124258555, -680.3810849712438, -181.2758817709116, -237.85169273266212, -647.631659260485, -1263.9733137425007, -128.5744753808613, -90.91664350045671, -305.1223433204623, -503.783095520991, -487.6242233654189, -537.1072247954872, -1053.3735526534772, -952.9662129975806, -115.42099775608507, -238.24376640278078, -882.3451197827202, -139.82701554336845, -1265.8094087836207, -477.4556689912492, -660.990036719211, -51.14303707732125, -427.78451026705875, -79.78734622817426, -608.8041156347166, -1224.4044266220374, -343.5890354667985, -609.9212275729163, -16.244914635626888, -1056.6216388587566, -134.07392041125289, -105.61233941122721, -129.07690306984736, -21.149939375484937, -964.9554273768518, -167.1132135840265, -383.02531505257036, -215.28259610569947, -1269.9061225480962, -94.64641681760875, -791.3600380082197, -123.54310673041459, -512.7441934997308, -839.7394995355141, -543.8034377182456, -69.8929355131814, -603.7026191769147, -1098.105503790077, -1279.3549587498624, -51.24880853198682, -987.7248314500171, -465.75176700903256, -1089.0154223142692, -630.8573002845377, -618.5040952098186, -647.256617587737, -96.1556106158477, -1319.6403889630726, -49.780218462872064, -393.97911728750705, -726.8128953274345, -60.637314039886455, -29.28354086656865, -657.1877859836329, -805.5379053317779, -353.87880491889825, -1115.5144910500628, -902.2239736508141, -190.2359470617147, -141.82993847865288, -1465.7550019068972, -583.4827030816543, -742.15492847764, -1262.7850748884262, -643.8911204752287, -863.5844217182722, -978.2862026532463, -423.5778662417129, -164.9213082643718, -214.86442323173046, -398.0055190469393, -849.9102949715758, -793.4416163626976, -55.19240600233704, -15.061978095007916, -641.8382368190322, -545.0558037535028, -1107.623734388346, -1113.6197080395586, -703.0989519490948, -117.59866328932713, -942.088950715397, -146.01278631717946, -24.566730618944295, -779.6692242499031, -716.1846734013866, -758.8062868647339, -99.93052144507055, -227.9691699946833, -423.1766966743644, -40.51420958101862, -561.4753864352373, -138.59530277663006, -960.4924286021762, -462.77191662524064, -478.96212768764605, -53.68571611550161, -932.5492553949933, -61.311279510848166, -660.3382191167499, -696.4727410597619, -490.22667996310656, -695.5173701690546, -1169.954976090021, -751.6446268982316, -85.409489893599, -570.6545492437378, -298.4694999934399, -504.090831140504, -779.3192606454207, -156.01492985612794, -51.42645062351381, -93.74332165783042, -744.4957616164768, -718.9855309285068, -566.3459702955108, -766.4981745196473, -513.9749471929586, -427.45073148469606, -733.3762000815763, -983.4993585774663, -60.79697045772347, -283.4285689778938, -1129.747068037398, -1022.6737615483087, -711.663350471598, -289.8489923729876, -487.983079847588, -482.37660550416456, -1221.5945280536578, -651.2530184804893, -721.6348179448452, -275.3194186105553, -846.575271853176, -821.304484715277, -1184.0876207208998, -280.0394876345052, -522.6340588497964, -1149.3941416883465, -1140.7599658731192, -1197.8115647236891, -35.527516491469484, -1346.0056493727743, -287.90872746743776, -1462.0615293347414, -1056.2255971540537, -15.38129694566647, -448.33036678554794, -1415.2747203553492, -817.0369125840756, -617.9751952356095, -317.57496000237285, -384.0135999311515, -734.7611928973103, -507.05746799334275, -44.944281086601414, -160.3706775867849, -37.62561680699147, -1414.212894284414, -77.77374456587218, -190.7343054736392, -447.73320539698017, -606.487371620221, -133.91408060941748, -541.0995721260023, -286.45961489695884, -376.31714278383157, -581.7393144334462, -215.18034421604045, -399.76947312555154, -219.41664559926252, -108.88352055691108, -147.25393065839185, -28.3854807727564, -849.9869002607002, -1169.4094672666934, -334.3572096584187, -605.1845516523231, -254.5262978587967, -657.7706107792, -913.3519390871344, -54.979022286903515, -147.30707824563729, -998.2019120028756, -848.5657598768386, -869.9316006331344, -482.6251101826825, -670.8725502674637, -197.61599745244297, -75.02472121718174, -659.60884487012, -802.2995469211876, -107.17146963761012, -1453.0425983534592, -153.77521902623153, -134.73854269100093, -1121.5167336574998, -190.60965979785095, -759.1089767938536, -598.450119622182, -657.6511525403581, -319.8391608985654, -1068.1433291061621, -582.8053164140846, -644.595020723456, -1207.6481490085719, -60.75649647973437, -964.2204095380545, -614.6156812476106, -1029.845347727985, -280.8090450855861, -178.1604342491235, -509.7730115150751, -79.88094281818813, -512.1700997382289, -1149.9432418193985, -520.1866412919723, -365.4927738760452, -632.11842150435, -116.41901747404991, -175.7198924820736, -1272.9609303423147, -1124.5162778897595, -516.2690400470434, -125.00479299698819, -845.4592215567382, -1117.5537269548759, -546.2023289859475, -139.47086561991338, -647.8913523857246, -181.13749932775093, -262.71162906555463, -265.8348301016767, -113.05654302603791, -512.6063642890988, -636.5577777043706, -28.934792739361214, -828.9653304723479, -31.380550838689675, -822.8460050613612, -323.4169440150123, -219.45249938468098, -711.541151011176, -891.0307085810159, -24.91303773551974, -1223.7505454004804, -428.8653473460046, -413.4039829876544, -218.39526265827908, -855.4547280420805, -651.8718164052424, -771.2141139393469, -1102.9687728246945, -21.80440411385932, -298.04250024060116, -458.29550242266737, -573.8941978716902, -67.54327975508275, -895.6936032354718, -338.2972939351036, -1422.3644712453356, -38.87089562183078, -772.0737870536237, -1156.599617985413, -733.6839555672918, -1332.8328422408106, -134.8046395049108, -276.41286056016463, -163.16621001556385, -39.337660085581746, -252.7995853596128, -95.86799173978096, -49.95400822289935, -683.3450267268192, -371.45978060688606, -91.12933333757344, -138.2917513498094, -288.428673110552, -148.4800670507496, -603.690599155179, -969.9625297537318, -672.6128481144796, -149.8677720627071, -530.3073496756166, -374.34719852011114, -48.101655533700935, -427.17159149124024, -1086.4237694468725, -59.44920187714615, -142.76550647544323, -78.28328266419359, -801.0049897368536, -584.8964448331442, -239.47362577338035, -295.39827409943496, -225.336086282312, -913.909976262434, -51.82368529037914, -82.09051770255456, -528.9007070715893, -157.79181281865226, -258.023464750154, -857.7784732838433, -88.23971506749464, -1271.5488020519338, -121.91031405098796, -1017.3068303784293, -37.128947582237444, -1155.8390683304071, -273.15284570639363, -161.24621942112782, -591.9758370848028, -641.660943931775, -1025.0264104939627, -252.99846478846823, -352.3933060681479, -161.346130910964, -593.6845320468354, -434.640428889031, -1065.7332802736992, -1174.3495004825068, -753.496936303362, -349.5180400284403, -246.37548678874253, -934.1456269974454, -692.3985434815394, -771.0611666221513, -832.2612791122043, -1029.638654172798, -522.0605356039767, -192.53618839185972, -400.4375709974238, -118.9668988085087, -491.18066053912673, -1013.510589805736, -502.96871149583, -793.4196664259514, -649.8371397173827, -1004.4329576820439, -668.3771921441878, -155.5884734818556, -1047.2444619317669, -1151.7576793923306, -1034.274390825819, -307.15231746439724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.572477444325365, "mean_inference_ms": 1.730881551789089, "mean_action_processing_ms": 0.8271837243899305, "mean_env_wait_ms": 10.54935082250703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014556884765625, "StateBufferConnector_ms": 0.010030269622802734, "ViewRequirementAgentConnector_ms": 0.3473856449127197}, "num_episodes": 27, "episode_return_max": -693.2525251995556, "episode_return_min": -4698.0688288298525, "episode_return_mean": -2621.3689652030193, "episodes_this_iter": 27}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044926, "num_agent_steps_trained": 1044926, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.04218920687366, "num_env_steps_trained_throughput_per_sec": 84.04218920687366, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 1044926, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1044926, "timers": {"training_iteration_time_ms": 46733.631, "restore_workers_time_ms": 0.025, "training_step_time_ms": 46733.562, "sample_time_ms": 3308.787, "learn_time_ms": 43368.23, "learn_throughput": 92.233, "synch_weights_time_ms": 53.484}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 1044926, "num_agent_steps_trained": 1044926}, "done": false, "training_iteration": 59, "trial_id": "05c72_00000", "date": "2024-07-26_15-31-45", "timestamp": 1721988105, "time_this_iter_s": 47.606804609298706, "time_total_s": 2924.683349132538, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805abbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2924.683349132538, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 11.95373134328358, "ram_util_percent": 30.84328358208956}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 148.44801426954803, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.824103569462352, "policy_loss": 0.0008182454819693581, "vf_loss": 4.837621336899825, "vf_explained_var": 0.9812131070307571, "kl": 0.018930958268468308, "entropy": 2.3919808370063484, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.83941605839416, "num_grad_updates_lifetime": 247905.5, "diff_num_grad_updates_vs_sampler_policy": 2054.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 1062440, "num_agent_steps_trained": 1062440}, "env_runners": {"episode_reward_max": -1097.761980971524, "episode_reward_min": -4698.0688288298525, "episode_reward_mean": -2677.681682021029, "episode_len_mean": 150.0, "episode_media": {}, "episodes_timesteps_total": 15000, "policy_reward_min": {"policy_0": -1465.7550019068972}, "policy_reward_max": {"policy_0": 1.431270138558646}, "policy_reward_mean": {"policy_0": -535.536336404206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3003.680979503739, -1828.5090459264832, -3250.781243156137, -1354.8685296446622, -2129.973664108001, -2811.190275492123, -3102.30482576202, -3791.853416267669, -2506.811952917038, -2279.4594415492998, -2703.683155160142, -4698.0688288298525, -2645.234222109332, -2111.6118144785573, -4111.236434949529, -2009.9363551907506, -2226.067348380238, -2163.8492440203013, -2186.84659782574, -3803.816394180179, -2237.943630916701, -1764.6659946824561, -3007.6460235743934, -3480.145727598788, -3193.466556249999, -3316.087011604341, -4276.915274766668, -4329.314987390111, -3752.2488938246897, -2561.3824160597865, -1734.9272143306644, -1919.9685352262595, -1859.4658894558293, -1353.9264778480208, -3021.2481372154334, -2962.4057114993907, -2296.0699797529037, -3175.8976788086093, -2804.42403256239, -3273.0339796826256, -3877.0860840019554, -1560.793533406201, -2784.160095965817, -3214.4709337581776, -3296.5774955031975, -1335.3468658101192, -2348.6844568161314, -2170.3543407274055, -3139.8698664344984, -2845.9016075237455, -2333.723877220016, -4123.592727473496, -1946.5542124070325, -1453.4263926559993, -1270.0204240038638, -2697.097698126646, -1763.911724824404, -1999.0566171070063, -1802.0609726092687, -2633.3822679720793, -2605.3380060484546, -2672.9078757201355, -2607.7976781886787, -3457.885590600499, -3847.420178992672, -2216.6319085426558, -3619.035667465396, -3696.01732309617, -2663.7698738869663, -1878.8279938394458, -2893.3230001920515, -1618.2009288069917, -2159.9482331547847, -3492.6561011799945, -3121.676793238455, -2086.831558722651, -1343.6269286702823, -3588.2906898249626, -3767.9291212185694, -2297.1306239061414, -3551.8597289914887, -3379.573403341439, -2579.702065418845, -3128.533077864027, -1495.4248849978037, -2844.681279923318, -1935.1495283086028, -3530.1460503546523, -2986.8438661787795, -1532.4901151944925, -1740.2060931603162, -4306.896416474362, -2628.120004716085, -1701.562026672097, -2720.282129619543, -2742.0941044320775, -4518.2894611583015, -1887.3777077065458, -2188.888084473811, -1097.761980971524], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-238.24376640278078, -882.3451197827202, -139.82701554336845, -1265.8094087836207, -477.4556689912492, -660.990036719211, -51.14303707732125, -427.78451026705875, -79.78734622817426, -608.8041156347166, -1224.4044266220374, -343.5890354667985, -609.9212275729163, -16.244914635626888, -1056.6216388587566, -134.07392041125289, -105.61233941122721, -129.07690306984736, -21.149939375484937, -964.9554273768518, -167.1132135840265, -383.02531505257036, -215.28259610569947, -1269.9061225480962, -94.64641681760875, -791.3600380082197, -123.54310673041459, -512.7441934997308, -839.7394995355141, -543.8034377182456, -69.8929355131814, -603.7026191769147, -1098.105503790077, -1279.3549587498624, -51.24880853198682, -987.7248314500171, -465.75176700903256, -1089.0154223142692, -630.8573002845377, -618.5040952098186, -647.256617587737, -96.1556106158477, -1319.6403889630726, -49.780218462872064, -393.97911728750705, -726.8128953274345, -60.637314039886455, -29.28354086656865, -657.1877859836329, -805.5379053317779, -353.87880491889825, -1115.5144910500628, -902.2239736508141, -190.2359470617147, -141.82993847865288, -1465.7550019068972, -583.4827030816543, -742.15492847764, -1262.7850748884262, -643.8911204752287, -863.5844217182722, -978.2862026532463, -423.5778662417129, -164.9213082643718, -214.86442323173046, -398.0055190469393, -849.9102949715758, -793.4416163626976, -55.19240600233704, -15.061978095007916, -641.8382368190322, -545.0558037535028, -1107.623734388346, -1113.6197080395586, -703.0989519490948, -117.59866328932713, -942.088950715397, -146.01278631717946, -24.566730618944295, -779.6692242499031, -716.1846734013866, -758.8062868647339, -99.93052144507055, -227.9691699946833, -423.1766966743644, -40.51420958101862, -561.4753864352373, -138.59530277663006, -960.4924286021762, -462.77191662524064, -478.96212768764605, -53.68571611550161, -932.5492553949933, -61.311279510848166, -660.3382191167499, -696.4727410597619, -490.22667996310656, -695.5173701690546, -1169.954976090021, -751.6446268982316, -85.409489893599, -570.6545492437378, -298.4694999934399, -504.090831140504, -779.3192606454207, -156.01492985612794, -51.42645062351381, -93.74332165783042, -744.4957616164768, -718.9855309285068, -566.3459702955108, -766.4981745196473, -513.9749471929586, -427.45073148469606, -733.3762000815763, -983.4993585774663, -60.79697045772347, -283.4285689778938, -1129.747068037398, -1022.6737615483087, -711.663350471598, -289.8489923729876, -487.983079847588, -482.37660550416456, -1221.5945280536578, -651.2530184804893, -721.6348179448452, -275.3194186105553, -846.575271853176, -821.304484715277, -1184.0876207208998, -280.0394876345052, -522.6340588497964, -1149.3941416883465, -1140.7599658731192, -1197.8115647236891, -35.527516491469484, -1346.0056493727743, -287.90872746743776, -1462.0615293347414, -1056.2255971540537, -15.38129694566647, -448.33036678554794, -1415.2747203553492, -817.0369125840756, -617.9751952356095, -317.57496000237285, -384.0135999311515, -734.7611928973103, -507.05746799334275, -44.944281086601414, -160.3706775867849, -37.62561680699147, -1414.212894284414, -77.77374456587218, -190.7343054736392, -447.73320539698017, -606.487371620221, -133.91408060941748, -541.0995721260023, -286.45961489695884, -376.31714278383157, -581.7393144334462, -215.18034421604045, -399.76947312555154, -219.41664559926252, -108.88352055691108, -147.25393065839185, -28.3854807727564, -849.9869002607002, -1169.4094672666934, -334.3572096584187, -605.1845516523231, -254.5262978587967, -657.7706107792, -913.3519390871344, -54.979022286903515, -147.30707824563729, -998.2019120028756, -848.5657598768386, -869.9316006331344, -482.6251101826825, -670.8725502674637, -197.61599745244297, -75.02472121718174, -659.60884487012, -802.2995469211876, -107.17146963761012, -1453.0425983534592, -153.77521902623153, -134.73854269100093, -1121.5167336574998, -190.60965979785095, -759.1089767938536, -598.450119622182, -657.6511525403581, -319.8391608985654, -1068.1433291061621, -582.8053164140846, -644.595020723456, -1207.6481490085719, -60.75649647973437, -964.2204095380545, -614.6156812476106, -1029.845347727985, -280.8090450855861, -178.1604342491235, -509.7730115150751, -79.88094281818813, -512.1700997382289, -1149.9432418193985, -520.1866412919723, -365.4927738760452, -632.11842150435, -116.41901747404991, -175.7198924820736, -1272.9609303423147, -1124.5162778897595, -516.2690400470434, -125.00479299698819, -845.4592215567382, -1117.5537269548759, -546.2023289859475, -139.47086561991338, -647.8913523857246, -181.13749932775093, -262.71162906555463, -265.8348301016767, -113.05654302603791, -512.6063642890988, -636.5577777043706, -28.934792739361214, -828.9653304723479, -31.380550838689675, -822.8460050613612, -323.4169440150123, -219.45249938468098, -711.541151011176, -891.0307085810159, -24.91303773551974, -1223.7505454004804, -428.8653473460046, -413.4039829876544, -218.39526265827908, -855.4547280420805, -651.8718164052424, -771.2141139393469, -1102.9687728246945, -21.80440411385932, -298.04250024060116, -458.29550242266737, -573.8941978716902, -67.54327975508275, -895.6936032354718, -338.2972939351036, -1422.3644712453356, -38.87089562183078, -772.0737870536237, -1156.599617985413, -733.6839555672918, -1332.8328422408106, -134.8046395049108, -276.41286056016463, -163.16621001556385, -39.337660085581746, -252.7995853596128, -95.86799173978096, -49.95400822289935, -683.3450267268192, -371.45978060688606, -91.12933333757344, -138.2917513498094, -288.428673110552, -148.4800670507496, -603.690599155179, -969.9625297537318, -672.6128481144796, -149.8677720627071, -530.3073496756166, -374.34719852011114, -48.101655533700935, -427.17159149124024, -1086.4237694468725, -59.44920187714615, -142.76550647544323, -78.28328266419359, -801.0049897368536, -584.8964448331442, -239.47362577338035, -295.39827409943496, -225.336086282312, -913.909976262434, -51.82368529037914, -82.09051770255456, -528.9007070715893, -157.79181281865226, -258.023464750154, -857.7784732838433, -88.23971506749464, -1271.5488020519338, -121.91031405098796, -1017.3068303784293, -37.128947582237444, -1155.8390683304071, -273.15284570639363, -161.24621942112782, -591.9758370848028, -641.660943931775, -1025.0264104939627, -252.99846478846823, -352.3933060681479, -161.346130910964, -593.6845320468354, -434.640428889031, -1065.7332802736992, -1174.3495004825068, -753.496936303362, -349.5180400284403, -246.37548678874253, -934.1456269974454, -692.3985434815394, -771.0611666221513, -832.2612791122043, -1029.638654172798, -522.0605356039767, -192.53618839185972, -400.4375709974238, -118.9668988085087, -491.18066053912673, -1013.510589805736, -502.96871149583, -793.4196664259514, -649.8371397173827, -1004.4329576820439, -668.3771921441878, -155.5884734818556, -1047.2444619317669, -1151.7576793923306, -1034.274390825819, -307.15231746439724, -686.7279182782452, -151.0699177647289, -707.949158554964, 1.431270138558646, -1119.454149427585, -175.71265151486173, -757.9527986280892, -100.02654639683244, -707.3347675943575, -137.80122970530456, -786.478243052352, -275.531535608742, -891.8362661160407, -160.7036022669308, -778.7733531479848, -651.9171576798223, -297.2181312058307, -386.36266223827647, -282.37761665353827, -0.3253610295235573, -934.739504637484, -362.7500448345462, -276.3052882817139, -276.75969226073886, -309.39370314030276, -357.6318501788607, -1166.4424667779742, -733.970297037137, -3.0982787381016714, -1231.5132084479199, -248.2887694487712, -648.3772864538123, -548.1639325732895, -1071.1989209918186, -605.6478837707617, -92.19230586181018, -996.4417876875611, -145.10884766609334, -364.7112706322918, -488.3773468748956, -366.5157430156849, -20.65212108079737, -87.74625945458257, -13.209697555808232, -855.5031075634088, -620.7893301594813, -1034.7905394033794, -417.3807257657975, -77.00505242194326, -1438.3250420743616, -804.7868468483174, -1259.8821938623653, -709.5937967443499, -632.0343245753652, -361.63195918817155, -4.392927988600838, -986.2849972061283, -395.8986183417313, -38.11069008621334, -872.4433902834656, -941.8526265364961, -440.61571894077, -1099.7722544007158, -913.3267607803425, -156.29236833316, -620.4176636353002, -491.3775608337289, -606.1271968923472, -1208.037189462049, -453.6137925180156, -467.16676786434886, -298.3612129936891, -948.8601789332995, -617.8229343082005, -247.49097131930515, -325.65005659723755, -164.02584479003627, -969.9446953073208, -1158.3788589304315, -510.5336222389994, -52.57644300399381, -494.33629373002907, -148.6303905234495, -350.56301954069244, -449.3187381996382, -1237.1191351921334, -526.9600242600899, -49.30369377243779, -118.43735852473054, -912.861068173926, -324.8674076208732, -564.1266969121631, -14.440217218018718, -797.4187818366712, -234.29642472087485, -839.117851461763, -133.39935933093014, -390.72931752579103, -874.6376473751785, -1292.2618746609853, -676.3855939096695, -1110.8692934862836, -842.1434364856755, -136.82877664450422, -220.61676565264708, -70.77928702438098, -255.32810905191587, -256.74056886490916, -421.8059161666117, -527.8362340866756, -411.3012462357112, -493.82165840118085, -227.21558140872705, -525.3437669467677, -82.52384016792831, -985.0594233574011, -595.9755240533644, -940.0746430363565, -917.0692740924989, -868.7175519347417, -86.20793302504896, -907.6758468312555, -158.28780235743375, -751.9055920413213, -724.0428304610285, -789.7652938578615, -107.93642614920891, -83.7782543664517, -132.15287839543572, -587.9291739031404, -430.3664885651492, -574.625617592858, -792.2303727182612, -115.45714346023662, -807.60250728304, -507.88161383943714, -751.1950820384168, -1223.7507266994203, -29.975692893318477, -229.29098896148687, -1084.1232056537992, -1367.3302861529492, -780.2770893195116, -1262.0846803823788, -24.474199649665444, -329.26811429641117, -137.98553025571613, -711.1578112550496, -500.0239327018951, -208.94231919747713, -145.78577412079278, -499.8529371028072, -262.8089196175582, -1102.314570200198, -178.1258834324546, -121.31657447080244, -202.75461338421565, -57.85198512640049, -13.407657532422363, -702.4311504576831]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5702357611964215, "mean_inference_ms": 1.7305966887176325, "mean_action_processing_ms": 0.8264352272755856, "mean_env_wait_ms": 10.535824036294958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014266014099121094, "StateBufferConnector_ms": 0.010069847106933594, "ViewRequirementAgentConnector_ms": 0.3489973545074463}, "num_episodes": 32, "episode_return_max": -1097.761980971524, "episode_return_min": -4698.0688288298525, "episode_return_mean": -2677.681682021029, "episodes_this_iter": 32}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1062440, "num_agent_steps_trained": 1062440, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.79672980868894, "num_env_steps_trained_throughput_per_sec": 71.79672980868894, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 1062440, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1062440, "timers": {"training_iteration_time_ms": 47418.299, "restore_workers_time_ms": 0.025, "training_step_time_ms": 47418.229, "sample_time_ms": 3303.923, "learn_time_ms": 44058.404, "learn_throughput": 90.789, "synch_weights_time_ms": 52.929}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 1062440, "num_agent_steps_trained": 1062440}, "done": false, "training_iteration": 60, "trial_id": "05c72_00000", "date": "2024-07-26_15-32-41", "timestamp": 1721988161, "time_this_iter_s": 55.723915100097656, "time_total_s": 2980.4072642326355, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00dcee0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2980.4072642326355, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 11.146835443037974, "ram_util_percent": 30.729113924050626}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.36163583239858, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.802787309806804, "policy_loss": -0.002013440522502159, "vf_loss": 4.8205647151927, "vf_explained_var": 0.9849681688575294, "kl": 0.0165063494768298, "entropy": 2.412030979560742, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.76377952755905, "num_grad_updates_lifetime": 251865.5, "diff_num_grad_updates_vs_sampler_policy": 1904.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 1078666, "num_agent_steps_trained": 1078666}, "env_runners": {"episode_reward_max": -975.0301823027069, "episode_reward_min": -4518.2894611583015, "episode_reward_mean": -2635.3793712587167, "episode_len_mean": 149.85, "episode_media": {}, "episodes_timesteps_total": 14985, "policy_reward_min": {"policy_0": -1526.152738067288}, "policy_reward_max": {"policy_0": 1.431270138558646}, "policy_reward_mean": {"policy_0": -527.0758742517434}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1764.6659946824561, -3007.6460235743934, -3480.145727598788, -3193.466556249999, -3316.087011604341, -4276.915274766668, -4329.314987390111, -3752.2488938246897, -2561.3824160597865, -1734.9272143306644, -1919.9685352262595, -1859.4658894558293, -1353.9264778480208, -3021.2481372154334, -2962.4057114993907, -2296.0699797529037, -3175.8976788086093, -2804.42403256239, -3273.0339796826256, -3877.0860840019554, -1560.793533406201, -2784.160095965817, -3214.4709337581776, -3296.5774955031975, -1335.3468658101192, -2348.6844568161314, -2170.3543407274055, -3139.8698664344984, -2845.9016075237455, -2333.723877220016, -4123.592727473496, -1946.5542124070325, -1453.4263926559993, -1270.0204240038638, -2697.097698126646, -1763.911724824404, -1999.0566171070063, -1802.0609726092687, -2633.3822679720793, -2605.3380060484546, -2672.9078757201355, -2607.7976781886787, -3457.885590600499, -3847.420178992672, -2216.6319085426558, -3619.035667465396, -3696.01732309617, -2663.7698738869663, -1878.8279938394458, -2893.3230001920515, -1618.2009288069917, -2159.9482331547847, -3492.6561011799945, -3121.676793238455, -2086.831558722651, -1343.6269286702823, -3588.2906898249626, -3767.9291212185694, -2297.1306239061414, -3551.8597289914887, -3379.573403341439, -2579.702065418845, -3128.533077864027, -1495.4248849978037, -2844.681279923318, -1935.1495283086028, -3530.1460503546523, -2986.8438661787795, -1532.4901151944925, -1740.2060931603162, -4306.896416474362, -2628.120004716085, -1701.562026672097, -2720.282129619543, -2742.0941044320775, -4518.2894611583015, -1887.3777077065458, -2188.888084473811, -1097.761980971524, -3156.1284524109706, -1830.2882058242628, -2127.5547296528116, -3112.3394492139923, -2515.1106405198084, -1079.075626928485, -3069.7487054770713, -2164.4918122246686, -975.0301823027069, -1437.956801567323, -2524.6385787595796, -2760.2199072591275, -3448.720191587148, -2524.6040569775464, -2515.0113901334457, -2331.0762350980563, -2237.361238797432, -3520.538195460299, -2780.500015310586, -4502.20882742537, -2114.8930812064746], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-156.01492985612794, -51.42645062351381, -93.74332165783042, -744.4957616164768, -718.9855309285068, -566.3459702955108, -766.4981745196473, -513.9749471929586, -427.45073148469606, -733.3762000815763, -983.4993585774663, -60.79697045772347, -283.4285689778938, -1129.747068037398, -1022.6737615483087, -711.663350471598, -289.8489923729876, -487.983079847588, -482.37660550416456, -1221.5945280536578, -651.2530184804893, -721.6348179448452, -275.3194186105553, -846.575271853176, -821.304484715277, -1184.0876207208998, -280.0394876345052, -522.6340588497964, -1149.3941416883465, -1140.7599658731192, -1197.8115647236891, -35.527516491469484, -1346.0056493727743, -287.90872746743776, -1462.0615293347414, -1056.2255971540537, -15.38129694566647, -448.33036678554794, -1415.2747203553492, -817.0369125840756, -617.9751952356095, -317.57496000237285, -384.0135999311515, -734.7611928973103, -507.05746799334275, -44.944281086601414, -160.3706775867849, -37.62561680699147, -1414.212894284414, -77.77374456587218, -190.7343054736392, -447.73320539698017, -606.487371620221, -133.91408060941748, -541.0995721260023, -286.45961489695884, -376.31714278383157, -581.7393144334462, -215.18034421604045, -399.76947312555154, -219.41664559926252, -108.88352055691108, -147.25393065839185, -28.3854807727564, -849.9869002607002, -1169.4094672666934, -334.3572096584187, -605.1845516523231, -254.5262978587967, -657.7706107792, -913.3519390871344, -54.979022286903515, -147.30707824563729, -998.2019120028756, -848.5657598768386, -869.9316006331344, -482.6251101826825, -670.8725502674637, -197.61599745244297, -75.02472121718174, -659.60884487012, -802.2995469211876, -107.17146963761012, -1453.0425983534592, -153.77521902623153, -134.73854269100093, -1121.5167336574998, -190.60965979785095, -759.1089767938536, -598.450119622182, -657.6511525403581, -319.8391608985654, -1068.1433291061621, -582.8053164140846, -644.595020723456, -1207.6481490085719, -60.75649647973437, -964.2204095380545, -614.6156812476106, -1029.845347727985, -280.8090450855861, -178.1604342491235, -509.7730115150751, -79.88094281818813, -512.1700997382289, -1149.9432418193985, -520.1866412919723, -365.4927738760452, -632.11842150435, -116.41901747404991, -175.7198924820736, -1272.9609303423147, -1124.5162778897595, -516.2690400470434, -125.00479299698819, -845.4592215567382, -1117.5537269548759, -546.2023289859475, -139.47086561991338, -647.8913523857246, -181.13749932775093, -262.71162906555463, -265.8348301016767, -113.05654302603791, -512.6063642890988, -636.5577777043706, -28.934792739361214, -828.9653304723479, -31.380550838689675, -822.8460050613612, -323.4169440150123, -219.45249938468098, -711.541151011176, -891.0307085810159, -24.91303773551974, -1223.7505454004804, -428.8653473460046, -413.4039829876544, -218.39526265827908, -855.4547280420805, -651.8718164052424, -771.2141139393469, -1102.9687728246945, -21.80440411385932, -298.04250024060116, -458.29550242266737, -573.8941978716902, -67.54327975508275, -895.6936032354718, -338.2972939351036, -1422.3644712453356, -38.87089562183078, -772.0737870536237, -1156.599617985413, -733.6839555672918, -1332.8328422408106, -134.8046395049108, -276.41286056016463, -163.16621001556385, -39.337660085581746, -252.7995853596128, -95.86799173978096, -49.95400822289935, -683.3450267268192, -371.45978060688606, -91.12933333757344, -138.2917513498094, -288.428673110552, -148.4800670507496, -603.690599155179, -969.9625297537318, -672.6128481144796, -149.8677720627071, -530.3073496756166, -374.34719852011114, -48.101655533700935, -427.17159149124024, -1086.4237694468725, -59.44920187714615, -142.76550647544323, -78.28328266419359, -801.0049897368536, -584.8964448331442, -239.47362577338035, -295.39827409943496, -225.336086282312, -913.909976262434, -51.82368529037914, -82.09051770255456, -528.9007070715893, -157.79181281865226, -258.023464750154, -857.7784732838433, -88.23971506749464, -1271.5488020519338, -121.91031405098796, -1017.3068303784293, -37.128947582237444, -1155.8390683304071, -273.15284570639363, -161.24621942112782, -591.9758370848028, -641.660943931775, -1025.0264104939627, -252.99846478846823, -352.3933060681479, -161.346130910964, -593.6845320468354, -434.640428889031, -1065.7332802736992, -1174.3495004825068, -753.496936303362, -349.5180400284403, -246.37548678874253, -934.1456269974454, -692.3985434815394, -771.0611666221513, -832.2612791122043, -1029.638654172798, -522.0605356039767, -192.53618839185972, -400.4375709974238, -118.9668988085087, -491.18066053912673, -1013.510589805736, -502.96871149583, -793.4196664259514, -649.8371397173827, -1004.4329576820439, -668.3771921441878, -155.5884734818556, -1047.2444619317669, -1151.7576793923306, -1034.274390825819, -307.15231746439724, -686.7279182782452, -151.0699177647289, -707.949158554964, 1.431270138558646, -1119.454149427585, -175.71265151486173, -757.9527986280892, -100.02654639683244, -707.3347675943575, -137.80122970530456, -786.478243052352, -275.531535608742, -891.8362661160407, -160.7036022669308, -778.7733531479848, -651.9171576798223, -297.2181312058307, -386.36266223827647, -282.37761665353827, -0.3253610295235573, -934.739504637484, -362.7500448345462, -276.3052882817139, -276.75969226073886, -309.39370314030276, -357.6318501788607, -1166.4424667779742, -733.970297037137, -3.0982787381016714, -1231.5132084479199, -248.2887694487712, -648.3772864538123, -548.1639325732895, -1071.1989209918186, -605.6478837707617, -92.19230586181018, -996.4417876875611, -145.10884766609334, -364.7112706322918, -488.3773468748956, -366.5157430156849, -20.65212108079737, -87.74625945458257, -13.209697555808232, -855.5031075634088, -620.7893301594813, -1034.7905394033794, -417.3807257657975, -77.00505242194326, -1438.3250420743616, -804.7868468483174, -1259.8821938623653, -709.5937967443499, -632.0343245753652, -361.63195918817155, -4.392927988600838, -986.2849972061283, -395.8986183417313, -38.11069008621334, -872.4433902834656, -941.8526265364961, -440.61571894077, -1099.7722544007158, -913.3267607803425, -156.29236833316, -620.4176636353002, -491.3775608337289, -606.1271968923472, -1208.037189462049, -453.6137925180156, -467.16676786434886, -298.3612129936891, -948.8601789332995, -617.8229343082005, -247.49097131930515, -325.65005659723755, -164.02584479003627, -969.9446953073208, -1158.3788589304315, -510.5336222389994, -52.57644300399381, -494.33629373002907, -148.6303905234495, -350.56301954069244, -449.3187381996382, -1237.1191351921334, -526.9600242600899, -49.30369377243779, -118.43735852473054, -912.861068173926, -324.8674076208732, -564.1266969121631, -14.440217218018718, -797.4187818366712, -234.29642472087485, -839.117851461763, -133.39935933093014, -390.72931752579103, -874.6376473751785, -1292.2618746609853, -676.3855939096695, -1110.8692934862836, -842.1434364856755, -136.82877664450422, -220.61676565264708, -70.77928702438098, -255.32810905191587, -256.74056886490916, -421.8059161666117, -527.8362340866756, -411.3012462357112, -493.82165840118085, -227.21558140872705, -525.3437669467677, -82.52384016792831, -985.0594233574011, -595.9755240533644, -940.0746430363565, -917.0692740924989, -868.7175519347417, -86.20793302504896, -907.6758468312555, -158.28780235743375, -751.9055920413213, -724.0428304610285, -789.7652938578615, -107.93642614920891, -83.7782543664517, -132.15287839543572, -587.9291739031404, -430.3664885651492, -574.625617592858, -792.2303727182612, -115.45714346023662, -807.60250728304, -507.88161383943714, -751.1950820384168, -1223.7507266994203, -29.975692893318477, -229.29098896148687, -1084.1232056537992, -1367.3302861529492, -780.2770893195116, -1262.0846803823788, -24.474199649665444, -329.26811429641117, -137.98553025571613, -711.1578112550496, -500.0239327018951, -208.94231919747713, -145.78577412079278, -499.8529371028072, -262.8089196175582, -1102.314570200198, -178.1258834324546, -121.31657447080244, -202.75461338421565, -57.85198512640049, -13.407657532422363, -702.4311504576831, -166.0096977655109, -560.2537138331843, -494.44594682174613, -807.0280677539693, -1128.3910262365625, -515.3543754412763, -270.5914366874626, -536.8609824416832, -295.7091675657456, -211.77224368809541, -762.8170367851053, -840.5604338177087, -264.75517912168766, -70.51982315117817, -188.90225677713113, -66.79522859899211, -1249.9711563450442, -1177.6640665861612, -184.6057387536724, -433.3032589301219, -452.1392321075974, -301.52086133146133, -379.77219191292323, -938.3655600538041, -443.3127951140207, -268.8532345973244, -186.56483525839442, -445.5108257631639, -101.79688809528783, -76.34984321431419, -50.874888746599396, -1118.02518053523, -742.5870974770074, -221.1890050809082, -937.0725336373281, -344.0559091725646, -863.6113693668689, -242.63948819048755, -111.22906217704362, -602.9559833177038, -70.25012232607388, -139.90398255205076, -207.76198828488594, -489.98708545332516, -67.12700368637051, -141.4611463096092, -796.8456817628187, -276.8510201042684, -135.75620922653104, -87.04274416409581, -1125.0456116145228, -378.29922855613125, -192.06674515641254, -132.67445961552275, -696.5525338169901, -496.46631426265424, -1210.2604745621989, -330.93922386585376, -698.5880836117814, -23.965810956640627, -425.6879966404753, -1526.152738067288, -209.54982645489306, -307.4652344149373, -979.8643960095555, -595.9130275888887, -40.79354854435183, -681.3124358400837, -1057.7712474988462, -148.813797505375, -781.5259955615461, -53.16341199205873, -98.05873283732745, -791.9568775200802, -790.3063722224347, -548.2945433651173, -445.8936661157919, -339.18342892125406, -95.67004145357046, -902.0345552423227, -745.9876823498303, -229.42813966430614, -357.9478158836273, -812.5206590764528, -91.47694182321503, -1082.2892991844635, -953.0127020851846, -55.828247390646084, -599.894686814432, -829.5132599855764, -386.7590983955817, -774.8043268749574, -801.8376172197086, -738.955380678467, -78.14359214187107, -1145.025693442134, -165.86590963208948, -977.0284642318578, -1495.197726607278, -719.0910335120122, -71.14107166165743, -123.26522967751389, -144.44968222891572, -795.7304316109664, -980.3066660274208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5709392449682023, "mean_inference_ms": 1.7302735852332136, "mean_action_processing_ms": 0.8248248709373097, "mean_env_wait_ms": 10.529933099919576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013554573059082031, "StateBufferConnector_ms": 0.009833574295043945, "ViewRequirementAgentConnector_ms": 0.3390631675720215}, "num_episodes": 21, "episode_return_max": -975.0301823027069, "episode_return_min": -4518.2894611583015, "episode_return_mean": -2635.3793712587167, "episodes_this_iter": 21}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1078666, "num_agent_steps_trained": 1078666, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.62100624032769, "num_env_steps_trained_throughput_per_sec": 80.62100624032769, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 1078666, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1078666, "timers": {"training_iteration_time_ms": 47872.566, "restore_workers_time_ms": 0.024, "training_step_time_ms": 47872.497, "sample_time_ms": 3287.457, "learn_time_ms": 44528.982, "learn_throughput": 89.829, "synch_weights_time_ms": 53.068}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 1078666, "num_agent_steps_trained": 1078666}, "done": false, "training_iteration": 61, "trial_id": "05c72_00000", "date": "2024-07-26_15-33-31", "timestamp": 1721988211, "time_this_iter_s": 49.627117395401, "time_total_s": 3030.0343816280365, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d3c3b29000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3030.0343816280365, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 11.535211267605636, "ram_util_percent": 30.59999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.8928101848084, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.69143159819238, "policy_loss": -0.002957577395517333, "vf_loss": 4.710726396360515, "vf_explained_var": 0.984225623342726, "kl": 0.017324635815306532, "entropy": 2.5107816109245205, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.47407407407407, "num_grad_updates_lifetime": 255795.5, "diff_num_grad_updates_vs_sampler_policy": 2024.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 1095875, "num_agent_steps_trained": 1095875}, "env_runners": {"episode_reward_max": -975.0301823027069, "episode_reward_min": -4518.2894611583015, "episode_reward_mean": -2519.0033130756474, "episode_len_mean": 148.95, "episode_media": {}, "episodes_timesteps_total": 14895, "policy_reward_min": {"policy_0": -1526.152738067288}, "policy_reward_max": {"policy_0": 1.431270138558646}, "policy_reward_mean": {"policy_0": -503.8006626151295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2333.723877220016, -4123.592727473496, -1946.5542124070325, -1453.4263926559993, -1270.0204240038638, -2697.097698126646, -1763.911724824404, -1999.0566171070063, -1802.0609726092687, -2633.3822679720793, -2605.3380060484546, -2672.9078757201355, -2607.7976781886787, -3457.885590600499, -3847.420178992672, -2216.6319085426558, -3619.035667465396, -3696.01732309617, -2663.7698738869663, -1878.8279938394458, -2893.3230001920515, -1618.2009288069917, -2159.9482331547847, -3492.6561011799945, -3121.676793238455, -2086.831558722651, -1343.6269286702823, -3588.2906898249626, -3767.9291212185694, -2297.1306239061414, -3551.8597289914887, -3379.573403341439, -2579.702065418845, -3128.533077864027, -1495.4248849978037, -2844.681279923318, -1935.1495283086028, -3530.1460503546523, -2986.8438661787795, -1532.4901151944925, -1740.2060931603162, -4306.896416474362, -2628.120004716085, -1701.562026672097, -2720.282129619543, -2742.0941044320775, -4518.2894611583015, -1887.3777077065458, -2188.888084473811, -1097.761980971524, -3156.1284524109706, -1830.2882058242628, -2127.5547296528116, -3112.3394492139923, -2515.1106405198084, -1079.075626928485, -3069.7487054770713, -2164.4918122246686, -975.0301823027069, -1437.956801567323, -2524.6385787595796, -2760.2199072591275, -3448.720191587148, -2524.6040569775464, -2515.0113901334457, -2331.0762350980563, -2237.361238797432, -3520.538195460299, -2780.500015310586, -4502.20882742537, -2114.8930812064746, -2876.121885575665, -2133.9511348972565, -3309.463195991163, -2964.230134188491, -2408.216341095906, -2842.8720899790283, -1688.3890225828031, -2341.7272384881544, -3461.2363382169597, -1343.6172048399383, -2281.995456624913, -2729.0596027903207, -2304.1401657738024, -989.5235829595568, -2876.6471868348326, -4123.428576321599, -2687.6191767827636, -1491.5528479799573, -2591.460549916229, -989.215143196475, -2265.163228569032, -1881.3814965113197, -4440.110668199674, -2763.2711295828335, -2554.253247766777, -2260.4532289977933, -2452.7473384504056, -977.4024788070317, -989.6302918530122], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 99, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-458.29550242266737, -573.8941978716902, -67.54327975508275, -895.6936032354718, -338.2972939351036, -1422.3644712453356, -38.87089562183078, -772.0737870536237, -1156.599617985413, -733.6839555672918, -1332.8328422408106, -134.8046395049108, -276.41286056016463, -163.16621001556385, -39.337660085581746, -252.7995853596128, -95.86799173978096, -49.95400822289935, -683.3450267268192, -371.45978060688606, -91.12933333757344, -138.2917513498094, -288.428673110552, -148.4800670507496, -603.690599155179, -969.9625297537318, -672.6128481144796, -149.8677720627071, -530.3073496756166, -374.34719852011114, -48.101655533700935, -427.17159149124024, -1086.4237694468725, -59.44920187714615, -142.76550647544323, -78.28328266419359, -801.0049897368536, -584.8964448331442, -239.47362577338035, -295.39827409943496, -225.336086282312, -913.909976262434, -51.82368529037914, -82.09051770255456, -528.9007070715893, -157.79181281865226, -258.023464750154, -857.7784732838433, -88.23971506749464, -1271.5488020519338, -121.91031405098796, -1017.3068303784293, -37.128947582237444, -1155.8390683304071, -273.15284570639363, -161.24621942112782, -591.9758370848028, -641.660943931775, -1025.0264104939627, -252.99846478846823, -352.3933060681479, -161.346130910964, -593.6845320468354, -434.640428889031, -1065.7332802736992, -1174.3495004825068, -753.496936303362, -349.5180400284403, -246.37548678874253, -934.1456269974454, -692.3985434815394, -771.0611666221513, -832.2612791122043, -1029.638654172798, -522.0605356039767, -192.53618839185972, -400.4375709974238, -118.9668988085087, -491.18066053912673, -1013.510589805736, -502.96871149583, -793.4196664259514, -649.8371397173827, -1004.4329576820439, -668.3771921441878, -155.5884734818556, -1047.2444619317669, -1151.7576793923306, -1034.274390825819, -307.15231746439724, -686.7279182782452, -151.0699177647289, -707.949158554964, 1.431270138558646, -1119.454149427585, -175.71265151486173, -757.9527986280892, -100.02654639683244, -707.3347675943575, -137.80122970530456, -786.478243052352, -275.531535608742, -891.8362661160407, -160.7036022669308, -778.7733531479848, -651.9171576798223, -297.2181312058307, -386.36266223827647, -282.37761665353827, -0.3253610295235573, -934.739504637484, -362.7500448345462, -276.3052882817139, -276.75969226073886, -309.39370314030276, -357.6318501788607, -1166.4424667779742, -733.970297037137, -3.0982787381016714, -1231.5132084479199, -248.2887694487712, -648.3772864538123, -548.1639325732895, -1071.1989209918186, -605.6478837707617, -92.19230586181018, -996.4417876875611, -145.10884766609334, -364.7112706322918, -488.3773468748956, -366.5157430156849, -20.65212108079737, -87.74625945458257, -13.209697555808232, -855.5031075634088, -620.7893301594813, -1034.7905394033794, -417.3807257657975, -77.00505242194326, -1438.3250420743616, -804.7868468483174, -1259.8821938623653, -709.5937967443499, -632.0343245753652, -361.63195918817155, -4.392927988600838, -986.2849972061283, -395.8986183417313, -38.11069008621334, -872.4433902834656, -941.8526265364961, -440.61571894077, -1099.7722544007158, -913.3267607803425, -156.29236833316, -620.4176636353002, -491.3775608337289, -606.1271968923472, -1208.037189462049, -453.6137925180156, -467.16676786434886, -298.3612129936891, -948.8601789332995, -617.8229343082005, -247.49097131930515, -325.65005659723755, -164.02584479003627, -969.9446953073208, -1158.3788589304315, -510.5336222389994, -52.57644300399381, -494.33629373002907, -148.6303905234495, -350.56301954069244, -449.3187381996382, -1237.1191351921334, -526.9600242600899, -49.30369377243779, -118.43735852473054, -912.861068173926, -324.8674076208732, -564.1266969121631, -14.440217218018718, -797.4187818366712, -234.29642472087485, -839.117851461763, -133.39935933093014, -390.72931752579103, -874.6376473751785, -1292.2618746609853, -676.3855939096695, -1110.8692934862836, -842.1434364856755, -136.82877664450422, -220.61676565264708, -70.77928702438098, -255.32810905191587, -256.74056886490916, -421.8059161666117, -527.8362340866756, -411.3012462357112, -493.82165840118085, -227.21558140872705, -525.3437669467677, -82.52384016792831, -985.0594233574011, -595.9755240533644, -940.0746430363565, -917.0692740924989, -868.7175519347417, -86.20793302504896, -907.6758468312555, -158.28780235743375, -751.9055920413213, -724.0428304610285, -789.7652938578615, -107.93642614920891, -83.7782543664517, -132.15287839543572, -587.9291739031404, -430.3664885651492, -574.625617592858, -792.2303727182612, -115.45714346023662, -807.60250728304, -507.88161383943714, -751.1950820384168, -1223.7507266994203, -29.975692893318477, -229.29098896148687, -1084.1232056537992, -1367.3302861529492, -780.2770893195116, -1262.0846803823788, -24.474199649665444, -329.26811429641117, -137.98553025571613, -711.1578112550496, -500.0239327018951, -208.94231919747713, -145.78577412079278, -499.8529371028072, -262.8089196175582, -1102.314570200198, -178.1258834324546, -121.31657447080244, -202.75461338421565, -57.85198512640049, -13.407657532422363, -702.4311504576831, -166.0096977655109, -560.2537138331843, -494.44594682174613, -807.0280677539693, -1128.3910262365625, -515.3543754412763, -270.5914366874626, -536.8609824416832, -295.7091675657456, -211.77224368809541, -762.8170367851053, -840.5604338177087, -264.75517912168766, -70.51982315117817, -188.90225677713113, -66.79522859899211, -1249.9711563450442, -1177.6640665861612, -184.6057387536724, -433.3032589301219, -452.1392321075974, -301.52086133146133, -379.77219191292323, -938.3655600538041, -443.3127951140207, -268.8532345973244, -186.56483525839442, -445.5108257631639, -101.79688809528783, -76.34984321431419, -50.874888746599396, -1118.02518053523, -742.5870974770074, -221.1890050809082, -937.0725336373281, -344.0559091725646, -863.6113693668689, -242.63948819048755, -111.22906217704362, -602.9559833177038, -70.25012232607388, -139.90398255205076, -207.76198828488594, -489.98708545332516, -67.12700368637051, -141.4611463096092, -796.8456817628187, -276.8510201042684, -135.75620922653104, -87.04274416409581, -1125.0456116145228, -378.29922855613125, -192.06674515641254, -132.67445961552275, -696.5525338169901, -496.46631426265424, -1210.2604745621989, -330.93922386585376, -698.5880836117814, -23.965810956640627, -425.6879966404753, -1526.152738067288, -209.54982645489306, -307.4652344149373, -979.8643960095555, -595.9130275888887, -40.79354854435183, -681.3124358400837, -1057.7712474988462, -148.813797505375, -781.5259955615461, -53.16341199205873, -98.05873283732745, -791.9568775200802, -790.3063722224347, -548.2945433651173, -445.8936661157919, -339.18342892125406, -95.67004145357046, -902.0345552423227, -745.9876823498303, -229.42813966430614, -357.9478158836273, -812.5206590764528, -91.47694182321503, -1082.2892991844635, -953.0127020851846, -55.828247390646084, -599.894686814432, -829.5132599855764, -386.7590983955817, -774.8043268749574, -801.8376172197086, -738.955380678467, -78.14359214187107, -1145.025693442134, -165.86590963208948, -977.0284642318578, -1495.197726607278, -719.0910335120122, -71.14107166165743, -123.26522967751389, -144.44968222891572, -795.7304316109664, -980.3066660274208, -1146.0781587895635, -187.26142001232515, -149.14572665195809, -567.1528712756342, -826.483708846185, -99.90709890732207, -757.2428763220446, -249.39344079715627, -210.44304846337903, -816.9646704073564, -910.1578121862105, -508.1887514116166, -663.7637540247486, -70.36877124573117, -1156.984107122856, -543.4669714869852, -617.4133288888735, -1130.566744048686, -274.41455036701666, -398.36853939692975, -99.02632590760403, -537.6292329066831, -832.5555814939472, -579.9833473858326, -359.02185340183934, -1312.6376358643965, -584.0142524558462, -77.74734965974858, -262.7949261418915, -605.6779258571421, -446.114944553991, -478.5776135638656, -52.385466868594264, -388.8697090125977, -322.441288583755, -752.9093410250186, -491.8704681247881, -57.857448009993234, -694.6105795442927, -344.47940178406316, -875.0389905356682, -74.57936403773334, -1179.4004259261503, -726.1357426320947, -606.0818150853135, -324.7390777192426, -158.37692425646355, -178.66844902235547, -227.75811850410247, -454.074635337775, -733.1749780396336, -1024.4299081086126, -17.255199817029464, -318.4256234725021, -188.70974718713612, -516.5957586639927, -671.6642467720923, -193.18740759353255, -532.0058239770423, -815.6063657836618, -331.43068853229624, -138.5281736008764, -186.76396706346526, -707.4303410707857, -939.9869955063803, -81.6269426240172, -160.87953496491812, -47.920970849723496, -317.97743105178125, -381.11870346911684, -711.7917273522395, 1.2093587791854419, -515.2693710401975, -388.1875625404962, -1262.6078846810867, -698.7409361195893, -1085.6279775508776, -64.75059823434147, -1289.4361733084743, -984.87289110831, -591.1773148060861, -544.9115861666886, -1027.4269029249344, -157.54790952983626, -366.55546335521757, -435.32794271556463, -115.41060747519204, -185.92943687075658, -288.0363645221529, -466.84849639629095, -493.2875754295337, -90.07776338122243, -536.5932386153972, -116.23552594886132, -1355.2664465412142, -176.2955352640554, -161.0290868470062, -344.6211209953826, -31.93004452163338, -275.339355568397, -45.144945145311844, -172.4463173613989, -852.6597970485875, -597.5201661280315, -597.3920028857015, -112.17608608674416, -776.4060268244573, -333.45022502644997, -493.00516753078267, -166.34399104288457, -659.2179469783144, -1065.10347459928, -829.7489288566438, -702.5334076615097, -1183.5069101039303, -1070.6570813554306, -78.88473150374926, -1023.5488755534759, -230.47897713783595, -359.70146403234287, -871.7552899204861, -559.2200719947643, -162.58168144298904, -461.7198384716134, -498.97636593692255, -454.13966786467427, -57.757340777492765, -800.7389360991821, -408.114947767446, -539.7023364889982, -468.72690152639456, -680.3302145845942, -370.8761685032008, -301.30598593128474, -631.5080679049341, -59.32612428041457, -47.34326977242119, -69.85373682255785, -82.44292463125164, -718.436423300386, -33.0162589323323, -35.672810668744646, -119.91126171368796, -277.79736304191397, -523.2325974963333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.567961998649385, "mean_inference_ms": 1.7300163136103075, "mean_action_processing_ms": 0.8239245808807633, "mean_env_wait_ms": 10.517406179459122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013615131378173828, "StateBufferConnector_ms": 0.009853363037109375, "ViewRequirementAgentConnector_ms": 0.33554697036743164}, "num_episodes": 29, "episode_return_max": -975.0301823027069, "episode_return_min": -4518.2894611583015, "episode_return_mean": -2519.0033130756474, "episodes_this_iter": 29}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1095875, "num_agent_steps_trained": 1095875, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 86.35490410094042, "num_env_steps_trained_throughput_per_sec": 86.35490410094042, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 1095875, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1095875, "timers": {"training_iteration_time_ms": 47616.381, "restore_workers_time_ms": 0.024, "training_step_time_ms": 47616.312, "sample_time_ms": 3295.391, "learn_time_ms": 44263.308, "learn_throughput": 90.368, "synch_weights_time_ms": 54.531}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 1095875, "num_agent_steps_trained": 1095875}, "done": false, "training_iteration": 62, "trial_id": "05c72_00000", "date": "2024-07-26_15-34-17", "timestamp": 1721988257, "time_this_iter_s": 46.33130717277527, "time_total_s": 3076.3656888008118, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e7d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3076.3656888008118, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 11.889393939393937, "ram_util_percent": 30.565151515151513}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 134.9926032996118, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.884537252686675, "policy_loss": -0.0031945335445342058, "vf_loss": 4.903788265488799, "vf_explained_var": 0.9865783044120722, "kl": 0.016953479720543334, "entropy": 2.463917884999947, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.14285714285714, "num_grad_updates_lifetime": 259815.5, "diff_num_grad_updates_vs_sampler_policy": 1994.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1112785, "num_agent_steps_trained": 1112785}, "env_runners": {"episode_reward_max": -826.0110589877547, "episode_reward_min": -4518.2894611583015, "episode_reward_mean": -2473.5935375166573, "episode_len_mean": 148.84, "episode_media": {}, "episodes_timesteps_total": 14884, "policy_reward_min": {"policy_0": -1526.152738067288}, "policy_reward_max": {"policy_0": 1.2093587791854419}, "policy_reward_mean": {"policy_0": -494.71870750333136}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3551.8597289914887, -3379.573403341439, -2579.702065418845, -3128.533077864027, -1495.4248849978037, -2844.681279923318, -1935.1495283086028, -3530.1460503546523, -2986.8438661787795, -1532.4901151944925, -1740.2060931603162, -4306.896416474362, -2628.120004716085, -1701.562026672097, -2720.282129619543, -2742.0941044320775, -4518.2894611583015, -1887.3777077065458, -2188.888084473811, -1097.761980971524, -3156.1284524109706, -1830.2882058242628, -2127.5547296528116, -3112.3394492139923, -2515.1106405198084, -1079.075626928485, -3069.7487054770713, -2164.4918122246686, -975.0301823027069, -1437.956801567323, -2524.6385787595796, -2760.2199072591275, -3448.720191587148, -2524.6040569775464, -2515.0113901334457, -2331.0762350980563, -2237.361238797432, -3520.538195460299, -2780.500015310586, -4502.20882742537, -2114.8930812064746, -2876.121885575665, -2133.9511348972565, -3309.463195991163, -2964.230134188491, -2408.216341095906, -2842.8720899790283, -1688.3890225828031, -2341.7272384881544, -3461.2363382169597, -1343.6172048399383, -2281.995456624913, -2729.0596027903207, -2304.1401657738024, -989.5235829595568, -2876.6471868348326, -4123.428576321599, -2687.6191767827636, -1491.5528479799573, -2591.460549916229, -989.215143196475, -2265.163228569032, -1881.3814965113197, -4440.110668199674, -2763.2711295828335, -2554.253247766777, -2260.4532289977933, -2452.7473384504056, -977.4024788070317, -989.6302918530122, -3292.2608455300433, -1667.9772243349234, -2848.6994461743825, -2302.0997311564483, -2541.7597335219234, -2846.8918095468343, -826.0110589877547, -1326.1746774990388, -2834.100325957584, -3135.32154238933, -2354.666017799321, -2516.6578075573143, -2202.3243268662877, -2773.958779444041, -1439.3172221152324, -3297.045731465933, -3186.9826683111332, -2951.8427089761817, -1718.3656154791663, -2215.6645715363697, -2600.508418231695, -3036.361579446492, -3589.7163742843954, -3641.3681196694583, -2151.12878027608, -2482.3767554225565, -2096.966442247861, -2202.4929884533326, -1389.3407038637831, -1648.7134272518038], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 99, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-941.8526265364961, -440.61571894077, -1099.7722544007158, -913.3267607803425, -156.29236833316, -620.4176636353002, -491.3775608337289, -606.1271968923472, -1208.037189462049, -453.6137925180156, -467.16676786434886, -298.3612129936891, -948.8601789332995, -617.8229343082005, -247.49097131930515, -325.65005659723755, -164.02584479003627, -969.9446953073208, -1158.3788589304315, -510.5336222389994, -52.57644300399381, -494.33629373002907, -148.6303905234495, -350.56301954069244, -449.3187381996382, -1237.1191351921334, -526.9600242600899, -49.30369377243779, -118.43735852473054, -912.861068173926, -324.8674076208732, -564.1266969121631, -14.440217218018718, -797.4187818366712, -234.29642472087485, -839.117851461763, -133.39935933093014, -390.72931752579103, -874.6376473751785, -1292.2618746609853, -676.3855939096695, -1110.8692934862836, -842.1434364856755, -136.82877664450422, -220.61676565264708, -70.77928702438098, -255.32810905191587, -256.74056886490916, -421.8059161666117, -527.8362340866756, -411.3012462357112, -493.82165840118085, -227.21558140872705, -525.3437669467677, -82.52384016792831, -985.0594233574011, -595.9755240533644, -940.0746430363565, -917.0692740924989, -868.7175519347417, -86.20793302504896, -907.6758468312555, -158.28780235743375, -751.9055920413213, -724.0428304610285, -789.7652938578615, -107.93642614920891, -83.7782543664517, -132.15287839543572, -587.9291739031404, -430.3664885651492, -574.625617592858, -792.2303727182612, -115.45714346023662, -807.60250728304, -507.88161383943714, -751.1950820384168, -1223.7507266994203, -29.975692893318477, -229.29098896148687, -1084.1232056537992, -1367.3302861529492, -780.2770893195116, -1262.0846803823788, -24.474199649665444, -329.26811429641117, -137.98553025571613, -711.1578112550496, -500.0239327018951, -208.94231919747713, -145.78577412079278, -499.8529371028072, -262.8089196175582, -1102.314570200198, -178.1258834324546, -121.31657447080244, -202.75461338421565, -57.85198512640049, -13.407657532422363, -702.4311504576831, -166.0096977655109, -560.2537138331843, -494.44594682174613, -807.0280677539693, -1128.3910262365625, -515.3543754412763, -270.5914366874626, -536.8609824416832, -295.7091675657456, -211.77224368809541, -762.8170367851053, -840.5604338177087, -264.75517912168766, -70.51982315117817, -188.90225677713113, -66.79522859899211, -1249.9711563450442, -1177.6640665861612, -184.6057387536724, -433.3032589301219, -452.1392321075974, -301.52086133146133, -379.77219191292323, -938.3655600538041, -443.3127951140207, -268.8532345973244, -186.56483525839442, -445.5108257631639, -101.79688809528783, -76.34984321431419, -50.874888746599396, -1118.02518053523, -742.5870974770074, -221.1890050809082, -937.0725336373281, -344.0559091725646, -863.6113693668689, -242.63948819048755, -111.22906217704362, -602.9559833177038, -70.25012232607388, -139.90398255205076, -207.76198828488594, -489.98708545332516, -67.12700368637051, -141.4611463096092, -796.8456817628187, -276.8510201042684, -135.75620922653104, -87.04274416409581, -1125.0456116145228, -378.29922855613125, -192.06674515641254, -132.67445961552275, -696.5525338169901, -496.46631426265424, -1210.2604745621989, -330.93922386585376, -698.5880836117814, -23.965810956640627, -425.6879966404753, -1526.152738067288, -209.54982645489306, -307.4652344149373, -979.8643960095555, -595.9130275888887, -40.79354854435183, -681.3124358400837, -1057.7712474988462, -148.813797505375, -781.5259955615461, -53.16341199205873, -98.05873283732745, -791.9568775200802, -790.3063722224347, -548.2945433651173, -445.8936661157919, -339.18342892125406, -95.67004145357046, -902.0345552423227, -745.9876823498303, -229.42813966430614, -357.9478158836273, -812.5206590764528, -91.47694182321503, -1082.2892991844635, -953.0127020851846, -55.828247390646084, -599.894686814432, -829.5132599855764, -386.7590983955817, -774.8043268749574, -801.8376172197086, -738.955380678467, -78.14359214187107, -1145.025693442134, -165.86590963208948, -977.0284642318578, -1495.197726607278, -719.0910335120122, -71.14107166165743, -123.26522967751389, -144.44968222891572, -795.7304316109664, -980.3066660274208, -1146.0781587895635, -187.26142001232515, -149.14572665195809, -567.1528712756342, -826.483708846185, -99.90709890732207, -757.2428763220446, -249.39344079715627, -210.44304846337903, -816.9646704073564, -910.1578121862105, -508.1887514116166, -663.7637540247486, -70.36877124573117, -1156.984107122856, -543.4669714869852, -617.4133288888735, -1130.566744048686, -274.41455036701666, -398.36853939692975, -99.02632590760403, -537.6292329066831, -832.5555814939472, -579.9833473858326, -359.02185340183934, -1312.6376358643965, -584.0142524558462, -77.74734965974858, -262.7949261418915, -605.6779258571421, -446.114944553991, -478.5776135638656, -52.385466868594264, -388.8697090125977, -322.441288583755, -752.9093410250186, -491.8704681247881, -57.857448009993234, -694.6105795442927, -344.47940178406316, -875.0389905356682, -74.57936403773334, -1179.4004259261503, -726.1357426320947, -606.0818150853135, -324.7390777192426, -158.37692425646355, -178.66844902235547, -227.75811850410247, -454.074635337775, -733.1749780396336, -1024.4299081086126, -17.255199817029464, -318.4256234725021, -188.70974718713612, -516.5957586639927, -671.6642467720923, -193.18740759353255, -532.0058239770423, -815.6063657836618, -331.43068853229624, -138.5281736008764, -186.76396706346526, -707.4303410707857, -939.9869955063803, -81.6269426240172, -160.87953496491812, -47.920970849723496, -317.97743105178125, -381.11870346911684, -711.7917273522395, 1.2093587791854419, -515.2693710401975, -388.1875625404962, -1262.6078846810867, -698.7409361195893, -1085.6279775508776, -64.75059823434147, -1289.4361733084743, -984.87289110831, -591.1773148060861, -544.9115861666886, -1027.4269029249344, -157.54790952983626, -366.55546335521757, -435.32794271556463, -115.41060747519204, -185.92943687075658, -288.0363645221529, -466.84849639629095, -493.2875754295337, -90.07776338122243, -536.5932386153972, -116.23552594886132, -1355.2664465412142, -176.2955352640554, -161.0290868470062, -344.6211209953826, -31.93004452163338, -275.339355568397, -45.144945145311844, -172.4463173613989, -852.6597970485875, -597.5201661280315, -597.3920028857015, -112.17608608674416, -776.4060268244573, -333.45022502644997, -493.00516753078267, -166.34399104288457, -659.2179469783144, -1065.10347459928, -829.7489288566438, -702.5334076615097, -1183.5069101039303, -1070.6570813554306, -78.88473150374926, -1023.5488755534759, -230.47897713783595, -359.70146403234287, -871.7552899204861, -559.2200719947643, -162.58168144298904, -461.7198384716134, -498.97636593692255, -454.13966786467427, -57.757340777492765, -800.7389360991821, -408.114947767446, -539.7023364889982, -468.72690152639456, -680.3302145845942, -370.8761685032008, -301.30598593128474, -631.5080679049341, -59.32612428041457, -47.34326977242119, -69.85373682255785, -82.44292463125164, -718.436423300386, -33.0162589323323, -35.672810668744646, -119.91126171368796, -277.79736304191397, -523.2325974963333, -212.77437070234427, -144.17010880637775, -717.1131454384263, -1096.4679272689805, -1121.735293313913, -428.6336744709844, -49.56645407846954, -503.4567693131569, -129.55546356661168, -556.7648629057002, -190.37535620833566, -596.3195052325784, -815.4457172242461, -1041.556200767165, -205.0026667420586, -424.8379463306853, -99.44493911900116, -127.00101689686197, -992.1433852496921, -658.6724435602093, -712.8706504636554, -148.93386583064125, -581.8539002891367, -136.23119311094402, -961.8701238275471, -712.9993081446687, -866.3720465373028, -234.14633312332109, -138.03358983930255, -895.3405319022422, -46.7309866775084, -358.39817612750596, -266.5296839553286, -138.82614913899215, -15.52606308842053, -133.46344540172697, -49.20237651993672, -427.4886615810849, -676.4110775041704, -39.609116492121125, -331.3100292736585, -575.6480981652905, -427.2961281909011, -244.39642643067762, -1255.4496438970566, -123.65544487776762, -704.3010090496588, -158.22629390006122, -954.7098783187039, -1194.4289162431385, -95.22398238281154, -467.6525403107326, -181.22813280114806, -697.710782326733, -912.850579977896, -633.3399841564174, -281.69963448141243, -136.45875849786674, -171.49331236975877, -1293.6661180518597, -557.2033588214392, -182.68855777473402, -996.222210678408, -203.03874208110344, -263.1714575106028, -985.8915540090017, -804.683347901041, -106.86856685732846, -249.93382781098387, -626.5814828656853, -513.0306779163234, -276.51881688916626, -318.4750239708188, -176.88682486489526, -154.40587847402824, -306.3514390118356, -644.8479641234137, -1030.5446780531465, -1104.6199955473342, -210.6816547302022, -623.2771694549243, -1263.3509899651924, -393.9448321226448, -737.6238413432794, -168.7858354250912, -264.63369716550255, -1315.5280277912414, -862.1055402461218, -435.43582240656366, -74.13962136675023, -326.20744325801934, -1087.900779652922, -35.07623591080761, -35.04090824987591, -234.14024840754138, -663.516175260481, -490.3921428387583, -310.6274675910082, -101.13067853609635, -649.998107310025, -1018.141680123913, -933.7358944042594, -4.837283116374589, -238.87555307220276, -404.91800751494407, -43.61932763957597, -416.5543105864019, -122.2162855188282, -1240.4863918646224, -1213.4852638370621, -360.2544422566667, -639.0682494091259, -941.3843959080235, -570.5650080573942, -1078.4442786531858, -1318.3144529165575, -95.430868207658, -286.3489294097387, -1322.656658899669, -618.6172102358316, -769.2338154272047, -609.5346949019458, -152.98991585948056, -528.6887323056131, -90.68162178183596, -715.7158237928056, -165.0978598651147, -482.95833684635903, -312.289879944511, -806.314854973768, -112.57321221059674, -1008.2019594066464, -240.15722170997853, -425.28079292301913, -310.75325599762135, -276.49561021384505, -937.8310720292855, -612.6077211712509, -232.439915470978, -143.11866956797314, -42.907504768527424, -240.91573992598302, -768.0686297643897, -214.81028985173216, -122.63853955315297, -131.76449656922568, -955.656663724172, -202.49511557964843, -86.29263615332964, -272.5045152254273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5659431358200666, "mean_inference_ms": 1.7295926162798805, "mean_action_processing_ms": 0.8229336829495797, "mean_env_wait_ms": 10.502826881247461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013659238815307617, "StateBufferConnector_ms": 0.009923219680786133, "ViewRequirementAgentConnector_ms": 0.3349490165710449}, "num_episodes": 30, "episode_return_max": -826.0110589877547, "episode_return_min": -4518.2894611583015, "episode_return_mean": -2473.5935375166573, "episodes_this_iter": 30}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1112785, "num_agent_steps_trained": 1112785, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.04098163900095, "num_env_steps_trained_throughput_per_sec": 89.04098163900095, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1112785, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1112785, "timers": {"training_iteration_time_ms": 48154.865, "restore_workers_time_ms": 0.025, "training_step_time_ms": 48154.795, "sample_time_ms": 3288.796, "learn_time_ms": 44807.862, "learn_throughput": 89.27, "synch_weights_time_ms": 55.025}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1112785, "num_agent_steps_trained": 1112785}, "done": false, "training_iteration": 63, "trial_id": "05c72_00000", "date": "2024-07-26_15-35-02", "timestamp": 1721988302, "time_this_iter_s": 44.9343786239624, "time_total_s": 3121.300067424774, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00de560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3121.300067424774, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 12.071874999999999, "ram_util_percent": 30.5171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 146.83929565259479, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.636692477461547, "policy_loss": -0.000734253101792734, "vf_loss": 4.653786827510423, "vf_explained_var": 0.9882041803182267, "kl": 0.017239566885609868, "entropy": 2.5087626932174203, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.8267716535433, "num_grad_updates_lifetime": 263715.5, "diff_num_grad_updates_vs_sampler_policy": 1904.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1129019, "num_agent_steps_trained": 1129019}, "env_runners": {"episode_reward_max": -519.0725209913834, "episode_reward_min": -4502.20882742537, "episode_reward_mean": -2435.9503988116257, "episode_len_mean": 148.13, "episode_media": {}, "episodes_timesteps_total": 14813, "policy_reward_min": {"policy_0": -1526.152738067288}, "policy_reward_max": {"policy_0": 1.2093587791854419}, "policy_reward_mean": {"policy_0": -487.1900797623252}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1830.2882058242628, -2127.5547296528116, -3112.3394492139923, -2515.1106405198084, -1079.075626928485, -3069.7487054770713, -2164.4918122246686, -975.0301823027069, -1437.956801567323, -2524.6385787595796, -2760.2199072591275, -3448.720191587148, -2524.6040569775464, -2515.0113901334457, -2331.0762350980563, -2237.361238797432, -3520.538195460299, -2780.500015310586, -4502.20882742537, -2114.8930812064746, -2876.121885575665, -2133.9511348972565, -3309.463195991163, -2964.230134188491, -2408.216341095906, -2842.8720899790283, -1688.3890225828031, -2341.7272384881544, -3461.2363382169597, -1343.6172048399383, -2281.995456624913, -2729.0596027903207, -2304.1401657738024, -989.5235829595568, -2876.6471868348326, -4123.428576321599, -2687.6191767827636, -1491.5528479799573, -2591.460549916229, -989.215143196475, -2265.163228569032, -1881.3814965113197, -4440.110668199674, -2763.2711295828335, -2554.253247766777, -2260.4532289977933, -2452.7473384504056, -977.4024788070317, -989.6302918530122, -3292.2608455300433, -1667.9772243349234, -2848.6994461743825, -2302.0997311564483, -2541.7597335219234, -2846.8918095468343, -826.0110589877547, -1326.1746774990388, -2834.100325957584, -3135.32154238933, -2354.666017799321, -2516.6578075573143, -2202.3243268662877, -2773.958779444041, -1439.3172221152324, -3297.045731465933, -3186.9826683111332, -2951.8427089761817, -1718.3656154791663, -2215.6645715363697, -2600.508418231695, -3036.361579446492, -3589.7163742843954, -3641.3681196694583, -2151.12878027608, -2482.3767554225565, -2096.966442247861, -2202.4929884533326, -1389.3407038637831, -1648.7134272518038, -3452.8224769354465, -3091.1869521915223, -2943.2196604883397, -992.5367948198332, -1848.6750225212645, -2555.1155502812967, -3332.001860517853, -2268.0293843429868, -2551.3527425907764, -1725.36869814347, -3844.376030450329, -853.626990816375, -1857.0991636620668, -519.0725209913834, -1481.457927030256, -2798.9906590508, -2070.042019803636, -2006.7384302841358, -4495.874171082003, -4012.8549446692077, -3187.2545911930247], "episode_lengths": [150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 99, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-515.3543754412763, -270.5914366874626, -536.8609824416832, -295.7091675657456, -211.77224368809541, -762.8170367851053, -840.5604338177087, -264.75517912168766, -70.51982315117817, -188.90225677713113, -66.79522859899211, -1249.9711563450442, -1177.6640665861612, -184.6057387536724, -433.3032589301219, -452.1392321075974, -301.52086133146133, -379.77219191292323, -938.3655600538041, -443.3127951140207, -268.8532345973244, -186.56483525839442, -445.5108257631639, -101.79688809528783, -76.34984321431419, -50.874888746599396, -1118.02518053523, -742.5870974770074, -221.1890050809082, -937.0725336373281, -344.0559091725646, -863.6113693668689, -242.63948819048755, -111.22906217704362, -602.9559833177038, -70.25012232607388, -139.90398255205076, -207.76198828488594, -489.98708545332516, -67.12700368637051, -141.4611463096092, -796.8456817628187, -276.8510201042684, -135.75620922653104, -87.04274416409581, -1125.0456116145228, -378.29922855613125, -192.06674515641254, -132.67445961552275, -696.5525338169901, -496.46631426265424, -1210.2604745621989, -330.93922386585376, -698.5880836117814, -23.965810956640627, -425.6879966404753, -1526.152738067288, -209.54982645489306, -307.4652344149373, -979.8643960095555, -595.9130275888887, -40.79354854435183, -681.3124358400837, -1057.7712474988462, -148.813797505375, -781.5259955615461, -53.16341199205873, -98.05873283732745, -791.9568775200802, -790.3063722224347, -548.2945433651173, -445.8936661157919, -339.18342892125406, -95.67004145357046, -902.0345552423227, -745.9876823498303, -229.42813966430614, -357.9478158836273, -812.5206590764528, -91.47694182321503, -1082.2892991844635, -953.0127020851846, -55.828247390646084, -599.894686814432, -829.5132599855764, -386.7590983955817, -774.8043268749574, -801.8376172197086, -738.955380678467, -78.14359214187107, -1145.025693442134, -165.86590963208948, -977.0284642318578, -1495.197726607278, -719.0910335120122, -71.14107166165743, -123.26522967751389, -144.44968222891572, -795.7304316109664, -980.3066660274208, -1146.0781587895635, -187.26142001232515, -149.14572665195809, -567.1528712756342, -826.483708846185, -99.90709890732207, -757.2428763220446, -249.39344079715627, -210.44304846337903, -816.9646704073564, -910.1578121862105, -508.1887514116166, -663.7637540247486, -70.36877124573117, -1156.984107122856, -543.4669714869852, -617.4133288888735, -1130.566744048686, -274.41455036701666, -398.36853939692975, -99.02632590760403, -537.6292329066831, -832.5555814939472, -579.9833473858326, -359.02185340183934, -1312.6376358643965, -584.0142524558462, -77.74734965974858, -262.7949261418915, -605.6779258571421, -446.114944553991, -478.5776135638656, -52.385466868594264, -388.8697090125977, -322.441288583755, -752.9093410250186, -491.8704681247881, -57.857448009993234, -694.6105795442927, -344.47940178406316, -875.0389905356682, -74.57936403773334, -1179.4004259261503, -726.1357426320947, -606.0818150853135, -324.7390777192426, -158.37692425646355, -178.66844902235547, -227.75811850410247, -454.074635337775, -733.1749780396336, -1024.4299081086126, -17.255199817029464, -318.4256234725021, -188.70974718713612, -516.5957586639927, -671.6642467720923, -193.18740759353255, -532.0058239770423, -815.6063657836618, -331.43068853229624, -138.5281736008764, -186.76396706346526, -707.4303410707857, -939.9869955063803, -81.6269426240172, -160.87953496491812, -47.920970849723496, -317.97743105178125, -381.11870346911684, -711.7917273522395, 1.2093587791854419, -515.2693710401975, -388.1875625404962, -1262.6078846810867, -698.7409361195893, -1085.6279775508776, -64.75059823434147, -1289.4361733084743, -984.87289110831, -591.1773148060861, -544.9115861666886, -1027.4269029249344, -157.54790952983626, -366.55546335521757, -435.32794271556463, -115.41060747519204, -185.92943687075658, -288.0363645221529, -466.84849639629095, -493.2875754295337, -90.07776338122243, -536.5932386153972, -116.23552594886132, -1355.2664465412142, -176.2955352640554, -161.0290868470062, -344.6211209953826, -31.93004452163338, -275.339355568397, -45.144945145311844, -172.4463173613989, -852.6597970485875, -597.5201661280315, -597.3920028857015, -112.17608608674416, -776.4060268244573, -333.45022502644997, -493.00516753078267, -166.34399104288457, -659.2179469783144, -1065.10347459928, -829.7489288566438, -702.5334076615097, -1183.5069101039303, -1070.6570813554306, -78.88473150374926, -1023.5488755534759, -230.47897713783595, -359.70146403234287, -871.7552899204861, -559.2200719947643, -162.58168144298904, -461.7198384716134, -498.97636593692255, -454.13966786467427, -57.757340777492765, -800.7389360991821, -408.114947767446, -539.7023364889982, -468.72690152639456, -680.3302145845942, -370.8761685032008, -301.30598593128474, -631.5080679049341, -59.32612428041457, -47.34326977242119, -69.85373682255785, -82.44292463125164, -718.436423300386, -33.0162589323323, -35.672810668744646, -119.91126171368796, -277.79736304191397, -523.2325974963333, -212.77437070234427, -144.17010880637775, -717.1131454384263, -1096.4679272689805, -1121.735293313913, -428.6336744709844, -49.56645407846954, -503.4567693131569, -129.55546356661168, -556.7648629057002, -190.37535620833566, -596.3195052325784, -815.4457172242461, -1041.556200767165, -205.0026667420586, -424.8379463306853, -99.44493911900116, -127.00101689686197, -992.1433852496921, -658.6724435602093, -712.8706504636554, -148.93386583064125, -581.8539002891367, -136.23119311094402, -961.8701238275471, -712.9993081446687, -866.3720465373028, -234.14633312332109, -138.03358983930255, -895.3405319022422, -46.7309866775084, -358.39817612750596, -266.5296839553286, -138.82614913899215, -15.52606308842053, -133.46344540172697, -49.20237651993672, -427.4886615810849, -676.4110775041704, -39.609116492121125, -331.3100292736585, -575.6480981652905, -427.2961281909011, -244.39642643067762, -1255.4496438970566, -123.65544487776762, -704.3010090496588, -158.22629390006122, -954.7098783187039, -1194.4289162431385, -95.22398238281154, -467.6525403107326, -181.22813280114806, -697.710782326733, -912.850579977896, -633.3399841564174, -281.69963448141243, -136.45875849786674, -171.49331236975877, -1293.6661180518597, -557.2033588214392, -182.68855777473402, -996.222210678408, -203.03874208110344, -263.1714575106028, -985.8915540090017, -804.683347901041, -106.86856685732846, -249.93382781098387, -626.5814828656853, -513.0306779163234, -276.51881688916626, -318.4750239708188, -176.88682486489526, -154.40587847402824, -306.3514390118356, -644.8479641234137, -1030.5446780531465, -1104.6199955473342, -210.6816547302022, -623.2771694549243, -1263.3509899651924, -393.9448321226448, -737.6238413432794, -168.7858354250912, -264.63369716550255, -1315.5280277912414, -862.1055402461218, -435.43582240656366, -74.13962136675023, -326.20744325801934, -1087.900779652922, -35.07623591080761, -35.04090824987591, -234.14024840754138, -663.516175260481, -490.3921428387583, -310.6274675910082, -101.13067853609635, -649.998107310025, -1018.141680123913, -933.7358944042594, -4.837283116374589, -238.87555307220276, -404.91800751494407, -43.61932763957597, -416.5543105864019, -122.2162855188282, -1240.4863918646224, -1213.4852638370621, -360.2544422566667, -639.0682494091259, -941.3843959080235, -570.5650080573942, -1078.4442786531858, -1318.3144529165575, -95.430868207658, -286.3489294097387, -1322.656658899669, -618.6172102358316, -769.2338154272047, -609.5346949019458, -152.98991585948056, -528.6887323056131, -90.68162178183596, -715.7158237928056, -165.0978598651147, -482.95833684635903, -312.289879944511, -806.314854973768, -112.57321221059674, -1008.2019594066464, -240.15722170997853, -425.28079292301913, -310.75325599762135, -276.49561021384505, -937.8310720292855, -612.6077211712509, -232.439915470978, -143.11866956797314, -42.907504768527424, -240.91573992598302, -768.0686297643897, -214.81028985173216, -122.63853955315297, -131.76449656922568, -955.656663724172, -202.49511557964843, -86.29263615332964, -272.5045152254273, -1220.8788358746513, -1344.421361354105, -189.82566230081756, -649.7445062811609, -47.952111124712545, -1164.5584278589456, -534.378694660071, -442.37419425917983, -648.6891123385217, -301.1865230747997, -707.5742351385713, -417.8900477292923, -324.76197318956133, -1277.9274433108446, -215.06596112006613, -106.37396800776074, -115.89407252413054, -83.52781281969816, -44.2687574780163, -642.4721839902279, -682.9953105327063, -142.57270303564914, -172.520510075508, -0.14609559528942462, -850.4404032821107, -315.8727797751036, -642.835796679844, -856.662089690671, -95.3829339210058, -644.3619502146723, -775.504883661051, -1043.898263850628, -1118.8424831784741, -45.401404328382384, -348.35482549932084, -640.2555663099494, -399.8966378321836, -227.03343542106572, -314.21805100988837, -686.6256937699004, -712.2726430214237, -454.9741471750365, -638.4711687079416, -458.5674525672205, -287.0673311191504, -209.01742073246993, -930.8179437387005, -67.75428001396673, -99.3713500606234, -418.40770359771017, -676.5203762561382, -1513.8096042295479, -165.25214850613582, -125.17280507072655, -1363.6210963877807, -230.63576421414703, -22.54734460175313, -513.4347958112023, -41.63291884926371, -45.37616734000952, -117.00391330348567, -514.5828926767049, -305.6343967580804, -348.55996394186286, -571.3179969819324, -115.62152778322766, -22.969330524017387, -103.88784778103819, -142.47781030573574, -134.11600459736442, -472.5547653454057, -175.84231403288973, -235.5524780245153, -348.0821701329292, -249.42619949451773, -660.351258030541, -359.2085641668594, -121.41398307215447, -591.5265443000307, -1066.4903094812132, -584.0674625064146, -162.2852146306962, -245.78786092363933, -640.7921959458056, -437.1092857970795, -187.71110081339486, -859.9709480192776, -68.7860259066105, -672.4172791567978, -217.8530763880551, -349.4703935111172, -1376.877409623625, -1357.656715285347, -1287.4721104025086, -124.397542259406, -1056.3066950899076, -158.5835698668853, -1260.6813061149699, -893.0070626939937, -644.2763109034488, -899.513512155553, -426.945333447215, -851.773333750608, -434.9613194831715, -574.0610923564778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5667163331692893, "mean_inference_ms": 1.7290357250926485, "mean_action_processing_ms": 0.8213266680835399, "mean_env_wait_ms": 10.496122291002578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013589143753051758, "StateBufferConnector_ms": 0.009788990020751953, "ViewRequirementAgentConnector_ms": 0.3281381130218506}, "num_episodes": 21, "episode_return_max": -519.0725209913834, "episode_return_min": -4502.20882742537, "episode_return_mean": -2435.9503988116257, "episodes_this_iter": 21}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1129019, "num_agent_steps_trained": 1129019, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.229953675342, "num_env_steps_trained_throughput_per_sec": 80.229953675342, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1129019, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1129019, "timers": {"training_iteration_time_ms": 47614.151, "restore_workers_time_ms": 0.026, "training_step_time_ms": 47614.08, "sample_time_ms": 3265.658, "learn_time_ms": 44288.701, "learn_throughput": 90.316, "synch_weights_time_ms": 56.575}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1129019, "num_agent_steps_trained": 1129019}, "done": false, "training_iteration": 64, "trial_id": "05c72_00000", "date": "2024-07-26_15-35-52", "timestamp": 1721988352, "time_this_iter_s": 49.868720293045044, "time_total_s": 3171.168787717819, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd0128310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3171.168787717819, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 11.677142857142858, "ram_util_percent": 30.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.63524250671307, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.567000142670679, "policy_loss": -0.0008739903613220988, "vf_loss": 4.584712441887443, "vf_explained_var": 0.9856127122412204, "kl": 0.018326970758778226, "entropy": 2.611633985718404, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.07874015748031, "num_grad_updates_lifetime": 267525.5, "diff_num_grad_updates_vs_sampler_policy": 1904.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1145158, "num_agent_steps_trained": 1145158}, "env_runners": {"episode_reward_max": -519.0725209913834, "episode_reward_min": -4495.874171082003, "episode_reward_mean": -2343.310342807124, "episode_len_mean": 147.03, "episode_media": {}, "episodes_timesteps_total": 14703, "policy_reward_min": {"policy_0": -1513.8096042295479}, "policy_reward_max": {"policy_0": 1.2093587791854419}, "policy_reward_mean": {"policy_0": -468.66206856142486}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2281.995456624913, -2729.0596027903207, -2304.1401657738024, -989.5235829595568, -2876.6471868348326, -4123.428576321599, -2687.6191767827636, -1491.5528479799573, -2591.460549916229, -989.215143196475, -2265.163228569032, -1881.3814965113197, -4440.110668199674, -2763.2711295828335, -2554.253247766777, -2260.4532289977933, -2452.7473384504056, -977.4024788070317, -989.6302918530122, -3292.2608455300433, -1667.9772243349234, -2848.6994461743825, -2302.0997311564483, -2541.7597335219234, -2846.8918095468343, -826.0110589877547, -1326.1746774990388, -2834.100325957584, -3135.32154238933, -2354.666017799321, -2516.6578075573143, -2202.3243268662877, -2773.958779444041, -1439.3172221152324, -3297.045731465933, -3186.9826683111332, -2951.8427089761817, -1718.3656154791663, -2215.6645715363697, -2600.508418231695, -3036.361579446492, -3589.7163742843954, -3641.3681196694583, -2151.12878027608, -2482.3767554225565, -2096.966442247861, -2202.4929884533326, -1389.3407038637831, -1648.7134272518038, -3452.8224769354465, -3091.1869521915223, -2943.2196604883397, -992.5367948198332, -1848.6750225212645, -2555.1155502812967, -3332.001860517853, -2268.0293843429868, -2551.3527425907764, -1725.36869814347, -3844.376030450329, -853.626990816375, -1857.0991636620668, -519.0725209913834, -1481.457927030256, -2798.9906590508, -2070.042019803636, -2006.7384302841358, -4495.874171082003, -4012.8549446692077, -3187.2545911930247, -4306.660865939841, -1774.0593366726919, -894.4074941997814, -2414.0169177211956, -2403.90435373508, -2956.511952564481, -1669.1032730315749, -1966.0903980952748, -1032.8882981288086, -1665.2464370486073, -2894.2506240954617, -3466.3896847035408, -1995.8743789109865, -1157.9106161708341, -760.4360309164318, -2039.6855542907929, -3437.7630658148146, -1924.4890858700994, -3412.0842442763046, -1338.9129559338214, -2129.351089405416, -1572.6647140881946, -1695.4001859599816, -2601.7490959847355, -2727.9768997993842, -1334.0278861238266, -2278.3032536839282, -2305.8763486144667, -2914.040117383541, -2607.1116979674907], "episode_lengths": [150, 150, 150, 99, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 147, 150, 150, 150, 145, 103, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-733.1749780396336, -1024.4299081086126, -17.255199817029464, -318.4256234725021, -188.70974718713612, -516.5957586639927, -671.6642467720923, -193.18740759353255, -532.0058239770423, -815.6063657836618, -331.43068853229624, -138.5281736008764, -186.76396706346526, -707.4303410707857, -939.9869955063803, -81.6269426240172, -160.87953496491812, -47.920970849723496, -317.97743105178125, -381.11870346911684, -711.7917273522395, 1.2093587791854419, -515.2693710401975, -388.1875625404962, -1262.6078846810867, -698.7409361195893, -1085.6279775508776, -64.75059823434147, -1289.4361733084743, -984.87289110831, -591.1773148060861, -544.9115861666886, -1027.4269029249344, -157.54790952983626, -366.55546335521757, -435.32794271556463, -115.41060747519204, -185.92943687075658, -288.0363645221529, -466.84849639629095, -493.2875754295337, -90.07776338122243, -536.5932386153972, -116.23552594886132, -1355.2664465412142, -176.2955352640554, -161.0290868470062, -344.6211209953826, -31.93004452163338, -275.339355568397, -45.144945145311844, -172.4463173613989, -852.6597970485875, -597.5201661280315, -597.3920028857015, -112.17608608674416, -776.4060268244573, -333.45022502644997, -493.00516753078267, -166.34399104288457, -659.2179469783144, -1065.10347459928, -829.7489288566438, -702.5334076615097, -1183.5069101039303, -1070.6570813554306, -78.88473150374926, -1023.5488755534759, -230.47897713783595, -359.70146403234287, -871.7552899204861, -559.2200719947643, -162.58168144298904, -461.7198384716134, -498.97636593692255, -454.13966786467427, -57.757340777492765, -800.7389360991821, -408.114947767446, -539.7023364889982, -468.72690152639456, -680.3302145845942, -370.8761685032008, -301.30598593128474, -631.5080679049341, -59.32612428041457, -47.34326977242119, -69.85373682255785, -82.44292463125164, -718.436423300386, -33.0162589323323, -35.672810668744646, -119.91126171368796, -277.79736304191397, -523.2325974963333, -212.77437070234427, -144.17010880637775, -717.1131454384263, -1096.4679272689805, -1121.735293313913, -428.6336744709844, -49.56645407846954, -503.4567693131569, -129.55546356661168, -556.7648629057002, -190.37535620833566, -596.3195052325784, -815.4457172242461, -1041.556200767165, -205.0026667420586, -424.8379463306853, -99.44493911900116, -127.00101689686197, -992.1433852496921, -658.6724435602093, -712.8706504636554, -148.93386583064125, -581.8539002891367, -136.23119311094402, -961.8701238275471, -712.9993081446687, -866.3720465373028, -234.14633312332109, -138.03358983930255, -895.3405319022422, -46.7309866775084, -358.39817612750596, -266.5296839553286, -138.82614913899215, -15.52606308842053, -133.46344540172697, -49.20237651993672, -427.4886615810849, -676.4110775041704, -39.609116492121125, -331.3100292736585, -575.6480981652905, -427.2961281909011, -244.39642643067762, -1255.4496438970566, -123.65544487776762, -704.3010090496588, -158.22629390006122, -954.7098783187039, -1194.4289162431385, -95.22398238281154, -467.6525403107326, -181.22813280114806, -697.710782326733, -912.850579977896, -633.3399841564174, -281.69963448141243, -136.45875849786674, -171.49331236975877, -1293.6661180518597, -557.2033588214392, -182.68855777473402, -996.222210678408, -203.03874208110344, -263.1714575106028, -985.8915540090017, -804.683347901041, -106.86856685732846, -249.93382781098387, -626.5814828656853, -513.0306779163234, -276.51881688916626, -318.4750239708188, -176.88682486489526, -154.40587847402824, -306.3514390118356, -644.8479641234137, -1030.5446780531465, -1104.6199955473342, -210.6816547302022, -623.2771694549243, -1263.3509899651924, -393.9448321226448, -737.6238413432794, -168.7858354250912, -264.63369716550255, -1315.5280277912414, -862.1055402461218, -435.43582240656366, -74.13962136675023, -326.20744325801934, -1087.900779652922, -35.07623591080761, -35.04090824987591, -234.14024840754138, -663.516175260481, -490.3921428387583, -310.6274675910082, -101.13067853609635, -649.998107310025, -1018.141680123913, -933.7358944042594, -4.837283116374589, -238.87555307220276, -404.91800751494407, -43.61932763957597, -416.5543105864019, -122.2162855188282, -1240.4863918646224, -1213.4852638370621, -360.2544422566667, -639.0682494091259, -941.3843959080235, -570.5650080573942, -1078.4442786531858, -1318.3144529165575, -95.430868207658, -286.3489294097387, -1322.656658899669, -618.6172102358316, -769.2338154272047, -609.5346949019458, -152.98991585948056, -528.6887323056131, -90.68162178183596, -715.7158237928056, -165.0978598651147, -482.95833684635903, -312.289879944511, -806.314854973768, -112.57321221059674, -1008.2019594066464, -240.15722170997853, -425.28079292301913, -310.75325599762135, -276.49561021384505, -937.8310720292855, -612.6077211712509, -232.439915470978, -143.11866956797314, -42.907504768527424, -240.91573992598302, -768.0686297643897, -214.81028985173216, -122.63853955315297, -131.76449656922568, -955.656663724172, -202.49511557964843, -86.29263615332964, -272.5045152254273, -1220.8788358746513, -1344.421361354105, -189.82566230081756, -649.7445062811609, -47.952111124712545, -1164.5584278589456, -534.378694660071, -442.37419425917983, -648.6891123385217, -301.1865230747997, -707.5742351385713, -417.8900477292923, -324.76197318956133, -1277.9274433108446, -215.06596112006613, -106.37396800776074, -115.89407252413054, -83.52781281969816, -44.2687574780163, -642.4721839902279, -682.9953105327063, -142.57270303564914, -172.520510075508, -0.14609559528942462, -850.4404032821107, -315.8727797751036, -642.835796679844, -856.662089690671, -95.3829339210058, -644.3619502146723, -775.504883661051, -1043.898263850628, -1118.8424831784741, -45.401404328382384, -348.35482549932084, -640.2555663099494, -399.8966378321836, -227.03343542106572, -314.21805100988837, -686.6256937699004, -712.2726430214237, -454.9741471750365, -638.4711687079416, -458.5674525672205, -287.0673311191504, -209.01742073246993, -930.8179437387005, -67.75428001396673, -99.3713500606234, -418.40770359771017, -676.5203762561382, -1513.8096042295479, -165.25214850613582, -125.17280507072655, -1363.6210963877807, -230.63576421414703, -22.54734460175313, -513.4347958112023, -41.63291884926371, -45.37616734000952, -117.00391330348567, -514.5828926767049, -305.6343967580804, -348.55996394186286, -571.3179969819324, -115.62152778322766, -22.969330524017387, -103.88784778103819, -142.47781030573574, -134.11600459736442, -472.5547653454057, -175.84231403288973, -235.5524780245153, -348.0821701329292, -249.42619949451773, -660.351258030541, -359.2085641668594, -121.41398307215447, -591.5265443000307, -1066.4903094812132, -584.0674625064146, -162.2852146306962, -245.78786092363933, -640.7921959458056, -437.1092857970795, -187.71110081339486, -859.9709480192776, -68.7860259066105, -672.4172791567978, -217.8530763880551, -349.4703935111172, -1376.877409623625, -1357.656715285347, -1287.4721104025086, -124.397542259406, -1056.3066950899076, -158.5835698668853, -1260.6813061149699, -893.0070626939937, -644.2763109034488, -899.513512155553, -426.945333447215, -851.773333750608, -434.9613194831715, -574.0610923564778, -669.3533196757669, -1314.6959597448003, -844.2111667724939, -1112.0479954759057, -366.3524242708764, -639.9133542221779, -140.6766313310182, -516.251026540534, -88.13429382028404, -389.08403075867795, -74.24136391151958, -391.5907876571483, -101.58868917034168, -252.54403636034246, -74.44261710042936, -341.5843026136486, -8.764688827092192, -1151.8368448883268, -215.4698715165841, -696.3612098755469, -321.3281517687206, -619.9430309371824, -424.9514513227703, -314.382424900204, -723.2992948062008, -96.01269716406199, -985.1184479589309, -1162.8785448243398, -97.32539467646343, -615.1768679406846, -199.72617024152026, -471.27523095550066, -209.20692257217218, -76.77448230191342, -712.1204669604676, -443.97601882357725, -852.6147172112069, -518.0346832491482, -128.83316154095573, -22.631817270387195, -116.51415037299974, -47.16023832926663, -139.11099547861036, -222.6129231610848, -507.4899907868477, -396.2011714296908, -774.7066782348295, -40.89779759365748, -340.54983529502493, -112.8909544954043, -451.750953164197, -72.74800529882867, -828.4157729350311, -1433.5442897943506, -107.79160290305292, -17.3340224341566, -1219.5937874203694, -174.89011002729018, -777.2327791878987, -1277.3389856338288, -557.0700613419332, -42.674486359457866, -490.3635866716187, -725.003356413714, -180.762888124262, -377.8058275993663, -363.81713340762195, -28.11605633131448, -233.2903595881992, -154.8812392443313, -111.53366565936703, -75.50875869295301, -55.123698924163975, -165.18978081698933, -353.0801268229592, -498.91486826613504, -70.73681234998251, -424.93329910557077, -377.21299027687354, -667.8875842922316, -1270.661389285282, -980.3547643755569, -399.5234431513709, -139.0618372792848, -648.1616317233184, -427.7630806622909, -1126.3150587944328, -97.41016237219273, -32.11144151184026, -240.88934252934354, -683.8206301155163, -1228.2364293285234, -483.9627711066587, -560.3406502624713, -455.7237634631381, -47.225969584183225, -275.0218851670286, -144.29786908672475, -121.9070470759582, -750.4601850199264, -24.832527771596215, -699.8760861936381, -86.25105240428005, -1029.3440394755087, -289.0473835603925, -105.16191373651878, -22.924931201000618, -1252.8721498625873, -143.13150884431158, -48.574210443775726, -169.25662722473902, -704.8456584186652, -154.31902431751922, -586.236585589076, -80.74229040998418, -980.3954154611895, -1092.4203924397489, -120.87589171181864, -170.7178838633962, -237.33951250858303, -845.9548710712253, -27.672291203375224, -586.2653556266802, -570.5148661078454, -697.5695157902584, -560.0973578845441, -20.911676801518347, -137.63140681826656, -117.54508988372054, -497.84235473577763, -785.4569038434821, -555.8330969075802, -139.47919182649434, -770.1019698642464, -27.432091242124063, -441.1745837542966, -701.3572767481892, -228.24692231411706, -863.5593763494801, -71.53818944838478, -410.05244044221945, -314.88683308976505, -39.71315943596286, -1315.1670196799198, -834.220664735669, -47.32583176864062, -155.37533730065894, -1149.236119848556, -374.48002705376746, -880.6943819958672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5633986515603575, "mean_inference_ms": 1.7285403540583417, "mean_action_processing_ms": 0.8202274540894753, "mean_env_wait_ms": 10.480956809595298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013014793395996094, "StateBufferConnector_ms": 0.009316682815551758, "ViewRequirementAgentConnector_ms": 0.30516743659973145}, "num_episodes": 30, "episode_return_max": -519.0725209913834, "episode_return_min": -4495.874171082003, "episode_return_mean": -2343.310342807124, "episodes_this_iter": 30}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1145158, "num_agent_steps_trained": 1145158, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.56112790361406, "num_env_steps_trained_throughput_per_sec": 83.56112790361406, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1145158, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1145158, "timers": {"training_iteration_time_ms": 47496.232, "restore_workers_time_ms": 0.027, "training_step_time_ms": 47496.159, "sample_time_ms": 3231.765, "learn_time_ms": 44204.967, "learn_throughput": 90.488, "synch_weights_time_ms": 56.282}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1145158, "num_agent_steps_trained": 1145158}, "done": false, "training_iteration": 65, "trial_id": "05c72_00000", "date": "2024-07-26_15-36-40", "timestamp": 1721988400, "time_this_iter_s": 47.88076686859131, "time_total_s": 3219.0495545864105, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00dd6c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3219.0495545864105, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 11.520289855072463, "ram_util_percent": 30.569565217391293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 150.05962527019005, "cur_kl_coeff": 0.50625, "cur_lr": 0.001, "total_loss": 4.943735004409596, "policy_loss": 0.0011118889558861997, "vf_loss": 4.958122770543452, "vf_explained_var": 0.9802690942668253, "kl": 0.018971101383134806, "entropy": 2.51037788854705, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.32638888888889, "num_grad_updates_lifetime": 271590.5, "diff_num_grad_updates_vs_sampler_policy": 2159.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1163493, "num_agent_steps_trained": 1163493}, "env_runners": {"episode_reward_max": -519.0725209913834, "episode_reward_min": -4550.170179007368, "episode_reward_mean": -2451.086557794531, "episode_len_mean": 147.62, "episode_media": {}, "episodes_timesteps_total": 14762, "policy_reward_min": {"policy_0": -1513.8096042295479}, "policy_reward_max": {"policy_0": 3.8445733026431324}, "policy_reward_mean": {"policy_0": -490.2173115589062}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2516.6578075573143, -2202.3243268662877, -2773.958779444041, -1439.3172221152324, -3297.045731465933, -3186.9826683111332, -2951.8427089761817, -1718.3656154791663, -2215.6645715363697, -2600.508418231695, -3036.361579446492, -3589.7163742843954, -3641.3681196694583, -2151.12878027608, -2482.3767554225565, -2096.966442247861, -2202.4929884533326, -1389.3407038637831, -1648.7134272518038, -3452.8224769354465, -3091.1869521915223, -2943.2196604883397, -992.5367948198332, -1848.6750225212645, -2555.1155502812967, -3332.001860517853, -2268.0293843429868, -2551.3527425907764, -1725.36869814347, -3844.376030450329, -853.626990816375, -1857.0991636620668, -519.0725209913834, -1481.457927030256, -2798.9906590508, -2070.042019803636, -2006.7384302841358, -4495.874171082003, -4012.8549446692077, -3187.2545911930247, -4306.660865939841, -1774.0593366726919, -894.4074941997814, -2414.0169177211956, -2403.90435373508, -2956.511952564481, -1669.1032730315749, -1966.0903980952748, -1032.8882981288086, -1665.2464370486073, -2894.2506240954617, -3466.3896847035408, -1995.8743789109865, -1157.9106161708341, -760.4360309164318, -2039.6855542907929, -3437.7630658148146, -1924.4890858700994, -3412.0842442763046, -1338.9129559338214, -2129.351089405416, -1572.6647140881946, -1695.4001859599816, -2601.7490959847355, -2727.9768997993842, -1334.0278861238266, -2278.3032536839282, -2305.8763486144667, -2914.040117383541, -2607.1116979674907, -3233.7558764856053, -3277.100814540583, -1679.6450344402404, -1603.5287860826274, -2187.499992300826, -4550.170179007368, -3805.062798915436, -2559.319829675051, -2136.8522434534707, -2453.2116863897713, -2921.5117541675886, -1902.5503828712626, -3653.1369414137316, -1062.2294672744367, -2564.1006337493345, -3125.8296473187324, -2643.294108640927, -1591.1367314109968, -4240.203212929481, -2496.1948140464, -3175.03101884248, -3718.2824473095034, -2795.6461792692307, -2196.212274323684, -2085.6738833564013, -2299.3209055443444, -1381.7555858891947, -1969.787990235648, -3603.036347570874, -3491.5577421013404], "episode_lengths": [150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 147, 150, 150, 150, 145, 103, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-633.3399841564174, -281.69963448141243, -136.45875849786674, -171.49331236975877, -1293.6661180518597, -557.2033588214392, -182.68855777473402, -996.222210678408, -203.03874208110344, -263.1714575106028, -985.8915540090017, -804.683347901041, -106.86856685732846, -249.93382781098387, -626.5814828656853, -513.0306779163234, -276.51881688916626, -318.4750239708188, -176.88682486489526, -154.40587847402824, -306.3514390118356, -644.8479641234137, -1030.5446780531465, -1104.6199955473342, -210.6816547302022, -623.2771694549243, -1263.3509899651924, -393.9448321226448, -737.6238413432794, -168.7858354250912, -264.63369716550255, -1315.5280277912414, -862.1055402461218, -435.43582240656366, -74.13962136675023, -326.20744325801934, -1087.900779652922, -35.07623591080761, -35.04090824987591, -234.14024840754138, -663.516175260481, -490.3921428387583, -310.6274675910082, -101.13067853609635, -649.998107310025, -1018.141680123913, -933.7358944042594, -4.837283116374589, -238.87555307220276, -404.91800751494407, -43.61932763957597, -416.5543105864019, -122.2162855188282, -1240.4863918646224, -1213.4852638370621, -360.2544422566667, -639.0682494091259, -941.3843959080235, -570.5650080573942, -1078.4442786531858, -1318.3144529165575, -95.430868207658, -286.3489294097387, -1322.656658899669, -618.6172102358316, -769.2338154272047, -609.5346949019458, -152.98991585948056, -528.6887323056131, -90.68162178183596, -715.7158237928056, -165.0978598651147, -482.95833684635903, -312.289879944511, -806.314854973768, -112.57321221059674, -1008.2019594066464, -240.15722170997853, -425.28079292301913, -310.75325599762135, -276.49561021384505, -937.8310720292855, -612.6077211712509, -232.439915470978, -143.11866956797314, -42.907504768527424, -240.91573992598302, -768.0686297643897, -214.81028985173216, -122.63853955315297, -131.76449656922568, -955.656663724172, -202.49511557964843, -86.29263615332964, -272.5045152254273, -1220.8788358746513, -1344.421361354105, -189.82566230081756, -649.7445062811609, -47.952111124712545, -1164.5584278589456, -534.378694660071, -442.37419425917983, -648.6891123385217, -301.1865230747997, -707.5742351385713, -417.8900477292923, -324.76197318956133, -1277.9274433108446, -215.06596112006613, -106.37396800776074, -115.89407252413054, -83.52781281969816, -44.2687574780163, -642.4721839902279, -682.9953105327063, -142.57270303564914, -172.520510075508, -0.14609559528942462, -850.4404032821107, -315.8727797751036, -642.835796679844, -856.662089690671, -95.3829339210058, -644.3619502146723, -775.504883661051, -1043.898263850628, -1118.8424831784741, -45.401404328382384, -348.35482549932084, -640.2555663099494, -399.8966378321836, -227.03343542106572, -314.21805100988837, -686.6256937699004, -712.2726430214237, -454.9741471750365, -638.4711687079416, -458.5674525672205, -287.0673311191504, -209.01742073246993, -930.8179437387005, -67.75428001396673, -99.3713500606234, -418.40770359771017, -676.5203762561382, -1513.8096042295479, -165.25214850613582, -125.17280507072655, -1363.6210963877807, -230.63576421414703, -22.54734460175313, -513.4347958112023, -41.63291884926371, -45.37616734000952, -117.00391330348567, -514.5828926767049, -305.6343967580804, -348.55996394186286, -571.3179969819324, -115.62152778322766, -22.969330524017387, -103.88784778103819, -142.47781030573574, -134.11600459736442, -472.5547653454057, -175.84231403288973, -235.5524780245153, -348.0821701329292, -249.42619949451773, -660.351258030541, -359.2085641668594, -121.41398307215447, -591.5265443000307, -1066.4903094812132, -584.0674625064146, -162.2852146306962, -245.78786092363933, -640.7921959458056, -437.1092857970795, -187.71110081339486, -859.9709480192776, -68.7860259066105, -672.4172791567978, -217.8530763880551, -349.4703935111172, -1376.877409623625, -1357.656715285347, -1287.4721104025086, -124.397542259406, -1056.3066950899076, -158.5835698668853, -1260.6813061149699, -893.0070626939937, -644.2763109034488, -899.513512155553, -426.945333447215, -851.773333750608, -434.9613194831715, -574.0610923564778, -669.3533196757669, -1314.6959597448003, -844.2111667724939, -1112.0479954759057, -366.3524242708764, -639.9133542221779, -140.6766313310182, -516.251026540534, -88.13429382028404, -389.08403075867795, -74.24136391151958, -391.5907876571483, -101.58868917034168, -252.54403636034246, -74.44261710042936, -341.5843026136486, -8.764688827092192, -1151.8368448883268, -215.4698715165841, -696.3612098755469, -321.3281517687206, -619.9430309371824, -424.9514513227703, -314.382424900204, -723.2992948062008, -96.01269716406199, -985.1184479589309, -1162.8785448243398, -97.32539467646343, -615.1768679406846, -199.72617024152026, -471.27523095550066, -209.20692257217218, -76.77448230191342, -712.1204669604676, -443.97601882357725, -852.6147172112069, -518.0346832491482, -128.83316154095573, -22.631817270387195, -116.51415037299974, -47.16023832926663, -139.11099547861036, -222.6129231610848, -507.4899907868477, -396.2011714296908, -774.7066782348295, -40.89779759365748, -340.54983529502493, -112.8909544954043, -451.750953164197, -72.74800529882867, -828.4157729350311, -1433.5442897943506, -107.79160290305292, -17.3340224341566, -1219.5937874203694, -174.89011002729018, -777.2327791878987, -1277.3389856338288, -557.0700613419332, -42.674486359457866, -490.3635866716187, -725.003356413714, -180.762888124262, -377.8058275993663, -363.81713340762195, -28.11605633131448, -233.2903595881992, -154.8812392443313, -111.53366565936703, -75.50875869295301, -55.123698924163975, -165.18978081698933, -353.0801268229592, -498.91486826613504, -70.73681234998251, -424.93329910557077, -377.21299027687354, -667.8875842922316, -1270.661389285282, -980.3547643755569, -399.5234431513709, -139.0618372792848, -648.1616317233184, -427.7630806622909, -1126.3150587944328, -97.41016237219273, -32.11144151184026, -240.88934252934354, -683.8206301155163, -1228.2364293285234, -483.9627711066587, -560.3406502624713, -455.7237634631381, -47.225969584183225, -275.0218851670286, -144.29786908672475, -121.9070470759582, -750.4601850199264, -24.832527771596215, -699.8760861936381, -86.25105240428005, -1029.3440394755087, -289.0473835603925, -105.16191373651878, -22.924931201000618, -1252.8721498625873, -143.13150884431158, -48.574210443775726, -169.25662722473902, -704.8456584186652, -154.31902431751922, -586.236585589076, -80.74229040998418, -980.3954154611895, -1092.4203924397489, -120.87589171181864, -170.7178838633962, -237.33951250858303, -845.9548710712253, -27.672291203375224, -586.2653556266802, -570.5148661078454, -697.5695157902584, -560.0973578845441, -20.911676801518347, -137.63140681826656, -117.54508988372054, -497.84235473577763, -785.4569038434821, -555.8330969075802, -139.47919182649434, -770.1019698642464, -27.432091242124063, -441.1745837542966, -701.3572767481892, -228.24692231411706, -863.5593763494801, -71.53818944838478, -410.05244044221945, -314.88683308976505, -39.71315943596286, -1315.1670196799198, -834.220664735669, -47.32583176864062, -155.37533730065894, -1149.236119848556, -374.48002705376746, -880.6943819958672, -312.75616478211555, -1377.2820260550136, -222.20964093298278, -147.33883575717152, -1174.1692089583232, -230.74206102966198, -439.71453496914114, -1081.1169612515553, -494.53024440756724, -1030.997012882655, -20.764713860637094, -77.1125289498801, -856.60525957568, -31.00144541952164, -694.1610866345202, -223.52300140640114, -264.07475687292316, -928.5794182427741, -120.52981216017218, -66.82179740035787, -902.2714586962841, -612.5122715981709, -566.5839488446563, -51.05717278856398, -55.07514037315069, -1186.2841179391598, -425.3205493989604, -929.254867731054, -994.5657054240019, -1014.7449385141898, -281.9085058683668, -239.60912606043468, -1215.4074939958314, -929.2648002732317, -1138.872872717574, -641.486953177162, -331.9888364839995, -113.95871732060483, -364.82634020147134, -1107.0589824918138, -782.5781620091642, -498.1093020769653, -232.45793203734274, -339.8127593478524, -283.89408798214663, -213.6360738268402, -621.1800269039486, -1118.5032947423692, -402.1326011031538, -97.75968981345892, -623.4049397090187, -130.25233239776173, -242.62084090686295, -1182.2878136690663, -742.945827484878, -60.9591799589937, -573.5180647520299, -603.2981345918589, -223.37185121752776, -441.40315235085393, -923.490412101087, -618.3834570247537, -1378.0888892910873, -155.76223402028165, -577.4119489765243, -160.30968713806524, -196.18161712394718, -61.457894696765806, -48.28875315416573, -595.9915151614928, -420.434330442804, -21.41407553101728, -857.8412259791367, -262.11912586082667, -1002.2918759355493, -506.9833656911398, -1342.7825837947348, -374.6972892701732, -61.34923182094915, -840.0171767417328, -936.3340244877681, -104.0098051791753, -320.5067125607155, -1142.9729137686593, -139.4706526446112, -704.1811751962657, 3.8445733026431324, -190.15296735657554, -571.1443072740956, -129.50285488670175, -984.307804581754, -618.2404482966958, -561.4187992438927, -1149.8315751300138, -926.4045856771315, -476.5078446802431, -494.61511227764925, -1090.5498584430595, -30.364477554795606, -404.15752109065465, -568.1196275712052, -80.32535236742352, -583.6965361931301, -1053.9195829954715, -888.9699197152479, -95.77387352205939, -775.4698388079432, -1026.6886451539242, -686.9227722960568, -1133.4273175295245, -1146.0665947093794, -104.73718448219255, -145.1684650876345, -658.4616465868784, -741.2122884031479, -92.42274483575392, -972.8438984480355, 1.2036979930919443, -498.9461240230583, -633.2032050099269, -366.72952106075167, -659.1462567448648, -281.499001253546, -529.7799605091864, -248.51914378805384, -594.4102613476582, -493.09334215519766, -340.18580705343925, -531.2297332004784, -340.40176178756997, -434.6511036418068, -75.66527165844734, -592.3485374157916, -280.2993168382032, 1.208643665054752, -271.7664071319106, -610.1960985580861, -588.2338832488449, -195.6584685193303, -303.9331327774768, -588.4007316733446, -659.5473476269243, -176.67764007029706, -1026.5005652632144, -1151.9100629370928, -1248.01566281573, -265.7527703800484, -86.2340384091146, -663.0070098076875, -1228.5482606887592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5607759773261776, "mean_inference_ms": 1.7277591571809487, "mean_action_processing_ms": 0.8186450470681166, "mean_env_wait_ms": 10.46349789707664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013402223587036133, "StateBufferConnector_ms": 0.009393453598022461, "ViewRequirementAgentConnector_ms": 0.31104111671447754}, "num_episodes": 30, "episode_return_max": -519.0725209913834, "episode_return_min": -4550.170179007368, "episode_return_mean": -2451.086557794531, "episodes_this_iter": 30}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1163493, "num_agent_steps_trained": 1163493, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.55800545125385, "num_env_steps_trained_throughput_per_sec": 70.55800545125385, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1163493, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1163493, "timers": {"training_iteration_time_ms": 48290.318, "restore_workers_time_ms": 0.026, "training_step_time_ms": 48290.245, "sample_time_ms": 3236.109, "learn_time_ms": 44993.926, "learn_throughput": 88.901, "synch_weights_time_ms": 57.058}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1163493, "num_agent_steps_trained": 1163493}, "done": false, "training_iteration": 66, "trial_id": "05c72_00000", "date": "2024-07-26_15-37-37", "timestamp": 1721988457, "time_this_iter_s": 56.703112840652466, "time_total_s": 3275.752667427063, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e6b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3275.752667427063, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 11.26125, "ram_util_percent": 30.555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.48639742533365, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.781781103394248, "policy_loss": 0.0025600162166691596, "vf_loss": 4.790186224561749, "vf_explained_var": 0.9827051622480072, "kl": 0.028056809911504388, "entropy": 2.5168892325120193, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.49586776859505, "num_grad_updates_lifetime": 275565.5, "diff_num_grad_updates_vs_sampler_policy": 1814.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1178920, "num_agent_steps_trained": 1178920}, "env_runners": {"episode_reward_max": -519.0725209913834, "episode_reward_min": -4550.170179007368, "episode_reward_mean": -2384.3993215557975, "episode_len_mean": 147.46, "episode_media": {}, "episodes_timesteps_total": 14746, "policy_reward_min": {"policy_0": -1513.8096042295479}, "policy_reward_max": {"policy_0": 3.8445733026431324}, "policy_reward_mean": {"policy_0": -476.87986431115957}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1848.6750225212645, -2555.1155502812967, -3332.001860517853, -2268.0293843429868, -2551.3527425907764, -1725.36869814347, -3844.376030450329, -853.626990816375, -1857.0991636620668, -519.0725209913834, -1481.457927030256, -2798.9906590508, -2070.042019803636, -2006.7384302841358, -4495.874171082003, -4012.8549446692077, -3187.2545911930247, -4306.660865939841, -1774.0593366726919, -894.4074941997814, -2414.0169177211956, -2403.90435373508, -2956.511952564481, -1669.1032730315749, -1966.0903980952748, -1032.8882981288086, -1665.2464370486073, -2894.2506240954617, -3466.3896847035408, -1995.8743789109865, -1157.9106161708341, -760.4360309164318, -2039.6855542907929, -3437.7630658148146, -1924.4890858700994, -3412.0842442763046, -1338.9129559338214, -2129.351089405416, -1572.6647140881946, -1695.4001859599816, -2601.7490959847355, -2727.9768997993842, -1334.0278861238266, -2278.3032536839282, -2305.8763486144667, -2914.040117383541, -2607.1116979674907, -3233.7558764856053, -3277.100814540583, -1679.6450344402404, -1603.5287860826274, -2187.499992300826, -4550.170179007368, -3805.062798915436, -2559.319829675051, -2136.8522434534707, -2453.2116863897713, -2921.5117541675886, -1902.5503828712626, -3653.1369414137316, -1062.2294672744367, -2564.1006337493345, -3125.8296473187324, -2643.294108640927, -1591.1367314109968, -4240.203212929481, -2496.1948140464, -3175.03101884248, -3718.2824473095034, -2795.6461792692307, -2196.212274323684, -2085.6738833564013, -2299.3209055443444, -1381.7555858891947, -1969.787990235648, -3603.036347570874, -3491.5577421013404, -2071.6549460291208, -2622.0043457009815, -1710.2479106344551, -2186.6179407075224, -1766.286612853623, -2363.737269176649, -3056.528264997004, -822.9668271253842, -2634.407883093365, -1754.976009106657, -2272.16054171392, -2010.3413380009172, -2527.1939404694012, -1368.0529150916273, -2343.733894413201, -4041.1246125082803, -2424.904170183213, -2114.3925553499785, -1740.6676829539456, -1811.1647671397789, -1865.654188377995, -2514.9557010343074, -2928.400964799613], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 147, 150, 150, 150, 145, 103, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-682.9953105327063, -142.57270303564914, -172.520510075508, -0.14609559528942462, -850.4404032821107, -315.8727797751036, -642.835796679844, -856.662089690671, -95.3829339210058, -644.3619502146723, -775.504883661051, -1043.898263850628, -1118.8424831784741, -45.401404328382384, -348.35482549932084, -640.2555663099494, -399.8966378321836, -227.03343542106572, -314.21805100988837, -686.6256937699004, -712.2726430214237, -454.9741471750365, -638.4711687079416, -458.5674525672205, -287.0673311191504, -209.01742073246993, -930.8179437387005, -67.75428001396673, -99.3713500606234, -418.40770359771017, -676.5203762561382, -1513.8096042295479, -165.25214850613582, -125.17280507072655, -1363.6210963877807, -230.63576421414703, -22.54734460175313, -513.4347958112023, -41.63291884926371, -45.37616734000952, -117.00391330348567, -514.5828926767049, -305.6343967580804, -348.55996394186286, -571.3179969819324, -115.62152778322766, -22.969330524017387, -103.88784778103819, -142.47781030573574, -134.11600459736442, -472.5547653454057, -175.84231403288973, -235.5524780245153, -348.0821701329292, -249.42619949451773, -660.351258030541, -359.2085641668594, -121.41398307215447, -591.5265443000307, -1066.4903094812132, -584.0674625064146, -162.2852146306962, -245.78786092363933, -640.7921959458056, -437.1092857970795, -187.71110081339486, -859.9709480192776, -68.7860259066105, -672.4172791567978, -217.8530763880551, -349.4703935111172, -1376.877409623625, -1357.656715285347, -1287.4721104025086, -124.397542259406, -1056.3066950899076, -158.5835698668853, -1260.6813061149699, -893.0070626939937, -644.2763109034488, -899.513512155553, -426.945333447215, -851.773333750608, -434.9613194831715, -574.0610923564778, -669.3533196757669, -1314.6959597448003, -844.2111667724939, -1112.0479954759057, -366.3524242708764, -639.9133542221779, -140.6766313310182, -516.251026540534, -88.13429382028404, -389.08403075867795, -74.24136391151958, -391.5907876571483, -101.58868917034168, -252.54403636034246, -74.44261710042936, -341.5843026136486, -8.764688827092192, -1151.8368448883268, -215.4698715165841, -696.3612098755469, -321.3281517687206, -619.9430309371824, -424.9514513227703, -314.382424900204, -723.2992948062008, -96.01269716406199, -985.1184479589309, -1162.8785448243398, -97.32539467646343, -615.1768679406846, -199.72617024152026, -471.27523095550066, -209.20692257217218, -76.77448230191342, -712.1204669604676, -443.97601882357725, -852.6147172112069, -518.0346832491482, -128.83316154095573, -22.631817270387195, -116.51415037299974, -47.16023832926663, -139.11099547861036, -222.6129231610848, -507.4899907868477, -396.2011714296908, -774.7066782348295, -40.89779759365748, -340.54983529502493, -112.8909544954043, -451.750953164197, -72.74800529882867, -828.4157729350311, -1433.5442897943506, -107.79160290305292, -17.3340224341566, -1219.5937874203694, -174.89011002729018, -777.2327791878987, -1277.3389856338288, -557.0700613419332, -42.674486359457866, -490.3635866716187, -725.003356413714, -180.762888124262, -377.8058275993663, -363.81713340762195, -28.11605633131448, -233.2903595881992, -154.8812392443313, -111.53366565936703, -75.50875869295301, -55.123698924163975, -165.18978081698933, -353.0801268229592, -498.91486826613504, -70.73681234998251, -424.93329910557077, -377.21299027687354, -667.8875842922316, -1270.661389285282, -980.3547643755569, -399.5234431513709, -139.0618372792848, -648.1616317233184, -427.7630806622909, -1126.3150587944328, -97.41016237219273, -32.11144151184026, -240.88934252934354, -683.8206301155163, -1228.2364293285234, -483.9627711066587, -560.3406502624713, -455.7237634631381, -47.225969584183225, -275.0218851670286, -144.29786908672475, -121.9070470759582, -750.4601850199264, -24.832527771596215, -699.8760861936381, -86.25105240428005, -1029.3440394755087, -289.0473835603925, -105.16191373651878, -22.924931201000618, -1252.8721498625873, -143.13150884431158, -48.574210443775726, -169.25662722473902, -704.8456584186652, -154.31902431751922, -586.236585589076, -80.74229040998418, -980.3954154611895, -1092.4203924397489, -120.87589171181864, -170.7178838633962, -237.33951250858303, -845.9548710712253, -27.672291203375224, -586.2653556266802, -570.5148661078454, -697.5695157902584, -560.0973578845441, -20.911676801518347, -137.63140681826656, -117.54508988372054, -497.84235473577763, -785.4569038434821, -555.8330969075802, -139.47919182649434, -770.1019698642464, -27.432091242124063, -441.1745837542966, -701.3572767481892, -228.24692231411706, -863.5593763494801, -71.53818944838478, -410.05244044221945, -314.88683308976505, -39.71315943596286, -1315.1670196799198, -834.220664735669, -47.32583176864062, -155.37533730065894, -1149.236119848556, -374.48002705376746, -880.6943819958672, -312.75616478211555, -1377.2820260550136, -222.20964093298278, -147.33883575717152, -1174.1692089583232, -230.74206102966198, -439.71453496914114, -1081.1169612515553, -494.53024440756724, -1030.997012882655, -20.764713860637094, -77.1125289498801, -856.60525957568, -31.00144541952164, -694.1610866345202, -223.52300140640114, -264.07475687292316, -928.5794182427741, -120.52981216017218, -66.82179740035787, -902.2714586962841, -612.5122715981709, -566.5839488446563, -51.05717278856398, -55.07514037315069, -1186.2841179391598, -425.3205493989604, -929.254867731054, -994.5657054240019, -1014.7449385141898, -281.9085058683668, -239.60912606043468, -1215.4074939958314, -929.2648002732317, -1138.872872717574, -641.486953177162, -331.9888364839995, -113.95871732060483, -364.82634020147134, -1107.0589824918138, -782.5781620091642, -498.1093020769653, -232.45793203734274, -339.8127593478524, -283.89408798214663, -213.6360738268402, -621.1800269039486, -1118.5032947423692, -402.1326011031538, -97.75968981345892, -623.4049397090187, -130.25233239776173, -242.62084090686295, -1182.2878136690663, -742.945827484878, -60.9591799589937, -573.5180647520299, -603.2981345918589, -223.37185121752776, -441.40315235085393, -923.490412101087, -618.3834570247537, -1378.0888892910873, -155.76223402028165, -577.4119489765243, -160.30968713806524, -196.18161712394718, -61.457894696765806, -48.28875315416573, -595.9915151614928, -420.434330442804, -21.41407553101728, -857.8412259791367, -262.11912586082667, -1002.2918759355493, -506.9833656911398, -1342.7825837947348, -374.6972892701732, -61.34923182094915, -840.0171767417328, -936.3340244877681, -104.0098051791753, -320.5067125607155, -1142.9729137686593, -139.4706526446112, -704.1811751962657, 3.8445733026431324, -190.15296735657554, -571.1443072740956, -129.50285488670175, -984.307804581754, -618.2404482966958, -561.4187992438927, -1149.8315751300138, -926.4045856771315, -476.5078446802431, -494.61511227764925, -1090.5498584430595, -30.364477554795606, -404.15752109065465, -568.1196275712052, -80.32535236742352, -583.6965361931301, -1053.9195829954715, -888.9699197152479, -95.77387352205939, -775.4698388079432, -1026.6886451539242, -686.9227722960568, -1133.4273175295245, -1146.0665947093794, -104.73718448219255, -145.1684650876345, -658.4616465868784, -741.2122884031479, -92.42274483575392, -972.8438984480355, 1.2036979930919443, -498.9461240230583, -633.2032050099269, -366.72952106075167, -659.1462567448648, -281.499001253546, -529.7799605091864, -248.51914378805384, -594.4102613476582, -493.09334215519766, -340.18580705343925, -531.2297332004784, -340.40176178756997, -434.6511036418068, -75.66527165844734, -592.3485374157916, -280.2993168382032, 1.208643665054752, -271.7664071319106, -610.1960985580861, -588.2338832488449, -195.6584685193303, -303.9331327774768, -588.4007316733446, -659.5473476269243, -176.67764007029706, -1026.5005652632144, -1151.9100629370928, -1248.01566281573, -265.7527703800484, -86.2340384091146, -663.0070098076875, -1228.5482606887592, -55.26685701545621, -142.19251100092026, -174.67167433765093, -341.98961596411834, -1357.5342877109765, -1307.3885763634923, -104.6314553440198, -178.78035901972385, -545.9572308185566, -485.24672415519063, -825.6272125242456, -18.696947574308403, -217.6804334666862, -170.71203934034676, -477.53127772886745, -25.839777078477113, -1106.057522961651, -816.1969540513529, -161.3553267512444, -77.16835986479484, -140.4762417003867, -200.39772307268686, -84.13652760708052, -102.8416425063821, -1238.4344779670882, -58.128481513365585, -587.0756244684745, -12.107799857768702, -948.9592631060289, -757.4661002310095, -738.4756936760909, -870.7011133056452, -357.05654875385085, -622.565456767938, -467.7294524934803, -67.62513342796683, -70.99239591145675, -373.9781707224481, -175.3586945213397, -135.0124325421733, -84.28590336327791, -105.70564873666095, -1274.5965343910786, -581.8324125656036, -587.9873840367455, -735.3437805777488, -26.701759608231324, -229.59978613082842, -488.5241885619071, -274.80649422794176, -181.92955875377027, -482.20503161316054, -391.306557224205, -318.0733883428062, -898.6460057799767, -393.4739009278082, -72.81620050234794, -984.6897800298852, -254.9751200842541, -304.3863364566196, -540.5589176540624, -537.6719350970748, -837.0280631332473, -467.5958031142737, -144.33922147074293, -856.2649893751376, -199.97758728960426, -59.36220807665737, -180.88116491928008, -71.56696543094799, -1418.7206876918153, -7.677777693952843, -32.041812118670926, -699.02276606412, -186.2708508446417, -511.4635212719975, -698.1797464152235, -945.8409387711106, -1071.542924382114, -814.0974816678367, -998.9715924335005, -225.73610259607847, -539.7249174619724, -326.61086982990963, -333.8606878617533, -421.35866635795213, -640.4350901972128, -108.99374905368784, -375.03512869687506, -568.5699210442506, -473.9463017485779, -695.5223448081179, -207.40733353304933, -30.38222581978802, -333.40947704441277, -47.590322045518036, -254.80110365242112, -779.0183578672022, -640.4270809973043, -89.32790257733286, -16.032067301433447, -607.1965844234923, -665.7708742899628, -220.03114007222382, -356.62352229088117, -132.40457031987594, -757.8962539172659, -437.23321804483453, -431.31638632647423, -756.1052724258553, -244.64325094693757, -1186.0003598920441, -812.3697619535559, -116.82246349614088, -568.5651285109344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5607984636175893, "mean_inference_ms": 1.7274500052453396, "mean_action_processing_ms": 0.8172449163345098, "mean_env_wait_ms": 10.456540005523957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01333761215209961, "StateBufferConnector_ms": 0.009313821792602539, "ViewRequirementAgentConnector_ms": 0.3051486015319824}, "num_episodes": 23, "episode_return_max": -519.0725209913834, "episode_return_min": -4550.170179007368, "episode_return_mean": -2384.3993215557975, "episodes_this_iter": 23}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1178920, "num_agent_steps_trained": 1178920, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.39447209081719, "num_env_steps_trained_throughput_per_sec": 87.39447209081719, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1178920, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1178920, "timers": {"training_iteration_time_ms": 48373.626, "restore_workers_time_ms": 0.026, "training_step_time_ms": 48373.553, "sample_time_ms": 3229.165, "learn_time_ms": 45084.133, "learn_throughput": 88.723, "synch_weights_time_ms": 57.146}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1178920, "num_agent_steps_trained": 1178920}, "done": false, "training_iteration": 67, "trial_id": "05c72_00000", "date": "2024-07-26_15-38-23", "timestamp": 1721988503, "time_this_iter_s": 45.78078007698059, "time_total_s": 3321.5334475040436, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd0148b80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3321.5334475040436, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 11.76, "ram_util_percent": 30.510769230769228}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 159.40291751104456, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.5730272961633505, "policy_loss": -0.0018811401455193929, "vf_loss": 4.589583679980601, "vf_explained_var": 0.9879733459640095, "kl": 0.01491047480545284, "entropy": 2.5997881974882753, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.77099236641222, "num_grad_updates_lifetime": 279345.5, "diff_num_grad_updates_vs_sampler_policy": 1964.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1195658, "num_agent_steps_trained": 1195658}, "env_runners": {"episode_reward_max": -760.4360309164318, "episode_reward_min": -4550.170179007368, "episode_reward_mean": -2432.4636249191954, "episode_len_mean": 147.88, "episode_media": {}, "episodes_timesteps_total": 14788, "policy_reward_min": {"policy_0": -1474.1216595404026}, "policy_reward_max": {"policy_0": 3.8445733026431324}, "policy_reward_mean": {"policy_0": -486.4927249838391}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3466.3896847035408, -1995.8743789109865, -1157.9106161708341, -760.4360309164318, -2039.6855542907929, -3437.7630658148146, -1924.4890858700994, -3412.0842442763046, -1338.9129559338214, -2129.351089405416, -1572.6647140881946, -1695.4001859599816, -2601.7490959847355, -2727.9768997993842, -1334.0278861238266, -2278.3032536839282, -2305.8763486144667, -2914.040117383541, -2607.1116979674907, -3233.7558764856053, -3277.100814540583, -1679.6450344402404, -1603.5287860826274, -2187.499992300826, -4550.170179007368, -3805.062798915436, -2559.319829675051, -2136.8522434534707, -2453.2116863897713, -2921.5117541675886, -1902.5503828712626, -3653.1369414137316, -1062.2294672744367, -2564.1006337493345, -3125.8296473187324, -2643.294108640927, -1591.1367314109968, -4240.203212929481, -2496.1948140464, -3175.03101884248, -3718.2824473095034, -2795.6461792692307, -2196.212274323684, -2085.6738833564013, -2299.3209055443444, -1381.7555858891947, -1969.787990235648, -3603.036347570874, -3491.5577421013404, -2071.6549460291208, -2622.0043457009815, -1710.2479106344551, -2186.6179407075224, -1766.286612853623, -2363.737269176649, -3056.528264997004, -822.9668271253842, -2634.407883093365, -1754.976009106657, -2272.16054171392, -2010.3413380009172, -2527.1939404694012, -1368.0529150916273, -2343.733894413201, -4041.1246125082803, -2424.904170183213, -2114.3925553499785, -1740.6676829539456, -1811.1647671397789, -1865.654188377995, -2514.9557010343074, -2928.400964799613, -1466.0616694766863, -3835.497398313324, -1966.750712374839, -3159.707336759577, -910.9185356364198, -2726.283212619869, -4089.3804499681673, -3258.2934055141245, -4348.294906812707, -2744.784545123137, -2739.5508268825743, -1874.331114346138, -1543.0150995348604, -4041.963522854516, -854.0983173578647, -1274.9310858690446, -1745.678312608475, -1501.4155718766117, -3009.687762671292, -3812.9315327753147, -2652.9334780824825, -2569.757182638849, -1392.7558229361584, -1791.1804236611215, -2817.93186212241, -3446.6285502160213, -2514.2933143881673, -2102.445041582661], "episode_lengths": [150, 145, 103, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-17.3340224341566, -1219.5937874203694, -174.89011002729018, -777.2327791878987, -1277.3389856338288, -557.0700613419332, -42.674486359457866, -490.3635866716187, -725.003356413714, -180.762888124262, -377.8058275993663, -363.81713340762195, -28.11605633131448, -233.2903595881992, -154.8812392443313, -111.53366565936703, -75.50875869295301, -55.123698924163975, -165.18978081698933, -353.0801268229592, -498.91486826613504, -70.73681234998251, -424.93329910557077, -377.21299027687354, -667.8875842922316, -1270.661389285282, -980.3547643755569, -399.5234431513709, -139.0618372792848, -648.1616317233184, -427.7630806622909, -1126.3150587944328, -97.41016237219273, -32.11144151184026, -240.88934252934354, -683.8206301155163, -1228.2364293285234, -483.9627711066587, -560.3406502624713, -455.7237634631381, -47.225969584183225, -275.0218851670286, -144.29786908672475, -121.9070470759582, -750.4601850199264, -24.832527771596215, -699.8760861936381, -86.25105240428005, -1029.3440394755087, -289.0473835603925, -105.16191373651878, -22.924931201000618, -1252.8721498625873, -143.13150884431158, -48.574210443775726, -169.25662722473902, -704.8456584186652, -154.31902431751922, -586.236585589076, -80.74229040998418, -980.3954154611895, -1092.4203924397489, -120.87589171181864, -170.7178838633962, -237.33951250858303, -845.9548710712253, -27.672291203375224, -586.2653556266802, -570.5148661078454, -697.5695157902584, -560.0973578845441, -20.911676801518347, -137.63140681826656, -117.54508988372054, -497.84235473577763, -785.4569038434821, -555.8330969075802, -139.47919182649434, -770.1019698642464, -27.432091242124063, -441.1745837542966, -701.3572767481892, -228.24692231411706, -863.5593763494801, -71.53818944838478, -410.05244044221945, -314.88683308976505, -39.71315943596286, -1315.1670196799198, -834.220664735669, -47.32583176864062, -155.37533730065894, -1149.236119848556, -374.48002705376746, -880.6943819958672, -312.75616478211555, -1377.2820260550136, -222.20964093298278, -147.33883575717152, -1174.1692089583232, -230.74206102966198, -439.71453496914114, -1081.1169612515553, -494.53024440756724, -1030.997012882655, -20.764713860637094, -77.1125289498801, -856.60525957568, -31.00144541952164, -694.1610866345202, -223.52300140640114, -264.07475687292316, -928.5794182427741, -120.52981216017218, -66.82179740035787, -902.2714586962841, -612.5122715981709, -566.5839488446563, -51.05717278856398, -55.07514037315069, -1186.2841179391598, -425.3205493989604, -929.254867731054, -994.5657054240019, -1014.7449385141898, -281.9085058683668, -239.60912606043468, -1215.4074939958314, -929.2648002732317, -1138.872872717574, -641.486953177162, -331.9888364839995, -113.95871732060483, -364.82634020147134, -1107.0589824918138, -782.5781620091642, -498.1093020769653, -232.45793203734274, -339.8127593478524, -283.89408798214663, -213.6360738268402, -621.1800269039486, -1118.5032947423692, -402.1326011031538, -97.75968981345892, -623.4049397090187, -130.25233239776173, -242.62084090686295, -1182.2878136690663, -742.945827484878, -60.9591799589937, -573.5180647520299, -603.2981345918589, -223.37185121752776, -441.40315235085393, -923.490412101087, -618.3834570247537, -1378.0888892910873, -155.76223402028165, -577.4119489765243, -160.30968713806524, -196.18161712394718, -61.457894696765806, -48.28875315416573, -595.9915151614928, -420.434330442804, -21.41407553101728, -857.8412259791367, -262.11912586082667, -1002.2918759355493, -506.9833656911398, -1342.7825837947348, -374.6972892701732, -61.34923182094915, -840.0171767417328, -936.3340244877681, -104.0098051791753, -320.5067125607155, -1142.9729137686593, -139.4706526446112, -704.1811751962657, 3.8445733026431324, -190.15296735657554, -571.1443072740956, -129.50285488670175, -984.307804581754, -618.2404482966958, -561.4187992438927, -1149.8315751300138, -926.4045856771315, -476.5078446802431, -494.61511227764925, -1090.5498584430595, -30.364477554795606, -404.15752109065465, -568.1196275712052, -80.32535236742352, -583.6965361931301, -1053.9195829954715, -888.9699197152479, -95.77387352205939, -775.4698388079432, -1026.6886451539242, -686.9227722960568, -1133.4273175295245, -1146.0665947093794, -104.73718448219255, -145.1684650876345, -658.4616465868784, -741.2122884031479, -92.42274483575392, -972.8438984480355, 1.2036979930919443, -498.9461240230583, -633.2032050099269, -366.72952106075167, -659.1462567448648, -281.499001253546, -529.7799605091864, -248.51914378805384, -594.4102613476582, -493.09334215519766, -340.18580705343925, -531.2297332004784, -340.40176178756997, -434.6511036418068, -75.66527165844734, -592.3485374157916, -280.2993168382032, 1.208643665054752, -271.7664071319106, -610.1960985580861, -588.2338832488449, -195.6584685193303, -303.9331327774768, -588.4007316733446, -659.5473476269243, -176.67764007029706, -1026.5005652632144, -1151.9100629370928, -1248.01566281573, -265.7527703800484, -86.2340384091146, -663.0070098076875, -1228.5482606887592, -55.26685701545621, -142.19251100092026, -174.67167433765093, -341.98961596411834, -1357.5342877109765, -1307.3885763634923, -104.6314553440198, -178.78035901972385, -545.9572308185566, -485.24672415519063, -825.6272125242456, -18.696947574308403, -217.6804334666862, -170.71203934034676, -477.53127772886745, -25.839777078477113, -1106.057522961651, -816.1969540513529, -161.3553267512444, -77.16835986479484, -140.4762417003867, -200.39772307268686, -84.13652760708052, -102.8416425063821, -1238.4344779670882, -58.128481513365585, -587.0756244684745, -12.107799857768702, -948.9592631060289, -757.4661002310095, -738.4756936760909, -870.7011133056452, -357.05654875385085, -622.565456767938, -467.7294524934803, -67.62513342796683, -70.99239591145675, -373.9781707224481, -175.3586945213397, -135.0124325421733, -84.28590336327791, -105.70564873666095, -1274.5965343910786, -581.8324125656036, -587.9873840367455, -735.3437805777488, -26.701759608231324, -229.59978613082842, -488.5241885619071, -274.80649422794176, -181.92955875377027, -482.20503161316054, -391.306557224205, -318.0733883428062, -898.6460057799767, -393.4739009278082, -72.81620050234794, -984.6897800298852, -254.9751200842541, -304.3863364566196, -540.5589176540624, -537.6719350970748, -837.0280631332473, -467.5958031142737, -144.33922147074293, -856.2649893751376, -199.97758728960426, -59.36220807665737, -180.88116491928008, -71.56696543094799, -1418.7206876918153, -7.677777693952843, -32.041812118670926, -699.02276606412, -186.2708508446417, -511.4635212719975, -698.1797464152235, -945.8409387711106, -1071.542924382114, -814.0974816678367, -998.9715924335005, -225.73610259607847, -539.7249174619724, -326.61086982990963, -333.8606878617533, -421.35866635795213, -640.4350901972128, -108.99374905368784, -375.03512869687506, -568.5699210442506, -473.9463017485779, -695.5223448081179, -207.40733353304933, -30.38222581978802, -333.40947704441277, -47.590322045518036, -254.80110365242112, -779.0183578672022, -640.4270809973043, -89.32790257733286, -16.032067301433447, -607.1965844234923, -665.7708742899628, -220.03114007222382, -356.62352229088117, -132.40457031987594, -757.8962539172659, -437.23321804483453, -431.31638632647423, -756.1052724258553, -244.64325094693757, -1186.0003598920441, -812.3697619535559, -116.82246349614088, -568.5651285109344, -46.707011391839316, -507.0203311800224, -11.377281387921263, -873.7502293280488, -27.206816188855406, -666.4405343605165, -1474.1216595404026, -1254.036246436654, -94.0522138817339, -346.84674409401714, -251.61394590332887, -42.827684919432436, -336.6183989476335, -685.4671033251389, -650.223579279305, -734.3119025786694, -804.5308406362532, -501.76454003027794, -1050.6691526232403, -68.43090089113204, -265.69937259439433, -107.41167019121913, -38.45554019607109, -134.0044220814807, -365.3475305732543, -778.4871993776837, -515.4314757841611, -43.690006157351746, -542.4451309747863, -846.2294003258864, -457.14087201798907, -913.4209593695538, -1009.0483679584951, -846.2266965492008, -863.543554072925, -320.5282401798509, -702.1135065745684, -530.6697198756435, -547.8212052907221, -1157.1607335933368, -711.7425857249641, -512.0509082786266, -1458.397669606909, -552.8562732807106, -1113.2474699214988, -214.27181058189612, -1296.2027839687084, -95.25378463668095, -639.1648519065291, -499.8913140293232, -818.5751755601779, -196.50358750921131, -402.7029747901156, -473.4267247416594, -848.3423642814098, -96.57231332613853, -409.2843016296842, -212.0378899395982, -338.95788849015395, -817.4787209605627, -262.7499221778552, -860.180918433291, -131.04117901312142, -145.40512079808812, -143.63795911250386, -769.4205710626384, -712.5595534825605, -217.8609498258651, -1326.453536587229, -1015.6689118962186, -481.90397095652145, -76.22862188256414, -21.757247921920374, -21.328383066715674, -252.8800935301423, -160.11100641685928, -748.2367343823419, -184.2316557731623, -32.04473378121463, -150.30695551546594, -443.58284805826577, -243.96309131621686, -688.9244884568816, -108.39623479976733, -260.8116499773432, -871.1645338798044, -40.07937543006216, -208.94566574657085, -133.6916555899664, -247.5343412302087, -450.5264332359573, -994.2538033586032, -1210.8853763112895, -47.20962618153229, -306.8125235839095, -70.35822683662843, -770.396541762508, -1351.0551467033008, -1202.665157736, -418.45645973688084, -1342.2787528186814, -217.91593105095737, -237.33146055756978, -92.09975661513894, -763.3075770401364, -849.6917537361508, -553.1997992090222, -81.21934161718558, -1065.7590390569221, -19.88724901957015, -672.8172335553897, -168.75559485105134, -244.58761499615767, -247.46979605766035, -59.125583475899205, -192.54777052723597, -130.22549533717321, -49.68535315355804, -1009.6825177167516, -409.03928692640284, -668.720460485359, -540.9358319984111, -738.2572434293899, -799.5862982710771, -70.43202793817034, -733.930149178579, -412.5052447649936, -1296.821328403883, -130.2156928187044, -873.1561350498638, -273.32904693579707, -792.8610316165236, -22.133580957295926, -1034.6924308583193, -391.2772240202314, -681.9375289503765, -157.79277586105775, -533.7789635475882, -122.79780381770139, -606.1379694059394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5581081078380774, "mean_inference_ms": 1.7266708111679492, "mean_action_processing_ms": 0.8161611367983491, "mean_env_wait_ms": 10.440933848913698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013106822967529297, "StateBufferConnector_ms": 0.009285688400268555, "ViewRequirementAgentConnector_ms": 0.306882381439209}, "num_episodes": 28, "episode_return_max": -760.4360309164318, "episode_return_min": -4550.170179007368, "episode_return_mean": -2432.4636249191954, "episodes_this_iter": 28}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1195658, "num_agent_steps_trained": 1195658, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 86.19398515012402, "num_env_steps_trained_throughput_per_sec": 86.19398515012402, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1195658, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1195658, "timers": {"training_iteration_time_ms": 49075.983, "restore_workers_time_ms": 0.029, "training_step_time_ms": 49075.904, "sample_time_ms": 3230.853, "learn_time_ms": 45781.385, "learn_throughput": 87.372, "synch_weights_time_ms": 60.525}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1195658, "num_agent_steps_trained": 1195658}, "done": false, "training_iteration": 68, "trial_id": "05c72_00000", "date": "2024-07-26_15-39-09", "timestamp": 1721988549, "time_this_iter_s": 46.41778087615967, "time_total_s": 3367.9512283802032, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00df7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3367.9512283802032, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 11.656060606060606, "ram_util_percent": 30.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.42685976482574, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.023987446751511, "policy_loss": -0.004233323259601243, "vf_loss": 5.042860197722165, "vf_explained_var": 0.9840179279633333, "kl": 0.014373745885444222, "entropy": 2.555449655241237, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.80451127819549, "num_grad_updates_lifetime": 283305.5, "diff_num_grad_updates_vs_sampler_policy": 1994.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1212656, "num_agent_steps_trained": 1212656}, "env_runners": {"episode_reward_max": -822.9668271253842, "episode_reward_min": -4515.525476119021, "episode_reward_mean": -2388.930474942712, "episode_len_mean": 148.57, "episode_media": {}, "episodes_timesteps_total": 14857, "policy_reward_min": {"policy_0": -1474.1216595404026}, "policy_reward_max": {"policy_0": 3.8445733026431324}, "policy_reward_mean": {"policy_0": -477.78609498854246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2921.5117541675886, -1902.5503828712626, -3653.1369414137316, -1062.2294672744367, -2564.1006337493345, -3125.8296473187324, -2643.294108640927, -1591.1367314109968, -4240.203212929481, -2496.1948140464, -3175.03101884248, -3718.2824473095034, -2795.6461792692307, -2196.212274323684, -2085.6738833564013, -2299.3209055443444, -1381.7555858891947, -1969.787990235648, -3603.036347570874, -3491.5577421013404, -2071.6549460291208, -2622.0043457009815, -1710.2479106344551, -2186.6179407075224, -1766.286612853623, -2363.737269176649, -3056.528264997004, -822.9668271253842, -2634.407883093365, -1754.976009106657, -2272.16054171392, -2010.3413380009172, -2527.1939404694012, -1368.0529150916273, -2343.733894413201, -4041.1246125082803, -2424.904170183213, -2114.3925553499785, -1740.6676829539456, -1811.1647671397789, -1865.654188377995, -2514.9557010343074, -2928.400964799613, -1466.0616694766863, -3835.497398313324, -1966.750712374839, -3159.707336759577, -910.9185356364198, -2726.283212619869, -4089.3804499681673, -3258.2934055141245, -4348.294906812707, -2744.784545123137, -2739.5508268825743, -1874.331114346138, -1543.0150995348604, -4041.963522854516, -854.0983173578647, -1274.9310858690446, -1745.678312608475, -1501.4155718766117, -3009.687762671292, -3812.9315327753147, -2652.9334780824825, -2569.757182638849, -1392.7558229361584, -1791.1804236611215, -2817.93186212241, -3446.6285502160213, -2514.2933143881673, -2102.445041582661, -2498.961709561381, -1843.3273279639122, -1995.2786664951495, -1877.5832460451916, -1311.8693498824787, -2205.0186638072914, -1688.8590126293666, -1038.6667720632356, -3205.925773449086, -3209.4013583291603, -2924.7416477962474, -1754.7935523628214, -1776.7341325477882, -3131.580754820382, -1271.1110034927613, -3123.9060594814327, -2557.0215660995, -2937.45281661011, -3043.927429624043, -1318.324351935054, -1908.8006075014362, -1845.7420127652545, -1977.514628679019, -4515.525476119021, -1726.5728335316219, -2233.284985120853, -1828.9910670536756, -2786.5572485150647, -1295.405095258951], "episode_lengths": [150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 149], "policy_policy_0_reward": [-623.4049397090187, -130.25233239776173, -242.62084090686295, -1182.2878136690663, -742.945827484878, -60.9591799589937, -573.5180647520299, -603.2981345918589, -223.37185121752776, -441.40315235085393, -923.490412101087, -618.3834570247537, -1378.0888892910873, -155.76223402028165, -577.4119489765243, -160.30968713806524, -196.18161712394718, -61.457894696765806, -48.28875315416573, -595.9915151614928, -420.434330442804, -21.41407553101728, -857.8412259791367, -262.11912586082667, -1002.2918759355493, -506.9833656911398, -1342.7825837947348, -374.6972892701732, -61.34923182094915, -840.0171767417328, -936.3340244877681, -104.0098051791753, -320.5067125607155, -1142.9729137686593, -139.4706526446112, -704.1811751962657, 3.8445733026431324, -190.15296735657554, -571.1443072740956, -129.50285488670175, -984.307804581754, -618.2404482966958, -561.4187992438927, -1149.8315751300138, -926.4045856771315, -476.5078446802431, -494.61511227764925, -1090.5498584430595, -30.364477554795606, -404.15752109065465, -568.1196275712052, -80.32535236742352, -583.6965361931301, -1053.9195829954715, -888.9699197152479, -95.77387352205939, -775.4698388079432, -1026.6886451539242, -686.9227722960568, -1133.4273175295245, -1146.0665947093794, -104.73718448219255, -145.1684650876345, -658.4616465868784, -741.2122884031479, -92.42274483575392, -972.8438984480355, 1.2036979930919443, -498.9461240230583, -633.2032050099269, -366.72952106075167, -659.1462567448648, -281.499001253546, -529.7799605091864, -248.51914378805384, -594.4102613476582, -493.09334215519766, -340.18580705343925, -531.2297332004784, -340.40176178756997, -434.6511036418068, -75.66527165844734, -592.3485374157916, -280.2993168382032, 1.208643665054752, -271.7664071319106, -610.1960985580861, -588.2338832488449, -195.6584685193303, -303.9331327774768, -588.4007316733446, -659.5473476269243, -176.67764007029706, -1026.5005652632144, -1151.9100629370928, -1248.01566281573, -265.7527703800484, -86.2340384091146, -663.0070098076875, -1228.5482606887592, -55.26685701545621, -142.19251100092026, -174.67167433765093, -341.98961596411834, -1357.5342877109765, -1307.3885763634923, -104.6314553440198, -178.78035901972385, -545.9572308185566, -485.24672415519063, -825.6272125242456, -18.696947574308403, -217.6804334666862, -170.71203934034676, -477.53127772886745, -25.839777078477113, -1106.057522961651, -816.1969540513529, -161.3553267512444, -77.16835986479484, -140.4762417003867, -200.39772307268686, -84.13652760708052, -102.8416425063821, -1238.4344779670882, -58.128481513365585, -587.0756244684745, -12.107799857768702, -948.9592631060289, -757.4661002310095, -738.4756936760909, -870.7011133056452, -357.05654875385085, -622.565456767938, -467.7294524934803, -67.62513342796683, -70.99239591145675, -373.9781707224481, -175.3586945213397, -135.0124325421733, -84.28590336327791, -105.70564873666095, -1274.5965343910786, -581.8324125656036, -587.9873840367455, -735.3437805777488, -26.701759608231324, -229.59978613082842, -488.5241885619071, -274.80649422794176, -181.92955875377027, -482.20503161316054, -391.306557224205, -318.0733883428062, -898.6460057799767, -393.4739009278082, -72.81620050234794, -984.6897800298852, -254.9751200842541, -304.3863364566196, -540.5589176540624, -537.6719350970748, -837.0280631332473, -467.5958031142737, -144.33922147074293, -856.2649893751376, -199.97758728960426, -59.36220807665737, -180.88116491928008, -71.56696543094799, -1418.7206876918153, -7.677777693952843, -32.041812118670926, -699.02276606412, -186.2708508446417, -511.4635212719975, -698.1797464152235, -945.8409387711106, -1071.542924382114, -814.0974816678367, -998.9715924335005, -225.73610259607847, -539.7249174619724, -326.61086982990963, -333.8606878617533, -421.35866635795213, -640.4350901972128, -108.99374905368784, -375.03512869687506, -568.5699210442506, -473.9463017485779, -695.5223448081179, -207.40733353304933, -30.38222581978802, -333.40947704441277, -47.590322045518036, -254.80110365242112, -779.0183578672022, -640.4270809973043, -89.32790257733286, -16.032067301433447, -607.1965844234923, -665.7708742899628, -220.03114007222382, -356.62352229088117, -132.40457031987594, -757.8962539172659, -437.23321804483453, -431.31638632647423, -756.1052724258553, -244.64325094693757, -1186.0003598920441, -812.3697619535559, -116.82246349614088, -568.5651285109344, -46.707011391839316, -507.0203311800224, -11.377281387921263, -873.7502293280488, -27.206816188855406, -666.4405343605165, -1474.1216595404026, -1254.036246436654, -94.0522138817339, -346.84674409401714, -251.61394590332887, -42.827684919432436, -336.6183989476335, -685.4671033251389, -650.223579279305, -734.3119025786694, -804.5308406362532, -501.76454003027794, -1050.6691526232403, -68.43090089113204, -265.69937259439433, -107.41167019121913, -38.45554019607109, -134.0044220814807, -365.3475305732543, -778.4871993776837, -515.4314757841611, -43.690006157351746, -542.4451309747863, -846.2294003258864, -457.14087201798907, -913.4209593695538, -1009.0483679584951, -846.2266965492008, -863.543554072925, -320.5282401798509, -702.1135065745684, -530.6697198756435, -547.8212052907221, -1157.1607335933368, -711.7425857249641, -512.0509082786266, -1458.397669606909, -552.8562732807106, -1113.2474699214988, -214.27181058189612, -1296.2027839687084, -95.25378463668095, -639.1648519065291, -499.8913140293232, -818.5751755601779, -196.50358750921131, -402.7029747901156, -473.4267247416594, -848.3423642814098, -96.57231332613853, -409.2843016296842, -212.0378899395982, -338.95788849015395, -817.4787209605627, -262.7499221778552, -860.180918433291, -131.04117901312142, -145.40512079808812, -143.63795911250386, -769.4205710626384, -712.5595534825605, -217.8609498258651, -1326.453536587229, -1015.6689118962186, -481.90397095652145, -76.22862188256414, -21.757247921920374, -21.328383066715674, -252.8800935301423, -160.11100641685928, -748.2367343823419, -184.2316557731623, -32.04473378121463, -150.30695551546594, -443.58284805826577, -243.96309131621686, -688.9244884568816, -108.39623479976733, -260.8116499773432, -871.1645338798044, -40.07937543006216, -208.94566574657085, -133.6916555899664, -247.5343412302087, -450.5264332359573, -994.2538033586032, -1210.8853763112895, -47.20962618153229, -306.8125235839095, -70.35822683662843, -770.396541762508, -1351.0551467033008, -1202.665157736, -418.45645973688084, -1342.2787528186814, -217.91593105095737, -237.33146055756978, -92.09975661513894, -763.3075770401364, -849.6917537361508, -553.1997992090222, -81.21934161718558, -1065.7590390569221, -19.88724901957015, -672.8172335553897, -168.75559485105134, -244.58761499615767, -247.46979605766035, -59.125583475899205, -192.54777052723597, -130.22549533717321, -49.68535315355804, -1009.6825177167516, -409.03928692640284, -668.720460485359, -540.9358319984111, -738.2572434293899, -799.5862982710771, -70.43202793817034, -733.930149178579, -412.5052447649936, -1296.821328403883, -130.2156928187044, -873.1561350498638, -273.32904693579707, -792.8610316165236, -22.133580957295926, -1034.6924308583193, -391.2772240202314, -681.9375289503765, -157.79277586105775, -533.7789635475882, -122.79780381770139, -606.1379694059394, -603.1827631759243, -495.2197301101512, -718.3292235742074, -240.20423340982063, -442.02575929127954, -49.45968248058695, -357.16925427059664, -705.9422437456291, -569.4085705552225, -161.3475769118777, -48.88223361275056, -963.5512268509381, -233.20214738666556, -161.39370165025753, -588.2493569945384, -662.3104693454451, -21.353822505478327, -665.7209613328021, -414.4855522861109, -113.71244057535328, -24.637712064070154, -35.487466556803135, -543.5191752709422, -673.6664021935682, -34.558593797093074, -660.3455645335221, -43.45471496302203, -342.5412610979682, -1040.4803486246185, -118.19677458815998, -676.6694350044538, -151.0274613251964, -657.0282034768543, -119.7732900363007, -84.36062278656361, -100.76191254134427, -28.582024406278133, -754.2838820511928, -107.45968009587772, -47.57927296854374, -1049.9608296947727, -619.0519622320182, -358.6656875853311, -953.9402020548744, -224.3070918820898, -1063.2107828059013, -374.790579411581, -1059.9008119325297, -46.49357388442595, -665.0056102947251, -1051.9288057049923, -49.712220446507644, -633.8143984795596, -246.64089644848278, -942.6453267167041, -187.76427491624565, -384.6627739133165, -41.16116910719311, -520.15867374859, -621.0466606774743, -479.08732352706, -1050.6999859264993, -76.78475540938436, -104.14869593247847, -66.01337175236888, -1441.4869930950165, -1391.307147277554, -38.34445067431913, -235.741068120818, -24.701095652674912, -48.89676443706795, -442.817301556684, -57.94770379726735, -284.09001929976205, -437.3592144019798, -207.5307416779465, -958.6222191615059, -249.14845912670043, -1103.0184401115318, -605.5861994037482, -271.9308086210954, -931.5953242093805, -78.14343216283419, -913.7052598725779, -361.6467412336111, -807.2198859544397, -878.5830132805656, -417.5461666091795, -817.3336018947059, -16.77014887122008, -1426.1192100981386, -235.8722564845119, -432.43249789172194, -330.7369204273771, -618.766544722289, -332.6791388038203, -511.88454187933957, -244.33774009388029, -178.77966849918496, -50.64326265882884, -13.4998015162219, -514.5519807203972, -904.644563432255, -196.5730285891249, -279.53123324343653, -1004.6180427516009, -87.62713081164486, -131.90283542723114, -592.5830135174408, -29.010990257335855, -291.89495500671745, -339.28746746872645, -117.2035957124517, -868.2491920871043, -360.87941840402016, -1175.0774559212502, -811.5461395794989, -1173.266409751301, -161.33076674709278, -1194.3047041198777, -189.8517638374026, -90.05463580555629, -435.4076298999903, -680.7822829303013, -330.4765210583702, -535.1070022426719, -18.66177294311061, -106.91435319046779, -331.56338461649426, -1241.038472128108, -566.689479889064, -333.1410621630276, -31.74496489473702, -69.7605829509764, -827.6549771558699, -822.3633847079611, -411.9838483420695, -93.46153951131451, -899.1283775510531, -559.6200984026664, -62.84446889748098, -360.4025778494951, -337.46782128452713, -95.85449387888619, -438.835733348561]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5553694882788187, "mean_inference_ms": 1.7260385127839595, "mean_action_processing_ms": 0.8144562581088133, "mean_env_wait_ms": 10.422755163670779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01339268684387207, "StateBufferConnector_ms": 0.00946497917175293, "ViewRequirementAgentConnector_ms": 0.31307339668273926}, "num_episodes": 29, "episode_return_max": -822.9668271253842, "episode_return_min": -4515.525476119021, "episode_return_mean": -2388.930474942712, "episodes_this_iter": 29}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212656, "num_agent_steps_trained": 1212656, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.04710290088794, "num_env_steps_trained_throughput_per_sec": 82.04710290088794, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1212656, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1212656, "timers": {"training_iteration_time_ms": 49191.717, "restore_workers_time_ms": 0.03, "training_step_time_ms": 49191.638, "sample_time_ms": 3228.536, "learn_time_ms": 45900.681, "learn_throughput": 87.145, "synch_weights_time_ms": 59.29}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1212656, "num_agent_steps_trained": 1212656}, "done": false, "training_iteration": 69, "trial_id": "05c72_00000", "date": "2024-07-26_15-39-58", "timestamp": 1721988598, "time_this_iter_s": 48.76390767097473, "time_total_s": 3416.715136051178, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d3c3b29000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3416.715136051178, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 11.567142857142857, "ram_util_percent": 30.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.2946295273998, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.670295604133101, "policy_loss": -0.0025493044863213543, "vf_loss": 4.688383843343725, "vf_explained_var": 0.9843244127810947, "kl": 0.013879423937452317, "entropy": 2.6078617690101504, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.96031746031746, "num_grad_updates_lifetime": 287190.5, "diff_num_grad_updates_vs_sampler_policy": 1889.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1228779, "num_agent_steps_trained": 1228779}, "env_runners": {"episode_reward_max": -822.9668271253842, "episode_reward_min": -4515.525476119021, "episode_reward_mean": -2381.1996735986104, "episode_len_mean": 148.75, "episode_media": {}, "episodes_timesteps_total": 14875, "policy_reward_min": {"policy_0": -1474.1216595404026}, "policy_reward_max": {"policy_0": 2.734139196411495}, "policy_reward_mean": {"policy_0": -476.23993471972204}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1766.286612853623, -2363.737269176649, -3056.528264997004, -822.9668271253842, -2634.407883093365, -1754.976009106657, -2272.16054171392, -2010.3413380009172, -2527.1939404694012, -1368.0529150916273, -2343.733894413201, -4041.1246125082803, -2424.904170183213, -2114.3925553499785, -1740.6676829539456, -1811.1647671397789, -1865.654188377995, -2514.9557010343074, -2928.400964799613, -1466.0616694766863, -3835.497398313324, -1966.750712374839, -3159.707336759577, -910.9185356364198, -2726.283212619869, -4089.3804499681673, -3258.2934055141245, -4348.294906812707, -2744.784545123137, -2739.5508268825743, -1874.331114346138, -1543.0150995348604, -4041.963522854516, -854.0983173578647, -1274.9310858690446, -1745.678312608475, -1501.4155718766117, -3009.687762671292, -3812.9315327753147, -2652.9334780824825, -2569.757182638849, -1392.7558229361584, -1791.1804236611215, -2817.93186212241, -3446.6285502160213, -2514.2933143881673, -2102.445041582661, -2498.961709561381, -1843.3273279639122, -1995.2786664951495, -1877.5832460451916, -1311.8693498824787, -2205.0186638072914, -1688.8590126293666, -1038.6667720632356, -3205.925773449086, -3209.4013583291603, -2924.7416477962474, -1754.7935523628214, -1776.7341325477882, -3131.580754820382, -1271.1110034927613, -3123.9060594814327, -2557.0215660995, -2937.45281661011, -3043.927429624043, -1318.324351935054, -1908.8006075014362, -1845.7420127652545, -1977.514628679019, -4515.525476119021, -1726.5728335316219, -2233.284985120853, -1828.9910670536756, -2786.5572485150647, -1295.405095258951, -2564.2374581923236, -3677.211677698618, -2366.395909300483, -2569.796909763121, -2680.697675944601, -1533.8143816454422, -2263.5271837692544, -2296.1795803138116, -1315.8388472968113, -1844.442967565209, -3249.926993936021, -2321.318676040349, -3284.6896481737253, -1642.490135927296, -2927.7900423513956, -3778.9228144636168, -3638.6329011993807, -2327.1095232030193, -915.1946929960149, -2808.525957906924, -2826.049159313587, -1437.6573363075975, -3548.675003192931, -2914.811600425912], "episode_lengths": [150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150], "policy_policy_0_reward": [-140.4762417003867, -200.39772307268686, -84.13652760708052, -102.8416425063821, -1238.4344779670882, -58.128481513365585, -587.0756244684745, -12.107799857768702, -948.9592631060289, -757.4661002310095, -738.4756936760909, -870.7011133056452, -357.05654875385085, -622.565456767938, -467.7294524934803, -67.62513342796683, -70.99239591145675, -373.9781707224481, -175.3586945213397, -135.0124325421733, -84.28590336327791, -105.70564873666095, -1274.5965343910786, -581.8324125656036, -587.9873840367455, -735.3437805777488, -26.701759608231324, -229.59978613082842, -488.5241885619071, -274.80649422794176, -181.92955875377027, -482.20503161316054, -391.306557224205, -318.0733883428062, -898.6460057799767, -393.4739009278082, -72.81620050234794, -984.6897800298852, -254.9751200842541, -304.3863364566196, -540.5589176540624, -537.6719350970748, -837.0280631332473, -467.5958031142737, -144.33922147074293, -856.2649893751376, -199.97758728960426, -59.36220807665737, -180.88116491928008, -71.56696543094799, -1418.7206876918153, -7.677777693952843, -32.041812118670926, -699.02276606412, -186.2708508446417, -511.4635212719975, -698.1797464152235, -945.8409387711106, -1071.542924382114, -814.0974816678367, -998.9715924335005, -225.73610259607847, -539.7249174619724, -326.61086982990963, -333.8606878617533, -421.35866635795213, -640.4350901972128, -108.99374905368784, -375.03512869687506, -568.5699210442506, -473.9463017485779, -695.5223448081179, -207.40733353304933, -30.38222581978802, -333.40947704441277, -47.590322045518036, -254.80110365242112, -779.0183578672022, -640.4270809973043, -89.32790257733286, -16.032067301433447, -607.1965844234923, -665.7708742899628, -220.03114007222382, -356.62352229088117, -132.40457031987594, -757.8962539172659, -437.23321804483453, -431.31638632647423, -756.1052724258553, -244.64325094693757, -1186.0003598920441, -812.3697619535559, -116.82246349614088, -568.5651285109344, -46.707011391839316, -507.0203311800224, -11.377281387921263, -873.7502293280488, -27.206816188855406, -666.4405343605165, -1474.1216595404026, -1254.036246436654, -94.0522138817339, -346.84674409401714, -251.61394590332887, -42.827684919432436, -336.6183989476335, -685.4671033251389, -650.223579279305, -734.3119025786694, -804.5308406362532, -501.76454003027794, -1050.6691526232403, -68.43090089113204, -265.69937259439433, -107.41167019121913, -38.45554019607109, -134.0044220814807, -365.3475305732543, -778.4871993776837, -515.4314757841611, -43.690006157351746, -542.4451309747863, -846.2294003258864, -457.14087201798907, -913.4209593695538, -1009.0483679584951, -846.2266965492008, -863.543554072925, -320.5282401798509, -702.1135065745684, -530.6697198756435, -547.8212052907221, -1157.1607335933368, -711.7425857249641, -512.0509082786266, -1458.397669606909, -552.8562732807106, -1113.2474699214988, -214.27181058189612, -1296.2027839687084, -95.25378463668095, -639.1648519065291, -499.8913140293232, -818.5751755601779, -196.50358750921131, -402.7029747901156, -473.4267247416594, -848.3423642814098, -96.57231332613853, -409.2843016296842, -212.0378899395982, -338.95788849015395, -817.4787209605627, -262.7499221778552, -860.180918433291, -131.04117901312142, -145.40512079808812, -143.63795911250386, -769.4205710626384, -712.5595534825605, -217.8609498258651, -1326.453536587229, -1015.6689118962186, -481.90397095652145, -76.22862188256414, -21.757247921920374, -21.328383066715674, -252.8800935301423, -160.11100641685928, -748.2367343823419, -184.2316557731623, -32.04473378121463, -150.30695551546594, -443.58284805826577, -243.96309131621686, -688.9244884568816, -108.39623479976733, -260.8116499773432, -871.1645338798044, -40.07937543006216, -208.94566574657085, -133.6916555899664, -247.5343412302087, -450.5264332359573, -994.2538033586032, -1210.8853763112895, -47.20962618153229, -306.8125235839095, -70.35822683662843, -770.396541762508, -1351.0551467033008, -1202.665157736, -418.45645973688084, -1342.2787528186814, -217.91593105095737, -237.33146055756978, -92.09975661513894, -763.3075770401364, -849.6917537361508, -553.1997992090222, -81.21934161718558, -1065.7590390569221, -19.88724901957015, -672.8172335553897, -168.75559485105134, -244.58761499615767, -247.46979605766035, -59.125583475899205, -192.54777052723597, -130.22549533717321, -49.68535315355804, -1009.6825177167516, -409.03928692640284, -668.720460485359, -540.9358319984111, -738.2572434293899, -799.5862982710771, -70.43202793817034, -733.930149178579, -412.5052447649936, -1296.821328403883, -130.2156928187044, -873.1561350498638, -273.32904693579707, -792.8610316165236, -22.133580957295926, -1034.6924308583193, -391.2772240202314, -681.9375289503765, -157.79277586105775, -533.7789635475882, -122.79780381770139, -606.1379694059394, -603.1827631759243, -495.2197301101512, -718.3292235742074, -240.20423340982063, -442.02575929127954, -49.45968248058695, -357.16925427059664, -705.9422437456291, -569.4085705552225, -161.3475769118777, -48.88223361275056, -963.5512268509381, -233.20214738666556, -161.39370165025753, -588.2493569945384, -662.3104693454451, -21.353822505478327, -665.7209613328021, -414.4855522861109, -113.71244057535328, -24.637712064070154, -35.487466556803135, -543.5191752709422, -673.6664021935682, -34.558593797093074, -660.3455645335221, -43.45471496302203, -342.5412610979682, -1040.4803486246185, -118.19677458815998, -676.6694350044538, -151.0274613251964, -657.0282034768543, -119.7732900363007, -84.36062278656361, -100.76191254134427, -28.582024406278133, -754.2838820511928, -107.45968009587772, -47.57927296854374, -1049.9608296947727, -619.0519622320182, -358.6656875853311, -953.9402020548744, -224.3070918820898, -1063.2107828059013, -374.790579411581, -1059.9008119325297, -46.49357388442595, -665.0056102947251, -1051.9288057049923, -49.712220446507644, -633.8143984795596, -246.64089644848278, -942.6453267167041, -187.76427491624565, -384.6627739133165, -41.16116910719311, -520.15867374859, -621.0466606774743, -479.08732352706, -1050.6999859264993, -76.78475540938436, -104.14869593247847, -66.01337175236888, -1441.4869930950165, -1391.307147277554, -38.34445067431913, -235.741068120818, -24.701095652674912, -48.89676443706795, -442.817301556684, -57.94770379726735, -284.09001929976205, -437.3592144019798, -207.5307416779465, -958.6222191615059, -249.14845912670043, -1103.0184401115318, -605.5861994037482, -271.9308086210954, -931.5953242093805, -78.14343216283419, -913.7052598725779, -361.6467412336111, -807.2198859544397, -878.5830132805656, -417.5461666091795, -817.3336018947059, -16.77014887122008, -1426.1192100981386, -235.8722564845119, -432.43249789172194, -330.7369204273771, -618.766544722289, -332.6791388038203, -511.88454187933957, -244.33774009388029, -178.77966849918496, -50.64326265882884, -13.4998015162219, -514.5519807203972, -904.644563432255, -196.5730285891249, -279.53123324343653, -1004.6180427516009, -87.62713081164486, -131.90283542723114, -592.5830135174408, -29.010990257335855, -291.89495500671745, -339.28746746872645, -117.2035957124517, -868.2491920871043, -360.87941840402016, -1175.0774559212502, -811.5461395794989, -1173.266409751301, -161.33076674709278, -1194.3047041198777, -189.8517638374026, -90.05463580555629, -435.4076298999903, -680.7822829303013, -330.4765210583702, -535.1070022426719, -18.66177294311061, -106.91435319046779, -331.56338461649426, -1241.038472128108, -566.689479889064, -333.1410621630276, -31.74496489473702, -69.7605829509764, -827.6549771558699, -822.3633847079611, -411.9838483420695, -93.46153951131451, -899.1283775510531, -559.6200984026664, -62.84446889748098, -360.4025778494951, -337.46782128452713, -95.85449387888619, -438.835733348561, -167.37982044589083, -16.051626188596494, -749.9965608320364, -439.40552710887323, -1191.4039236169278, -1133.3937028298556, -130.7122702395666, -1305.6238620107367, -111.91984894235561, -995.5619936761024, -451.0053935798808, -1093.3376277767807, -146.22899345193633, -632.0743705112266, -43.74952398065911, -599.4803714516643, -444.5595323601561, -712.2203042332724, -143.18309487683686, -670.3536068411942, -347.73311969722783, -340.33757640215657, -469.1156637743314, -762.5444580973432, -760.9668579735402, -246.69587407634478, -210.1578692432501, -816.7235906106534, -139.05772793609194, -121.17931977910366, -29.1850349323142, -407.7483429560974, -692.2319404622382, -562.9791500562131, -571.3827153623926, -357.84442750508106, -738.8360099990954, -720.3412459755103, -159.54486636406344, -319.61303047006027, -150.6813089170421, -18.313373527389665, -292.08992262716697, -212.9908375052583, -641.7634047199534, -467.4401768759755, -366.15181770237024, -210.49490351089827, -268.5600866654922, -531.7959828104741, -151.20026597098143, -1157.2603849505713, -930.217419558154, -244.27596809010097, -766.972955366217, -367.5842390138869, -499.70558582926884, -266.0283131254997, -167.02525514988844, -1020.9752829218073, -1327.0625418716013, -341.1993201629132, -569.2585845975151, -222.7476920439287, -824.4215094977657, -573.7637969779149, -758.4158981353153, -205.56073093616632, -58.083338972272195, -46.66637090562632, -125.03533414791646, -464.24438697998534, -1197.9818628848388, -38.61220002460582, -1101.916258314052, -568.9878402524837, -865.3521539837883, -609.4030073710907, -1325.358570718797, -409.821242137453, -826.3825171501286, -680.8262319638454, -1202.6443163556994, -790.6896271136077, -138.09020861610057, -2.572786726396155, -1027.0846847085702, -293.0312824806411, -476.50503472938243, -527.9157345580303, -88.66656538093184, -156.35091505695434, -500.8204971174297, -48.54569740052971, -120.8110180401696, -97.54138164691817, 2.734139196411495, -663.1054024584072, -986.1926957937656, -1064.4206172042457, -235.75642265203533, -684.3094315820698, -525.7563786280641, -753.2199375985041, -627.0069888529146, -580.2784773688413, -6.854269518878535, -5.2580162728643085, -358.19061418650756, -487.07595896050606, -519.2266700314939, -769.1030762793309, -389.1220719722495, -891.6947999050983, -979.5283850047563, -415.11030157425756, -167.19652222717957, -769.546622633173, -1020.9971207892768, -541.9610332020253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5562868786718065, "mean_inference_ms": 1.725894320886114, "mean_action_processing_ms": 0.8133485541266535, "mean_env_wait_ms": 10.420505514441258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01259922981262207, "StateBufferConnector_ms": 0.009243965148925781, "ViewRequirementAgentConnector_ms": 0.3059852123260498}, "num_episodes": 24, "episode_return_max": -822.9668271253842, "episode_return_min": -4515.525476119021, "episode_return_mean": -2381.1996735986104, "episodes_this_iter": 24}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1228779, "num_agent_steps_trained": 1228779, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 113.47061466457704, "num_env_steps_trained_throughput_per_sec": 113.47061466457704, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1228779, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1228779, "timers": {"training_iteration_time_ms": 47145.573, "restore_workers_time_ms": 0.031, "training_step_time_ms": 47145.494, "sample_time_ms": 3215.888, "learn_time_ms": 43869.233, "learn_throughput": 91.18, "synch_weights_time_ms": 57.308}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1228779, "num_agent_steps_trained": 1228779}, "done": false, "training_iteration": 70, "trial_id": "05c72_00000", "date": "2024-07-26_15-40-33", "timestamp": 1721988633, "time_this_iter_s": 35.262696504592896, "time_total_s": 3451.977832555771, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd0149120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3451.977832555771, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 13.393999999999998, "ram_util_percent": 30.558000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 172.36798902212405, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.7335280579679155, "policy_loss": -0.003784161455148612, "vf_loss": 4.752846577821994, "vf_explained_var": 0.9884489643369235, "kl": 0.014866907411245241, "entropy": 2.6823910629632426, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.63970588235294, "num_grad_updates_lifetime": 291120.5, "diff_num_grad_updates_vs_sampler_policy": 2039.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1246138, "num_agent_steps_trained": 1246138}, "env_runners": {"episode_reward_max": -844.6345896259063, "episode_reward_min": -4515.525476119021, "episode_reward_mean": -2499.1153017575366, "episode_len_mean": 149.24, "episode_media": {}, "episodes_timesteps_total": 14924, "policy_reward_min": {"policy_0": -1489.7739017827805}, "policy_reward_max": {"policy_0": 2.734139196411495}, "policy_reward_mean": {"policy_0": -499.8230603515073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4348.294906812707, -2744.784545123137, -2739.5508268825743, -1874.331114346138, -1543.0150995348604, -4041.963522854516, -854.0983173578647, -1274.9310858690446, -1745.678312608475, -1501.4155718766117, -3009.687762671292, -3812.9315327753147, -2652.9334780824825, -2569.757182638849, -1392.7558229361584, -1791.1804236611215, -2817.93186212241, -3446.6285502160213, -2514.2933143881673, -2102.445041582661, -2498.961709561381, -1843.3273279639122, -1995.2786664951495, -1877.5832460451916, -1311.8693498824787, -2205.0186638072914, -1688.8590126293666, -1038.6667720632356, -3205.925773449086, -3209.4013583291603, -2924.7416477962474, -1754.7935523628214, -1776.7341325477882, -3131.580754820382, -1271.1110034927613, -3123.9060594814327, -2557.0215660995, -2937.45281661011, -3043.927429624043, -1318.324351935054, -1908.8006075014362, -1845.7420127652545, -1977.514628679019, -4515.525476119021, -1726.5728335316219, -2233.284985120853, -1828.9910670536756, -2786.5572485150647, -1295.405095258951, -2564.2374581923236, -3677.211677698618, -2366.395909300483, -2569.796909763121, -2680.697675944601, -1533.8143816454422, -2263.5271837692544, -2296.1795803138116, -1315.8388472968113, -1844.442967565209, -3249.926993936021, -2321.318676040349, -3284.6896481737253, -1642.490135927296, -2927.7900423513956, -3778.9228144636168, -3638.6329011993807, -2327.1095232030193, -915.1946929960149, -2808.525957906924, -2826.049159313587, -1437.6573363075975, -3548.675003192931, -2914.811600425912, -1288.6017461051044, -2573.7653293555913, -2716.7050367798183, -3848.8652694217453, -3143.79034566374, -3505.577470411466, -1961.889832722994, -3013.5680003088864, -3845.1907289936025, -2449.7242431571776, -844.6345896259063, -1682.0710442120676, -1868.5825123213651, -3180.4423108728206, -2337.4945465768637, -2793.715095992611, -3198.389590878285, -3930.040340966308, -4149.1220051404825, -2798.7324580714608, -2679.940886446876, -3292.739095249661, -1662.6309501945668, -3646.2870275675286, -4213.286032174066, -2602.635817997956, -2337.6833677355576], "episode_lengths": [150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-711.7425857249641, -512.0509082786266, -1458.397669606909, -552.8562732807106, -1113.2474699214988, -214.27181058189612, -1296.2027839687084, -95.25378463668095, -639.1648519065291, -499.8913140293232, -818.5751755601779, -196.50358750921131, -402.7029747901156, -473.4267247416594, -848.3423642814098, -96.57231332613853, -409.2843016296842, -212.0378899395982, -338.95788849015395, -817.4787209605627, -262.7499221778552, -860.180918433291, -131.04117901312142, -145.40512079808812, -143.63795911250386, -769.4205710626384, -712.5595534825605, -217.8609498258651, -1326.453536587229, -1015.6689118962186, -481.90397095652145, -76.22862188256414, -21.757247921920374, -21.328383066715674, -252.8800935301423, -160.11100641685928, -748.2367343823419, -184.2316557731623, -32.04473378121463, -150.30695551546594, -443.58284805826577, -243.96309131621686, -688.9244884568816, -108.39623479976733, -260.8116499773432, -871.1645338798044, -40.07937543006216, -208.94566574657085, -133.6916555899664, -247.5343412302087, -450.5264332359573, -994.2538033586032, -1210.8853763112895, -47.20962618153229, -306.8125235839095, -70.35822683662843, -770.396541762508, -1351.0551467033008, -1202.665157736, -418.45645973688084, -1342.2787528186814, -217.91593105095737, -237.33146055756978, -92.09975661513894, -763.3075770401364, -849.6917537361508, -553.1997992090222, -81.21934161718558, -1065.7590390569221, -19.88724901957015, -672.8172335553897, -168.75559485105134, -244.58761499615767, -247.46979605766035, -59.125583475899205, -192.54777052723597, -130.22549533717321, -49.68535315355804, -1009.6825177167516, -409.03928692640284, -668.720460485359, -540.9358319984111, -738.2572434293899, -799.5862982710771, -70.43202793817034, -733.930149178579, -412.5052447649936, -1296.821328403883, -130.2156928187044, -873.1561350498638, -273.32904693579707, -792.8610316165236, -22.133580957295926, -1034.6924308583193, -391.2772240202314, -681.9375289503765, -157.79277586105775, -533.7789635475882, -122.79780381770139, -606.1379694059394, -603.1827631759243, -495.2197301101512, -718.3292235742074, -240.20423340982063, -442.02575929127954, -49.45968248058695, -357.16925427059664, -705.9422437456291, -569.4085705552225, -161.3475769118777, -48.88223361275056, -963.5512268509381, -233.20214738666556, -161.39370165025753, -588.2493569945384, -662.3104693454451, -21.353822505478327, -665.7209613328021, -414.4855522861109, -113.71244057535328, -24.637712064070154, -35.487466556803135, -543.5191752709422, -673.6664021935682, -34.558593797093074, -660.3455645335221, -43.45471496302203, -342.5412610979682, -1040.4803486246185, -118.19677458815998, -676.6694350044538, -151.0274613251964, -657.0282034768543, -119.7732900363007, -84.36062278656361, -100.76191254134427, -28.582024406278133, -754.2838820511928, -107.45968009587772, -47.57927296854374, -1049.9608296947727, -619.0519622320182, -358.6656875853311, -953.9402020548744, -224.3070918820898, -1063.2107828059013, -374.790579411581, -1059.9008119325297, -46.49357388442595, -665.0056102947251, -1051.9288057049923, -49.712220446507644, -633.8143984795596, -246.64089644848278, -942.6453267167041, -187.76427491624565, -384.6627739133165, -41.16116910719311, -520.15867374859, -621.0466606774743, -479.08732352706, -1050.6999859264993, -76.78475540938436, -104.14869593247847, -66.01337175236888, -1441.4869930950165, -1391.307147277554, -38.34445067431913, -235.741068120818, -24.701095652674912, -48.89676443706795, -442.817301556684, -57.94770379726735, -284.09001929976205, -437.3592144019798, -207.5307416779465, -958.6222191615059, -249.14845912670043, -1103.0184401115318, -605.5861994037482, -271.9308086210954, -931.5953242093805, -78.14343216283419, -913.7052598725779, -361.6467412336111, -807.2198859544397, -878.5830132805656, -417.5461666091795, -817.3336018947059, -16.77014887122008, -1426.1192100981386, -235.8722564845119, -432.43249789172194, -330.7369204273771, -618.766544722289, -332.6791388038203, -511.88454187933957, -244.33774009388029, -178.77966849918496, -50.64326265882884, -13.4998015162219, -514.5519807203972, -904.644563432255, -196.5730285891249, -279.53123324343653, -1004.6180427516009, -87.62713081164486, -131.90283542723114, -592.5830135174408, -29.010990257335855, -291.89495500671745, -339.28746746872645, -117.2035957124517, -868.2491920871043, -360.87941840402016, -1175.0774559212502, -811.5461395794989, -1173.266409751301, -161.33076674709278, -1194.3047041198777, -189.8517638374026, -90.05463580555629, -435.4076298999903, -680.7822829303013, -330.4765210583702, -535.1070022426719, -18.66177294311061, -106.91435319046779, -331.56338461649426, -1241.038472128108, -566.689479889064, -333.1410621630276, -31.74496489473702, -69.7605829509764, -827.6549771558699, -822.3633847079611, -411.9838483420695, -93.46153951131451, -899.1283775510531, -559.6200984026664, -62.84446889748098, -360.4025778494951, -337.46782128452713, -95.85449387888619, -438.835733348561, -167.37982044589083, -16.051626188596494, -749.9965608320364, -439.40552710887323, -1191.4039236169278, -1133.3937028298556, -130.7122702395666, -1305.6238620107367, -111.91984894235561, -995.5619936761024, -451.0053935798808, -1093.3376277767807, -146.22899345193633, -632.0743705112266, -43.74952398065911, -599.4803714516643, -444.5595323601561, -712.2203042332724, -143.18309487683686, -670.3536068411942, -347.73311969722783, -340.33757640215657, -469.1156637743314, -762.5444580973432, -760.9668579735402, -246.69587407634478, -210.1578692432501, -816.7235906106534, -139.05772793609194, -121.17931977910366, -29.1850349323142, -407.7483429560974, -692.2319404622382, -562.9791500562131, -571.3827153623926, -357.84442750508106, -738.8360099990954, -720.3412459755103, -159.54486636406344, -319.61303047006027, -150.6813089170421, -18.313373527389665, -292.08992262716697, -212.9908375052583, -641.7634047199534, -467.4401768759755, -366.15181770237024, -210.49490351089827, -268.5600866654922, -531.7959828104741, -151.20026597098143, -1157.2603849505713, -930.217419558154, -244.27596809010097, -766.972955366217, -367.5842390138869, -499.70558582926884, -266.0283131254997, -167.02525514988844, -1020.9752829218073, -1327.0625418716013, -341.1993201629132, -569.2585845975151, -222.7476920439287, -824.4215094977657, -573.7637969779149, -758.4158981353153, -205.56073093616632, -58.083338972272195, -46.66637090562632, -125.03533414791646, -464.24438697998534, -1197.9818628848388, -38.61220002460582, -1101.916258314052, -568.9878402524837, -865.3521539837883, -609.4030073710907, -1325.358570718797, -409.821242137453, -826.3825171501286, -680.8262319638454, -1202.6443163556994, -790.6896271136077, -138.09020861610057, -2.572786726396155, -1027.0846847085702, -293.0312824806411, -476.50503472938243, -527.9157345580303, -88.66656538093184, -156.35091505695434, -500.8204971174297, -48.54569740052971, -120.8110180401696, -97.54138164691817, 2.734139196411495, -663.1054024584072, -986.1926957937656, -1064.4206172042457, -235.75642265203533, -684.3094315820698, -525.7563786280641, -753.2199375985041, -627.0069888529146, -580.2784773688413, -6.854269518878535, -5.2580162728643085, -358.19061418650756, -487.07595896050606, -519.2266700314939, -769.1030762793309, -389.1220719722495, -891.6947999050983, -979.5283850047563, -415.11030157425756, -167.19652222717957, -769.546622633173, -1020.9971207892768, -541.9610332020253, -18.651600436933172, -372.3134648779723, -59.87111906907056, -29.88257808904539, -807.8829836320843, -296.0845625059482, -178.06808090468252, -464.5987747184696, -1286.764161040518, -348.2497501859744, -1265.4509728611301, -18.395543324811175, -587.7932490728184, -479.8105863436131, -365.2546851774466, -1489.7739017827805, -67.7817823270484, -1055.0235360052864, -933.1056731206794, -303.1803761859513, -1222.9819598888396, -1245.103192265034, -192.7447667468005, -20.07813879855949, -462.8822879645048, -1024.2730528628658, -898.7468143612027, -379.9626666520388, -855.0622842453251, -347.5326522900356, -49.84729752229525, -731.7499991650394, -26.58302533876896, -662.4122669753256, -491.297243721563, -993.9319624275937, -139.29107273371875, -104.34725632144036, -858.0588070683467, -917.938901757786, -121.18062692006079, -916.8292237982881, -741.070552274827, -977.0240892944363, -1089.086236705992, -264.2088247387079, -412.46733499148223, -849.6051615206349, -206.14715883390963, -717.2957630724428, -235.23426739118977, -73.86121183562709, -64.70773722229819, -439.0145054258153, -31.81686775097622, -168.11927936772858, -987.0130387068202, -347.89512597287313, -62.87645745180409, -116.16714271284248, -33.64387818546854, -497.0256175982934, -742.0805526798006, -207.30783194916657, -388.5246319086374, -1007.6486782781782, -435.1593893042604, -964.8550493856178, -80.22174943124587, -692.5574444735198, -429.83787822605984, -696.8455866732044, -400.82129126868824, -13.595545706014965, -796.3942447028945, -1033.473804557923, -55.87286344328627, -54.40287442961073, -1212.2780627032187, -437.68749085857434, -174.9328938420414, -477.5049911914198, -1437.8613413102817, -229.1156015324969, -878.9747630020466, -1237.80085118389, -308.87695915039, -429.80000546739274, -1069.965911396547, -883.5966137680886, -214.69980666223162, -773.4101563771097, -1444.958190845785, -457.6369069927891, -1258.4169442625691, -937.4485199451444, -225.66634141435344, -628.8494916876626, -42.29811450016867, -964.469990524132, -1218.3075336861998, -210.6548991065085, -485.2447041374192, -657.2030640841299, -108.53068543261446, -495.4173382605099, -767.3094214225375, -314.4535434631763, -620.2839159006508, -1095.2748762027863, -593.8996778551505, -17.31208422785194, -344.9809944316817, -261.65048740685245, -444.78770627303163, -1356.249898456879, -418.0749712520551, -1215.284269627415, -11.916106409662428, -644.7617818215174, -471.24719861929157, -905.4255496603597, -1059.7639937855295, -568.6920393295006, -1208.1572507793899, -7.5093514743778345, -752.3570555736628, -832.3384678405508, -70.48018465451877, -939.9507584548477, -42.003942613977124, -201.5790692989846, -803.71013132624, -597.374981093471, -693.0152434028824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5531919826267526, "mean_inference_ms": 1.7255032143187679, "mean_action_processing_ms": 0.8124721065922238, "mean_env_wait_ms": 10.408000944978726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013170957565307617, "StateBufferConnector_ms": 0.009505510330200195, "ViewRequirementAgentConnector_ms": 0.32217955589294434}, "num_episodes": 27, "episode_return_max": -844.6345896259063, "episode_return_min": -4515.525476119021, "episode_return_mean": -2499.1153017575366, "episodes_this_iter": 27}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1246138, "num_agent_steps_trained": 1246138, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.6625921142104, "num_env_steps_trained_throughput_per_sec": 73.6625921142104, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1246138, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1246138, "timers": {"training_iteration_time_ms": 47614.251, "restore_workers_time_ms": 0.03, "training_step_time_ms": 47614.174, "sample_time_ms": 3247.877, "learn_time_ms": 44306.99, "learn_throughput": 90.279, "synch_weights_time_ms": 56.251}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1246138, "num_agent_steps_trained": 1246138}, "done": false, "training_iteration": 71, "trial_id": "05c72_00000", "date": "2024-07-26_15-41-28", "timestamp": 1721988688, "time_this_iter_s": 54.31272530555725, "time_total_s": 3506.290557861328, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00dcb80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3506.290557861328, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 11.323376623376621, "ram_util_percent": 30.576623376623367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 125.91275524784676, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000002, "total_loss": 4.897047465238998, "policy_loss": -0.0024519322935806875, "vf_loss": 4.912797787592779, "vf_explained_var": 0.9818379595653335, "kl": 0.015017003526613441, "entropy": 2.470191518109829, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.99253731343283, "num_grad_updates_lifetime": 295170.5, "diff_num_grad_updates_vs_sampler_policy": 2009.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1263289, "num_agent_steps_trained": 1263289}, "env_runners": {"episode_reward_max": -844.6345896259063, "episode_reward_min": -4515.525476119021, "episode_reward_mean": -2539.6972892188032, "episode_len_mean": 149.42, "episode_media": {}, "episodes_timesteps_total": 14942, "policy_reward_min": {"policy_0": -1489.7739017827805}, "policy_reward_max": {"policy_0": 2.734139196411495}, "policy_reward_mean": {"policy_0": -507.93945784376075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3209.4013583291603, -2924.7416477962474, -1754.7935523628214, -1776.7341325477882, -3131.580754820382, -1271.1110034927613, -3123.9060594814327, -2557.0215660995, -2937.45281661011, -3043.927429624043, -1318.324351935054, -1908.8006075014362, -1845.7420127652545, -1977.514628679019, -4515.525476119021, -1726.5728335316219, -2233.284985120853, -1828.9910670536756, -2786.5572485150647, -1295.405095258951, -2564.2374581923236, -3677.211677698618, -2366.395909300483, -2569.796909763121, -2680.697675944601, -1533.8143816454422, -2263.5271837692544, -2296.1795803138116, -1315.8388472968113, -1844.442967565209, -3249.926993936021, -2321.318676040349, -3284.6896481737253, -1642.490135927296, -2927.7900423513956, -3778.9228144636168, -3638.6329011993807, -2327.1095232030193, -915.1946929960149, -2808.525957906924, -2826.049159313587, -1437.6573363075975, -3548.675003192931, -2914.811600425912, -1288.6017461051044, -2573.7653293555913, -2716.7050367798183, -3848.8652694217453, -3143.79034566374, -3505.577470411466, -1961.889832722994, -3013.5680003088864, -3845.1907289936025, -2449.7242431571776, -844.6345896259063, -1682.0710442120676, -1868.5825123213651, -3180.4423108728206, -2337.4945465768637, -2793.715095992611, -3198.389590878285, -3930.040340966308, -4149.1220051404825, -2798.7324580714608, -2679.940886446876, -3292.739095249661, -1662.6309501945668, -3646.2870275675286, -4213.286032174066, -2602.635817997956, -2337.6833677355576, -3541.888917226098, -2676.81399251252, -1657.8591999539767, -2649.9410500563463, -2345.4126721796465, -3726.737148979451, -3226.4261280393835, -3358.8083371807975, -1971.392103554007, -1983.9240406272745, -2334.5735897993463, -2501.955616362023, -3932.3997032213806, -1503.1506546191613, -1450.6952374068665, -3143.155370318568, -3135.499421868569, -1029.846916121736, -1306.7521021982584, -2277.4794888168135, -2236.366883677382, -1521.9186637331065, -2647.1016362081887, -3025.50748863624, -1261.3328612069151, -2147.2558746054874, -2957.6964772012398, -3238.90668119345, -1711.4992848599381], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150], "policy_policy_0_reward": [-1063.2107828059013, -374.790579411581, -1059.9008119325297, -46.49357388442595, -665.0056102947251, -1051.9288057049923, -49.712220446507644, -633.8143984795596, -246.64089644848278, -942.6453267167041, -187.76427491624565, -384.6627739133165, -41.16116910719311, -520.15867374859, -621.0466606774743, -479.08732352706, -1050.6999859264993, -76.78475540938436, -104.14869593247847, -66.01337175236888, -1441.4869930950165, -1391.307147277554, -38.34445067431913, -235.741068120818, -24.701095652674912, -48.89676443706795, -442.817301556684, -57.94770379726735, -284.09001929976205, -437.3592144019798, -207.5307416779465, -958.6222191615059, -249.14845912670043, -1103.0184401115318, -605.5861994037482, -271.9308086210954, -931.5953242093805, -78.14343216283419, -913.7052598725779, -361.6467412336111, -807.2198859544397, -878.5830132805656, -417.5461666091795, -817.3336018947059, -16.77014887122008, -1426.1192100981386, -235.8722564845119, -432.43249789172194, -330.7369204273771, -618.766544722289, -332.6791388038203, -511.88454187933957, -244.33774009388029, -178.77966849918496, -50.64326265882884, -13.4998015162219, -514.5519807203972, -904.644563432255, -196.5730285891249, -279.53123324343653, -1004.6180427516009, -87.62713081164486, -131.90283542723114, -592.5830135174408, -29.010990257335855, -291.89495500671745, -339.28746746872645, -117.2035957124517, -868.2491920871043, -360.87941840402016, -1175.0774559212502, -811.5461395794989, -1173.266409751301, -161.33076674709278, -1194.3047041198777, -189.8517638374026, -90.05463580555629, -435.4076298999903, -680.7822829303013, -330.4765210583702, -535.1070022426719, -18.66177294311061, -106.91435319046779, -331.56338461649426, -1241.038472128108, -566.689479889064, -333.1410621630276, -31.74496489473702, -69.7605829509764, -827.6549771558699, -822.3633847079611, -411.9838483420695, -93.46153951131451, -899.1283775510531, -559.6200984026664, -62.84446889748098, -360.4025778494951, -337.46782128452713, -95.85449387888619, -438.835733348561, -167.37982044589083, -16.051626188596494, -749.9965608320364, -439.40552710887323, -1191.4039236169278, -1133.3937028298556, -130.7122702395666, -1305.6238620107367, -111.91984894235561, -995.5619936761024, -451.0053935798808, -1093.3376277767807, -146.22899345193633, -632.0743705112266, -43.74952398065911, -599.4803714516643, -444.5595323601561, -712.2203042332724, -143.18309487683686, -670.3536068411942, -347.73311969722783, -340.33757640215657, -469.1156637743314, -762.5444580973432, -760.9668579735402, -246.69587407634478, -210.1578692432501, -816.7235906106534, -139.05772793609194, -121.17931977910366, -29.1850349323142, -407.7483429560974, -692.2319404622382, -562.9791500562131, -571.3827153623926, -357.84442750508106, -738.8360099990954, -720.3412459755103, -159.54486636406344, -319.61303047006027, -150.6813089170421, -18.313373527389665, -292.08992262716697, -212.9908375052583, -641.7634047199534, -467.4401768759755, -366.15181770237024, -210.49490351089827, -268.5600866654922, -531.7959828104741, -151.20026597098143, -1157.2603849505713, -930.217419558154, -244.27596809010097, -766.972955366217, -367.5842390138869, -499.70558582926884, -266.0283131254997, -167.02525514988844, -1020.9752829218073, -1327.0625418716013, -341.1993201629132, -569.2585845975151, -222.7476920439287, -824.4215094977657, -573.7637969779149, -758.4158981353153, -205.56073093616632, -58.083338972272195, -46.66637090562632, -125.03533414791646, -464.24438697998534, -1197.9818628848388, -38.61220002460582, -1101.916258314052, -568.9878402524837, -865.3521539837883, -609.4030073710907, -1325.358570718797, -409.821242137453, -826.3825171501286, -680.8262319638454, -1202.6443163556994, -790.6896271136077, -138.09020861610057, -2.572786726396155, -1027.0846847085702, -293.0312824806411, -476.50503472938243, -527.9157345580303, -88.66656538093184, -156.35091505695434, -500.8204971174297, -48.54569740052971, -120.8110180401696, -97.54138164691817, 2.734139196411495, -663.1054024584072, -986.1926957937656, -1064.4206172042457, -235.75642265203533, -684.3094315820698, -525.7563786280641, -753.2199375985041, -627.0069888529146, -580.2784773688413, -6.854269518878535, -5.2580162728643085, -358.19061418650756, -487.07595896050606, -519.2266700314939, -769.1030762793309, -389.1220719722495, -891.6947999050983, -979.5283850047563, -415.11030157425756, -167.19652222717957, -769.546622633173, -1020.9971207892768, -541.9610332020253, -18.651600436933172, -372.3134648779723, -59.87111906907056, -29.88257808904539, -807.8829836320843, -296.0845625059482, -178.06808090468252, -464.5987747184696, -1286.764161040518, -348.2497501859744, -1265.4509728611301, -18.395543324811175, -587.7932490728184, -479.8105863436131, -365.2546851774466, -1489.7739017827805, -67.7817823270484, -1055.0235360052864, -933.1056731206794, -303.1803761859513, -1222.9819598888396, -1245.103192265034, -192.7447667468005, -20.07813879855949, -462.8822879645048, -1024.2730528628658, -898.7468143612027, -379.9626666520388, -855.0622842453251, -347.5326522900356, -49.84729752229525, -731.7499991650394, -26.58302533876896, -662.4122669753256, -491.297243721563, -993.9319624275937, -139.29107273371875, -104.34725632144036, -858.0588070683467, -917.938901757786, -121.18062692006079, -916.8292237982881, -741.070552274827, -977.0240892944363, -1089.086236705992, -264.2088247387079, -412.46733499148223, -849.6051615206349, -206.14715883390963, -717.2957630724428, -235.23426739118977, -73.86121183562709, -64.70773722229819, -439.0145054258153, -31.81686775097622, -168.11927936772858, -987.0130387068202, -347.89512597287313, -62.87645745180409, -116.16714271284248, -33.64387818546854, -497.0256175982934, -742.0805526798006, -207.30783194916657, -388.5246319086374, -1007.6486782781782, -435.1593893042604, -964.8550493856178, -80.22174943124587, -692.5574444735198, -429.83787822605984, -696.8455866732044, -400.82129126868824, -13.595545706014965, -796.3942447028945, -1033.473804557923, -55.87286344328627, -54.40287442961073, -1212.2780627032187, -437.68749085857434, -174.9328938420414, -477.5049911914198, -1437.8613413102817, -229.1156015324969, -878.9747630020466, -1237.80085118389, -308.87695915039, -429.80000546739274, -1069.965911396547, -883.5966137680886, -214.69980666223162, -773.4101563771097, -1444.958190845785, -457.6369069927891, -1258.4169442625691, -937.4485199451444, -225.66634141435344, -628.8494916876626, -42.29811450016867, -964.469990524132, -1218.3075336861998, -210.6548991065085, -485.2447041374192, -657.2030640841299, -108.53068543261446, -495.4173382605099, -767.3094214225375, -314.4535434631763, -620.2839159006508, -1095.2748762027863, -593.8996778551505, -17.31208422785194, -344.9809944316817, -261.65048740685245, -444.78770627303163, -1356.249898456879, -418.0749712520551, -1215.284269627415, -11.916106409662428, -644.7617818215174, -471.24719861929157, -905.4255496603597, -1059.7639937855295, -568.6920393295006, -1208.1572507793899, -7.5093514743778345, -752.3570555736628, -832.3384678405508, -70.48018465451877, -939.9507584548477, -42.003942613977124, -201.5790692989846, -803.71013132624, -597.374981093471, -693.0152434028824, -1249.780065604157, -579.1891187509357, -603.3110797786062, -784.3110463022288, -325.2976067901757, -575.3543752269042, -531.3382711208645, -646.552425771463, -307.4270399388815, -616.1418804544091, -285.06926097737653, -419.4344021482327, -166.5364799503076, -398.1349993749897, -388.6840575030715, -779.1763594988572, -541.543724375699, -509.9102121608139, -229.28562377083935, -590.0251302501356, -247.516523457148, -580.6627434484644, -397.0920107086154, -756.6157244694688, -363.52567009595174, -1270.2330621234862, -95.60046514136, -874.1156454572076, -285.280654047174, -1201.507322210223, -130.0207545515339, -833.2766107216057, -1004.6444113301575, -1215.1798880533731, -43.3044633827118, -863.1492240862551, -409.5097323022961, -833.7177269788086, -266.7613816457812, -985.6702721676534, -236.10115182967502, -359.2113787436903, -413.57210331318316, -525.8842629575267, -436.6232067099319, -213.46919346360735, -1311.6408253164002, -43.51040620118791, -239.08276786392778, -176.2208477821514, -17.109309632054266, -443.77069512272766, -1005.1142266965935, -163.14577565555794, -705.4335826924131, -115.29123957908581, -51.84912011184247, -751.4375946817189, -448.9950171365206, -1134.3826448528555, -1193.927725858416, -136.61288774087367, -686.6072878168362, -580.0648000423756, -1335.1870017628773, -55.76448471039762, -420.4846963356172, -433.4723630000614, -122.59649290334671, -470.8326176697381, -35.88014270238046, -638.1124461159693, -204.76301060673748, -319.72873872448173, -252.21089925729825, -1214.0754159971275, -480.4608502479914, -308.52601003321774, -491.57765034867595, -648.5154436915569, -1324.722987544577, -132.7340153517315, -424.6467324150709, -1051.2199681290924, -202.1757184280975, -354.25122474355555, -341.2803946080223, -43.21151808482903, -100.08104065559876, -191.0227380297312, -55.50546910020081, -118.23523548258166, -61.93350240461551, -974.8340471899774, -96.24384802088255, -265.5871757351834, -661.1183991693258, -28.460271597016103, -685.1895914693054, -637.1240508459823, -1248.3089231081874, -119.7430024373471, -568.6251658947284, -22.067631118342124, -277.6221611187778, -407.66164718697854, -618.5351597534923, -133.72886443535253, -270.2527407488969, -91.74025160838613, -251.41622428176242, -356.4463217267731, -776.222450198841, -1086.0624796462655, -176.954160354549, -963.7095099961633, -1330.639028664245, -13.998158221209023, -41.25830683099573, -675.9024849236288, -688.2796710735537, -237.52077931486895, -55.96275478894014, -169.29675465949745, -110.27290137005491, -60.092230911479376, -773.8471396976817, -185.25449137721873, -317.0591800923006, -811.0028325268078, -1108.44098077674, -694.3016497834981, -815.1604076548214, -203.6224628302823, -136.17097615589802, -569.1061409939833, -285.0112274623945, -1033.686967992588, -23.563977916155135, -1327.5383668283291, -16.35379053804897, -353.0019024021615, -382.1278337186152, -675.1702890126999, -284.8454691884137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5511803090213194, "mean_inference_ms": 1.72443669202174, "mean_action_processing_ms": 0.8111605943379493, "mean_env_wait_ms": 10.391576959207939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013383626937866211, "StateBufferConnector_ms": 0.009691476821899414, "ViewRequirementAgentConnector_ms": 0.3274223804473877}, "num_episodes": 29, "episode_return_max": -844.6345896259063, "episode_return_min": -4515.525476119021, "episode_return_mean": -2539.6972892188032, "episodes_this_iter": 29}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1263289, "num_agent_steps_trained": 1263289, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.59031332834515, "num_env_steps_trained_throughput_per_sec": 87.59031332834515, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1263289, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1263289, "timers": {"training_iteration_time_ms": 47548.919, "restore_workers_time_ms": 0.03, "training_step_time_ms": 47548.842, "sample_time_ms": 3247.461, "learn_time_ms": 44242.43, "learn_throughput": 90.411, "synch_weights_time_ms": 55.918}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1263289, "num_agent_steps_trained": 1263289}, "done": false, "training_iteration": 72, "trial_id": "05c72_00000", "date": "2024-07-26_15-42-13", "timestamp": 1721988733, "time_this_iter_s": 45.67888879776001, "time_total_s": 3551.969446659088, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00ddab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3551.969446659088, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 11.873846153846154, "ram_util_percent": 30.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 151.86482088541743, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.863230218851205, "policy_loss": 0.0016995083991052451, "vf_loss": 4.875129777373689, "vf_explained_var": 0.9813084663766803, "kl": 0.015763682884742114, "entropy": 2.5569610353672143, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.81060606060606, "num_grad_updates_lifetime": 299160.5, "diff_num_grad_updates_vs_sampler_policy": 1979.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1280160, "num_agent_steps_trained": 1280160}, "env_runners": {"episode_reward_max": -844.6345896259063, "episode_reward_min": -4495.916289989663, "episode_reward_mean": -2616.772303523929, "episode_len_mean": 149.33, "episode_media": {}, "episodes_timesteps_total": 14933, "policy_reward_min": {"policy_0": -1489.7739017827805}, "policy_reward_max": {"policy_0": 2.734139196411495}, "policy_reward_mean": {"policy_0": -523.354460704786}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2680.697675944601, -1533.8143816454422, -2263.5271837692544, -2296.1795803138116, -1315.8388472968113, -1844.442967565209, -3249.926993936021, -2321.318676040349, -3284.6896481737253, -1642.490135927296, -2927.7900423513956, -3778.9228144636168, -3638.6329011993807, -2327.1095232030193, -915.1946929960149, -2808.525957906924, -2826.049159313587, -1437.6573363075975, -3548.675003192931, -2914.811600425912, -1288.6017461051044, -2573.7653293555913, -2716.7050367798183, -3848.8652694217453, -3143.79034566374, -3505.577470411466, -1961.889832722994, -3013.5680003088864, -3845.1907289936025, -2449.7242431571776, -844.6345896259063, -1682.0710442120676, -1868.5825123213651, -3180.4423108728206, -2337.4945465768637, -2793.715095992611, -3198.389590878285, -3930.040340966308, -4149.1220051404825, -2798.7324580714608, -2679.940886446876, -3292.739095249661, -1662.6309501945668, -3646.2870275675286, -4213.286032174066, -2602.635817997956, -2337.6833677355576, -3541.888917226098, -2676.81399251252, -1657.8591999539767, -2649.9410500563463, -2345.4126721796465, -3726.737148979451, -3226.4261280393835, -3358.8083371807975, -1971.392103554007, -1983.9240406272745, -2334.5735897993463, -2501.955616362023, -3932.3997032213806, -1503.1506546191613, -1450.6952374068665, -3143.155370318568, -3135.499421868569, -1029.846916121736, -1306.7521021982584, -2277.4794888168135, -2236.366883677382, -1521.9186637331065, -2647.1016362081887, -3025.50748863624, -1261.3328612069151, -2147.2558746054874, -2957.6964772012398, -3238.90668119345, -1711.4992848599381, -3608.6807463505193, -2286.537998663947, -3030.453323442198, -1906.1548066524595, -2055.5845422884545, -3197.0874928153803, -2586.4735917845564, -3479.447689207373, -3513.740999467828, -1789.9795874173421, -2128.775227720231, -4469.117855433674, -3400.066369583599, -2475.4531752457247, -1975.4818726224723, -2902.406657781362, -3272.1575785159143, -2556.1364296271713, -2519.6935613203436, -2768.2042240124474, -1163.3668391913282, -2161.1423736740157, -4495.916289989663, -2310.4727803033443], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150], "policy_policy_0_reward": [-347.73311969722783, -340.33757640215657, -469.1156637743314, -762.5444580973432, -760.9668579735402, -246.69587407634478, -210.1578692432501, -816.7235906106534, -139.05772793609194, -121.17931977910366, -29.1850349323142, -407.7483429560974, -692.2319404622382, -562.9791500562131, -571.3827153623926, -357.84442750508106, -738.8360099990954, -720.3412459755103, -159.54486636406344, -319.61303047006027, -150.6813089170421, -18.313373527389665, -292.08992262716697, -212.9908375052583, -641.7634047199534, -467.4401768759755, -366.15181770237024, -210.49490351089827, -268.5600866654922, -531.7959828104741, -151.20026597098143, -1157.2603849505713, -930.217419558154, -244.27596809010097, -766.972955366217, -367.5842390138869, -499.70558582926884, -266.0283131254997, -167.02525514988844, -1020.9752829218073, -1327.0625418716013, -341.1993201629132, -569.2585845975151, -222.7476920439287, -824.4215094977657, -573.7637969779149, -758.4158981353153, -205.56073093616632, -58.083338972272195, -46.66637090562632, -125.03533414791646, -464.24438697998534, -1197.9818628848388, -38.61220002460582, -1101.916258314052, -568.9878402524837, -865.3521539837883, -609.4030073710907, -1325.358570718797, -409.821242137453, -826.3825171501286, -680.8262319638454, -1202.6443163556994, -790.6896271136077, -138.09020861610057, -2.572786726396155, -1027.0846847085702, -293.0312824806411, -476.50503472938243, -527.9157345580303, -88.66656538093184, -156.35091505695434, -500.8204971174297, -48.54569740052971, -120.8110180401696, -97.54138164691817, 2.734139196411495, -663.1054024584072, -986.1926957937656, -1064.4206172042457, -235.75642265203533, -684.3094315820698, -525.7563786280641, -753.2199375985041, -627.0069888529146, -580.2784773688413, -6.854269518878535, -5.2580162728643085, -358.19061418650756, -487.07595896050606, -519.2266700314939, -769.1030762793309, -389.1220719722495, -891.6947999050983, -979.5283850047563, -415.11030157425756, -167.19652222717957, -769.546622633173, -1020.9971207892768, -541.9610332020253, -18.651600436933172, -372.3134648779723, -59.87111906907056, -29.88257808904539, -807.8829836320843, -296.0845625059482, -178.06808090468252, -464.5987747184696, -1286.764161040518, -348.2497501859744, -1265.4509728611301, -18.395543324811175, -587.7932490728184, -479.8105863436131, -365.2546851774466, -1489.7739017827805, -67.7817823270484, -1055.0235360052864, -933.1056731206794, -303.1803761859513, -1222.9819598888396, -1245.103192265034, -192.7447667468005, -20.07813879855949, -462.8822879645048, -1024.2730528628658, -898.7468143612027, -379.9626666520388, -855.0622842453251, -347.5326522900356, -49.84729752229525, -731.7499991650394, -26.58302533876896, -662.4122669753256, -491.297243721563, -993.9319624275937, -139.29107273371875, -104.34725632144036, -858.0588070683467, -917.938901757786, -121.18062692006079, -916.8292237982881, -741.070552274827, -977.0240892944363, -1089.086236705992, -264.2088247387079, -412.46733499148223, -849.6051615206349, -206.14715883390963, -717.2957630724428, -235.23426739118977, -73.86121183562709, -64.70773722229819, -439.0145054258153, -31.81686775097622, -168.11927936772858, -987.0130387068202, -347.89512597287313, -62.87645745180409, -116.16714271284248, -33.64387818546854, -497.0256175982934, -742.0805526798006, -207.30783194916657, -388.5246319086374, -1007.6486782781782, -435.1593893042604, -964.8550493856178, -80.22174943124587, -692.5574444735198, -429.83787822605984, -696.8455866732044, -400.82129126868824, -13.595545706014965, -796.3942447028945, -1033.473804557923, -55.87286344328627, -54.40287442961073, -1212.2780627032187, -437.68749085857434, -174.9328938420414, -477.5049911914198, -1437.8613413102817, -229.1156015324969, -878.9747630020466, -1237.80085118389, -308.87695915039, -429.80000546739274, -1069.965911396547, -883.5966137680886, -214.69980666223162, -773.4101563771097, -1444.958190845785, -457.6369069927891, -1258.4169442625691, -937.4485199451444, -225.66634141435344, -628.8494916876626, -42.29811450016867, -964.469990524132, -1218.3075336861998, -210.6548991065085, -485.2447041374192, -657.2030640841299, -108.53068543261446, -495.4173382605099, -767.3094214225375, -314.4535434631763, -620.2839159006508, -1095.2748762027863, -593.8996778551505, -17.31208422785194, -344.9809944316817, -261.65048740685245, -444.78770627303163, -1356.249898456879, -418.0749712520551, -1215.284269627415, -11.916106409662428, -644.7617818215174, -471.24719861929157, -905.4255496603597, -1059.7639937855295, -568.6920393295006, -1208.1572507793899, -7.5093514743778345, -752.3570555736628, -832.3384678405508, -70.48018465451877, -939.9507584548477, -42.003942613977124, -201.5790692989846, -803.71013132624, -597.374981093471, -693.0152434028824, -1249.780065604157, -579.1891187509357, -603.3110797786062, -784.3110463022288, -325.2976067901757, -575.3543752269042, -531.3382711208645, -646.552425771463, -307.4270399388815, -616.1418804544091, -285.06926097737653, -419.4344021482327, -166.5364799503076, -398.1349993749897, -388.6840575030715, -779.1763594988572, -541.543724375699, -509.9102121608139, -229.28562377083935, -590.0251302501356, -247.516523457148, -580.6627434484644, -397.0920107086154, -756.6157244694688, -363.52567009595174, -1270.2330621234862, -95.60046514136, -874.1156454572076, -285.280654047174, -1201.507322210223, -130.0207545515339, -833.2766107216057, -1004.6444113301575, -1215.1798880533731, -43.3044633827118, -863.1492240862551, -409.5097323022961, -833.7177269788086, -266.7613816457812, -985.6702721676534, -236.10115182967502, -359.2113787436903, -413.57210331318316, -525.8842629575267, -436.6232067099319, -213.46919346360735, -1311.6408253164002, -43.51040620118791, -239.08276786392778, -176.2208477821514, -17.109309632054266, -443.77069512272766, -1005.1142266965935, -163.14577565555794, -705.4335826924131, -115.29123957908581, -51.84912011184247, -751.4375946817189, -448.9950171365206, -1134.3826448528555, -1193.927725858416, -136.61288774087367, -686.6072878168362, -580.0648000423756, -1335.1870017628773, -55.76448471039762, -420.4846963356172, -433.4723630000614, -122.59649290334671, -470.8326176697381, -35.88014270238046, -638.1124461159693, -204.76301060673748, -319.72873872448173, -252.21089925729825, -1214.0754159971275, -480.4608502479914, -308.52601003321774, -491.57765034867595, -648.5154436915569, -1324.722987544577, -132.7340153517315, -424.6467324150709, -1051.2199681290924, -202.1757184280975, -354.25122474355555, -341.2803946080223, -43.21151808482903, -100.08104065559876, -191.0227380297312, -55.50546910020081, -118.23523548258166, -61.93350240461551, -974.8340471899774, -96.24384802088255, -265.5871757351834, -661.1183991693258, -28.460271597016103, -685.1895914693054, -637.1240508459823, -1248.3089231081874, -119.7430024373471, -568.6251658947284, -22.067631118342124, -277.6221611187778, -407.66164718697854, -618.5351597534923, -133.72886443535253, -270.2527407488969, -91.74025160838613, -251.41622428176242, -356.4463217267731, -776.222450198841, -1086.0624796462655, -176.954160354549, -963.7095099961633, -1330.639028664245, -13.998158221209023, -41.25830683099573, -675.9024849236288, -688.2796710735537, -237.52077931486895, -55.96275478894014, -169.29675465949745, -110.27290137005491, -60.092230911479376, -773.8471396976817, -185.25449137721873, -317.0591800923006, -811.0028325268078, -1108.44098077674, -694.3016497834981, -815.1604076548214, -203.6224628302823, -136.17097615589802, -569.1061409939833, -285.0112274623945, -1033.686967992588, -23.563977916155135, -1327.5383668283291, -16.35379053804897, -353.0019024021615, -382.1278337186152, -675.1702890126999, -284.8454691884137, -353.86398988110307, -1225.2303263205952, -253.9788020772536, -579.0410916814349, -1196.5665363901342, -491.7226340450274, -361.34142450897014, -64.55541302985552, -669.8505908550618, -699.0679362250316, -38.26562856503987, -582.5485000213845, -455.5881624845179, -1431.4280856173218, -522.6229467539324, -150.85890225374033, -378.21549019253575, -201.649126232488, -576.693646009904, -598.7376419637922, -312.22181213454144, -43.77882294197415, -799.8165507386401, -354.40452494884045, -545.3628315244594, -54.363940260281865, -893.5724522724962, -723.8014442374081, -660.2837386883089, -865.0659173568861, -651.2402598948373, -645.9344245394627, -126.34199695644648, -237.95254629387398, -925.0043640999371, -1250.4462378768396, -1027.0701902244666, -558.613402201151, -13.351092302187887, -629.9667666027266, -774.4822016063555, -1459.3610864604477, -674.0848924264395, -109.80368711426152, -496.0091318603259, -28.444382293094325, -508.6645470730472, -29.037313201946095, -509.40872708122936, -714.424617768026, -594.5727757075541, -546.717191638274, -549.2529501549155, -283.3679837632682, -154.86432645622014, -1234.0764375606745, -196.5440587931923, -678.1662614123135, -1301.2129878830674, -1059.1181097844283, -824.4448194848449, -821.3897203647728, -323.1828901346053, -1001.3248560747679, -429.72408352461, -776.9750093884087, -1437.0764417281528, -108.18934910328704, -85.27585759439248, -67.93651743148476, -121.68717016988047, -64.97651174023704, -200.07659939495647, -710.5599609826459, -878.1816303347521, -461.016411615788, -7.352671513672196, -296.13567540600525, -1074.8888511569046, -1063.0130480889895, -123.24663498758802, -1189.987572462103, -974.5208494470606, -178.3610090672432, -806.04151255192, -369.5852331384397, -77.04764556802809, -408.8981523633819, -1226.0797509307265, -474.52564762659887, -275.42521900019955, -152.35166545430295, -1116.550545710513, -99.74345338498759, -875.6226777703421, -735.8708271019177, -1015.9139704375393, -22.018530071889167, -391.5750551752606, -602.825841225841, -469.1631221280448, -48.50629456940731, -5.56927951690723, -262.50850330245413, -377.619639674516, -606.70608624025, -412.5173012131982, -384.4546583968674, -147.8056944445755, -609.6586333791281, -1047.7180470041249, -576.3260887254785, -1028.9331030605201, -946.8460762187665, -896.092974980778, -882.3397785395268, -96.89650840997706, -287.1961935404872, -778.8020670981552, -265.2382327151968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5525900837114273, "mean_inference_ms": 1.7244199890573446, "mean_action_processing_ms": 0.8105299685788309, "mean_env_wait_ms": 10.394836637476338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013745546340942383, "StateBufferConnector_ms": 0.00980830192565918, "ViewRequirementAgentConnector_ms": 0.3341529369354248}, "num_episodes": 24, "episode_return_max": -844.6345896259063, "episode_return_min": -4495.916289989663, "episode_return_mean": -2616.772303523929, "episodes_this_iter": 24}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280160, "num_agent_steps_trained": 1280160, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.12918064130203, "num_env_steps_trained_throughput_per_sec": 79.12918064130203, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1280160, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280160, "timers": {"training_iteration_time_ms": 48111.631, "restore_workers_time_ms": 0.03, "training_step_time_ms": 48111.554, "sample_time_ms": 3249.112, "learn_time_ms": 44803.751, "learn_throughput": 89.278, "synch_weights_time_ms": 55.698}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1280160, "num_agent_steps_trained": 1280160}, "done": false, "training_iteration": 73, "trial_id": "05c72_00000", "date": "2024-07-26_15-43-04", "timestamp": 1721988784, "time_this_iter_s": 50.56125044822693, "time_total_s": 3602.530697107315, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd0148c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3602.530697107315, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 11.7, "ram_util_percent": 30.54861111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 146.13327883096565, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.668331876912512, "policy_loss": 0.0018499462130038362, "vf_loss": 4.680304718017578, "vf_explained_var": 0.9854585849701014, "kl": 0.01602360844515255, "entropy": 2.5990715903447086, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.46616541353383, "num_grad_updates_lifetime": 303135.5, "diff_num_grad_updates_vs_sampler_policy": 1994.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1297113, "num_agent_steps_trained": 1297113}, "env_runners": {"episode_reward_max": -381.60663652589926, "episode_reward_min": -4495.916289989663, "episode_reward_mean": -2524.4499330854787, "episode_len_mean": 148.62, "episode_media": {}, "episodes_timesteps_total": 14862, "policy_reward_min": {"policy_0": -1487.8274257310206}, "policy_reward_max": {"policy_0": -5.56927951690723}, "policy_reward_mean": {"policy_0": -504.8899866170959}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3845.1907289936025, -2449.7242431571776, -844.6345896259063, -1682.0710442120676, -1868.5825123213651, -3180.4423108728206, -2337.4945465768637, -2793.715095992611, -3198.389590878285, -3930.040340966308, -4149.1220051404825, -2798.7324580714608, -2679.940886446876, -3292.739095249661, -1662.6309501945668, -3646.2870275675286, -4213.286032174066, -2602.635817997956, -2337.6833677355576, -3541.888917226098, -2676.81399251252, -1657.8591999539767, -2649.9410500563463, -2345.4126721796465, -3726.737148979451, -3226.4261280393835, -3358.8083371807975, -1971.392103554007, -1983.9240406272745, -2334.5735897993463, -2501.955616362023, -3932.3997032213806, -1503.1506546191613, -1450.6952374068665, -3143.155370318568, -3135.499421868569, -1029.846916121736, -1306.7521021982584, -2277.4794888168135, -2236.366883677382, -1521.9186637331065, -2647.1016362081887, -3025.50748863624, -1261.3328612069151, -2147.2558746054874, -2957.6964772012398, -3238.90668119345, -1711.4992848599381, -3608.6807463505193, -2286.537998663947, -3030.453323442198, -1906.1548066524595, -2055.5845422884545, -3197.0874928153803, -2586.4735917845564, -3479.447689207373, -3513.740999467828, -1789.9795874173421, -2128.775227720231, -4469.117855433674, -3400.066369583599, -2475.4531752457247, -1975.4818726224723, -2902.406657781362, -3272.1575785159143, -2556.1364296271713, -2519.6935613203436, -2768.2042240124474, -1163.3668391913282, -2161.1423736740157, -4495.916289989663, -2310.4727803033443, -2251.5435472503045, -1916.654225678401, -1220.124857128137, -1945.9427619709227, -2670.4404385780017, -3096.2105941547393, -2013.859122136383, -2386.7450252571048, -2345.0496214042723, -2343.196891933406, -3215.635434906857, -1154.0042986820283, -1136.7042702403894, -3161.9954381662883, -1964.4194452614113, -2225.2975512144276, -2947.1276517493725, -1440.105380237543, -3032.9042838396094, -2065.3898273232535, -381.60663652589926, -1266.6833169537065, -2742.950816891214, -3295.251657836673, -1025.2444985555485, -3197.479256121181, -2724.411587214447, -3209.8426716856998], "episode_lengths": [150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-121.18062692006079, -916.8292237982881, -741.070552274827, -977.0240892944363, -1089.086236705992, -264.2088247387079, -412.46733499148223, -849.6051615206349, -206.14715883390963, -717.2957630724428, -235.23426739118977, -73.86121183562709, -64.70773722229819, -439.0145054258153, -31.81686775097622, -168.11927936772858, -987.0130387068202, -347.89512597287313, -62.87645745180409, -116.16714271284248, -33.64387818546854, -497.0256175982934, -742.0805526798006, -207.30783194916657, -388.5246319086374, -1007.6486782781782, -435.1593893042604, -964.8550493856178, -80.22174943124587, -692.5574444735198, -429.83787822605984, -696.8455866732044, -400.82129126868824, -13.595545706014965, -796.3942447028945, -1033.473804557923, -55.87286344328627, -54.40287442961073, -1212.2780627032187, -437.68749085857434, -174.9328938420414, -477.5049911914198, -1437.8613413102817, -229.1156015324969, -878.9747630020466, -1237.80085118389, -308.87695915039, -429.80000546739274, -1069.965911396547, -883.5966137680886, -214.69980666223162, -773.4101563771097, -1444.958190845785, -457.6369069927891, -1258.4169442625691, -937.4485199451444, -225.66634141435344, -628.8494916876626, -42.29811450016867, -964.469990524132, -1218.3075336861998, -210.6548991065085, -485.2447041374192, -657.2030640841299, -108.53068543261446, -495.4173382605099, -767.3094214225375, -314.4535434631763, -620.2839159006508, -1095.2748762027863, -593.8996778551505, -17.31208422785194, -344.9809944316817, -261.65048740685245, -444.78770627303163, -1356.249898456879, -418.0749712520551, -1215.284269627415, -11.916106409662428, -644.7617818215174, -471.24719861929157, -905.4255496603597, -1059.7639937855295, -568.6920393295006, -1208.1572507793899, -7.5093514743778345, -752.3570555736628, -832.3384678405508, -70.48018465451877, -939.9507584548477, -42.003942613977124, -201.5790692989846, -803.71013132624, -597.374981093471, -693.0152434028824, -1249.780065604157, -579.1891187509357, -603.3110797786062, -784.3110463022288, -325.2976067901757, -575.3543752269042, -531.3382711208645, -646.552425771463, -307.4270399388815, -616.1418804544091, -285.06926097737653, -419.4344021482327, -166.5364799503076, -398.1349993749897, -388.6840575030715, -779.1763594988572, -541.543724375699, -509.9102121608139, -229.28562377083935, -590.0251302501356, -247.516523457148, -580.6627434484644, -397.0920107086154, -756.6157244694688, -363.52567009595174, -1270.2330621234862, -95.60046514136, -874.1156454572076, -285.280654047174, -1201.507322210223, -130.0207545515339, -833.2766107216057, -1004.6444113301575, -1215.1798880533731, -43.3044633827118, -863.1492240862551, -409.5097323022961, -833.7177269788086, -266.7613816457812, -985.6702721676534, -236.10115182967502, -359.2113787436903, -413.57210331318316, -525.8842629575267, -436.6232067099319, -213.46919346360735, -1311.6408253164002, -43.51040620118791, -239.08276786392778, -176.2208477821514, -17.109309632054266, -443.77069512272766, -1005.1142266965935, -163.14577565555794, -705.4335826924131, -115.29123957908581, -51.84912011184247, -751.4375946817189, -448.9950171365206, -1134.3826448528555, -1193.927725858416, -136.61288774087367, -686.6072878168362, -580.0648000423756, -1335.1870017628773, -55.76448471039762, -420.4846963356172, -433.4723630000614, -122.59649290334671, -470.8326176697381, -35.88014270238046, -638.1124461159693, -204.76301060673748, -319.72873872448173, -252.21089925729825, -1214.0754159971275, -480.4608502479914, -308.52601003321774, -491.57765034867595, -648.5154436915569, -1324.722987544577, -132.7340153517315, -424.6467324150709, -1051.2199681290924, -202.1757184280975, -354.25122474355555, -341.2803946080223, -43.21151808482903, -100.08104065559876, -191.0227380297312, -55.50546910020081, -118.23523548258166, -61.93350240461551, -974.8340471899774, -96.24384802088255, -265.5871757351834, -661.1183991693258, -28.460271597016103, -685.1895914693054, -637.1240508459823, -1248.3089231081874, -119.7430024373471, -568.6251658947284, -22.067631118342124, -277.6221611187778, -407.66164718697854, -618.5351597534923, -133.72886443535253, -270.2527407488969, -91.74025160838613, -251.41622428176242, -356.4463217267731, -776.222450198841, -1086.0624796462655, -176.954160354549, -963.7095099961633, -1330.639028664245, -13.998158221209023, -41.25830683099573, -675.9024849236288, -688.2796710735537, -237.52077931486895, -55.96275478894014, -169.29675465949745, -110.27290137005491, -60.092230911479376, -773.8471396976817, -185.25449137721873, -317.0591800923006, -811.0028325268078, -1108.44098077674, -694.3016497834981, -815.1604076548214, -203.6224628302823, -136.17097615589802, -569.1061409939833, -285.0112274623945, -1033.686967992588, -23.563977916155135, -1327.5383668283291, -16.35379053804897, -353.0019024021615, -382.1278337186152, -675.1702890126999, -284.8454691884137, -353.86398988110307, -1225.2303263205952, -253.9788020772536, -579.0410916814349, -1196.5665363901342, -491.7226340450274, -361.34142450897014, -64.55541302985552, -669.8505908550618, -699.0679362250316, -38.26562856503987, -582.5485000213845, -455.5881624845179, -1431.4280856173218, -522.6229467539324, -150.85890225374033, -378.21549019253575, -201.649126232488, -576.693646009904, -598.7376419637922, -312.22181213454144, -43.77882294197415, -799.8165507386401, -354.40452494884045, -545.3628315244594, -54.363940260281865, -893.5724522724962, -723.8014442374081, -660.2837386883089, -865.0659173568861, -651.2402598948373, -645.9344245394627, -126.34199695644648, -237.95254629387398, -925.0043640999371, -1250.4462378768396, -1027.0701902244666, -558.613402201151, -13.351092302187887, -629.9667666027266, -774.4822016063555, -1459.3610864604477, -674.0848924264395, -109.80368711426152, -496.0091318603259, -28.444382293094325, -508.6645470730472, -29.037313201946095, -509.40872708122936, -714.424617768026, -594.5727757075541, -546.717191638274, -549.2529501549155, -283.3679837632682, -154.86432645622014, -1234.0764375606745, -196.5440587931923, -678.1662614123135, -1301.2129878830674, -1059.1181097844283, -824.4448194848449, -821.3897203647728, -323.1828901346053, -1001.3248560747679, -429.72408352461, -776.9750093884087, -1437.0764417281528, -108.18934910328704, -85.27585759439248, -67.93651743148476, -121.68717016988047, -64.97651174023704, -200.07659939495647, -710.5599609826459, -878.1816303347521, -461.016411615788, -7.352671513672196, -296.13567540600525, -1074.8888511569046, -1063.0130480889895, -123.24663498758802, -1189.987572462103, -974.5208494470606, -178.3610090672432, -806.04151255192, -369.5852331384397, -77.04764556802809, -408.8981523633819, -1226.0797509307265, -474.52564762659887, -275.42521900019955, -152.35166545430295, -1116.550545710513, -99.74345338498759, -875.6226777703421, -735.8708271019177, -1015.9139704375393, -22.018530071889167, -391.5750551752606, -602.825841225841, -469.1631221280448, -48.50629456940731, -5.56927951690723, -262.50850330245413, -377.619639674516, -606.70608624025, -412.5173012131982, -384.4546583968674, -147.8056944445755, -609.6586333791281, -1047.7180470041249, -576.3260887254785, -1028.9331030605201, -946.8460762187665, -896.092974980778, -882.3397785395268, -96.89650840997706, -287.1961935404872, -778.8020670981552, -265.2382327151968, -669.2067971739847, -412.4886026051805, -535.2534748828876, -116.47989312196697, -518.1147794662858, -251.9655611089994, -146.38353785531277, -113.98786602709781, -1366.523759106827, -37.79350158016394, -85.1855771984783, -148.77631161713572, -207.96049384366862, -383.24447735285935, -394.9579971159965, -290.5837235821723, -353.82413592074744, -145.79867961264821, -956.5089980843745, -199.22722477097756, -241.80394211854144, -552.979545820476, -1246.500873401842, -181.66070262490558, -447.49537461223576, -129.24974462281946, -930.4118794767492, -423.45621802425126, -1143.9561146781848, -469.13663735273076, -359.20999485051703, -190.07030549980405, -277.5898498599539, -455.19928223371505, -731.7896896923912, -95.71575899471735, -382.56894275865835, -567.2151042829377, -1253.169118340839, -88.07610087994982, -839.2937617620445, -78.01228924099469, -145.60811910111258, -608.7687785185723, -673.3666727815493, -73.34233089988496, -723.6679840456193, -104.80865328868803, -705.3221928438834, -736.055730855329, -882.19255097255, -590.3684209994143, -246.54161177618798, -1068.887606376295, -427.6452447824109, -656.7082774454215, -133.26842243980053, -115.91869868973637, -92.81380441822002, -155.29509568884882, -613.6031183497953, -205.75922960493187, -46.268949556515466, -158.88658776581426, -112.18638496333317, -1136.9168028659387, -209.5653693691233, -1348.2932551036815, -187.12408117069668, -280.0959296568472, -84.74754168714811, -353.2271193849445, -359.23950944601586, -1030.8148208022749, -136.3904539410266, -865.4557992213737, -488.623227134528, -744.4602381043394, -43.41633571270001, -83.34195104148881, -1071.3727862847986, -152.25088577971326, -338.8721074002175, -1366.910831777075, -17.721040507570414, -710.0359617488868, -197.82961525715484, -67.13057214540619, -12.954985508850765, -452.154245577246, -137.72976314261587, -491.7734304583403, -856.0009898382029, -241.67728943105118, -1305.722810969397, -316.28225727254573, -689.4207032956527, -306.7308653937424, -649.801414350292, -103.15458701102035, -182.34182354538729, -96.64701537544097, -30.775437913166652, -28.72182098117284, -43.1205387107315, -520.3072979105235, -120.46586334476099, -232.0780877048856, -19.564321160031227, -374.2677468335047, -332.08333096894603, -1296.2996991044065, -536.6163210360885, -110.97373838586694, -466.9777273959056, -416.78784831106196, -616.1285096911026, -144.970723430436, -629.5371506730492, -1487.8274257310206, -211.4453836974572, -471.49523500111957, -67.67505697745766, -209.48422412553086, -65.14459875398356, -58.984144789500625, -1179.6979079671748, -112.18462980745697, -594.098344504347, -1252.5142290527008, -944.3602262019463, -947.3267338533507, -93.74198476758293, -247.1694131350081, -491.81322925656116, -1319.3304704593615, -332.50625104324376, -707.8007631334224, -591.3731360215089, -258.8320510281668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5488957737400504, "mean_inference_ms": 1.7237426640221103, "mean_action_processing_ms": 0.8093443596890504, "mean_env_wait_ms": 10.376775678215948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013840436935424805, "StateBufferConnector_ms": 0.009552955627441406, "ViewRequirementAgentConnector_ms": 0.31912660598754883}, "num_episodes": 28, "episode_return_max": -381.60663652589926, "episode_return_min": -4495.916289989663, "episode_return_mean": -2524.4499330854787, "episodes_this_iter": 28}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1297113, "num_agent_steps_trained": 1297113, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.97442853017581, "num_env_steps_trained_throughput_per_sec": 85.97442853017581, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1297113, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1297113, "timers": {"training_iteration_time_ms": 47778.508, "restore_workers_time_ms": 0.03, "training_step_time_ms": 47778.432, "sample_time_ms": 3226.588, "learn_time_ms": 44493.395, "learn_throughput": 89.901, "synch_weights_time_ms": 55.464}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1297113, "num_agent_steps_trained": 1297113}, "done": false, "training_iteration": 74, "trial_id": "05c72_00000", "date": "2024-07-26_15-43-51", "timestamp": 1721988831, "time_this_iter_s": 46.53559422492981, "time_total_s": 3649.066291332245, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00dd240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3649.066291332245, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 12.480303030303029, "ram_util_percent": 30.598484848484844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 134.3939342759735, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000002, "total_loss": 4.856379822593423, "policy_loss": 0.0016266054928270584, "vf_loss": 4.868524771009511, "vf_explained_var": 0.9797373387054424, "kl": 0.015192178708491893, "entropy": 2.5308105169244075, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.75373134328358, "num_grad_updates_lifetime": 307140.5, "diff_num_grad_updates_vs_sampler_policy": 2009.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1314232, "num_agent_steps_trained": 1314232}, "env_runners": {"episode_reward_max": -381.60663652589926, "episode_reward_min": -4522.8100759454455, "episode_reward_mean": -2495.7678018367574, "episode_len_mean": 147.88, "episode_media": {}, "episodes_timesteps_total": 14788, "policy_reward_min": {"policy_0": -1487.8274257310206}, "policy_reward_max": {"policy_0": -5.56927951690723}, "policy_reward_mean": {"policy_0": -499.1535603673516}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2334.5735897993463, -2501.955616362023, -3932.3997032213806, -1503.1506546191613, -1450.6952374068665, -3143.155370318568, -3135.499421868569, -1029.846916121736, -1306.7521021982584, -2277.4794888168135, -2236.366883677382, -1521.9186637331065, -2647.1016362081887, -3025.50748863624, -1261.3328612069151, -2147.2558746054874, -2957.6964772012398, -3238.90668119345, -1711.4992848599381, -3608.6807463505193, -2286.537998663947, -3030.453323442198, -1906.1548066524595, -2055.5845422884545, -3197.0874928153803, -2586.4735917845564, -3479.447689207373, -3513.740999467828, -1789.9795874173421, -2128.775227720231, -4469.117855433674, -3400.066369583599, -2475.4531752457247, -1975.4818726224723, -2902.406657781362, -3272.1575785159143, -2556.1364296271713, -2519.6935613203436, -2768.2042240124474, -1163.3668391913282, -2161.1423736740157, -4495.916289989663, -2310.4727803033443, -2251.5435472503045, -1916.654225678401, -1220.124857128137, -1945.9427619709227, -2670.4404385780017, -3096.2105941547393, -2013.859122136383, -2386.7450252571048, -2345.0496214042723, -2343.196891933406, -3215.635434906857, -1154.0042986820283, -1136.7042702403894, -3161.9954381662883, -1964.4194452614113, -2225.2975512144276, -2947.1276517493725, -1440.105380237543, -3032.9042838396094, -2065.3898273232535, -381.60663652589926, -1266.6833169537065, -2742.950816891214, -3295.251657836673, -1025.2444985555485, -3197.479256121181, -2724.411587214447, -3209.8426716856998, -3379.517007530547, -3249.530944377784, -3488.5551386996235, -4329.942965649628, -2681.582172499066, -3382.89614863369, -1650.3641560309438, -934.892209947421, -2831.3291132673216, -2840.826775202598, -1800.544882660279, -1249.500361957748, -2881.4180674944523, -4522.8100759454455, -2018.9361818743523, -2226.217365437118, -3538.5461774585733, -2898.943429182057, -3244.3712270738665, -2154.395335704367, -4100.769921977041, -2828.5208085645495, -2468.9311935539945, -2529.9476943394156, -1520.7637595128076, -3156.0111533786935, -1040.4107520536345, -2633.0054395050597, -2200.8526501004167], "episode_lengths": [150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150], "policy_policy_0_reward": [-17.109309632054266, -443.77069512272766, -1005.1142266965935, -163.14577565555794, -705.4335826924131, -115.29123957908581, -51.84912011184247, -751.4375946817189, -448.9950171365206, -1134.3826448528555, -1193.927725858416, -136.61288774087367, -686.6072878168362, -580.0648000423756, -1335.1870017628773, -55.76448471039762, -420.4846963356172, -433.4723630000614, -122.59649290334671, -470.8326176697381, -35.88014270238046, -638.1124461159693, -204.76301060673748, -319.72873872448173, -252.21089925729825, -1214.0754159971275, -480.4608502479914, -308.52601003321774, -491.57765034867595, -648.5154436915569, -1324.722987544577, -132.7340153517315, -424.6467324150709, -1051.2199681290924, -202.1757184280975, -354.25122474355555, -341.2803946080223, -43.21151808482903, -100.08104065559876, -191.0227380297312, -55.50546910020081, -118.23523548258166, -61.93350240461551, -974.8340471899774, -96.24384802088255, -265.5871757351834, -661.1183991693258, -28.460271597016103, -685.1895914693054, -637.1240508459823, -1248.3089231081874, -119.7430024373471, -568.6251658947284, -22.067631118342124, -277.6221611187778, -407.66164718697854, -618.5351597534923, -133.72886443535253, -270.2527407488969, -91.74025160838613, -251.41622428176242, -356.4463217267731, -776.222450198841, -1086.0624796462655, -176.954160354549, -963.7095099961633, -1330.639028664245, -13.998158221209023, -41.25830683099573, -675.9024849236288, -688.2796710735537, -237.52077931486895, -55.96275478894014, -169.29675465949745, -110.27290137005491, -60.092230911479376, -773.8471396976817, -185.25449137721873, -317.0591800923006, -811.0028325268078, -1108.44098077674, -694.3016497834981, -815.1604076548214, -203.6224628302823, -136.17097615589802, -569.1061409939833, -285.0112274623945, -1033.686967992588, -23.563977916155135, -1327.5383668283291, -16.35379053804897, -353.0019024021615, -382.1278337186152, -675.1702890126999, -284.8454691884137, -353.86398988110307, -1225.2303263205952, -253.9788020772536, -579.0410916814349, -1196.5665363901342, -491.7226340450274, -361.34142450897014, -64.55541302985552, -669.8505908550618, -699.0679362250316, -38.26562856503987, -582.5485000213845, -455.5881624845179, -1431.4280856173218, -522.6229467539324, -150.85890225374033, -378.21549019253575, -201.649126232488, -576.693646009904, -598.7376419637922, -312.22181213454144, -43.77882294197415, -799.8165507386401, -354.40452494884045, -545.3628315244594, -54.363940260281865, -893.5724522724962, -723.8014442374081, -660.2837386883089, -865.0659173568861, -651.2402598948373, -645.9344245394627, -126.34199695644648, -237.95254629387398, -925.0043640999371, -1250.4462378768396, -1027.0701902244666, -558.613402201151, -13.351092302187887, -629.9667666027266, -774.4822016063555, -1459.3610864604477, -674.0848924264395, -109.80368711426152, -496.0091318603259, -28.444382293094325, -508.6645470730472, -29.037313201946095, -509.40872708122936, -714.424617768026, -594.5727757075541, -546.717191638274, -549.2529501549155, -283.3679837632682, -154.86432645622014, -1234.0764375606745, -196.5440587931923, -678.1662614123135, -1301.2129878830674, -1059.1181097844283, -824.4448194848449, -821.3897203647728, -323.1828901346053, -1001.3248560747679, -429.72408352461, -776.9750093884087, -1437.0764417281528, -108.18934910328704, -85.27585759439248, -67.93651743148476, -121.68717016988047, -64.97651174023704, -200.07659939495647, -710.5599609826459, -878.1816303347521, -461.016411615788, -7.352671513672196, -296.13567540600525, -1074.8888511569046, -1063.0130480889895, -123.24663498758802, -1189.987572462103, -974.5208494470606, -178.3610090672432, -806.04151255192, -369.5852331384397, -77.04764556802809, -408.8981523633819, -1226.0797509307265, -474.52564762659887, -275.42521900019955, -152.35166545430295, -1116.550545710513, -99.74345338498759, -875.6226777703421, -735.8708271019177, -1015.9139704375393, -22.018530071889167, -391.5750551752606, -602.825841225841, -469.1631221280448, -48.50629456940731, -5.56927951690723, -262.50850330245413, -377.619639674516, -606.70608624025, -412.5173012131982, -384.4546583968674, -147.8056944445755, -609.6586333791281, -1047.7180470041249, -576.3260887254785, -1028.9331030605201, -946.8460762187665, -896.092974980778, -882.3397785395268, -96.89650840997706, -287.1961935404872, -778.8020670981552, -265.2382327151968, -669.2067971739847, -412.4886026051805, -535.2534748828876, -116.47989312196697, -518.1147794662858, -251.9655611089994, -146.38353785531277, -113.98786602709781, -1366.523759106827, -37.79350158016394, -85.1855771984783, -148.77631161713572, -207.96049384366862, -383.24447735285935, -394.9579971159965, -290.5837235821723, -353.82413592074744, -145.79867961264821, -956.5089980843745, -199.22722477097756, -241.80394211854144, -552.979545820476, -1246.500873401842, -181.66070262490558, -447.49537461223576, -129.24974462281946, -930.4118794767492, -423.45621802425126, -1143.9561146781848, -469.13663735273076, -359.20999485051703, -190.07030549980405, -277.5898498599539, -455.19928223371505, -731.7896896923912, -95.71575899471735, -382.56894275865835, -567.2151042829377, -1253.169118340839, -88.07610087994982, -839.2937617620445, -78.01228924099469, -145.60811910111258, -608.7687785185723, -673.3666727815493, -73.34233089988496, -723.6679840456193, -104.80865328868803, -705.3221928438834, -736.055730855329, -882.19255097255, -590.3684209994143, -246.54161177618798, -1068.887606376295, -427.6452447824109, -656.7082774454215, -133.26842243980053, -115.91869868973637, -92.81380441822002, -155.29509568884882, -613.6031183497953, -205.75922960493187, -46.268949556515466, -158.88658776581426, -112.18638496333317, -1136.9168028659387, -209.5653693691233, -1348.2932551036815, -187.12408117069668, -280.0959296568472, -84.74754168714811, -353.2271193849445, -359.23950944601586, -1030.8148208022749, -136.3904539410266, -865.4557992213737, -488.623227134528, -744.4602381043394, -43.41633571270001, -83.34195104148881, -1071.3727862847986, -152.25088577971326, -338.8721074002175, -1366.910831777075, -17.721040507570414, -710.0359617488868, -197.82961525715484, -67.13057214540619, -12.954985508850765, -452.154245577246, -137.72976314261587, -491.7734304583403, -856.0009898382029, -241.67728943105118, -1305.722810969397, -316.28225727254573, -689.4207032956527, -306.7308653937424, -649.801414350292, -103.15458701102035, -182.34182354538729, -96.64701537544097, -30.775437913166652, -28.72182098117284, -43.1205387107315, -520.3072979105235, -120.46586334476099, -232.0780877048856, -19.564321160031227, -374.2677468335047, -332.08333096894603, -1296.2996991044065, -536.6163210360885, -110.97373838586694, -466.9777273959056, -416.78784831106196, -616.1285096911026, -144.970723430436, -629.5371506730492, -1487.8274257310206, -211.4453836974572, -471.49523500111957, -67.67505697745766, -209.48422412553086, -65.14459875398356, -58.984144789500625, -1179.6979079671748, -112.18462980745697, -594.098344504347, -1252.5142290527008, -944.3602262019463, -947.3267338533507, -93.74198476758293, -247.1694131350081, -491.81322925656116, -1319.3304704593615, -332.50625104324376, -707.8007631334224, -591.3731360215089, -258.8320510281668, -178.01068853154567, -469.0111037639636, -1222.343674504209, -79.0093880700647, -1431.1421526607633, -851.4755941502132, -92.3507196874406, -1287.7863134601737, -817.3507088735096, -200.56760820644786, -914.5695961998019, -344.5127991948743, -901.1178228986778, -338.0533524281196, -990.3015679781483, -440.13368074492956, -735.9145123564059, -1328.5945899500387, -760.1404795698078, -1065.1597030284513, -1034.990358077031, -538.9350643052641, -323.57745303569783, -588.6921879919321, -195.38710908914305, -627.5160642207917, -530.0375037184805, -609.4096443454051, -632.7747076098881, -983.158228739127, -73.57657940252138, -401.32736671802354, -344.8524519240146, -727.5758510081143, -103.03190697826787, -391.4790518857538, -13.406481367060593, -41.70721142310883, -432.88113229865905, -55.41833297283937, -425.9833782823557, -843.7170866451631, -413.76099685229366, -734.3211292984852, -413.5465221890266, -1082.3015298971955, -1044.3500914254585, -596.2097878063338, -79.71326991696039, -38.25209615665008, -231.47377606072854, -58.70494095474327, -661.7211919684062, -14.402617065758408, -834.2423566106409, -65.12763689286263, -493.1416203739887, -307.7838244684367, -89.34683092264375, -294.1004492998154, -963.5062138024222, -303.6088287184219, -823.4575700737844, -74.64127029657834, -716.204184603244, -487.04402643139383, -1165.4311440411827, -846.1221994073873, -954.2682407510013, -1069.9444653144808, -522.5773725804825, -1062.3404780131195, -107.26226887700322, -167.9578871377361, -158.79817526601002, -124.38706086692461, -675.6337819876176, -70.1541499034479, -742.8320043950245, -613.2103682841058, -1177.1614545710697, -884.2967432914822, -44.051605370879685, -1009.2372900179652, -423.7990842071778, -1069.5020998076675, -857.1901968820293, -85.58477177269953, -692.1992613306811, -194.46709938898212, -751.3871955521781, -498.2067898607101, -480.64666985333764, -213.31134438687636, -1300.8192274207634, -208.95781733728222, -560.6984848887334, -719.6311972108986, -56.77404264376538, -608.3337936236885, -1030.312013788747, -626.7716060310237, -248.3235229043757, -1105.294425551622, -1090.0683537012726, -193.4749339063674, -87.66810511318582, -712.9732203094987, -608.5447435631112, -1225.859805672384, -635.6851708139419, -272.18573863700584, -306.15445112411817, -408.2494647447566, -846.6563682341747, -81.38233189358225, -1198.843766869845, -331.1792162607928, -246.75509798872108, -671.7872813264751, -83.20472553176394, -349.43872294887194, -368.46236064991365, -23.807793505798852, -695.8501568764584, -1090.7252905266937, -609.0605449056142, -383.95435789649895, -146.2873403595906, -925.9836196902934, -292.46784435999274, -106.34129348626345, -12.964584706154435, -148.55427466400528, -480.0827548372184, -999.120413395751, -378.8267047320878, -612.865473077217, -456.11442424810195, -186.0784240519033, -213.1575800221519, -259.220151997205, -503.53649511262427, -1038.0749838378058, -186.8634391306312]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5481181752871973, "mean_inference_ms": 1.7231594465701479, "mean_action_processing_ms": 0.8085379650674628, "mean_env_wait_ms": 10.367580584402022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013484716415405273, "StateBufferConnector_ms": 0.009541988372802734, "ViewRequirementAgentConnector_ms": 0.3166532516479492}, "num_episodes": 29, "episode_return_max": -381.60663652589926, "episode_return_min": -4522.8100759454455, "episode_return_mean": -2495.7678018367574, "episodes_this_iter": 29}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1314232, "num_agent_steps_trained": 1314232, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 114.36671330030873, "num_env_steps_trained_throughput_per_sec": 114.36671330030873, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1314232, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1314232, "timers": {"training_iteration_time_ms": 46489.114, "restore_workers_time_ms": 0.029, "training_step_time_ms": 46489.04, "sample_time_ms": 3244.612, "learn_time_ms": 43187.499, "learn_throughput": 92.619, "synch_weights_time_ms": 53.96}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1314232, "num_agent_steps_trained": 1314232}, "done": false, "training_iteration": 75, "trial_id": "05c72_00000", "date": "2024-07-26_15-44-26", "timestamp": 1721988866, "time_this_iter_s": 34.9841365814209, "time_total_s": 3684.0504279136658, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e55a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3684.0504279136658, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 13.53061224489796, "ram_util_percent": 30.720408163265304}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 144.24931557625533, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.824873092273871, "policy_loss": 0.0019800840402846615, "vf_loss": 4.835735952854156, "vf_explained_var": 0.9803630038630218, "kl": 0.01619078093861693, "entropy": 2.5137815520167353, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.6796875, "num_grad_updates_lifetime": 311070.5, "diff_num_grad_updates_vs_sampler_policy": 1919.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1330575, "num_agent_steps_trained": 1330575}, "env_runners": {"episode_reward_max": -381.60663652589926, "episode_reward_min": -4522.8100759454455, "episode_reward_mean": -2477.8754035714214, "episode_len_mean": 147.68, "episode_media": {}, "episodes_timesteps_total": 14768, "policy_reward_min": {"policy_0": -1487.8274257310206}, "policy_reward_max": {"policy_0": 3.8983210929663565}, "policy_reward_mean": {"policy_0": -495.57508071428435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3197.0874928153803, -2586.4735917845564, -3479.447689207373, -3513.740999467828, -1789.9795874173421, -2128.775227720231, -4469.117855433674, -3400.066369583599, -2475.4531752457247, -1975.4818726224723, -2902.406657781362, -3272.1575785159143, -2556.1364296271713, -2519.6935613203436, -2768.2042240124474, -1163.3668391913282, -2161.1423736740157, -4495.916289989663, -2310.4727803033443, -2251.5435472503045, -1916.654225678401, -1220.124857128137, -1945.9427619709227, -2670.4404385780017, -3096.2105941547393, -2013.859122136383, -2386.7450252571048, -2345.0496214042723, -2343.196891933406, -3215.635434906857, -1154.0042986820283, -1136.7042702403894, -3161.9954381662883, -1964.4194452614113, -2225.2975512144276, -2947.1276517493725, -1440.105380237543, -3032.9042838396094, -2065.3898273232535, -381.60663652589926, -1266.6833169537065, -2742.950816891214, -3295.251657836673, -1025.2444985555485, -3197.479256121181, -2724.411587214447, -3209.8426716856998, -3379.517007530547, -3249.530944377784, -3488.5551386996235, -4329.942965649628, -2681.582172499066, -3382.89614863369, -1650.3641560309438, -934.892209947421, -2831.3291132673216, -2840.826775202598, -1800.544882660279, -1249.500361957748, -2881.4180674944523, -4522.8100759454455, -2018.9361818743523, -2226.217365437118, -3538.5461774585733, -2898.943429182057, -3244.3712270738665, -2154.395335704367, -4100.769921977041, -2828.5208085645495, -2468.9311935539945, -2529.9476943394156, -1520.7637595128076, -3156.0111533786935, -1040.4107520536345, -2633.0054395050597, -2200.8526501004167, -2190.932362801435, -1934.9368578773456, -3769.4709814088965, -2740.1114863312123, -2596.8815735523685, -2807.3730146812018, -1288.5009052867108, -2664.4413491552395, -1943.0619666626715, -3040.6757337834556, -1541.1267498260236, -2593.9964678203855, -2243.1498125631083, -1499.132011508633, -844.0238527003382, -2877.2461179478432, -1744.0921065500495, -2553.6755234951565, -1108.8252386107138, -1990.4374092335424, -1115.2502572109606, -3406.6308726240086, -3734.5980725443796, -2232.694818742967], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-54.363940260281865, -893.5724522724962, -723.8014442374081, -660.2837386883089, -865.0659173568861, -651.2402598948373, -645.9344245394627, -126.34199695644648, -237.95254629387398, -925.0043640999371, -1250.4462378768396, -1027.0701902244666, -558.613402201151, -13.351092302187887, -629.9667666027266, -774.4822016063555, -1459.3610864604477, -674.0848924264395, -109.80368711426152, -496.0091318603259, -28.444382293094325, -508.6645470730472, -29.037313201946095, -509.40872708122936, -714.424617768026, -594.5727757075541, -546.717191638274, -549.2529501549155, -283.3679837632682, -154.86432645622014, -1234.0764375606745, -196.5440587931923, -678.1662614123135, -1301.2129878830674, -1059.1181097844283, -824.4448194848449, -821.3897203647728, -323.1828901346053, -1001.3248560747679, -429.72408352461, -776.9750093884087, -1437.0764417281528, -108.18934910328704, -85.27585759439248, -67.93651743148476, -121.68717016988047, -64.97651174023704, -200.07659939495647, -710.5599609826459, -878.1816303347521, -461.016411615788, -7.352671513672196, -296.13567540600525, -1074.8888511569046, -1063.0130480889895, -123.24663498758802, -1189.987572462103, -974.5208494470606, -178.3610090672432, -806.04151255192, -369.5852331384397, -77.04764556802809, -408.8981523633819, -1226.0797509307265, -474.52564762659887, -275.42521900019955, -152.35166545430295, -1116.550545710513, -99.74345338498759, -875.6226777703421, -735.8708271019177, -1015.9139704375393, -22.018530071889167, -391.5750551752606, -602.825841225841, -469.1631221280448, -48.50629456940731, -5.56927951690723, -262.50850330245413, -377.619639674516, -606.70608624025, -412.5173012131982, -384.4546583968674, -147.8056944445755, -609.6586333791281, -1047.7180470041249, -576.3260887254785, -1028.9331030605201, -946.8460762187665, -896.092974980778, -882.3397785395268, -96.89650840997706, -287.1961935404872, -778.8020670981552, -265.2382327151968, -669.2067971739847, -412.4886026051805, -535.2534748828876, -116.47989312196697, -518.1147794662858, -251.9655611089994, -146.38353785531277, -113.98786602709781, -1366.523759106827, -37.79350158016394, -85.1855771984783, -148.77631161713572, -207.96049384366862, -383.24447735285935, -394.9579971159965, -290.5837235821723, -353.82413592074744, -145.79867961264821, -956.5089980843745, -199.22722477097756, -241.80394211854144, -552.979545820476, -1246.500873401842, -181.66070262490558, -447.49537461223576, -129.24974462281946, -930.4118794767492, -423.45621802425126, -1143.9561146781848, -469.13663735273076, -359.20999485051703, -190.07030549980405, -277.5898498599539, -455.19928223371505, -731.7896896923912, -95.71575899471735, -382.56894275865835, -567.2151042829377, -1253.169118340839, -88.07610087994982, -839.2937617620445, -78.01228924099469, -145.60811910111258, -608.7687785185723, -673.3666727815493, -73.34233089988496, -723.6679840456193, -104.80865328868803, -705.3221928438834, -736.055730855329, -882.19255097255, -590.3684209994143, -246.54161177618798, -1068.887606376295, -427.6452447824109, -656.7082774454215, -133.26842243980053, -115.91869868973637, -92.81380441822002, -155.29509568884882, -613.6031183497953, -205.75922960493187, -46.268949556515466, -158.88658776581426, -112.18638496333317, -1136.9168028659387, -209.5653693691233, -1348.2932551036815, -187.12408117069668, -280.0959296568472, -84.74754168714811, -353.2271193849445, -359.23950944601586, -1030.8148208022749, -136.3904539410266, -865.4557992213737, -488.623227134528, -744.4602381043394, -43.41633571270001, -83.34195104148881, -1071.3727862847986, -152.25088577971326, -338.8721074002175, -1366.910831777075, -17.721040507570414, -710.0359617488868, -197.82961525715484, -67.13057214540619, -12.954985508850765, -452.154245577246, -137.72976314261587, -491.7734304583403, -856.0009898382029, -241.67728943105118, -1305.722810969397, -316.28225727254573, -689.4207032956527, -306.7308653937424, -649.801414350292, -103.15458701102035, -182.34182354538729, -96.64701537544097, -30.775437913166652, -28.72182098117284, -43.1205387107315, -520.3072979105235, -120.46586334476099, -232.0780877048856, -19.564321160031227, -374.2677468335047, -332.08333096894603, -1296.2996991044065, -536.6163210360885, -110.97373838586694, -466.9777273959056, -416.78784831106196, -616.1285096911026, -144.970723430436, -629.5371506730492, -1487.8274257310206, -211.4453836974572, -471.49523500111957, -67.67505697745766, -209.48422412553086, -65.14459875398356, -58.984144789500625, -1179.6979079671748, -112.18462980745697, -594.098344504347, -1252.5142290527008, -944.3602262019463, -947.3267338533507, -93.74198476758293, -247.1694131350081, -491.81322925656116, -1319.3304704593615, -332.50625104324376, -707.8007631334224, -591.3731360215089, -258.8320510281668, -178.01068853154567, -469.0111037639636, -1222.343674504209, -79.0093880700647, -1431.1421526607633, -851.4755941502132, -92.3507196874406, -1287.7863134601737, -817.3507088735096, -200.56760820644786, -914.5695961998019, -344.5127991948743, -901.1178228986778, -338.0533524281196, -990.3015679781483, -440.13368074492956, -735.9145123564059, -1328.5945899500387, -760.1404795698078, -1065.1597030284513, -1034.990358077031, -538.9350643052641, -323.57745303569783, -588.6921879919321, -195.38710908914305, -627.5160642207917, -530.0375037184805, -609.4096443454051, -632.7747076098881, -983.158228739127, -73.57657940252138, -401.32736671802354, -344.8524519240146, -727.5758510081143, -103.03190697826787, -391.4790518857538, -13.406481367060593, -41.70721142310883, -432.88113229865905, -55.41833297283937, -425.9833782823557, -843.7170866451631, -413.76099685229366, -734.3211292984852, -413.5465221890266, -1082.3015298971955, -1044.3500914254585, -596.2097878063338, -79.71326991696039, -38.25209615665008, -231.47377606072854, -58.70494095474327, -661.7211919684062, -14.402617065758408, -834.2423566106409, -65.12763689286263, -493.1416203739887, -307.7838244684367, -89.34683092264375, -294.1004492998154, -963.5062138024222, -303.6088287184219, -823.4575700737844, -74.64127029657834, -716.204184603244, -487.04402643139383, -1165.4311440411827, -846.1221994073873, -954.2682407510013, -1069.9444653144808, -522.5773725804825, -1062.3404780131195, -107.26226887700322, -167.9578871377361, -158.79817526601002, -124.38706086692461, -675.6337819876176, -70.1541499034479, -742.8320043950245, -613.2103682841058, -1177.1614545710697, -884.2967432914822, -44.051605370879685, -1009.2372900179652, -423.7990842071778, -1069.5020998076675, -857.1901968820293, -85.58477177269953, -692.1992613306811, -194.46709938898212, -751.3871955521781, -498.2067898607101, -480.64666985333764, -213.31134438687636, -1300.8192274207634, -208.95781733728222, -560.6984848887334, -719.6311972108986, -56.77404264376538, -608.3337936236885, -1030.312013788747, -626.7716060310237, -248.3235229043757, -1105.294425551622, -1090.0683537012726, -193.4749339063674, -87.66810511318582, -712.9732203094987, -608.5447435631112, -1225.859805672384, -635.6851708139419, -272.18573863700584, -306.15445112411817, -408.2494647447566, -846.6563682341747, -81.38233189358225, -1198.843766869845, -331.1792162607928, -246.75509798872108, -671.7872813264751, -83.20472553176394, -349.43872294887194, -368.46236064991365, -23.807793505798852, -695.8501568764584, -1090.7252905266937, -609.0605449056142, -383.95435789649895, -146.2873403595906, -925.9836196902934, -292.46784435999274, -106.34129348626345, -12.964584706154435, -148.55427466400528, -480.0827548372184, -999.120413395751, -378.8267047320878, -612.865473077217, -456.11442424810195, -186.0784240519033, -213.1575800221519, -259.220151997205, -503.53649511262427, -1038.0749838378058, -186.8634391306312, -1099.1515777631578, -17.266821570382252, -46.38022292635652, -752.4969029331107, -275.6368376084248, -845.9063739644378, -813.6675740432698, -217.6208251864604, -52.42860734947574, -5.313477333702121, -1283.3640782739665, -507.8637460243952, -332.1910191527391, -1317.3877554325484, -328.6643825252476, -1130.7779754513663, -564.5601318388119, -86.29296793023747, -321.93921291468644, -636.541198196115, -673.5688410352418, -58.7687705520632, -156.0821236491565, -902.2401452817124, -806.2216930341955, -438.71147952030407, -920.0960366479073, -1102.2631316507338, -261.1614817040236, -85.14088515823393, -37.771958849994604, -35.86184144655056, -295.6138479370784, -833.1885818800841, -86.0646751730026, -993.910958412599, -626.6352447850386, -382.30727668839245, 3.8983210929663565, -665.4861903621771, -5.4576041030793805, -360.0957237655713, -633.4843715038743, -465.7022696379085, -478.32199765223965, -1064.4306824904888, -432.2629113415589, -277.95306206190753, -960.8648352705352, -305.16424261896543, -119.4553591505368, -532.0324331568097, -423.7232439737146, -6.979203165022296, -458.9365103799399, -249.6283727112572, -118.57085610584072, -297.25587802083186, -900.9894632792021, -1027.5518977032546, -70.61400314970588, -335.79914241847183, -753.4979632220449, -442.46009424507014, -640.7786095278153, -10.549180863019222, -320.9054757873862, -93.93957141479237, -945.6668202616759, -128.07096318175985, -510.5705739255232, -32.90074584573477, -2.4366769449227377, -82.79567767189904, -215.32017831225835, -246.11685452339415, -468.072344419733, -571.5312393603941, -578.592636867643, -1012.9330427766774, -91.43397859389074, -119.07600448019862, -1187.6810350933513, -67.14651385230718, -278.7545745303021, -15.665190070394074, -485.2652924316935, -765.866352608844, -755.9732929710437, -530.9053954131833, -247.22815386921576, -71.54704222575404, -257.9331525656904, -107.0393087474525, -425.0775812026017, -815.6647549632912, -170.90476210195692, -48.51984608506368, -910.7681913688484, -44.57985471438175, -49.30079920582938, -246.09938525672183, -60.98219658255359, -708.1422530464536, -50.725623119401824, -733.196157147231, -332.2280488092792, -1246.9762092614912, -594.4778341749332, -499.7526232310688, -499.55311769120226, -791.4021607776464, -727.7074794520163, -798.6136210865535, -917.3216935369585, -1109.8079137130012, -454.1782692993961, -326.473832096181, -174.34070895579308, -167.89409467859417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5490236386338532, "mean_inference_ms": 1.7231732608538435, "mean_action_processing_ms": 0.8078164274014991, "mean_env_wait_ms": 10.368686783492501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013501882553100586, "StateBufferConnector_ms": 0.009341716766357422, "ViewRequirementAgentConnector_ms": 0.3096339702606201}, "num_episodes": 24, "episode_return_max": -381.60663652589926, "episode_return_min": -4522.8100759454455, "episode_return_mean": -2477.8754035714214, "episodes_this_iter": 24}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1330575, "num_agent_steps_trained": 1330575, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 90.0797515808868, "num_env_steps_trained_throughput_per_sec": 90.0797515808868, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1330575, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1330575, "timers": {"training_iteration_time_ms": 45260.529, "restore_workers_time_ms": 0.028, "training_step_time_ms": 45260.455, "sample_time_ms": 3237.513, "learn_time_ms": 41967.374, "learn_throughput": 95.312, "synch_weights_time_ms": 52.636}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1330575, "num_agent_steps_trained": 1330575}, "done": false, "training_iteration": 76, "trial_id": "05c72_00000", "date": "2024-07-26_15-45-10", "timestamp": 1721988910, "time_this_iter_s": 44.41596221923828, "time_total_s": 3728.466390132904, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd0149750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3728.466390132904, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 11.5984375, "ram_util_percent": 30.639062499999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 144.0968758140889, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.538660910195277, "policy_loss": -0.0014073722747815097, "vf_loss": 4.552948835081325, "vf_explained_var": 0.9835110936995437, "kl": 0.017030600778686168, "entropy": 2.581316198621477, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.52631578947368, "num_grad_updates_lifetime": 314985.5, "diff_num_grad_updates_vs_sampler_policy": 1994.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1347536, "num_agent_steps_trained": 1347536}, "env_runners": {"episode_reward_max": -381.60663652589926, "episode_reward_min": -4738.446815433957, "episode_reward_mean": -2497.867215083366, "episode_len_mean": 148.01, "episode_media": {}, "episodes_timesteps_total": 14801, "policy_reward_min": {"policy_0": -1487.8274257310206}, "policy_reward_max": {"policy_0": 3.8983210929663565}, "policy_reward_mean": {"policy_0": -499.5734430166731}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2343.196891933406, -3215.635434906857, -1154.0042986820283, -1136.7042702403894, -3161.9954381662883, -1964.4194452614113, -2225.2975512144276, -2947.1276517493725, -1440.105380237543, -3032.9042838396094, -2065.3898273232535, -381.60663652589926, -1266.6833169537065, -2742.950816891214, -3295.251657836673, -1025.2444985555485, -3197.479256121181, -2724.411587214447, -3209.8426716856998, -3379.517007530547, -3249.530944377784, -3488.5551386996235, -4329.942965649628, -2681.582172499066, -3382.89614863369, -1650.3641560309438, -934.892209947421, -2831.3291132673216, -2840.826775202598, -1800.544882660279, -1249.500361957748, -2881.4180674944523, -4522.8100759454455, -2018.9361818743523, -2226.217365437118, -3538.5461774585733, -2898.943429182057, -3244.3712270738665, -2154.395335704367, -4100.769921977041, -2828.5208085645495, -2468.9311935539945, -2529.9476943394156, -1520.7637595128076, -3156.0111533786935, -1040.4107520536345, -2633.0054395050597, -2200.8526501004167, -2190.932362801435, -1934.9368578773456, -3769.4709814088965, -2740.1114863312123, -2596.8815735523685, -2807.3730146812018, -1288.5009052867108, -2664.4413491552395, -1943.0619666626715, -3040.6757337834556, -1541.1267498260236, -2593.9964678203855, -2243.1498125631083, -1499.132011508633, -844.0238527003382, -2877.2461179478432, -1744.0921065500495, -2553.6755234951565, -1108.8252386107138, -1990.4374092335424, -1115.2502572109606, -3406.6308726240086, -3734.5980725443796, -2232.694818742967, -1708.7652297617562, -2014.539016302776, -2368.883909298423, -4361.60905448674, -3239.099473027426, -3162.7351430336043, -2756.5859677300414, -2693.498640314194, -3301.197584560768, -2601.6253052140364, -2041.0040336709812, -1404.6713819763786, -4738.446815433957, -3946.3019984736375, -2427.5662139433566, -3380.372776374824, -1434.838965222436, -4084.4693086411585, -2308.682597603054, -1394.9344803449617, -2642.59414453228, -3462.4961509804934, -1331.483049995287, -3725.8810859821724, -2193.6279481961137, -2344.2785190471627, -1731.8718888827034, -2208.81125743576], "episode_lengths": [150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-73.34233089988496, -723.6679840456193, -104.80865328868803, -705.3221928438834, -736.055730855329, -882.19255097255, -590.3684209994143, -246.54161177618798, -1068.887606376295, -427.6452447824109, -656.7082774454215, -133.26842243980053, -115.91869868973637, -92.81380441822002, -155.29509568884882, -613.6031183497953, -205.75922960493187, -46.268949556515466, -158.88658776581426, -112.18638496333317, -1136.9168028659387, -209.5653693691233, -1348.2932551036815, -187.12408117069668, -280.0959296568472, -84.74754168714811, -353.2271193849445, -359.23950944601586, -1030.8148208022749, -136.3904539410266, -865.4557992213737, -488.623227134528, -744.4602381043394, -43.41633571270001, -83.34195104148881, -1071.3727862847986, -152.25088577971326, -338.8721074002175, -1366.910831777075, -17.721040507570414, -710.0359617488868, -197.82961525715484, -67.13057214540619, -12.954985508850765, -452.154245577246, -137.72976314261587, -491.7734304583403, -856.0009898382029, -241.67728943105118, -1305.722810969397, -316.28225727254573, -689.4207032956527, -306.7308653937424, -649.801414350292, -103.15458701102035, -182.34182354538729, -96.64701537544097, -30.775437913166652, -28.72182098117284, -43.1205387107315, -520.3072979105235, -120.46586334476099, -232.0780877048856, -19.564321160031227, -374.2677468335047, -332.08333096894603, -1296.2996991044065, -536.6163210360885, -110.97373838586694, -466.9777273959056, -416.78784831106196, -616.1285096911026, -144.970723430436, -629.5371506730492, -1487.8274257310206, -211.4453836974572, -471.49523500111957, -67.67505697745766, -209.48422412553086, -65.14459875398356, -58.984144789500625, -1179.6979079671748, -112.18462980745697, -594.098344504347, -1252.5142290527008, -944.3602262019463, -947.3267338533507, -93.74198476758293, -247.1694131350081, -491.81322925656116, -1319.3304704593615, -332.50625104324376, -707.8007631334224, -591.3731360215089, -258.8320510281668, -178.01068853154567, -469.0111037639636, -1222.343674504209, -79.0093880700647, -1431.1421526607633, -851.4755941502132, -92.3507196874406, -1287.7863134601737, -817.3507088735096, -200.56760820644786, -914.5695961998019, -344.5127991948743, -901.1178228986778, -338.0533524281196, -990.3015679781483, -440.13368074492956, -735.9145123564059, -1328.5945899500387, -760.1404795698078, -1065.1597030284513, -1034.990358077031, -538.9350643052641, -323.57745303569783, -588.6921879919321, -195.38710908914305, -627.5160642207917, -530.0375037184805, -609.4096443454051, -632.7747076098881, -983.158228739127, -73.57657940252138, -401.32736671802354, -344.8524519240146, -727.5758510081143, -103.03190697826787, -391.4790518857538, -13.406481367060593, -41.70721142310883, -432.88113229865905, -55.41833297283937, -425.9833782823557, -843.7170866451631, -413.76099685229366, -734.3211292984852, -413.5465221890266, -1082.3015298971955, -1044.3500914254585, -596.2097878063338, -79.71326991696039, -38.25209615665008, -231.47377606072854, -58.70494095474327, -661.7211919684062, -14.402617065758408, -834.2423566106409, -65.12763689286263, -493.1416203739887, -307.7838244684367, -89.34683092264375, -294.1004492998154, -963.5062138024222, -303.6088287184219, -823.4575700737844, -74.64127029657834, -716.204184603244, -487.04402643139383, -1165.4311440411827, -846.1221994073873, -954.2682407510013, -1069.9444653144808, -522.5773725804825, -1062.3404780131195, -107.26226887700322, -167.9578871377361, -158.79817526601002, -124.38706086692461, -675.6337819876176, -70.1541499034479, -742.8320043950245, -613.2103682841058, -1177.1614545710697, -884.2967432914822, -44.051605370879685, -1009.2372900179652, -423.7990842071778, -1069.5020998076675, -857.1901968820293, -85.58477177269953, -692.1992613306811, -194.46709938898212, -751.3871955521781, -498.2067898607101, -480.64666985333764, -213.31134438687636, -1300.8192274207634, -208.95781733728222, -560.6984848887334, -719.6311972108986, -56.77404264376538, -608.3337936236885, -1030.312013788747, -626.7716060310237, -248.3235229043757, -1105.294425551622, -1090.0683537012726, -193.4749339063674, -87.66810511318582, -712.9732203094987, -608.5447435631112, -1225.859805672384, -635.6851708139419, -272.18573863700584, -306.15445112411817, -408.2494647447566, -846.6563682341747, -81.38233189358225, -1198.843766869845, -331.1792162607928, -246.75509798872108, -671.7872813264751, -83.20472553176394, -349.43872294887194, -368.46236064991365, -23.807793505798852, -695.8501568764584, -1090.7252905266937, -609.0605449056142, -383.95435789649895, -146.2873403595906, -925.9836196902934, -292.46784435999274, -106.34129348626345, -12.964584706154435, -148.55427466400528, -480.0827548372184, -999.120413395751, -378.8267047320878, -612.865473077217, -456.11442424810195, -186.0784240519033, -213.1575800221519, -259.220151997205, -503.53649511262427, -1038.0749838378058, -186.8634391306312, -1099.1515777631578, -17.266821570382252, -46.38022292635652, -752.4969029331107, -275.6368376084248, -845.9063739644378, -813.6675740432698, -217.6208251864604, -52.42860734947574, -5.313477333702121, -1283.3640782739665, -507.8637460243952, -332.1910191527391, -1317.3877554325484, -328.6643825252476, -1130.7779754513663, -564.5601318388119, -86.29296793023747, -321.93921291468644, -636.541198196115, -673.5688410352418, -58.7687705520632, -156.0821236491565, -902.2401452817124, -806.2216930341955, -438.71147952030407, -920.0960366479073, -1102.2631316507338, -261.1614817040236, -85.14088515823393, -37.771958849994604, -35.86184144655056, -295.6138479370784, -833.1885818800841, -86.0646751730026, -993.910958412599, -626.6352447850386, -382.30727668839245, 3.8983210929663565, -665.4861903621771, -5.4576041030793805, -360.0957237655713, -633.4843715038743, -465.7022696379085, -478.32199765223965, -1064.4306824904888, -432.2629113415589, -277.95306206190753, -960.8648352705352, -305.16424261896543, -119.4553591505368, -532.0324331568097, -423.7232439737146, -6.979203165022296, -458.9365103799399, -249.6283727112572, -118.57085610584072, -297.25587802083186, -900.9894632792021, -1027.5518977032546, -70.61400314970588, -335.79914241847183, -753.4979632220449, -442.46009424507014, -640.7786095278153, -10.549180863019222, -320.9054757873862, -93.93957141479237, -945.6668202616759, -128.07096318175985, -510.5705739255232, -32.90074584573477, -2.4366769449227377, -82.79567767189904, -215.32017831225835, -246.11685452339415, -468.072344419733, -571.5312393603941, -578.592636867643, -1012.9330427766774, -91.43397859389074, -119.07600448019862, -1187.6810350933513, -67.14651385230718, -278.7545745303021, -15.665190070394074, -485.2652924316935, -765.866352608844, -755.9732929710437, -530.9053954131833, -247.22815386921576, -71.54704222575404, -257.9331525656904, -107.0393087474525, -425.0775812026017, -815.6647549632912, -170.90476210195692, -48.51984608506368, -910.7681913688484, -44.57985471438175, -49.30079920582938, -246.09938525672183, -60.98219658255359, -708.1422530464536, -50.725623119401824, -733.196157147231, -332.2280488092792, -1246.9762092614912, -594.4778341749332, -499.7526232310688, -499.55311769120226, -791.4021607776464, -727.7074794520163, -798.6136210865535, -917.3216935369585, -1109.8079137130012, -454.1782692993961, -326.473832096181, -174.34070895579308, -167.89409467859417, -34.3053889094261, -871.0621977977995, -534.3330999987693, -129.89605195860688, -139.16849109715295, -15.168593685436706, -1242.2575934804884, -150.37169800167877, -40.14156180520637, -566.5995693299664, -302.89206950880777, -941.8565785919283, -976.3865046088722, -61.6091800833694, -86.13957650544619, -1334.8082528657053, -569.9882064050141, -944.8358689532743, -426.003679102354, -1085.973047160392, -1407.6455252124147, -144.49362450700966, -580.2506985849952, -755.6774514507023, -351.03217327230425, -1152.1373770228656, -345.0724361865359, -993.8071865909175, -32.64212281138117, -639.0760204219039, -957.1744760211944, -452.95014730048615, -92.82150801757386, -609.9129843896613, -643.7268520011282, -180.24079917302714, -706.7680429597814, -618.7918851223397, -117.79848419479549, -1069.8994288642496, -732.5359825189748, -1296.9077050613523, -220.11980177811643, -1000.0854950328945, -51.54860016943071, -64.2060311531663, -452.3314742816477, -1104.9183966180942, -277.7270130984768, -702.4423900626509, -643.4621481735801, -90.72475253201546, -493.97341833285697, -113.09079892400881, -699.7529157085183, -109.4656576145871, -287.93070966304106, -71.11597453755716, -208.83707145692813, -727.3219687042655, -1293.4962055360193, -1130.3083259032494, -1111.2698054211448, -958.730010599556, -244.64246797398275, -870.1946180198644, -974.6628165288545, -831.8182493624408, -544.5206480693148, -725.1056664931614, -426.8019906736956, -433.31637633435645, -110.88095784715973, -719.3659177113173, -737.2009713768297, -28.922656901466183, -975.2557978557195, -676.6845222440244, -658.8032333497167, -1040.7065660238948, -603.7678546237779, -41.70382719660712, -526.7493793207609, -24.4558423066295, -238.16206177465978, -1370.432806254822, -741.8743351295494, -932.9482257440496, -25.511343962251125, -1013.7025975504846, -598.8499234016836, -1128.7423417661173, -96.21058505592305, -68.9127647837292, -415.966982595601, -122.08795936547583, -648.2784119706541, -280.2549970259569, -20.35063543655394, -323.96247654632134, -113.60410794962425, -1366.6633078868979, -750.4822380083074, -314.4768853391483, -97.36760534830053, -54.95978609638461, -690.1859636306673, -928.293166251502, -1066.6015400905853, -722.4556949113517, -157.87112554977503, -152.47141039088513, -67.42717515312494, -723.2486707061906, -230.46466819531062, -373.47060307305895, -1139.7633523352658, -1071.3308608134275, -150.3876253031402, -990.9286444572805, -558.9033318839128, -132.60401222183913, -140.48365651845575, -526.1884316196289, -835.4485159522756, -658.9927669126532, -88.61045105620354, -223.06372171923837, -335.6339141147433, -1037.9776652443238, -262.1752966113819, -111.12788342183698, -134.56591964842087, -220.58193604149102, -1003.4208531595713, -593.1981686084405, -395.47228771303463, -163.75950952148807, -132.1894642182303, -924.1918273745661]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5454101111891887, "mean_inference_ms": 1.7222621092502224, "mean_action_processing_ms": 0.8065709273119236, "mean_env_wait_ms": 10.351817456133777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013133049011230469, "StateBufferConnector_ms": 0.00936746597290039, "ViewRequirementAgentConnector_ms": 0.31618380546569824}, "num_episodes": 28, "episode_return_max": -381.60663652589926, "episode_return_min": -4738.446815433957, "episode_return_mean": -2497.867215083366, "episodes_this_iter": 28}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1347536, "num_agent_steps_trained": 1347536, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 97.47880365898077, "num_env_steps_trained_throughput_per_sec": 97.47880365898077, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1347536, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1347536, "timers": {"training_iteration_time_ms": 44787.036, "restore_workers_time_ms": 0.028, "training_step_time_ms": 44786.963, "sample_time_ms": 3236.893, "learn_time_ms": 41495.143, "learn_throughput": 96.397, "synch_weights_time_ms": 52.072}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1347536, "num_agent_steps_trained": 1347536}, "done": false, "training_iteration": 77, "trial_id": "05c72_00000", "date": "2024-07-26_15-45-51", "timestamp": 1721988951, "time_this_iter_s": 41.04600667953491, "time_total_s": 3769.512396812439, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00dc430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3769.512396812439, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 11.884482758620688, "ram_util_percent": 30.601724137931033}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.08358409923056, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000007, "total_loss": 4.859933374469407, "policy_loss": -0.0017906054644268973, "vf_loss": 4.875275812488823, "vf_explained_var": 0.980612917251633, "kl": 0.01583719535903434, "entropy": 2.5578202376619052, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.1231884057971, "num_grad_updates_lifetime": 319050.5, "diff_num_grad_updates_vs_sampler_policy": 2069.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1365079, "num_agent_steps_trained": 1365079}, "env_runners": {"episode_reward_max": -763.8054622390199, "episode_reward_min": -4738.446815433957, "episode_reward_mean": -2424.634411928789, "episode_len_mean": 147.92, "episode_media": {}, "episodes_timesteps_total": 14792, "policy_reward_min": {"policy_0": -1407.6455252124147}, "policy_reward_max": {"policy_0": 3.8983210929663565}, "policy_reward_mean": {"policy_0": -484.9268823857577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1800.544882660279, -1249.500361957748, -2881.4180674944523, -4522.8100759454455, -2018.9361818743523, -2226.217365437118, -3538.5461774585733, -2898.943429182057, -3244.3712270738665, -2154.395335704367, -4100.769921977041, -2828.5208085645495, -2468.9311935539945, -2529.9476943394156, -1520.7637595128076, -3156.0111533786935, -1040.4107520536345, -2633.0054395050597, -2200.8526501004167, -2190.932362801435, -1934.9368578773456, -3769.4709814088965, -2740.1114863312123, -2596.8815735523685, -2807.3730146812018, -1288.5009052867108, -2664.4413491552395, -1943.0619666626715, -3040.6757337834556, -1541.1267498260236, -2593.9964678203855, -2243.1498125631083, -1499.132011508633, -844.0238527003382, -2877.2461179478432, -1744.0921065500495, -2553.6755234951565, -1108.8252386107138, -1990.4374092335424, -1115.2502572109606, -3406.6308726240086, -3734.5980725443796, -2232.694818742967, -1708.7652297617562, -2014.539016302776, -2368.883909298423, -4361.60905448674, -3239.099473027426, -3162.7351430336043, -2756.5859677300414, -2693.498640314194, -3301.197584560768, -2601.6253052140364, -2041.0040336709812, -1404.6713819763786, -4738.446815433957, -3946.3019984736375, -2427.5662139433566, -3380.372776374824, -1434.838965222436, -4084.4693086411585, -2308.682597603054, -1394.9344803449617, -2642.59414453228, -3462.4961509804934, -1331.483049995287, -3725.8810859821724, -2193.6279481961137, -2344.2785190471627, -1731.8718888827034, -2208.81125743576, -1625.4710658818879, -1410.1492159077743, -3625.240703463341, -1632.8322102538314, -2305.090768093186, -1835.751855556582, -1924.506284145161, -2668.7653028019863, -3449.8874905973926, -3192.5799069523805, -2436.601580153362, -1928.4283152797752, -3856.61610507978, -763.8054622390199, -3036.067085719277, -1634.8822711813227, -2380.812771706749, -2458.7886015174163, -2601.099247153835, -1764.148543529796, -1130.8719527827097, -1257.1301771004655, -1843.3507493717148, -1663.768698732879, -1511.424405207197, -1255.849338879825, -2220.994404740286, -2925.9072602049037, -3635.5854574860305], "episode_lengths": [150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-231.47377606072854, -58.70494095474327, -661.7211919684062, -14.402617065758408, -834.2423566106409, -65.12763689286263, -493.1416203739887, -307.7838244684367, -89.34683092264375, -294.1004492998154, -963.5062138024222, -303.6088287184219, -823.4575700737844, -74.64127029657834, -716.204184603244, -487.04402643139383, -1165.4311440411827, -846.1221994073873, -954.2682407510013, -1069.9444653144808, -522.5773725804825, -1062.3404780131195, -107.26226887700322, -167.9578871377361, -158.79817526601002, -124.38706086692461, -675.6337819876176, -70.1541499034479, -742.8320043950245, -613.2103682841058, -1177.1614545710697, -884.2967432914822, -44.051605370879685, -1009.2372900179652, -423.7990842071778, -1069.5020998076675, -857.1901968820293, -85.58477177269953, -692.1992613306811, -194.46709938898212, -751.3871955521781, -498.2067898607101, -480.64666985333764, -213.31134438687636, -1300.8192274207634, -208.95781733728222, -560.6984848887334, -719.6311972108986, -56.77404264376538, -608.3337936236885, -1030.312013788747, -626.7716060310237, -248.3235229043757, -1105.294425551622, -1090.0683537012726, -193.4749339063674, -87.66810511318582, -712.9732203094987, -608.5447435631112, -1225.859805672384, -635.6851708139419, -272.18573863700584, -306.15445112411817, -408.2494647447566, -846.6563682341747, -81.38233189358225, -1198.843766869845, -331.1792162607928, -246.75509798872108, -671.7872813264751, -83.20472553176394, -349.43872294887194, -368.46236064991365, -23.807793505798852, -695.8501568764584, -1090.7252905266937, -609.0605449056142, -383.95435789649895, -146.2873403595906, -925.9836196902934, -292.46784435999274, -106.34129348626345, -12.964584706154435, -148.55427466400528, -480.0827548372184, -999.120413395751, -378.8267047320878, -612.865473077217, -456.11442424810195, -186.0784240519033, -213.1575800221519, -259.220151997205, -503.53649511262427, -1038.0749838378058, -186.8634391306312, -1099.1515777631578, -17.266821570382252, -46.38022292635652, -752.4969029331107, -275.6368376084248, -845.9063739644378, -813.6675740432698, -217.6208251864604, -52.42860734947574, -5.313477333702121, -1283.3640782739665, -507.8637460243952, -332.1910191527391, -1317.3877554325484, -328.6643825252476, -1130.7779754513663, -564.5601318388119, -86.29296793023747, -321.93921291468644, -636.541198196115, -673.5688410352418, -58.7687705520632, -156.0821236491565, -902.2401452817124, -806.2216930341955, -438.71147952030407, -920.0960366479073, -1102.2631316507338, -261.1614817040236, -85.14088515823393, -37.771958849994604, -35.86184144655056, -295.6138479370784, -833.1885818800841, -86.0646751730026, -993.910958412599, -626.6352447850386, -382.30727668839245, 3.8983210929663565, -665.4861903621771, -5.4576041030793805, -360.0957237655713, -633.4843715038743, -465.7022696379085, -478.32199765223965, -1064.4306824904888, -432.2629113415589, -277.95306206190753, -960.8648352705352, -305.16424261896543, -119.4553591505368, -532.0324331568097, -423.7232439737146, -6.979203165022296, -458.9365103799399, -249.6283727112572, -118.57085610584072, -297.25587802083186, -900.9894632792021, -1027.5518977032546, -70.61400314970588, -335.79914241847183, -753.4979632220449, -442.46009424507014, -640.7786095278153, -10.549180863019222, -320.9054757873862, -93.93957141479237, -945.6668202616759, -128.07096318175985, -510.5705739255232, -32.90074584573477, -2.4366769449227377, -82.79567767189904, -215.32017831225835, -246.11685452339415, -468.072344419733, -571.5312393603941, -578.592636867643, -1012.9330427766774, -91.43397859389074, -119.07600448019862, -1187.6810350933513, -67.14651385230718, -278.7545745303021, -15.665190070394074, -485.2652924316935, -765.866352608844, -755.9732929710437, -530.9053954131833, -247.22815386921576, -71.54704222575404, -257.9331525656904, -107.0393087474525, -425.0775812026017, -815.6647549632912, -170.90476210195692, -48.51984608506368, -910.7681913688484, -44.57985471438175, -49.30079920582938, -246.09938525672183, -60.98219658255359, -708.1422530464536, -50.725623119401824, -733.196157147231, -332.2280488092792, -1246.9762092614912, -594.4778341749332, -499.7526232310688, -499.55311769120226, -791.4021607776464, -727.7074794520163, -798.6136210865535, -917.3216935369585, -1109.8079137130012, -454.1782692993961, -326.473832096181, -174.34070895579308, -167.89409467859417, -34.3053889094261, -871.0621977977995, -534.3330999987693, -129.89605195860688, -139.16849109715295, -15.168593685436706, -1242.2575934804884, -150.37169800167877, -40.14156180520637, -566.5995693299664, -302.89206950880777, -941.8565785919283, -976.3865046088722, -61.6091800833694, -86.13957650544619, -1334.8082528657053, -569.9882064050141, -944.8358689532743, -426.003679102354, -1085.973047160392, -1407.6455252124147, -144.49362450700966, -580.2506985849952, -755.6774514507023, -351.03217327230425, -1152.1373770228656, -345.0724361865359, -993.8071865909175, -32.64212281138117, -639.0760204219039, -957.1744760211944, -452.95014730048615, -92.82150801757386, -609.9129843896613, -643.7268520011282, -180.24079917302714, -706.7680429597814, -618.7918851223397, -117.79848419479549, -1069.8994288642496, -732.5359825189748, -1296.9077050613523, -220.11980177811643, -1000.0854950328945, -51.54860016943071, -64.2060311531663, -452.3314742816477, -1104.9183966180942, -277.7270130984768, -702.4423900626509, -643.4621481735801, -90.72475253201546, -493.97341833285697, -113.09079892400881, -699.7529157085183, -109.4656576145871, -287.93070966304106, -71.11597453755716, -208.83707145692813, -727.3219687042655, -1293.4962055360193, -1130.3083259032494, -1111.2698054211448, -958.730010599556, -244.64246797398275, -870.1946180198644, -974.6628165288545, -831.8182493624408, -544.5206480693148, -725.1056664931614, -426.8019906736956, -433.31637633435645, -110.88095784715973, -719.3659177113173, -737.2009713768297, -28.922656901466183, -975.2557978557195, -676.6845222440244, -658.8032333497167, -1040.7065660238948, -603.7678546237779, -41.70382719660712, -526.7493793207609, -24.4558423066295, -238.16206177465978, -1370.432806254822, -741.8743351295494, -932.9482257440496, -25.511343962251125, -1013.7025975504846, -598.8499234016836, -1128.7423417661173, -96.21058505592305, -68.9127647837292, -415.966982595601, -122.08795936547583, -648.2784119706541, -280.2549970259569, -20.35063543655394, -323.96247654632134, -113.60410794962425, -1366.6633078868979, -750.4822380083074, -314.4768853391483, -97.36760534830053, -54.95978609638461, -690.1859636306673, -928.293166251502, -1066.6015400905853, -722.4556949113517, -157.87112554977503, -152.47141039088513, -67.42717515312494, -723.2486707061906, -230.46466819531062, -373.47060307305895, -1139.7633523352658, -1071.3308608134275, -150.3876253031402, -990.9286444572805, -558.9033318839128, -132.60401222183913, -140.48365651845575, -526.1884316196289, -835.4485159522756, -658.9927669126532, -88.61045105620354, -223.06372171923837, -335.6339141147433, -1037.9776652443238, -262.1752966113819, -111.12788342183698, -134.56591964842087, -220.58193604149102, -1003.4208531595713, -593.1981686084405, -395.47228771303463, -163.75950952148807, -132.1894642182303, -924.1918273745661, -168.8186713977678, -589.1611495025212, -175.42361801525726, -647.2621495289158, -44.805477437424706, -734.7029008463369, -187.20340997236474, -24.122367997399955, -425.05623065409054, -39.0643064375814, -844.9374412241159, -607.1763594584806, -404.66377941831087, -1142.7326736284983, -625.7304497339355, -411.9438770230941, -655.4014600627646, -10.137686538680608, -129.46634763510576, -425.88283899418605, -512.8146391017809, -759.3322766318004, -183.7978804086372, -342.46310099731767, -506.6828709536484, -958.7356041654746, -482.738659375292, -38.09669389410644, -99.16958645362432, -257.01131166808545, -336.8991679511758, -758.6333727041185, -207.24580603046672, -173.6773179951833, -448.05061946421625, -1078.7901115124894, -64.32514749654952, -745.5082522223299, -406.535324382374, -373.60646718824233, -704.454175644365, -1252.5157375773597, -275.9294266022452, -67.10066724101924, -1149.8874835323998, -282.924186977236, -896.5674526787583, -509.5919030023752, -1304.0073892598023, -199.48897503420852, -221.11959613020838, -113.31135344852177, -1105.8574692218601, -564.1470271670875, -432.16613418568613, -66.25268347966261, -496.9680952742849, -81.40587717067314, -674.0426324934288, -609.7590268617249, -851.57041994898, -498.998357145587, -292.32763415206017, -906.9104368934898, -1306.809256939663, -74.39059344767836, -81.02173849191047, -94.98837463884311, -138.07826396768576, -375.32649169290215, -892.4250245746022, -163.5240099865681, -66.61356328169366, -856.5252075358561, -1056.9792803405578, -18.06495936427423, -132.84516363214237, -798.1900022157188, -154.87390613201475, -530.9082398371747, -162.518381274089, -378.21128198595596, -199.09192707664042, -789.9917781010273, -850.9994032690373, -118.10906850347011, -178.47526527674964, -1368.246057125207, -595.4041350604012, -198.5540755515898, -1020.8130899845548, -611.1332616305663, -253.73665927184544, -26.351372624697067, -689.0648636421733, -633.1066329694248, -58.20946585489134, -297.4724213044788, -736.8565219542489, -38.503501446750064, -352.6924783340909, -249.04073648103903, -289.27939929386326, -173.52038370034956, -66.33895497336755, -137.79338209605544, -647.5601892930384, -231.38999496854842, -63.73834190470137, -176.6482688381221, -62.861530376251906, -505.7536704812748, -447.2707952429933, -578.9857253008239, -248.47902797037258, -99.75870706207391, -414.95317961788805, -1005.7020445203796, -25.764746003947792, -117.59002152858827, -248.82114883750214, -567.8525216901744, -295.57650071981413, -213.4412084174638, -185.73302554224125, -51.04924631117409, -338.96758428185547, -185.0826700199338, -588.2459975657404, -92.5038407011211, -1159.2144274434038, -334.3895717583722, -265.6459584112018, -419.28397348137895, -42.46047364592972, -107.56782811748174, -84.68908223285818, -1243.497810345213, -1329.41945073796, -160.73308877138805, -1057.7415501537118, -733.5172750880704, -211.06123669041764, -667.5206863034973, -965.7447092503355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5459551846101567, "mean_inference_ms": 1.7222283312156705, "mean_action_processing_ms": 0.805807162469839, "mean_env_wait_ms": 10.345351495265499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013485193252563477, "StateBufferConnector_ms": 0.009511232376098633, "ViewRequirementAgentConnector_ms": 0.31256556510925293}, "num_episodes": 29, "episode_return_max": -763.8054622390199, "episode_return_min": -4738.446815433957, "episode_return_mean": -2424.634411928789, "episodes_this_iter": 29}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1365079, "num_agent_steps_trained": 1365079, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.18012858509572, "num_env_steps_trained_throughput_per_sec": 83.18012858509572, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1365079, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1365079, "timers": {"training_iteration_time_ms": 44955.181, "restore_workers_time_ms": 0.025, "training_step_time_ms": 44955.113, "sample_time_ms": 3260.9, "learn_time_ms": 41640.425, "learn_throughput": 96.06, "synch_weights_time_ms": 50.935}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1365079, "num_agent_steps_trained": 1365079}, "done": false, "training_iteration": 78, "trial_id": "05c72_00000", "date": "2024-07-26_15-46-39", "timestamp": 1721988999, "time_this_iter_s": 48.09925413131714, "time_total_s": 3817.611650943756, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd0149990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3817.611650943756, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 12.925, "ram_util_percent": 30.80882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 116.426582085189, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.810883015586484, "policy_loss": 0.0015903629557234586, "vf_loss": 4.82160101526527, "vf_explained_var": 0.9798696877014252, "kl": 0.015623589755102908, "entropy": 2.417252090573311, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.89516129032258, "num_grad_updates_lifetime": 322980.5, "diff_num_grad_updates_vs_sampler_policy": 1859.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1380938, "num_agent_steps_trained": 1380938}, "env_runners": {"episode_reward_max": -763.8054622390199, "episode_reward_min": -4738.446815433957, "episode_reward_mean": -2354.6859749849305, "episode_len_mean": 147.98, "episode_media": {}, "episodes_timesteps_total": 14798, "policy_reward_min": {"policy_0": -1407.6455252124147}, "policy_reward_max": {"policy_0": 3.8983210929663565}, "policy_reward_mean": {"policy_0": -470.9371949969861}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2807.3730146812018, -1288.5009052867108, -2664.4413491552395, -1943.0619666626715, -3040.6757337834556, -1541.1267498260236, -2593.9964678203855, -2243.1498125631083, -1499.132011508633, -844.0238527003382, -2877.2461179478432, -1744.0921065500495, -2553.6755234951565, -1108.8252386107138, -1990.4374092335424, -1115.2502572109606, -3406.6308726240086, -3734.5980725443796, -2232.694818742967, -1708.7652297617562, -2014.539016302776, -2368.883909298423, -4361.60905448674, -3239.099473027426, -3162.7351430336043, -2756.5859677300414, -2693.498640314194, -3301.197584560768, -2601.6253052140364, -2041.0040336709812, -1404.6713819763786, -4738.446815433957, -3946.3019984736375, -2427.5662139433566, -3380.372776374824, -1434.838965222436, -4084.4693086411585, -2308.682597603054, -1394.9344803449617, -2642.59414453228, -3462.4961509804934, -1331.483049995287, -3725.8810859821724, -2193.6279481961137, -2344.2785190471627, -1731.8718888827034, -2208.81125743576, -1625.4710658818879, -1410.1492159077743, -3625.240703463341, -1632.8322102538314, -2305.090768093186, -1835.751855556582, -1924.506284145161, -2668.7653028019863, -3449.8874905973926, -3192.5799069523805, -2436.601580153362, -1928.4283152797752, -3856.61610507978, -763.8054622390199, -3036.067085719277, -1634.8822711813227, -2380.812771706749, -2458.7886015174163, -2601.099247153835, -1764.148543529796, -1130.8719527827097, -1257.1301771004655, -1843.3507493717148, -1663.768698732879, -1511.424405207197, -1255.849338879825, -2220.994404740286, -2925.9072602049037, -3635.5854574860305, -1443.678761771175, -1805.2241147092154, -2721.1292178430294, -1459.6621471958442, -2513.9365771260577, -1552.3221119693271, -3250.1516267764673, -1382.4637540081533, -2922.053502358466, -4270.28532560925, -1110.386198647779, -2483.759080698789, -2104.51458474872, -2912.8151053184342, -2056.703132138365, -1157.8984885030104, -2270.3890310598263, -1699.7699875355866, -2439.36657559097, -3563.9406787229786, -2213.3480215158465, -3600.855008277667, -1442.0040289714395, -2875.7289842629066], "episode_lengths": [150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150], "policy_policy_0_reward": [-438.71147952030407, -920.0960366479073, -1102.2631316507338, -261.1614817040236, -85.14088515823393, -37.771958849994604, -35.86184144655056, -295.6138479370784, -833.1885818800841, -86.0646751730026, -993.910958412599, -626.6352447850386, -382.30727668839245, 3.8983210929663565, -665.4861903621771, -5.4576041030793805, -360.0957237655713, -633.4843715038743, -465.7022696379085, -478.32199765223965, -1064.4306824904888, -432.2629113415589, -277.95306206190753, -960.8648352705352, -305.16424261896543, -119.4553591505368, -532.0324331568097, -423.7232439737146, -6.979203165022296, -458.9365103799399, -249.6283727112572, -118.57085610584072, -297.25587802083186, -900.9894632792021, -1027.5518977032546, -70.61400314970588, -335.79914241847183, -753.4979632220449, -442.46009424507014, -640.7786095278153, -10.549180863019222, -320.9054757873862, -93.93957141479237, -945.6668202616759, -128.07096318175985, -510.5705739255232, -32.90074584573477, -2.4366769449227377, -82.79567767189904, -215.32017831225835, -246.11685452339415, -468.072344419733, -571.5312393603941, -578.592636867643, -1012.9330427766774, -91.43397859389074, -119.07600448019862, -1187.6810350933513, -67.14651385230718, -278.7545745303021, -15.665190070394074, -485.2652924316935, -765.866352608844, -755.9732929710437, -530.9053954131833, -247.22815386921576, -71.54704222575404, -257.9331525656904, -107.0393087474525, -425.0775812026017, -815.6647549632912, -170.90476210195692, -48.51984608506368, -910.7681913688484, -44.57985471438175, -49.30079920582938, -246.09938525672183, -60.98219658255359, -708.1422530464536, -50.725623119401824, -733.196157147231, -332.2280488092792, -1246.9762092614912, -594.4778341749332, -499.7526232310688, -499.55311769120226, -791.4021607776464, -727.7074794520163, -798.6136210865535, -917.3216935369585, -1109.8079137130012, -454.1782692993961, -326.473832096181, -174.34070895579308, -167.89409467859417, -34.3053889094261, -871.0621977977995, -534.3330999987693, -129.89605195860688, -139.16849109715295, -15.168593685436706, -1242.2575934804884, -150.37169800167877, -40.14156180520637, -566.5995693299664, -302.89206950880777, -941.8565785919283, -976.3865046088722, -61.6091800833694, -86.13957650544619, -1334.8082528657053, -569.9882064050141, -944.8358689532743, -426.003679102354, -1085.973047160392, -1407.6455252124147, -144.49362450700966, -580.2506985849952, -755.6774514507023, -351.03217327230425, -1152.1373770228656, -345.0724361865359, -993.8071865909175, -32.64212281138117, -639.0760204219039, -957.1744760211944, -452.95014730048615, -92.82150801757386, -609.9129843896613, -643.7268520011282, -180.24079917302714, -706.7680429597814, -618.7918851223397, -117.79848419479549, -1069.8994288642496, -732.5359825189748, -1296.9077050613523, -220.11980177811643, -1000.0854950328945, -51.54860016943071, -64.2060311531663, -452.3314742816477, -1104.9183966180942, -277.7270130984768, -702.4423900626509, -643.4621481735801, -90.72475253201546, -493.97341833285697, -113.09079892400881, -699.7529157085183, -109.4656576145871, -287.93070966304106, -71.11597453755716, -208.83707145692813, -727.3219687042655, -1293.4962055360193, -1130.3083259032494, -1111.2698054211448, -958.730010599556, -244.64246797398275, -870.1946180198644, -974.6628165288545, -831.8182493624408, -544.5206480693148, -725.1056664931614, -426.8019906736956, -433.31637633435645, -110.88095784715973, -719.3659177113173, -737.2009713768297, -28.922656901466183, -975.2557978557195, -676.6845222440244, -658.8032333497167, -1040.7065660238948, -603.7678546237779, -41.70382719660712, -526.7493793207609, -24.4558423066295, -238.16206177465978, -1370.432806254822, -741.8743351295494, -932.9482257440496, -25.511343962251125, -1013.7025975504846, -598.8499234016836, -1128.7423417661173, -96.21058505592305, -68.9127647837292, -415.966982595601, -122.08795936547583, -648.2784119706541, -280.2549970259569, -20.35063543655394, -323.96247654632134, -113.60410794962425, -1366.6633078868979, -750.4822380083074, -314.4768853391483, -97.36760534830053, -54.95978609638461, -690.1859636306673, -928.293166251502, -1066.6015400905853, -722.4556949113517, -157.87112554977503, -152.47141039088513, -67.42717515312494, -723.2486707061906, -230.46466819531062, -373.47060307305895, -1139.7633523352658, -1071.3308608134275, -150.3876253031402, -990.9286444572805, -558.9033318839128, -132.60401222183913, -140.48365651845575, -526.1884316196289, -835.4485159522756, -658.9927669126532, -88.61045105620354, -223.06372171923837, -335.6339141147433, -1037.9776652443238, -262.1752966113819, -111.12788342183698, -134.56591964842087, -220.58193604149102, -1003.4208531595713, -593.1981686084405, -395.47228771303463, -163.75950952148807, -132.1894642182303, -924.1918273745661, -168.8186713977678, -589.1611495025212, -175.42361801525726, -647.2621495289158, -44.805477437424706, -734.7029008463369, -187.20340997236474, -24.122367997399955, -425.05623065409054, -39.0643064375814, -844.9374412241159, -607.1763594584806, -404.66377941831087, -1142.7326736284983, -625.7304497339355, -411.9438770230941, -655.4014600627646, -10.137686538680608, -129.46634763510576, -425.88283899418605, -512.8146391017809, -759.3322766318004, -183.7978804086372, -342.46310099731767, -506.6828709536484, -958.7356041654746, -482.738659375292, -38.09669389410644, -99.16958645362432, -257.01131166808545, -336.8991679511758, -758.6333727041185, -207.24580603046672, -173.6773179951833, -448.05061946421625, -1078.7901115124894, -64.32514749654952, -745.5082522223299, -406.535324382374, -373.60646718824233, -704.454175644365, -1252.5157375773597, -275.9294266022452, -67.10066724101924, -1149.8874835323998, -282.924186977236, -896.5674526787583, -509.5919030023752, -1304.0073892598023, -199.48897503420852, -221.11959613020838, -113.31135344852177, -1105.8574692218601, -564.1470271670875, -432.16613418568613, -66.25268347966261, -496.9680952742849, -81.40587717067314, -674.0426324934288, -609.7590268617249, -851.57041994898, -498.998357145587, -292.32763415206017, -906.9104368934898, -1306.809256939663, -74.39059344767836, -81.02173849191047, -94.98837463884311, -138.07826396768576, -375.32649169290215, -892.4250245746022, -163.5240099865681, -66.61356328169366, -856.5252075358561, -1056.9792803405578, -18.06495936427423, -132.84516363214237, -798.1900022157188, -154.87390613201475, -530.9082398371747, -162.518381274089, -378.21128198595596, -199.09192707664042, -789.9917781010273, -850.9994032690373, -118.10906850347011, -178.47526527674964, -1368.246057125207, -595.4041350604012, -198.5540755515898, -1020.8130899845548, -611.1332616305663, -253.73665927184544, -26.351372624697067, -689.0648636421733, -633.1066329694248, -58.20946585489134, -297.4724213044788, -736.8565219542489, -38.503501446750064, -352.6924783340909, -249.04073648103903, -289.27939929386326, -173.52038370034956, -66.33895497336755, -137.79338209605544, -647.5601892930384, -231.38999496854842, -63.73834190470137, -176.6482688381221, -62.861530376251906, -505.7536704812748, -447.2707952429933, -578.9857253008239, -248.47902797037258, -99.75870706207391, -414.95317961788805, -1005.7020445203796, -25.764746003947792, -117.59002152858827, -248.82114883750214, -567.8525216901744, -295.57650071981413, -213.4412084174638, -185.73302554224125, -51.04924631117409, -338.96758428185547, -185.0826700199338, -588.2459975657404, -92.5038407011211, -1159.2144274434038, -334.3895717583722, -265.6459584112018, -419.28397348137895, -42.46047364592972, -107.56782811748174, -84.68908223285818, -1243.497810345213, -1329.41945073796, -160.73308877138805, -1057.7415501537118, -733.5172750880704, -211.06123669041764, -667.5206863034973, -965.7447092503355, -95.65047493004981, -88.49152847176207, -639.8866140200995, -184.42916837048628, -435.22097597877826, -154.42908508169512, -120.73755389255123, -392.07417865426254, -1006.9950329593171, -130.9882641213898, -863.1058285738719, -457.9647824561519, -135.9858394227394, -194.43151958709834, -1069.6412478031677, -21.247036799261625, -216.29300728120526, -285.1603162126693, -512.6830742649046, -424.27871263780395, -16.82613722070257, -838.4366011146805, -819.0361432724718, -414.8699117697022, -424.7677837484997, -507.1392898181065, -151.76216336477182, -181.75450746701705, -114.1665519653838, -597.4995993540466, -602.9770910526859, -131.7419881817247, -169.39083662720884, -1284.903184065831, -1061.1385268490185, -220.81107764668752, -145.27241491693982, -409.0493853693704, -285.3866235456434, -321.9442525295124, -276.490539553934, -819.2867519291511, -451.6217999494391, -641.7514934468077, -732.9029174791357, -1282.6611289598443, -492.0545208472848, -1091.960498942644, -753.3542808827618, -650.2548959767172, -126.58378867033674, -392.4409455412414, -181.0059909030691, -44.13271046497287, -366.2227630681597, -859.7221456072322, -324.0057528143509, -137.7862140547801, -158.66370834120337, -1003.5812598812219, -257.66493708665024, -60.26109342731494, -709.5704592016706, -608.9627946304389, -468.0553004026451, -1223.6212879991888, -673.3903696202779, -533.6702679669187, -88.52734180707908, -393.60583792497096, -473.40480346883913, -465.92306154549743, -668.6424337461202, -166.21166541873407, -282.52116795917163, -130.63172815079557, -568.5361791963112, -128.80740506522156, -162.84152284125688, -167.08165324942487, -349.91543037562633, -305.67634337646155, -513.6742567678893, -514.8120228499238, -586.3109776899252, -217.08919861385712, -317.2054428331812, -942.6679956095425, -54.811525839306306, -167.9958246396991, -319.64695572529655, -133.87328155691822, -961.5823645730943, -155.95699274841346, -868.3069809872466, -664.2352774595074, -1396.2442313221711, -914.7291347745293, -446.8755411532677, -141.8564940135031, -575.59323981207, -77.09180617018237, -652.4888408455148, -788.3875625113322, -119.78657217674866, -992.5337560315929, -350.7294814515767, -67.26627392309038, -1090.405614529672, -1099.9198823417355, -154.5552844988043, -55.34275298322829, -288.8761561152106, -498.4628738414038, -444.7669615327932, -1175.7676013869186, -1074.6553288495475, -301.84971566643827, -251.39523808385832, -72.06110027614251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5451418522569131, "mean_inference_ms": 1.721420385862637, "mean_action_processing_ms": 0.8046677926230403, "mean_env_wait_ms": 10.336744822658806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013359546661376953, "StateBufferConnector_ms": 0.00929117202758789, "ViewRequirementAgentConnector_ms": 0.30312347412109375}, "num_episodes": 24, "episode_return_max": -763.8054622390199, "episode_return_min": -4738.446815433957, "episode_return_mean": -2354.6859749849305, "episodes_this_iter": 24}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380938, "num_agent_steps_trained": 1380938, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 86.3453421309717, "num_env_steps_trained_throughput_per_sec": 86.3453421309717, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1380938, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1380938, "timers": {"training_iteration_time_ms": 44712.493, "restore_workers_time_ms": 0.026, "training_step_time_ms": 44712.425, "sample_time_ms": 3263.202, "learn_time_ms": 41395.145, "learn_throughput": 96.63, "synch_weights_time_ms": 51.27}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1380938, "num_agent_steps_trained": 1380938}, "done": false, "training_iteration": 79, "trial_id": "05c72_00000", "date": "2024-07-26_15-47-26", "timestamp": 1721989046, "time_this_iter_s": 46.33566880226135, "time_total_s": 3863.9473197460175, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd014a290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3863.9473197460175, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 12.230303030303029, "ram_util_percent": 30.58787878787879}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.13000147676698, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000007, "total_loss": 4.743358888372707, "policy_loss": -4.333692303620243e-05, "vf_loss": 4.756467574057372, "vf_explained_var": 0.9860258598546475, "kl": 0.01570441910247926, "entropy": 2.499089757083119, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.97826086956522, "num_grad_updates_lifetime": 326910.5, "diff_num_grad_updates_vs_sampler_policy": 2069.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1398599, "num_agent_steps_trained": 1398599}, "env_runners": {"episode_reward_max": -749.5424122560762, "episode_reward_min": -4738.446815433957, "episode_reward_mean": -2342.2879152633277, "episode_len_mean": 147.01, "episode_media": {}, "episodes_timesteps_total": 14701, "policy_reward_min": {"policy_0": -1396.2442313221711}, "policy_reward_max": {"policy_0": -6.425871007180056}, "policy_reward_mean": {"policy_0": -468.4575830526655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1404.6713819763786, -4738.446815433957, -3946.3019984736375, -2427.5662139433566, -3380.372776374824, -1434.838965222436, -4084.4693086411585, -2308.682597603054, -1394.9344803449617, -2642.59414453228, -3462.4961509804934, -1331.483049995287, -3725.8810859821724, -2193.6279481961137, -2344.2785190471627, -1731.8718888827034, -2208.81125743576, -1625.4710658818879, -1410.1492159077743, -3625.240703463341, -1632.8322102538314, -2305.090768093186, -1835.751855556582, -1924.506284145161, -2668.7653028019863, -3449.8874905973926, -3192.5799069523805, -2436.601580153362, -1928.4283152797752, -3856.61610507978, -763.8054622390199, -3036.067085719277, -1634.8822711813227, -2380.812771706749, -2458.7886015174163, -2601.099247153835, -1764.148543529796, -1130.8719527827097, -1257.1301771004655, -1843.3507493717148, -1663.768698732879, -1511.424405207197, -1255.849338879825, -2220.994404740286, -2925.9072602049037, -3635.5854574860305, -1443.678761771175, -1805.2241147092154, -2721.1292178430294, -1459.6621471958442, -2513.9365771260577, -1552.3221119693271, -3250.1516267764673, -1382.4637540081533, -2922.053502358466, -4270.28532560925, -1110.386198647779, -2483.759080698789, -2104.51458474872, -2912.8151053184342, -2056.703132138365, -1157.8984885030104, -2270.3890310598263, -1699.7699875355866, -2439.36657559097, -3563.9406787229786, -2213.3480215158465, -3600.855008277667, -1442.0040289714395, -2875.7289842629066, -2300.4729180612635, -1916.2548215461231, -2708.038650052471, -1058.7098719899445, -3583.395375878292, -2057.9292222786034, -1800.552042795183, -3137.872989622974, -1681.3938246111366, -1790.3114070004476, -2144.575379601869, -1469.2182304607018, -1140.653279579078, -2495.204390257857, -4596.972441450198, -1873.1781912977187, -3415.0711109617905, -1388.6900091649143, -2164.8906337129315, -2717.156350064499, -2606.117793288689, -3681.9063706770426, -3669.084385399848, -1205.1191694681218, -749.5424122560762, -2387.9637889331893, -3044.9426761779814, -2925.7852701169504, -2187.5077238417434, -2340.158935640217], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-109.4656576145871, -287.93070966304106, -71.11597453755716, -208.83707145692813, -727.3219687042655, -1293.4962055360193, -1130.3083259032494, -1111.2698054211448, -958.730010599556, -244.64246797398275, -870.1946180198644, -974.6628165288545, -831.8182493624408, -544.5206480693148, -725.1056664931614, -426.8019906736956, -433.31637633435645, -110.88095784715973, -719.3659177113173, -737.2009713768297, -28.922656901466183, -975.2557978557195, -676.6845222440244, -658.8032333497167, -1040.7065660238948, -603.7678546237779, -41.70382719660712, -526.7493793207609, -24.4558423066295, -238.16206177465978, -1370.432806254822, -741.8743351295494, -932.9482257440496, -25.511343962251125, -1013.7025975504846, -598.8499234016836, -1128.7423417661173, -96.21058505592305, -68.9127647837292, -415.966982595601, -122.08795936547583, -648.2784119706541, -280.2549970259569, -20.35063543655394, -323.96247654632134, -113.60410794962425, -1366.6633078868979, -750.4822380083074, -314.4768853391483, -97.36760534830053, -54.95978609638461, -690.1859636306673, -928.293166251502, -1066.6015400905853, -722.4556949113517, -157.87112554977503, -152.47141039088513, -67.42717515312494, -723.2486707061906, -230.46466819531062, -373.47060307305895, -1139.7633523352658, -1071.3308608134275, -150.3876253031402, -990.9286444572805, -558.9033318839128, -132.60401222183913, -140.48365651845575, -526.1884316196289, -835.4485159522756, -658.9927669126532, -88.61045105620354, -223.06372171923837, -335.6339141147433, -1037.9776652443238, -262.1752966113819, -111.12788342183698, -134.56591964842087, -220.58193604149102, -1003.4208531595713, -593.1981686084405, -395.47228771303463, -163.75950952148807, -132.1894642182303, -924.1918273745661, -168.8186713977678, -589.1611495025212, -175.42361801525726, -647.2621495289158, -44.805477437424706, -734.7029008463369, -187.20340997236474, -24.122367997399955, -425.05623065409054, -39.0643064375814, -844.9374412241159, -607.1763594584806, -404.66377941831087, -1142.7326736284983, -625.7304497339355, -411.9438770230941, -655.4014600627646, -10.137686538680608, -129.46634763510576, -425.88283899418605, -512.8146391017809, -759.3322766318004, -183.7978804086372, -342.46310099731767, -506.6828709536484, -958.7356041654746, -482.738659375292, -38.09669389410644, -99.16958645362432, -257.01131166808545, -336.8991679511758, -758.6333727041185, -207.24580603046672, -173.6773179951833, -448.05061946421625, -1078.7901115124894, -64.32514749654952, -745.5082522223299, -406.535324382374, -373.60646718824233, -704.454175644365, -1252.5157375773597, -275.9294266022452, -67.10066724101924, -1149.8874835323998, -282.924186977236, -896.5674526787583, -509.5919030023752, -1304.0073892598023, -199.48897503420852, -221.11959613020838, -113.31135344852177, -1105.8574692218601, -564.1470271670875, -432.16613418568613, -66.25268347966261, -496.9680952742849, -81.40587717067314, -674.0426324934288, -609.7590268617249, -851.57041994898, -498.998357145587, -292.32763415206017, -906.9104368934898, -1306.809256939663, -74.39059344767836, -81.02173849191047, -94.98837463884311, -138.07826396768576, -375.32649169290215, -892.4250245746022, -163.5240099865681, -66.61356328169366, -856.5252075358561, -1056.9792803405578, -18.06495936427423, -132.84516363214237, -798.1900022157188, -154.87390613201475, -530.9082398371747, -162.518381274089, -378.21128198595596, -199.09192707664042, -789.9917781010273, -850.9994032690373, -118.10906850347011, -178.47526527674964, -1368.246057125207, -595.4041350604012, -198.5540755515898, -1020.8130899845548, -611.1332616305663, -253.73665927184544, -26.351372624697067, -689.0648636421733, -633.1066329694248, -58.20946585489134, -297.4724213044788, -736.8565219542489, -38.503501446750064, -352.6924783340909, -249.04073648103903, -289.27939929386326, -173.52038370034956, -66.33895497336755, -137.79338209605544, -647.5601892930384, -231.38999496854842, -63.73834190470137, -176.6482688381221, -62.861530376251906, -505.7536704812748, -447.2707952429933, -578.9857253008239, -248.47902797037258, -99.75870706207391, -414.95317961788805, -1005.7020445203796, -25.764746003947792, -117.59002152858827, -248.82114883750214, -567.8525216901744, -295.57650071981413, -213.4412084174638, -185.73302554224125, -51.04924631117409, -338.96758428185547, -185.0826700199338, -588.2459975657404, -92.5038407011211, -1159.2144274434038, -334.3895717583722, -265.6459584112018, -419.28397348137895, -42.46047364592972, -107.56782811748174, -84.68908223285818, -1243.497810345213, -1329.41945073796, -160.73308877138805, -1057.7415501537118, -733.5172750880704, -211.06123669041764, -667.5206863034973, -965.7447092503355, -95.65047493004981, -88.49152847176207, -639.8866140200995, -184.42916837048628, -435.22097597877826, -154.42908508169512, -120.73755389255123, -392.07417865426254, -1006.9950329593171, -130.9882641213898, -863.1058285738719, -457.9647824561519, -135.9858394227394, -194.43151958709834, -1069.6412478031677, -21.247036799261625, -216.29300728120526, -285.1603162126693, -512.6830742649046, -424.27871263780395, -16.82613722070257, -838.4366011146805, -819.0361432724718, -414.8699117697022, -424.7677837484997, -507.1392898181065, -151.76216336477182, -181.75450746701705, -114.1665519653838, -597.4995993540466, -602.9770910526859, -131.7419881817247, -169.39083662720884, -1284.903184065831, -1061.1385268490185, -220.81107764668752, -145.27241491693982, -409.0493853693704, -285.3866235456434, -321.9442525295124, -276.490539553934, -819.2867519291511, -451.6217999494391, -641.7514934468077, -732.9029174791357, -1282.6611289598443, -492.0545208472848, -1091.960498942644, -753.3542808827618, -650.2548959767172, -126.58378867033674, -392.4409455412414, -181.0059909030691, -44.13271046497287, -366.2227630681597, -859.7221456072322, -324.0057528143509, -137.7862140547801, -158.66370834120337, -1003.5812598812219, -257.66493708665024, -60.26109342731494, -709.5704592016706, -608.9627946304389, -468.0553004026451, -1223.6212879991888, -673.3903696202779, -533.6702679669187, -88.52734180707908, -393.60583792497096, -473.40480346883913, -465.92306154549743, -668.6424337461202, -166.21166541873407, -282.52116795917163, -130.63172815079557, -568.5361791963112, -128.80740506522156, -162.84152284125688, -167.08165324942487, -349.91543037562633, -305.67634337646155, -513.6742567678893, -514.8120228499238, -586.3109776899252, -217.08919861385712, -317.2054428331812, -942.6679956095425, -54.811525839306306, -167.9958246396991, -319.64695572529655, -133.87328155691822, -961.5823645730943, -155.95699274841346, -868.3069809872466, -664.2352774595074, -1396.2442313221711, -914.7291347745293, -446.8755411532677, -141.8564940135031, -575.59323981207, -77.09180617018237, -652.4888408455148, -788.3875625113322, -119.78657217674866, -992.5337560315929, -350.7294814515767, -67.26627392309038, -1090.405614529672, -1099.9198823417355, -154.5552844988043, -55.34275298322829, -288.8761561152106, -498.4628738414038, -444.7669615327932, -1175.7676013869186, -1074.6553288495475, -301.84971566643827, -251.39523808385832, -72.06110027614251, -659.5507573834352, -345.58193802793375, -698.4014176485307, -572.947098216742, -23.991706784621332, -34.757435353586985, -41.00179438583916, -1000.5979506438395, -761.9100445237347, -77.98759663912342, -1266.6942908837082, -84.39808648276296, -260.3138247829673, -88.07478733343754, -1008.5576605695943, -180.93416924418338, -411.3643176172342, -107.06217017047442, -139.31478856822486, -220.03442638982887, -544.7561529213053, -620.6986573929132, -737.8139883171058, -334.23905036312357, -1345.8875268838433, -114.27550395844104, -48.17891527706026, -455.2149578241444, -1164.892923212908, -275.36692200604944, -360.64156352943587, -514.9273607004909, -11.196609912535239, -144.53215443547018, -769.2543542172516, -820.70561595703, -523.242465199499, -982.6738292384197, -425.60327046230276, -385.64780876572394, -122.6924944045556, -103.20608690430248, -58.63194362993719, -906.9399211202149, -489.923378552126, -396.55689451537677, -747.700094898245, -115.86948564044599, -41.08416373068337, -489.10076821569606, -410.38930552617677, -514.1123326744561, -151.19429467846797, -393.1254539847782, -675.7539927379916, -994.5359322888611, -181.91757756199442, -56.02277893756166, -156.87055228254007, -79.87138938974465, -70.80071555835278, -285.6859982313347, -59.83227132632998, -424.77359865189857, -299.5606958111622, -129.33902925697083, -243.2114639650721, -645.433252988479, -786.2991372554869, -690.9215067918434, -689.4638328196405, -918.1825753003167, -1231.037274364914, -1024.900934593514, -733.3878243718154, -31.189298772587886, -813.0585143975026, -732.8151266278866, -190.38056056916858, -105.7346909305728, -759.0585280651727, -65.29951799312578, -544.807073377673, -869.1751796599659, -1176.7308118658527, -315.15000834612067, -24.35541791213543, -321.7711430989931, -604.066010045978, -123.34742976168728, -69.15145021404787, -843.9900544589082, -222.4111246827989, -369.40772108772165, -659.9302832694551, -944.6597879956963, -507.5706356487266, -6.425871007180056, -1136.2914208832058, -122.20863452968806, -828.2597754252278, -466.41173057017556, -582.9886459974668, -29.179143820573312, -699.278497475244, -882.6626950279978, -1038.8667558778907, -942.0654104533781, -496.41278324180246, -321.89872607597044, -1140.124011690991, -476.54605963803584, -717.30736355829, -367.00339216258413, -968.1035583499462, -218.7818717662184, -86.20674640054963, -23.235278989239404, -664.3485512365991, -212.5467210755153, -252.48849028032484, -245.20576172902986, -53.98121346138665, -72.87048251032745, -124.99646427500737, -675.7470670874992, -496.9242466229019, -859.2618848222033, -142.73852417726076, -213.2920662233227, -1125.3115969828464, -87.97384944733237, -474.1409063039394, -381.62468488850175, -975.8916385553598, -313.9481551713319, -205.9604506552651, -1048.8212149979645, -863.0546629542237, -494.000786338167, -632.6615910338846, -570.3920930784374, -490.8760985501508, -381.4112800504102, -112.166661128859, -658.6984253900517, -633.2165802891838, -82.09057536113903, -912.6867379278651, -53.466616671976524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.542709225246229, "mean_inference_ms": 1.7211393242108803, "mean_action_processing_ms": 0.803845621544571, "mean_env_wait_ms": 10.324235464499695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013338327407836914, "StateBufferConnector_ms": 0.009411334991455078, "ViewRequirementAgentConnector_ms": 0.3086085319519043}, "num_episodes": 30, "episode_return_max": -749.5424122560762, "episode_return_min": -4738.446815433957, "episode_return_mean": -2342.2879152633277, "episodes_this_iter": 30}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1398599, "num_agent_steps_trained": 1398599, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 86.21973436955064, "num_env_steps_trained_throughput_per_sec": 86.21973436955064, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1398599, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1398599, "timers": {"training_iteration_time_ms": 45826.66, "restore_workers_time_ms": 0.025, "training_step_time_ms": 45826.594, "sample_time_ms": 3268.353, "learn_time_ms": 42502.207, "learn_throughput": 94.113, "synch_weights_time_ms": 53.184}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1398599, "num_agent_steps_trained": 1398599}, "done": false, "training_iteration": 80, "trial_id": "05c72_00000", "date": "2024-07-26_15-48-12", "timestamp": 1721989092, "time_this_iter_s": 46.40384364128113, "time_total_s": 3910.3511633872986, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00dfa30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3910.3511633872986, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 11.545454545454547, "ram_util_percent": 30.253030303030304}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 122.7458142419509, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.724282713525089, "policy_loss": -0.0038569846504114937, "vf_loss": 4.7426240783856235, "vf_explained_var": 0.9832704910967085, "kl": 0.014437986536491892, "entropy": 2.544821928106708, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.31111111111112, "num_grad_updates_lifetime": 331005.5, "diff_num_grad_updates_vs_sampler_policy": 2024.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1415786, "num_agent_steps_trained": 1415786}, "env_runners": {"episode_reward_max": -749.5424122560762, "episode_reward_min": -4596.972441450198, "episode_reward_mean": -2320.6345196297784, "episode_len_mean": 146.59, "episode_media": {}, "episodes_timesteps_total": 14659, "policy_reward_min": {"policy_0": -1396.2442313221711}, "policy_reward_max": {"policy_0": -6.425871007180056}, "policy_reward_mean": {"policy_0": -464.12690392595573}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3192.5799069523805, -2436.601580153362, -1928.4283152797752, -3856.61610507978, -763.8054622390199, -3036.067085719277, -1634.8822711813227, -2380.812771706749, -2458.7886015174163, -2601.099247153835, -1764.148543529796, -1130.8719527827097, -1257.1301771004655, -1843.3507493717148, -1663.768698732879, -1511.424405207197, -1255.849338879825, -2220.994404740286, -2925.9072602049037, -3635.5854574860305, -1443.678761771175, -1805.2241147092154, -2721.1292178430294, -1459.6621471958442, -2513.9365771260577, -1552.3221119693271, -3250.1516267764673, -1382.4637540081533, -2922.053502358466, -4270.28532560925, -1110.386198647779, -2483.759080698789, -2104.51458474872, -2912.8151053184342, -2056.703132138365, -1157.8984885030104, -2270.3890310598263, -1699.7699875355866, -2439.36657559097, -3563.9406787229786, -2213.3480215158465, -3600.855008277667, -1442.0040289714395, -2875.7289842629066, -2300.4729180612635, -1916.2548215461231, -2708.038650052471, -1058.7098719899445, -3583.395375878292, -2057.9292222786034, -1800.552042795183, -3137.872989622974, -1681.3938246111366, -1790.3114070004476, -2144.575379601869, -1469.2182304607018, -1140.653279579078, -2495.204390257857, -4596.972441450198, -1873.1781912977187, -3415.0711109617905, -1388.6900091649143, -2164.8906337129315, -2717.156350064499, -2606.117793288689, -3681.9063706770426, -3669.084385399848, -1205.1191694681218, -749.5424122560762, -2387.9637889331893, -3044.9426761779814, -2925.7852701169504, -2187.5077238417434, -2340.158935640217, -2591.3633800826383, -855.8914344254931, -1211.409880323682, -1931.434319721205, -2855.406910769288, -3316.3822911262255, -3180.5086428608597, -3579.8842045047777, -2120.751512435235, -2126.425878837012, -2372.246085230003, -2657.9380453034196, -2501.635560525023, -3009.512303866327, -2536.573922880589, -3054.2710672464796, -2031.9807843173237, -3004.557585251678, -3295.0701597524503, -1512.069495449768, -2373.1111864588224, -2632.8357039374123, -2601.05248404876, -2186.4111904810748, -1099.1939718488522, -2435.7659147275654], "episode_lengths": [150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 129, 150], "policy_policy_0_reward": [-282.924186977236, -896.5674526787583, -509.5919030023752, -1304.0073892598023, -199.48897503420852, -221.11959613020838, -113.31135344852177, -1105.8574692218601, -564.1470271670875, -432.16613418568613, -66.25268347966261, -496.9680952742849, -81.40587717067314, -674.0426324934288, -609.7590268617249, -851.57041994898, -498.998357145587, -292.32763415206017, -906.9104368934898, -1306.809256939663, -74.39059344767836, -81.02173849191047, -94.98837463884311, -138.07826396768576, -375.32649169290215, -892.4250245746022, -163.5240099865681, -66.61356328169366, -856.5252075358561, -1056.9792803405578, -18.06495936427423, -132.84516363214237, -798.1900022157188, -154.87390613201475, -530.9082398371747, -162.518381274089, -378.21128198595596, -199.09192707664042, -789.9917781010273, -850.9994032690373, -118.10906850347011, -178.47526527674964, -1368.246057125207, -595.4041350604012, -198.5540755515898, -1020.8130899845548, -611.1332616305663, -253.73665927184544, -26.351372624697067, -689.0648636421733, -633.1066329694248, -58.20946585489134, -297.4724213044788, -736.8565219542489, -38.503501446750064, -352.6924783340909, -249.04073648103903, -289.27939929386326, -173.52038370034956, -66.33895497336755, -137.79338209605544, -647.5601892930384, -231.38999496854842, -63.73834190470137, -176.6482688381221, -62.861530376251906, -505.7536704812748, -447.2707952429933, -578.9857253008239, -248.47902797037258, -99.75870706207391, -414.95317961788805, -1005.7020445203796, -25.764746003947792, -117.59002152858827, -248.82114883750214, -567.8525216901744, -295.57650071981413, -213.4412084174638, -185.73302554224125, -51.04924631117409, -338.96758428185547, -185.0826700199338, -588.2459975657404, -92.5038407011211, -1159.2144274434038, -334.3895717583722, -265.6459584112018, -419.28397348137895, -42.46047364592972, -107.56782811748174, -84.68908223285818, -1243.497810345213, -1329.41945073796, -160.73308877138805, -1057.7415501537118, -733.5172750880704, -211.06123669041764, -667.5206863034973, -965.7447092503355, -95.65047493004981, -88.49152847176207, -639.8866140200995, -184.42916837048628, -435.22097597877826, -154.42908508169512, -120.73755389255123, -392.07417865426254, -1006.9950329593171, -130.9882641213898, -863.1058285738719, -457.9647824561519, -135.9858394227394, -194.43151958709834, -1069.6412478031677, -21.247036799261625, -216.29300728120526, -285.1603162126693, -512.6830742649046, -424.27871263780395, -16.82613722070257, -838.4366011146805, -819.0361432724718, -414.8699117697022, -424.7677837484997, -507.1392898181065, -151.76216336477182, -181.75450746701705, -114.1665519653838, -597.4995993540466, -602.9770910526859, -131.7419881817247, -169.39083662720884, -1284.903184065831, -1061.1385268490185, -220.81107764668752, -145.27241491693982, -409.0493853693704, -285.3866235456434, -321.9442525295124, -276.490539553934, -819.2867519291511, -451.6217999494391, -641.7514934468077, -732.9029174791357, -1282.6611289598443, -492.0545208472848, -1091.960498942644, -753.3542808827618, -650.2548959767172, -126.58378867033674, -392.4409455412414, -181.0059909030691, -44.13271046497287, -366.2227630681597, -859.7221456072322, -324.0057528143509, -137.7862140547801, -158.66370834120337, -1003.5812598812219, -257.66493708665024, -60.26109342731494, -709.5704592016706, -608.9627946304389, -468.0553004026451, -1223.6212879991888, -673.3903696202779, -533.6702679669187, -88.52734180707908, -393.60583792497096, -473.40480346883913, -465.92306154549743, -668.6424337461202, -166.21166541873407, -282.52116795917163, -130.63172815079557, -568.5361791963112, -128.80740506522156, -162.84152284125688, -167.08165324942487, -349.91543037562633, -305.67634337646155, -513.6742567678893, -514.8120228499238, -586.3109776899252, -217.08919861385712, -317.2054428331812, -942.6679956095425, -54.811525839306306, -167.9958246396991, -319.64695572529655, -133.87328155691822, -961.5823645730943, -155.95699274841346, -868.3069809872466, -664.2352774595074, -1396.2442313221711, -914.7291347745293, -446.8755411532677, -141.8564940135031, -575.59323981207, -77.09180617018237, -652.4888408455148, -788.3875625113322, -119.78657217674866, -992.5337560315929, -350.7294814515767, -67.26627392309038, -1090.405614529672, -1099.9198823417355, -154.5552844988043, -55.34275298322829, -288.8761561152106, -498.4628738414038, -444.7669615327932, -1175.7676013869186, -1074.6553288495475, -301.84971566643827, -251.39523808385832, -72.06110027614251, -659.5507573834352, -345.58193802793375, -698.4014176485307, -572.947098216742, -23.991706784621332, -34.757435353586985, -41.00179438583916, -1000.5979506438395, -761.9100445237347, -77.98759663912342, -1266.6942908837082, -84.39808648276296, -260.3138247829673, -88.07478733343754, -1008.5576605695943, -180.93416924418338, -411.3643176172342, -107.06217017047442, -139.31478856822486, -220.03442638982887, -544.7561529213053, -620.6986573929132, -737.8139883171058, -334.23905036312357, -1345.8875268838433, -114.27550395844104, -48.17891527706026, -455.2149578241444, -1164.892923212908, -275.36692200604944, -360.64156352943587, -514.9273607004909, -11.196609912535239, -144.53215443547018, -769.2543542172516, -820.70561595703, -523.242465199499, -982.6738292384197, -425.60327046230276, -385.64780876572394, -122.6924944045556, -103.20608690430248, -58.63194362993719, -906.9399211202149, -489.923378552126, -396.55689451537677, -747.700094898245, -115.86948564044599, -41.08416373068337, -489.10076821569606, -410.38930552617677, -514.1123326744561, -151.19429467846797, -393.1254539847782, -675.7539927379916, -994.5359322888611, -181.91757756199442, -56.02277893756166, -156.87055228254007, -79.87138938974465, -70.80071555835278, -285.6859982313347, -59.83227132632998, -424.77359865189857, -299.5606958111622, -129.33902925697083, -243.2114639650721, -645.433252988479, -786.2991372554869, -690.9215067918434, -689.4638328196405, -918.1825753003167, -1231.037274364914, -1024.900934593514, -733.3878243718154, -31.189298772587886, -813.0585143975026, -732.8151266278866, -190.38056056916858, -105.7346909305728, -759.0585280651727, -65.29951799312578, -544.807073377673, -869.1751796599659, -1176.7308118658527, -315.15000834612067, -24.35541791213543, -321.7711430989931, -604.066010045978, -123.34742976168728, -69.15145021404787, -843.9900544589082, -222.4111246827989, -369.40772108772165, -659.9302832694551, -944.6597879956963, -507.5706356487266, -6.425871007180056, -1136.2914208832058, -122.20863452968806, -828.2597754252278, -466.41173057017556, -582.9886459974668, -29.179143820573312, -699.278497475244, -882.6626950279978, -1038.8667558778907, -942.0654104533781, -496.41278324180246, -321.89872607597044, -1140.124011690991, -476.54605963803584, -717.30736355829, -367.00339216258413, -968.1035583499462, -218.7818717662184, -86.20674640054963, -23.235278989239404, -664.3485512365991, -212.5467210755153, -252.48849028032484, -245.20576172902986, -53.98121346138665, -72.87048251032745, -124.99646427500737, -675.7470670874992, -496.9242466229019, -859.2618848222033, -142.73852417726076, -213.2920662233227, -1125.3115969828464, -87.97384944733237, -474.1409063039394, -381.62468488850175, -975.8916385553598, -313.9481551713319, -205.9604506552651, -1048.8212149979645, -863.0546629542237, -494.000786338167, -632.6615910338846, -570.3920930784374, -490.8760985501508, -381.4112800504102, -112.166661128859, -658.6984253900517, -633.2165802891838, -82.09057536113903, -912.6867379278651, -53.466616671976524, -253.7553086833572, -218.20535287830296, -153.54736573359747, -978.192223564513, -987.6631292228685, -67.31479258386364, -436.56121001675655, -138.08016479071446, -152.09330381469368, -61.841963219464475, -35.06636203917079, -191.04939882058, -79.51522870534619, -322.1627012841595, -583.6161894744268, -432.84819380217215, -203.94982313047126, -269.5650733278524, -601.7324953059574, -423.3387341547517, -46.56883258033425, -983.4953357393618, -554.6923451295422, -437.2781791635389, -833.3722181565117, -1124.1372659643998, -59.36217589141995, -939.2392000063285, -607.4201304457346, -586.223518818343, -409.9155059461264, -647.334478126408, -967.0098149692237, -699.5909033075397, -456.65794051156286, -550.4332995497513, -224.46709458074437, -845.5474322665199, -899.183598803808, -1060.2527793039512, -302.36568062305497, -345.15097401190184, -786.036020194758, -599.305567229066, -87.89327037645381, -462.5555292641476, -575.3952758957001, -413.59110138006247, -104.29538349333978, -570.5885888037627, -830.4729282830826, -555.8031506032561, -727.9897489623618, -103.39181516720627, -154.5884422140962, -190.4388165112596, -604.7229840032774, -759.484927286598, -867.8057343505562, -235.4855831517272, -146.27913400219018, -133.8231284057732, -629.7291900197525, -897.7294132310991, -694.0746948662097, -593.7058681954767, -840.7974374263954, -757.4828466966751, -29.175320352392358, -788.3508311953856, -1190.6347936236923, -364.4523178374612, -26.51349837277249, -236.81107382856658, -718.1622392180959, -1114.1649637584994, -1088.6329226199107, -143.5777369657012, -318.6933310451295, -389.2021128572374, -677.6196081853346, -554.8822929905525, -579.6996609256855, -140.80106979487428, -78.97815242087592, -958.7020260473608, -1069.9230606069998, -437.0811116725786, -216.05573217422003, -322.79565475051794, -312.0451762874677, -1095.4460175450508, -821.4884685835841, -1036.7943696310765, -29.29612770527118, -107.45882932974257, -608.9120210785121, -351.0359863250141, -355.77340106131726, -88.88925765518033, -429.1781295749507, -276.45755305169865, -1319.5928679354456, -72.20319982970449, -275.6794360670238, -976.1375601122016, -840.0088704555078, -499.9577602861962, -269.49474245085185, -47.23677063265485, -741.1098412122292, -530.3187129332563, -156.26324784048774, -930.3152421296231, -243.0454399331649, -1212.5419431162225, -315.93613531479923, -214.9550094804272, -237.73239212948837, -205.2457104401374, -112.48315682525553, -72.72613135870854, -205.69595746357803, -663.231954964767, -45.05677123654345, -691.1093125279818, -497.54529999788645, -51.44426162077401, -706.3500513130864, -489.31698926783804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.543296147368349, "mean_inference_ms": 1.7211122069083529, "mean_action_processing_ms": 0.8027921497498595, "mean_env_wait_ms": 10.31536089641739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013595342636108398, "StateBufferConnector_ms": 0.009430885314941406, "ViewRequirementAgentConnector_ms": 0.31622314453125}, "num_episodes": 26, "episode_return_max": -749.5424122560762, "episode_return_min": -4596.972441450198, "episode_return_mean": -2320.6345196297784, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1415786, "num_agent_steps_trained": 1415786, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.75289230703002, "num_env_steps_trained_throughput_per_sec": 75.75289230703002, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1415786, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1415786, "timers": {"training_iteration_time_ms": 45676.822, "restore_workers_time_ms": 0.024, "training_step_time_ms": 45676.756, "sample_time_ms": 3239.971, "learn_time_ms": 42381.826, "learn_throughput": 94.38, "synch_weights_time_ms": 52.167}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1415786, "num_agent_steps_trained": 1415786}, "done": false, "training_iteration": 81, "trial_id": "05c72_00000", "date": "2024-07-26_15-49-05", "timestamp": 1721989145, "time_this_iter_s": 52.81349992752075, "time_total_s": 3963.1646633148193, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd0149240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3963.1646633148193, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 11.706666666666665, "ram_util_percent": 30.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.9761175011595, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.492516964736084, "policy_loss": -0.002560684173295158, "vf_loss": 4.510966820828616, "vf_explained_var": 0.9857233535032719, "kl": 0.015322815027927088, "entropy": 2.7524933983882267, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.375, "num_grad_updates_lifetime": 334950.5, "diff_num_grad_updates_vs_sampler_policy": 1919.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1432090, "num_agent_steps_trained": 1432090}, "env_runners": {"episode_reward_max": -749.5424122560762, "episode_reward_min": -4596.972441450198, "episode_reward_mean": -2407.528906832578, "episode_len_mean": 147.59, "episode_media": {}, "episodes_timesteps_total": 14759, "policy_reward_min": {"policy_0": -1396.2442313221711}, "policy_reward_max": {"policy_0": 8.939850134629456}, "policy_reward_mean": {"policy_0": -481.5057813665156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1552.3221119693271, -3250.1516267764673, -1382.4637540081533, -2922.053502358466, -4270.28532560925, -1110.386198647779, -2483.759080698789, -2104.51458474872, -2912.8151053184342, -2056.703132138365, -1157.8984885030104, -2270.3890310598263, -1699.7699875355866, -2439.36657559097, -3563.9406787229786, -2213.3480215158465, -3600.855008277667, -1442.0040289714395, -2875.7289842629066, -2300.4729180612635, -1916.2548215461231, -2708.038650052471, -1058.7098719899445, -3583.395375878292, -2057.9292222786034, -1800.552042795183, -3137.872989622974, -1681.3938246111366, -1790.3114070004476, -2144.575379601869, -1469.2182304607018, -1140.653279579078, -2495.204390257857, -4596.972441450198, -1873.1781912977187, -3415.0711109617905, -1388.6900091649143, -2164.8906337129315, -2717.156350064499, -2606.117793288689, -3681.9063706770426, -3669.084385399848, -1205.1191694681218, -749.5424122560762, -2387.9637889331893, -3044.9426761779814, -2925.7852701169504, -2187.5077238417434, -2340.158935640217, -2591.3633800826383, -855.8914344254931, -1211.409880323682, -1931.434319721205, -2855.406910769288, -3316.3822911262255, -3180.5086428608597, -3579.8842045047777, -2120.751512435235, -2126.425878837012, -2372.246085230003, -2657.9380453034196, -2501.635560525023, -3009.512303866327, -2536.573922880589, -3054.2710672464796, -2031.9807843173237, -3004.557585251678, -3295.0701597524503, -1512.069495449768, -2373.1111864588224, -2632.8357039374123, -2601.05248404876, -2186.4111904810748, -1099.1939718488522, -2435.7659147275654, -1811.308883574, -1719.288096519934, -4365.873979223657, -2097.294021163272, -2820.656853250435, -2030.4643437532718, -1614.6874299779813, -2855.943920515082, -3206.267735367684, -2184.271522850701, -2147.3953644985354, -3732.3936866572635, -2692.238554026424, -1909.1381224952129, -2994.502452170676, -1549.682702003673, -1984.8147233694583, -2742.697869672244, -3129.4689729391453, -1107.2630182018916, -3044.985519602891, -1659.2342144663405, -3079.883663863213, -3060.181069585304, -2591.8451541957083], "episode_lengths": [150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 135, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-507.1392898181065, -151.76216336477182, -181.75450746701705, -114.1665519653838, -597.4995993540466, -602.9770910526859, -131.7419881817247, -169.39083662720884, -1284.903184065831, -1061.1385268490185, -220.81107764668752, -145.27241491693982, -409.0493853693704, -285.3866235456434, -321.9442525295124, -276.490539553934, -819.2867519291511, -451.6217999494391, -641.7514934468077, -732.9029174791357, -1282.6611289598443, -492.0545208472848, -1091.960498942644, -753.3542808827618, -650.2548959767172, -126.58378867033674, -392.4409455412414, -181.0059909030691, -44.13271046497287, -366.2227630681597, -859.7221456072322, -324.0057528143509, -137.7862140547801, -158.66370834120337, -1003.5812598812219, -257.66493708665024, -60.26109342731494, -709.5704592016706, -608.9627946304389, -468.0553004026451, -1223.6212879991888, -673.3903696202779, -533.6702679669187, -88.52734180707908, -393.60583792497096, -473.40480346883913, -465.92306154549743, -668.6424337461202, -166.21166541873407, -282.52116795917163, -130.63172815079557, -568.5361791963112, -128.80740506522156, -162.84152284125688, -167.08165324942487, -349.91543037562633, -305.67634337646155, -513.6742567678893, -514.8120228499238, -586.3109776899252, -217.08919861385712, -317.2054428331812, -942.6679956095425, -54.811525839306306, -167.9958246396991, -319.64695572529655, -133.87328155691822, -961.5823645730943, -155.95699274841346, -868.3069809872466, -664.2352774595074, -1396.2442313221711, -914.7291347745293, -446.8755411532677, -141.8564940135031, -575.59323981207, -77.09180617018237, -652.4888408455148, -788.3875625113322, -119.78657217674866, -992.5337560315929, -350.7294814515767, -67.26627392309038, -1090.405614529672, -1099.9198823417355, -154.5552844988043, -55.34275298322829, -288.8761561152106, -498.4628738414038, -444.7669615327932, -1175.7676013869186, -1074.6553288495475, -301.84971566643827, -251.39523808385832, -72.06110027614251, -659.5507573834352, -345.58193802793375, -698.4014176485307, -572.947098216742, -23.991706784621332, -34.757435353586985, -41.00179438583916, -1000.5979506438395, -761.9100445237347, -77.98759663912342, -1266.6942908837082, -84.39808648276296, -260.3138247829673, -88.07478733343754, -1008.5576605695943, -180.93416924418338, -411.3643176172342, -107.06217017047442, -139.31478856822486, -220.03442638982887, -544.7561529213053, -620.6986573929132, -737.8139883171058, -334.23905036312357, -1345.8875268838433, -114.27550395844104, -48.17891527706026, -455.2149578241444, -1164.892923212908, -275.36692200604944, -360.64156352943587, -514.9273607004909, -11.196609912535239, -144.53215443547018, -769.2543542172516, -820.70561595703, -523.242465199499, -982.6738292384197, -425.60327046230276, -385.64780876572394, -122.6924944045556, -103.20608690430248, -58.63194362993719, -906.9399211202149, -489.923378552126, -396.55689451537677, -747.700094898245, -115.86948564044599, -41.08416373068337, -489.10076821569606, -410.38930552617677, -514.1123326744561, -151.19429467846797, -393.1254539847782, -675.7539927379916, -994.5359322888611, -181.91757756199442, -56.02277893756166, -156.87055228254007, -79.87138938974465, -70.80071555835278, -285.6859982313347, -59.83227132632998, -424.77359865189857, -299.5606958111622, -129.33902925697083, -243.2114639650721, -645.433252988479, -786.2991372554869, -690.9215067918434, -689.4638328196405, -918.1825753003167, -1231.037274364914, -1024.900934593514, -733.3878243718154, -31.189298772587886, -813.0585143975026, -732.8151266278866, -190.38056056916858, -105.7346909305728, -759.0585280651727, -65.29951799312578, -544.807073377673, -869.1751796599659, -1176.7308118658527, -315.15000834612067, -24.35541791213543, -321.7711430989931, -604.066010045978, -123.34742976168728, -69.15145021404787, -843.9900544589082, -222.4111246827989, -369.40772108772165, -659.9302832694551, -944.6597879956963, -507.5706356487266, -6.425871007180056, -1136.2914208832058, -122.20863452968806, -828.2597754252278, -466.41173057017556, -582.9886459974668, -29.179143820573312, -699.278497475244, -882.6626950279978, -1038.8667558778907, -942.0654104533781, -496.41278324180246, -321.89872607597044, -1140.124011690991, -476.54605963803584, -717.30736355829, -367.00339216258413, -968.1035583499462, -218.7818717662184, -86.20674640054963, -23.235278989239404, -664.3485512365991, -212.5467210755153, -252.48849028032484, -245.20576172902986, -53.98121346138665, -72.87048251032745, -124.99646427500737, -675.7470670874992, -496.9242466229019, -859.2618848222033, -142.73852417726076, -213.2920662233227, -1125.3115969828464, -87.97384944733237, -474.1409063039394, -381.62468488850175, -975.8916385553598, -313.9481551713319, -205.9604506552651, -1048.8212149979645, -863.0546629542237, -494.000786338167, -632.6615910338846, -570.3920930784374, -490.8760985501508, -381.4112800504102, -112.166661128859, -658.6984253900517, -633.2165802891838, -82.09057536113903, -912.6867379278651, -53.466616671976524, -253.7553086833572, -218.20535287830296, -153.54736573359747, -978.192223564513, -987.6631292228685, -67.31479258386364, -436.56121001675655, -138.08016479071446, -152.09330381469368, -61.841963219464475, -35.06636203917079, -191.04939882058, -79.51522870534619, -322.1627012841595, -583.6161894744268, -432.84819380217215, -203.94982313047126, -269.5650733278524, -601.7324953059574, -423.3387341547517, -46.56883258033425, -983.4953357393618, -554.6923451295422, -437.2781791635389, -833.3722181565117, -1124.1372659643998, -59.36217589141995, -939.2392000063285, -607.4201304457346, -586.223518818343, -409.9155059461264, -647.334478126408, -967.0098149692237, -699.5909033075397, -456.65794051156286, -550.4332995497513, -224.46709458074437, -845.5474322665199, -899.183598803808, -1060.2527793039512, -302.36568062305497, -345.15097401190184, -786.036020194758, -599.305567229066, -87.89327037645381, -462.5555292641476, -575.3952758957001, -413.59110138006247, -104.29538349333978, -570.5885888037627, -830.4729282830826, -555.8031506032561, -727.9897489623618, -103.39181516720627, -154.5884422140962, -190.4388165112596, -604.7229840032774, -759.484927286598, -867.8057343505562, -235.4855831517272, -146.27913400219018, -133.8231284057732, -629.7291900197525, -897.7294132310991, -694.0746948662097, -593.7058681954767, -840.7974374263954, -757.4828466966751, -29.175320352392358, -788.3508311953856, -1190.6347936236923, -364.4523178374612, -26.51349837277249, -236.81107382856658, -718.1622392180959, -1114.1649637584994, -1088.6329226199107, -143.5777369657012, -318.6933310451295, -389.2021128572374, -677.6196081853346, -554.8822929905525, -579.6996609256855, -140.80106979487428, -78.97815242087592, -958.7020260473608, -1069.9230606069998, -437.0811116725786, -216.05573217422003, -322.79565475051794, -312.0451762874677, -1095.4460175450508, -821.4884685835841, -1036.7943696310765, -29.29612770527118, -107.45882932974257, -608.9120210785121, -351.0359863250141, -355.77340106131726, -88.88925765518033, -429.1781295749507, -276.45755305169865, -1319.5928679354456, -72.20319982970449, -275.6794360670238, -976.1375601122016, -840.0088704555078, -499.9577602861962, -269.49474245085185, -47.23677063265485, -741.1098412122292, -530.3187129332563, -156.26324784048774, -930.3152421296231, -243.0454399331649, -1212.5419431162225, -315.93613531479923, -214.9550094804272, -237.73239212948837, -205.2457104401374, -112.48315682525553, -72.72613135870854, -205.69595746357803, -663.231954964767, -45.05677123654345, -691.1093125279818, -497.54529999788645, -51.44426162077401, -706.3500513130864, -489.31698926783804, -992.9619195751181, 8.939850134629456, -655.2673264549384, -103.76872492535905, -68.25076275321273, -23.09385728537565, -400.4108988361599, -620.4000258144168, -130.76619179582983, -544.6171227881523, -305.09955979003496, -740.3777144213403, -1255.6071697040943, -1311.162367508437, -753.6271677997505, -51.05383300844648, -902.7710842845049, -85.76141764810666, -91.10608618003087, -966.6016000421837, -60.701321333726796, -400.91919042803295, -52.87536703931957, -1280.141701841854, -1026.0192726074988, -676.1945541813718, -450.39529646117126, -353.7181018023349, -417.26324655103656, -132.89314475735702, -616.8421659057952, -714.9757119453637, -63.43129819495893, -50.52449936983533, -168.9137545620283, -210.23121040130115, -202.89529719342187, -1114.3024529867669, -1176.9837248114038, -151.5312351221881, -1307.0679366481897, -495.25802108174264, -178.70586468623497, -408.34731862943164, -816.8885943220904, -338.77642216406645, -420.4970343658038, -562.7373203496479, -344.3555700695035, -517.9051759016778, -387.39486022300747, -442.852505698327, -129.92202796530657, -927.678215925143, -259.5477546867507, -247.22813722061383, -1240.411492431275, -157.7726853265992, -822.2716657783421, -1264.7097059004327, -758.8913721133817, -170.37505996519033, -1197.521284217293, -80.98212305522425, -484.46871467533407, -41.0602820834425, -546.279091390632, -635.9009995327696, -26.819898705990287, -659.0778507823788, -1213.2471300555871, -490.8939208375349, -811.289486355672, -127.24539486146413, -351.8265200604165, -677.1903177831031, -39.34874440248938, -445.6836154043852, -242.0936210966578, -145.36640331703717, -139.57997607977126, -670.1436699025616, -12.532086388358252, -695.824776931913, -466.7342140668543, -196.14896909227835, -1123.4401987999408, -1321.5088806395847, -54.16227018744625, -47.43755095299343, -82.38253473962406, -1290.3816196184462, -767.7640286169507, -683.6236636965799, -305.317126267541, -349.13485653032666, -87.42076507002479, -26.188360892436005, -545.4976828345216, -99.02135287458209, -189.31535395349582, -1385.587150557185, -1145.3727144905786, -88.38374082663978, -236.32655977499152, -352.35482237540447, -92.7732653955449, -1085.3755811320987, -21.500972764501995, -107.22957279879039, -1155.8853153861583, -82.26214565975931, -75.6939513636277, -697.4225888505314, -1068.6196626031362, -839.4348854405654, -792.2142701535759, -947.7981594198159, -416.34142659637155, -64.39232797497739, -68.2532452989129, -676.6530134035914, -424.4797309014208, -482.64324159182524, -939.8159229999585]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.542114987940165, "mean_inference_ms": 1.720038500891157, "mean_action_processing_ms": 0.8017483874365943, "mean_env_wait_ms": 10.30820211835397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013519287109375, "StateBufferConnector_ms": 0.009570121765136719, "ViewRequirementAgentConnector_ms": 0.3231658935546875}, "num_episodes": 25, "episode_return_max": -749.5424122560762, "episode_return_min": -4596.972441450198, "episode_return_mean": -2407.528906832578, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1432090, "num_agent_steps_trained": 1432090, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.95180288875197, "num_env_steps_trained_throughput_per_sec": 79.95180288875197, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1432090, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1432090, "timers": {"training_iteration_time_ms": 46113.121, "restore_workers_time_ms": 0.024, "training_step_time_ms": 46113.057, "sample_time_ms": 3220.455, "learn_time_ms": 42837.092, "learn_throughput": 93.377, "synch_weights_time_ms": 52.779}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1432090, "num_agent_steps_trained": 1432090}, "done": false, "training_iteration": 82, "trial_id": "05c72_00000", "date": "2024-07-26_15-49-55", "timestamp": 1721989195, "time_this_iter_s": 50.03912854194641, "time_total_s": 4013.2037918567657, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd014af80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4013.2037918567657, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 11.64225352112676, "ram_util_percent": 30.273239436619725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 125.74388728228034, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.623322552920004, "policy_loss": -0.004277978153316935, "vf_loss": 4.644167767815504, "vf_explained_var": 0.9867730584717536, "kl": 0.014557827349201096, "entropy": 2.762208630564293, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.75193798449612, "num_grad_updates_lifetime": 338805.5, "diff_num_grad_updates_vs_sampler_policy": 1934.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1448570, "num_agent_steps_trained": 1448570}, "env_runners": {"episode_reward_max": -743.8831751290184, "episode_reward_min": -4596.972441450198, "episode_reward_mean": -2425.404155455114, "episode_len_mean": 146.68, "episode_media": {}, "episodes_timesteps_total": 14668, "policy_reward_min": {"policy_0": -1417.2202398097465}, "policy_reward_max": {"policy_0": 8.939850134629456}, "policy_reward_mean": {"policy_0": -485.0808310910228}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1469.2182304607018, -1140.653279579078, -2495.204390257857, -4596.972441450198, -1873.1781912977187, -3415.0711109617905, -1388.6900091649143, -2164.8906337129315, -2717.156350064499, -2606.117793288689, -3681.9063706770426, -3669.084385399848, -1205.1191694681218, -749.5424122560762, -2387.9637889331893, -3044.9426761779814, -2925.7852701169504, -2187.5077238417434, -2340.158935640217, -2591.3633800826383, -855.8914344254931, -1211.409880323682, -1931.434319721205, -2855.406910769288, -3316.3822911262255, -3180.5086428608597, -3579.8842045047777, -2120.751512435235, -2126.425878837012, -2372.246085230003, -2657.9380453034196, -2501.635560525023, -3009.512303866327, -2536.573922880589, -3054.2710672464796, -2031.9807843173237, -3004.557585251678, -3295.0701597524503, -1512.069495449768, -2373.1111864588224, -2632.8357039374123, -2601.05248404876, -2186.4111904810748, -1099.1939718488522, -2435.7659147275654, -1811.308883574, -1719.288096519934, -4365.873979223657, -2097.294021163272, -2820.656853250435, -2030.4643437532718, -1614.6874299779813, -2855.943920515082, -3206.267735367684, -2184.271522850701, -2147.3953644985354, -3732.3936866572635, -2692.238554026424, -1909.1381224952129, -2994.502452170676, -1549.682702003673, -1984.8147233694583, -2742.697869672244, -3129.4689729391453, -1107.2630182018916, -3044.985519602891, -1659.2342144663405, -3079.883663863213, -3060.181069585304, -2591.8451541957083, -1769.7008898275076, -743.8831751290184, -2855.3824548717303, -3463.290633684863, -3164.5887100577643, -2399.293813832064, -3149.085928674591, -2036.237447512052, -3446.782879262511, -1759.2930811381339, -2282.2710773005083, -2319.989271113393, -1580.2333340896666, -2549.376681624757, -1090.4843199273469, -3072.9787492580795, -2271.058790104816, -832.5770623063, -3174.273873323409, -2543.7384550351912, -3095.4299897139335, -4029.725002940949, -2484.0764333244356, -2274.3360178711055, -1114.3703115235855, -2334.5415156297368, -1894.0911958379872, -1769.7411325650812, -3407.9678904591933, -2366.986474466155], "episode_lengths": [150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 122, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-994.5359322888611, -181.91757756199442, -56.02277893756166, -156.87055228254007, -79.87138938974465, -70.80071555835278, -285.6859982313347, -59.83227132632998, -424.77359865189857, -299.5606958111622, -129.33902925697083, -243.2114639650721, -645.433252988479, -786.2991372554869, -690.9215067918434, -689.4638328196405, -918.1825753003167, -1231.037274364914, -1024.900934593514, -733.3878243718154, -31.189298772587886, -813.0585143975026, -732.8151266278866, -190.38056056916858, -105.7346909305728, -759.0585280651727, -65.29951799312578, -544.807073377673, -869.1751796599659, -1176.7308118658527, -315.15000834612067, -24.35541791213543, -321.7711430989931, -604.066010045978, -123.34742976168728, -69.15145021404787, -843.9900544589082, -222.4111246827989, -369.40772108772165, -659.9302832694551, -944.6597879956963, -507.5706356487266, -6.425871007180056, -1136.2914208832058, -122.20863452968806, -828.2597754252278, -466.41173057017556, -582.9886459974668, -29.179143820573312, -699.278497475244, -882.6626950279978, -1038.8667558778907, -942.0654104533781, -496.41278324180246, -321.89872607597044, -1140.124011690991, -476.54605963803584, -717.30736355829, -367.00339216258413, -968.1035583499462, -218.7818717662184, -86.20674640054963, -23.235278989239404, -664.3485512365991, -212.5467210755153, -252.48849028032484, -245.20576172902986, -53.98121346138665, -72.87048251032745, -124.99646427500737, -675.7470670874992, -496.9242466229019, -859.2618848222033, -142.73852417726076, -213.2920662233227, -1125.3115969828464, -87.97384944733237, -474.1409063039394, -381.62468488850175, -975.8916385553598, -313.9481551713319, -205.9604506552651, -1048.8212149979645, -863.0546629542237, -494.000786338167, -632.6615910338846, -570.3920930784374, -490.8760985501508, -381.4112800504102, -112.166661128859, -658.6984253900517, -633.2165802891838, -82.09057536113903, -912.6867379278651, -53.466616671976524, -253.7553086833572, -218.20535287830296, -153.54736573359747, -978.192223564513, -987.6631292228685, -67.31479258386364, -436.56121001675655, -138.08016479071446, -152.09330381469368, -61.841963219464475, -35.06636203917079, -191.04939882058, -79.51522870534619, -322.1627012841595, -583.6161894744268, -432.84819380217215, -203.94982313047126, -269.5650733278524, -601.7324953059574, -423.3387341547517, -46.56883258033425, -983.4953357393618, -554.6923451295422, -437.2781791635389, -833.3722181565117, -1124.1372659643998, -59.36217589141995, -939.2392000063285, -607.4201304457346, -586.223518818343, -409.9155059461264, -647.334478126408, -967.0098149692237, -699.5909033075397, -456.65794051156286, -550.4332995497513, -224.46709458074437, -845.5474322665199, -899.183598803808, -1060.2527793039512, -302.36568062305497, -345.15097401190184, -786.036020194758, -599.305567229066, -87.89327037645381, -462.5555292641476, -575.3952758957001, -413.59110138006247, -104.29538349333978, -570.5885888037627, -830.4729282830826, -555.8031506032561, -727.9897489623618, -103.39181516720627, -154.5884422140962, -190.4388165112596, -604.7229840032774, -759.484927286598, -867.8057343505562, -235.4855831517272, -146.27913400219018, -133.8231284057732, -629.7291900197525, -897.7294132310991, -694.0746948662097, -593.7058681954767, -840.7974374263954, -757.4828466966751, -29.175320352392358, -788.3508311953856, -1190.6347936236923, -364.4523178374612, -26.51349837277249, -236.81107382856658, -718.1622392180959, -1114.1649637584994, -1088.6329226199107, -143.5777369657012, -318.6933310451295, -389.2021128572374, -677.6196081853346, -554.8822929905525, -579.6996609256855, -140.80106979487428, -78.97815242087592, -958.7020260473608, -1069.9230606069998, -437.0811116725786, -216.05573217422003, -322.79565475051794, -312.0451762874677, -1095.4460175450508, -821.4884685835841, -1036.7943696310765, -29.29612770527118, -107.45882932974257, -608.9120210785121, -351.0359863250141, -355.77340106131726, -88.88925765518033, -429.1781295749507, -276.45755305169865, -1319.5928679354456, -72.20319982970449, -275.6794360670238, -976.1375601122016, -840.0088704555078, -499.9577602861962, -269.49474245085185, -47.23677063265485, -741.1098412122292, -530.3187129332563, -156.26324784048774, -930.3152421296231, -243.0454399331649, -1212.5419431162225, -315.93613531479923, -214.9550094804272, -237.73239212948837, -205.2457104401374, -112.48315682525553, -72.72613135870854, -205.69595746357803, -663.231954964767, -45.05677123654345, -691.1093125279818, -497.54529999788645, -51.44426162077401, -706.3500513130864, -489.31698926783804, -992.9619195751181, 8.939850134629456, -655.2673264549384, -103.76872492535905, -68.25076275321273, -23.09385728537565, -400.4108988361599, -620.4000258144168, -130.76619179582983, -544.6171227881523, -305.09955979003496, -740.3777144213403, -1255.6071697040943, -1311.162367508437, -753.6271677997505, -51.05383300844648, -902.7710842845049, -85.76141764810666, -91.10608618003087, -966.6016000421837, -60.701321333726796, -400.91919042803295, -52.87536703931957, -1280.141701841854, -1026.0192726074988, -676.1945541813718, -450.39529646117126, -353.7181018023349, -417.26324655103656, -132.89314475735702, -616.8421659057952, -714.9757119453637, -63.43129819495893, -50.52449936983533, -168.9137545620283, -210.23121040130115, -202.89529719342187, -1114.3024529867669, -1176.9837248114038, -151.5312351221881, -1307.0679366481897, -495.25802108174264, -178.70586468623497, -408.34731862943164, -816.8885943220904, -338.77642216406645, -420.4970343658038, -562.7373203496479, -344.3555700695035, -517.9051759016778, -387.39486022300747, -442.852505698327, -129.92202796530657, -927.678215925143, -259.5477546867507, -247.22813722061383, -1240.411492431275, -157.7726853265992, -822.2716657783421, -1264.7097059004327, -758.8913721133817, -170.37505996519033, -1197.521284217293, -80.98212305522425, -484.46871467533407, -41.0602820834425, -546.279091390632, -635.9009995327696, -26.819898705990287, -659.0778507823788, -1213.2471300555871, -490.8939208375349, -811.289486355672, -127.24539486146413, -351.8265200604165, -677.1903177831031, -39.34874440248938, -445.6836154043852, -242.0936210966578, -145.36640331703717, -139.57997607977126, -670.1436699025616, -12.532086388358252, -695.824776931913, -466.7342140668543, -196.14896909227835, -1123.4401987999408, -1321.5088806395847, -54.16227018744625, -47.43755095299343, -82.38253473962406, -1290.3816196184462, -767.7640286169507, -683.6236636965799, -305.317126267541, -349.13485653032666, -87.42076507002479, -26.188360892436005, -545.4976828345216, -99.02135287458209, -189.31535395349582, -1385.587150557185, -1145.3727144905786, -88.38374082663978, -236.32655977499152, -352.35482237540447, -92.7732653955449, -1085.3755811320987, -21.500972764501995, -107.22957279879039, -1155.8853153861583, -82.26214565975931, -75.6939513636277, -697.4225888505314, -1068.6196626031362, -839.4348854405654, -792.2142701535759, -947.7981594198159, -416.34142659637155, -64.39232797497739, -68.2532452989129, -676.6530134035914, -424.4797309014208, -482.64324159182524, -939.8159229999585, -53.77248034198131, -150.40906816657557, -371.04428483203844, -102.06652429064066, -1092.4085321962714, -198.6651459112755, -153.5659723602547, -73.56472393574087, -147.1283074066061, -170.9590255151413, -538.619631152633, -684.4133437000563, -192.86078060335768, -1402.399687127413, -37.08901228827037, -393.6205592279693, -1087.3526306596277, -489.9000265113198, -707.8351643160539, -784.5822529698952, -1068.1408492228022, -194.25169969942954, -65.34948655263457, -972.3104283504153, -864.5362462324807, -736.0563398264089, -809.629724207079, -304.7197707339257, -431.35038173662525, -117.5375973280238, -699.6236464368593, -576.8501785481835, -803.9831314723928, -383.10512906373305, -685.5238431534247, -622.4219020031287, -724.633282843702, -589.3056130385771, -15.194576235828636, -84.68207339081609, -921.2099156516234, -137.47571328320808, -1103.2945525602331, -510.20374698221394, -774.5989507852343, -241.56888623346447, -91.78430311543767, -540.687107083644, -807.4157580588543, -77.83702664673235, -6.564720595512334, -210.30996170634216, -885.4426905871304, -1001.9487551805944, -178.004949230929, -125.78016549522442, -395.92765863692875, -1039.1346123684968, -677.9008531763336, -81.2459814364087, -89.39331668120738, -1197.5264551855037, -152.5645179304908, -34.82086295993458, -105.92818133252963, -290.14814413400364, -171.4162296576624, -478.9763418822043, -860.4386230580831, -748.3973428928019, -101.2106935576171, -303.93889933152377, -395.24466191945413, -124.80339653430921, -165.28666858444308, -1339.78238425226, -503.15891111400435, -17.026677107721518, -497.0383081215415, -715.9724686625525, -706.4659072027317, -77.59085667625644, -253.93306083882982, -734.2353532936137, -498.8336120933849, -345.94192153949155, -289.6233468164806, -42.154873928215885, -95.57862529226011, -59.27829472985208, -829.2084498973445, -701.1367551419116, -610.8595354598303, -603.7793460773454, -429.2897867469822, -685.245851441181, -480.2769040966071, -241.8325468290331, -1120.9407471446393, -15.442405523730772, -146.39172816943918, -718.9875816334849, -640.0975141738098, -983.1265565291233, -606.826609208076, -126.06463723510777, -61.5369528756144, -1291.868073709345, -1133.0350993111329, -1417.2202398097465, -105.31972139713473, -433.23132239420863, -1260.4732255260801, -546.1237649711553, -138.9283990358591, -378.7611480091668, -25.68600238258427, -857.960021827403, -50.11892631259574, -961.8099193393558, -299.5452326177543, -234.99071432537258, -98.62110899466056, -33.94172050130128, -447.27153508449646, -93.51634043665966, -764.7268349186267, -231.35721972776645, -509.1546285887706, -735.7864919579121, -36.6481543244279, -350.0435486239228, -72.85671103691962, -1249.3350644221787, -185.20771743053803, -1065.032798607586, -221.45046747158293, -276.41638070058735, -30.198048185589904, -176.64343759973443, -1073.872763607058, -953.5219914782284, -1078.9993793899855, -175.74729734301053, -125.82645864090657, -489.39777221241496, -41.68063956178105, -1374.5170235821458, -59.56921744482169, -401.82182166499047]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5402031401030425, "mean_inference_ms": 1.7200219553646416, "mean_action_processing_ms": 0.8011323335980549, "mean_env_wait_ms": 10.300921769578043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013292789459228516, "StateBufferConnector_ms": 0.009549617767333984, "ViewRequirementAgentConnector_ms": 0.3257598876953125}, "num_episodes": 30, "episode_return_max": -743.8831751290184, "episode_return_min": -4596.972441450198, "episode_return_mean": -2425.404155455114, "episodes_this_iter": 30}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1448570, "num_agent_steps_trained": 1448570, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.86507251045018, "num_env_steps_trained_throughput_per_sec": 82.86507251045018, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1448570, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1448570, "timers": {"training_iteration_time_ms": 45885.22, "restore_workers_time_ms": 0.023, "training_step_time_ms": 45885.156, "sample_time_ms": 3233.029, "learn_time_ms": 42596.153, "learn_throughput": 93.905, "synch_weights_time_ms": 53.26}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1448570, "num_agent_steps_trained": 1448570}, "done": false, "training_iteration": 83, "trial_id": "05c72_00000", "date": "2024-07-26_15-50-43", "timestamp": 1721989243, "time_this_iter_s": 48.2809317111969, "time_total_s": 4061.4847235679626, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00de5f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4061.4847235679626, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 11.378260869565215, "ram_util_percent": 30.220289855072462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.42411517544069, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000007, "total_loss": 4.903979926120832, "policy_loss": 0.00146076669410357, "vf_loss": 4.916045134309409, "vf_explained_var": 0.9758490932304502, "kl": 0.016345758036235662, "entropy": 2.5938541149459597, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.20289855072464, "num_grad_updates_lifetime": 342810.5, "diff_num_grad_updates_vs_sampler_policy": 2069.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1466124, "num_agent_steps_trained": 1466124}, "env_runners": {"episode_reward_max": -727.4322606572557, "episode_reward_min": -4365.873979223657, "episode_reward_mean": -2410.0684470666292, "episode_len_mean": 146.44, "episode_media": {}, "episodes_timesteps_total": 14644, "policy_reward_min": {"policy_0": -1417.2202398097465}, "policy_reward_max": {"policy_0": 8.939850134629456}, "policy_reward_mean": {"policy_0": -482.01368941332584}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2126.425878837012, -2372.246085230003, -2657.9380453034196, -2501.635560525023, -3009.512303866327, -2536.573922880589, -3054.2710672464796, -2031.9807843173237, -3004.557585251678, -3295.0701597524503, -1512.069495449768, -2373.1111864588224, -2632.8357039374123, -2601.05248404876, -2186.4111904810748, -1099.1939718488522, -2435.7659147275654, -1811.308883574, -1719.288096519934, -4365.873979223657, -2097.294021163272, -2820.656853250435, -2030.4643437532718, -1614.6874299779813, -2855.943920515082, -3206.267735367684, -2184.271522850701, -2147.3953644985354, -3732.3936866572635, -2692.238554026424, -1909.1381224952129, -2994.502452170676, -1549.682702003673, -1984.8147233694583, -2742.697869672244, -3129.4689729391453, -1107.2630182018916, -3044.985519602891, -1659.2342144663405, -3079.883663863213, -3060.181069585304, -2591.8451541957083, -1769.7008898275076, -743.8831751290184, -2855.3824548717303, -3463.290633684863, -3164.5887100577643, -2399.293813832064, -3149.085928674591, -2036.237447512052, -3446.782879262511, -1759.2930811381339, -2282.2710773005083, -2319.989271113393, -1580.2333340896666, -2549.376681624757, -1090.4843199273469, -3072.9787492580795, -2271.058790104816, -832.5770623063, -3174.273873323409, -2543.7384550351912, -3095.4299897139335, -4029.725002940949, -2484.0764333244356, -2274.3360178711055, -1114.3703115235855, -2334.5415156297368, -1894.0911958379872, -1769.7411325650812, -3407.9678904591933, -2366.986474466155, -2057.9572993664465, -2652.652983143635, -1845.434746053287, -1378.2319104811056, -3787.5415065705542, -2966.1488783082373, -4203.735456697258, -1689.2378692761856, -2881.060774942778, -2509.567470418399, -3270.6508198641227, -1929.3876019851393, -2279.411616980586, -2497.277452200643, -2116.9980424780365, -4032.1044505802483, -3862.959802369984, -2329.1660811790625, -828.8568690328693, -1816.08807688135, -2234.556367500326, -1737.574737750633, -3449.3777858074764, -1257.1530127601095, -2060.4362766426643, -727.4322606572557, -1989.9574133723847, -1777.6673368497322], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 122, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 136, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 85, 150, 139], "policy_policy_0_reward": [-462.5555292641476, -575.3952758957001, -413.59110138006247, -104.29538349333978, -570.5885888037627, -830.4729282830826, -555.8031506032561, -727.9897489623618, -103.39181516720627, -154.5884422140962, -190.4388165112596, -604.7229840032774, -759.484927286598, -867.8057343505562, -235.4855831517272, -146.27913400219018, -133.8231284057732, -629.7291900197525, -897.7294132310991, -694.0746948662097, -593.7058681954767, -840.7974374263954, -757.4828466966751, -29.175320352392358, -788.3508311953856, -1190.6347936236923, -364.4523178374612, -26.51349837277249, -236.81107382856658, -718.1622392180959, -1114.1649637584994, -1088.6329226199107, -143.5777369657012, -318.6933310451295, -389.2021128572374, -677.6196081853346, -554.8822929905525, -579.6996609256855, -140.80106979487428, -78.97815242087592, -958.7020260473608, -1069.9230606069998, -437.0811116725786, -216.05573217422003, -322.79565475051794, -312.0451762874677, -1095.4460175450508, -821.4884685835841, -1036.7943696310765, -29.29612770527118, -107.45882932974257, -608.9120210785121, -351.0359863250141, -355.77340106131726, -88.88925765518033, -429.1781295749507, -276.45755305169865, -1319.5928679354456, -72.20319982970449, -275.6794360670238, -976.1375601122016, -840.0088704555078, -499.9577602861962, -269.49474245085185, -47.23677063265485, -741.1098412122292, -530.3187129332563, -156.26324784048774, -930.3152421296231, -243.0454399331649, -1212.5419431162225, -315.93613531479923, -214.9550094804272, -237.73239212948837, -205.2457104401374, -112.48315682525553, -72.72613135870854, -205.69595746357803, -663.231954964767, -45.05677123654345, -691.1093125279818, -497.54529999788645, -51.44426162077401, -706.3500513130864, -489.31698926783804, -992.9619195751181, 8.939850134629456, -655.2673264549384, -103.76872492535905, -68.25076275321273, -23.09385728537565, -400.4108988361599, -620.4000258144168, -130.76619179582983, -544.6171227881523, -305.09955979003496, -740.3777144213403, -1255.6071697040943, -1311.162367508437, -753.6271677997505, -51.05383300844648, -902.7710842845049, -85.76141764810666, -91.10608618003087, -966.6016000421837, -60.701321333726796, -400.91919042803295, -52.87536703931957, -1280.141701841854, -1026.0192726074988, -676.1945541813718, -450.39529646117126, -353.7181018023349, -417.26324655103656, -132.89314475735702, -616.8421659057952, -714.9757119453637, -63.43129819495893, -50.52449936983533, -168.9137545620283, -210.23121040130115, -202.89529719342187, -1114.3024529867669, -1176.9837248114038, -151.5312351221881, -1307.0679366481897, -495.25802108174264, -178.70586468623497, -408.34731862943164, -816.8885943220904, -338.77642216406645, -420.4970343658038, -562.7373203496479, -344.3555700695035, -517.9051759016778, -387.39486022300747, -442.852505698327, -129.92202796530657, -927.678215925143, -259.5477546867507, -247.22813722061383, -1240.411492431275, -157.7726853265992, -822.2716657783421, -1264.7097059004327, -758.8913721133817, -170.37505996519033, -1197.521284217293, -80.98212305522425, -484.46871467533407, -41.0602820834425, -546.279091390632, -635.9009995327696, -26.819898705990287, -659.0778507823788, -1213.2471300555871, -490.8939208375349, -811.289486355672, -127.24539486146413, -351.8265200604165, -677.1903177831031, -39.34874440248938, -445.6836154043852, -242.0936210966578, -145.36640331703717, -139.57997607977126, -670.1436699025616, -12.532086388358252, -695.824776931913, -466.7342140668543, -196.14896909227835, -1123.4401987999408, -1321.5088806395847, -54.16227018744625, -47.43755095299343, -82.38253473962406, -1290.3816196184462, -767.7640286169507, -683.6236636965799, -305.317126267541, -349.13485653032666, -87.42076507002479, -26.188360892436005, -545.4976828345216, -99.02135287458209, -189.31535395349582, -1385.587150557185, -1145.3727144905786, -88.38374082663978, -236.32655977499152, -352.35482237540447, -92.7732653955449, -1085.3755811320987, -21.500972764501995, -107.22957279879039, -1155.8853153861583, -82.26214565975931, -75.6939513636277, -697.4225888505314, -1068.6196626031362, -839.4348854405654, -792.2142701535759, -947.7981594198159, -416.34142659637155, -64.39232797497739, -68.2532452989129, -676.6530134035914, -424.4797309014208, -482.64324159182524, -939.8159229999585, -53.77248034198131, -150.40906816657557, -371.04428483203844, -102.06652429064066, -1092.4085321962714, -198.6651459112755, -153.5659723602547, -73.56472393574087, -147.1283074066061, -170.9590255151413, -538.619631152633, -684.4133437000563, -192.86078060335768, -1402.399687127413, -37.08901228827037, -393.6205592279693, -1087.3526306596277, -489.9000265113198, -707.8351643160539, -784.5822529698952, -1068.1408492228022, -194.25169969942954, -65.34948655263457, -972.3104283504153, -864.5362462324807, -736.0563398264089, -809.629724207079, -304.7197707339257, -431.35038173662525, -117.5375973280238, -699.6236464368593, -576.8501785481835, -803.9831314723928, -383.10512906373305, -685.5238431534247, -622.4219020031287, -724.633282843702, -589.3056130385771, -15.194576235828636, -84.68207339081609, -921.2099156516234, -137.47571328320808, -1103.2945525602331, -510.20374698221394, -774.5989507852343, -241.56888623346447, -91.78430311543767, -540.687107083644, -807.4157580588543, -77.83702664673235, -6.564720595512334, -210.30996170634216, -885.4426905871304, -1001.9487551805944, -178.004949230929, -125.78016549522442, -395.92765863692875, -1039.1346123684968, -677.9008531763336, -81.2459814364087, -89.39331668120738, -1197.5264551855037, -152.5645179304908, -34.82086295993458, -105.92818133252963, -290.14814413400364, -171.4162296576624, -478.9763418822043, -860.4386230580831, -748.3973428928019, -101.2106935576171, -303.93889933152377, -395.24466191945413, -124.80339653430921, -165.28666858444308, -1339.78238425226, -503.15891111400435, -17.026677107721518, -497.0383081215415, -715.9724686625525, -706.4659072027317, -77.59085667625644, -253.93306083882982, -734.2353532936137, -498.8336120933849, -345.94192153949155, -289.6233468164806, -42.154873928215885, -95.57862529226011, -59.27829472985208, -829.2084498973445, -701.1367551419116, -610.8595354598303, -603.7793460773454, -429.2897867469822, -685.245851441181, -480.2769040966071, -241.8325468290331, -1120.9407471446393, -15.442405523730772, -146.39172816943918, -718.9875816334849, -640.0975141738098, -983.1265565291233, -606.826609208076, -126.06463723510777, -61.5369528756144, -1291.868073709345, -1133.0350993111329, -1417.2202398097465, -105.31972139713473, -433.23132239420863, -1260.4732255260801, -546.1237649711553, -138.9283990358591, -378.7611480091668, -25.68600238258427, -857.960021827403, -50.11892631259574, -961.8099193393558, -299.5452326177543, -234.99071432537258, -98.62110899466056, -33.94172050130128, -447.27153508449646, -93.51634043665966, -764.7268349186267, -231.35721972776645, -509.1546285887706, -735.7864919579121, -36.6481543244279, -350.0435486239228, -72.85671103691962, -1249.3350644221787, -185.20771743053803, -1065.032798607586, -221.45046747158293, -276.41638070058735, -30.198048185589904, -176.64343759973443, -1073.872763607058, -953.5219914782284, -1078.9993793899855, -175.74729734301053, -125.82645864090657, -489.39777221241496, -41.68063956178105, -1374.5170235821458, -59.56921744482169, -401.82182166499047, -19.24604212814381, -63.43520193612549, -65.3455876693527, -903.5762758175024, -1006.3541918153212, -468.0878201504209, -163.4311019324466, -668.779099635729, -169.89395849276258, -1182.461002932275, -61.71706341450638, -248.09684302666963, -564.3839235437958, -248.9628703698141, -722.2740456985014, -89.88123248307978, -279.935386013834, -174.61149575561345, -728.2677107273519, -105.53608550122743, -413.50471898017986, -1075.7136398766054, -375.30417857324966, -1306.3031426800871, -616.7158264604345, -558.2345957867484, -929.5214940111404, -666.1069432606625, -175.78362997362723, -636.5022152760598, -1342.3782423378916, -746.4236612895785, -493.96450414094454, -277.2690818623825, -1343.699967066459, -165.10811327750568, -609.2069337085342, -669.9292474567709, -184.18448736224016, -60.80908747113487, -20.4728532967711, -770.0596195721953, -792.7208655647335, -843.1039770310598, -454.7034594780137, -440.32553222734896, -1275.0652097539878, -45.8006748152487, -680.8768525575599, -67.49920106425712, -871.7171834762562, -708.7176296314112, -252.63114608586372, -924.9846276263445, -512.6002330442492, -627.8944400002216, -244.89677075988982, -226.12366566377858, -35.31062054570027, -795.1621050155483, -80.86277121447098, -1289.4195819493605, -740.877481873959, -102.1225323052435, -66.12924963754958, -241.3980923343303, -904.3930200208614, -273.6705569454665, -810.0793618286502, -267.73642107133486, -243.47658558891268, -86.12218516715106, -909.6228576162866, -746.7987266204013, -130.97768748528475, -1224.549009870722, -1124.7241760543277, -850.6582402832533, -321.1266619020443, -511.0463624699008, -1050.113069597868, -617.7218446919294, -356.9729020601024, -1125.332038669757, -712.8199473503265, -101.19322482533613, -186.10039280364214, -309.4972708256631, -1343.941101792611, -388.43409093181185, -144.26764749149038, -269.6114194428666, -34.9282929019562, -98.00429342271818, -282.0452157738385, -216.07711444763817, -295.817123448547, -11.035526203956643, -283.2826227358406, -1009.8756900453672, -135.97722467651727, -906.3029235112086, -399.651972649267, -87.9116640495107, -704.712582613824, -513.1678660319859, -126.90712045658162, -111.18814896826069, -40.10645050739267, -946.2051517864114, -554.4560219663488, -22.20934285700621, -1114.1841592147218, -721.5142038262222, -1037.0140579431788, -235.71628413722433, -107.02055133185115, -820.9874463085386, -27.556690172246892, -65.87204081024906, -154.04539206271372, -1164.303427595465, -364.7346965460445, -28.763215971878896, -348.5895444665623, -18.593149082605382, -15.211017620511027, -131.55864458238037, -306.19750392083023, -255.8719454509282, -903.4835414577784, -696.6185174448074, -97.42542635507408, -152.3975487935328, -140.03237932119242, -200.51511868529272, -255.05754017449897, -770.1654155453623, -169.669714186005, -382.2595482585715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5396419631199905, "mean_inference_ms": 1.7193071663596746, "mean_action_processing_ms": 0.8000154271143721, "mean_env_wait_ms": 10.289507833829663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012526512145996094, "StateBufferConnector_ms": 0.009274482727050781, "ViewRequirementAgentConnector_ms": 0.3112156391143799}, "num_episodes": 28, "episode_return_max": -727.4322606572557, "episode_return_min": -4365.873979223657, "episode_return_mean": -2410.0684470666292, "episodes_this_iter": 28}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1466124, "num_agent_steps_trained": 1466124, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.14855901664164, "num_env_steps_trained_throughput_per_sec": 77.14855901664164, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1466124, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1466124, "timers": {"training_iteration_time_ms": 46417.476, "restore_workers_time_ms": 0.023, "training_step_time_ms": 46417.412, "sample_time_ms": 3252.067, "learn_time_ms": 43110.734, "learn_throughput": 92.784, "synch_weights_time_ms": 51.924}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1466124, "num_agent_steps_trained": 1466124}, "done": false, "training_iteration": 84, "trial_id": "05c72_00000", "date": "2024-07-26_15-51-35", "timestamp": 1721989295, "time_this_iter_s": 51.858153343200684, "time_total_s": 4113.342876911163, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd0148040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4113.342876911163, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 11.258904109589041, "ram_util_percent": 30.199999999999992}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 114.26714895541852, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.692574897973965, "policy_loss": -0.0014784564886492892, "vf_loss": 4.709009078527108, "vf_explained_var": 0.9775358005517568, "kl": 0.01564307138892428, "entropy": 2.6834676326238194, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.87692307692308, "num_grad_updates_lifetime": 346830.5, "diff_num_grad_updates_vs_sampler_policy": 1949.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1482748, "num_agent_steps_trained": 1482748}, "env_runners": {"episode_reward_max": -727.4322606572557, "episode_reward_min": -4367.523091719134, "episode_reward_mean": -2405.6598787067237, "episode_len_mean": 146.94, "episode_media": {}, "episodes_timesteps_total": 14694, "policy_reward_min": {"policy_0": -1474.763033386571}, "policy_reward_max": {"policy_0": -2.595555226307069}, "policy_reward_mean": {"policy_0": -481.1319757413447}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2855.943920515082, -3206.267735367684, -2184.271522850701, -2147.3953644985354, -3732.3936866572635, -2692.238554026424, -1909.1381224952129, -2994.502452170676, -1549.682702003673, -1984.8147233694583, -2742.697869672244, -3129.4689729391453, -1107.2630182018916, -3044.985519602891, -1659.2342144663405, -3079.883663863213, -3060.181069585304, -2591.8451541957083, -1769.7008898275076, -743.8831751290184, -2855.3824548717303, -3463.290633684863, -3164.5887100577643, -2399.293813832064, -3149.085928674591, -2036.237447512052, -3446.782879262511, -1759.2930811381339, -2282.2710773005083, -2319.989271113393, -1580.2333340896666, -2549.376681624757, -1090.4843199273469, -3072.9787492580795, -2271.058790104816, -832.5770623063, -3174.273873323409, -2543.7384550351912, -3095.4299897139335, -4029.725002940949, -2484.0764333244356, -2274.3360178711055, -1114.3703115235855, -2334.5415156297368, -1894.0911958379872, -1769.7411325650812, -3407.9678904591933, -2366.986474466155, -2057.9572993664465, -2652.652983143635, -1845.434746053287, -1378.2319104811056, -3787.5415065705542, -2966.1488783082373, -4203.735456697258, -1689.2378692761856, -2881.060774942778, -2509.567470418399, -3270.6508198641227, -1929.3876019851393, -2279.411616980586, -2497.277452200643, -2116.9980424780365, -4032.1044505802483, -3862.959802369984, -2329.1660811790625, -828.8568690328693, -1816.08807688135, -2234.556367500326, -1737.574737750633, -3449.3777858074764, -1257.1530127601095, -2060.4362766426643, -727.4322606572557, -1989.9574133723847, -1777.6673368497322, -1598.0336936794965, -2776.2854279760327, -2615.4581901478755, -2746.6300018419415, -1877.7535833949562, -2186.6726565542012, -3157.3549031032176, -1673.490540673708, -2355.641158900278, -2816.2653473589135, -1335.1547121576286, -2489.910896018448, -2137.0758806486165, -4367.523091719134, -2501.8665644471316, -3128.5193824526255, -1859.958527999292, -2630.4457370883856, -3262.3966420154316, -2819.974306975167, -979.4008131122358, -2853.9901086487903, -2291.198402236467, -988.3675424845636], "episode_lengths": [150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 122, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 136, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 85, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-210.23121040130115, -202.89529719342187, -1114.3024529867669, -1176.9837248114038, -151.5312351221881, -1307.0679366481897, -495.25802108174264, -178.70586468623497, -408.34731862943164, -816.8885943220904, -338.77642216406645, -420.4970343658038, -562.7373203496479, -344.3555700695035, -517.9051759016778, -387.39486022300747, -442.852505698327, -129.92202796530657, -927.678215925143, -259.5477546867507, -247.22813722061383, -1240.411492431275, -157.7726853265992, -822.2716657783421, -1264.7097059004327, -758.8913721133817, -170.37505996519033, -1197.521284217293, -80.98212305522425, -484.46871467533407, -41.0602820834425, -546.279091390632, -635.9009995327696, -26.819898705990287, -659.0778507823788, -1213.2471300555871, -490.8939208375349, -811.289486355672, -127.24539486146413, -351.8265200604165, -677.1903177831031, -39.34874440248938, -445.6836154043852, -242.0936210966578, -145.36640331703717, -139.57997607977126, -670.1436699025616, -12.532086388358252, -695.824776931913, -466.7342140668543, -196.14896909227835, -1123.4401987999408, -1321.5088806395847, -54.16227018744625, -47.43755095299343, -82.38253473962406, -1290.3816196184462, -767.7640286169507, -683.6236636965799, -305.317126267541, -349.13485653032666, -87.42076507002479, -26.188360892436005, -545.4976828345216, -99.02135287458209, -189.31535395349582, -1385.587150557185, -1145.3727144905786, -88.38374082663978, -236.32655977499152, -352.35482237540447, -92.7732653955449, -1085.3755811320987, -21.500972764501995, -107.22957279879039, -1155.8853153861583, -82.26214565975931, -75.6939513636277, -697.4225888505314, -1068.6196626031362, -839.4348854405654, -792.2142701535759, -947.7981594198159, -416.34142659637155, -64.39232797497739, -68.2532452989129, -676.6530134035914, -424.4797309014208, -482.64324159182524, -939.8159229999585, -53.77248034198131, -150.40906816657557, -371.04428483203844, -102.06652429064066, -1092.4085321962714, -198.6651459112755, -153.5659723602547, -73.56472393574087, -147.1283074066061, -170.9590255151413, -538.619631152633, -684.4133437000563, -192.86078060335768, -1402.399687127413, -37.08901228827037, -393.6205592279693, -1087.3526306596277, -489.9000265113198, -707.8351643160539, -784.5822529698952, -1068.1408492228022, -194.25169969942954, -65.34948655263457, -972.3104283504153, -864.5362462324807, -736.0563398264089, -809.629724207079, -304.7197707339257, -431.35038173662525, -117.5375973280238, -699.6236464368593, -576.8501785481835, -803.9831314723928, -383.10512906373305, -685.5238431534247, -622.4219020031287, -724.633282843702, -589.3056130385771, -15.194576235828636, -84.68207339081609, -921.2099156516234, -137.47571328320808, -1103.2945525602331, -510.20374698221394, -774.5989507852343, -241.56888623346447, -91.78430311543767, -540.687107083644, -807.4157580588543, -77.83702664673235, -6.564720595512334, -210.30996170634216, -885.4426905871304, -1001.9487551805944, -178.004949230929, -125.78016549522442, -395.92765863692875, -1039.1346123684968, -677.9008531763336, -81.2459814364087, -89.39331668120738, -1197.5264551855037, -152.5645179304908, -34.82086295993458, -105.92818133252963, -290.14814413400364, -171.4162296576624, -478.9763418822043, -860.4386230580831, -748.3973428928019, -101.2106935576171, -303.93889933152377, -395.24466191945413, -124.80339653430921, -165.28666858444308, -1339.78238425226, -503.15891111400435, -17.026677107721518, -497.0383081215415, -715.9724686625525, -706.4659072027317, -77.59085667625644, -253.93306083882982, -734.2353532936137, -498.8336120933849, -345.94192153949155, -289.6233468164806, -42.154873928215885, -95.57862529226011, -59.27829472985208, -829.2084498973445, -701.1367551419116, -610.8595354598303, -603.7793460773454, -429.2897867469822, -685.245851441181, -480.2769040966071, -241.8325468290331, -1120.9407471446393, -15.442405523730772, -146.39172816943918, -718.9875816334849, -640.0975141738098, -983.1265565291233, -606.826609208076, -126.06463723510777, -61.5369528756144, -1291.868073709345, -1133.0350993111329, -1417.2202398097465, -105.31972139713473, -433.23132239420863, -1260.4732255260801, -546.1237649711553, -138.9283990358591, -378.7611480091668, -25.68600238258427, -857.960021827403, -50.11892631259574, -961.8099193393558, -299.5452326177543, -234.99071432537258, -98.62110899466056, -33.94172050130128, -447.27153508449646, -93.51634043665966, -764.7268349186267, -231.35721972776645, -509.1546285887706, -735.7864919579121, -36.6481543244279, -350.0435486239228, -72.85671103691962, -1249.3350644221787, -185.20771743053803, -1065.032798607586, -221.45046747158293, -276.41638070058735, -30.198048185589904, -176.64343759973443, -1073.872763607058, -953.5219914782284, -1078.9993793899855, -175.74729734301053, -125.82645864090657, -489.39777221241496, -41.68063956178105, -1374.5170235821458, -59.56921744482169, -401.82182166499047, -19.24604212814381, -63.43520193612549, -65.3455876693527, -903.5762758175024, -1006.3541918153212, -468.0878201504209, -163.4311019324466, -668.779099635729, -169.89395849276258, -1182.461002932275, -61.71706341450638, -248.09684302666963, -564.3839235437958, -248.9628703698141, -722.2740456985014, -89.88123248307978, -279.935386013834, -174.61149575561345, -728.2677107273519, -105.53608550122743, -413.50471898017986, -1075.7136398766054, -375.30417857324966, -1306.3031426800871, -616.7158264604345, -558.2345957867484, -929.5214940111404, -666.1069432606625, -175.78362997362723, -636.5022152760598, -1342.3782423378916, -746.4236612895785, -493.96450414094454, -277.2690818623825, -1343.699967066459, -165.10811327750568, -609.2069337085342, -669.9292474567709, -184.18448736224016, -60.80908747113487, -20.4728532967711, -770.0596195721953, -792.7208655647335, -843.1039770310598, -454.7034594780137, -440.32553222734896, -1275.0652097539878, -45.8006748152487, -680.8768525575599, -67.49920106425712, -871.7171834762562, -708.7176296314112, -252.63114608586372, -924.9846276263445, -512.6002330442492, -627.8944400002216, -244.89677075988982, -226.12366566377858, -35.31062054570027, -795.1621050155483, -80.86277121447098, -1289.4195819493605, -740.877481873959, -102.1225323052435, -66.12924963754958, -241.3980923343303, -904.3930200208614, -273.6705569454665, -810.0793618286502, -267.73642107133486, -243.47658558891268, -86.12218516715106, -909.6228576162866, -746.7987266204013, -130.97768748528475, -1224.549009870722, -1124.7241760543277, -850.6582402832533, -321.1266619020443, -511.0463624699008, -1050.113069597868, -617.7218446919294, -356.9729020601024, -1125.332038669757, -712.8199473503265, -101.19322482533613, -186.10039280364214, -309.4972708256631, -1343.941101792611, -388.43409093181185, -144.26764749149038, -269.6114194428666, -34.9282929019562, -98.00429342271818, -282.0452157738385, -216.07711444763817, -295.817123448547, -11.035526203956643, -283.2826227358406, -1009.8756900453672, -135.97722467651727, -906.3029235112086, -399.651972649267, -87.9116640495107, -704.712582613824, -513.1678660319859, -126.90712045658162, -111.18814896826069, -40.10645050739267, -946.2051517864114, -554.4560219663488, -22.20934285700621, -1114.1841592147218, -721.5142038262222, -1037.0140579431788, -235.71628413722433, -107.02055133185115, -820.9874463085386, -27.556690172246892, -65.87204081024906, -154.04539206271372, -1164.303427595465, -364.7346965460445, -28.763215971878896, -348.5895444665623, -18.593149082605382, -15.211017620511027, -131.55864458238037, -306.19750392083023, -255.8719454509282, -903.4835414577784, -696.6185174448074, -97.42542635507408, -152.3975487935328, -140.03237932119242, -200.51511868529272, -255.05754017449897, -770.1654155453623, -169.669714186005, -382.2595482585715, -101.40649482570937, -553.3078294747783, -226.6025919866502, -671.8835101916862, -44.83326720067364, -392.1250870723409, -221.74904565078003, -210.327278087104, -477.3209837792361, -1474.763033386571, -453.09572787542436, -191.1582213915162, -1083.757994253548, -617.5555328438313, -269.8907137835563, -47.03643577495287, -31.16435060400398, -968.6717967496462, -473.47867419880345, -1226.278744514537, -50.22577853066609, -468.49301979164863, -892.3747858708679, -421.4966750884395, -45.16332411333575, -629.278848362709, -86.92729724549244, -216.20934099876916, -1209.5926048857802, -44.664565061449935, -325.2256451548664, -330.2041816731135, -1032.313971985413, -583.83577616988, -885.7753281199425, -285.3092392202689, -529.4079080588062, -175.66875660796694, -171.71084216236397, -511.3937946243018, -196.54514037943125, -735.1119440288397, -582.0965844948935, -189.04194324639232, -652.8455467507221, -472.9050016380424, -489.1389075536397, -744.4655256636639, -328.1993655013147, -781.5565470022541, -689.1056030102145, -89.22638858063861, -37.34626997126071, -53.81115904855281, -465.6652915469635, -286.4312849747578, -536.0377644589919, -414.61356738872007, -513.7369352470477, -739.0913439489299, -248.48520932907013, -215.77931483157678, -959.4674810303113, -362.96577788238335, -350.37809757527697, -461.2601491578571, -1103.0487337216362, -979.9436957125669, -742.3829390580023, -1080.8875740690683, -386.7303163606392, -562.5650488784376, -1065.4136399700478, -475.3703528378354, -11.787206400171975, -251.9648947907056, -813.2761744100402, -477.370504481458, -1193.4039224328053, -392.50388633761474, -422.2268412824967, -72.3449338240222, -1316.2416730815632, -46.54952458490315, -2.595555226307069, -373.1333332499419, -648.0899679454474, -46.81953152905094, -855.7875389369555, -706.6153654269897, -1267.817013917905, -219.46585665063458, -171.77629929740385, -1032.2617705948685, -571.0757015546191, -887.3873983596104, -799.1341344862973, -226.21637679658392, -412.48247876171786, -494.7539185709582, -634.7029842296262, -107.05186828428403, -44.139671187337974, -123.76979491934964, -69.73649449163823, -356.16767659446504, -325.6021363338999, -508.2872398012025, -875.2285491744548, -788.7045067447665, -946.3718422711187, -825.2846697132381, -293.1000437016329, -109.33027131357458, -117.11157523690453, -216.12251709779937, -9.562775233670259, -20.75613909986871, -638.6655928543317, -103.26051819889366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5378938608563846, "mean_inference_ms": 1.7183671051468208, "mean_action_processing_ms": 0.7992032582581499, "mean_env_wait_ms": 10.282495217290448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012363672256469727, "StateBufferConnector_ms": 0.00904083251953125, "ViewRequirementAgentConnector_ms": 0.3040804862976074}, "num_episodes": 24, "episode_return_max": -727.4322606572557, "episode_return_min": -4367.523091719134, "episode_return_mean": -2405.6598787067237, "episodes_this_iter": 24}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1482748, "num_agent_steps_trained": 1482748, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.16112785756931, "num_env_steps_trained_throughput_per_sec": 83.16112785756931, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1482748, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1482748, "timers": {"training_iteration_time_ms": 47729.894, "restore_workers_time_ms": 0.024, "training_step_time_ms": 47729.828, "sample_time_ms": 3243.285, "learn_time_ms": 44430.647, "learn_throughput": 90.028, "synch_weights_time_ms": 53.188}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1482748, "num_agent_steps_trained": 1482748}, "done": false, "training_iteration": 85, "trial_id": "05c72_00000", "date": "2024-07-26_15-52-23", "timestamp": 1721989343, "time_this_iter_s": 48.10924816131592, "time_total_s": 4161.452125072479, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd014bac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4161.452125072479, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 11.037681159420291, "ram_util_percent": 30.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 102.48542223735828, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000002, "total_loss": 4.896710052419064, "policy_loss": 0.0035731433732643612, "vf_loss": 4.907531146089829, "vf_explained_var": 0.9740809966230867, "kl": 0.016330876365950937, "entropy": 2.6795493887431587, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.68656716417911, "num_grad_updates_lifetime": 350790.5, "diff_num_grad_updates_vs_sampler_policy": 2009.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1499858, "num_agent_steps_trained": 1499858}, "env_runners": {"episode_reward_max": -727.4322606572557, "episode_reward_min": -4445.197917677206, "episode_reward_mean": -2384.565359996444, "episode_len_mean": 146.71, "episode_media": {}, "episodes_timesteps_total": 14671, "policy_reward_min": {"policy_0": -1474.763033386571}, "policy_reward_max": {"policy_0": -2.595555226307069}, "policy_reward_mean": {"policy_0": -476.9130719992889}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2549.376681624757, -1090.4843199273469, -3072.9787492580795, -2271.058790104816, -832.5770623063, -3174.273873323409, -2543.7384550351912, -3095.4299897139335, -4029.725002940949, -2484.0764333244356, -2274.3360178711055, -1114.3703115235855, -2334.5415156297368, -1894.0911958379872, -1769.7411325650812, -3407.9678904591933, -2366.986474466155, -2057.9572993664465, -2652.652983143635, -1845.434746053287, -1378.2319104811056, -3787.5415065705542, -2966.1488783082373, -4203.735456697258, -1689.2378692761856, -2881.060774942778, -2509.567470418399, -3270.6508198641227, -1929.3876019851393, -2279.411616980586, -2497.277452200643, -2116.9980424780365, -4032.1044505802483, -3862.959802369984, -2329.1660811790625, -828.8568690328693, -1816.08807688135, -2234.556367500326, -1737.574737750633, -3449.3777858074764, -1257.1530127601095, -2060.4362766426643, -727.4322606572557, -1989.9574133723847, -1777.6673368497322, -1598.0336936794965, -2776.2854279760327, -2615.4581901478755, -2746.6300018419415, -1877.7535833949562, -2186.6726565542012, -3157.3549031032176, -1673.490540673708, -2355.641158900278, -2816.2653473589135, -1335.1547121576286, -2489.910896018448, -2137.0758806486165, -4367.523091719134, -2501.8665644471316, -3128.5193824526255, -1859.958527999292, -2630.4457370883856, -3262.3966420154316, -2819.974306975167, -979.4008131122358, -2853.9901086487903, -2291.198402236467, -988.3675424845636, -1964.5636059731462, -3314.3973950503137, -1956.868906915717, -1201.8550752212502, -2697.9152717351967, -2053.1220973738714, -1350.657245504022, -2041.1017734486836, -2396.1272981976012, -2050.735697528016, -2719.953655473323, -2329.8241191310362, -3180.0517258280056, -1837.6385185209508, -2579.5132196678455, -1971.6007663503322, -3247.1875683924923, -2028.5204574543177, -2144.7780766096503, -4445.197917677206, -2032.0870460012886, -2190.9835225471734, -1889.4038140108912, -2859.484667372653, -949.1167837077772, -2452.040534935497, -2499.5644203557417, -2240.65657195845, -2755.760646790539, -3059.722491830215, -4092.3582003840997], "episode_lengths": [150, 107, 150, 150, 122, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 136, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 85, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-290.14814413400364, -171.4162296576624, -478.9763418822043, -860.4386230580831, -748.3973428928019, -101.2106935576171, -303.93889933152377, -395.24466191945413, -124.80339653430921, -165.28666858444308, -1339.78238425226, -503.15891111400435, -17.026677107721518, -497.0383081215415, -715.9724686625525, -706.4659072027317, -77.59085667625644, -253.93306083882982, -734.2353532936137, -498.8336120933849, -345.94192153949155, -289.6233468164806, -42.154873928215885, -95.57862529226011, -59.27829472985208, -829.2084498973445, -701.1367551419116, -610.8595354598303, -603.7793460773454, -429.2897867469822, -685.245851441181, -480.2769040966071, -241.8325468290331, -1120.9407471446393, -15.442405523730772, -146.39172816943918, -718.9875816334849, -640.0975141738098, -983.1265565291233, -606.826609208076, -126.06463723510777, -61.5369528756144, -1291.868073709345, -1133.0350993111329, -1417.2202398097465, -105.31972139713473, -433.23132239420863, -1260.4732255260801, -546.1237649711553, -138.9283990358591, -378.7611480091668, -25.68600238258427, -857.960021827403, -50.11892631259574, -961.8099193393558, -299.5452326177543, -234.99071432537258, -98.62110899466056, -33.94172050130128, -447.27153508449646, -93.51634043665966, -764.7268349186267, -231.35721972776645, -509.1546285887706, -735.7864919579121, -36.6481543244279, -350.0435486239228, -72.85671103691962, -1249.3350644221787, -185.20771743053803, -1065.032798607586, -221.45046747158293, -276.41638070058735, -30.198048185589904, -176.64343759973443, -1073.872763607058, -953.5219914782284, -1078.9993793899855, -175.74729734301053, -125.82645864090657, -489.39777221241496, -41.68063956178105, -1374.5170235821458, -59.56921744482169, -401.82182166499047, -19.24604212814381, -63.43520193612549, -65.3455876693527, -903.5762758175024, -1006.3541918153212, -468.0878201504209, -163.4311019324466, -668.779099635729, -169.89395849276258, -1182.461002932275, -61.71706341450638, -248.09684302666963, -564.3839235437958, -248.9628703698141, -722.2740456985014, -89.88123248307978, -279.935386013834, -174.61149575561345, -728.2677107273519, -105.53608550122743, -413.50471898017986, -1075.7136398766054, -375.30417857324966, -1306.3031426800871, -616.7158264604345, -558.2345957867484, -929.5214940111404, -666.1069432606625, -175.78362997362723, -636.5022152760598, -1342.3782423378916, -746.4236612895785, -493.96450414094454, -277.2690818623825, -1343.699967066459, -165.10811327750568, -609.2069337085342, -669.9292474567709, -184.18448736224016, -60.80908747113487, -20.4728532967711, -770.0596195721953, -792.7208655647335, -843.1039770310598, -454.7034594780137, -440.32553222734896, -1275.0652097539878, -45.8006748152487, -680.8768525575599, -67.49920106425712, -871.7171834762562, -708.7176296314112, -252.63114608586372, -924.9846276263445, -512.6002330442492, -627.8944400002216, -244.89677075988982, -226.12366566377858, -35.31062054570027, -795.1621050155483, -80.86277121447098, -1289.4195819493605, -740.877481873959, -102.1225323052435, -66.12924963754958, -241.3980923343303, -904.3930200208614, -273.6705569454665, -810.0793618286502, -267.73642107133486, -243.47658558891268, -86.12218516715106, -909.6228576162866, -746.7987266204013, -130.97768748528475, -1224.549009870722, -1124.7241760543277, -850.6582402832533, -321.1266619020443, -511.0463624699008, -1050.113069597868, -617.7218446919294, -356.9729020601024, -1125.332038669757, -712.8199473503265, -101.19322482533613, -186.10039280364214, -309.4972708256631, -1343.941101792611, -388.43409093181185, -144.26764749149038, -269.6114194428666, -34.9282929019562, -98.00429342271818, -282.0452157738385, -216.07711444763817, -295.817123448547, -11.035526203956643, -283.2826227358406, -1009.8756900453672, -135.97722467651727, -906.3029235112086, -399.651972649267, -87.9116640495107, -704.712582613824, -513.1678660319859, -126.90712045658162, -111.18814896826069, -40.10645050739267, -946.2051517864114, -554.4560219663488, -22.20934285700621, -1114.1841592147218, -721.5142038262222, -1037.0140579431788, -235.71628413722433, -107.02055133185115, -820.9874463085386, -27.556690172246892, -65.87204081024906, -154.04539206271372, -1164.303427595465, -364.7346965460445, -28.763215971878896, -348.5895444665623, -18.593149082605382, -15.211017620511027, -131.55864458238037, -306.19750392083023, -255.8719454509282, -903.4835414577784, -696.6185174448074, -97.42542635507408, -152.3975487935328, -140.03237932119242, -200.51511868529272, -255.05754017449897, -770.1654155453623, -169.669714186005, -382.2595482585715, -101.40649482570937, -553.3078294747783, -226.6025919866502, -671.8835101916862, -44.83326720067364, -392.1250870723409, -221.74904565078003, -210.327278087104, -477.3209837792361, -1474.763033386571, -453.09572787542436, -191.1582213915162, -1083.757994253548, -617.5555328438313, -269.8907137835563, -47.03643577495287, -31.16435060400398, -968.6717967496462, -473.47867419880345, -1226.278744514537, -50.22577853066609, -468.49301979164863, -892.3747858708679, -421.4966750884395, -45.16332411333575, -629.278848362709, -86.92729724549244, -216.20934099876916, -1209.5926048857802, -44.664565061449935, -325.2256451548664, -330.2041816731135, -1032.313971985413, -583.83577616988, -885.7753281199425, -285.3092392202689, -529.4079080588062, -175.66875660796694, -171.71084216236397, -511.3937946243018, -196.54514037943125, -735.1119440288397, -582.0965844948935, -189.04194324639232, -652.8455467507221, -472.9050016380424, -489.1389075536397, -744.4655256636639, -328.1993655013147, -781.5565470022541, -689.1056030102145, -89.22638858063861, -37.34626997126071, -53.81115904855281, -465.6652915469635, -286.4312849747578, -536.0377644589919, -414.61356738872007, -513.7369352470477, -739.0913439489299, -248.48520932907013, -215.77931483157678, -959.4674810303113, -362.96577788238335, -350.37809757527697, -461.2601491578571, -1103.0487337216362, -979.9436957125669, -742.3829390580023, -1080.8875740690683, -386.7303163606392, -562.5650488784376, -1065.4136399700478, -475.3703528378354, -11.787206400171975, -251.9648947907056, -813.2761744100402, -477.370504481458, -1193.4039224328053, -392.50388633761474, -422.2268412824967, -72.3449338240222, -1316.2416730815632, -46.54952458490315, -2.595555226307069, -373.1333332499419, -648.0899679454474, -46.81953152905094, -855.7875389369555, -706.6153654269897, -1267.817013917905, -219.46585665063458, -171.77629929740385, -1032.2617705948685, -571.0757015546191, -887.3873983596104, -799.1341344862973, -226.21637679658392, -412.48247876171786, -494.7539185709582, -634.7029842296262, -107.05186828428403, -44.139671187337974, -123.76979491934964, -69.73649449163823, -356.16767659446504, -325.6021363338999, -508.2872398012025, -875.2285491744548, -788.7045067447665, -946.3718422711187, -825.2846697132381, -293.1000437016329, -109.33027131357458, -117.11157523690453, -216.12251709779937, -9.562775233670259, -20.75613909986871, -638.6655928543317, -103.26051819889366, -124.76090126132749, -547.9499946583842, -692.7499267553047, -438.77583804729267, -160.32694525083687, -955.9259702195278, -921.3514015912975, -36.81685334851784, -1191.485701541146, -208.81746834982394, -475.86805396624413, -389.1728479616741, -216.0350025607197, -501.44333263897, -374.3496697881092, -146.83300784988617, -94.39438799119162, -130.75847713106342, -525.6923736793128, -304.17682856979576, -416.7916868972002, -767.4208817001303, -193.98300669235354, -320.75975532575103, -998.9599411197617, -94.84771387944348, -725.3771111670773, -766.3011649523677, -99.10594356728893, -367.490163807694, -399.7273458730614, -36.66578110328196, -477.76064230475913, -363.63087367636996, -72.87260254655075, -847.1107432736811, -241.77768904008747, -187.9146542144457, -732.2897066132074, -32.008980307263286, -334.9596921135586, -96.45341285860081, -504.5845314556803, -1414.6933345015734, -45.43632726818861, -564.9710792115637, -543.6975800866312, -119.69646603744482, -165.14218781648006, -657.2283843758964, -3.3484378123377945, -1251.365230452617, -22.850143621551876, -585.4646562962962, -856.9251872905241, -425.9547619857517, -631.5123887926829, -610.5541550646418, -19.98518783322274, -641.8176254547366, -914.3854171070734, -97.64917023050998, -1109.67138658663, -1036.392172935703, -21.953578968088955, -145.94186262089343, -35.37894992048685, -105.99705988362182, -1344.3901738854547, -205.9304722104934, -197.65290115978675, -606.8842235383644, -953.8092019462152, -585.6861099290968, -235.4807830943816, -271.46741489944253, -305.19711452033107, -220.29286854960924, -896.2894044868962, -278.35396389405423, -352.67270118233336, -126.71505484914975, -1416.2294229253882, -1122.5066120083973, -229.06377742722165, -181.86517059760166, -797.8192416959134, -307.11044844645005, -415.1937159573282, -326.5318807570228, -358.3142427172324, -668.5322169928219, -578.3338018289097, -306.6653403969759, -232.93247467370853, -1100.5915267553119, -1452.3970241752286, -51.8617154854916, -727.7705673555024, -1112.5770839056665, -598.1643133826378, -289.55157441737157, -638.769111836522, -73.1506619945413, -432.4513843702161, -192.4476558609601, -97.43823409830841, -1277.6444379590287, -465.7283066005717, -157.724888028304, -668.1545816910944, -107.31056963160466, -396.47852967356897, -556.2365088926058, -161.22362412201903, -912.8712310908595, -600.2722309559948, -410.90678761175764, -392.0570022233232, -543.377415490715, -151.31048084740718, -258.3966807993387, -33.982002646886194, -420.5931289281745, -84.83449048597095, -888.4696341194556, -257.37689675160044, -500.76254456775354, -115.80483361025853, -689.626625886429, -137.81211868614184, -55.54703825758505, -716.5686154141875, -517.6100111487744, -1072.0266368490506, -1031.4164136616696, -469.7641492870192, -80.49259913739017, -283.8981447057247, -375.0852651666512, -925.7273503093036, -895.0927279032284, -330.1373305119213, -566.0135390143904, -38.78969905169534, -1037.3270573896225, -372.5590522161697, -322.0410554255644, -217.36904371716147, -1110.4262830816979, -848.2518383563555, -261.87761487119815, -428.3044068770292, -1421.3648845999203, -1132.5594556796004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.536673512088393, "mean_inference_ms": 1.7182190380723639, "mean_action_processing_ms": 0.7985872193994591, "mean_env_wait_ms": 10.27387861350747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01223611831665039, "StateBufferConnector_ms": 0.008890390396118164, "ViewRequirementAgentConnector_ms": 0.29383373260498047}, "num_episodes": 31, "episode_return_max": -727.4322606572557, "episode_return_min": -4445.197917677206, "episode_return_mean": -2384.565359996444, "episodes_this_iter": 31}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1499858, "num_agent_steps_trained": 1499858, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.67584917620997, "num_env_steps_trained_throughput_per_sec": 79.67584917620997, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1499858, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1499858, "timers": {"training_iteration_time_ms": 48309.727, "restore_workers_time_ms": 0.025, "training_step_time_ms": 48309.658, "sample_time_ms": 3251.373, "learn_time_ms": 45002.311, "learn_throughput": 88.884, "synch_weights_time_ms": 53.239}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1499858, "num_agent_steps_trained": 1499858}, "done": false, "training_iteration": 86, "trial_id": "05c72_00000", "date": "2024-07-26_15-53-14", "timestamp": 1721989394, "time_this_iter_s": 50.211671590805054, "time_total_s": 4211.663796663284, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71d2805e7910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4211.663796663284, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 11.001408450704227, "ram_util_percent": 30.142253521126754}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.47758185933431, "cur_kl_coeff": 0.7593750000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.511423839569092, "policy_loss": -0.0005912237265923371, "vf_loss": 4.527632201067607, "vf_explained_var": 0.9798868060588837, "kl": 0.014430392991068462, "entropy": 2.6575212847391763, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.808, "num_grad_updates_lifetime": 354675.5, "diff_num_grad_updates_vs_sampler_policy": 1874.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1515834, "num_agent_steps_trained": 1515834}, "env_runners": {"episode_reward_max": -693.6280167328143, "episode_reward_min": -4445.197917677206, "episode_reward_mean": -2310.6345904340706, "episode_len_mean": 147.4, "episode_media": {}, "episodes_timesteps_total": 14740, "policy_reward_min": {"policy_0": -1486.0918414535652}, "policy_reward_max": {"policy_0": -2.595555226307069}, "policy_reward_mean": {"policy_0": -462.1269180868141}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2509.567470418399, -3270.6508198641227, -1929.3876019851393, -2279.411616980586, -2497.277452200643, -2116.9980424780365, -4032.1044505802483, -3862.959802369984, -2329.1660811790625, -828.8568690328693, -1816.08807688135, -2234.556367500326, -1737.574737750633, -3449.3777858074764, -1257.1530127601095, -2060.4362766426643, -727.4322606572557, -1989.9574133723847, -1777.6673368497322, -1598.0336936794965, -2776.2854279760327, -2615.4581901478755, -2746.6300018419415, -1877.7535833949562, -2186.6726565542012, -3157.3549031032176, -1673.490540673708, -2355.641158900278, -2816.2653473589135, -1335.1547121576286, -2489.910896018448, -2137.0758806486165, -4367.523091719134, -2501.8665644471316, -3128.5193824526255, -1859.958527999292, -2630.4457370883856, -3262.3966420154316, -2819.974306975167, -979.4008131122358, -2853.9901086487903, -2291.198402236467, -988.3675424845636, -1964.5636059731462, -3314.3973950503137, -1956.868906915717, -1201.8550752212502, -2697.9152717351967, -2053.1220973738714, -1350.657245504022, -2041.1017734486836, -2396.1272981976012, -2050.735697528016, -2719.953655473323, -2329.8241191310362, -3180.0517258280056, -1837.6385185209508, -2579.5132196678455, -1971.6007663503322, -3247.1875683924923, -2028.5204574543177, -2144.7780766096503, -4445.197917677206, -2032.0870460012886, -2190.9835225471734, -1889.4038140108912, -2859.484667372653, -949.1167837077772, -2452.040534935497, -2499.5644203557417, -2240.65657195845, -2755.760646790539, -3059.722491830215, -4092.3582003840997, -2405.7110201234505, -693.6280167328143, -2462.7090640370047, -2482.141041533937, -1766.9244838283987, -1688.7554401762923, -2216.189185590999, -2295.0350795050867, -2157.5985891723917, -1598.302872799256, -997.665980956999, -2535.701284735035, -3169.2598493419036, -2292.6336216827294, -2629.979870272225, -1729.9543615814796, -1542.7984778922848, -2941.206929829439, -1894.2864457923522, -3432.127568718826, -2204.957665836154, -2668.9977812301972, -976.0217979548898, -1800.401263114364, -3022.5083131507163, -2769.1823589249548], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 85, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150], "policy_policy_0_reward": [-440.32553222734896, -1275.0652097539878, -45.8006748152487, -680.8768525575599, -67.49920106425712, -871.7171834762562, -708.7176296314112, -252.63114608586372, -924.9846276263445, -512.6002330442492, -627.8944400002216, -244.89677075988982, -226.12366566377858, -35.31062054570027, -795.1621050155483, -80.86277121447098, -1289.4195819493605, -740.877481873959, -102.1225323052435, -66.12924963754958, -241.3980923343303, -904.3930200208614, -273.6705569454665, -810.0793618286502, -267.73642107133486, -243.47658558891268, -86.12218516715106, -909.6228576162866, -746.7987266204013, -130.97768748528475, -1224.549009870722, -1124.7241760543277, -850.6582402832533, -321.1266619020443, -511.0463624699008, -1050.113069597868, -617.7218446919294, -356.9729020601024, -1125.332038669757, -712.8199473503265, -101.19322482533613, -186.10039280364214, -309.4972708256631, -1343.941101792611, -388.43409093181185, -144.26764749149038, -269.6114194428666, -34.9282929019562, -98.00429342271818, -282.0452157738385, -216.07711444763817, -295.817123448547, -11.035526203956643, -283.2826227358406, -1009.8756900453672, -135.97722467651727, -906.3029235112086, -399.651972649267, -87.9116640495107, -704.712582613824, -513.1678660319859, -126.90712045658162, -111.18814896826069, -40.10645050739267, -946.2051517864114, -554.4560219663488, -22.20934285700621, -1114.1841592147218, -721.5142038262222, -1037.0140579431788, -235.71628413722433, -107.02055133185115, -820.9874463085386, -27.556690172246892, -65.87204081024906, -154.04539206271372, -1164.303427595465, -364.7346965460445, -28.763215971878896, -348.5895444665623, -18.593149082605382, -15.211017620511027, -131.55864458238037, -306.19750392083023, -255.8719454509282, -903.4835414577784, -696.6185174448074, -97.42542635507408, -152.3975487935328, -140.03237932119242, -200.51511868529272, -255.05754017449897, -770.1654155453623, -169.669714186005, -382.2595482585715, -101.40649482570937, -553.3078294747783, -226.6025919866502, -671.8835101916862, -44.83326720067364, -392.1250870723409, -221.74904565078003, -210.327278087104, -477.3209837792361, -1474.763033386571, -453.09572787542436, -191.1582213915162, -1083.757994253548, -617.5555328438313, -269.8907137835563, -47.03643577495287, -31.16435060400398, -968.6717967496462, -473.47867419880345, -1226.278744514537, -50.22577853066609, -468.49301979164863, -892.3747858708679, -421.4966750884395, -45.16332411333575, -629.278848362709, -86.92729724549244, -216.20934099876916, -1209.5926048857802, -44.664565061449935, -325.2256451548664, -330.2041816731135, -1032.313971985413, -583.83577616988, -885.7753281199425, -285.3092392202689, -529.4079080588062, -175.66875660796694, -171.71084216236397, -511.3937946243018, -196.54514037943125, -735.1119440288397, -582.0965844948935, -189.04194324639232, -652.8455467507221, -472.9050016380424, -489.1389075536397, -744.4655256636639, -328.1993655013147, -781.5565470022541, -689.1056030102145, -89.22638858063861, -37.34626997126071, -53.81115904855281, -465.6652915469635, -286.4312849747578, -536.0377644589919, -414.61356738872007, -513.7369352470477, -739.0913439489299, -248.48520932907013, -215.77931483157678, -959.4674810303113, -362.96577788238335, -350.37809757527697, -461.2601491578571, -1103.0487337216362, -979.9436957125669, -742.3829390580023, -1080.8875740690683, -386.7303163606392, -562.5650488784376, -1065.4136399700478, -475.3703528378354, -11.787206400171975, -251.9648947907056, -813.2761744100402, -477.370504481458, -1193.4039224328053, -392.50388633761474, -422.2268412824967, -72.3449338240222, -1316.2416730815632, -46.54952458490315, -2.595555226307069, -373.1333332499419, -648.0899679454474, -46.81953152905094, -855.7875389369555, -706.6153654269897, -1267.817013917905, -219.46585665063458, -171.77629929740385, -1032.2617705948685, -571.0757015546191, -887.3873983596104, -799.1341344862973, -226.21637679658392, -412.48247876171786, -494.7539185709582, -634.7029842296262, -107.05186828428403, -44.139671187337974, -123.76979491934964, -69.73649449163823, -356.16767659446504, -325.6021363338999, -508.2872398012025, -875.2285491744548, -788.7045067447665, -946.3718422711187, -825.2846697132381, -293.1000437016329, -109.33027131357458, -117.11157523690453, -216.12251709779937, -9.562775233670259, -20.75613909986871, -638.6655928543317, -103.26051819889366, -124.76090126132749, -547.9499946583842, -692.7499267553047, -438.77583804729267, -160.32694525083687, -955.9259702195278, -921.3514015912975, -36.81685334851784, -1191.485701541146, -208.81746834982394, -475.86805396624413, -389.1728479616741, -216.0350025607197, -501.44333263897, -374.3496697881092, -146.83300784988617, -94.39438799119162, -130.75847713106342, -525.6923736793128, -304.17682856979576, -416.7916868972002, -767.4208817001303, -193.98300669235354, -320.75975532575103, -998.9599411197617, -94.84771387944348, -725.3771111670773, -766.3011649523677, -99.10594356728893, -367.490163807694, -399.7273458730614, -36.66578110328196, -477.76064230475913, -363.63087367636996, -72.87260254655075, -847.1107432736811, -241.77768904008747, -187.9146542144457, -732.2897066132074, -32.008980307263286, -334.9596921135586, -96.45341285860081, -504.5845314556803, -1414.6933345015734, -45.43632726818861, -564.9710792115637, -543.6975800866312, -119.69646603744482, -165.14218781648006, -657.2283843758964, -3.3484378123377945, -1251.365230452617, -22.850143621551876, -585.4646562962962, -856.9251872905241, -425.9547619857517, -631.5123887926829, -610.5541550646418, -19.98518783322274, -641.8176254547366, -914.3854171070734, -97.64917023050998, -1109.67138658663, -1036.392172935703, -21.953578968088955, -145.94186262089343, -35.37894992048685, -105.99705988362182, -1344.3901738854547, -205.9304722104934, -197.65290115978675, -606.8842235383644, -953.8092019462152, -585.6861099290968, -235.4807830943816, -271.46741489944253, -305.19711452033107, -220.29286854960924, -896.2894044868962, -278.35396389405423, -352.67270118233336, -126.71505484914975, -1416.2294229253882, -1122.5066120083973, -229.06377742722165, -181.86517059760166, -797.8192416959134, -307.11044844645005, -415.1937159573282, -326.5318807570228, -358.3142427172324, -668.5322169928219, -578.3338018289097, -306.6653403969759, -232.93247467370853, -1100.5915267553119, -1452.3970241752286, -51.8617154854916, -727.7705673555024, -1112.5770839056665, -598.1643133826378, -289.55157441737157, -638.769111836522, -73.1506619945413, -432.4513843702161, -192.4476558609601, -97.43823409830841, -1277.6444379590287, -465.7283066005717, -157.724888028304, -668.1545816910944, -107.31056963160466, -396.47852967356897, -556.2365088926058, -161.22362412201903, -912.8712310908595, -600.2722309559948, -410.90678761175764, -392.0570022233232, -543.377415490715, -151.31048084740718, -258.3966807993387, -33.982002646886194, -420.5931289281745, -84.83449048597095, -888.4696341194556, -257.37689675160044, -500.76254456775354, -115.80483361025853, -689.626625886429, -137.81211868614184, -55.54703825758505, -716.5686154141875, -517.6100111487744, -1072.0266368490506, -1031.4164136616696, -469.7641492870192, -80.49259913739017, -283.8981447057247, -375.0852651666512, -925.7273503093036, -895.0927279032284, -330.1373305119213, -566.0135390143904, -38.78969905169534, -1037.3270573896225, -372.5590522161697, -322.0410554255644, -217.36904371716147, -1110.4262830816979, -848.2518383563555, -261.87761487119815, -428.3044068770292, -1421.3648845999203, -1132.5594556796004, -610.1281982080674, -434.9577667326042, -322.67420233003145, -563.0175490266156, -474.9333038261321, -84.86309979650974, -396.6196775477223, -98.75287233326912, -64.5058975099288, -48.886469545384095, -772.663944319191, -337.6566336521982, -220.85751426529347, -131.3747964118822, -1000.1561753884414, -607.8288724225627, -138.2633809858627, -36.7354157291728, -962.1875973634938, -737.1257750328456, -95.89404740257957, -97.17098869260988, -975.1504752140506, -508.8562136242074, -89.85275889495013, -238.92529082154917, -123.8427178196866, -501.7385171033571, -331.4244205679761, -492.8244938637237, -846.4848784316413, -573.59938268679, -174.22740976644238, -600.0115306012509, -21.865984104872286, -92.7643717273357, -1033.4401688243968, -996.1102182608543, -118.214472397544, -54.50584829495578, -1145.7030165328729, -124.23254930222124, -631.2865472098267, -135.33645593701053, -121.04002019046186, -71.28078381812563, -80.30187348641557, -121.12926623448325, -1198.3552872999353, -127.23566196029606, -55.19746989187594, -127.3444688618405, -113.7453200634145, -670.0188555624417, -31.35986657742691, -438.3121693577796, -359.8586547818118, -1136.0672501091221, -125.41305224354716, -476.05015824277416, -415.6327403132633, -158.437143963049, -1013.1751624250344, -697.3464701577257, -884.6683324828305, -728.7512670332076, -720.2307350683564, -303.27105799247244, -329.14322636789046, -211.23733522080227, -64.79831322610536, -730.9361148362286, -759.6920806513494, -244.35956743308142, -830.1937941254607, -911.1216604924766, -95.5160352545559, -288.16739525019017, -43.192902695291046, -391.9563678889654, -63.383032770353054, -848.2467908480703, -471.45302091802614, -18.76976049883534, -140.94587285699978, -169.09604060190327, -363.87975829305486, -30.42536941222013, -891.713920068693, -1486.0918414535652, -717.2168936178605, -192.02595493283113, -687.3070298731484, -84.6853967998523, -213.05117056865913, -230.17377333442337, -1316.875202592862, -286.6048494449574, -599.3271407856199, -999.1466025609626, -717.451485309509, -195.8539873604738, -17.665977228650647, -431.0545988997004, -842.931617037819, -458.45552559564703, -483.7526545298079, -1390.3918165645275, -210.4969390933857, -125.90084544682912, -104.09954762367765, -361.2644987396406, -244.4994421837359, -136.3001725906032, -129.85813681723207, -406.4395622441748, -192.65263203397018, -123.09049993018903, -533.9847656741601, -544.2338032318714, -551.4058636897732, -22.01222228526647, -785.6876208166253, -946.3396010470408, -717.0630053120112, -270.09133344185426, -109.10326080573043, -1235.4686455099115, -66.54170036631871, -1087.9774188011402]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.53503279722547, "mean_inference_ms": 1.7168285390055202, "mean_action_processing_ms": 0.7968003199634299, "mean_env_wait_ms": 10.255740296872457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011646509170532227, "StateBufferConnector_ms": 0.008550643920898438, "ViewRequirementAgentConnector_ms": 0.2765371799468994}, "num_episodes": 26, "episode_return_max": -693.6280167328143, "episode_return_min": -4445.197917677206, "episode_return_mean": -2310.6345904340706, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1515834, "num_agent_steps_trained": 1515834, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 109.31456027023394, "num_env_steps_trained_throughput_per_sec": 109.31456027023394, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1515834, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1515834, "timers": {"training_iteration_time_ms": 47865.435, "restore_workers_time_ms": 0.025, "training_step_time_ms": 47865.368, "sample_time_ms": 3228.22, "learn_time_ms": 44581.565, "learn_throughput": 89.723, "synch_weights_time_ms": 52.808}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1515834, "num_agent_steps_trained": 1515834}, "done": false, "training_iteration": 87, "trial_id": "05c72_00000", "date": "2024-07-26_15-53-50", "timestamp": 1721989430, "time_this_iter_s": 36.60191297531128, "time_total_s": 4248.265709638596, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd014aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4248.265709638596, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 12.286538461538461, "ram_util_percent": 30.10192307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 136.54371569084398, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.708942119099877, "policy_loss": -0.00045737511486595853, "vf_loss": 4.724683780019934, "vf_explained_var": 0.9806541462287758, "kl": 0.016046378962610932, "entropy": 2.7469508473921302, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.42424242424242, "num_grad_updates_lifetime": 358530.5, "diff_num_grad_updates_vs_sampler_policy": 1979.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1532654, "num_agent_steps_trained": 1532654}, "env_runners": {"episode_reward_max": -693.6280167328143, "episode_reward_min": -4445.197917677206, "episode_reward_mean": -2410.1692616382506, "episode_len_mean": 148.51, "episode_media": {}, "episodes_timesteps_total": 14851, "policy_reward_min": {"policy_0": -1486.0918414535652}, "policy_reward_max": {"policy_0": -2.595555226307069}, "policy_reward_mean": {"policy_0": -482.0338523276501}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1877.7535833949562, -2186.6726565542012, -3157.3549031032176, -1673.490540673708, -2355.641158900278, -2816.2653473589135, -1335.1547121576286, -2489.910896018448, -2137.0758806486165, -4367.523091719134, -2501.8665644471316, -3128.5193824526255, -1859.958527999292, -2630.4457370883856, -3262.3966420154316, -2819.974306975167, -979.4008131122358, -2853.9901086487903, -2291.198402236467, -988.3675424845636, -1964.5636059731462, -3314.3973950503137, -1956.868906915717, -1201.8550752212502, -2697.9152717351967, -2053.1220973738714, -1350.657245504022, -2041.1017734486836, -2396.1272981976012, -2050.735697528016, -2719.953655473323, -2329.8241191310362, -3180.0517258280056, -1837.6385185209508, -2579.5132196678455, -1971.6007663503322, -3247.1875683924923, -2028.5204574543177, -2144.7780766096503, -4445.197917677206, -2032.0870460012886, -2190.9835225471734, -1889.4038140108912, -2859.484667372653, -949.1167837077772, -2452.040534935497, -2499.5644203557417, -2240.65657195845, -2755.760646790539, -3059.722491830215, -4092.3582003840997, -2405.7110201234505, -693.6280167328143, -2462.7090640370047, -2482.141041533937, -1766.9244838283987, -1688.7554401762923, -2216.189185590999, -2295.0350795050867, -2157.5985891723917, -1598.302872799256, -997.665980956999, -2535.701284735035, -3169.2598493419036, -2292.6336216827294, -2629.979870272225, -1729.9543615814796, -1542.7984778922848, -2941.206929829439, -1894.2864457923522, -3432.127568718826, -2204.957665836154, -2668.9977812301972, -976.0217979548898, -1800.401263114364, -3022.5083131507163, -2769.1823589249548, -2148.8771734634033, -1828.906711774056, -2269.9967624993133, -3468.0769425295703, -3401.4567862704753, -2952.286322124557, -4098.882539042586, -2361.3216881947656, -2270.4639116432404, -2017.9319009881083, -2354.1599206548426, -3126.2832463797117, -3890.2244450853354, -3152.564473123854, -2123.1597436576462, -2372.533864778301, -3262.2058224978223, -1719.7586339341347, -2703.86692891042, -3885.738646072262, -1860.9551399749669, -3344.778912573221, -1782.0673932018121], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150], "policy_policy_0_reward": [-50.22577853066609, -468.49301979164863, -892.3747858708679, -421.4966750884395, -45.16332411333575, -629.278848362709, -86.92729724549244, -216.20934099876916, -1209.5926048857802, -44.664565061449935, -325.2256451548664, -330.2041816731135, -1032.313971985413, -583.83577616988, -885.7753281199425, -285.3092392202689, -529.4079080588062, -175.66875660796694, -171.71084216236397, -511.3937946243018, -196.54514037943125, -735.1119440288397, -582.0965844948935, -189.04194324639232, -652.8455467507221, -472.9050016380424, -489.1389075536397, -744.4655256636639, -328.1993655013147, -781.5565470022541, -689.1056030102145, -89.22638858063861, -37.34626997126071, -53.81115904855281, -465.6652915469635, -286.4312849747578, -536.0377644589919, -414.61356738872007, -513.7369352470477, -739.0913439489299, -248.48520932907013, -215.77931483157678, -959.4674810303113, -362.96577788238335, -350.37809757527697, -461.2601491578571, -1103.0487337216362, -979.9436957125669, -742.3829390580023, -1080.8875740690683, -386.7303163606392, -562.5650488784376, -1065.4136399700478, -475.3703528378354, -11.787206400171975, -251.9648947907056, -813.2761744100402, -477.370504481458, -1193.4039224328053, -392.50388633761474, -422.2268412824967, -72.3449338240222, -1316.2416730815632, -46.54952458490315, -2.595555226307069, -373.1333332499419, -648.0899679454474, -46.81953152905094, -855.7875389369555, -706.6153654269897, -1267.817013917905, -219.46585665063458, -171.77629929740385, -1032.2617705948685, -571.0757015546191, -887.3873983596104, -799.1341344862973, -226.21637679658392, -412.48247876171786, -494.7539185709582, -634.7029842296262, -107.05186828428403, -44.139671187337974, -123.76979491934964, -69.73649449163823, -356.16767659446504, -325.6021363338999, -508.2872398012025, -875.2285491744548, -788.7045067447665, -946.3718422711187, -825.2846697132381, -293.1000437016329, -109.33027131357458, -117.11157523690453, -216.12251709779937, -9.562775233670259, -20.75613909986871, -638.6655928543317, -103.26051819889366, -124.76090126132749, -547.9499946583842, -692.7499267553047, -438.77583804729267, -160.32694525083687, -955.9259702195278, -921.3514015912975, -36.81685334851784, -1191.485701541146, -208.81746834982394, -475.86805396624413, -389.1728479616741, -216.0350025607197, -501.44333263897, -374.3496697881092, -146.83300784988617, -94.39438799119162, -130.75847713106342, -525.6923736793128, -304.17682856979576, -416.7916868972002, -767.4208817001303, -193.98300669235354, -320.75975532575103, -998.9599411197617, -94.84771387944348, -725.3771111670773, -766.3011649523677, -99.10594356728893, -367.490163807694, -399.7273458730614, -36.66578110328196, -477.76064230475913, -363.63087367636996, -72.87260254655075, -847.1107432736811, -241.77768904008747, -187.9146542144457, -732.2897066132074, -32.008980307263286, -334.9596921135586, -96.45341285860081, -504.5845314556803, -1414.6933345015734, -45.43632726818861, -564.9710792115637, -543.6975800866312, -119.69646603744482, -165.14218781648006, -657.2283843758964, -3.3484378123377945, -1251.365230452617, -22.850143621551876, -585.4646562962962, -856.9251872905241, -425.9547619857517, -631.5123887926829, -610.5541550646418, -19.98518783322274, -641.8176254547366, -914.3854171070734, -97.64917023050998, -1109.67138658663, -1036.392172935703, -21.953578968088955, -145.94186262089343, -35.37894992048685, -105.99705988362182, -1344.3901738854547, -205.9304722104934, -197.65290115978675, -606.8842235383644, -953.8092019462152, -585.6861099290968, -235.4807830943816, -271.46741489944253, -305.19711452033107, -220.29286854960924, -896.2894044868962, -278.35396389405423, -352.67270118233336, -126.71505484914975, -1416.2294229253882, -1122.5066120083973, -229.06377742722165, -181.86517059760166, -797.8192416959134, -307.11044844645005, -415.1937159573282, -326.5318807570228, -358.3142427172324, -668.5322169928219, -578.3338018289097, -306.6653403969759, -232.93247467370853, -1100.5915267553119, -1452.3970241752286, -51.8617154854916, -727.7705673555024, -1112.5770839056665, -598.1643133826378, -289.55157441737157, -638.769111836522, -73.1506619945413, -432.4513843702161, -192.4476558609601, -97.43823409830841, -1277.6444379590287, -465.7283066005717, -157.724888028304, -668.1545816910944, -107.31056963160466, -396.47852967356897, -556.2365088926058, -161.22362412201903, -912.8712310908595, -600.2722309559948, -410.90678761175764, -392.0570022233232, -543.377415490715, -151.31048084740718, -258.3966807993387, -33.982002646886194, -420.5931289281745, -84.83449048597095, -888.4696341194556, -257.37689675160044, -500.76254456775354, -115.80483361025853, -689.626625886429, -137.81211868614184, -55.54703825758505, -716.5686154141875, -517.6100111487744, -1072.0266368490506, -1031.4164136616696, -469.7641492870192, -80.49259913739017, -283.8981447057247, -375.0852651666512, -925.7273503093036, -895.0927279032284, -330.1373305119213, -566.0135390143904, -38.78969905169534, -1037.3270573896225, -372.5590522161697, -322.0410554255644, -217.36904371716147, -1110.4262830816979, -848.2518383563555, -261.87761487119815, -428.3044068770292, -1421.3648845999203, -1132.5594556796004, -610.1281982080674, -434.9577667326042, -322.67420233003145, -563.0175490266156, -474.9333038261321, -84.86309979650974, -396.6196775477223, -98.75287233326912, -64.5058975099288, -48.886469545384095, -772.663944319191, -337.6566336521982, -220.85751426529347, -131.3747964118822, -1000.1561753884414, -607.8288724225627, -138.2633809858627, -36.7354157291728, -962.1875973634938, -737.1257750328456, -95.89404740257957, -97.17098869260988, -975.1504752140506, -508.8562136242074, -89.85275889495013, -238.92529082154917, -123.8427178196866, -501.7385171033571, -331.4244205679761, -492.8244938637237, -846.4848784316413, -573.59938268679, -174.22740976644238, -600.0115306012509, -21.865984104872286, -92.7643717273357, -1033.4401688243968, -996.1102182608543, -118.214472397544, -54.50584829495578, -1145.7030165328729, -124.23254930222124, -631.2865472098267, -135.33645593701053, -121.04002019046186, -71.28078381812563, -80.30187348641557, -121.12926623448325, -1198.3552872999353, -127.23566196029606, -55.19746989187594, -127.3444688618405, -113.7453200634145, -670.0188555624417, -31.35986657742691, -438.3121693577796, -359.8586547818118, -1136.0672501091221, -125.41305224354716, -476.05015824277416, -415.6327403132633, -158.437143963049, -1013.1751624250344, -697.3464701577257, -884.6683324828305, -728.7512670332076, -720.2307350683564, -303.27105799247244, -329.14322636789046, -211.23733522080227, -64.79831322610536, -730.9361148362286, -759.6920806513494, -244.35956743308142, -830.1937941254607, -911.1216604924766, -95.5160352545559, -288.16739525019017, -43.192902695291046, -391.9563678889654, -63.383032770353054, -848.2467908480703, -471.45302091802614, -18.76976049883534, -140.94587285699978, -169.09604060190327, -363.87975829305486, -30.42536941222013, -891.713920068693, -1486.0918414535652, -717.2168936178605, -192.02595493283113, -687.3070298731484, -84.6853967998523, -213.05117056865913, -230.17377333442337, -1316.875202592862, -286.6048494449574, -599.3271407856199, -999.1466025609626, -717.451485309509, -195.8539873604738, -17.665977228650647, -431.0545988997004, -842.931617037819, -458.45552559564703, -483.7526545298079, -1390.3918165645275, -210.4969390933857, -125.90084544682912, -104.09954762367765, -361.2644987396406, -244.4994421837359, -136.3001725906032, -129.85813681723207, -406.4395622441748, -192.65263203397018, -123.09049993018903, -533.9847656741601, -544.2338032318714, -551.4058636897732, -22.01222228526647, -785.6876208166253, -946.3396010470408, -717.0630053120112, -270.09133344185426, -109.10326080573043, -1235.4686455099115, -66.54170036631871, -1087.9774188011402, -1285.140747636611, -344.9671531216498, -241.9238536279517, -211.0961828636876, -65.7492362135022, -496.3619903986756, -264.11860014856353, -424.7683697965795, -520.8414946972695, -122.81625673296728, -1257.9925616403368, -94.13605028373311, -25.18530055695198, -131.6011474435599, -761.0817025747322, -726.042498009292, -754.906452410077, -338.449017808494, -855.3211167845074, -793.3578575172038, -852.3165893059517, -89.59553020277326, -991.8696268100483, -1345.9761514529055, -121.69888849879513, -162.77591149238177, -337.60663515049094, -571.6900127562928, -523.3761290272937, -1356.8376336981012, -730.1791946704668, -1178.6997089509302, -967.8011882156084, -1163.4612979594551, -58.741149246123975, -5.0095301775543515, -384.13930759254856, -951.6601485288066, -97.9513118246965, -922.5613900711589, -358.45216131171526, -1183.3518711463037, -109.498811662827, -543.2848201199441, -75.8762474024501, -808.3988148427287, -243.56295050156467, -504.8625634919134, -214.15855732273224, -246.9490148291697, -1223.0984691558956, -348.77782380765257, -628.5759199214273, -110.9301623775469, -42.77754539232205, -159.79455484632888, -1081.1170354454196, -319.66683913570023, -840.0845615478573, -725.6202554044079, -1181.0173520247836, -248.6293090910626, -955.391409455107, -1152.5205978026383, -352.66577671174383, -672.0870702075637, -846.0851032687832, -387.04427593862187, -530.4362844931637, -716.9117392157184, -402.87032982180233, -160.6322638601285, -890.225552863797, -532.6178784781948, -136.81371863372357, -85.68922364158652, -487.698087359332, -448.3662298021851, -435.50360058762175, -915.2767233875758, -652.0781093175107, -1008.1356594732905, -22.823579538665747, -1364.128327302131, -215.0401468662245, -88.41335176377983, -926.9335942916584, -13.685702476832466, -631.8106239073059, -58.9153614945577, -172.66299136943258, -909.6554035454009, -852.53477347209, -650.3125459466223, -118.70121457687347, -198.97804155863628, -1191.5897566377482, -1316.7842697842616, -496.3086859313956, -682.0778921602217, -505.3321130030991, -102.49165718420848, -334.55190524854277, -626.7370671812618, -291.84239735785525, -228.49500158076148, -1122.714064382723, -1229.9893726298596, -366.05375164364517, -397.5267223362327, -311.732896668918, -573.5079615021705, -846.8676517830853, -13.106639206430925, -36.85224404120683]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.535244578856063, "mean_inference_ms": 1.7167211883924052, "mean_action_processing_ms": 0.7964515266133219, "mean_env_wait_ms": 10.258149964340951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012143850326538086, "StateBufferConnector_ms": 0.00873708724975586, "ViewRequirementAgentConnector_ms": 0.2844982147216797}, "num_episodes": 23, "episode_return_max": -693.6280167328143, "episode_return_min": -4445.197917677206, "episode_return_mean": -2410.1692616382506, "episodes_this_iter": 23}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1532654, "num_agent_steps_trained": 1532654, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.61187515445357, "num_env_steps_trained_throughput_per_sec": 76.61187515445357, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1532654, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1532654, "timers": {"training_iteration_time_ms": 48277.717, "restore_workers_time_ms": 0.025, "training_step_time_ms": 48277.65, "sample_time_ms": 3209.045, "learn_time_ms": 45013.134, "learn_throughput": 88.863, "synch_weights_time_ms": 52.694}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1532654, "num_agent_steps_trained": 1532654}, "done": false, "training_iteration": 88, "trial_id": "05c72_00000", "date": "2024-07-26_15-54-43", "timestamp": 1721989483, "time_this_iter_s": 52.22122383117676, "time_total_s": 4300.486933469772, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd014bbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4300.486933469772, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 10.781081081081082, "ram_util_percent": 30.122972972972967}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 136.56169178727745, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000007, "total_loss": 4.580911183587595, "policy_loss": -0.00030449318692789994, "vf_loss": 4.595927655581691, "vf_explained_var": 0.9768433469649098, "kl": 0.015678817602684317, "entropy": 2.6618079834514194, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.47101449275362, "num_grad_updates_lifetime": 362580.5, "diff_num_grad_updates_vs_sampler_policy": 2069.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1550245, "num_agent_steps_trained": 1550245}, "env_runners": {"episode_reward_max": -693.6280167328143, "episode_reward_min": -4480.583970223075, "episode_reward_mean": -2489.6582289450766, "episode_len_mean": 148.37, "episode_media": {}, "episodes_timesteps_total": 14837, "policy_reward_min": {"policy_0": -1486.0918414535652}, "policy_reward_max": {"policy_0": -5.0095301775543515}, "policy_reward_mean": {"policy_0": -497.93164578901536}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3180.0517258280056, -1837.6385185209508, -2579.5132196678455, -1971.6007663503322, -3247.1875683924923, -2028.5204574543177, -2144.7780766096503, -4445.197917677206, -2032.0870460012886, -2190.9835225471734, -1889.4038140108912, -2859.484667372653, -949.1167837077772, -2452.040534935497, -2499.5644203557417, -2240.65657195845, -2755.760646790539, -3059.722491830215, -4092.3582003840997, -2405.7110201234505, -693.6280167328143, -2462.7090640370047, -2482.141041533937, -1766.9244838283987, -1688.7554401762923, -2216.189185590999, -2295.0350795050867, -2157.5985891723917, -1598.302872799256, -997.665980956999, -2535.701284735035, -3169.2598493419036, -2292.6336216827294, -2629.979870272225, -1729.9543615814796, -1542.7984778922848, -2941.206929829439, -1894.2864457923522, -3432.127568718826, -2204.957665836154, -2668.9977812301972, -976.0217979548898, -1800.401263114364, -3022.5083131507163, -2769.1823589249548, -2148.8771734634033, -1828.906711774056, -2269.9967624993133, -3468.0769425295703, -3401.4567862704753, -2952.286322124557, -4098.882539042586, -2361.3216881947656, -2270.4639116432404, -2017.9319009881083, -2354.1599206548426, -3126.2832463797117, -3890.2244450853354, -3152.564473123854, -2123.1597436576462, -2372.533864778301, -3262.2058224978223, -1719.7586339341347, -2703.86692891042, -3885.738646072262, -1860.9551399749669, -3344.778912573221, -1782.0673932018121, -2780.1730769392248, -2780.875162078862, -3696.0797124747282, -3161.921740769047, -3369.015111281236, -2551.126308037103, -1007.5064513777107, -3894.344452160803, -2186.570464962872, -1822.8002238567221, -2089.4286960830304, -1868.90265438871, -4072.5903403161924, -1829.660359698275, -2371.6622475051963, -2827.741277723753, -4480.583970223075, -3661.6981081871745, -1849.9887655168677, -1432.1216767774017, -2804.4157559606388, -2773.044984135561, -3758.246957955117, -1883.7403589065864, -2154.5849965583525, -2618.945256884598, -1442.6980813304933, -3290.028430271576, -2431.2755760371106, -1640.3352540468902, -2292.0541486730763, -914.8190691059573], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 116], "policy_policy_0_reward": [-914.3854171070734, -97.64917023050998, -1109.67138658663, -1036.392172935703, -21.953578968088955, -145.94186262089343, -35.37894992048685, -105.99705988362182, -1344.3901738854547, -205.9304722104934, -197.65290115978675, -606.8842235383644, -953.8092019462152, -585.6861099290968, -235.4807830943816, -271.46741489944253, -305.19711452033107, -220.29286854960924, -896.2894044868962, -278.35396389405423, -352.67270118233336, -126.71505484914975, -1416.2294229253882, -1122.5066120083973, -229.06377742722165, -181.86517059760166, -797.8192416959134, -307.11044844645005, -415.1937159573282, -326.5318807570228, -358.3142427172324, -668.5322169928219, -578.3338018289097, -306.6653403969759, -232.93247467370853, -1100.5915267553119, -1452.3970241752286, -51.8617154854916, -727.7705673555024, -1112.5770839056665, -598.1643133826378, -289.55157441737157, -638.769111836522, -73.1506619945413, -432.4513843702161, -192.4476558609601, -97.43823409830841, -1277.6444379590287, -465.7283066005717, -157.724888028304, -668.1545816910944, -107.31056963160466, -396.47852967356897, -556.2365088926058, -161.22362412201903, -912.8712310908595, -600.2722309559948, -410.90678761175764, -392.0570022233232, -543.377415490715, -151.31048084740718, -258.3966807993387, -33.982002646886194, -420.5931289281745, -84.83449048597095, -888.4696341194556, -257.37689675160044, -500.76254456775354, -115.80483361025853, -689.626625886429, -137.81211868614184, -55.54703825758505, -716.5686154141875, -517.6100111487744, -1072.0266368490506, -1031.4164136616696, -469.7641492870192, -80.49259913739017, -283.8981447057247, -375.0852651666512, -925.7273503093036, -895.0927279032284, -330.1373305119213, -566.0135390143904, -38.78969905169534, -1037.3270573896225, -372.5590522161697, -322.0410554255644, -217.36904371716147, -1110.4262830816979, -848.2518383563555, -261.87761487119815, -428.3044068770292, -1421.3648845999203, -1132.5594556796004, -610.1281982080674, -434.9577667326042, -322.67420233003145, -563.0175490266156, -474.9333038261321, -84.86309979650974, -396.6196775477223, -98.75287233326912, -64.5058975099288, -48.886469545384095, -772.663944319191, -337.6566336521982, -220.85751426529347, -131.3747964118822, -1000.1561753884414, -607.8288724225627, -138.2633809858627, -36.7354157291728, -962.1875973634938, -737.1257750328456, -95.89404740257957, -97.17098869260988, -975.1504752140506, -508.8562136242074, -89.85275889495013, -238.92529082154917, -123.8427178196866, -501.7385171033571, -331.4244205679761, -492.8244938637237, -846.4848784316413, -573.59938268679, -174.22740976644238, -600.0115306012509, -21.865984104872286, -92.7643717273357, -1033.4401688243968, -996.1102182608543, -118.214472397544, -54.50584829495578, -1145.7030165328729, -124.23254930222124, -631.2865472098267, -135.33645593701053, -121.04002019046186, -71.28078381812563, -80.30187348641557, -121.12926623448325, -1198.3552872999353, -127.23566196029606, -55.19746989187594, -127.3444688618405, -113.7453200634145, -670.0188555624417, -31.35986657742691, -438.3121693577796, -359.8586547818118, -1136.0672501091221, -125.41305224354716, -476.05015824277416, -415.6327403132633, -158.437143963049, -1013.1751624250344, -697.3464701577257, -884.6683324828305, -728.7512670332076, -720.2307350683564, -303.27105799247244, -329.14322636789046, -211.23733522080227, -64.79831322610536, -730.9361148362286, -759.6920806513494, -244.35956743308142, -830.1937941254607, -911.1216604924766, -95.5160352545559, -288.16739525019017, -43.192902695291046, -391.9563678889654, -63.383032770353054, -848.2467908480703, -471.45302091802614, -18.76976049883534, -140.94587285699978, -169.09604060190327, -363.87975829305486, -30.42536941222013, -891.713920068693, -1486.0918414535652, -717.2168936178605, -192.02595493283113, -687.3070298731484, -84.6853967998523, -213.05117056865913, -230.17377333442337, -1316.875202592862, -286.6048494449574, -599.3271407856199, -999.1466025609626, -717.451485309509, -195.8539873604738, -17.665977228650647, -431.0545988997004, -842.931617037819, -458.45552559564703, -483.7526545298079, -1390.3918165645275, -210.4969390933857, -125.90084544682912, -104.09954762367765, -361.2644987396406, -244.4994421837359, -136.3001725906032, -129.85813681723207, -406.4395622441748, -192.65263203397018, -123.09049993018903, -533.9847656741601, -544.2338032318714, -551.4058636897732, -22.01222228526647, -785.6876208166253, -946.3396010470408, -717.0630053120112, -270.09133344185426, -109.10326080573043, -1235.4686455099115, -66.54170036631871, -1087.9774188011402, -1285.140747636611, -344.9671531216498, -241.9238536279517, -211.0961828636876, -65.7492362135022, -496.3619903986756, -264.11860014856353, -424.7683697965795, -520.8414946972695, -122.81625673296728, -1257.9925616403368, -94.13605028373311, -25.18530055695198, -131.6011474435599, -761.0817025747322, -726.042498009292, -754.906452410077, -338.449017808494, -855.3211167845074, -793.3578575172038, -852.3165893059517, -89.59553020277326, -991.8696268100483, -1345.9761514529055, -121.69888849879513, -162.77591149238177, -337.60663515049094, -571.6900127562928, -523.3761290272937, -1356.8376336981012, -730.1791946704668, -1178.6997089509302, -967.8011882156084, -1163.4612979594551, -58.741149246123975, -5.0095301775543515, -384.13930759254856, -951.6601485288066, -97.9513118246965, -922.5613900711589, -358.45216131171526, -1183.3518711463037, -109.498811662827, -543.2848201199441, -75.8762474024501, -808.3988148427287, -243.56295050156467, -504.8625634919134, -214.15855732273224, -246.9490148291697, -1223.0984691558956, -348.77782380765257, -628.5759199214273, -110.9301623775469, -42.77754539232205, -159.79455484632888, -1081.1170354454196, -319.66683913570023, -840.0845615478573, -725.6202554044079, -1181.0173520247836, -248.6293090910626, -955.391409455107, -1152.5205978026383, -352.66577671174383, -672.0870702075637, -846.0851032687832, -387.04427593862187, -530.4362844931637, -716.9117392157184, -402.87032982180233, -160.6322638601285, -890.225552863797, -532.6178784781948, -136.81371863372357, -85.68922364158652, -487.698087359332, -448.3662298021851, -435.50360058762175, -915.2767233875758, -652.0781093175107, -1008.1356594732905, -22.823579538665747, -1364.128327302131, -215.0401468662245, -88.41335176377983, -926.9335942916584, -13.685702476832466, -631.8106239073059, -58.9153614945577, -172.66299136943258, -909.6554035454009, -852.53477347209, -650.3125459466223, -118.70121457687347, -198.97804155863628, -1191.5897566377482, -1316.7842697842616, -496.3086859313956, -682.0778921602217, -505.3321130030991, -102.49165718420848, -334.55190524854277, -626.7370671812618, -291.84239735785525, -228.49500158076148, -1122.714064382723, -1229.9893726298596, -366.05375164364517, -397.5267223362327, -311.732896668918, -573.5079615021705, -846.8676517830853, -13.106639206430925, -36.85224404120683, -449.7999916045691, -560.5461560694075, -352.5520963856644, -1032.342205031234, -384.9326278483482, -810.4643368821612, -157.86023297646682, -184.53505121467057, -484.1802449708169, -1143.835296034748, -290.300624150322, -229.53288746032186, -1148.093138838897, -1245.6980028234289, -782.4550592017592, -573.8156288481516, -349.5203544597416, -176.06333680811085, -1178.0452935460876, -884.4771271069568, -96.28918805467217, -1098.7449682076854, -51.78500847910721, -985.5002536933841, -1136.6956928463874, -148.73483184378787, -796.2274477126659, -339.62468266501145, -1100.9150795515345, -165.62426626410237, -414.3601218515369, -92.73830369411503, -128.32352932720605, -354.31519559828797, -17.769300906564638, -491.2054752326598, -655.3953634180548, -1207.5727725690242, -787.9566081330089, -752.21423280805, -458.968750587739, -45.494873800138194, -541.8889424840573, -723.9841763909479, -416.23372169999175, -585.5216129241843, -86.42281932828413, -634.2552485355063, -116.12146421113691, -400.47907885761424, -46.70976553809062, -546.8154980537479, -879.184050275132, -93.58037916385594, -523.1390030522048, -313.39657623269414, -146.44385593366107, -406.99445782291565, -443.0282484424687, -559.0395159569697, -847.2652661421741, -738.0578816310253, -982.4420610160556, -537.2943888030419, -967.5307427238972, -477.8554878615008, -63.35995217755016, -402.88847329093244, -781.9450681018582, -103.61137826643272, -1171.1768728156667, -57.619494744507975, -121.62177563700165, -918.9797516404784, -102.26435266754004, -472.86677249616025, -728.1680522856393, -622.0894898424071, -744.7327307276356, -259.88423237191125, -966.9631109770138, -856.0378216601907, -970.2721240426499, -510.6423405576139, -1176.6685729856072, -394.52987951628785, -907.7195709020748, -1340.1946638380114, -750.5825246506922, -268.6714692801079, -226.53018385578645, -212.99749037799302, -111.36074480728543, -340.056458924962, -959.0438875508415, -214.3795079108193, -57.285467994937605, -287.0780771416019, -129.53850554984294, -743.8401181801989, -718.4804884538229, -850.2477967915213, -25.66315593055234, -467.3125174945765, -742.7117972901679, -946.989275661996, -438.81168864951997, -651.0328228931256, -20.123021861785222, -716.0881750691386, -1104.1813987368093, -844.8847691452697, -822.1516502138887, -178.56267431061542, -808.4664655485309, -158.1935786261291, -24.924193796302152, -1212.9164162936122, -10.971604833728811, -476.7345653568149, -1004.677335931729, -633.7212116544537, -98.50033584769015, -280.2551651400945, -137.43094798438565, -663.8948896340654, -289.8414647928762, -1033.6646459967085, -509.0163625956985, -122.52789386524918, -62.29309975314488, -377.33972130306336, -78.9245832379706, -622.1557665468512, -301.98491048946295, -557.5230919367584, -789.7252688313074, -80.39819840664796, -1130.1153272236215, -732.2665438732392, -527.7386384719383, -636.3271489095135, -365.0946838808027, -112.8388251413675, -789.2762796334861, -201.76167708938493, -574.7087083536005, -51.05567704537042, -110.79966683915082, -702.0095247193829, -223.66549814561168, -479.3021477753405, -272.91456832891157, -1002.1338980793788, -314.03803634383405, -62.85972575160363, -270.9036184722516, -105.0045326536859, -106.83607328452098, -369.2151189438946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5333238611064544, "mean_inference_ms": 1.7164005014633366, "mean_action_processing_ms": 0.7953437269793235, "mean_env_wait_ms": 10.242178049359941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012750625610351562, "StateBufferConnector_ms": 0.008917093276977539, "ViewRequirementAgentConnector_ms": 0.2929258346557617}, "num_episodes": 32, "episode_return_max": -693.6280167328143, "episode_return_min": -4480.583970223075, "episode_return_mean": -2489.6582289450766, "episodes_this_iter": 32}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1550245, "num_agent_steps_trained": 1550245, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.81393458898401, "num_env_steps_trained_throughput_per_sec": 77.81393458898401, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1550245, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1550245, "timers": {"training_iteration_time_ms": 48785.624, "restore_workers_time_ms": 0.024, "training_step_time_ms": 48785.558, "sample_time_ms": 3218.4, "learn_time_ms": 45511.65, "learn_throughput": 87.89, "synch_weights_time_ms": 52.664}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1550245, "num_agent_steps_trained": 1550245}, "done": false, "training_iteration": 89, "trial_id": "05c72_00000", "date": "2024-07-26_15-55-34", "timestamp": 1721989534, "time_this_iter_s": 51.41543436050415, "time_total_s": 4351.9023678302765, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd0148e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4351.9023678302765, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 11.29041095890411, "ram_util_percent": 30.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 122.7361515059507, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 5.017119735046138, "policy_loss": 0.0010150312500326593, "vf_loss": 5.029908173604119, "vf_explained_var": 0.977508966262478, "kl": 0.016022152059191, "entropy": 2.5970291658750453, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.64661654135338, "num_grad_updates_lifetime": 366645.5, "diff_num_grad_updates_vs_sampler_policy": 1994.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1567222, "num_agent_steps_trained": 1567222}, "env_runners": {"episode_reward_max": -914.8190691059573, "episode_reward_min": -5019.561278111249, "episode_reward_mean": -2560.9622265180583, "episode_len_mean": 148.46, "episode_media": {}, "episodes_timesteps_total": 14846, "policy_reward_min": {"policy_0": -1544.662061040414}, "policy_reward_max": {"policy_0": 3.9107427053607315}, "policy_reward_mean": {"policy_0": -512.1924453036116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2295.0350795050867, -2157.5985891723917, -1598.302872799256, -997.665980956999, -2535.701284735035, -3169.2598493419036, -2292.6336216827294, -2629.979870272225, -1729.9543615814796, -1542.7984778922848, -2941.206929829439, -1894.2864457923522, -3432.127568718826, -2204.957665836154, -2668.9977812301972, -976.0217979548898, -1800.401263114364, -3022.5083131507163, -2769.1823589249548, -2148.8771734634033, -1828.906711774056, -2269.9967624993133, -3468.0769425295703, -3401.4567862704753, -2952.286322124557, -4098.882539042586, -2361.3216881947656, -2270.4639116432404, -2017.9319009881083, -2354.1599206548426, -3126.2832463797117, -3890.2244450853354, -3152.564473123854, -2123.1597436576462, -2372.533864778301, -3262.2058224978223, -1719.7586339341347, -2703.86692891042, -3885.738646072262, -1860.9551399749669, -3344.778912573221, -1782.0673932018121, -2780.1730769392248, -2780.875162078862, -3696.0797124747282, -3161.921740769047, -3369.015111281236, -2551.126308037103, -1007.5064513777107, -3894.344452160803, -2186.570464962872, -1822.8002238567221, -2089.4286960830304, -1868.90265438871, -4072.5903403161924, -1829.660359698275, -2371.6622475051963, -2827.741277723753, -4480.583970223075, -3661.6981081871745, -1849.9887655168677, -1432.1216767774017, -2804.4157559606388, -2773.044984135561, -3758.246957955117, -1883.7403589065864, -2154.5849965583525, -2618.945256884598, -1442.6980813304933, -3290.028430271576, -2431.2755760371106, -1640.3352540468902, -2292.0541486730763, -914.8190691059573, -2878.580149460874, -3556.922404017724, -1110.5205974898802, -2511.673276442728, -3107.7436563705473, -1593.110344642568, -2471.752761149474, -2069.923058464887, -2985.630053331473, -1530.0700476584564, -3381.023459056028, -3097.5537845281165, -2823.8809126477, -2427.2292720676774, -2954.4359273515724, -3116.255592978584, -1993.956282700618, -3052.636668502766, -3748.813350252695, -2983.90866644715, -5019.561278111249, -1495.1337662251942, -2289.560079686227, -1714.1420203739651, -2349.095281625283, -3039.0122681327516], "episode_lengths": [150, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 116, 150, 150, 103, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-92.7643717273357, -1033.4401688243968, -996.1102182608543, -118.214472397544, -54.50584829495578, -1145.7030165328729, -124.23254930222124, -631.2865472098267, -135.33645593701053, -121.04002019046186, -71.28078381812563, -80.30187348641557, -121.12926623448325, -1198.3552872999353, -127.23566196029606, -55.19746989187594, -127.3444688618405, -113.7453200634145, -670.0188555624417, -31.35986657742691, -438.3121693577796, -359.8586547818118, -1136.0672501091221, -125.41305224354716, -476.05015824277416, -415.6327403132633, -158.437143963049, -1013.1751624250344, -697.3464701577257, -884.6683324828305, -728.7512670332076, -720.2307350683564, -303.27105799247244, -329.14322636789046, -211.23733522080227, -64.79831322610536, -730.9361148362286, -759.6920806513494, -244.35956743308142, -830.1937941254607, -911.1216604924766, -95.5160352545559, -288.16739525019017, -43.192902695291046, -391.9563678889654, -63.383032770353054, -848.2467908480703, -471.45302091802614, -18.76976049883534, -140.94587285699978, -169.09604060190327, -363.87975829305486, -30.42536941222013, -891.713920068693, -1486.0918414535652, -717.2168936178605, -192.02595493283113, -687.3070298731484, -84.6853967998523, -213.05117056865913, -230.17377333442337, -1316.875202592862, -286.6048494449574, -599.3271407856199, -999.1466025609626, -717.451485309509, -195.8539873604738, -17.665977228650647, -431.0545988997004, -842.931617037819, -458.45552559564703, -483.7526545298079, -1390.3918165645275, -210.4969390933857, -125.90084544682912, -104.09954762367765, -361.2644987396406, -244.4994421837359, -136.3001725906032, -129.85813681723207, -406.4395622441748, -192.65263203397018, -123.09049993018903, -533.9847656741601, -544.2338032318714, -551.4058636897732, -22.01222228526647, -785.6876208166253, -946.3396010470408, -717.0630053120112, -270.09133344185426, -109.10326080573043, -1235.4686455099115, -66.54170036631871, -1087.9774188011402, -1285.140747636611, -344.9671531216498, -241.9238536279517, -211.0961828636876, -65.7492362135022, -496.3619903986756, -264.11860014856353, -424.7683697965795, -520.8414946972695, -122.81625673296728, -1257.9925616403368, -94.13605028373311, -25.18530055695198, -131.6011474435599, -761.0817025747322, -726.042498009292, -754.906452410077, -338.449017808494, -855.3211167845074, -793.3578575172038, -852.3165893059517, -89.59553020277326, -991.8696268100483, -1345.9761514529055, -121.69888849879513, -162.77591149238177, -337.60663515049094, -571.6900127562928, -523.3761290272937, -1356.8376336981012, -730.1791946704668, -1178.6997089509302, -967.8011882156084, -1163.4612979594551, -58.741149246123975, -5.0095301775543515, -384.13930759254856, -951.6601485288066, -97.9513118246965, -922.5613900711589, -358.45216131171526, -1183.3518711463037, -109.498811662827, -543.2848201199441, -75.8762474024501, -808.3988148427287, -243.56295050156467, -504.8625634919134, -214.15855732273224, -246.9490148291697, -1223.0984691558956, -348.77782380765257, -628.5759199214273, -110.9301623775469, -42.77754539232205, -159.79455484632888, -1081.1170354454196, -319.66683913570023, -840.0845615478573, -725.6202554044079, -1181.0173520247836, -248.6293090910626, -955.391409455107, -1152.5205978026383, -352.66577671174383, -672.0870702075637, -846.0851032687832, -387.04427593862187, -530.4362844931637, -716.9117392157184, -402.87032982180233, -160.6322638601285, -890.225552863797, -532.6178784781948, -136.81371863372357, -85.68922364158652, -487.698087359332, -448.3662298021851, -435.50360058762175, -915.2767233875758, -652.0781093175107, -1008.1356594732905, -22.823579538665747, -1364.128327302131, -215.0401468662245, -88.41335176377983, -926.9335942916584, -13.685702476832466, -631.8106239073059, -58.9153614945577, -172.66299136943258, -909.6554035454009, -852.53477347209, -650.3125459466223, -118.70121457687347, -198.97804155863628, -1191.5897566377482, -1316.7842697842616, -496.3086859313956, -682.0778921602217, -505.3321130030991, -102.49165718420848, -334.55190524854277, -626.7370671812618, -291.84239735785525, -228.49500158076148, -1122.714064382723, -1229.9893726298596, -366.05375164364517, -397.5267223362327, -311.732896668918, -573.5079615021705, -846.8676517830853, -13.106639206430925, -36.85224404120683, -449.7999916045691, -560.5461560694075, -352.5520963856644, -1032.342205031234, -384.9326278483482, -810.4643368821612, -157.86023297646682, -184.53505121467057, -484.1802449708169, -1143.835296034748, -290.300624150322, -229.53288746032186, -1148.093138838897, -1245.6980028234289, -782.4550592017592, -573.8156288481516, -349.5203544597416, -176.06333680811085, -1178.0452935460876, -884.4771271069568, -96.28918805467217, -1098.7449682076854, -51.78500847910721, -985.5002536933841, -1136.6956928463874, -148.73483184378787, -796.2274477126659, -339.62468266501145, -1100.9150795515345, -165.62426626410237, -414.3601218515369, -92.73830369411503, -128.32352932720605, -354.31519559828797, -17.769300906564638, -491.2054752326598, -655.3953634180548, -1207.5727725690242, -787.9566081330089, -752.21423280805, -458.968750587739, -45.494873800138194, -541.8889424840573, -723.9841763909479, -416.23372169999175, -585.5216129241843, -86.42281932828413, -634.2552485355063, -116.12146421113691, -400.47907885761424, -46.70976553809062, -546.8154980537479, -879.184050275132, -93.58037916385594, -523.1390030522048, -313.39657623269414, -146.44385593366107, -406.99445782291565, -443.0282484424687, -559.0395159569697, -847.2652661421741, -738.0578816310253, -982.4420610160556, -537.2943888030419, -967.5307427238972, -477.8554878615008, -63.35995217755016, -402.88847329093244, -781.9450681018582, -103.61137826643272, -1171.1768728156667, -57.619494744507975, -121.62177563700165, -918.9797516404784, -102.26435266754004, -472.86677249616025, -728.1680522856393, -622.0894898424071, -744.7327307276356, -259.88423237191125, -966.9631109770138, -856.0378216601907, -970.2721240426499, -510.6423405576139, -1176.6685729856072, -394.52987951628785, -907.7195709020748, -1340.1946638380114, -750.5825246506922, -268.6714692801079, -226.53018385578645, -212.99749037799302, -111.36074480728543, -340.056458924962, -959.0438875508415, -214.3795079108193, -57.285467994937605, -287.0780771416019, -129.53850554984294, -743.8401181801989, -718.4804884538229, -850.2477967915213, -25.66315593055234, -467.3125174945765, -742.7117972901679, -946.989275661996, -438.81168864951997, -651.0328228931256, -20.123021861785222, -716.0881750691386, -1104.1813987368093, -844.8847691452697, -822.1516502138887, -178.56267431061542, -808.4664655485309, -158.1935786261291, -24.924193796302152, -1212.9164162936122, -10.971604833728811, -476.7345653568149, -1004.677335931729, -633.7212116544537, -98.50033584769015, -280.2551651400945, -137.43094798438565, -663.8948896340654, -289.8414647928762, -1033.6646459967085, -509.0163625956985, -122.52789386524918, -62.29309975314488, -377.33972130306336, -78.9245832379706, -622.1557665468512, -301.98491048946295, -557.5230919367584, -789.7252688313074, -80.39819840664796, -1130.1153272236215, -732.2665438732392, -527.7386384719383, -636.3271489095135, -365.0946838808027, -112.8388251413675, -789.2762796334861, -201.76167708938493, -574.7087083536005, -51.05567704537042, -110.79966683915082, -702.0095247193829, -223.66549814561168, -479.3021477753405, -272.91456832891157, -1002.1338980793788, -314.03803634383405, -62.85972575160363, -270.9036184722516, -105.0045326536859, -106.83607328452098, -369.2151189438946, -602.0502640717573, -564.013452306675, -402.7237142397003, -741.45692912309, -568.3357897196504, -401.4259364590691, -733.6289147997657, -1194.0529238771037, -870.0370266212099, -357.7776022605777, -400.9597955231054, -113.00614127606974, -110.10439801026557, -305.18622451161156, -181.264038168829, -1059.8555808392139, -415.03038746612367, -102.10603965407317, -795.3467940560138, -139.3344744273052, -3.812349186847021, -772.0047020421925, -1069.7007900218096, -34.053657358472336, -1228.172157761224, -461.28810647119667, -37.43493995219172, -153.69742338821905, -256.4086946366862, -684.2811801942748, -844.8916767308056, -120.22214428248523, -81.12371995584542, -430.3524010517831, -995.1628191285521, -363.8042025625635, -167.46953336606282, -675.4442906622727, -610.8338132843187, -252.37121858966972, -681.1423994530322, -1022.4294908353771, -147.30353531409713, -718.1560239211013, -416.598603807863, -266.62259349538226, -271.2738289627024, -817.0497495804073, -139.6980255959431, -35.42585002402137, -516.9015971281606, -1053.6194213493009, -821.7197898278065, -475.8423203649728, -512.9403303857896, -244.58829453510637, -1124.6152539525133, -708.4694819516495, -458.98172590810566, -560.8990281807393, -181.4569711370829, -225.37954637134789, -510.4192462708316, -1125.1967346873698, -781.4284141810683, -113.38760736122187, -963.6544940712741, -524.6025816116037, -549.551757578236, -276.0328314453382, -1544.662061040414, -94.87085521146697, -845.9066943226072, -57.866503781765644, -411.1298129953171, -68.82592323763329, -866.3472990793392, -752.5082303389211, -517.9201093513134, -910.6540309713768, -519.9737804035295, -53.90741681159579, -755.970281131563, -637.2582675352011, -26.846536818729753, -407.2929292230653, -572.5547493678979, -881.1739798863088, -502.43098987700205, -689.1840201484931, -411.6369743221938, -701.809795809244, -834.3809297101425, -648.2832893109489, -1152.7023611001625, -735.6367293537987, -280.99405047029404, -1363.7135568845572, -442.8423714388791, -160.7219582996192, -1207.0518933681108, -387.9851193171462, -1284.6074984665559, -1195.439911684962, -944.4768552744742, -75.58766689581296, -666.1433283988289, -171.7557249432094, -15.056606735271558, -566.5904392520723, -537.2838615678852, -564.9309906297948, -385.3024445781236, -681.6197445798853, -120.42303833053707, -44.947205469050964, -55.40864305175847, -1232.736229726524, -305.37258922147976, -75.67735290515184, -365.46689439915997, -794.8470282457212, -71.29111357866498, -182.43841842066675, -935.0518269810713, -477.2616014896015, -1009.9745116014865, 3.9107427053607315, -839.7592716096192, -715.9276261374023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.532940625922988, "mean_inference_ms": 1.7157115177440725, "mean_action_processing_ms": 0.7947060310053675, "mean_env_wait_ms": 10.240131556946585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012974262237548828, "StateBufferConnector_ms": 0.00921010971069336, "ViewRequirementAgentConnector_ms": 0.308229923248291}, "num_episodes": 26, "episode_return_max": -914.8190691059573, "episode_return_min": -5019.561278111249, "episode_return_mean": -2560.9622265180583, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1567222, "num_agent_steps_trained": 1567222, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 93.10610423608341, "num_env_steps_trained_throughput_per_sec": 93.10610423608341, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1567222, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1567222, "timers": {"training_iteration_time_ms": 48442.489, "restore_workers_time_ms": 0.024, "training_step_time_ms": 48442.423, "sample_time_ms": 3223.668, "learn_time_ms": 45162.517, "learn_throughput": 88.569, "synch_weights_time_ms": 53.414}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1567222, "num_agent_steps_trained": 1567222}, "done": false, "training_iteration": 90, "trial_id": "05c72_00000", "date": "2024-07-26_15-56-17", "timestamp": 1721989577, "time_this_iter_s": 42.97235727310181, "time_total_s": 4394.874725103378, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd014b7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4394.874725103378, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 11.96774193548387, "ram_util_percent": 30.11612903225807}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 141.43712457415361, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.743728383258948, "policy_loss": 0.0009652155102531423, "vf_loss": 4.759510812710114, "vf_explained_var": 0.983896527826324, "kl": 0.015457861735822406, "entropy": 2.8485961528403507, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.56589147286822, "num_grad_updates_lifetime": 370575.5, "diff_num_grad_updates_vs_sampler_policy": 1934.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1583678, "num_agent_steps_trained": 1583678}, "env_runners": {"episode_reward_max": -722.8682590061661, "episode_reward_min": -5019.561278111249, "episode_reward_mean": -2572.402080404556, "episode_len_mean": 147.79, "episode_media": {}, "episodes_timesteps_total": 14779, "policy_reward_min": {"policy_0": -1544.662061040414}, "policy_reward_max": {"policy_0": 3.9107427053607315}, "policy_reward_mean": {"policy_0": -514.480416080911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4098.882539042586, -2361.3216881947656, -2270.4639116432404, -2017.9319009881083, -2354.1599206548426, -3126.2832463797117, -3890.2244450853354, -3152.564473123854, -2123.1597436576462, -2372.533864778301, -3262.2058224978223, -1719.7586339341347, -2703.86692891042, -3885.738646072262, -1860.9551399749669, -3344.778912573221, -1782.0673932018121, -2780.1730769392248, -2780.875162078862, -3696.0797124747282, -3161.921740769047, -3369.015111281236, -2551.126308037103, -1007.5064513777107, -3894.344452160803, -2186.570464962872, -1822.8002238567221, -2089.4286960830304, -1868.90265438871, -4072.5903403161924, -1829.660359698275, -2371.6622475051963, -2827.741277723753, -4480.583970223075, -3661.6981081871745, -1849.9887655168677, -1432.1216767774017, -2804.4157559606388, -2773.044984135561, -3758.246957955117, -1883.7403589065864, -2154.5849965583525, -2618.945256884598, -1442.6980813304933, -3290.028430271576, -2431.2755760371106, -1640.3352540468902, -2292.0541486730763, -914.8190691059573, -2878.580149460874, -3556.922404017724, -1110.5205974898802, -2511.673276442728, -3107.7436563705473, -1593.110344642568, -2471.752761149474, -2069.923058464887, -2985.630053331473, -1530.0700476584564, -3381.023459056028, -3097.5537845281165, -2823.8809126477, -2427.2292720676774, -2954.4359273515724, -3116.255592978584, -1993.956282700618, -3052.636668502766, -3748.813350252695, -2983.90866644715, -5019.561278111249, -1495.1337662251942, -2289.560079686227, -1714.1420203739651, -2349.095281625283, -3039.0122681327516, -3093.6508172754143, -2269.6648884923347, -2647.2994480354787, -798.6016700701517, -2675.308386845201, -1429.0406282687234, -2211.0326016075664, -2048.899630128569, -2428.3177063218513, -2976.266818426442, -2278.220865486387, -1719.1837027947554, -2464.8304686234706, -1943.8658759114844, -1432.9831005591145, -3199.253974316896, -2685.59279113374, -722.8682590061661, -3572.1797879627698, -3153.4851417171517, -1647.2599417997433, -2475.9816914569, -4737.317991769651, -1899.4371038134457, -3361.6629079789805], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 116, 150, 150, 103, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-730.1791946704668, -1178.6997089509302, -967.8011882156084, -1163.4612979594551, -58.741149246123975, -5.0095301775543515, -384.13930759254856, -951.6601485288066, -97.9513118246965, -922.5613900711589, -358.45216131171526, -1183.3518711463037, -109.498811662827, -543.2848201199441, -75.8762474024501, -808.3988148427287, -243.56295050156467, -504.8625634919134, -214.15855732273224, -246.9490148291697, -1223.0984691558956, -348.77782380765257, -628.5759199214273, -110.9301623775469, -42.77754539232205, -159.79455484632888, -1081.1170354454196, -319.66683913570023, -840.0845615478573, -725.6202554044079, -1181.0173520247836, -248.6293090910626, -955.391409455107, -1152.5205978026383, -352.66577671174383, -672.0870702075637, -846.0851032687832, -387.04427593862187, -530.4362844931637, -716.9117392157184, -402.87032982180233, -160.6322638601285, -890.225552863797, -532.6178784781948, -136.81371863372357, -85.68922364158652, -487.698087359332, -448.3662298021851, -435.50360058762175, -915.2767233875758, -652.0781093175107, -1008.1356594732905, -22.823579538665747, -1364.128327302131, -215.0401468662245, -88.41335176377983, -926.9335942916584, -13.685702476832466, -631.8106239073059, -58.9153614945577, -172.66299136943258, -909.6554035454009, -852.53477347209, -650.3125459466223, -118.70121457687347, -198.97804155863628, -1191.5897566377482, -1316.7842697842616, -496.3086859313956, -682.0778921602217, -505.3321130030991, -102.49165718420848, -334.55190524854277, -626.7370671812618, -291.84239735785525, -228.49500158076148, -1122.714064382723, -1229.9893726298596, -366.05375164364517, -397.5267223362327, -311.732896668918, -573.5079615021705, -846.8676517830853, -13.106639206430925, -36.85224404120683, -449.7999916045691, -560.5461560694075, -352.5520963856644, -1032.342205031234, -384.9326278483482, -810.4643368821612, -157.86023297646682, -184.53505121467057, -484.1802449708169, -1143.835296034748, -290.300624150322, -229.53288746032186, -1148.093138838897, -1245.6980028234289, -782.4550592017592, -573.8156288481516, -349.5203544597416, -176.06333680811085, -1178.0452935460876, -884.4771271069568, -96.28918805467217, -1098.7449682076854, -51.78500847910721, -985.5002536933841, -1136.6956928463874, -148.73483184378787, -796.2274477126659, -339.62468266501145, -1100.9150795515345, -165.62426626410237, -414.3601218515369, -92.73830369411503, -128.32352932720605, -354.31519559828797, -17.769300906564638, -491.2054752326598, -655.3953634180548, -1207.5727725690242, -787.9566081330089, -752.21423280805, -458.968750587739, -45.494873800138194, -541.8889424840573, -723.9841763909479, -416.23372169999175, -585.5216129241843, -86.42281932828413, -634.2552485355063, -116.12146421113691, -400.47907885761424, -46.70976553809062, -546.8154980537479, -879.184050275132, -93.58037916385594, -523.1390030522048, -313.39657623269414, -146.44385593366107, -406.99445782291565, -443.0282484424687, -559.0395159569697, -847.2652661421741, -738.0578816310253, -982.4420610160556, -537.2943888030419, -967.5307427238972, -477.8554878615008, -63.35995217755016, -402.88847329093244, -781.9450681018582, -103.61137826643272, -1171.1768728156667, -57.619494744507975, -121.62177563700165, -918.9797516404784, -102.26435266754004, -472.86677249616025, -728.1680522856393, -622.0894898424071, -744.7327307276356, -259.88423237191125, -966.9631109770138, -856.0378216601907, -970.2721240426499, -510.6423405576139, -1176.6685729856072, -394.52987951628785, -907.7195709020748, -1340.1946638380114, -750.5825246506922, -268.6714692801079, -226.53018385578645, -212.99749037799302, -111.36074480728543, -340.056458924962, -959.0438875508415, -214.3795079108193, -57.285467994937605, -287.0780771416019, -129.53850554984294, -743.8401181801989, -718.4804884538229, -850.2477967915213, -25.66315593055234, -467.3125174945765, -742.7117972901679, -946.989275661996, -438.81168864951997, -651.0328228931256, -20.123021861785222, -716.0881750691386, -1104.1813987368093, -844.8847691452697, -822.1516502138887, -178.56267431061542, -808.4664655485309, -158.1935786261291, -24.924193796302152, -1212.9164162936122, -10.971604833728811, -476.7345653568149, -1004.677335931729, -633.7212116544537, -98.50033584769015, -280.2551651400945, -137.43094798438565, -663.8948896340654, -289.8414647928762, -1033.6646459967085, -509.0163625956985, -122.52789386524918, -62.29309975314488, -377.33972130306336, -78.9245832379706, -622.1557665468512, -301.98491048946295, -557.5230919367584, -789.7252688313074, -80.39819840664796, -1130.1153272236215, -732.2665438732392, -527.7386384719383, -636.3271489095135, -365.0946838808027, -112.8388251413675, -789.2762796334861, -201.76167708938493, -574.7087083536005, -51.05567704537042, -110.79966683915082, -702.0095247193829, -223.66549814561168, -479.3021477753405, -272.91456832891157, -1002.1338980793788, -314.03803634383405, -62.85972575160363, -270.9036184722516, -105.0045326536859, -106.83607328452098, -369.2151189438946, -602.0502640717573, -564.013452306675, -402.7237142397003, -741.45692912309, -568.3357897196504, -401.4259364590691, -733.6289147997657, -1194.0529238771037, -870.0370266212099, -357.7776022605777, -400.9597955231054, -113.00614127606974, -110.10439801026557, -305.18622451161156, -181.264038168829, -1059.8555808392139, -415.03038746612367, -102.10603965407317, -795.3467940560138, -139.3344744273052, -3.812349186847021, -772.0047020421925, -1069.7007900218096, -34.053657358472336, -1228.172157761224, -461.28810647119667, -37.43493995219172, -153.69742338821905, -256.4086946366862, -684.2811801942748, -844.8916767308056, -120.22214428248523, -81.12371995584542, -430.3524010517831, -995.1628191285521, -363.8042025625635, -167.46953336606282, -675.4442906622727, -610.8338132843187, -252.37121858966972, -681.1423994530322, -1022.4294908353771, -147.30353531409713, -718.1560239211013, -416.598603807863, -266.62259349538226, -271.2738289627024, -817.0497495804073, -139.6980255959431, -35.42585002402137, -516.9015971281606, -1053.6194213493009, -821.7197898278065, -475.8423203649728, -512.9403303857896, -244.58829453510637, -1124.6152539525133, -708.4694819516495, -458.98172590810566, -560.8990281807393, -181.4569711370829, -225.37954637134789, -510.4192462708316, -1125.1967346873698, -781.4284141810683, -113.38760736122187, -963.6544940712741, -524.6025816116037, -549.551757578236, -276.0328314453382, -1544.662061040414, -94.87085521146697, -845.9066943226072, -57.866503781765644, -411.1298129953171, -68.82592323763329, -866.3472990793392, -752.5082303389211, -517.9201093513134, -910.6540309713768, -519.9737804035295, -53.90741681159579, -755.970281131563, -637.2582675352011, -26.846536818729753, -407.2929292230653, -572.5547493678979, -881.1739798863088, -502.43098987700205, -689.1840201484931, -411.6369743221938, -701.809795809244, -834.3809297101425, -648.2832893109489, -1152.7023611001625, -735.6367293537987, -280.99405047029404, -1363.7135568845572, -442.8423714388791, -160.7219582996192, -1207.0518933681108, -387.9851193171462, -1284.6074984665559, -1195.439911684962, -944.4768552744742, -75.58766689581296, -666.1433283988289, -171.7557249432094, -15.056606735271558, -566.5904392520723, -537.2838615678852, -564.9309906297948, -385.3024445781236, -681.6197445798853, -120.42303833053707, -44.947205469050964, -55.40864305175847, -1232.736229726524, -305.37258922147976, -75.67735290515184, -365.46689439915997, -794.8470282457212, -71.29111357866498, -182.43841842066675, -935.0518269810713, -477.2616014896015, -1009.9745116014865, 3.9107427053607315, -839.7592716096192, -715.9276261374023, -642.3508274566422, -152.38209538178646, -595.9952896993768, -1211.5716669684257, -491.3509377691844, -93.32101924090325, -856.3832761228906, -874.8051547609999, -258.7986328213239, -186.35680554621558, -187.48079700776998, -997.0447965183075, -799.1812620296126, -556.5846590536662, -107.00793342612013, -172.37024472643117, -259.344482523567, -140.89112000478596, -163.05053420350632, -62.94528861186071, -407.8333815748718, -84.31182518615756, -732.8197541083547, -598.2142234535692, -852.1292025222465, -104.39194669240649, -171.13164261127173, -754.5172378093536, -282.33337081986014, -116.66643033583208, -94.08837256424819, -889.5237295553793, -345.02395296781407, -446.2358611274849, -436.16068539263694, -694.3438416567556, -232.94999903731215, -524.5491923762658, -184.1440353175583, -412.9125617406757, -935.3827443631538, -1111.764442551369, -93.5140272889613, -143.37940843292407, -144.27708368544265, -523.0204952378618, -105.51114352935795, -99.44415565123843, -720.2547753795138, -1528.03624862847, -428.1985404026775, -793.9137291600587, -316.7096633251208, -641.3945340308758, -98.00439856765463, -171.9840803827177, -238.1087798698963, -804.8386947459451, -180.88892093709953, -323.36322685909715, -773.4656345802506, -266.6125049239901, -840.8069942195002, -395.6973398713824, -188.24799502834858, -306.3541209561081, -41.901215382741384, -865.186674969657, -9.603591766242321, -720.8202728367357, -112.82961192965435, -412.94322582725687, -109.18620653774332, -36.07936404269217, -761.9446922217687, -127.0702641762426, -389.1600442224971, -1450.6910476816533, -941.642142934814, -290.6904753016896, -367.56739146452463, -796.9500584139029, -261.2476857171855, -917.2063423249951, -342.62131321313046, -110.34774561868433, -59.666185776290895, -196.32190014370343, -25.15516525859843, -331.37726220888834, -933.8767837514429, -586.0925874734072, -598.0054194330168, -1381.3400813702435, -72.86491593466259, -227.83891077296332, -1476.3024522127166, -181.79551938237134, -45.493331919430204, -1222.0549274296698, -148.17571493613914, -638.9633888299395, -316.88582985980366, -453.451702863563, -89.78330531029897, -142.0443941146185, -172.18127974965924, -284.54947149883503, -1116.749109034985, -760.4574370588011, -1156.4689253052607, -1474.4970427337635, -913.8976333505053, -1039.9665403666845, -152.48785001343848, -467.0821458448331, -37.20594930113268, -505.93601743402365, -809.0135705814548, -80.19942065200128, -115.31058697934908, -1258.7982957580134, -759.3817985639473, -269.9666575136939, -958.2055691639767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5329667364296455, "mean_inference_ms": 1.7159954717724581, "mean_action_processing_ms": 0.7948342796824406, "mean_env_wait_ms": 10.240140739523268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013086318969726562, "StateBufferConnector_ms": 0.009193897247314453, "ViewRequirementAgentConnector_ms": 0.3071882724761963}, "num_episodes": 25, "episode_return_max": -722.8682590061661, "episode_return_min": -5019.561278111249, "episode_return_mean": -2572.402080404556, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1583678, "num_agent_steps_trained": 1583678, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 101.19225035729717, "num_env_steps_trained_throughput_per_sec": 101.19225035729717, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1583678, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1583678, "timers": {"training_iteration_time_ms": 47115.034, "restore_workers_time_ms": 0.024, "training_step_time_ms": 47114.968, "sample_time_ms": 3212.797, "learn_time_ms": 43845.157, "learn_throughput": 91.23, "synch_weights_time_ms": 54.193}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1583678, "num_agent_steps_trained": 1583678}, "done": false, "training_iteration": 91, "trial_id": "05c72_00000", "date": "2024-07-26_15-56-57", "timestamp": 1721989617, "time_this_iter_s": 39.53856897354126, "time_total_s": 4434.41329407692, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00f80d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4434.41329407692, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 11.93392857142857, "ram_util_percent": 30.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 147.03236235105075, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.375371057987213, "policy_loss": -0.005147600589164843, "vf_loss": 4.398065158954034, "vf_explained_var": 0.988050739245537, "kl": 0.015102373928739093, "entropy": 2.9014863280149608, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.51538461538462, "num_grad_updates_lifetime": 374460.5, "diff_num_grad_updates_vs_sampler_policy": 1949.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1600255, "num_agent_steps_trained": 1600255}, "env_runners": {"episode_reward_max": -722.8682590061661, "episode_reward_min": -5019.561278111249, "episode_reward_mean": -2568.386449456723, "episode_len_mean": 147.77, "episode_media": {}, "episodes_timesteps_total": 14777, "policy_reward_min": {"policy_0": -1544.662061040414}, "policy_reward_max": {"policy_0": 3.9107427053607315}, "policy_reward_mean": {"policy_0": -513.6772898913445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1829.660359698275, -2371.6622475051963, -2827.741277723753, -4480.583970223075, -3661.6981081871745, -1849.9887655168677, -1432.1216767774017, -2804.4157559606388, -2773.044984135561, -3758.246957955117, -1883.7403589065864, -2154.5849965583525, -2618.945256884598, -1442.6980813304933, -3290.028430271576, -2431.2755760371106, -1640.3352540468902, -2292.0541486730763, -914.8190691059573, -2878.580149460874, -3556.922404017724, -1110.5205974898802, -2511.673276442728, -3107.7436563705473, -1593.110344642568, -2471.752761149474, -2069.923058464887, -2985.630053331473, -1530.0700476584564, -3381.023459056028, -3097.5537845281165, -2823.8809126477, -2427.2292720676774, -2954.4359273515724, -3116.255592978584, -1993.956282700618, -3052.636668502766, -3748.813350252695, -2983.90866644715, -5019.561278111249, -1495.1337662251942, -2289.560079686227, -1714.1420203739651, -2349.095281625283, -3039.0122681327516, -3093.6508172754143, -2269.6648884923347, -2647.2994480354787, -798.6016700701517, -2675.308386845201, -1429.0406282687234, -2211.0326016075664, -2048.899630128569, -2428.3177063218513, -2976.266818426442, -2278.220865486387, -1719.1837027947554, -2464.8304686234706, -1943.8658759114844, -1432.9831005591145, -3199.253974316896, -2685.59279113374, -722.8682590061661, -3572.1797879627698, -3153.4851417171517, -1647.2599417997433, -2475.9816914569, -4737.317991769651, -1899.4371038134457, -3361.6629079789805, -1503.8996986153998, -2577.1551734458217, -3574.895422749064, -2738.85390820529, -1720.6795416888087, -2903.6777392959784, -2007.201679783276, -3061.7295061298287, -1908.4022560436865, -1163.687315303789, -3575.7598901992023, -3267.9504233865246, -2752.830491323112, -2283.571583576102, -3631.6123631740816, -3983.9271108862076, -2221.1662338416045, -2166.2517619576493, -3823.6508357087655, -3522.8466775051024, -3472.6287379351934, -1304.614784122375, -2897.3687862780403, -3645.680671811119, -1826.6529997403763, -2158.4109330226647, -3794.973102955987, -1528.3033806940828, -3016.9792199795374, -3171.3062812972917], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 116, 150, 150, 103, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-477.8554878615008, -63.35995217755016, -402.88847329093244, -781.9450681018582, -103.61137826643272, -1171.1768728156667, -57.619494744507975, -121.62177563700165, -918.9797516404784, -102.26435266754004, -472.86677249616025, -728.1680522856393, -622.0894898424071, -744.7327307276356, -259.88423237191125, -966.9631109770138, -856.0378216601907, -970.2721240426499, -510.6423405576139, -1176.6685729856072, -394.52987951628785, -907.7195709020748, -1340.1946638380114, -750.5825246506922, -268.6714692801079, -226.53018385578645, -212.99749037799302, -111.36074480728543, -340.056458924962, -959.0438875508415, -214.3795079108193, -57.285467994937605, -287.0780771416019, -129.53850554984294, -743.8401181801989, -718.4804884538229, -850.2477967915213, -25.66315593055234, -467.3125174945765, -742.7117972901679, -946.989275661996, -438.81168864951997, -651.0328228931256, -20.123021861785222, -716.0881750691386, -1104.1813987368093, -844.8847691452697, -822.1516502138887, -178.56267431061542, -808.4664655485309, -158.1935786261291, -24.924193796302152, -1212.9164162936122, -10.971604833728811, -476.7345653568149, -1004.677335931729, -633.7212116544537, -98.50033584769015, -280.2551651400945, -137.43094798438565, -663.8948896340654, -289.8414647928762, -1033.6646459967085, -509.0163625956985, -122.52789386524918, -62.29309975314488, -377.33972130306336, -78.9245832379706, -622.1557665468512, -301.98491048946295, -557.5230919367584, -789.7252688313074, -80.39819840664796, -1130.1153272236215, -732.2665438732392, -527.7386384719383, -636.3271489095135, -365.0946838808027, -112.8388251413675, -789.2762796334861, -201.76167708938493, -574.7087083536005, -51.05567704537042, -110.79966683915082, -702.0095247193829, -223.66549814561168, -479.3021477753405, -272.91456832891157, -1002.1338980793788, -314.03803634383405, -62.85972575160363, -270.9036184722516, -105.0045326536859, -106.83607328452098, -369.2151189438946, -602.0502640717573, -564.013452306675, -402.7237142397003, -741.45692912309, -568.3357897196504, -401.4259364590691, -733.6289147997657, -1194.0529238771037, -870.0370266212099, -357.7776022605777, -400.9597955231054, -113.00614127606974, -110.10439801026557, -305.18622451161156, -181.264038168829, -1059.8555808392139, -415.03038746612367, -102.10603965407317, -795.3467940560138, -139.3344744273052, -3.812349186847021, -772.0047020421925, -1069.7007900218096, -34.053657358472336, -1228.172157761224, -461.28810647119667, -37.43493995219172, -153.69742338821905, -256.4086946366862, -684.2811801942748, -844.8916767308056, -120.22214428248523, -81.12371995584542, -430.3524010517831, -995.1628191285521, -363.8042025625635, -167.46953336606282, -675.4442906622727, -610.8338132843187, -252.37121858966972, -681.1423994530322, -1022.4294908353771, -147.30353531409713, -718.1560239211013, -416.598603807863, -266.62259349538226, -271.2738289627024, -817.0497495804073, -139.6980255959431, -35.42585002402137, -516.9015971281606, -1053.6194213493009, -821.7197898278065, -475.8423203649728, -512.9403303857896, -244.58829453510637, -1124.6152539525133, -708.4694819516495, -458.98172590810566, -560.8990281807393, -181.4569711370829, -225.37954637134789, -510.4192462708316, -1125.1967346873698, -781.4284141810683, -113.38760736122187, -963.6544940712741, -524.6025816116037, -549.551757578236, -276.0328314453382, -1544.662061040414, -94.87085521146697, -845.9066943226072, -57.866503781765644, -411.1298129953171, -68.82592323763329, -866.3472990793392, -752.5082303389211, -517.9201093513134, -910.6540309713768, -519.9737804035295, -53.90741681159579, -755.970281131563, -637.2582675352011, -26.846536818729753, -407.2929292230653, -572.5547493678979, -881.1739798863088, -502.43098987700205, -689.1840201484931, -411.6369743221938, -701.809795809244, -834.3809297101425, -648.2832893109489, -1152.7023611001625, -735.6367293537987, -280.99405047029404, -1363.7135568845572, -442.8423714388791, -160.7219582996192, -1207.0518933681108, -387.9851193171462, -1284.6074984665559, -1195.439911684962, -944.4768552744742, -75.58766689581296, -666.1433283988289, -171.7557249432094, -15.056606735271558, -566.5904392520723, -537.2838615678852, -564.9309906297948, -385.3024445781236, -681.6197445798853, -120.42303833053707, -44.947205469050964, -55.40864305175847, -1232.736229726524, -305.37258922147976, -75.67735290515184, -365.46689439915997, -794.8470282457212, -71.29111357866498, -182.43841842066675, -935.0518269810713, -477.2616014896015, -1009.9745116014865, 3.9107427053607315, -839.7592716096192, -715.9276261374023, -642.3508274566422, -152.38209538178646, -595.9952896993768, -1211.5716669684257, -491.3509377691844, -93.32101924090325, -856.3832761228906, -874.8051547609999, -258.7986328213239, -186.35680554621558, -187.48079700776998, -997.0447965183075, -799.1812620296126, -556.5846590536662, -107.00793342612013, -172.37024472643117, -259.344482523567, -140.89112000478596, -163.05053420350632, -62.94528861186071, -407.8333815748718, -84.31182518615756, -732.8197541083547, -598.2142234535692, -852.1292025222465, -104.39194669240649, -171.13164261127173, -754.5172378093536, -282.33337081986014, -116.66643033583208, -94.08837256424819, -889.5237295553793, -345.02395296781407, -446.2358611274849, -436.16068539263694, -694.3438416567556, -232.94999903731215, -524.5491923762658, -184.1440353175583, -412.9125617406757, -935.3827443631538, -1111.764442551369, -93.5140272889613, -143.37940843292407, -144.27708368544265, -523.0204952378618, -105.51114352935795, -99.44415565123843, -720.2547753795138, -1528.03624862847, -428.1985404026775, -793.9137291600587, -316.7096633251208, -641.3945340308758, -98.00439856765463, -171.9840803827177, -238.1087798698963, -804.8386947459451, -180.88892093709953, -323.36322685909715, -773.4656345802506, -266.6125049239901, -840.8069942195002, -395.6973398713824, -188.24799502834858, -306.3541209561081, -41.901215382741384, -865.186674969657, -9.603591766242321, -720.8202728367357, -112.82961192965435, -412.94322582725687, -109.18620653774332, -36.07936404269217, -761.9446922217687, -127.0702641762426, -389.1600442224971, -1450.6910476816533, -941.642142934814, -290.6904753016896, -367.56739146452463, -796.9500584139029, -261.2476857171855, -917.2063423249951, -342.62131321313046, -110.34774561868433, -59.666185776290895, -196.32190014370343, -25.15516525859843, -331.37726220888834, -933.8767837514429, -586.0925874734072, -598.0054194330168, -1381.3400813702435, -72.86491593466259, -227.83891077296332, -1476.3024522127166, -181.79551938237134, -45.493331919430204, -1222.0549274296698, -148.17571493613914, -638.9633888299395, -316.88582985980366, -453.451702863563, -89.78330531029897, -142.0443941146185, -172.18127974965924, -284.54947149883503, -1116.749109034985, -760.4574370588011, -1156.4689253052607, -1474.4970427337635, -913.8976333505053, -1039.9665403666845, -152.48785001343848, -467.0821458448331, -37.20594930113268, -505.93601743402365, -809.0135705814548, -80.19942065200128, -115.31058697934908, -1258.7982957580134, -759.3817985639473, -269.9666575136939, -958.2055691639767, -368.32247256189265, -374.8903964196225, -267.35058632013755, -100.44131332320045, -392.8949299905465, -423.64052466106466, -973.6142937765092, -50.104032019329246, -1031.8290077729534, -97.96731521596367, -533.5269023300177, -831.8364848002204, -519.4795251377811, -1375.9493786220416, -314.103131859, -766.7469281097342, -1126.0986809910282, -346.01904547563834, -239.6732508958294, -260.3160027330591, -440.0858768477471, -181.57217315397475, -66.85846499958431, -778.8765784198912, -253.28644826761192, -625.6624606329129, -663.1525880906177, -120.88945457589459, -1105.481709807149, -388.49152618940826, -164.77965216272216, -225.57423710103237, -1025.5531494968484, -564.401073991547, -26.89356703112591, -4.389689237738323, -1329.4662717543051, -1061.0494632476405, -167.3192727088401, -499.50480918130955, -315.22143242969815, -1188.8116601436036, -33.826849793603444, -120.70187678053982, -249.84043689624212, -67.71516297926908, -362.93081913277405, -38.01452711417673, -95.70088070092861, -599.3259253766386, -1240.4443949879956, -784.6623418969584, -435.328957261979, -362.089308194328, -753.2348878579353, -712.2034665694728, -552.7950210078302, -116.58991260392779, -873.9010512531587, -1012.4609719521351, -116.36518429154681, -23.683380545857442, -77.88340614254004, -1076.762244256638, -1458.1362760865293, -83.55334328836935, -646.6776639814508, -789.7000792845222, -742.8198758731788, -20.820621148578542, -695.233422402947, -1305.8673419937072, -119.93737485061544, -1030.8539767965767, -479.72024713023626, -955.2895489603205, -1071.3235246981062, -599.9003876441016, -391.18509952864196, -966.2285500550396, -373.5738024672275, -126.04843109061049, -118.85802751954068, -64.24661715500336, -1538.4393556092227, -435.8676145720686, -96.41216952657435, -61.19159705678695, -710.9096667869422, -861.8707140152758, -1297.8983115230249, -1007.6424861418317, -725.7727744133896, -560.4176244996416, -231.91963913087798, -210.68736759376048, -957.4684580818945, -1035.5393505779232, -141.70644629965972, -1177.4450549518651, -779.4135031670203, -975.37923162088, -1080.3518458764904, -470.7822032685451, -166.70195400225884, -271.72550376886323, -468.65271904144, -127.33303918329128, -167.55005556469015, -269.3534665640899, -619.765175584488, -982.0131338583095, -67.52374426041528, -915.2001398524893, -312.8665927223379, -403.1136089270034, -250.7710776973436, -815.3352467619695, -1050.8553333147336, -1125.605405110066, -1027.0582149531474, -291.6776002947562, -74.60775083610011, -43.96941039130219, -389.34002326507056, -1029.112558255918, -173.13265494459478, -809.536767974198, -23.9347943283078, -122.69415751964587, -1192.2053947512895, -279.8599598643766, -793.1507701775352, -533.5176575266842, -996.2393206360991, -521.1996930494668, -190.78134687586063, -530.2024226149703, -167.24453213611594, -118.8753860176704, -1305.946727158626, -177.11667877807102, -261.90787434066203, -450.5874640076052, -821.4204756945722, -489.83772303697725, -1188.2887124404592, -1276.6171614914185, -214.83462997775794, -1.728054350678227]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5314118659748512, "mean_inference_ms": 1.7151250435921486, "mean_action_processing_ms": 0.7935141016074594, "mean_env_wait_ms": 10.227911580582244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01256108283996582, "StateBufferConnector_ms": 0.00933527946472168, "ViewRequirementAgentConnector_ms": 0.3015632629394531}, "num_episodes": 30, "episode_return_max": -722.8682590061661, "episode_return_min": -5019.561278111249, "episode_return_mean": -2568.386449456723, "episodes_this_iter": 30}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600255, "num_agent_steps_trained": 1600255, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.21843042082553, "num_env_steps_trained_throughput_per_sec": 82.21843042082553, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1600255, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600255, "timers": {"training_iteration_time_ms": 46977.109, "restore_workers_time_ms": 0.024, "training_step_time_ms": 46977.043, "sample_time_ms": 3221.099, "learn_time_ms": 43700.104, "learn_throughput": 91.533, "synch_weights_time_ms": 53.003}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1600255, "num_agent_steps_trained": 1600255}, "done": false, "training_iteration": 92, "trial_id": "05c72_00000", "date": "2024-07-26_15-57-45", "timestamp": 1721989665, "time_this_iter_s": 48.66083812713623, "time_total_s": 4483.074132204056, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd014af80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4483.074132204056, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 10.566666666666668, "ram_util_percent": 30.13043478260869}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 134.53632897566763, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.4747115251013785, "policy_loss": -0.0024677273535797764, "vf_loss": 4.493871828875184, "vf_explained_var": 0.9869282779613514, "kl": 0.014787878570977409, "entropy": 2.7922127585078393, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 378345.5, "diff_num_grad_updates_vs_sampler_policy": 1934.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1616767, "num_agent_steps_trained": 1616767}, "env_runners": {"episode_reward_max": -722.8682590061661, "episode_reward_min": -5019.561278111249, "episode_reward_mean": -2607.3372115727398, "episode_len_mean": 148.07, "episode_media": {}, "episodes_timesteps_total": 14807, "policy_reward_min": {"policy_0": -1544.662061040414}, "policy_reward_max": {"policy_0": 3.9107427053607315}, "policy_reward_mean": {"policy_0": -521.467442314548}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2471.752761149474, -2069.923058464887, -2985.630053331473, -1530.0700476584564, -3381.023459056028, -3097.5537845281165, -2823.8809126477, -2427.2292720676774, -2954.4359273515724, -3116.255592978584, -1993.956282700618, -3052.636668502766, -3748.813350252695, -2983.90866644715, -5019.561278111249, -1495.1337662251942, -2289.560079686227, -1714.1420203739651, -2349.095281625283, -3039.0122681327516, -3093.6508172754143, -2269.6648884923347, -2647.2994480354787, -798.6016700701517, -2675.308386845201, -1429.0406282687234, -2211.0326016075664, -2048.899630128569, -2428.3177063218513, -2976.266818426442, -2278.220865486387, -1719.1837027947554, -2464.8304686234706, -1943.8658759114844, -1432.9831005591145, -3199.253974316896, -2685.59279113374, -722.8682590061661, -3572.1797879627698, -3153.4851417171517, -1647.2599417997433, -2475.9816914569, -4737.317991769651, -1899.4371038134457, -3361.6629079789805, -1503.8996986153998, -2577.1551734458217, -3574.895422749064, -2738.85390820529, -1720.6795416888087, -2903.6777392959784, -2007.201679783276, -3061.7295061298287, -1908.4022560436865, -1163.687315303789, -3575.7598901992023, -3267.9504233865246, -2752.830491323112, -2283.571583576102, -3631.6123631740816, -3983.9271108862076, -2221.1662338416045, -2166.2517619576493, -3823.6508357087655, -3522.8466775051024, -3472.6287379351934, -1304.614784122375, -2897.3687862780403, -3645.680671811119, -1826.6529997403763, -2158.4109330226647, -3794.973102955987, -1528.3033806940828, -3016.9792199795374, -3171.3062812972917, -3111.706229917309, -2346.1869212498814, -3465.305669131711, -2472.1141990331816, -888.9627086974189, -2797.4980731740675, -1789.895021838311, -1044.3704015840858, -2473.1933138559502, -2262.2889155154635, -3626.941104627004, -1442.2840340061764, -1219.1244427151034, -1208.4694985881222, -4086.050889102845, -2604.706717296558, -1639.1359383967501, -3048.4727205226664, -3345.9808612337897, -4355.770546710144, -4101.308744026304, -3086.457139731341, -2702.8657938988636, -3514.5413362714876, -2477.640694399231], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-844.8916767308056, -120.22214428248523, -81.12371995584542, -430.3524010517831, -995.1628191285521, -363.8042025625635, -167.46953336606282, -675.4442906622727, -610.8338132843187, -252.37121858966972, -681.1423994530322, -1022.4294908353771, -147.30353531409713, -718.1560239211013, -416.598603807863, -266.62259349538226, -271.2738289627024, -817.0497495804073, -139.6980255959431, -35.42585002402137, -516.9015971281606, -1053.6194213493009, -821.7197898278065, -475.8423203649728, -512.9403303857896, -244.58829453510637, -1124.6152539525133, -708.4694819516495, -458.98172590810566, -560.8990281807393, -181.4569711370829, -225.37954637134789, -510.4192462708316, -1125.1967346873698, -781.4284141810683, -113.38760736122187, -963.6544940712741, -524.6025816116037, -549.551757578236, -276.0328314453382, -1544.662061040414, -94.87085521146697, -845.9066943226072, -57.866503781765644, -411.1298129953171, -68.82592323763329, -866.3472990793392, -752.5082303389211, -517.9201093513134, -910.6540309713768, -519.9737804035295, -53.90741681159579, -755.970281131563, -637.2582675352011, -26.846536818729753, -407.2929292230653, -572.5547493678979, -881.1739798863088, -502.43098987700205, -689.1840201484931, -411.6369743221938, -701.809795809244, -834.3809297101425, -648.2832893109489, -1152.7023611001625, -735.6367293537987, -280.99405047029404, -1363.7135568845572, -442.8423714388791, -160.7219582996192, -1207.0518933681108, -387.9851193171462, -1284.6074984665559, -1195.439911684962, -944.4768552744742, -75.58766689581296, -666.1433283988289, -171.7557249432094, -15.056606735271558, -566.5904392520723, -537.2838615678852, -564.9309906297948, -385.3024445781236, -681.6197445798853, -120.42303833053707, -44.947205469050964, -55.40864305175847, -1232.736229726524, -305.37258922147976, -75.67735290515184, -365.46689439915997, -794.8470282457212, -71.29111357866498, -182.43841842066675, -935.0518269810713, -477.2616014896015, -1009.9745116014865, 3.9107427053607315, -839.7592716096192, -715.9276261374023, -642.3508274566422, -152.38209538178646, -595.9952896993768, -1211.5716669684257, -491.3509377691844, -93.32101924090325, -856.3832761228906, -874.8051547609999, -258.7986328213239, -186.35680554621558, -187.48079700776998, -997.0447965183075, -799.1812620296126, -556.5846590536662, -107.00793342612013, -172.37024472643117, -259.344482523567, -140.89112000478596, -163.05053420350632, -62.94528861186071, -407.8333815748718, -84.31182518615756, -732.8197541083547, -598.2142234535692, -852.1292025222465, -104.39194669240649, -171.13164261127173, -754.5172378093536, -282.33337081986014, -116.66643033583208, -94.08837256424819, -889.5237295553793, -345.02395296781407, -446.2358611274849, -436.16068539263694, -694.3438416567556, -232.94999903731215, -524.5491923762658, -184.1440353175583, -412.9125617406757, -935.3827443631538, -1111.764442551369, -93.5140272889613, -143.37940843292407, -144.27708368544265, -523.0204952378618, -105.51114352935795, -99.44415565123843, -720.2547753795138, -1528.03624862847, -428.1985404026775, -793.9137291600587, -316.7096633251208, -641.3945340308758, -98.00439856765463, -171.9840803827177, -238.1087798698963, -804.8386947459451, -180.88892093709953, -323.36322685909715, -773.4656345802506, -266.6125049239901, -840.8069942195002, -395.6973398713824, -188.24799502834858, -306.3541209561081, -41.901215382741384, -865.186674969657, -9.603591766242321, -720.8202728367357, -112.82961192965435, -412.94322582725687, -109.18620653774332, -36.07936404269217, -761.9446922217687, -127.0702641762426, -389.1600442224971, -1450.6910476816533, -941.642142934814, -290.6904753016896, -367.56739146452463, -796.9500584139029, -261.2476857171855, -917.2063423249951, -342.62131321313046, -110.34774561868433, -59.666185776290895, -196.32190014370343, -25.15516525859843, -331.37726220888834, -933.8767837514429, -586.0925874734072, -598.0054194330168, -1381.3400813702435, -72.86491593466259, -227.83891077296332, -1476.3024522127166, -181.79551938237134, -45.493331919430204, -1222.0549274296698, -148.17571493613914, -638.9633888299395, -316.88582985980366, -453.451702863563, -89.78330531029897, -142.0443941146185, -172.18127974965924, -284.54947149883503, -1116.749109034985, -760.4574370588011, -1156.4689253052607, -1474.4970427337635, -913.8976333505053, -1039.9665403666845, -152.48785001343848, -467.0821458448331, -37.20594930113268, -505.93601743402365, -809.0135705814548, -80.19942065200128, -115.31058697934908, -1258.7982957580134, -759.3817985639473, -269.9666575136939, -958.2055691639767, -368.32247256189265, -374.8903964196225, -267.35058632013755, -100.44131332320045, -392.8949299905465, -423.64052466106466, -973.6142937765092, -50.104032019329246, -1031.8290077729534, -97.96731521596367, -533.5269023300177, -831.8364848002204, -519.4795251377811, -1375.9493786220416, -314.103131859, -766.7469281097342, -1126.0986809910282, -346.01904547563834, -239.6732508958294, -260.3160027330591, -440.0858768477471, -181.57217315397475, -66.85846499958431, -778.8765784198912, -253.28644826761192, -625.6624606329129, -663.1525880906177, -120.88945457589459, -1105.481709807149, -388.49152618940826, -164.77965216272216, -225.57423710103237, -1025.5531494968484, -564.401073991547, -26.89356703112591, -4.389689237738323, -1329.4662717543051, -1061.0494632476405, -167.3192727088401, -499.50480918130955, -315.22143242969815, -1188.8116601436036, -33.826849793603444, -120.70187678053982, -249.84043689624212, -67.71516297926908, -362.93081913277405, -38.01452711417673, -95.70088070092861, -599.3259253766386, -1240.4443949879956, -784.6623418969584, -435.328957261979, -362.089308194328, -753.2348878579353, -712.2034665694728, -552.7950210078302, -116.58991260392779, -873.9010512531587, -1012.4609719521351, -116.36518429154681, -23.683380545857442, -77.88340614254004, -1076.762244256638, -1458.1362760865293, -83.55334328836935, -646.6776639814508, -789.7000792845222, -742.8198758731788, -20.820621148578542, -695.233422402947, -1305.8673419937072, -119.93737485061544, -1030.8539767965767, -479.72024713023626, -955.2895489603205, -1071.3235246981062, -599.9003876441016, -391.18509952864196, -966.2285500550396, -373.5738024672275, -126.04843109061049, -118.85802751954068, -64.24661715500336, -1538.4393556092227, -435.8676145720686, -96.41216952657435, -61.19159705678695, -710.9096667869422, -861.8707140152758, -1297.8983115230249, -1007.6424861418317, -725.7727744133896, -560.4176244996416, -231.91963913087798, -210.68736759376048, -957.4684580818945, -1035.5393505779232, -141.70644629965972, -1177.4450549518651, -779.4135031670203, -975.37923162088, -1080.3518458764904, -470.7822032685451, -166.70195400225884, -271.72550376886323, -468.65271904144, -127.33303918329128, -167.55005556469015, -269.3534665640899, -619.765175584488, -982.0131338583095, -67.52374426041528, -915.2001398524893, -312.8665927223379, -403.1136089270034, -250.7710776973436, -815.3352467619695, -1050.8553333147336, -1125.605405110066, -1027.0582149531474, -291.6776002947562, -74.60775083610011, -43.96941039130219, -389.34002326507056, -1029.112558255918, -173.13265494459478, -809.536767974198, -23.9347943283078, -122.69415751964587, -1192.2053947512895, -279.8599598643766, -793.1507701775352, -533.5176575266842, -996.2393206360991, -521.1996930494668, -190.78134687586063, -530.2024226149703, -167.24453213611594, -118.8753860176704, -1305.946727158626, -177.11667877807102, -261.90787434066203, -450.5874640076052, -821.4204756945722, -489.83772303697725, -1188.2887124404592, -1276.6171614914185, -214.83462997775794, -1.728054350678227, -586.4938912484919, -102.81845704191129, -1065.3709921392808, -275.95787149193404, -1081.0650179956895, -19.84020787024992, -826.7367010456217, -518.2724645716219, -854.8952319522643, -126.44231581012471, -1231.4347972216788, -647.0290509139919, -923.0063939819815, -148.27516842999844, -515.5602585840618, -92.70408990863577, -639.617094616956, -498.13366960754917, -346.997485637691, -894.6618592623514, -158.8928987468356, -304.27661349971413, -216.63406583445536, -58.634380707240595, -150.52474990917239, -1203.235559040316, -616.8646831567468, -807.5334170470566, -101.00230197099921, -68.86211195894988, -286.03920283252256, -872.0721124649396, -401.8819910987151, -159.41976154769253, -70.48195389444184, -58.03843643735491, -364.6668445925896, -257.15930160501796, -328.7386277846048, -35.76719116451979, -595.4585235578533, -160.7396444373795, -761.1633287030902, -857.577094091016, -98.25472306661021, -164.55389193412154, -1177.3528848761987, -143.38845831966526, -196.85493020619128, -580.1387501792874, -72.06940986179943, -677.6321054208111, -834.3495243103032, -1010.3013350147364, -1032.5887300193535, -508.54804254607114, -800.3799974338932, -81.96270910384048, -12.450617966768228, -38.942666955603556, -287.8127461200566, -98.80733991833588, -76.73485380055362, -42.94437797887553, -712.8251248972811, -550.5063447280714, -79.17348668153309, -460.62905317446337, -89.71516195469624, -28.44545204935699, -449.0615965132726, -1011.9337723267585, -94.07730264221429, -1383.8370755417825, -1147.1411420788188, -836.3672722526932, -69.96672730748813, -322.0009291293494, -935.0759447666261, -441.2958438404002, -482.2120208783686, -405.56557737672466, -208.66991692543448, -268.0130675459889, -274.6753556702311, -423.2979000478269, -157.87109508396355, -1295.0580636699888, -802.1695277569768, -370.0761339639131, -1331.86926063452, -1015.4023056363711, -17.027324046740684, -957.8421651818599, -23.83980573429666, -1207.202747178586, -1049.372079362879, -886.6682670408727, -1099.163233244939, -113.36421988286708, -851.9481620684697, -1071.4960664491296, -1080.644924610806, -350.49813888192494, -746.721452015975, -1380.841110355096, -103.93520348364159, -731.930582873531, -297.7461749350602, -572.0040680840127, -51.18960320658797, -1176.5694410048914, -322.6338272021163, -1121.1518265470172, -31.321095938250096, -707.0380871645843, -1176.4273998749302, -16.538363970089797, -1002.1723144379968, -612.365170823888, -288.2048755761463, -763.5223213454228, -813.2229507355661, -503.8841813975817, -108.80636534451334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5302184942168717, "mean_inference_ms": 1.7142197912805848, "mean_action_processing_ms": 0.7927568606364487, "mean_env_wait_ms": 10.221598272148157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012816190719604492, "StateBufferConnector_ms": 0.009602546691894531, "ViewRequirementAgentConnector_ms": 0.31302690505981445}, "num_episodes": 25, "episode_return_max": -722.8682590061661, "episode_return_min": -5019.561278111249, "episode_return_mean": -2607.3372115727398, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1616767, "num_agent_steps_trained": 1616767, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.55057261563917, "num_env_steps_trained_throughput_per_sec": 80.55057261563917, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1616767, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1616767, "timers": {"training_iteration_time_ms": 47115.81, "restore_workers_time_ms": 0.025, "training_step_time_ms": 47115.741, "sample_time_ms": 3221.525, "learn_time_ms": 43838.88, "learn_throughput": 91.243, "synch_weights_time_ms": 52.493}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1616767, "num_agent_steps_trained": 1616767}, "done": false, "training_iteration": 93, "trial_id": "05c72_00000", "date": "2024-07-26_15-58-35", "timestamp": 1721989715, "time_this_iter_s": 49.66944479942322, "time_total_s": 4532.743577003479, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd014acb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4532.743577003479, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 10.908450704225354, "ram_util_percent": 30.09999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 147.24283276159298, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.418255837569161, "policy_loss": 0.0016194510786109186, "vf_loss": 4.4316671708273505, "vf_explained_var": 0.9874680484255786, "kl": 0.017559393548801486, "entropy": 2.8364960833201334, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.73015873015873, "num_grad_updates_lifetime": 382170.5, "diff_num_grad_updates_vs_sampler_policy": 1889.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1632861, "num_agent_steps_trained": 1632861}, "env_runners": {"episode_reward_max": -722.8682590061661, "episode_reward_min": -4737.317991769651, "episode_reward_mean": -2603.14532684879, "episode_len_mean": 148.02, "episode_media": {}, "episodes_timesteps_total": 14802, "policy_reward_min": {"policy_0": -1538.4393556092227}, "policy_reward_max": {"policy_0": 0.9274887549164089}, "policy_reward_mean": {"policy_0": -520.629065369758}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2048.899630128569, -2428.3177063218513, -2976.266818426442, -2278.220865486387, -1719.1837027947554, -2464.8304686234706, -1943.8658759114844, -1432.9831005591145, -3199.253974316896, -2685.59279113374, -722.8682590061661, -3572.1797879627698, -3153.4851417171517, -1647.2599417997433, -2475.9816914569, -4737.317991769651, -1899.4371038134457, -3361.6629079789805, -1503.8996986153998, -2577.1551734458217, -3574.895422749064, -2738.85390820529, -1720.6795416888087, -2903.6777392959784, -2007.201679783276, -3061.7295061298287, -1908.4022560436865, -1163.687315303789, -3575.7598901992023, -3267.9504233865246, -2752.830491323112, -2283.571583576102, -3631.6123631740816, -3983.9271108862076, -2221.1662338416045, -2166.2517619576493, -3823.6508357087655, -3522.8466775051024, -3472.6287379351934, -1304.614784122375, -2897.3687862780403, -3645.680671811119, -1826.6529997403763, -2158.4109330226647, -3794.973102955987, -1528.3033806940828, -3016.9792199795374, -3171.3062812972917, -3111.706229917309, -2346.1869212498814, -3465.305669131711, -2472.1141990331816, -888.9627086974189, -2797.4980731740675, -1789.895021838311, -1044.3704015840858, -2473.1933138559502, -2262.2889155154635, -3626.941104627004, -1442.2840340061764, -1219.1244427151034, -1208.4694985881222, -4086.050889102845, -2604.706717296558, -1639.1359383967501, -3048.4727205226664, -3345.9808612337897, -4355.770546710144, -4101.308744026304, -3086.457139731341, -2702.8657938988636, -3514.5413362714876, -2477.640694399231, -3090.5250841978536, -2169.178247672318, -3228.503736436992, -2896.5913312256566, -3027.3159660824153, -2662.759286694988, -1945.8191291099258, -3294.358411840183, -1557.7291880822402, -4571.2460588080585, -843.5723148261685, -1776.0416735481879, -1464.1163681337587, -4138.753690776126, -2558.602029561268, -2780.9661389847124, -2058.0619235896497, -3422.487409768253, -2683.4341054149018, -3156.5138199962594, -1933.6269765363909, -1884.79318983372, -1416.414270891745, -2541.9324268010014, -2697.696872819948, -1832.8142013697009, -3615.1306464893273], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150], "policy_policy_0_reward": [-694.3438416567556, -232.94999903731215, -524.5491923762658, -184.1440353175583, -412.9125617406757, -935.3827443631538, -1111.764442551369, -93.5140272889613, -143.37940843292407, -144.27708368544265, -523.0204952378618, -105.51114352935795, -99.44415565123843, -720.2547753795138, -1528.03624862847, -428.1985404026775, -793.9137291600587, -316.7096633251208, -641.3945340308758, -98.00439856765463, -171.9840803827177, -238.1087798698963, -804.8386947459451, -180.88892093709953, -323.36322685909715, -773.4656345802506, -266.6125049239901, -840.8069942195002, -395.6973398713824, -188.24799502834858, -306.3541209561081, -41.901215382741384, -865.186674969657, -9.603591766242321, -720.8202728367357, -112.82961192965435, -412.94322582725687, -109.18620653774332, -36.07936404269217, -761.9446922217687, -127.0702641762426, -389.1600442224971, -1450.6910476816533, -941.642142934814, -290.6904753016896, -367.56739146452463, -796.9500584139029, -261.2476857171855, -917.2063423249951, -342.62131321313046, -110.34774561868433, -59.666185776290895, -196.32190014370343, -25.15516525859843, -331.37726220888834, -933.8767837514429, -586.0925874734072, -598.0054194330168, -1381.3400813702435, -72.86491593466259, -227.83891077296332, -1476.3024522127166, -181.79551938237134, -45.493331919430204, -1222.0549274296698, -148.17571493613914, -638.9633888299395, -316.88582985980366, -453.451702863563, -89.78330531029897, -142.0443941146185, -172.18127974965924, -284.54947149883503, -1116.749109034985, -760.4574370588011, -1156.4689253052607, -1474.4970427337635, -913.8976333505053, -1039.9665403666845, -152.48785001343848, -467.0821458448331, -37.20594930113268, -505.93601743402365, -809.0135705814548, -80.19942065200128, -115.31058697934908, -1258.7982957580134, -759.3817985639473, -269.9666575136939, -958.2055691639767, -368.32247256189265, -374.8903964196225, -267.35058632013755, -100.44131332320045, -392.8949299905465, -423.64052466106466, -973.6142937765092, -50.104032019329246, -1031.8290077729534, -97.96731521596367, -533.5269023300177, -831.8364848002204, -519.4795251377811, -1375.9493786220416, -314.103131859, -766.7469281097342, -1126.0986809910282, -346.01904547563834, -239.6732508958294, -260.3160027330591, -440.0858768477471, -181.57217315397475, -66.85846499958431, -778.8765784198912, -253.28644826761192, -625.6624606329129, -663.1525880906177, -120.88945457589459, -1105.481709807149, -388.49152618940826, -164.77965216272216, -225.57423710103237, -1025.5531494968484, -564.401073991547, -26.89356703112591, -4.389689237738323, -1329.4662717543051, -1061.0494632476405, -167.3192727088401, -499.50480918130955, -315.22143242969815, -1188.8116601436036, -33.826849793603444, -120.70187678053982, -249.84043689624212, -67.71516297926908, -362.93081913277405, -38.01452711417673, -95.70088070092861, -599.3259253766386, -1240.4443949879956, -784.6623418969584, -435.328957261979, -362.089308194328, -753.2348878579353, -712.2034665694728, -552.7950210078302, -116.58991260392779, -873.9010512531587, -1012.4609719521351, -116.36518429154681, -23.683380545857442, -77.88340614254004, -1076.762244256638, -1458.1362760865293, -83.55334328836935, -646.6776639814508, -789.7000792845222, -742.8198758731788, -20.820621148578542, -695.233422402947, -1305.8673419937072, -119.93737485061544, -1030.8539767965767, -479.72024713023626, -955.2895489603205, -1071.3235246981062, -599.9003876441016, -391.18509952864196, -966.2285500550396, -373.5738024672275, -126.04843109061049, -118.85802751954068, -64.24661715500336, -1538.4393556092227, -435.8676145720686, -96.41216952657435, -61.19159705678695, -710.9096667869422, -861.8707140152758, -1297.8983115230249, -1007.6424861418317, -725.7727744133896, -560.4176244996416, -231.91963913087798, -210.68736759376048, -957.4684580818945, -1035.5393505779232, -141.70644629965972, -1177.4450549518651, -779.4135031670203, -975.37923162088, -1080.3518458764904, -470.7822032685451, -166.70195400225884, -271.72550376886323, -468.65271904144, -127.33303918329128, -167.55005556469015, -269.3534665640899, -619.765175584488, -982.0131338583095, -67.52374426041528, -915.2001398524893, -312.8665927223379, -403.1136089270034, -250.7710776973436, -815.3352467619695, -1050.8553333147336, -1125.605405110066, -1027.0582149531474, -291.6776002947562, -74.60775083610011, -43.96941039130219, -389.34002326507056, -1029.112558255918, -173.13265494459478, -809.536767974198, -23.9347943283078, -122.69415751964587, -1192.2053947512895, -279.8599598643766, -793.1507701775352, -533.5176575266842, -996.2393206360991, -521.1996930494668, -190.78134687586063, -530.2024226149703, -167.24453213611594, -118.8753860176704, -1305.946727158626, -177.11667877807102, -261.90787434066203, -450.5874640076052, -821.4204756945722, -489.83772303697725, -1188.2887124404592, -1276.6171614914185, -214.83462997775794, -1.728054350678227, -586.4938912484919, -102.81845704191129, -1065.3709921392808, -275.95787149193404, -1081.0650179956895, -19.84020787024992, -826.7367010456217, -518.2724645716219, -854.8952319522643, -126.44231581012471, -1231.4347972216788, -647.0290509139919, -923.0063939819815, -148.27516842999844, -515.5602585840618, -92.70408990863577, -639.617094616956, -498.13366960754917, -346.997485637691, -894.6618592623514, -158.8928987468356, -304.27661349971413, -216.63406583445536, -58.634380707240595, -150.52474990917239, -1203.235559040316, -616.8646831567468, -807.5334170470566, -101.00230197099921, -68.86211195894988, -286.03920283252256, -872.0721124649396, -401.8819910987151, -159.41976154769253, -70.48195389444184, -58.03843643735491, -364.6668445925896, -257.15930160501796, -328.7386277846048, -35.76719116451979, -595.4585235578533, -160.7396444373795, -761.1633287030902, -857.577094091016, -98.25472306661021, -164.55389193412154, -1177.3528848761987, -143.38845831966526, -196.85493020619128, -580.1387501792874, -72.06940986179943, -677.6321054208111, -834.3495243103032, -1010.3013350147364, -1032.5887300193535, -508.54804254607114, -800.3799974338932, -81.96270910384048, -12.450617966768228, -38.942666955603556, -287.8127461200566, -98.80733991833588, -76.73485380055362, -42.94437797887553, -712.8251248972811, -550.5063447280714, -79.17348668153309, -460.62905317446337, -89.71516195469624, -28.44545204935699, -449.0615965132726, -1011.9337723267585, -94.07730264221429, -1383.8370755417825, -1147.1411420788188, -836.3672722526932, -69.96672730748813, -322.0009291293494, -935.0759447666261, -441.2958438404002, -482.2120208783686, -405.56557737672466, -208.66991692543448, -268.0130675459889, -274.6753556702311, -423.2979000478269, -157.87109508396355, -1295.0580636699888, -802.1695277569768, -370.0761339639131, -1331.86926063452, -1015.4023056363711, -17.027324046740684, -957.8421651818599, -23.83980573429666, -1207.202747178586, -1049.372079362879, -886.6682670408727, -1099.163233244939, -113.36421988286708, -851.9481620684697, -1071.4960664491296, -1080.644924610806, -350.49813888192494, -746.721452015975, -1380.841110355096, -103.93520348364159, -731.930582873531, -297.7461749350602, -572.0040680840127, -51.18960320658797, -1176.5694410048914, -322.6338272021163, -1121.1518265470172, -31.321095938250096, -707.0380871645843, -1176.4273998749302, -16.538363970089797, -1002.1723144379968, -612.365170823888, -288.2048755761463, -763.5223213454228, -813.2229507355661, -503.8841813975817, -108.80636534451334, -1228.9043138961024, -907.5612450733416, -467.4890697081185, -122.88502141653835, -363.68543410374787, -396.9213654627914, -104.12908209478003, -249.99030535781307, -536.8477671497684, -881.2897276071662, -1129.2830229629121, -54.46195159324451, -884.5845914678156, -579.4226250274492, -580.7515453855675, -540.6025158263287, -182.0467685678319, -1294.5039695798264, -84.5316065069701, -794.9064707446998, -292.83967741867747, -53.146198909297844, -925.3280294446914, -623.1238180865321, -1132.8782422232157, -62.815802798329756, -592.5108022065084, -145.95059143158966, -1006.7785957047031, -854.703494553858, -59.952732725668035, -508.3873675877413, -1096.6423589084393, -195.81456660688585, -85.02210328119217, -534.2903188390492, -848.667709871067, -773.165908642543, -207.1190168562993, -931.115457631227, -953.8362462185786, -99.94447431816724, 0.9274887549164089, -102.44113020600587, -402.4348260944037, -376.5975030021191, -1339.049178773648, -707.4915389906084, -1259.68903996014, -888.418798081539, -91.18800155873843, -78.67990190104553, -255.893357564751, -347.94431226643337, -69.86674153519988, -599.3825124948222, -170.62750189523234, -93.26838970422689, -878.6373064721714, -34.12596298173414, -6.277519947531941, -192.92689450399837, -188.53722479057998, -1015.128567656204, -61.246161235444575, -199.33208445424057, -1109.3835758840626, -1246.643022482002, -164.23274275665062, -1419.1622651991693, -744.9839617800608, -902.5278242947521, -404.80595816593694, -86.65405327761255, -419.630232042907, -1092.6853989489493, -856.8723505689786, -619.1942824919333, -78.61663686870166, -133.5974701061497, -460.0235154525759, -109.4123888357613, -1066.1622726243645, -255.69097302366544, -166.7727736532841, -106.69181566103852, -1023.529416567595, -883.3861064314343, -385.0631441693164, -1023.816926938872, -844.4260518349561, -494.839057652073, -837.8086158366383, -343.8653064906879, -162.49507360054707, -991.070541775625, -214.20585805497717, -93.85382612202939, -1435.1928027116537, -422.1907913319716, -218.5840410344116, -48.976647987944375, -351.6724059601175, -1072.8666793902362, -241.5272021636815, -271.1047496297645, -222.8349847709303, -18.998883347563147, -600.5782337845546, -771.2763383009062, -489.4708504551229, -17.58966352703196, -338.12470036903875, -133.147883356012, -438.0811731845399, -584.219063948345, -213.79968244136123, -776.9443739439173, -821.4893308502034, -145.47997561717523, -455.6886072229086, -1201.3637199737568, -40.9252352563545, -814.0908220029869, -185.628488363943, -43.30621045847834, -644.6659088969013, -128.2445955584817, -948.7058200160101, -67.89166643982854, -1110.1290776910482, -1080.7195310045533, -1173.383654575322, -123.72736305444717, -127.17102016395363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.528878521889634, "mean_inference_ms": 1.7138576969800936, "mean_action_processing_ms": 0.7919232249973036, "mean_env_wait_ms": 10.212191495100008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012723207473754883, "StateBufferConnector_ms": 0.009542465209960938, "ViewRequirementAgentConnector_ms": 0.31164073944091797}, "num_episodes": 27, "episode_return_max": -722.8682590061661, "episode_return_min": -4737.317991769651, "episode_return_mean": -2603.14532684879, "episodes_this_iter": 27}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632861, "num_agent_steps_trained": 1632861, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 121.99500900898674, "num_env_steps_trained_throughput_per_sec": 121.99500900898674, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1632861, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1632861, "timers": {"training_iteration_time_ms": 45209.83, "restore_workers_time_ms": 0.025, "training_step_time_ms": 45209.762, "sample_time_ms": 3205.198, "learn_time_ms": 41950.121, "learn_throughput": 95.351, "synch_weights_time_ms": 51.644}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1632861, "num_agent_steps_trained": 1632861}, "done": false, "training_iteration": 94, "trial_id": "05c72_00000", "date": "2024-07-26_15-59-08", "timestamp": 1721989748, "time_this_iter_s": 32.798490047454834, "time_total_s": 4565.542067050934, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00f8dc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4565.542067050934, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 12.904347826086957, "ram_util_percent": 30.117391304347812}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.84466440990718, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.311337204834428, "policy_loss": -0.0032707336914638585, "vf_loss": 4.333222094930783, "vf_explained_var": 0.9869893039266269, "kl": 0.014509936326302146, "entropy": 2.9632636592243657, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.73484848484848, "num_grad_updates_lifetime": 386040.5, "diff_num_grad_updates_vs_sampler_policy": 1979.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1649722, "num_agent_steps_trained": 1649722}, "env_runners": {"episode_reward_max": -843.5723148261685, "episode_reward_min": -4571.2460588080585, "episode_reward_mean": -2654.9609102150403, "episode_len_mean": 147.94, "episode_media": {}, "episodes_timesteps_total": 14794, "policy_reward_min": {"policy_0": -1538.4393556092227}, "policy_reward_max": {"policy_0": 5.146184726428563}, "policy_reward_mean": {"policy_0": -530.992182043008}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3575.7598901992023, -3267.9504233865246, -2752.830491323112, -2283.571583576102, -3631.6123631740816, -3983.9271108862076, -2221.1662338416045, -2166.2517619576493, -3823.6508357087655, -3522.8466775051024, -3472.6287379351934, -1304.614784122375, -2897.3687862780403, -3645.680671811119, -1826.6529997403763, -2158.4109330226647, -3794.973102955987, -1528.3033806940828, -3016.9792199795374, -3171.3062812972917, -3111.706229917309, -2346.1869212498814, -3465.305669131711, -2472.1141990331816, -888.9627086974189, -2797.4980731740675, -1789.895021838311, -1044.3704015840858, -2473.1933138559502, -2262.2889155154635, -3626.941104627004, -1442.2840340061764, -1219.1244427151034, -1208.4694985881222, -4086.050889102845, -2604.706717296558, -1639.1359383967501, -3048.4727205226664, -3345.9808612337897, -4355.770546710144, -4101.308744026304, -3086.457139731341, -2702.8657938988636, -3514.5413362714876, -2477.640694399231, -3090.5250841978536, -2169.178247672318, -3228.503736436992, -2896.5913312256566, -3027.3159660824153, -2662.759286694988, -1945.8191291099258, -3294.358411840183, -1557.7291880822402, -4571.2460588080585, -843.5723148261685, -1776.0416735481879, -1464.1163681337587, -4138.753690776126, -2558.602029561268, -2780.9661389847124, -2058.0619235896497, -3422.487409768253, -2683.4341054149018, -3156.5138199962594, -1933.6269765363909, -1884.79318983372, -1416.414270891745, -2541.9324268010014, -2697.696872819948, -1832.8142013697009, -3615.1306464893273, -1453.7181833132354, -2989.099660890369, -1799.847994292859, -3997.310452190516, -3080.20390709324, -2489.2149484321108, -3107.718197202199, -1238.5488906933335, -1251.9802527109953, -3474.639810037454, -1620.36109512193, -2405.847535363229, -1611.730361611232, -3602.4009453444814, -2219.1236621537278, -1465.867840500215, -3938.1891723055464, -3614.3003514866555, -3036.1428512020416, -2322.0982501082444, -2074.6485585108894, -3245.712773730902, -3562.0628875890093, -3738.6309677219665, -3400.759301374648, -3113.381253422255, -1637.5358917268243, -1598.272340963365], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1240.4443949879956, -784.6623418969584, -435.328957261979, -362.089308194328, -753.2348878579353, -712.2034665694728, -552.7950210078302, -116.58991260392779, -873.9010512531587, -1012.4609719521351, -116.36518429154681, -23.683380545857442, -77.88340614254004, -1076.762244256638, -1458.1362760865293, -83.55334328836935, -646.6776639814508, -789.7000792845222, -742.8198758731788, -20.820621148578542, -695.233422402947, -1305.8673419937072, -119.93737485061544, -1030.8539767965767, -479.72024713023626, -955.2895489603205, -1071.3235246981062, -599.9003876441016, -391.18509952864196, -966.2285500550396, -373.5738024672275, -126.04843109061049, -118.85802751954068, -64.24661715500336, -1538.4393556092227, -435.8676145720686, -96.41216952657435, -61.19159705678695, -710.9096667869422, -861.8707140152758, -1297.8983115230249, -1007.6424861418317, -725.7727744133896, -560.4176244996416, -231.91963913087798, -210.68736759376048, -957.4684580818945, -1035.5393505779232, -141.70644629965972, -1177.4450549518651, -779.4135031670203, -975.37923162088, -1080.3518458764904, -470.7822032685451, -166.70195400225884, -271.72550376886323, -468.65271904144, -127.33303918329128, -167.55005556469015, -269.3534665640899, -619.765175584488, -982.0131338583095, -67.52374426041528, -915.2001398524893, -312.8665927223379, -403.1136089270034, -250.7710776973436, -815.3352467619695, -1050.8553333147336, -1125.605405110066, -1027.0582149531474, -291.6776002947562, -74.60775083610011, -43.96941039130219, -389.34002326507056, -1029.112558255918, -173.13265494459478, -809.536767974198, -23.9347943283078, -122.69415751964587, -1192.2053947512895, -279.8599598643766, -793.1507701775352, -533.5176575266842, -996.2393206360991, -521.1996930494668, -190.78134687586063, -530.2024226149703, -167.24453213611594, -118.8753860176704, -1305.946727158626, -177.11667877807102, -261.90787434066203, -450.5874640076052, -821.4204756945722, -489.83772303697725, -1188.2887124404592, -1276.6171614914185, -214.83462997775794, -1.728054350678227, -586.4938912484919, -102.81845704191129, -1065.3709921392808, -275.95787149193404, -1081.0650179956895, -19.84020787024992, -826.7367010456217, -518.2724645716219, -854.8952319522643, -126.44231581012471, -1231.4347972216788, -647.0290509139919, -923.0063939819815, -148.27516842999844, -515.5602585840618, -92.70408990863577, -639.617094616956, -498.13366960754917, -346.997485637691, -894.6618592623514, -158.8928987468356, -304.27661349971413, -216.63406583445536, -58.634380707240595, -150.52474990917239, -1203.235559040316, -616.8646831567468, -807.5334170470566, -101.00230197099921, -68.86211195894988, -286.03920283252256, -872.0721124649396, -401.8819910987151, -159.41976154769253, -70.48195389444184, -58.03843643735491, -364.6668445925896, -257.15930160501796, -328.7386277846048, -35.76719116451979, -595.4585235578533, -160.7396444373795, -761.1633287030902, -857.577094091016, -98.25472306661021, -164.55389193412154, -1177.3528848761987, -143.38845831966526, -196.85493020619128, -580.1387501792874, -72.06940986179943, -677.6321054208111, -834.3495243103032, -1010.3013350147364, -1032.5887300193535, -508.54804254607114, -800.3799974338932, -81.96270910384048, -12.450617966768228, -38.942666955603556, -287.8127461200566, -98.80733991833588, -76.73485380055362, -42.94437797887553, -712.8251248972811, -550.5063447280714, -79.17348668153309, -460.62905317446337, -89.71516195469624, -28.44545204935699, -449.0615965132726, -1011.9337723267585, -94.07730264221429, -1383.8370755417825, -1147.1411420788188, -836.3672722526932, -69.96672730748813, -322.0009291293494, -935.0759447666261, -441.2958438404002, -482.2120208783686, -405.56557737672466, -208.66991692543448, -268.0130675459889, -274.6753556702311, -423.2979000478269, -157.87109508396355, -1295.0580636699888, -802.1695277569768, -370.0761339639131, -1331.86926063452, -1015.4023056363711, -17.027324046740684, -957.8421651818599, -23.83980573429666, -1207.202747178586, -1049.372079362879, -886.6682670408727, -1099.163233244939, -113.36421988286708, -851.9481620684697, -1071.4960664491296, -1080.644924610806, -350.49813888192494, -746.721452015975, -1380.841110355096, -103.93520348364159, -731.930582873531, -297.7461749350602, -572.0040680840127, -51.18960320658797, -1176.5694410048914, -322.6338272021163, -1121.1518265470172, -31.321095938250096, -707.0380871645843, -1176.4273998749302, -16.538363970089797, -1002.1723144379968, -612.365170823888, -288.2048755761463, -763.5223213454228, -813.2229507355661, -503.8841813975817, -108.80636534451334, -1228.9043138961024, -907.5612450733416, -467.4890697081185, -122.88502141653835, -363.68543410374787, -396.9213654627914, -104.12908209478003, -249.99030535781307, -536.8477671497684, -881.2897276071662, -1129.2830229629121, -54.46195159324451, -884.5845914678156, -579.4226250274492, -580.7515453855675, -540.6025158263287, -182.0467685678319, -1294.5039695798264, -84.5316065069701, -794.9064707446998, -292.83967741867747, -53.146198909297844, -925.3280294446914, -623.1238180865321, -1132.8782422232157, -62.815802798329756, -592.5108022065084, -145.95059143158966, -1006.7785957047031, -854.703494553858, -59.952732725668035, -508.3873675877413, -1096.6423589084393, -195.81456660688585, -85.02210328119217, -534.2903188390492, -848.667709871067, -773.165908642543, -207.1190168562993, -931.115457631227, -953.8362462185786, -99.94447431816724, 0.9274887549164089, -102.44113020600587, -402.4348260944037, -376.5975030021191, -1339.049178773648, -707.4915389906084, -1259.68903996014, -888.418798081539, -91.18800155873843, -78.67990190104553, -255.893357564751, -347.94431226643337, -69.86674153519988, -599.3825124948222, -170.62750189523234, -93.26838970422689, -878.6373064721714, -34.12596298173414, -6.277519947531941, -192.92689450399837, -188.53722479057998, -1015.128567656204, -61.246161235444575, -199.33208445424057, -1109.3835758840626, -1246.643022482002, -164.23274275665062, -1419.1622651991693, -744.9839617800608, -902.5278242947521, -404.80595816593694, -86.65405327761255, -419.630232042907, -1092.6853989489493, -856.8723505689786, -619.1942824919333, -78.61663686870166, -133.5974701061497, -460.0235154525759, -109.4123888357613, -1066.1622726243645, -255.69097302366544, -166.7727736532841, -106.69181566103852, -1023.529416567595, -883.3861064314343, -385.0631441693164, -1023.816926938872, -844.4260518349561, -494.839057652073, -837.8086158366383, -343.8653064906879, -162.49507360054707, -991.070541775625, -214.20585805497717, -93.85382612202939, -1435.1928027116537, -422.1907913319716, -218.5840410344116, -48.976647987944375, -351.6724059601175, -1072.8666793902362, -241.5272021636815, -271.1047496297645, -222.8349847709303, -18.998883347563147, -600.5782337845546, -771.2763383009062, -489.4708504551229, -17.58966352703196, -338.12470036903875, -133.147883356012, -438.0811731845399, -584.219063948345, -213.79968244136123, -776.9443739439173, -821.4893308502034, -145.47997561717523, -455.6886072229086, -1201.3637199737568, -40.9252352563545, -814.0908220029869, -185.628488363943, -43.30621045847834, -644.6659088969013, -128.2445955584817, -948.7058200160101, -67.89166643982854, -1110.1290776910482, -1080.7195310045533, -1173.383654575322, -123.72736305444717, -127.17102016395363, -643.4969760038105, -138.13739551707297, -109.03167724875972, -145.37268458305905, -417.67944996053296, -356.2178510046905, -388.0973684882609, -888.1423372986757, -108.0937843454577, -1248.5483197532822, -206.01171325785353, -256.1281830127454, -59.011417389560826, -533.9315511721967, -744.765129460504, -188.98786354466912, -1239.0004200172561, -408.4054898705839, -1052.57743852943, -1108.339240228574, -1011.5057200323014, -767.4362504217856, -600.552019441562, -28.050289795535207, -672.6596274020537, -982.322920514576, -103.28279645150009, -72.15857662675894, -48.65086284143892, -1282.7997919978352, -116.90403294165898, -51.28648642218819, -1383.16129794114, -930.3024656278685, -626.0639142693421, -83.70872620666712, -270.63528482043114, -291.66505539951794, -14.9195308173097, -577.6202934494073, -320.2084145477369, -165.54613038193335, -120.09761657036128, -271.5880319372882, -374.5400592736761, -135.7827932117421, -1076.4001904776837, -1245.3505571279306, -455.9353170260474, -561.1709521940485, -167.07659532549164, -204.55190852449076, -237.13752060125665, -704.4416909636487, -307.15337970704354, -26.238374630257297, -1017.7892135750345, -188.7177395282701, -1097.1304703226479, -75.97173730702067, -442.82760299386285, -552.0394000327944, -477.3598678855751, -12.43225639927606, -127.07123429972471, -962.8521082239292, -1093.874127283878, -782.9722821138132, -440.47229577131145, -322.2301319515504, -89.67042758257439, -572.1892991298381, -197.91424574497645, -1123.2914098955796, -236.0582798007576, -174.6817919287859, -288.38774129740744, -91.68488795504172, -697.8649277781259, -213.2484915408538, -117.53089611400544, -650.1019396395404, -997.2231943591298, -877.817817704646, -1295.515324488225, -156.84116241883964, -1120.1053696260926, -700.4873755283386, -816.3154485147887, -820.5509953985949, -438.07721014035883, -359.6913298114129, -862.384374236916, -98.90115468444208, -1277.0887823289122, -50.65016035244427, -229.69269601267808, -1314.059900793117, -123.14836796201247, -604.5471249879935, -1082.211837178079, -105.43078078328348, -26.484267933643455, -839.5916443308954, -20.930028284988722, -688.9913504049789, -692.8744447506277, -112.03337984036351, -1314.4358420657024, -437.3777566692283, -922.6663201921777, -415.3711572372342, -1008.6119879251861, -158.11448265648542, -1057.2989395779284, -370.0051067078806, -1052.9681234169627, -499.53864003345177, -740.2254595373547, -1075.8936380263146, -472.3837171564039, -978.8624888965211, -863.696763148806, -840.4220811973971, -245.39425097552328, -443.9649637951834, -1033.0588853896131, -159.41714316621125, -602.6506251387619, -874.2896359324858, 5.146184726428563, -1187.5231367878569, -74.66937752772705, -179.4733658026346, -201.01619633503472, -69.59507247449935, -320.10221160481655, -73.67789466621599, -1020.402870781673, -114.4942914361595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5276478199937886, "mean_inference_ms": 1.7130040219577105, "mean_action_processing_ms": 0.790989698562757, "mean_env_wait_ms": 10.203944720604976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013212919235229492, "StateBufferConnector_ms": 0.009765863418579102, "ViewRequirementAgentConnector_ms": 0.32784605026245117}, "num_episodes": 28, "episode_return_max": -843.5723148261685, "episode_return_min": -4571.2460588080585, "episode_return_mean": -2654.9609102150403, "episodes_this_iter": 28}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1649722, "num_agent_steps_trained": 1649722, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.92452523701162, "num_env_steps_trained_throughput_per_sec": 78.92452523701162, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1649722, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1649722, "timers": {"training_iteration_time_ms": 45468.024, "restore_workers_time_ms": 0.025, "training_step_time_ms": 45467.958, "sample_time_ms": 3210.526, "learn_time_ms": 42202.588, "learn_throughput": 94.781, "synch_weights_time_ms": 52.063}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1649722, "num_agent_steps_trained": 1649722}, "done": false, "training_iteration": 95, "trial_id": "05c72_00000", "date": "2024-07-26_15-59-59", "timestamp": 1721989799, "time_this_iter_s": 50.69249963760376, "time_total_s": 4616.234566688538, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd014a170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4616.234566688538, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 10.572222222222221, "ram_util_percent": 30.10833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 135.88504108722393, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.271578029852647, "policy_loss": -0.0020448030810206173, "vf_loss": 4.291804291162736, "vf_explained_var": 0.9905655649227973, "kl": 0.01549650236826169, "entropy": 2.9949111572290077, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.85384615384615, "num_grad_updates_lifetime": 389970.5, "diff_num_grad_updates_vs_sampler_policy": 1949.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1666343, "num_agent_steps_trained": 1666343}, "env_runners": {"episode_reward_max": -843.5723148261685, "episode_reward_min": -4571.2460588080585, "episode_reward_mean": -2574.8588449099143, "episode_len_mean": 148.0, "episode_media": {}, "episodes_timesteps_total": 14800, "policy_reward_min": {"policy_0": -1435.1928027116537}, "policy_reward_max": {"policy_0": 5.146184726428563}, "policy_reward_mean": {"policy_0": -514.9717689819828}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1789.895021838311, -1044.3704015840858, -2473.1933138559502, -2262.2889155154635, -3626.941104627004, -1442.2840340061764, -1219.1244427151034, -1208.4694985881222, -4086.050889102845, -2604.706717296558, -1639.1359383967501, -3048.4727205226664, -3345.9808612337897, -4355.770546710144, -4101.308744026304, -3086.457139731341, -2702.8657938988636, -3514.5413362714876, -2477.640694399231, -3090.5250841978536, -2169.178247672318, -3228.503736436992, -2896.5913312256566, -3027.3159660824153, -2662.759286694988, -1945.8191291099258, -3294.358411840183, -1557.7291880822402, -4571.2460588080585, -843.5723148261685, -1776.0416735481879, -1464.1163681337587, -4138.753690776126, -2558.602029561268, -2780.9661389847124, -2058.0619235896497, -3422.487409768253, -2683.4341054149018, -3156.5138199962594, -1933.6269765363909, -1884.79318983372, -1416.414270891745, -2541.9324268010014, -2697.696872819948, -1832.8142013697009, -3615.1306464893273, -1453.7181833132354, -2989.099660890369, -1799.847994292859, -3997.310452190516, -3080.20390709324, -2489.2149484321108, -3107.718197202199, -1238.5488906933335, -1251.9802527109953, -3474.639810037454, -1620.36109512193, -2405.847535363229, -1611.730361611232, -3602.4009453444814, -2219.1236621537278, -1465.867840500215, -3938.1891723055464, -3614.3003514866555, -3036.1428512020416, -2322.0982501082444, -2074.6485585108894, -3245.712773730902, -3562.0628875890093, -3738.6309677219665, -3400.759301374648, -3113.381253422255, -1637.5358917268243, -1598.272340963365, -3777.22827022658, -2810.0583577751654, -2586.7848011727738, -2957.150030322949, -3530.035918477647, -1834.942540401413, -1421.9647445315932, -2612.607815875399, -1405.3641067561393, -3996.061004510009, -1303.5100136209514, -1770.941237595015, -2481.2002097592313, -2514.217193098325, -2222.560680192319, -2179.11132804114, -3344.1603494819087, -2116.5175900706395, -2590.386246481582, -1322.7525795627935, -3386.1435033897455, -2424.6459130379135, -2830.9337856090524, -3090.1325826059274, -1198.138975070089, -3410.5037624196702], "episode_lengths": [150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-286.03920283252256, -872.0721124649396, -401.8819910987151, -159.41976154769253, -70.48195389444184, -58.03843643735491, -364.6668445925896, -257.15930160501796, -328.7386277846048, -35.76719116451979, -595.4585235578533, -160.7396444373795, -761.1633287030902, -857.577094091016, -98.25472306661021, -164.55389193412154, -1177.3528848761987, -143.38845831966526, -196.85493020619128, -580.1387501792874, -72.06940986179943, -677.6321054208111, -834.3495243103032, -1010.3013350147364, -1032.5887300193535, -508.54804254607114, -800.3799974338932, -81.96270910384048, -12.450617966768228, -38.942666955603556, -287.8127461200566, -98.80733991833588, -76.73485380055362, -42.94437797887553, -712.8251248972811, -550.5063447280714, -79.17348668153309, -460.62905317446337, -89.71516195469624, -28.44545204935699, -449.0615965132726, -1011.9337723267585, -94.07730264221429, -1383.8370755417825, -1147.1411420788188, -836.3672722526932, -69.96672730748813, -322.0009291293494, -935.0759447666261, -441.2958438404002, -482.2120208783686, -405.56557737672466, -208.66991692543448, -268.0130675459889, -274.6753556702311, -423.2979000478269, -157.87109508396355, -1295.0580636699888, -802.1695277569768, -370.0761339639131, -1331.86926063452, -1015.4023056363711, -17.027324046740684, -957.8421651818599, -23.83980573429666, -1207.202747178586, -1049.372079362879, -886.6682670408727, -1099.163233244939, -113.36421988286708, -851.9481620684697, -1071.4960664491296, -1080.644924610806, -350.49813888192494, -746.721452015975, -1380.841110355096, -103.93520348364159, -731.930582873531, -297.7461749350602, -572.0040680840127, -51.18960320658797, -1176.5694410048914, -322.6338272021163, -1121.1518265470172, -31.321095938250096, -707.0380871645843, -1176.4273998749302, -16.538363970089797, -1002.1723144379968, -612.365170823888, -288.2048755761463, -763.5223213454228, -813.2229507355661, -503.8841813975817, -108.80636534451334, -1228.9043138961024, -907.5612450733416, -467.4890697081185, -122.88502141653835, -363.68543410374787, -396.9213654627914, -104.12908209478003, -249.99030535781307, -536.8477671497684, -881.2897276071662, -1129.2830229629121, -54.46195159324451, -884.5845914678156, -579.4226250274492, -580.7515453855675, -540.6025158263287, -182.0467685678319, -1294.5039695798264, -84.5316065069701, -794.9064707446998, -292.83967741867747, -53.146198909297844, -925.3280294446914, -623.1238180865321, -1132.8782422232157, -62.815802798329756, -592.5108022065084, -145.95059143158966, -1006.7785957047031, -854.703494553858, -59.952732725668035, -508.3873675877413, -1096.6423589084393, -195.81456660688585, -85.02210328119217, -534.2903188390492, -848.667709871067, -773.165908642543, -207.1190168562993, -931.115457631227, -953.8362462185786, -99.94447431816724, 0.9274887549164089, -102.44113020600587, -402.4348260944037, -376.5975030021191, -1339.049178773648, -707.4915389906084, -1259.68903996014, -888.418798081539, -91.18800155873843, -78.67990190104553, -255.893357564751, -347.94431226643337, -69.86674153519988, -599.3825124948222, -170.62750189523234, -93.26838970422689, -878.6373064721714, -34.12596298173414, -6.277519947531941, -192.92689450399837, -188.53722479057998, -1015.128567656204, -61.246161235444575, -199.33208445424057, -1109.3835758840626, -1246.643022482002, -164.23274275665062, -1419.1622651991693, -744.9839617800608, -902.5278242947521, -404.80595816593694, -86.65405327761255, -419.630232042907, -1092.6853989489493, -856.8723505689786, -619.1942824919333, -78.61663686870166, -133.5974701061497, -460.0235154525759, -109.4123888357613, -1066.1622726243645, -255.69097302366544, -166.7727736532841, -106.69181566103852, -1023.529416567595, -883.3861064314343, -385.0631441693164, -1023.816926938872, -844.4260518349561, -494.839057652073, -837.8086158366383, -343.8653064906879, -162.49507360054707, -991.070541775625, -214.20585805497717, -93.85382612202939, -1435.1928027116537, -422.1907913319716, -218.5840410344116, -48.976647987944375, -351.6724059601175, -1072.8666793902362, -241.5272021636815, -271.1047496297645, -222.8349847709303, -18.998883347563147, -600.5782337845546, -771.2763383009062, -489.4708504551229, -17.58966352703196, -338.12470036903875, -133.147883356012, -438.0811731845399, -584.219063948345, -213.79968244136123, -776.9443739439173, -821.4893308502034, -145.47997561717523, -455.6886072229086, -1201.3637199737568, -40.9252352563545, -814.0908220029869, -185.628488363943, -43.30621045847834, -644.6659088969013, -128.2445955584817, -948.7058200160101, -67.89166643982854, -1110.1290776910482, -1080.7195310045533, -1173.383654575322, -123.72736305444717, -127.17102016395363, -643.4969760038105, -138.13739551707297, -109.03167724875972, -145.37268458305905, -417.67944996053296, -356.2178510046905, -388.0973684882609, -888.1423372986757, -108.0937843454577, -1248.5483197532822, -206.01171325785353, -256.1281830127454, -59.011417389560826, -533.9315511721967, -744.765129460504, -188.98786354466912, -1239.0004200172561, -408.4054898705839, -1052.57743852943, -1108.339240228574, -1011.5057200323014, -767.4362504217856, -600.552019441562, -28.050289795535207, -672.6596274020537, -982.322920514576, -103.28279645150009, -72.15857662675894, -48.65086284143892, -1282.7997919978352, -116.90403294165898, -51.28648642218819, -1383.16129794114, -930.3024656278685, -626.0639142693421, -83.70872620666712, -270.63528482043114, -291.66505539951794, -14.9195308173097, -577.6202934494073, -320.2084145477369, -165.54613038193335, -120.09761657036128, -271.5880319372882, -374.5400592736761, -135.7827932117421, -1076.4001904776837, -1245.3505571279306, -455.9353170260474, -561.1709521940485, -167.07659532549164, -204.55190852449076, -237.13752060125665, -704.4416909636487, -307.15337970704354, -26.238374630257297, -1017.7892135750345, -188.7177395282701, -1097.1304703226479, -75.97173730702067, -442.82760299386285, -552.0394000327944, -477.3598678855751, -12.43225639927606, -127.07123429972471, -962.8521082239292, -1093.874127283878, -782.9722821138132, -440.47229577131145, -322.2301319515504, -89.67042758257439, -572.1892991298381, -197.91424574497645, -1123.2914098955796, -236.0582798007576, -174.6817919287859, -288.38774129740744, -91.68488795504172, -697.8649277781259, -213.2484915408538, -117.53089611400544, -650.1019396395404, -997.2231943591298, -877.817817704646, -1295.515324488225, -156.84116241883964, -1120.1053696260926, -700.4873755283386, -816.3154485147887, -820.5509953985949, -438.07721014035883, -359.6913298114129, -862.384374236916, -98.90115468444208, -1277.0887823289122, -50.65016035244427, -229.69269601267808, -1314.059900793117, -123.14836796201247, -604.5471249879935, -1082.211837178079, -105.43078078328348, -26.484267933643455, -839.5916443308954, -20.930028284988722, -688.9913504049789, -692.8744447506277, -112.03337984036351, -1314.4358420657024, -437.3777566692283, -922.6663201921777, -415.3711572372342, -1008.6119879251861, -158.11448265648542, -1057.2989395779284, -370.0051067078806, -1052.9681234169627, -499.53864003345177, -740.2254595373547, -1075.8936380263146, -472.3837171564039, -978.8624888965211, -863.696763148806, -840.4220811973971, -245.39425097552328, -443.9649637951834, -1033.0588853896131, -159.41714316621125, -602.6506251387619, -874.2896359324858, 5.146184726428563, -1187.5231367878569, -74.66937752772705, -179.4733658026346, -201.01619633503472, -69.59507247449935, -320.10221160481655, -73.67789466621599, -1020.402870781673, -114.4942914361595, -1274.0240137338938, -1307.9834208033217, -145.7862250701613, -845.6532696066226, -203.78134101258195, -239.291009637497, -420.532596072702, -569.1667420079175, -826.9036949861796, -754.1643150708695, -399.19541042454114, -31.63722893051438, -1162.3272960498002, -681.614267380936, -312.01059838698274, -45.14267444474022, -317.97730415364236, -1155.238595573488, -1111.5247590937745, -327.26669705730495, -835.174115590155, -526.6772233680439, -730.1024801780206, -943.5261347629566, -494.555964578472, -122.59026203897463, -428.4322753340857, -360.25510959013263, -144.35742365138054, -779.30746978684, -510.1061048406115, -90.469985799463, -562.8437213003148, -133.56038564513253, -124.98454694607244, -994.6397231366839, -14.133321437927677, -953.717194687119, -278.11029616428544, -372.00728044938325, -471.70687070646125, -870.6922855519099, -10.315351219127345, -50.34094755140475, -2.30865172723679, -291.78267495067934, -1182.865829255115, -1222.4680543324184, -1075.9605798419261, -222.98386612987014, -177.76280357940965, -324.59765498424457, -156.51563451233002, -97.9605156787083, -546.6734048662588, -543.8293232555059, -134.1120313640035, -621.7198597119348, -416.0810316574404, -55.19899160613111, -851.5703462171512, -860.382553453822, -630.9632037163339, -3.88367031463641, -134.40043605728889, -375.38773176520095, -848.3566188928158, -731.8668051562476, -116.99927467999484, -441.60676260406785, -778.7426054587007, -774.3137715994056, -34.463748159265705, -467.32460461245955, -167.71595036248468, -734.7486478243393, -23.080255531956595, -26.153565711653712, -1130.8210241144511, -264.30783485874025, -182.9008479163748, -1224.899483410255, -687.2254025106521, -509.71700894901113, -739.4176066956153, -1237.3917353216239, -243.72996789108998, -101.36007885693287, -191.0063113986544, -343.02949660233986, -572.4009208786744, -136.02111191499043, -1045.036348580484, -424.94448370126383, -411.98338140617216, -455.9859322674258, -257.6908791507061, -120.983907620484, -143.41732083335393, -344.67453969082254, -625.2549292303352, -33.83794961233124, -385.7945352808435, -1346.6393930872348, -994.6166961789994, -1289.242453812509, -456.4146719300663, -168.91135817036275, -117.40432487556507, -392.67310424941144, -958.6499931870151, -729.3881946634965, -341.48786944067393, -285.62477636218733, -515.7829519556781, -299.6215390364011, -85.46840466555221, -684.6686281838076, -1053.2680869332514, -967.1059237869152, -83.61307403864193, -69.23720969551773, -474.0177246828191, -92.9369225982488, -478.3340440548622, -599.3514491845795, -331.98626673030554, -1119.2020209602251, -466.2898600078957, -893.6741655366659]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5263730532142492, "mean_inference_ms": 1.7121881023606103, "mean_action_processing_ms": 0.7903232389596744, "mean_env_wait_ms": 10.196470889263527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01314854621887207, "StateBufferConnector_ms": 0.009465932846069336, "ViewRequirementAgentConnector_ms": 0.32056641578674316}, "num_episodes": 26, "episode_return_max": -843.5723148261685, "episode_return_min": -4571.2460588080585, "episode_return_mean": -2574.8588449099143, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1666343, "num_agent_steps_trained": 1666343, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.27785486875341, "num_env_steps_trained_throughput_per_sec": 78.27785486875341, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1666343, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1666343, "timers": {"training_iteration_time_ms": 45557.684, "restore_workers_time_ms": 0.025, "training_step_time_ms": 45557.618, "sample_time_ms": 3201.54, "learn_time_ms": 42301.956, "learn_throughput": 94.558, "synch_weights_time_ms": 51.325}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1666343, "num_agent_steps_trained": 1666343}, "done": false, "training_iteration": 96, "trial_id": "05c72_00000", "date": "2024-07-26_16-00-50", "timestamp": 1721989850, "time_this_iter_s": 51.11038327217102, "time_total_s": 4667.344949960709, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00f8700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4667.344949960709, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 10.693150684931506, "ram_util_percent": 30.160273972602738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 129.1294876421415, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.505260878740213, "policy_loss": -0.006144820964919069, "vf_loss": 4.5292076079356365, "vf_explained_var": 0.9871810149993652, "kl": 0.014854691851860247, "entropy": 2.9082190893857907, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.08461538461539, "num_grad_updates_lifetime": 393870.5, "diff_num_grad_updates_vs_sampler_policy": 1949.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1682864, "num_agent_steps_trained": 1682864}, "env_runners": {"episode_reward_max": -843.5723148261685, "episode_reward_min": -4571.2460588080585, "episode_reward_mean": -2502.5531646054924, "episode_len_mean": 148.29, "episode_media": {}, "episodes_timesteps_total": 14829, "policy_reward_min": {"policy_0": -1455.426461024777}, "policy_reward_max": {"policy_0": 5.146184726428563}, "policy_reward_mean": {"policy_0": -500.5106329210985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3294.358411840183, -1557.7291880822402, -4571.2460588080585, -843.5723148261685, -1776.0416735481879, -1464.1163681337587, -4138.753690776126, -2558.602029561268, -2780.9661389847124, -2058.0619235896497, -3422.487409768253, -2683.4341054149018, -3156.5138199962594, -1933.6269765363909, -1884.79318983372, -1416.414270891745, -2541.9324268010014, -2697.696872819948, -1832.8142013697009, -3615.1306464893273, -1453.7181833132354, -2989.099660890369, -1799.847994292859, -3997.310452190516, -3080.20390709324, -2489.2149484321108, -3107.718197202199, -1238.5488906933335, -1251.9802527109953, -3474.639810037454, -1620.36109512193, -2405.847535363229, -1611.730361611232, -3602.4009453444814, -2219.1236621537278, -1465.867840500215, -3938.1891723055464, -3614.3003514866555, -3036.1428512020416, -2322.0982501082444, -2074.6485585108894, -3245.712773730902, -3562.0628875890093, -3738.6309677219665, -3400.759301374648, -3113.381253422255, -1637.5358917268243, -1598.272340963365, -3777.22827022658, -2810.0583577751654, -2586.7848011727738, -2957.150030322949, -3530.035918477647, -1834.942540401413, -1421.9647445315932, -2612.607815875399, -1405.3641067561393, -3996.061004510009, -1303.5100136209514, -1770.941237595015, -2481.2002097592313, -2514.217193098325, -2222.560680192319, -2179.11132804114, -3344.1603494819087, -2116.5175900706395, -2590.386246481582, -1322.7525795627935, -3386.1435033897455, -2424.6459130379135, -2830.9337856090524, -3090.1325826059274, -1198.138975070089, -3410.5037624196702, -2718.9129904848915, -1423.2726742605228, -2680.058752257764, -1292.087788098785, -1894.5866528251931, -2268.1656586399117, -2654.6370839804035, -871.3149389375043, -3200.738646484125, -1938.5230420801158, -2176.550557440831, -1550.1660419481466, -1693.4010506561117, -2389.336337670897, -2790.232640016352, -2347.5331127891154, -4560.49476674309, -1855.7461316852366, -2268.7790583021497, -2744.0197674968726, -2820.8692823079537, -3436.733454497134, -1837.224417432962, -2723.4024359189057, -3711.8046086139266, -1971.030973729297], "episode_lengths": [150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-534.2903188390492, -848.667709871067, -773.165908642543, -207.1190168562993, -931.115457631227, -953.8362462185786, -99.94447431816724, 0.9274887549164089, -102.44113020600587, -402.4348260944037, -376.5975030021191, -1339.049178773648, -707.4915389906084, -1259.68903996014, -888.418798081539, -91.18800155873843, -78.67990190104553, -255.893357564751, -347.94431226643337, -69.86674153519988, -599.3825124948222, -170.62750189523234, -93.26838970422689, -878.6373064721714, -34.12596298173414, -6.277519947531941, -192.92689450399837, -188.53722479057998, -1015.128567656204, -61.246161235444575, -199.33208445424057, -1109.3835758840626, -1246.643022482002, -164.23274275665062, -1419.1622651991693, -744.9839617800608, -902.5278242947521, -404.80595816593694, -86.65405327761255, -419.630232042907, -1092.6853989489493, -856.8723505689786, -619.1942824919333, -78.61663686870166, -133.5974701061497, -460.0235154525759, -109.4123888357613, -1066.1622726243645, -255.69097302366544, -166.7727736532841, -106.69181566103852, -1023.529416567595, -883.3861064314343, -385.0631441693164, -1023.816926938872, -844.4260518349561, -494.839057652073, -837.8086158366383, -343.8653064906879, -162.49507360054707, -991.070541775625, -214.20585805497717, -93.85382612202939, -1435.1928027116537, -422.1907913319716, -218.5840410344116, -48.976647987944375, -351.6724059601175, -1072.8666793902362, -241.5272021636815, -271.1047496297645, -222.8349847709303, -18.998883347563147, -600.5782337845546, -771.2763383009062, -489.4708504551229, -17.58966352703196, -338.12470036903875, -133.147883356012, -438.0811731845399, -584.219063948345, -213.79968244136123, -776.9443739439173, -821.4893308502034, -145.47997561717523, -455.6886072229086, -1201.3637199737568, -40.9252352563545, -814.0908220029869, -185.628488363943, -43.30621045847834, -644.6659088969013, -128.2445955584817, -948.7058200160101, -67.89166643982854, -1110.1290776910482, -1080.7195310045533, -1173.383654575322, -123.72736305444717, -127.17102016395363, -643.4969760038105, -138.13739551707297, -109.03167724875972, -145.37268458305905, -417.67944996053296, -356.2178510046905, -388.0973684882609, -888.1423372986757, -108.0937843454577, -1248.5483197532822, -206.01171325785353, -256.1281830127454, -59.011417389560826, -533.9315511721967, -744.765129460504, -188.98786354466912, -1239.0004200172561, -408.4054898705839, -1052.57743852943, -1108.339240228574, -1011.5057200323014, -767.4362504217856, -600.552019441562, -28.050289795535207, -672.6596274020537, -982.322920514576, -103.28279645150009, -72.15857662675894, -48.65086284143892, -1282.7997919978352, -116.90403294165898, -51.28648642218819, -1383.16129794114, -930.3024656278685, -626.0639142693421, -83.70872620666712, -270.63528482043114, -291.66505539951794, -14.9195308173097, -577.6202934494073, -320.2084145477369, -165.54613038193335, -120.09761657036128, -271.5880319372882, -374.5400592736761, -135.7827932117421, -1076.4001904776837, -1245.3505571279306, -455.9353170260474, -561.1709521940485, -167.07659532549164, -204.55190852449076, -237.13752060125665, -704.4416909636487, -307.15337970704354, -26.238374630257297, -1017.7892135750345, -188.7177395282701, -1097.1304703226479, -75.97173730702067, -442.82760299386285, -552.0394000327944, -477.3598678855751, -12.43225639927606, -127.07123429972471, -962.8521082239292, -1093.874127283878, -782.9722821138132, -440.47229577131145, -322.2301319515504, -89.67042758257439, -572.1892991298381, -197.91424574497645, -1123.2914098955796, -236.0582798007576, -174.6817919287859, -288.38774129740744, -91.68488795504172, -697.8649277781259, -213.2484915408538, -117.53089611400544, -650.1019396395404, -997.2231943591298, -877.817817704646, -1295.515324488225, -156.84116241883964, -1120.1053696260926, -700.4873755283386, -816.3154485147887, -820.5509953985949, -438.07721014035883, -359.6913298114129, -862.384374236916, -98.90115468444208, -1277.0887823289122, -50.65016035244427, -229.69269601267808, -1314.059900793117, -123.14836796201247, -604.5471249879935, -1082.211837178079, -105.43078078328348, -26.484267933643455, -839.5916443308954, -20.930028284988722, -688.9913504049789, -692.8744447506277, -112.03337984036351, -1314.4358420657024, -437.3777566692283, -922.6663201921777, -415.3711572372342, -1008.6119879251861, -158.11448265648542, -1057.2989395779284, -370.0051067078806, -1052.9681234169627, -499.53864003345177, -740.2254595373547, -1075.8936380263146, -472.3837171564039, -978.8624888965211, -863.696763148806, -840.4220811973971, -245.39425097552328, -443.9649637951834, -1033.0588853896131, -159.41714316621125, -602.6506251387619, -874.2896359324858, 5.146184726428563, -1187.5231367878569, -74.66937752772705, -179.4733658026346, -201.01619633503472, -69.59507247449935, -320.10221160481655, -73.67789466621599, -1020.402870781673, -114.4942914361595, -1274.0240137338938, -1307.9834208033217, -145.7862250701613, -845.6532696066226, -203.78134101258195, -239.291009637497, -420.532596072702, -569.1667420079175, -826.9036949861796, -754.1643150708695, -399.19541042454114, -31.63722893051438, -1162.3272960498002, -681.614267380936, -312.01059838698274, -45.14267444474022, -317.97730415364236, -1155.238595573488, -1111.5247590937745, -327.26669705730495, -835.174115590155, -526.6772233680439, -730.1024801780206, -943.5261347629566, -494.555964578472, -122.59026203897463, -428.4322753340857, -360.25510959013263, -144.35742365138054, -779.30746978684, -510.1061048406115, -90.469985799463, -562.8437213003148, -133.56038564513253, -124.98454694607244, -994.6397231366839, -14.133321437927677, -953.717194687119, -278.11029616428544, -372.00728044938325, -471.70687070646125, -870.6922855519099, -10.315351219127345, -50.34094755140475, -2.30865172723679, -291.78267495067934, -1182.865829255115, -1222.4680543324184, -1075.9605798419261, -222.98386612987014, -177.76280357940965, -324.59765498424457, -156.51563451233002, -97.9605156787083, -546.6734048662588, -543.8293232555059, -134.1120313640035, -621.7198597119348, -416.0810316574404, -55.19899160613111, -851.5703462171512, -860.382553453822, -630.9632037163339, -3.88367031463641, -134.40043605728889, -375.38773176520095, -848.3566188928158, -731.8668051562476, -116.99927467999484, -441.60676260406785, -778.7426054587007, -774.3137715994056, -34.463748159265705, -467.32460461245955, -167.71595036248468, -734.7486478243393, -23.080255531956595, -26.153565711653712, -1130.8210241144511, -264.30783485874025, -182.9008479163748, -1224.899483410255, -687.2254025106521, -509.71700894901113, -739.4176066956153, -1237.3917353216239, -243.72996789108998, -101.36007885693287, -191.0063113986544, -343.02949660233986, -572.4009208786744, -136.02111191499043, -1045.036348580484, -424.94448370126383, -411.98338140617216, -455.9859322674258, -257.6908791507061, -120.983907620484, -143.41732083335393, -344.67453969082254, -625.2549292303352, -33.83794961233124, -385.7945352808435, -1346.6393930872348, -994.6166961789994, -1289.242453812509, -456.4146719300663, -168.91135817036275, -117.40432487556507, -392.67310424941144, -958.6499931870151, -729.3881946634965, -341.48786944067393, -285.62477636218733, -515.7829519556781, -299.6215390364011, -85.46840466555221, -684.6686281838076, -1053.2680869332514, -967.1059237869152, -83.61307403864193, -69.23720969551773, -474.0177246828191, -92.9369225982488, -478.3340440548622, -599.3514491845795, -331.98626673030554, -1119.2020209602251, -466.2898600078957, -893.6741655366659, -549.1575453560322, -523.439892882087, -1390.5606693465666, -17.218940321204443, -238.53594257900198, -427.05441383608445, -270.4635578092723, -191.35574083419982, -32.11516966365438, -502.28379211731203, -403.19473513858884, -1096.9805429942999, -617.6905927424384, -26.09671098858617, -536.0961703938484, -176.00715149991237, -127.96743997633624, -52.42435560013274, -96.80996086982194, -838.8788801525811, -52.683811927528254, -79.77455443810592, -1003.803571333498, -491.5311602576856, -266.79355486837505, -50.06749963699895, -37.07264475697689, -703.6126984938898, -1173.1795727129384, -304.23324303910675, -885.5000457194012, -154.54601531064864, -603.5194676408364, -227.33424028803952, -783.7373150214746, -185.44011163219997, -65.0160643572898, -34.23147991868191, -567.0156606787286, -19.61162235060397, -1029.8015993010567, -169.0995983894748, -188.47015233136526, -1211.5988992815935, -601.7683971806351, -22.49664293522219, -1140.5285516006102, -346.08960319790083, -334.93995439982973, -94.46828994655179, -308.83504928608943, -329.134297342361, -306.7574915667783, -1031.2760640439863, -200.5476552016148, -518.8132759895939, -180.58293581498648, -76.49625081786834, -758.0885317464148, -16.1850475792848, -146.5738680318334, -312.8052470247508, -164.94906560905915, -878.5697716642383, -190.50309832622847, -16.91712187909769, -714.7776822425395, -241.38643171089748, -1384.7035153431375, -31.551586495225706, -403.8754695897782, -146.71563761178447, -1059.4454328286408, -908.0926548167251, -272.1034451694197, -507.19088238406755, -69.14227904774376, -998.7554805804001, -91.40255502796812, -681.0419157489348, -1234.9933384385442, -1135.882826900047, -400.52813045623856, -1057.4577787648418, -731.6326921834212, -211.2137178958145, -250.5569201916163, -75.08095026971041, -472.4306205010208, -846.4639228270747, -1208.0517119204321, -155.09575188736704, -42.60635951116469, -584.6802553453297, -278.34497963785554, -362.5357674655634, -417.31169085923926, -722.0595283931515, -236.09579187392472, -1006.0169889049947, -416.5901859939852, -411.66280548614196, -470.2098319838272, -1455.426461024777, -66.97999781922434, -1454.9354962590414, -443.34085334810993, -103.54096286990513, -775.3493173007171, -659.5668247193616, -1140.811031592752, -139.24717706004537, -171.0299122840282, -315.24602415161706, -70.89027234452053, -656.3210627197601, -393.4222639874758, -415.7467550411625, -1116.0342776973519, -141.8780764731534, -93.49440535035563, -1165.585168590779, -182.42573848478781, -1255.481080545851, -1014.8182156421544, -230.11589193216417, -158.37726600297188, -135.26684872284534, -479.14090703725026, -968.1300600340674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.525328440342342, "mean_inference_ms": 1.7117774948735496, "mean_action_processing_ms": 0.7897296924030396, "mean_env_wait_ms": 10.190203850264773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012581586837768555, "StateBufferConnector_ms": 0.009085893630981445, "ViewRequirementAgentConnector_ms": 0.3026108741760254}, "num_episodes": 26, "episode_return_max": -843.5723148261685, "episode_return_min": -4571.2460588080585, "episode_return_mean": -2502.5531646054924, "episodes_this_iter": 26}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1682864, "num_agent_steps_trained": 1682864, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.57693790676049, "num_env_steps_trained_throughput_per_sec": 81.57693790676049, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1682864, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1682864, "timers": {"training_iteration_time_ms": 46801.866, "restore_workers_time_ms": 0.025, "training_step_time_ms": 46801.799, "sample_time_ms": 3203.021, "learn_time_ms": 43544.575, "learn_throughput": 91.86, "synch_weights_time_ms": 51.445}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1682864, "num_agent_steps_trained": 1682864}, "done": false, "training_iteration": 97, "trial_id": "05c72_00000", "date": "2024-07-26_16-01-39", "timestamp": 1721989899, "time_this_iter_s": 49.04404139518738, "time_total_s": 4716.388991355896, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00f9a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4716.388991355896, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 10.876811594202898, "ram_util_percent": 30.16521739130435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 132.93910541784732, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.223464996545647, "policy_loss": -0.0058838466875381305, "vf_loss": 4.249132638090239, "vf_explained_var": 0.9914961646548094, "kl": 0.014264409310762524, "entropy": 3.0615833554680894, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.99212598425197, "num_grad_updates_lifetime": 397725.5, "diff_num_grad_updates_vs_sampler_policy": 1904.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1699119, "num_agent_steps_trained": 1699119}, "env_runners": {"episode_reward_max": -871.3149389375043, "episode_reward_min": -4560.49476674309, "episode_reward_mean": -2459.7136896016764, "episode_len_mean": 148.84, "episode_media": {}, "episodes_timesteps_total": 14884, "policy_reward_min": {"policy_0": -1455.426461024777}, "policy_reward_max": {"policy_0": 5.146184726428563}, "policy_reward_mean": {"policy_0": -491.9427379203353}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3474.639810037454, -1620.36109512193, -2405.847535363229, -1611.730361611232, -3602.4009453444814, -2219.1236621537278, -1465.867840500215, -3938.1891723055464, -3614.3003514866555, -3036.1428512020416, -2322.0982501082444, -2074.6485585108894, -3245.712773730902, -3562.0628875890093, -3738.6309677219665, -3400.759301374648, -3113.381253422255, -1637.5358917268243, -1598.272340963365, -3777.22827022658, -2810.0583577751654, -2586.7848011727738, -2957.150030322949, -3530.035918477647, -1834.942540401413, -1421.9647445315932, -2612.607815875399, -1405.3641067561393, -3996.061004510009, -1303.5100136209514, -1770.941237595015, -2481.2002097592313, -2514.217193098325, -2222.560680192319, -2179.11132804114, -3344.1603494819087, -2116.5175900706395, -2590.386246481582, -1322.7525795627935, -3386.1435033897455, -2424.6459130379135, -2830.9337856090524, -3090.1325826059274, -1198.138975070089, -3410.5037624196702, -2718.9129904848915, -1423.2726742605228, -2680.058752257764, -1292.087788098785, -1894.5866528251931, -2268.1656586399117, -2654.6370839804035, -871.3149389375043, -3200.738646484125, -1938.5230420801158, -2176.550557440831, -1550.1660419481466, -1693.4010506561117, -2389.336337670897, -2790.232640016352, -2347.5331127891154, -4560.49476674309, -1855.7461316852366, -2268.7790583021497, -2744.0197674968726, -2820.8692823079537, -3436.733454497134, -1837.224417432962, -2723.4024359189057, -3711.8046086139266, -1971.030973729297, -4259.059391183562, -2413.0891929453696, -2081.2111261360787, -1497.711999809125, -1492.34287661793, -2153.3254321694567, -1107.9608846613744, -4195.225793030244, -3683.2024336770914, -2989.1417227585184, -2137.286631482168, -2015.9676751734119, -1734.200157677199, -1546.773057666588, -3731.356430316985, -2081.726224116008, -2345.724318382626, -2677.2517645511157, -1361.6226035230713, -2312.4151925534666, -1575.4825561140894, -2354.2161268656278, -2275.5281496299112, -2090.4404758276014, -2423.2804061146826, -2492.1386290468804, -2286.47947786655, -2438.7783965505373, -1599.047578061585], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150], "policy_policy_0_reward": [-135.7827932117421, -1076.4001904776837, -1245.3505571279306, -455.9353170260474, -561.1709521940485, -167.07659532549164, -204.55190852449076, -237.13752060125665, -704.4416909636487, -307.15337970704354, -26.238374630257297, -1017.7892135750345, -188.7177395282701, -1097.1304703226479, -75.97173730702067, -442.82760299386285, -552.0394000327944, -477.3598678855751, -12.43225639927606, -127.07123429972471, -962.8521082239292, -1093.874127283878, -782.9722821138132, -440.47229577131145, -322.2301319515504, -89.67042758257439, -572.1892991298381, -197.91424574497645, -1123.2914098955796, -236.0582798007576, -174.6817919287859, -288.38774129740744, -91.68488795504172, -697.8649277781259, -213.2484915408538, -117.53089611400544, -650.1019396395404, -997.2231943591298, -877.817817704646, -1295.515324488225, -156.84116241883964, -1120.1053696260926, -700.4873755283386, -816.3154485147887, -820.5509953985949, -438.07721014035883, -359.6913298114129, -862.384374236916, -98.90115468444208, -1277.0887823289122, -50.65016035244427, -229.69269601267808, -1314.059900793117, -123.14836796201247, -604.5471249879935, -1082.211837178079, -105.43078078328348, -26.484267933643455, -839.5916443308954, -20.930028284988722, -688.9913504049789, -692.8744447506277, -112.03337984036351, -1314.4358420657024, -437.3777566692283, -922.6663201921777, -415.3711572372342, -1008.6119879251861, -158.11448265648542, -1057.2989395779284, -370.0051067078806, -1052.9681234169627, -499.53864003345177, -740.2254595373547, -1075.8936380263146, -472.3837171564039, -978.8624888965211, -863.696763148806, -840.4220811973971, -245.39425097552328, -443.9649637951834, -1033.0588853896131, -159.41714316621125, -602.6506251387619, -874.2896359324858, 5.146184726428563, -1187.5231367878569, -74.66937752772705, -179.4733658026346, -201.01619633503472, -69.59507247449935, -320.10221160481655, -73.67789466621599, -1020.402870781673, -114.4942914361595, -1274.0240137338938, -1307.9834208033217, -145.7862250701613, -845.6532696066226, -203.78134101258195, -239.291009637497, -420.532596072702, -569.1667420079175, -826.9036949861796, -754.1643150708695, -399.19541042454114, -31.63722893051438, -1162.3272960498002, -681.614267380936, -312.01059838698274, -45.14267444474022, -317.97730415364236, -1155.238595573488, -1111.5247590937745, -327.26669705730495, -835.174115590155, -526.6772233680439, -730.1024801780206, -943.5261347629566, -494.555964578472, -122.59026203897463, -428.4322753340857, -360.25510959013263, -144.35742365138054, -779.30746978684, -510.1061048406115, -90.469985799463, -562.8437213003148, -133.56038564513253, -124.98454694607244, -994.6397231366839, -14.133321437927677, -953.717194687119, -278.11029616428544, -372.00728044938325, -471.70687070646125, -870.6922855519099, -10.315351219127345, -50.34094755140475, -2.30865172723679, -291.78267495067934, -1182.865829255115, -1222.4680543324184, -1075.9605798419261, -222.98386612987014, -177.76280357940965, -324.59765498424457, -156.51563451233002, -97.9605156787083, -546.6734048662588, -543.8293232555059, -134.1120313640035, -621.7198597119348, -416.0810316574404, -55.19899160613111, -851.5703462171512, -860.382553453822, -630.9632037163339, -3.88367031463641, -134.40043605728889, -375.38773176520095, -848.3566188928158, -731.8668051562476, -116.99927467999484, -441.60676260406785, -778.7426054587007, -774.3137715994056, -34.463748159265705, -467.32460461245955, -167.71595036248468, -734.7486478243393, -23.080255531956595, -26.153565711653712, -1130.8210241144511, -264.30783485874025, -182.9008479163748, -1224.899483410255, -687.2254025106521, -509.71700894901113, -739.4176066956153, -1237.3917353216239, -243.72996789108998, -101.36007885693287, -191.0063113986544, -343.02949660233986, -572.4009208786744, -136.02111191499043, -1045.036348580484, -424.94448370126383, -411.98338140617216, -455.9859322674258, -257.6908791507061, -120.983907620484, -143.41732083335393, -344.67453969082254, -625.2549292303352, -33.83794961233124, -385.7945352808435, -1346.6393930872348, -994.6166961789994, -1289.242453812509, -456.4146719300663, -168.91135817036275, -117.40432487556507, -392.67310424941144, -958.6499931870151, -729.3881946634965, -341.48786944067393, -285.62477636218733, -515.7829519556781, -299.6215390364011, -85.46840466555221, -684.6686281838076, -1053.2680869332514, -967.1059237869152, -83.61307403864193, -69.23720969551773, -474.0177246828191, -92.9369225982488, -478.3340440548622, -599.3514491845795, -331.98626673030554, -1119.2020209602251, -466.2898600078957, -893.6741655366659, -549.1575453560322, -523.439892882087, -1390.5606693465666, -17.218940321204443, -238.53594257900198, -427.05441383608445, -270.4635578092723, -191.35574083419982, -32.11516966365438, -502.28379211731203, -403.19473513858884, -1096.9805429942999, -617.6905927424384, -26.09671098858617, -536.0961703938484, -176.00715149991237, -127.96743997633624, -52.42435560013274, -96.80996086982194, -838.8788801525811, -52.683811927528254, -79.77455443810592, -1003.803571333498, -491.5311602576856, -266.79355486837505, -50.06749963699895, -37.07264475697689, -703.6126984938898, -1173.1795727129384, -304.23324303910675, -885.5000457194012, -154.54601531064864, -603.5194676408364, -227.33424028803952, -783.7373150214746, -185.44011163219997, -65.0160643572898, -34.23147991868191, -567.0156606787286, -19.61162235060397, -1029.8015993010567, -169.0995983894748, -188.47015233136526, -1211.5988992815935, -601.7683971806351, -22.49664293522219, -1140.5285516006102, -346.08960319790083, -334.93995439982973, -94.46828994655179, -308.83504928608943, -329.134297342361, -306.7574915667783, -1031.2760640439863, -200.5476552016148, -518.8132759895939, -180.58293581498648, -76.49625081786834, -758.0885317464148, -16.1850475792848, -146.5738680318334, -312.8052470247508, -164.94906560905915, -878.5697716642383, -190.50309832622847, -16.91712187909769, -714.7776822425395, -241.38643171089748, -1384.7035153431375, -31.551586495225706, -403.8754695897782, -146.71563761178447, -1059.4454328286408, -908.0926548167251, -272.1034451694197, -507.19088238406755, -69.14227904774376, -998.7554805804001, -91.40255502796812, -681.0419157489348, -1234.9933384385442, -1135.882826900047, -400.52813045623856, -1057.4577787648418, -731.6326921834212, -211.2137178958145, -250.5569201916163, -75.08095026971041, -472.4306205010208, -846.4639228270747, -1208.0517119204321, -155.09575188736704, -42.60635951116469, -584.6802553453297, -278.34497963785554, -362.5357674655634, -417.31169085923926, -722.0595283931515, -236.09579187392472, -1006.0169889049947, -416.5901859939852, -411.66280548614196, -470.2098319838272, -1455.426461024777, -66.97999781922434, -1454.9354962590414, -443.34085334810993, -103.54096286990513, -775.3493173007171, -659.5668247193616, -1140.811031592752, -139.24717706004537, -171.0299122840282, -315.24602415161706, -70.89027234452053, -656.3210627197601, -393.4222639874758, -415.7467550411625, -1116.0342776973519, -141.8780764731534, -93.49440535035563, -1165.585168590779, -182.42573848478781, -1255.481080545851, -1014.8182156421544, -230.11589193216417, -158.37726600297188, -135.26684872284534, -479.14090703725026, -968.1300600340674, -1273.0754737611544, -397.23752292168166, -727.3739088651362, -681.0193409324514, -1180.3531447031385, -91.67590482279495, -267.9010202493624, -974.1174956585886, -785.1864417778295, -294.2083304367936, -232.3548852158844, -19.678305832591562, -211.31717009377365, -260.90588928533896, -1356.9548757084915, -392.17295980547, -161.1079688678561, -555.4316596255993, -45.2361183672654, -343.7632931429337, -21.017578045719908, -10.162448793661628, -103.12696761979203, -234.44370008220451, -1123.5921820765516, -99.34589512713866, -1098.8677976804054, -259.3941661743637, -572.8148369109413, -122.90273627660885, -63.25382918908877, -292.3020637068354, -263.2038709234718, -167.72642853391673, -321.474692308061, -1039.1811644676195, -972.3432022950419, -32.398250871239796, -1071.5080949642418, -1079.7950804320992, -983.9017803571347, -878.0744377946019, -804.3015878809725, -138.4219254912482, -878.5027021531336, -1381.1090051059366, -111.23165495297896, -371.6227421557101, -208.89833132213707, -916.279989221754, -529.8343512391696, -463.1867056552545, -341.80173329224465, -200.97774166098637, -601.486099634515, -139.0383911929669, -123.0720127254743, -556.6013749025063, -117.93177712760607, -1079.3241192248595, -162.9305999013423, -140.8865731181127, -78.22498281737478, -1297.6060623929457, -54.55193944742341, -415.4266500371425, -65.35961036626821, -679.7472786482552, -60.574387063463945, -325.66513155145856, -123.81618310134364, -849.9378384290179, -1295.4563440015288, -638.7224428233143, -823.4236219617816, -129.66772802500685, -1048.3277557092676, -624.4933488343164, -58.79695847697273, -220.4404330704418, -185.7752373907423, -423.3983435591882, -362.1989050687754, -569.371588888319, -804.9802434755999, -951.2817067670301, -116.0651237723554, -1254.648194129396, -168.99608899823315, -186.26065088410022, -385.0439398793633, -53.00726589038315, -179.75811776361797, -183.08543010573618, -560.7278498839712, -154.51747239893598, -386.89542569343155, -1355.6836542045446, -58.45054118597015, -356.86809907058426, -163.5368000357621, -45.62759791393462, -125.97920431665976, -613.9126594713654, -626.4262943763658, -1167.2207457370516, -299.63717768635536, -351.1140192425273, -209.6188977582571, -326.62528644143765, -35.4111643984437, -854.0917872767338, -961.1410743072877, -349.0800351210855, -75.80408852635793, -448.0977141250769, -385.1923957632895, -219.62502847777358, -919.917602067552, -117.60773539391039, -563.7840617702711, -816.2739087565619, -269.9432022484419, -470.57796979200225, -302.70126354740347, -731.2390715119632, -688.5745409759074, -240.47446694637597, -188.34712239744331, -643.5034272151917, -576.5107886232586, -284.86232281215626, -470.865936327544, -679.8277677155335, -274.4126623880606, -1107.3938436060137, -351.5575941085377, -626.926397261359, -168.25198362947697, -184.64857794514916, -570.2283169186146, -412.83109119369857, -299.24623896322294, -20.076612970619568, -296.6653180154311]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5243932510079725, "mean_inference_ms": 1.7110505984783762, "mean_action_processing_ms": 0.7885445962616617, "mean_env_wait_ms": 10.178232861805045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012400388717651367, "StateBufferConnector_ms": 0.00921630859375, "ViewRequirementAgentConnector_ms": 0.2989921569824219}, "num_episodes": 29, "episode_return_max": -871.3149389375043, "episode_return_min": -4560.49476674309, "episode_return_mean": -2459.7136896016764, "episodes_this_iter": 29}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1699119, "num_agent_steps_trained": 1699119, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.25138996163147, "num_env_steps_trained_throughput_per_sec": 85.25138996163147, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1699119, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1699119, "timers": {"training_iteration_time_ms": 46272.75, "restore_workers_time_ms": 0.028, "training_step_time_ms": 46272.679, "sample_time_ms": 3221.036, "learn_time_ms": 42997.886, "learn_throughput": 93.028, "synch_weights_time_ms": 50.959}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1699119, "num_agent_steps_trained": 1699119}, "done": false, "training_iteration": 98, "trial_id": "05c72_00000", "date": "2024-07-26_16-02-26", "timestamp": 1721989946, "time_this_iter_s": 46.93115210533142, "time_total_s": 4763.320143461227, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd01484c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4763.320143461227, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 12.6044776119403, "ram_util_percent": 30.595522388059695}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.4341822902973, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.558034169918452, "policy_loss": -0.0030676267428610187, "vf_loss": 4.578787233707232, "vf_explained_var": 0.9849265840726021, "kl": 0.016414678499635415, "entropy": 3.015033495548444, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.21538461538462, "num_grad_updates_lifetime": 401580.5, "diff_num_grad_updates_vs_sampler_policy": 1949.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1715657, "num_agent_steps_trained": 1715657}, "env_runners": {"episode_reward_max": -871.3149389375043, "episode_reward_min": -5263.715484587767, "episode_reward_mean": -2447.738776349438, "episode_len_mean": 148.75, "episode_media": {}, "episodes_timesteps_total": 14875, "policy_reward_min": {"policy_0": -1455.426461024777}, "policy_reward_max": {"policy_0": -2.30865172723679}, "policy_reward_mean": {"policy_0": -489.5477552698875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1421.9647445315932, -2612.607815875399, -1405.3641067561393, -3996.061004510009, -1303.5100136209514, -1770.941237595015, -2481.2002097592313, -2514.217193098325, -2222.560680192319, -2179.11132804114, -3344.1603494819087, -2116.5175900706395, -2590.386246481582, -1322.7525795627935, -3386.1435033897455, -2424.6459130379135, -2830.9337856090524, -3090.1325826059274, -1198.138975070089, -3410.5037624196702, -2718.9129904848915, -1423.2726742605228, -2680.058752257764, -1292.087788098785, -1894.5866528251931, -2268.1656586399117, -2654.6370839804035, -871.3149389375043, -3200.738646484125, -1938.5230420801158, -2176.550557440831, -1550.1660419481466, -1693.4010506561117, -2389.336337670897, -2790.232640016352, -2347.5331127891154, -4560.49476674309, -1855.7461316852366, -2268.7790583021497, -2744.0197674968726, -2820.8692823079537, -3436.733454497134, -1837.224417432962, -2723.4024359189057, -3711.8046086139266, -1971.030973729297, -4259.059391183562, -2413.0891929453696, -2081.2111261360787, -1497.711999809125, -1492.34287661793, -2153.3254321694567, -1107.9608846613744, -4195.225793030244, -3683.2024336770914, -2989.1417227585184, -2137.286631482168, -2015.9676751734119, -1734.200157677199, -1546.773057666588, -3731.356430316985, -2081.726224116008, -2345.724318382626, -2677.2517645511157, -1361.6226035230713, -2312.4151925534666, -1575.4825561140894, -2354.2161268656278, -2275.5281496299112, -2090.4404758276014, -2423.2804061146826, -2492.1386290468804, -2286.47947786655, -2438.7783965505373, -1599.047578061585, -2973.4182202426664, -3568.687585161044, -1697.933913595991, -1747.0279415273828, -2583.4314732455905, -3286.265370276906, -2340.0691056374753, -2159.700485906555, -2060.3461446804445, -1544.0330326122726, -2868.16478291636, -3501.5343165782374, -1751.6865741017596, -1907.3127148388207, -2945.09272346221, -1930.7882615106564, -2276.8226541202725, -2622.566879993424, -3540.5099142193694, -4178.693570449221, -5263.715484587767, -2026.7871373594558, -2990.8319011599756, -3365.096056737519, -2849.8981985058495], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-510.1061048406115, -90.469985799463, -562.8437213003148, -133.56038564513253, -124.98454694607244, -994.6397231366839, -14.133321437927677, -953.717194687119, -278.11029616428544, -372.00728044938325, -471.70687070646125, -870.6922855519099, -10.315351219127345, -50.34094755140475, -2.30865172723679, -291.78267495067934, -1182.865829255115, -1222.4680543324184, -1075.9605798419261, -222.98386612987014, -177.76280357940965, -324.59765498424457, -156.51563451233002, -97.9605156787083, -546.6734048662588, -543.8293232555059, -134.1120313640035, -621.7198597119348, -416.0810316574404, -55.19899160613111, -851.5703462171512, -860.382553453822, -630.9632037163339, -3.88367031463641, -134.40043605728889, -375.38773176520095, -848.3566188928158, -731.8668051562476, -116.99927467999484, -441.60676260406785, -778.7426054587007, -774.3137715994056, -34.463748159265705, -467.32460461245955, -167.71595036248468, -734.7486478243393, -23.080255531956595, -26.153565711653712, -1130.8210241144511, -264.30783485874025, -182.9008479163748, -1224.899483410255, -687.2254025106521, -509.71700894901113, -739.4176066956153, -1237.3917353216239, -243.72996789108998, -101.36007885693287, -191.0063113986544, -343.02949660233986, -572.4009208786744, -136.02111191499043, -1045.036348580484, -424.94448370126383, -411.98338140617216, -455.9859322674258, -257.6908791507061, -120.983907620484, -143.41732083335393, -344.67453969082254, -625.2549292303352, -33.83794961233124, -385.7945352808435, -1346.6393930872348, -994.6166961789994, -1289.242453812509, -456.4146719300663, -168.91135817036275, -117.40432487556507, -392.67310424941144, -958.6499931870151, -729.3881946634965, -341.48786944067393, -285.62477636218733, -515.7829519556781, -299.6215390364011, -85.46840466555221, -684.6686281838076, -1053.2680869332514, -967.1059237869152, -83.61307403864193, -69.23720969551773, -474.0177246828191, -92.9369225982488, -478.3340440548622, -599.3514491845795, -331.98626673030554, -1119.2020209602251, -466.2898600078957, -893.6741655366659, -549.1575453560322, -523.439892882087, -1390.5606693465666, -17.218940321204443, -238.53594257900198, -427.05441383608445, -270.4635578092723, -191.35574083419982, -32.11516966365438, -502.28379211731203, -403.19473513858884, -1096.9805429942999, -617.6905927424384, -26.09671098858617, -536.0961703938484, -176.00715149991237, -127.96743997633624, -52.42435560013274, -96.80996086982194, -838.8788801525811, -52.683811927528254, -79.77455443810592, -1003.803571333498, -491.5311602576856, -266.79355486837505, -50.06749963699895, -37.07264475697689, -703.6126984938898, -1173.1795727129384, -304.23324303910675, -885.5000457194012, -154.54601531064864, -603.5194676408364, -227.33424028803952, -783.7373150214746, -185.44011163219997, -65.0160643572898, -34.23147991868191, -567.0156606787286, -19.61162235060397, -1029.8015993010567, -169.0995983894748, -188.47015233136526, -1211.5988992815935, -601.7683971806351, -22.49664293522219, -1140.5285516006102, -346.08960319790083, -334.93995439982973, -94.46828994655179, -308.83504928608943, -329.134297342361, -306.7574915667783, -1031.2760640439863, -200.5476552016148, -518.8132759895939, -180.58293581498648, -76.49625081786834, -758.0885317464148, -16.1850475792848, -146.5738680318334, -312.8052470247508, -164.94906560905915, -878.5697716642383, -190.50309832622847, -16.91712187909769, -714.7776822425395, -241.38643171089748, -1384.7035153431375, -31.551586495225706, -403.8754695897782, -146.71563761178447, -1059.4454328286408, -908.0926548167251, -272.1034451694197, -507.19088238406755, -69.14227904774376, -998.7554805804001, -91.40255502796812, -681.0419157489348, -1234.9933384385442, -1135.882826900047, -400.52813045623856, -1057.4577787648418, -731.6326921834212, -211.2137178958145, -250.5569201916163, -75.08095026971041, -472.4306205010208, -846.4639228270747, -1208.0517119204321, -155.09575188736704, -42.60635951116469, -584.6802553453297, -278.34497963785554, -362.5357674655634, -417.31169085923926, -722.0595283931515, -236.09579187392472, -1006.0169889049947, -416.5901859939852, -411.66280548614196, -470.2098319838272, -1455.426461024777, -66.97999781922434, -1454.9354962590414, -443.34085334810993, -103.54096286990513, -775.3493173007171, -659.5668247193616, -1140.811031592752, -139.24717706004537, -171.0299122840282, -315.24602415161706, -70.89027234452053, -656.3210627197601, -393.4222639874758, -415.7467550411625, -1116.0342776973519, -141.8780764731534, -93.49440535035563, -1165.585168590779, -182.42573848478781, -1255.481080545851, -1014.8182156421544, -230.11589193216417, -158.37726600297188, -135.26684872284534, -479.14090703725026, -968.1300600340674, -1273.0754737611544, -397.23752292168166, -727.3739088651362, -681.0193409324514, -1180.3531447031385, -91.67590482279495, -267.9010202493624, -974.1174956585886, -785.1864417778295, -294.2083304367936, -232.3548852158844, -19.678305832591562, -211.31717009377365, -260.90588928533896, -1356.9548757084915, -392.17295980547, -161.1079688678561, -555.4316596255993, -45.2361183672654, -343.7632931429337, -21.017578045719908, -10.162448793661628, -103.12696761979203, -234.44370008220451, -1123.5921820765516, -99.34589512713866, -1098.8677976804054, -259.3941661743637, -572.8148369109413, -122.90273627660885, -63.25382918908877, -292.3020637068354, -263.2038709234718, -167.72642853391673, -321.474692308061, -1039.1811644676195, -972.3432022950419, -32.398250871239796, -1071.5080949642418, -1079.7950804320992, -983.9017803571347, -878.0744377946019, -804.3015878809725, -138.4219254912482, -878.5027021531336, -1381.1090051059366, -111.23165495297896, -371.6227421557101, -208.89833132213707, -916.279989221754, -529.8343512391696, -463.1867056552545, -341.80173329224465, -200.97774166098637, -601.486099634515, -139.0383911929669, -123.0720127254743, -556.6013749025063, -117.93177712760607, -1079.3241192248595, -162.9305999013423, -140.8865731181127, -78.22498281737478, -1297.6060623929457, -54.55193944742341, -415.4266500371425, -65.35961036626821, -679.7472786482552, -60.574387063463945, -325.66513155145856, -123.81618310134364, -849.9378384290179, -1295.4563440015288, -638.7224428233143, -823.4236219617816, -129.66772802500685, -1048.3277557092676, -624.4933488343164, -58.79695847697273, -220.4404330704418, -185.7752373907423, -423.3983435591882, -362.1989050687754, -569.371588888319, -804.9802434755999, -951.2817067670301, -116.0651237723554, -1254.648194129396, -168.99608899823315, -186.26065088410022, -385.0439398793633, -53.00726589038315, -179.75811776361797, -183.08543010573618, -560.7278498839712, -154.51747239893598, -386.89542569343155, -1355.6836542045446, -58.45054118597015, -356.86809907058426, -163.5368000357621, -45.62759791393462, -125.97920431665976, -613.9126594713654, -626.4262943763658, -1167.2207457370516, -299.63717768635536, -351.1140192425273, -209.6188977582571, -326.62528644143765, -35.4111643984437, -854.0917872767338, -961.1410743072877, -349.0800351210855, -75.80408852635793, -448.0977141250769, -385.1923957632895, -219.62502847777358, -919.917602067552, -117.60773539391039, -563.7840617702711, -816.2739087565619, -269.9432022484419, -470.57796979200225, -302.70126354740347, -731.2390715119632, -688.5745409759074, -240.47446694637597, -188.34712239744331, -643.5034272151917, -576.5107886232586, -284.86232281215626, -470.865936327544, -679.8277677155335, -274.4126623880606, -1107.3938436060137, -351.5575941085377, -626.926397261359, -168.25198362947697, -184.64857794514916, -570.2283169186146, -412.83109119369857, -299.24623896322294, -20.076612970619568, -296.6653180154311, -766.3563358988062, -208.988177859316, -166.87536632698212, -1153.579309187697, -677.6190309698657, -778.5887285860276, -321.948645383505, -85.28924340305747, -1212.023456977476, -1170.8375108109801, -922.7325449838771, -48.125207714690255, -121.65922015353387, -447.6292269674616, -157.7877137764288, -343.1815785304382, -104.60800858854601, -467.56883019309464, -662.3199410719457, -169.34958314336075, -899.502515629655, -540.6981464573989, -21.48348758818048, -819.9240711069405, -301.8232524634168, -908.3696813350704, -88.05252915171313, -1070.0262777994838, -254.19449064487085, -965.6223913457718, -697.858509510317, -194.47388172693812, -77.11554674676253, -169.87379291480573, -1200.7473747386516, -787.5349867593033, -943.2493117720227, -209.81272152990164, -81.27877530174274, -137.8246905435856, -552.7543159425302, -19.644907184258578, -730.5996261840685, -656.9456537972986, -100.40164157228874, -25.90291305480683, -547.7127142331866, -21.182991047238687, -942.3379867746208, -6.896427502420156, -723.0615499259411, -45.712950059381114, -1122.3625429204003, -718.583086858707, -258.44465315193247, -9.99817678820947, -161.9358666544833, -694.4346329982527, -1194.5172681293789, -1440.6483720079098, -313.132904484239, -295.8319694347824, -51.4831774107462, -82.68577260912917, -1008.5527501628612, -345.9322238617919, -648.1059697122245, -57.63188865576875, -57.08001409433841, -798.5626185146967, -743.759988451984, -98.99708655300918, -539.5097062472184, -505.74660485066914, -1057.0793373593294, -261.01292313457526, -199.86103629919936, -77.02835383616367, -483.8271647255219, -909.0587835151972, -272.2182715142877, -988.2793646603254, -68.45120336503845, -270.31856030753346, -677.5552542730863, -1147.230131362768, -567.3532189354572, -226.9180356492018, -83.7424818690146, -597.3230121769882, -783.4499661309086, -314.3955469772857, -1107.79682646036, -110.7065637594091, -1224.1610108914065, -497.8047787940828, -1396.6738989150658, -799.6429915017764, -1258.318640960888, -226.25326027740226, -975.4608069935274, -1307.9397759609187, -1048.9220416757241, -975.1681557680943, -956.2247041895049, -1291.550328453167, -112.50937702309471, -31.85486710546357, -117.01866184012471, -473.8539029376062, -466.4718681925327, -673.6641538807602, -131.3145794012168, -975.8983046066309, -743.4829950788358, -203.28829131566062, -706.0705517341768, -609.5480447813623, -446.40303961886497, -1399.7861292874545, -706.7152638380821, -1008.9660800315877, -59.5730593512036, -645.2815618031946, -429.36223348177975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5230486144344944, "mean_inference_ms": 1.7105645251043553, "mean_action_processing_ms": 0.7877900070035422, "mean_env_wait_ms": 10.169779583189785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011929035186767578, "StateBufferConnector_ms": 0.009162425994873047, "ViewRequirementAgentConnector_ms": 0.29657816886901855}, "num_episodes": 25, "episode_return_max": -871.3149389375043, "episode_return_min": -5263.715484587767, "episode_return_mean": -2447.738776349438, "episodes_this_iter": 25}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1715657, "num_agent_steps_trained": 1715657, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.36146994375216, "num_env_steps_trained_throughput_per_sec": 89.36146994375216, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1715657, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1715657, "timers": {"training_iteration_time_ms": 45608.484, "restore_workers_time_ms": 0.027, "training_step_time_ms": 45608.414, "sample_time_ms": 3231.488, "learn_time_ms": 42322.958, "learn_throughput": 94.511, "synch_weights_time_ms": 51.203}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1715657, "num_agent_steps_trained": 1715657}, "done": false, "training_iteration": 99, "trial_id": "05c72_00000", "date": "2024-07-26_16-03-11", "timestamp": 1721989991, "time_this_iter_s": 44.773330211639404, "time_total_s": 4808.093473672867, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00f9630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4808.093473672867, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 12.4328125, "ram_util_percent": 30.545312499999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.6308606295792, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.0010000000000000005, "total_loss": 4.466793857943314, "policy_loss": -0.0016099319565785295, "vf_loss": 4.486431737771167, "vf_explained_var": 0.9847577144171445, "kl": 0.016471392964990453, "entropy": 3.0535910519024796, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.62595419847328, "num_grad_updates_lifetime": 405495.5, "diff_num_grad_updates_vs_sampler_policy": 1964.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1732376, "num_agent_steps_trained": 1732376}, "env_runners": {"episode_reward_max": -771.9608277123857, "episode_reward_min": -5263.715484587767, "episode_reward_mean": -2513.0338142043242, "episode_len_mean": 147.55, "episode_media": {}, "episodes_timesteps_total": 14755, "policy_reward_min": {"policy_0": -1455.426461024777}, "policy_reward_max": {"policy_0": -0.9859301080030837}, "policy_reward_mean": {"policy_0": -502.60676284086503}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3200.738646484125, -1938.5230420801158, -2176.550557440831, -1550.1660419481466, -1693.4010506561117, -2389.336337670897, -2790.232640016352, -2347.5331127891154, -4560.49476674309, -1855.7461316852366, -2268.7790583021497, -2744.0197674968726, -2820.8692823079537, -3436.733454497134, -1837.224417432962, -2723.4024359189057, -3711.8046086139266, -1971.030973729297, -4259.059391183562, -2413.0891929453696, -2081.2111261360787, -1497.711999809125, -1492.34287661793, -2153.3254321694567, -1107.9608846613744, -4195.225793030244, -3683.2024336770914, -2989.1417227585184, -2137.286631482168, -2015.9676751734119, -1734.200157677199, -1546.773057666588, -3731.356430316985, -2081.726224116008, -2345.724318382626, -2677.2517645511157, -1361.6226035230713, -2312.4151925534666, -1575.4825561140894, -2354.2161268656278, -2275.5281496299112, -2090.4404758276014, -2423.2804061146826, -2492.1386290468804, -2286.47947786655, -2438.7783965505373, -1599.047578061585, -2973.4182202426664, -3568.687585161044, -1697.933913595991, -1747.0279415273828, -2583.4314732455905, -3286.265370276906, -2340.0691056374753, -2159.700485906555, -2060.3461446804445, -1544.0330326122726, -2868.16478291636, -3501.5343165782374, -1751.6865741017596, -1907.3127148388207, -2945.09272346221, -1930.7882615106564, -2276.8226541202725, -2622.566879993424, -3540.5099142193694, -4178.693570449221, -5263.715484587767, -2026.7871373594558, -2990.8319011599756, -3365.096056737519, -2849.8981985058495, -1856.1251368101296, -1068.9954928394836, -1678.664904530711, -3157.433236960765, -771.9608277123857, -2813.0044740395824, -2527.376627830566, -3404.2118687537786, -4284.571746314251, -3433.195379334014, -1436.649228874619, -1687.655071902065, -4080.387626793109, -2102.950151729426, -951.9749389493295, -4391.608331753685, -2945.132459123399, -4117.234979535888, -1867.8758860247267, -1569.3261118043984, -1824.352389815704, -2277.6840149583386, -2685.562861676955, -3441.6707638862067, -2302.131235497268, -1870.9891408290482, -1832.0343344832283, -3573.634723920095], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 150, 150, 141, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 89, 150, 150, 150, 150, 150, 149, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1029.8015993010567, -169.0995983894748, -188.47015233136526, -1211.5988992815935, -601.7683971806351, -22.49664293522219, -1140.5285516006102, -346.08960319790083, -334.93995439982973, -94.46828994655179, -308.83504928608943, -329.134297342361, -306.7574915667783, -1031.2760640439863, -200.5476552016148, -518.8132759895939, -180.58293581498648, -76.49625081786834, -758.0885317464148, -16.1850475792848, -146.5738680318334, -312.8052470247508, -164.94906560905915, -878.5697716642383, -190.50309832622847, -16.91712187909769, -714.7776822425395, -241.38643171089748, -1384.7035153431375, -31.551586495225706, -403.8754695897782, -146.71563761178447, -1059.4454328286408, -908.0926548167251, -272.1034451694197, -507.19088238406755, -69.14227904774376, -998.7554805804001, -91.40255502796812, -681.0419157489348, -1234.9933384385442, -1135.882826900047, -400.52813045623856, -1057.4577787648418, -731.6326921834212, -211.2137178958145, -250.5569201916163, -75.08095026971041, -472.4306205010208, -846.4639228270747, -1208.0517119204321, -155.09575188736704, -42.60635951116469, -584.6802553453297, -278.34497963785554, -362.5357674655634, -417.31169085923926, -722.0595283931515, -236.09579187392472, -1006.0169889049947, -416.5901859939852, -411.66280548614196, -470.2098319838272, -1455.426461024777, -66.97999781922434, -1454.9354962590414, -443.34085334810993, -103.54096286990513, -775.3493173007171, -659.5668247193616, -1140.811031592752, -139.24717706004537, -171.0299122840282, -315.24602415161706, -70.89027234452053, -656.3210627197601, -393.4222639874758, -415.7467550411625, -1116.0342776973519, -141.8780764731534, -93.49440535035563, -1165.585168590779, -182.42573848478781, -1255.481080545851, -1014.8182156421544, -230.11589193216417, -158.37726600297188, -135.26684872284534, -479.14090703725026, -968.1300600340674, -1273.0754737611544, -397.23752292168166, -727.3739088651362, -681.0193409324514, -1180.3531447031385, -91.67590482279495, -267.9010202493624, -974.1174956585886, -785.1864417778295, -294.2083304367936, -232.3548852158844, -19.678305832591562, -211.31717009377365, -260.90588928533896, -1356.9548757084915, -392.17295980547, -161.1079688678561, -555.4316596255993, -45.2361183672654, -343.7632931429337, -21.017578045719908, -10.162448793661628, -103.12696761979203, -234.44370008220451, -1123.5921820765516, -99.34589512713866, -1098.8677976804054, -259.3941661743637, -572.8148369109413, -122.90273627660885, -63.25382918908877, -292.3020637068354, -263.2038709234718, -167.72642853391673, -321.474692308061, -1039.1811644676195, -972.3432022950419, -32.398250871239796, -1071.5080949642418, -1079.7950804320992, -983.9017803571347, -878.0744377946019, -804.3015878809725, -138.4219254912482, -878.5027021531336, -1381.1090051059366, -111.23165495297896, -371.6227421557101, -208.89833132213707, -916.279989221754, -529.8343512391696, -463.1867056552545, -341.80173329224465, -200.97774166098637, -601.486099634515, -139.0383911929669, -123.0720127254743, -556.6013749025063, -117.93177712760607, -1079.3241192248595, -162.9305999013423, -140.8865731181127, -78.22498281737478, -1297.6060623929457, -54.55193944742341, -415.4266500371425, -65.35961036626821, -679.7472786482552, -60.574387063463945, -325.66513155145856, -123.81618310134364, -849.9378384290179, -1295.4563440015288, -638.7224428233143, -823.4236219617816, -129.66772802500685, -1048.3277557092676, -624.4933488343164, -58.79695847697273, -220.4404330704418, -185.7752373907423, -423.3983435591882, -362.1989050687754, -569.371588888319, -804.9802434755999, -951.2817067670301, -116.0651237723554, -1254.648194129396, -168.99608899823315, -186.26065088410022, -385.0439398793633, -53.00726589038315, -179.75811776361797, -183.08543010573618, -560.7278498839712, -154.51747239893598, -386.89542569343155, -1355.6836542045446, -58.45054118597015, -356.86809907058426, -163.5368000357621, -45.62759791393462, -125.97920431665976, -613.9126594713654, -626.4262943763658, -1167.2207457370516, -299.63717768635536, -351.1140192425273, -209.6188977582571, -326.62528644143765, -35.4111643984437, -854.0917872767338, -961.1410743072877, -349.0800351210855, -75.80408852635793, -448.0977141250769, -385.1923957632895, -219.62502847777358, -919.917602067552, -117.60773539391039, -563.7840617702711, -816.2739087565619, -269.9432022484419, -470.57796979200225, -302.70126354740347, -731.2390715119632, -688.5745409759074, -240.47446694637597, -188.34712239744331, -643.5034272151917, -576.5107886232586, -284.86232281215626, -470.865936327544, -679.8277677155335, -274.4126623880606, -1107.3938436060137, -351.5575941085377, -626.926397261359, -168.25198362947697, -184.64857794514916, -570.2283169186146, -412.83109119369857, -299.24623896322294, -20.076612970619568, -296.6653180154311, -766.3563358988062, -208.988177859316, -166.87536632698212, -1153.579309187697, -677.6190309698657, -778.5887285860276, -321.948645383505, -85.28924340305747, -1212.023456977476, -1170.8375108109801, -922.7325449838771, -48.125207714690255, -121.65922015353387, -447.6292269674616, -157.7877137764288, -343.1815785304382, -104.60800858854601, -467.56883019309464, -662.3199410719457, -169.34958314336075, -899.502515629655, -540.6981464573989, -21.48348758818048, -819.9240711069405, -301.8232524634168, -908.3696813350704, -88.05252915171313, -1070.0262777994838, -254.19449064487085, -965.6223913457718, -697.858509510317, -194.47388172693812, -77.11554674676253, -169.87379291480573, -1200.7473747386516, -787.5349867593033, -943.2493117720227, -209.81272152990164, -81.27877530174274, -137.8246905435856, -552.7543159425302, -19.644907184258578, -730.5996261840685, -656.9456537972986, -100.40164157228874, -25.90291305480683, -547.7127142331866, -21.182991047238687, -942.3379867746208, -6.896427502420156, -723.0615499259411, -45.712950059381114, -1122.3625429204003, -718.583086858707, -258.44465315193247, -9.99817678820947, -161.9358666544833, -694.4346329982527, -1194.5172681293789, -1440.6483720079098, -313.132904484239, -295.8319694347824, -51.4831774107462, -82.68577260912917, -1008.5527501628612, -345.9322238617919, -648.1059697122245, -57.63188865576875, -57.08001409433841, -798.5626185146967, -743.759988451984, -98.99708655300918, -539.5097062472184, -505.74660485066914, -1057.0793373593294, -261.01292313457526, -199.86103629919936, -77.02835383616367, -483.8271647255219, -909.0587835151972, -272.2182715142877, -988.2793646603254, -68.45120336503845, -270.31856030753346, -677.5552542730863, -1147.230131362768, -567.3532189354572, -226.9180356492018, -83.7424818690146, -597.3230121769882, -783.4499661309086, -314.3955469772857, -1107.79682646036, -110.7065637594091, -1224.1610108914065, -497.8047787940828, -1396.6738989150658, -799.6429915017764, -1258.318640960888, -226.25326027740226, -975.4608069935274, -1307.9397759609187, -1048.9220416757241, -975.1681557680943, -956.2247041895049, -1291.550328453167, -112.50937702309471, -31.85486710546357, -117.01866184012471, -473.8539029376062, -466.4718681925327, -673.6641538807602, -131.3145794012168, -975.8983046066309, -743.4829950788358, -203.28829131566062, -706.0705517341768, -609.5480447813623, -446.40303961886497, -1399.7861292874545, -706.7152638380821, -1008.9660800315877, -59.5730593512036, -645.2815618031946, -429.36223348177975, -589.6332309683486, -128.4276923697215, -169.07840497746164, -622.6119062863556, -346.3739022082429, -61.391789041943596, -387.2268016078927, -304.65478678756193, -170.10137077896331, -145.620744623122, -284.8190323548197, -194.77018918581285, -883.0935634934257, -207.87030023124183, -108.11181926541163, -16.601463657334886, -1230.4664273351277, -701.4386337777134, -313.2329996514929, -895.693712539096, -86.48163517735804, -68.47512485282904, -80.88204496445049, -186.11976768724188, -350.0022550305058, -1349.3832328667954, -216.42665327073516, -212.63509382446878, -37.22973273146803, -997.3297613461135, -70.14508924130403, -4.948469672542181, -890.5757430586152, -1218.1231334455279, -343.5841924125795, -1290.50007438166, -278.91603413395416, -778.0443402118905, -543.6644401522899, -513.0869798739873, -990.6031966783289, -625.4089846544782, -840.205631955262, -963.5752122938347, -864.7787207323447, -117.62411709295245, -25.3325132855406, -1102.9916418372334, -1147.763283425895, -1039.483823692397, -134.56575300831037, -482.25895116520473, -268.5945759022101, -10.986821774424138, -540.2431270244698, -465.20659231020386, -776.1917427066104, -307.74711327458743, -95.99787441907824, -42.51174919158625, -659.859861206563, -1146.567519608724, -809.7343794531577, -63.49943599994923, -1400.726430524716, -321.0123191287872, -164.02058693430791, -333.16206789461256, -46.67010841758035, -1238.085069354137, -244.16517151875993, -258.6710663552474, -47.999009817123046, -279.2485842071305, -121.89110705106863, -722.398754022887, -1428.516585676278, -1298.292829469046, -476.27272621407593, -466.1274363713952, -1059.4189671787492, -308.6140868987565, -955.1644997852075, -477.66430978092126, -144.2705954797659, -1058.9977522118886, -833.2974772570467, -1183.7036500291915, -170.84823559917155, -870.387864438591, -15.063219555359561, -9.200723669057348, -1347.260220940827, -346.93531969758016, -149.4164021619029, -542.3474645790119, -150.69452986184595, -592.0428940651569, -0.9859301080030837, -283.2552931903799, -224.81408993747783, -755.005467508763, -151.11976677813806, -175.56535156469394, -517.8477140266326, -506.98895003243257, -134.32930372164475, -321.6295908323943, -1113.0654075571563, -201.67076281471012, -430.56514416839246, -640.4486397435201, -928.0558800523484, -261.3928500185129, -425.1003476941784, -237.48825109216563, -940.1664492081355, -942.5260351297916, -957.523259742555, -363.9667687135605, -159.73127057164416, -1044.1891917204093, -482.48109320489476, -353.57988914606955, -262.14979085425006, -480.1103024039594, -247.98564601057353, -41.64098171920932, -590.9754433242066, -510.276767371097, -256.58831863435523, -562.3863454877061, -469.7210542135236, -342.93978953882413, -200.3988266088205, -1075.9080183813237, -637.658444694703, -269.5838633826688, -982.5481633650645, -607.9362340963353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5224254275759739, "mean_inference_ms": 1.71068678345485, "mean_action_processing_ms": 0.7872578730707015, "mean_env_wait_ms": 10.16451233243333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012305498123168945, "StateBufferConnector_ms": 0.009134769439697266, "ViewRequirementAgentConnector_ms": 0.2957942485809326}, "num_episodes": 28, "episode_return_max": -771.9608277123857, "episode_return_min": -5263.715484587767, "episode_return_mean": -2513.0338142043242, "episodes_this_iter": 28}, "num_healthy_workers": 20, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1732376, "num_agent_steps_trained": 1732376, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.453526186675, "num_env_steps_trained_throughput_per_sec": 83.453526186675, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1732376, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1732376, "timers": {"training_iteration_time_ms": 46105.397, "restore_workers_time_ms": 0.027, "training_step_time_ms": 46105.327, "sample_time_ms": 3207.429, "learn_time_ms": 42844.714, "learn_throughput": 93.36, "synch_weights_time_ms": 50.413}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1732376, "num_agent_steps_trained": 1732376}, "done": true, "training_iteration": 100, "trial_id": "05c72_00000", "date": "2024-07-26_16-03-59", "timestamp": 1721990039, "time_this_iter_s": 47.942864179611206, "time_total_s": 4856.036337852478, "pid": 41177, "hostname": "mav-lab-invento", "node_ip": "192.168.0.178", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 5, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x71cdd00fa320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 37500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4856.036337852478, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 11.636764705882353, "ram_util_percent": 30.483823529411765}}
